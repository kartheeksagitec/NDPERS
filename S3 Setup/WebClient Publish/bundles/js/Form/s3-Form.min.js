function growtextbox(n,t,i){var e=0,o=100,r="",s="",h,l,f;t?(r=n,s=i):(r=$(n.currentTarget),s=r.val());h=r.width();r.width("auto");var a=r.width(),u=$("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:r.css("fontSize"),fontFamily:r.css("fontFamily"),fontWeight:r.css("fontWeight"),letterSpacing:r.css("letterSpacing"),whiteSpace:"nowrap",display:"block",visibility:"hidden"}),c=s.replace(/&/g,"&amp;").replace(/\s/g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");u.html(c);$("body").append(u);l=u.width();f=u.width();u.remove();f<o?e=o:f>o&&(e=f);r.width(e+10)}function funcontrolDragEnter(n,t,i){if(t&&t.IsSelected&&n&&(!n.draggable&&$(n).children("[content-editable]").length<=0||$(n).children("[content-editable]").length>0&&$(n).children("[drag-handler-btn]").length<=0)){if(i.dictAttributes.sfwType=="Lookup"&&i.SelectedControl.Name=="sfwGridView")return;var r=n;$(n).children("[content-editable]").length>0&&($(n).prepend("<span drag-handler-btn  class='drag-text-control'><\/span>"),r=$(n).children("[drag-handler-btn]")[0]);r.draggable=!0;r.addEventListener("dragstart",u,!1);function u(n){$(n.currentTarget).closest("[formcontroldroppable]").find("[add-control-hover-trigger]").remove();dragDropData=null;dragDropDataObject=null;dragfromleft=undefined;var i=$(n.currentTarget)[0];$(n.currentTarget).siblings("[content-editable]").length>0&&(i=$(n.currentTarget).parent()[0]);detectIE()||n.dataTransfer.setDragImage(i,5,5);dragDropData=t;draggingDataFromLeft=null;dragDropDataObject=null;n.stopPropagation()}}}function getDisplayValue(n){var t,i,r;return n!=undefined?(t="",n.Name=="udc"?t=n.dictAttributes.ID:(n.dictAttributes&&n.dictAttributes.Text?t=n.dictAttributes.Text:n.dictAttributes&&n.dictAttributes.sfwCaption?t=n.dictAttributes.sfwCaption:n.dictAttributes&&n.dictAttributes.sfwEntityField?(i=n.dictAttributes.sfwEntityField,r=i.lastIndexOf("."),t=i.substring(r+1)):n.dictAttributes&&n.dictAttributes.sfwDataField?(i=n.dictAttributes.sfwDataField,r=i.lastIndexOf("."),t=i.substring(r+1)):t=n.dictAttributes&&n.dictAttributes.sfwObjectField?n.dictAttributes.sfwObjectField:n.dictAttributes&&n.dictAttributes.Title?n.dictAttributes.Title:n.dictAttributes&&n.dictAttributes.ID?n.dictAttributes.ID:n.Name,n.Name=="sfwLiteral"&&(t="|"+t+"|")),t):""}function GetSelectedFieldList(n,t){return angular.forEach(n,function(n){n.IsSelected&&n.IsSelected.toLowerCase()=="true"&&t.push(n);n.Attributes&&n.Attributes.length>0&&GetSelectedFieldList(n.Attributes,t)}),t}function getDisplayedEntity(n){var i,t;if(n&&n.length>0)for(t=0;t<n.length;t++)if(n[t].IsVisible){i=n[t];break}return i}function ClearSelectedFieldList(n){angular.forEach(n,function(n){n.IsSelected&&n.IsSelected.toLowerCase()=="true"&&(n.IsSelected="false",n.IsRecordSelected=!1)})}function GetItemPathForEntityObject(n){for(var i=n.ID,t=n.objParent;t&&!t.IsMainEntity&&t.ID;)i=t.ID+"."+i,t=t.objParent;return i}function GetCodeIDByValue(n,t,i){var e="",r,u,f;return n&&(r=i.filter(function(t){return t.ID==n}),r&&r.length>0&&r[0].Attributes.length>0&&(u=r[0].Attributes.filter(function(n){return n.Value==t}),u.length>0&&u[0].Value&&(f=r[0].Attributes.filter(function(n){return n.Value==u[0].Value.replace("_value","_id")}),f&&f.length>0&&(e=f[0].CodeID)))),e}function GetCodeID(n,t,i){var h="",s=[],f=[],u,e,r,o;if(t&&(s=t.split(".")),n)for(u=i.filter(function(t){return t.ID==n}),e=0;e<s.length;e++)u&&u.length>0&&(f=getEntityAttributes(u[0].EntityName,i),f.length>0&&(r=f.filter(function(n){return n.ID==s[e]}),r.length>0&&r[0].Value&&(o=f.filter(function(n){return n.Value==r[0].Value.replace("_value","_id")}),o&&o.length>0&&(h=o[0].CodeID)),r.length>0&&r[0].Entity&&(u=i.filter(function(n){return n.ID==r[0].Entity}))));return h}function getEntityAttributes(n,t){for(var u=[],r=n,i,n;r;)i=t.filter(function(n){return n.ID==r}),i&&i.length>0&&i[0].Attributes.length>0&&(u=u.concat(i[0].Attributes)),t&&(n=t.filter(function(n){return n.ID==r}),r=n.length>0?n[0].ParentId:"");return u}function GetCodeIDForLookup(n,t,i){var e="",r,u,f;return n&&(r=i.filter(function(t){return t.ID==n}),r&&r.length>0&&r[0].Attributes.length>0&&(u=r[0].Attributes.filter(function(n){return n.Value==t}),u.length>0&&u[0].Value&&(f=r[0].Attributes.filter(function(n){return n.Value==u[0].Value.replace("_value","_id")}),f&&f.length>0&&(e=f[0].CodeID)))),e}function GetFieldFromFormObject(n,t,i,r,u){var f,e,o;if(u&&u.length>0)return u;if(n)for(f=0;f<n.Elements.length;f++){if(e=n.Elements[f],o=e.Elements.filter(function(n){return n.Name==t&&n.dictAttributes[i]==r}),o.length>0)return o;u=GetFieldFromFormObject(e,t,i,r,u)}return u}function GetTableKeyFields(n,t){var r="",i;return n&&(i=t.filter(function(t){return t.ID==n}),i&&i.length>0&&i[0].Attributes.length>0&&angular.forEach(i[0].Attributes,function(n){var t=n.KeyNo;t>0&&(r.length==0?r=n.ID:r+=","+n.ID)})),r}function PopulateAvailableFields(n,t,i,r,u,f){var e="";t&&angular.forEach(t.Elements,function(t){angular.forEach(t.Elements,function(t){t&&angular.forEach(t.Elements,function(t){var a,v,h,c,y,l,s,o;if(t.Name=="sfwPanel")e=t.dictAttributes.sfwCaption,(e==""||e==undefined)&&(e=t.dictAttributes.ID),o={Text:e,Items:[],IsSelected:!1,IsCheckBoxVisible:r},angular.forEach(t.Elements,function(t){PopulateAvailableFields(n,t,o,r,u,f)}),o.Items.length>0&&i.Items.push(o);else if(t.Name=="sfwTabContainer")e=t.dictAttributes.HeaderText,(e==""||e==undefined)&&(e=t.dictAttributes.ID),o={Text:e,Items:[],IsSelected:!1,IsCheckBoxVisible:r},a=t.Elements[0],a&&angular.forEach(a.Elements,function(t){t.Elements.length>0&&t.Elements[0].Name=="sfwTable"&&PopulateAvailableFields(n,t.Elements[0],o,r,u,f)}),o.Items.length>0&&i.Items.push(o);else if(t.Name=="sfwGridView"){if(v=t.dictAttributes.ID,o={Text:v,Items:[],IsSelected:!1,IsCheckBoxVisible:r},t.Elements.length>0&&t.Elements[0].Name=="Columns"){for(h=0;h<t.Elements[0].Elements.length;h++)c=t.Elements[0].Elements[h],c.Elements.length>0&&c.Elements[0].Name=="ItemTemplate"&&(y=c.Elements[0],angular.forEach(y.Elements,function(n){var t="";t=n.dictAttributes.sfwEntityField;t!=undefined&&t!=""&&o.Items.push({Text:t,Items:[],IsSelected:!1,IsCheckBoxVisible:r})}));o.Items.length>0&&i.Items.push(o)}}else t.Name=="sfwWizard"?(l=t.Elements.filter(function(n){return n.Name=="WizardSteps"}),l&&l.length>0&&angular.forEach(l[0].Elements,function(t){var s=t.Name=="HeaderTemplate"?t:undefined,o;s?(e="HeaderTemplate",o={Text:e,Items:[],IsSelected:!1,IsCheckBoxVisible:!1},s.Elements.length>0&&(PopulateAvailableFields(n,s.Elements[0],o,r,u,f),o.Items.length>0&&i.Items.push(o))):angular.forEach(t.Elements,function(t){e=t.dictAttributes.Title;(e==""||e==undefined)&&(e=t.dictAttributes.ID);var o={Text:e,Items:[],IsSelected:!1,IsCheckBoxVisible:!1};t.Elements.length>0&&(PopulateAvailableFields(n,t,o,r,u,f),o.Items.length>0&&i.Items.push(o))})})):(s="",u&&!IsCriteriaField(t)&&n=="sfwDataField"&&(n="sfwEntityField"),s=t.dictAttributes[n],(!f||f&&t.Name!=="sfwButton"&&t.Name!=="sfwLinkButton"&&t.Name!=="sfwImageButton")&&(o={Text:s,Items:[],IsSelected:!1,IsCheckBoxVisible:r},s!=undefined&&s!=""&&i.Items.push(o)))})})})}function PopulateAvailableFieldsForFormLink(t,i,r,u){var f="";angular.forEach(i.Elements,function(i){var l,a,s,h,v,c,o,e;if(i.Name=="items")PopulateAvailableFieldsForFormLink(t,i,r);else if(i.Name=="sfwPanel")f=i.dictAttributes.sfwCaption,(f==""||f==undefined)&&(f=i.dictAttributes.ID),e={Text:f,Items:[],IsSelected:!1},angular.forEach(i.Elements,function(n){PopulateAvailableFieldsForFormLink(t,n,e,u)}),e.Items.length>0&&r.Items.push(e);else if(i.Name=="sfwTabContainer")f=i.dictAttributes.HeaderText,(f==""||f==undefined)&&(f=i.dictAttributes.ID),e={Text:f,Items:[],IsSelected:!1,IsCheckBoxVisible:u},l=i.Elements[0],l&&angular.forEach(l.Elements,function(n){PopulateAvailableFieldsForFormLink(t,n,e,u)}),e.Items.length>0&&r.Items.push(e);else if(i.Name=="sfwGridView"){if(a=i.dictAttributes.ID,e={Text:a,Items:[],IsSelected:!1},i.Elements.length>0&&i.Elements[0].Name=="Columns"){for(s=0;s<i.Elements[0].Elements.length;s++)h=i.Elements[0].Elements[s],h.Elements.length>0&&h.Elements[0].Name=="ItemTemplate"&&(v=h.Elements[0],angular.forEach(v.Elements,function(n){var t="";t=n.dictAttributes.sfwEntityField;t!=undefined&&t!=""&&e.Items.push({Text:t,Items:[],IsSelected:!1,IsCheckBoxVisible:u})}));e.Items.length>0&&r.Items.push(e)}}else i.Name=="sfwWizard"?(c=i.Elements.filter(function(n){return n.Name=="items"}),c&&c.length>0&&angular.forEach(c[0].Elements,function(n){var e=n.Name=="HeaderTemplate"?n:undefined,i;e?(f="HeaderTemplate",i={Text:f,Items:[],IsSelected:!1,IsCheckBoxVisible:!1},e.Elements.length>0&&(PopulateAvailableFieldsForFormLink(t,e.Elements[0],i,u),i.Items.length>0&&r.Items.push(i))):angular.forEach(n.Elements,function(i){f=n.dictAttributes.Title;f&&f!=""||(f=n.dictAttributes.ID);var e={Text:f,Items:[],IsSelected:!1,IsCheckBoxVisible:!1};i.Elements.length>0&&(PopulateAvailableFieldsForFormLink(t,i,e,u),e.Items.length>0&&r.Items.push(e))})})):(o="",o=i.dictAttributes[t],e=n={Text:o,Items:[],IsSelected:!1,IsCheckBoxVisible:!0},o&&o!=""&&r.Items.push(e))})}function GetFormLinkItemsModel(n,t){var i={Name:"sfwLabel",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]};return(i=t.Elements.filter(function(n){return n.Name.toLowerCase()=="items"}),i&&i.length>0)?i[0]:i}function SetFormSelectedControl(n,t,i){n&&t&&(n.SelectedControl&&(n.SelectedControl.IsSelected=!1,(n.SelectedControl.Name=="sfwPanel"||n.SelectedControl.Name=="sfwDialogPanel"||n.SelectedControl.Name=="sfwListView")&&(n.SelectedControl.IsVisible=!1)),n.SelectedControl=t,n.SelectedControl.IsSelected=!0,(n.SelectedControl.Name=="sfwPanel"||n.SelectedControl.Name=="sfwDialogPanel"||n.SelectedControl.Name=="sfwListView")&&(n.SelectedControl.IsVisible=!0));i&&i.stopPropagation()}function GetCaptionFromFieldName(n){var t,r,i,u,f;if(n){for(startsWith(n,"icdo",0)&&(n=n.replace("icdo","")),t="",r=!0,i=0;i<n.length;i++)"._".contains(""+n[i])?(r=!0,t+=" "):(t+=r?n.toUpperCase()[i]:n[i],r=!1);endsWith(t," Id")&&(t=t.replace(" Id"," ID"));t.contains("Ssn")&&(t=t.replace("Ssn","SSN"));u=t.indexOf(" Value");u>0&&(t=t.substring(0,u));f=t.indexOf(" Description");f>0&&(t=t.substring(0,f))}return t}function GetCaptionFromField(n){if(n)return n.Caption&&n.Caption.trim().length>0?n.Caption:GetCaptionFromFieldName(n.ID)}function CreateControl(n,t,i,r){var u=i.split("."),f="",e="";return null!=u&&(f=u[0],u.length==2&&(e=u[1])),CreateControlWithMethod(n,f,e,t,r)}function CreateControlWithMethod(n,t,i,r,u){var f=null,e,o;switch(t){case"Panel":f=AddNewPanel(n,"sfwPanel",t,"NewPanel",r);break;case"DialogPanel":f=AddNewPanel(n,"sfwDialogPanel",t,"DialogPanel",r);break;case"TabContainer":f=CreateTabContainer(n,r);break;case"UserControl":f={Name:"udc",value:"",prefix:"",dictAttributes:{},Elements:[],Children:[]};f.ParentVM=r;f.dictAttributes.ID=GetControlID(n,f.Name);break;case"Caption":o="swc";f={Name:"sfwLabel",value:"",prefix:o,dictAttributes:{},Elements:[],Children:[]};f.ParentVM=r;f.dictAttributes.ID=GetControlIDForCaption(n,f.Name,!0);f.dictAttributes.sfwIsCaption="True";break;case"sfwSwitchCheckBox":o="swc";f={Name:"sfwCheckBox",value:"",prefix:o,dictAttributes:{sfwIsSwitch:"True"},Elements:[],Children:[]};f.ParentVM=r;f.dictAttributes.ID=GetControlID(n,f.Name);break;default:e=t;o="";t=="sfwCommandButton"?(e="sfwCommandButton",o="swc"):t=="sfwEmployerSoftErrors"?(e="sfwSoftErrors",o="swc"):t=="br"||t=="hr"?e=t:(e=t,o="swc");f={Name:e,value:"",prefix:o,dictAttributes:{},Elements:[],Children:[]};f.ParentVM=r;u?u&&e&&e=="sfwCascadingDropDownList"&&(f.dictAttributes.ID=GetControlID(n,f.Name)):f.dictAttributes.ID=GetControlID(n,f.Name);e&&e==="sfwDateTimePicker"&&(f.dictAttributes.sfwDataFormat="{0:d}");CheckAndSetControlDefaultValues(n,f,f.Name,i,t)}return f}function CreateTabContainer(n,t){var u="swc",o={Name:"sfwTabContainer",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},s,f,e,r,i;return o.ParentVM=t,o.dictAttributes.ID=CreateControlID(n,"sfwTabContainer","sfwTabContainer",!1),s={Name:"Tabs",value:"",prefix:"",dictAttributes:{},Elements:[],Children:[]},s.ParentVM=o,o.Elements.push(s),f={Name:"sfwTabSheet",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},f.ParentVM=s,f.dictAttributes.ID=CreateControlID(n,"NewPage","sfwTabSheet",!1),f.dictAttributes.HeaderText="New Page",s.Elements.push(f),e={Name:"sfwTable",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},e.ParentVM=f,e.dictAttributes.ID=CreateControlID(n,"Table","sfwTable",!1),f.Elements.push(e),r={Name:"sfwRow",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},r.ParentVM=e,i={Name:"sfwColumn",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},i.ParentVM=r,r.Elements.push(i),i={Name:"sfwColumn",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},i.ParentVM=r,r.Elements.push(i),i={Name:"sfwColumn",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},i.ParentVM=r,r.Elements.push(i),i={Name:"sfwColumn",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},i.ParentVM=r,r.Elements.push(i),e.Elements.push(r),o}function AddNewPanel(n,t,i,r,u){var o="swc",s={Name:t,value:"",prefix:o,dictAttributes:{},Elements:[],Children:[]},c,h,f,e;return s.ParentVM=u,s.dictAttributes.ID=CreateControlID(n,r,t,!1),s.dictAttributes.sfwCaption="New Page",c=CreateControlID(n,"NewPage","sfwTable",!1),h={Name:"sfwTable",value:"",prefix:o,dictAttributes:{},Elements:[],Children:[]},h.ParentVM=s,h.dictAttributes.ID=c,f={Name:"sfwRow",value:"",prefix:o,dictAttributes:{},Elements:[],Children:[]},f.ParentVM=h,e={Name:"sfwColumn",value:"",prefix:o,dictAttributes:{},Elements:[],Children:[]},f.ParentVM=f,f.Elements.push(e),e={Name:"sfwColumn",value:"",prefix:o,dictAttributes:{},Elements:[],Children:[]},f.ParentVM=f,f.Elements.push(e),e={Name:"sfwColumn",value:"",prefix:o,dictAttributes:{},Elements:[],Children:[]},f.ParentVM=f,f.Elements.push(e),e={Name:"sfwColumn",value:"",prefix:o,dictAttributes:{},Elements:[],Children:[]},f.ParentVM=f,f.Elements.push(e),h.Elements.push(f),s.Elements.push(h),s}function CheckAndSetControlDefaultValues(n,t,i,r,u){var f,e;t.Name=="sfwImageButton"&&(t.dictAttributes.sfwMethodName="btnRetrieve_Click",t.dictAttributes.ImageUrl="~/Image/Lookup.jpg",t.dictAttributes.ImageAlign="AbsMiddle");t.Name=="sfwSoftErrors"?u=="sfwSoftErrors"?t.dictAttributes.sfwEntityField="InternalErrors":u=="sfwEmployerSoftErrors"&&(t.dictAttributes.sfwEntityField="ExternalErrors"):u!="sfwCommandButton"&&(t.Name=="sfwButton"||t.Name=="sfwLinkButton"||t.Name=="sfwImageButton")?CheckAndSetSfwButtonDefaultValues(n,t,r):u=="sfwCommandButton"?(f="Cancel",t.dictAttributes.CommandName=f,e=CreateControlID(n,f,"sfwButton",!1),t.dictAttributes.Text=f,t.dictAttributes.ID=e,t.dictAttributes.sfwCheckChanges="True"):u=="sfwCheckBox"?t.dictAttributes.sfwIsSwitch="False":t.Name==="sfwTextBox"||t.Name==="sfwLabel"?t.dictAttributes.sfwRenderType="None":t.Name==="sfwCheckBoxList"&&(t.dictAttributes.sfwDisplayInDialog="True")}function GetControlIDForCaption(n,t,i){var r=t;return startsWith(r,"sfw",0)&&(r=r.substring(3)),CreateControlID(n,r,t,i)}function GetControlID(n,t){var i=t;return startsWith(i,"sfw",0)&&(i=i.substring(3)),CreateControlID(n,i,t,!1)}function CheckAndSetSfwButtonDefaultValues(n,t,i){var r,u,e,f;if(i){r="";u="";switch(i){case"btnNew_Click":r="New";break;case"btnDelete_Click":r="Delete";break;case"btnColumnsToExport_Click":r="Export To Excel";break;case"btnNewUpdate_Click":r="New Update";break;case"btnOpenLookup_Click":r="Open Lookup";break;case"btnOpen_Click":r="Open";break;case"btnOpenDoc_Click":r="Open Document";break;case"btnApplySort_Click":r="Apply Sort";break;case"btnReset_Click":r="Reset";break;case"btnSearch_Click":r="Search";break;case"btnSearchCriteriaRequired_Click":r="Search Criteria";break;case"btnStoreUserDefaults_Click":r="Store Defaults";break;case"btnAddNewChild_Click":r="Add New Child";break;case"btnAuditHistory_Click":r="Audit History";e="primary_key=;form_name=#"+n.dictAttributes.ID;t.dictAttributes.sfwActiveForm="wfmAuditMaintenance";t.dictAttributes.sfwNavigationParameter=e;break;case"btnCorrespondence_Click":r="Correspondence";break;case"btnDownload_Click":r="Download";break;case"btnExecuteBusinessMethodSelectRows_Click":r="Execute Pass Selected Rows";break;case"btnValidateExecuteBusinessMethod_Click":r="Execute Refresh From Object";break;case"btnExecuteBusinessMethod_Click":r="Execute Refresh Data";break;case"btnExecuteServerMethod_Click":r="Execute Server Method";break;case"btnForceSave_Click":r="Force Save";break;case"btnNext_Click":r="Next Record";break;case"btnPrev_Click":r="Previous Record";break;case"btnCancel_Click":r="Refresh Data";break;case"btnRefreshServers_Click":r="Refresh Servers";break;case"btnSaveAndNext_Click":r="Save And Next";break;case"btnSaveNew_Click":r="Save And New";break;case"btnSave_Click":r="Save";break;case"btnSaveIgnoreReadOnly_Click":r="Save ReadOnly";break;case"btnNoChangesSave_Click":r="Save No Changes";break;case"btnGridViewAdd_Click":r="Add";break;case"btnGridViewUpdate_Click":r="Update";break;case"btnGridViewSelect_Click":r="Select";break;case"btnGridViewDelete_Click":r="Delete";break;case"btnWizardPrevious_Click":r="Previous";break;case"btnWizardSaveAndPrevious_Click":r="Previous";u="Save And Previous";break;case"btnWizardNext_Click":r="Next";break;case"btnWizardFindAndNext_Click":r="Next";u="Find And Next";break;case"btnWizardSaveAndNext_Click":r="Next";u="Save And Next";break;case"btnWizardFinish_Click":r="Finish";break;case"btnPdfCorrespondence_Click":r="PDF Correspondence";t.dictAttributes.sfwTriggerPostBack="True";break;case"btnBpmApprove_Click":r="BPM Approve";t.dictAttributes.sfwMode="Update";t.dictAttributes.sfwRefreshUpdatePanels="uppWorkflowNew;uppCenterMiddle";break;case"btnBpmReject_Click":r="BPM Reject";t.dictAttributes.sfwMode="Update";t.dictAttributes.sfwRefreshUpdatePanels="uppWorkflowNew;uppCenterMiddle";break;case"btnBpmSubmit_Click":r="BPM Submit";t.dictAttributes.sfwMode="Update";t.dictAttributes.sfwRefreshUpdatePanels="uppWorkflowNew;uppCenterMiddle";break;default:r=i.replace("btn","")}t.dictAttributes.sfwMethodName=i;r!=undefined&&r!=""&&((u==undefined||u=="")&&(u=r),t.dictAttributes.Text=r,f="",f=CreateControlID(n,u,t.Name),t.dictAttributes.ID=f)}}function GetMaxColCount(n,t){var i=n.Elements.length;return t&&angular.forEach(t.Elements,function(n){n.Elements.length>i&&(i=n.Elements.length)}),i}function CreateControlIDInCamelCase(n){var t="",r=!0;for(i=0;i<n.length;i++)"~`!@#$%^&*_-–+=[{()}]|:;<,.>?/. ".contains(""+n[i])?r=!0:(t+=r?n.toUpperCase()[i]:n[i],r=!1);return(t.toLowerCase().indexOf("iclb")>-1&&t.toLowerCase().startsWith("iclb")||t.toLowerCase().indexOf("icol")>-1&&t.toLowerCase().startsWith("icol"))&&(t=t.substring(4)),t}function SetDefultValuesBasedOnDataType(n,t,i){(t=="sfwLabel"||t=="sfwTextBox"||t=="sfwDateTimePicker")&&(t=="sfwLabel"&&n.Value&&(n.Value.toLowerCase()=="created_date"||n.Value.toLowerCase()=="modified_date")?i.dictAttributes.sfwDataFormat="{0:G}":n.DataType&&(n.DataType.toLowerCase()=="datetime"||n.DataType.toLowerCase()=="date")?i.dictAttributes.sfwDataFormat="{0:d}":n.DataType=="Decimal"&&endsWith(n.Value,"_amt")||endsWith(n.Value,"_amount")?i.dictAttributes.sfwDataFormat="{0:C}":n.Value.contains("ssn")?i.dictAttributes.sfwDataFormat="{0:000-##-####}":(n.Value.contains("phone")||n.Value.contains("fax"))&&(i.dictAttributes.sfwDataFormat="{0:(###)###-####}"))}function CreateControlID(n,t,i,r){var u=CreateControlIDWithPrefix(n,t,i,r);if(u=="")return"";if(n)for(var f=FindControlByID(n,u),e=0,o=u;f!=null;)e++,u=String.format("{0}{1}",o,e),f=FindControlByID(n,u);return u}function CreateControlIDWithPrefix(n,t,i,r){var u="";return u=getControlIDPrefix(i,r),startsWith(t,u,0)&&(t=t.substring(u.length)),u.length>0&&(u+=CreateActualControlID(t)),u}function getControlIDPrefix(n,t){var i="";switch(n){case"sfwTable":i="tbl";break;case"sfwPanel":i="pnl";break;case"sfwTabContainer":i="tct";break;case"sfwTabSheet":i="tsh";break;case"sfwLabel":i=t?"cap":"lbl";break;case"sfwLiteral":i="ltr";break;case"sfwCheckBox":i="chk";break;case"sfwTextBox":i="txt";break;case"sfwDropDownList":case"sfwMultiSelectDropDownList":i="ddl";break;case"sfwCheckBoxList":i="cbl";break;case"sfwRadioButtonList":i="rbl";break;case"sfwGridView":i="grv";break;case"sfwButton":case"sfwToolTipButton":i="btn";break;case"sfwLinkButton":i="btn";break;case"sfwImageButton":i="btn";break;case"sfwFileLayout":i="flo";break;case"RequiredFieldValidator":i="rfv";break;case"CompareValidator":i="cmv";break;case"RangeValidator":i="rnv";break;case"RegularExpressionValidator":i="rev";break;case"ValidationSummary":i="vls";break;case"sfwRadioButton":i="rdb";break;case"sfwMultiCorrespondence":i="mcr";break;case"sfwCRViewer":i="crv";break;case"sfwHyperLink":i="hyp";break;case"sfwFileUpload":i="flu";break;case"sfwSoftErrors":i="egr";break;case"sfwListBox":i="lst";break;case"sfwImage":i="img";break;case"sfwWizard":i="wiz";break;case"sfwWizardStep":i="wzs";break;case"sfwCascadingDropDownList":i="ddl";break;case"sfwListPicker":i="lv";break;case"sfwTargetList":i="lv";break;case"sfwSourceList":i="lv";break;case"sfwChart":i="chrt";break;case"sfwSeries":i="ser";break;case"sfwChartArea":i="chrta";break;case"sfwDialogPanel":i="pnl";break;case"udc":case"UserControl":i="UserControl";break;case"sfwListView":i="lst";break;case"sfwRuleViewer":i="rvw";break;case"sfwSlider":i="sld";break;case"sfwQuestionnairePanel":i="qnp";break;case"sfwDateTimePicker":i="dtp";break;case"sfwKnob":i="knb";break;case"sfwCalendar":i="cal";break;case"hr":case"br":i=n;break;case"sfwUserDefaults":i="uds";break;case"sfwOpenDetail":i="od";break;case"sfwWizardProgress":i="wp";break;case"sfwJSONData":i="jdata";break;case"sfwScheduler":i="sch";break;case"sfwButtonGroup":i="btngrp";break;case"sfwCaptcha":i="cpt"}return i}function CreateActualControlID(n){for(var t="",r=!0,i=0;i<n.length;i++)"~`!@#$%^&*_-–+=[{()}]|:;<,.>?/. ".indexOf(""+n[i])!==-1?r=!0:(t+=r?n.toUpperCase()[i]:n[i],r=!1);return(startsWith(t.toLowerCase(),"iclb",0)||startsWith(t.toLowerCase(),"icol",0))&&(t=t.substring(4)),t}function FindParent(n,t,i){var u,r;if(n){if(u=null,n.Name===t&&i)u=n;else{for(r=n.ParentVM;r&&r.Name!=t;)r=r.ParentVM;u=r}return u}}function PopulateAssociatedControls(n){var u=[],r=[],f,e,t,o,i;return u.push(""),n.dictAttributes&&(f=n.dictAttributes.sfwEntityField,e=n.dictAttributes.sfwDataField,(f==undefined||f=="")&&(e==undefined||e=="")&&(t=n,t=FindParent(n,"sfwRow"),o=!1,t&&(i=-1,angular.forEach(t.Elements,function(u){(i++,o)||angular.forEach(u.Elements,function(u){if(u&&u.dictAttributes.ID==n.dictAttributes.ID){o=!0;r.push(t.Elements[i]);t.Elements.length>i+1&&t.Elements[i+1]!=undefined&&r.push(t.Elements[i+1]);return}})}),r!=undefined&&(r.length>0?angular.forEach(r,function(n){n&&n.Elements.length>0&&angular.forEach(n.Elements,function(n){if(!n.dictAttributes.sfwIsCaption){var t=n.dictAttributes.ID;t&&n.Name!="sfwGridView"&&n.Name!="sfwChart"&&n.Name!="sfwPanel"&&n.Name!="sfwDialogPanel"&&n.Name!="sfwButton"&&n.Name!="sfwTabContainer"&&n.Name!="sfwTabSheet"&&n.Name!="udc"&&n.Name!="sfwListViewer"&&u.push(t)}})}):u.push(""))))),u}function PopulateAssociatedControlsForRetriveButton(n){var r=[],f,e,t,u,o,i;return r.push(""),f=n.dictAttributes.sfwEntityField,e=n.dictAttributes.sfwDataField,(f==undefined||f=="")&&(e==undefined||e=="")&&(t=n,t=FindParent(n,"sfwRow"),o=!1,t!=undefined&&(i=-1,angular.forEach(t.Elements,function(r){(i++,o)||angular.forEach(r.Elements,function(r){if(r&&r.dictAttributes.ID==n.dictAttributes.ID){o=!0;t.Elements.length>i+1&&t.Elements[i]!=undefined&&(u=t.Elements[i]);return}})}),u!=undefined&&(u.Elements.length>0?angular.forEach(u.Elements,function(n){var t=n.dictAttributes.ID;t!=undefined&&t!=""&&(n.Name=="sfwLabel"||n.Name=="sfwTextBox"||n.Name=="sfwDropDownList"||n.Name=="sfwMultiSelectDropDownList"||n.Name=="sfwCheckBoxList"||n.Name=="sfwRadioButtonList"||n.Name=="sfwCheckBox"||n.Name=="sfwRadioButton"||n.Name=="sfwCascadingDropDownList")&&r.push(t)}):r.push("")))),r}function PopulateRelatedGrid(n,t,i){var u,r;i?((n.Name=="sfwButton"||n.Name=="sfwLinkButton"||n.Name=="sfwImageButton")&&(n.dictAttributes.sfwMethodName=="btnGridSearch_Click"||n.dictAttributes.sfwMethodName=="btnGridSearchCriteriaReq_Click")&&(u=n.dictAttributes.ID,u&&u.length>0&&t.push(u)),angular.forEach(n.Elements,function(n){PopulateRelatedGrid(n,t,!0)})):((n.Name=="sfwGridView"||n.Name=="sfwScheduler")&&(r=n.dictAttributes.ID,r&&r.length>0&&!r.match("^idsfw")&&t.push(r)),angular.forEach(n.Elements,function(n){PopulateRelatedGrid(n,t)}))}function PopulateEntityRules(n,t,i){var e=[],o,r,s,u,h,f;return i!=undefined&&i!=""?(r=n.lstGroupsList,r&&r.length>0&&(o=r[0]),o!=null&&(u=o.Elements.filter(function(n){return n.dictAttributes.ID==i}),u&&u.length>0&&(s=u[0]),s&&angular.forEach(s.Elements,function(n){e.push(n.dictAttributes.ID)}))):n&&(f=n.lstInitialLoadList,f&&f.length>0&&(h=f[0]),h&&angular.forEach(h.Elements,function(n){e.push(n.dictAttributes.ID)})),e}function IsAuditField(n){return(n=n.toLowerCase(),n=="created_by")?!0:n=="created_date"?!0:n=="modified_by"?!0:n=="modified_date"?!0:n=="update_seq"?!0:!1}function FindControlByID(n,t){var i;return t&&t!=""&&n.dictAttributes.ID==t?i=n:(angular.forEach(n.Elements,function(n){i==undefined&&(i=FindControlByID(n,t))}),i)}function CheckforDuplicateID(n,t,i){n.dictAttributes.ID!=undefined&&n.dictAttributes.ID!=""&&n.dictAttributes.ID==t&&i.push(t);angular.forEach(n.Elements,function(n){CheckforDuplicateID(n,t,i)})}function GetBuisnessRules(n,t,i,r,u){var s=[],f,e,h,o;return n!=null&&(u&&n.lstGroupsList?(f=n.lstGroupsList[0],f&&f.Elements.length>0&&angular.forEach(f.Elements,function(n){n.dictAttributes.ID==r&&angular.forEach(n.Elements,function(n){s.push(n.dictAttributes.ID)})})):n.Elements.length>0&&(e=n.Elements.filter(function(n){return n.Name==t}),e&&e.length>0&&(h=e[0],h!=null&&(o=[],GetRulesList(h,i,o),null!=o&&angular.forEach(o,function(n){s.push(n.dictAttributes.ID)}))))),s}function GetRulesList(n,t,i){n.Name==t&&i.push(n);angular.forEach(n.Elements,function(n){GetRulesList(n,t,i)});angular.forEach(n.Children,function(n){GetRulesList(n,t,i)})}function FindControlListByNameForTextBox(n,t,i,r){t&&t!=""&&n&&n.Name==t&&r&&r.SelectedControl&&r.SelectedControl.Name==t&&r.SelectedControl.dictAttributes.ID&&r.SelectedControl.dictAttributes.ID!=n.dictAttributes.ID&&i.push(n);angular.forEach(n.Elements,function(n){n.Name!="sfwGridView"&&FindControlListByNameForTextBox(n,t,i,r)})}function FindControlListByName(n,t,i){t&&t!=""&&n&&n.Name==t&&i.push(n);n&&angular.forEach(n.Elements,function(n){n.Name!="sfwGridView"&&FindControlListByName(n,t,i)})}function FindCaptionControlList(n,t){n&&n.Name=="sfwLabel"&&n.dictAttributes&&n.dictAttributes.sfwIsCaption&&n.dictAttributes.sfwIsCaption.toLowerCase()=="true"&&t.push(n);angular.forEach(n.Elements,function(n){n.Name!="sfwGridView"&&FindCaptionControlList(n,t)})}function FindControlListByNames(n,t,i){t&&t.length>0&&n&&t.some(function(t){return t==n.Name})&&i.push(n);angular.forEach(n.Elements,function(n){n.Name!="sfwGridView"&&FindControlListByNames(n,t,i)})}function PopulateRelatedDialogList(n,t){var i=[];return i.push(""),n!=null&&PopulateRelatedDialogs(n,i,t),i}function PopulateRelatedDialogs(n,t,i){n!=null&&angular.forEach(n.Elements,function(n){var r,u;n.Name=="sfwDialogPanel"?(r=n.dictAttributes.ID,r.length>0&&t.push(r)):n.Name=="sfwWizardStep"?i&&(u=FindParent(i,"sfwWizardStep"),u&&n.dictAttributes.ID==u.dictAttributes.ID&&n.Elements.length>0&&PopulateRelatedDialogs(n,t,i)):PopulateRelatedDialogs(n,t,i)})}function PopulateServerMethod(n,t,i,r){var u=[];return u.push(""),t.dictAttributes.sfwMethodName=="btnExecuteServerMethod_Click"||t.dictAttributes.sfwMethodName=="btnWizardFindAndNext_Click"||t.dictAttributes.sfwMethodName=="btnWorkflowExecuteMethod_Click"||t.dictAttributes.sfwMethodName=="btnDownload_Click"||t.dictAttributes.sfwMethodName=="btnExecuteServerMethodFromLookup_Click"||r?i&&angular.forEach(i.Elements,function(n){n.dictAttributes.ID&&u.push(n.dictAttributes.ID)}):(t.dictAttributes.sfwMethodName=="btnExecuteBusinessMethod_Click"||t.dictAttributes.sfwMethodName=="btnExecuteBusinessMethodSelectRows_Click"||t.dictAttributes.sfwMethodName=="btnValidateExecuteBusinessMethod_Click"||t.dictAttributes.sfwMethodName=="btnCopyRecord_Click"||t.dictAttributes.sfwMethodName=="btnGridSearchCriteriaReq_Click"||t.dictAttributes.sfwMethodName=="btnBack_Click"||t.dictAttributes.sfwMethodName=="btnCompleteWorkflowActivities_Click"||t.dictAttributes.sfwMethodName=="btnWizardCancel_Click"||t.dictAttributes.sfwMethodName=="btnCompleteWorkflowActivities_Click")&&angular.forEach(n,function(n){n.ID&&u.push(n.ID)}),u}function GetServerMethodObject(n,t){var r,i;return n!=undefined&&n!=""&&t&&t.length>0&&(i=t.filter(function(t){return t.dictAttributes.ID==n}),i&&i.length>0&&(r=i[0])),r}function IsCriteriaField(n){for(var i=!0,t=n.ParentVM;null!=t;){if(t.Name=="sfwGridView"){i=!1;break}t=t.ParentVM}return i}function LoadAttributeButton(n,t){var i=[];return t=="Lookup"||t=="FormLinkLookup"?n.dictAttributes.sfwMethodName=="btnNew_Click"||n.dictAttributes.sfwMethodName=="btnOpenDoc_Click"?(n.dictAttributes.sfwMethodName=="btnNew_Click"&&i.push("sfwActiveForm"),i.push("sfwCustomAttributes"),i.push("sfwNavigationParameter"),i.push("OnClientClick"),n.dictAttributes.sfwMethodName=="btnNew_Click"&&i.push("sfwEntityField"),n.dictAttributes.sfwMethodName=="btnNew_Click"||i.push("sfwRelatedControl"),i.push("sfwSecurityLevel"),i.push("Text"),i.push("sfwUserLogParameter"),i.push("Visible")):n.dictAttributes.sfwMethodName=="btnOpen_Click"||n.dictAttributes.sfwMethodName=="btnOpenLookup_Click"?(n.dictAttributes.sfwMethodName=="btnOpenLookup_Click"&&i.push("sfwActiveForm"),n.dictAttributes.sfwMethodName=="btnOpen_Click"&&(i.push("sfwActiveForm"),i.push("sfwFormTitleField"),i.push("sfwFormToolTipField")),i.push("sfwCustomAttributes"),i.push("sfwNavigationParameter"),i.push("OnClientClick"),n.dictAttributes.sfwMethodName=="btnOpen_Click"&&(i.push("sfwEntityField"),i.push("sfwRelatedControl")),i.push("sfwSecurityLevel"),n.dictAttributes.sfwMethodName=="btnOpen_Click"&&i.push("sfwSelection"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("Visible")):n.dictAttributes.sfwMethodName=="btnDelete_Click"||n.dictAttributes.sfwMethodName=="btnColumnsToExport_Click"||n.dictAttributes.sfwMethodName=="btnExportToExcel_Click"?(i.push("sfwCustomAttributes"),n.dictAttributes.sfwMethodName=="btnColumnsToExport_Click"||n.dictAttributes.sfwMethodName=="btnExportToExcel_Click"||i.push("sfwMessageId"),i.push("OnClientClick"),n.dictAttributes.sfwMethodName!="btnExportToExcel_Click"&&i.push("sfwRelatedControl"),i.push("sfwSecurityLevel"),n.dictAttributes.sfwMethodName=="btnColumnsToExport_Click"||n.dictAttributes.sfwMethodName=="btnExportToExcel_Click"||i.push("sfwSelection"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("Visible")):n.dictAttributes.sfwMethodName=="btnExecuteBusinessMethodSelectRows_Click"?(i.push("sfwCustomAttributes"),i.push("sfwMessageId"),i.push("sfwNavigationParameter"),i.push("OnClientClick"),i.push("sfwRelatedControl"),i.push("sfwSecurityLevel"),i.push("sfwSelection"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("Visible")):n.dictAttributes.sfwMethodName=="btnCorrespondenceRows_Click"||n.dictAttributes.sfwMethodName=="btnNewUpdate_Click"?(n.dictAttributes.sfwMethodName=="btnNewUpdate_Click"&&(i.push("sfwActiveForm"),i.push("sfwCustomAttributes"),i.push("sfwMessageId")),n.dictAttributes.sfwMethodName=="btnCorrespondenceRows_Click"&&(i.push("sfwActiveForm"),i.push("sfwCustomAttributes")),i.push("sfwNavigationParameter"),i.push("OnClientClick"),i.push("sfwSecurityLevel"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("Visible")):n.dictAttributes.sfwMethodName=="btnReset_Click"||n.dictAttributes.sfwMethodName=="btnSearch_Click"||n.dictAttributes.sfwMethodName=="btnSearchCriteriaRequired_Click"||n.dictAttributes.sfwMethodName=="btnStoreUserDefaults_Click"||n.dictAttributes.sfwMethodName=="btnApplySort_Click"?(i.push("sfwCustomAttributes"),i.push("sfwMessageId"),i.push("OnClientClick"),i.push("sfwObjectMethod"),n.dictAttributes.sfwMethodName=="btnApplySort_Click"&&i.push("sfwRelatedControl"),i.push("sfwSecurityLevel"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("Visible")):(i.push("sfwActiveForm"),i.push("sfwCustomAttributes"),i.push("sfwMessageId"),i.push("sfwNavigationParameter"),i.push("sfwObjectMethod"),i.push("OnClientClick"),i.push("sfwRelatedControl"),i.push("sfwSelection"),i.push("sfwSecurityLevel"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("Visible")):(t=="Maintenance"||t=="FormLinkMaintenance"||t=="FormLinkWizard")&&(n.dictAttributes.sfwMethodName=="btnColumnsToExport_Click"?(i.push("sfwCheckChanges"),i.push("sfwCustomAttributes"),n.Name=="sfwLinkButton"||i.push("sfwEnableRule"),i.push("sfwMode"),i.push("OnClientClick"),i.push("sfwRelatedControl"),i.push("sfwResource"),i.push("sfwSecurityLevel"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("sfwVisibleRule"),i.push("Visible")):n.dictAttributes.sfwMethodName=="btnGridViewAddEmpty_Click"||n.dictAttributes.sfwMethodName=="btnGridViewDelete_Click"||n.dictAttributes.sfwMethodName=="btnGridViewDeleteLast_Click"||n.dictAttributes.sfwMethodName=="btnGridViewSelect_Click"?(i.push("sfwCheckChanges"),i.push("sfwCustomAttributes"),n.Name=="sfwLinkButton"||i.push("sfwEnableRule"),i.push("sfwMode"),i.push("sfwRelatedControl"),i.push("sfwResource"),i.push("sfwSecurityLevel"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("sfwVisibleRule"),i.push("Visible")):n.dictAttributes.sfwMethodName=="btnGridViewAdd_Click"||n.dictAttributes.sfwMethodName=="btnGridViewUpdate_Click"?(i.push("sfwCheckChanges"),i.push("sfwCustomAttributes"),n.Name=="sfwLinkButton"||i.push("sfwEnableRule"),i.push("sfwMode"),i.push("sfwRelatedControl"),i.push("sfwResource"),i.push("sfwSecurityLevel"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("sfwVisibleRule"),i.push("Visible")):n.dictAttributes.sfwMethodName=="btnNew_Click"?(i.push("sfwActiveForm"),i.push("sfwCheckChanges"),i.push("sfwCustomAttributes"),n.Name=="sfwLinkButton"||i.push("sfwEnableRule"),i.push("sfwMode"),i.push("sfwNavigationParameter"),i.push("OnClientClick"),i.push("sfwResource"),i.push("sfwSecurityLevel"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("sfwVisibleRule"),i.push("Visible")):n.dictAttributes.sfwMethodName=="btnDelete_Click"?(i.push("sfwCheckChanges"),i.push("sfwCustomAttributes"),n.Name=="sfwLinkButton"||i.push("sfwEnableRule"),i.push("sfwMessageId"),i.push("sfwMode"),i.push("OnClientClick"),i.push("sfwRelatedControl"),i.push("sfwResource"),i.push("sfwSecurityLevel"),i.push("sfwSelection"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("sfwVisibleRule"),i.push("Visible")):n.dictAttributes.sfwMethodName=="btnExportToExcel_Click"?(i.push("sfwCheckChanges"),i.push("sfwCustomAttributes"),n.Name=="sfwLinkButton"||i.push("sfwEnableRule"),i.push("sfwMode"),i.push("OnClientClick"),i.push("sfwResource"),i.push("sfwSecurityLevel"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("sfwVisibleRule"),i.push("Visible")):n.dictAttributes.sfwMethodName=="btnCorrespondenceRows_Click"||n.dictAttributes.sfwMethodName=="btnOpenLookup_Click"||n.dictAttributes.sfwMethodName=="btnAuditHistory_Click"?((n.dictAttributes.sfwMethodName=="btnCorrespondenceRows_Click"||n.dictAttributes.sfwMethodName=="btnOpenLookup_Click")&&i.push("sfwActiveForm"),n.dictAttributes.sfwMethodName=="btnAuditHistory_Click"&&i.push("sfwActiveForm"),i.push("sfwCheckChanges"),i.push("sfwCustomAttributes"),n.Name=="sfwLinkButton"||i.push("sfwEnableRule"),i.push("sfwMode"),i.push("sfwNavigationParameter"),i.push("OnClientClick"),i.push("sfwResource"),i.push("sfwSecurityLevel"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("sfwVisibleRule"),i.push("Visible")):n.dictAttributes.sfwMethodName=="btnNewUpdate_Click"?(i.push("sfwActiveForm"),i.push("sfwCheckChanges"),i.push("sfwCustomAttributes"),n.Name=="sfwLinkButton"||i.push("sfwEnableRule"),i.push("sfwMode"),i.push("sfwNavigationParameter"),i.push("OnClientClick"),i.push("sfwResource"),i.push("sfwSecurityLevel"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("sfwVisibleRule"),i.push("Visible")):n.dictAttributes.sfwMethodName=="btnOpen_Click"||n.dictAttributes.sfwMethodName=="btnPrototypeSearch_Click"?(i.push("sfwActiveForm"),i.push("sfwCheckChanges"),i.push("sfwCustomAttributes"),n.Name=="sfwLinkButton"||i.push("sfwEnableRule"),n.dictAttributes.sfwMethodName=="btnPrototypeSearch_Click"&&i.push("sfwMessageId"),i.push("sfwMode"),i.push("sfwNavigationParameter"),i.push("OnClientClick"),n.dictAttributes.sfwMethodName=="btnPrototypeSearch_Click"&&i.push("sfwObjectMethod"),n.dictAttributes.sfwMethodName=="btnOpen_Click"&&(i.push("sfwEntityField"),i.push("sfwFormTitleField"),i.push("sfwFormToolTipField")),i.push("sfwRelatedControl"),i.push("sfwResource"),i.push("sfwSecurityLevel"),i.push("sfwSelection"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("sfwVisibleRule"),i.push("Visible")):n.dictAttributes.sfwMethodName=="btnGridSearch_Click"?(i.push("sfwCheckChanges"),i.push("sfwCustomAttributes"),n.Name=="sfwLinkButton"||i.push("sfwEnableRule"),i.push("sfwMode"),i.push("sfwNavigationParameter"),i.push("OnClientClick"),i.push("sfwRelatedControl"),i.push("sfwResource"),i.push("sfwSecurityLevel"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("sfwVisibleRule"),i.push("sfwMessageId"),i.push("Visible")):n.dictAttributes.sfwMethodName=="btnForceSave_Click"||n.dictAttributes.sfwMethodName=="btnSaveNew_Click"||n.dictAttributes.sfwMethodName=="btnSaveAndNext_Click"||n.dictAttributes.sfwMethodName=="btnSave_Click"||n.dictAttributes.sfwMethodName=="btnSaveIgnoreReadOnly_Click"||n.dictAttributes.sfwMethodName=="btnNoChangesSave_Click"?(i.push("sfwCheckChanges"),i.push("sfwCustomAttributes"),n.Name=="sfwLinkButton"||i.push("sfwEnableRule"),i.push("sfwMessageId"),i.push("sfwMode"),i.push("sfwNavigationParameter"),i.push("OnClientClick"),i.push("sfwResource"),i.push("sfwSecurityLevel"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("sfwVisibleRule"),i.push("Visible")):n.dictAttributes.sfwMethodName=="btnOpenDoc_Click"?(i.push("sfwCheckChanges"),i.push("sfwCustomAttributes"),n.Name=="sfwLinkButton"||i.push("sfwEnableRule"),i.push("sfwMode"),i.push("sfwNavigationParameter"),i.push("OnClientClick"),i.push("sfwRelatedControl"),i.push("sfwResource"),i.push("sfwSecurityLevel"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("sfwVisibleRule"),i.push("Visible")):n.dictAttributes.sfwMethodName=="btnAddNewChild_Click"||n.dictAttributes.sfwMethodName=="btnClearControls_Click"||n.dictAttributes.sfwMethodName=="btnClosePopupDialog_Click"||n.dictAttributes.sfwMethodName=="btnCorrespondence_Click"||n.dictAttributes.sfwMethodName=="btnDownload_Click"||n.dictAttributes.sfwMethodName=="btnGridSearchCriteriaReq_Click"||n.dictAttributes.sfwMethodName=="btnFinishPopupDialog_Click"||n.dictAttributes.sfwMethodName=="btnLoadOnDemand_Click"||n.dictAttributes.sfwMethodName=="btnNewPopupDialog_Click"||n.dictAttributes.sfwMethodName=="btnNext_Click"||n.dictAttributes.sfwMethodName=="btnOpenDetail_Click"||n.dictAttributes.sfwMethodName=="btnOpenPopupDialog_Click"||n.dictAttributes.sfwMethodName=="btnPrev_Click"||n.dictAttributes.sfwMethodName=="btnCancel_Click"||n.dictAttributes.sfwMethodName=="btnRefreshServers_Click"||n.dictAttributes.sfwMethodName=="btnReturnMaintenance_Click"?(i.push("OnClientClick"),i.push("sfwCheckChanges"),i.push("sfwCustomAttributes"),n.Name=="sfwLinkButton"||i.push("sfwEnableRule"),n.dictAttributes.sfwMethodName=="btnNewPopupDialog_Click"||n.dictAttributes.sfwMethodName=="btnOpenPopupDialog_Click"||n.dictAttributes.sfwMethodName=="btnFinishPopupDialog_Click"||n.dictAttributes.sfwMethodName=="btnClosePopupDialog_Click"||i.push("sfwMessageId"),i.push("sfwMode"),n.dictAttributes.sfwMethodName=="btnNewPopupDialog_Click"||n.dictAttributes.sfwMethodName=="btnOpenPopupDialog_Click"||n.dictAttributes.sfwMethodName=="btnFinishPopupDialog_Click"||n.dictAttributes.sfwMethodName=="btnClosePopupDialog_Click"||n.dictAttributes.sfwMethodName=="btnCorrespondence_Click"||i.push("sfwObjectMethod"),n.dictAttributes.sfwMethodName=="btnCorrespondence_Click"&&i.push("sfwTriggerPostBack"),(n.dictAttributes.sfwMethodName=="btnAddNewChild_Click"||n.dictAttributes.sfwMethodName=="btnOpenPopupDialog_Click"||n.dictAttributes.sfwMethodName=="btnNewPopupDialog_Click"||n.dictAttributes.sfwMethodName=="btnFinishPopupDialog_Click"||n.dictAttributes.sfwMethodName=="btnClosePopupDialog_Click")&&(i.push("sfwRelatedControl"),n.dictAttributes.sfwMethodName=="btnAddNewChild_Click"||i.push("sfwRelatedDialogPanel")),i.push("sfwResource"),i.push("sfwSecurityLevel"),n.dictAttributes.sfwMethodName=="btnOpenPopupDialog_Click"&&i.push("sfwSelection"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("sfwVisibleRule"),i.push("Visible")):n.dictAttributes.sfwMethodName=="btnExecuteBusinessMethodSelectRows_Click"||n.dictAttributes.sfwMethodName=="btnValidateExecuteBusinessMethod_Click"||n.dictAttributes.sfwMethodName=="btnExecuteBusinessMethod_Click"||n.dictAttributes.sfwMethodName=="btnExecuteServerMethod_Click"||n.dictAttributes.sfwMethodName=="btnCompleteWorkflowActivities_Click"?(i.push("sfwCheckChanges"),i.push("sfwCustomAttributes"),n.Name=="sfwLinkButton"||i.push("sfwEnableRule"),i.push("sfwMessageId"),i.push("sfwMode"),i.push("sfwNavigationParameter"),n.dictAttributes.sfwMethodName!="btnExecuteServerMethod_Click"&&i.push("sfwObjectMethod"),i.push("OnClientClick"),n.dictAttributes.sfwMethodName=="btnExecuteBusinessMethodSelectRows_Click"&&i.push("sfwRelatedControl"),i.push("sfwResource"),i.push("sfwSecurityLevel"),n.dictAttributes.sfwMethodName=="btnExecuteServerMethod_Click"&&i.push("sfwObjectMethod"),n.dictAttributes.sfwMethodName=="btnExecuteBusinessMethodSelectRows_Click"&&i.push("sfwSelection"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("sfwVisibleRule"),i.push("Visible")):n.dictAttributes.sfwMethodName=="btnWorkflowExecuteMethod_Click"?(i.push("sfwCheckChanges"),i.push("sfwCustomAttributes"),n.Name=="sfwLinkButton"||i.push("sfwEnableRule"),i.push("sfwMessageId"),i.push("sfwMode"),n.dictAttributes.sfwMethodName!="btnCompleteWorkflowActivities_Click"&&i.push("sfwNavigationParameter"),i.push("sfwObjectMethod"),i.push("OnClientClick"),i.push("sfwRelatedControl"),i.push("sfwResource"),i.push("sfwSecurityLevel"),i.push("sfwSelection"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("sfwVisibleRule"),i.push("Visible"),i.push("sfwWorkflowActivities")):n.dictAttributes.sfwMethodName=="btnPdfCorrespondence_Click"?(i.push("sfwCheckChanges"),i.push("sfwCustomAttributes"),n.Name=="sfwLinkButton"||i.push("sfwEnableRule"),i.push("sfwMessageId"),i.push("sfwMode"),i.push("OnClientClick"),i.push("sfwDownloadFileName"),i.push("sfwRelatedControl"),i.push("sfwResource"),i.push("sfwSecurityLevel"),i.push("sfwTriggerPostBack"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("sfwVisibleRule"),i.push("Visible"),i.push("sfwNavigationParameter"),i.push("sfwNavigationParameter")):n.dictAttributes.sfwMethodName=="btnWizardCancel_Click"||n.dictAttributes.sfwMethodName=="btnWizardFindAndNext_Click"||n.dictAttributes.sfwMethodName=="btnWizardFinish_Click"||n.dictAttributes.sfwMethodName=="btnWizardNext_Click"||n.dictAttributes.sfwMethodName=="btnWizardPrevious_Click"||n.dictAttributes.sfwMethodName=="btnWizardSaveAndNext_Click"||n.dictAttributes.sfwMethodName=="btnWizardSaveAndPrevious_Click"?(i.push("sfwActiveForm"),i.push("sfwCheckChanges"),i.push("sfwCustomAttributes"),i.push("sfwMessageId"),i.push("sfwMode"),i.push("sfwNavigationParameter"),i.push("sfwObjectMethod"),i.push("sfwResource"),i.push("sfwSecurityLevel"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("sfwVisibleRule"),i.push("Visible"),n.Name=="sfwLinkButton"||i.push("sfwEnableRule")):n.dictAttributes.sfwMethodName=="btnGenerateReport_Click"?(i.push("sfwCheckChanges"),i.push("sfwCustomAttributes"),n.Name=="sfwLinkButton"||i.push("sfwEnableRule"),i.push("sfwMessageId"),i.push("sfwMode"),i.push("sfwObjectMethod"),i.push("OnClientClick"),i.push("sfwResource"),i.push("sfwSecurityLevel"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("sfwVisibleRule"),i.push("Visible")):n.dictAttributes.sfwMethodName=="btnMasterDetailHeader_Click"?(i.push("sfwCheckChanges"),i.push("sfwCustomAttributes"),n.Name=="sfwLinkButton"||i.push("sfwEnableRule"),i.push("sfwMessageId"),i.push("sfwMode"),i.push("sfwObjectMethod"),i.push("OnClientClick"),i.push("sfwResource"),i.push("sfwSecurityLevel"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("sfwVisibleRule"),i.push("Visible")):n.dictAttributes.sfwMethodName=="btnCopyRecord_Click"?(i.push("sfwCustomAttributes"),n.Name=="sfwLinkButton"||i.push("sfwEnableRule"),i.push("sfwExecuteAfterSuccess"),i.push("sfwMode"),i.push("sfwMessageId"),i.push("sfwNavigationParameter"),i.push("sfwObjectMethod"),i.push("OnClientClick"),i.push("sfwResource"),i.push("sfwRelatedControl"),i.push("sfwSelection"),i.push("sfwSetPageMode"),i.push("sfwSecurityLevel"),i.push("sfwTriggerPostBack"),i.push("sfwSaveBeforeAction"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("sfwVisibleRule"),i.push("Visible")):t=="Wizard"&&n.dictAttributes.CommandName!=undefined&&n.dictAttributes.CommandName!=""?(i.push("sfwCheckChanges"),i.push("sfwCustomAttributes"),i.push("CommandName"),n.Name=="sfwLinkButton"||i.push("sfwEnableRule"),i.push("sfwMode"),i.push("OnClientClick"),i.push("sfwResource"),i.push("sfwSecurityLevel"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("sfwVisibleRule"),i.push("Visible")):(i.push("sfwActiveForm"),i.push("sfwCheckChanges"),i.push("sfwCustomAttributes"),n.Name=="sfwLinkButton"||i.push("sfwEnableRule"),i.push("sfwMode"),i.push("sfwMessageId"),n.dictAttributes.sfwMethodName!="btnBpmApprove_Click"&&n.dictAttributes.sfwMethodName!="btnBpmSubmit_Click"&&n.dictAttributes.sfwMethodName!="btnBpmReject_Click"&&i.push("sfwNavigationParameter"),i.push("sfwObjectMethod"),i.push("OnClientClick"),i.push("sfwResource"),i.push("sfwRelatedControl"),i.push("sfwSelection"),i.push("sfwSecurityLevel"),i.push("Text"),i.push("sfwUserLogParameters"),i.push("sfwVisibleRule"),i.push("Visible"))),i}function getPrimarykey(n,t){var u=[],i=n.filter(function(n){return n.ID==t}),r;return i&&i.length>0&&i[0].Attributes.length>0&&(r=i[0].Attributes.filter(function(n){return n.Type=="Column"&&n.KeyNo=="1"}),r.length>0&&u.push(r[0])),u}function GetFormTitle(n,t){for(var e,f,u="",r=t+n,i=0;i<r.length;i++)e=r[i],f=!1,i>0&&CharCase(r[i-1])<CharCase(r[i])&&(f=!0),f&&(u+=" "),u+=r[i];return u}function CharCase(n){return n>="a"&&n<="z"?0:1}function PopulateServerMethodForEntity(n){var i=[],t,r;return n&&(t=n.Elements.filter(function(n){return n.Name=="methods"}),t&&t.length>0&&(r=t[0],angular.forEach(r.Elements,function(n){i.push(n)}))),i}function IsAuditField(n){return(n=n.toLowerCase(),n=="created_by")?!0:n=="created_date"?!0:n=="modified_by"?!0:n=="modified_date"?!0:n=="update_seq"?!0:!1}function PopulateGridDataField(n,t){angular.forEach(n.Elements,function(n){n.dictAttributes&&n.dictAttributes.sfwEntityField&&n.Name!="rowformat"&&n.Name!="cellformat"&&n.Name!="HeaderTemplate"&&n.Name!="FooterTemplate"&&n.Name!="Parameters"&&n.Name!="Data"&&t.push(n.dictAttributes.sfwEntityField);n.Elements.length>0&&n.Name!="rowformat"&&n.Name!="cellformat"&&n.Name!="HeaderTemplate"&&n.Name!="FooterTemplate"&&n.Name!="Parameters"&&n.Name!="Data"&&PopulateGridDataField(n,t)})}function PopulateRetrievalControls(n,t){n&&angular.forEach(n.Elements,function(n){if(n.Name=="sfwLabel"||n.Name=="sfwDropDownList"||n.Name=="sfwTextBox"||n.Name=="sfwCascadingDropDownList"||n.Name=="sfwMultiSelectDropDownList"||n.Name=="sfwCheckBox"){var i={ID:n.dictAttributes.ID,ControlID:""};t.push(i)}n.Elements.length>0&&n.Name!="sfwGridView"&&PopulateRetrievalControls(n,t)})}function PopulateSortExpressions(n,t){angular.forEach(n.Elements,function(n){n.dictAttributes.sfwEntityField&&n.dictAttributes.sfwEntityField!=""&&t.push(n.dictAttributes.sfwEntityField);n.Elements.length>0&&n.Name&&(n.Name=="Columns"||n.Name=="ItemTemplate"||n.Name=="TemplateField")&&PopulateSortExpressions(n,t)})}function PopulateRetrievalOrAutoCompleteParameters(n,t,i,r){n&&angular.forEach(n.Elements,function(n){var e,f,u;n.Name!="sfwPanel"&&n.Name!="sfwWizardStep"&&n.Name!="sfwGridView"&&(i=="Lookup"&&n.dictAttributes.sfwDataField&&n.dictAttributes.ID?(u={ID:n.dictAttributes.ID,Name:n.Name,ControlID:"",Elements:[],IsExpanded:!1},t.push(u)):(i=="Maintenance"||i=="Wizard"||i=="UserControl")&&n.dictAttributes.sfwEntityField&&n.dictAttributes.ID?(u={ID:n.dictAttributes.ID,Name:n.Name,ControlID:"",Elements:[],IsExpanded:!1},t.push(u)):i=="Correspondence"&&n.dictAttributes.sfwQueryID&&n.dictAttributes.ID&&(u={ID:n.dictAttributes.ID,Name:n.Name,ControlID:"",Elements:[],IsExpanded:!1},t.push(u)));n.Elements.length>0&&(e=t,n.Name=="sfwPanel"&&(f=n.dictAttributes.sfwCaption,(f==undefined||f=="")&&(f=n.dictAttributes.ID),u={ID:f,Elements:[],Name:n.Name,IsExpanded:!1},t.push(u),e=t[t.length-1].Elements),n.Name=="sfwWizardStep"&&(f=n.dictAttributes.Title,(f==undefined||f=="")&&(f=n.dictAttributes.ID),u={ID:f,Elements:[],Name:n.Name,IsExpanded:!1},t.push(u),e=t[t.length-1].Elements),PopulateRetrievalOrAutoCompleteParameters(n,e,i,r))})}function PopulateGridEntityField(n,t){angular.forEach(n.Elements,function(n){if(n.dictAttributes.sfwEntityField&&n.Name!="rowformat"&&n.Name!="cellformat"&&n.Name!="HeaderTemplate"&&n.Name!="FooterTemplate"){var i={ID:n.dictAttributes.sfwEntityField,ControlID:"",Elements:[],IsExpanded:!1};t.push(i)}n.Elements.length>0&&n.Name!="rowformat"&&n.Name!="cellformat"&&n.Name!="HeaderTemplate"&&n.Name!="FooterTemplate"&&PopulateGridEntityField(n,t)})}function PopulateFormEntityField(n,t,i){angular.forEach(n.Elements,function(n){n.dictAttributes.sfwEntityField&&!i?t.push(n.dictAttributes.sfwEntityField):n.dictAttributes.sfwDataField&&i&&t.push(n.dictAttributes.sfwDataField);n.Elements.length>0&&n.Name!="sfwGridView"&&n.Name!="sfwDialogPanel"&&PopulateFormEntityField(n,t,i)})}function PopulateFormLinkEntityField(n,t,i){angular.forEach(n.Elements,function(n){n.dictAttributes.sfwEntityField&&!i?t.push(n.dictAttributes.sfwEntityField):n.dictAttributes.sfwDataField&&i&&t.push(n.dictAttributes.sfwDataField);n.Elements.length>0&&PopulateFormLinkEntityField(n,t,i)})}function PopulateGridID(n,t,i){angular.forEach(n.Elements,function(n){n.Name=="sfwGridView"&&n.dictAttributes.ID&&n.dictAttributes.ID!=t&&i.push(n.dictAttributes.ID);n.Elements&&n.Elements.length>0&&PopulateGridID(n,t,i)})}function GetVMUsingID(n,t,i,r){angular.forEach(t.Elements,function(t){t.Name==n&&t.dictAttributes.ID==i&&PopulateEntityField(t,r);t.Elements.length>0&&GetVMUsingID(n,t,i,r)})}function PopulateEntityField(n,t){angular.forEach(n.Elements,function(n){n.dictAttributes.sfwEntityField&&t.push(n.dictAttributes.sfwEntityField);n.Elements.length>0&&PopulateEntityField(n,t)})}function GetAllControls(n,t,i,r,u,f,e){var o=r!="";angular.forEach(n.Elements,function(n){n.Name=="items"&&u&&GetAllFormControls(n,t,i,r,f,o);n.Name=="sfwTable"&&GetAllControlsFormMainTable(n,t,i,r,f,o,e)})}function GetAllControlsFormMainTable(n,t,i,r,u,f,e){var s=t.split(","),o;if(n){o=n.dictAttributes.ID;function h(n){f||(!i||i&&o!=""&&o!=undefined&&i.toLowerCase()==o.toLowerCase())&&(s.length>0?angular.forEach(s,function(t){t==n.Name&&n.dictAttributes&&n.dictAttributes.ID&&u.push(n)}):n.dictAttributes&&n.dictAttributes.ID&&u.push(n));n.Elements.length>0&&n.Elements[0].Name=="sfwTable"&&GetAllControlsFormMainTable(n.Elements[0],t,i,r,u,f,e)}function c(n){n.Name=="HeaderTemplate"?(strTreeCaption="HeaderTemplate",f||(!i||i&&o!=""&&o!=undefined&&i.toLowerCase()==o.toLowerCase())&&(s.length>0?angular.forEach(s,function(t){t==n.Name&&n.dictAttributes&&n.dictAttributes.ID&&u.push(n)}):n.dictAttributes&&n.dictAttributes.ID&&u.push(n)),n.Elements.length>0&&n.Elements[0].Name=="sfwTable"&&GetAllControlsFormMainTable(n.Elements[0],t,i,r,u,f,e)):angular.forEach(n.Elements,h)}angular.forEach(n.Elements,function(n){angular.forEach(n.Elements,function(n){n&&angular.forEach(n.Elements,function(n){var p,l,a,w,b,y,v,h;if(f||(!i||i&&o!=undefined&&o!=""&&i.toLowerCase()==o.toLowerCase()||e)&&(s.length>0?angular.forEach(s,function(t){t==n.Name&&n.dictAttributes&&n.dictAttributes.ID&&u.push(n)}):n.dictAttributes&&n.dictAttributes.ID&&u.push(n)),n.Name=="sfwChart"&&(p=n,angular.forEach(p.Elements,function(n){var i,t,r;if(n.Name=="Series")for(t=0;t<n.Elements.length;t++)i=n.Elements[t],i.Name=="sfwSeries"&&i.dictAttributes&&i.dictAttributes.ID&&u.push(i);if(n.Name=="ChartAreas")for(t=0;t<n.Elements.Count;t++)r=n.Elements[t],r.Name=="sfwChartArea"&&r.dictAttributes&&r.dictAttributes.ID&&u.push(r)})),n.Name=="sfwPanel")l=n,l.Elements.length>0&&l.Elements[0].Name=="sfwTable"&&GetAllControlsFormMainTable(l.Elements[0],t,i,r,u,f,e);else if(n.Name=="sfwTabContainer")a=n,a.Elements.length>0&&a.Elements[0].Name=="Tabs"&&(w=a.Elements[0],angular.forEach(w.Elements,function(n){f||o!=undefined&&o!=""&&i.toLowerCase()==o.toLowerCase()&&(s.length>0?angular.forEach(s,function(t){t==n.Name&&n.dictAttributes&&n.dictAttributes.ID&&u.push(n)}):n.dictAttributes&&n.dictAttributes.ID&&u.push(n));n.Elements.length>0&&n.Elements[0].Name=="sfwTable"&&GetAllControlsFormMainTable(n.Elements[0],t,i,r,u,f,e)}));else if(n.Name=="sfwGridView"){if(b=n.dictAttributes.ID,f&&b==r&&n.Elements.length>0&&n.Elements[0].Name=="Columns")for(y=n.Elements[0],h=0;h<y.Elements.length;h++)v=y.Elements[h],v.Elements.length>0&&v.Elements[0].Name=="ItemTemplate"&&angular.forEach(v.Elements[0].Elements,function(n){u.push(n)})}else if(n.Name=="sfwWizard")angular.forEach(n.Elements,c);else if(n.Name=="sfwButtonGroup")for(h=0;h<n.Elements.length;h++)if(n.Elements[h].Name=="sfwScheduler"&&n.Elements[h].dictAttributes&&n.Elements[h].dictAttributes.ID){u.push(n.Elements[h]);break}})})})}}function GetAllFormControls(n,t,i,r,u,f){function o(n){f||(e.length>0?angular.forEach(e,function(t){t==n.Name&&n.dictAttributes&&n.dictAttributes.ID&&u.push(n)}):n.dictAttributes&&n.dictAttributes.ID&&u.push(n));n.Elements.length>0&&n.Elements[0].Name=="items"&&GetAllFormControls(n.Elements[0],t,i,r,u,f)}function s(n){n.Name=="HeaderTemplate"?(strTreeCaption="HeaderTemplate",f||(e.length>0?angular.forEach(e,function(t){t==n.Name&&n.dictAttributes&&n.dictAttributes.ID&&u.push(n)}):n.dictAttributes&&n.dictAttributes.ID&&u.push(n)),n.Elements.length>0&&n.Elements[0].Name=="items"&&GetAllFormControls(n.Elements[0],t,i,r,u,f)):angular.forEach(n.Elements,o)}var e=t.split(","),h;n&&(h=n.dictAttributes.ID,angular.forEach(n.Elements,function(n){var a,o,h,y,p,v,c,l;if(f||(e.length>0?angular.forEach(e,function(t){t==n.Name&&n.dictAttributes&&n.dictAttributes.ID&&u.push(n)}):n.dictAttributes&&n.dictAttributes.ID&&u.push(n)),n.Name=="sfwChart"&&(a=n,angular.forEach(a.Elements,function(n){var i,t,r;if(n.Name=="Series")for(t=0;t<n.Elements.length;t++)i=n.Elements[t],i.Name=="sfwSeries"&&i.dictAttributes&&i.dictAttributes.ID&&u.push(i);if(n.Name=="ChartAreas")for(t=0;t<n.Elements.Count;t++)r=a.Elements[t],r.Name=="sfwChartArea"&&r.dictAttributes&&r.dictAttributes.ID&&u.push(r)})),n.Name=="sfwPanel")o=n,o.Elements.length>0&&o.Elements[0].Name=="items"&&GetAllFormControls(o.Elements[0],t,i,r,u,f);else if(n.Name=="sfwTabContainer")h=n,h.Elements.length>0&&h.Elements[0].Name=="Tabs"&&(y=h.Elements[0],angular.forEach(y.Elements,function(n){f||(e.length>0?angular.forEach(e,function(t){t==n.Name&&n.dictAttributes&&n.dictAttributes.ID&&u.push(n)}):n.dictAttributes&&n.dictAttributes.ID&&u.push(n));n.Elements.length>0&&n.Elements[0].Name=="items"&&GetAllFormControls(n.Elements[0],t,i,r,u,f)}));else if(n.Name=="sfwGridView"){if(p=n.dictAttributes.ID,f&&p==r&&n.Elements.length>0&&n.Elements[0].Name=="Columns")for(v=n.Elements[0],c=0;c<v.Elements.length;c++)l=v.Elements[c],l.Elements.length>0&&l.Elements[0].Name=="ItemTemplate"&&angular.forEach(l.Elements[0].Elements,function(n){u.push(n)})}else n.Name=="sfwWizard"&&angular.forEach(n.Elements,s)}))}function GetEntityXMLMethodParameters(n,t,i){var u=n.filter(function(n){return n.ID==t}),r,f;return u&&u.length&&(f=u[0],angular.forEach(f.XmlMethods,function(n){r||n.ID==i&&(r=n)})),r?r.Parameters:r}function GetObjectMethodParameters(n,t,i){var u=n.filter(function(n){return n.ID==t}),r,f;return u&&u.length&&(f=u[0],angular.forEach(f.ObjectMethods,function(n){r||n.ID==i&&(r=n)})),r?r.Parameters:r}function GetObjectMethods(n,t){var i=n.filter(function(n){return n.ID==t}),r=[],u;return i&&i.length&&(u=i[0],angular.forEach(u.ObjectMethods,function(n){r.push(n)})),r}function GetSrvMethodParameters(n,t){var i;return(n&&angular.forEach(n.Elements,function(n){i||n.dictAttributes.ID==t&&(i=n)}),i)?i.Elements:i}function GetCriteriaPanel(n){var t;return angular.forEach(n.Elements,function(n){if(!t){if(n.dictAttributes.ID)var i=n.dictAttributes.ID.toLowerCase().trim();t=i=="tblcriteria"?n:GetCriteriaPanel(n)}}),t}function PopulateTextRelatedControls(n,t){if(n.Name=="sfwTextBox"&&n.dictAttributes.ID){var i=n.dictAttributes.ID;i.length>0&&!i.match("^idsfw")&&t.push(i)}angular.forEach(n.Elements,function(n){PopulateTextRelatedControls(n,t)})}function GetControlNames(n,t){angular.forEach(n.Elements,function(n){angular.forEach(n.Elements,function(n){angular.forEach(n.Elements,function(n){var i,r,u;if(n.Name=="sfwTable")GetControlNames(n,t);else if(n.Name=="sfwPanel")angular.forEach(n.Elements,function(n){n.Name=="sfwTable"&&GetControlNames(n,t)});else if(n.Name=="sfwGridView"&&n.Elements.length>0&&n.Elements[0].Name=="Columns")for(i=0;i<n.Elements[0].Elements.length;i++)r=n.Elements[0].Elements[i],r.Elements.length>0&&r.Elements[0].Name=="ItemTemplate"&&(u=r.Elements[0],angular.forEach(u.Elements,function(n){if("sfwEntityField"in n.dictAttributes){var i="";i=n.dictAttributes.sfwEntityField;t.push(i)}}))})})})}function GetRetrievalTargetControls(n,t){angular.forEach(n.Elements,function(n){if((n.Name=="sfwTextBox"||n.Name=="sfwCheckBox"||n.Name=="sfwDropDownList"||n.Name=="sfwRadioButtonList"||n.Name=="sfwMultiSelectDropDownList"||n.Name=="sfwCascadingDropDownList")&&n.dictAttributes.ID){var i={ID:n.dictAttributes.ID,sourceControl:"",isConstant:!1};t.push(i)}n.Elements.length>0&&n.Name!="sfwGridView"&&GetRetrievalTargetControls(n,t)})}function GetRetrievalSourceControls(n,t){angular.forEach(n.Elements,function(n){var r,i;(n.Name=="sfwTextBox"||n.Name=="sfwCheckBox"||n.Name=="sfwDropDownList"||n.Name=="sfwRadioButtonList"||n.Name=="sfwMultiSelectDropDownList"||n.Name=="sfwCascadingDropDownList")&&n.dictAttributes.ID&&(i={ID:n.dictAttributes.ID,Elements:[],IsExpanded:!1},t.push(i));n.Elements.length>0&&n.Name!="sfwGridView"&&n.Name!="sfwDialogPanel"&&(r=t,n.Name=="sfwPanel"?(i={ID:n.dictAttributes.sfwCaption,Elements:[],IsExpanded:!1},t.push(i),r=t[t.length-1].Elements):n.Name=="sfwWizardStep"&&(i={ID:n.dictAttributes.Title,Elements:[],IsExpanded:!1},t.push(i),r=t[t.length-1].Elements),GetRetrievalSourceControls(n,r))})}function onQueryChange(n,t){var f=[],e,i,o,r,s;if(n&&(e=n,i=e.split("."),i&&i.length==2)){var h=i[0],c=i[1],u=t.filter(function(n){return n.ID==h});u&&u.length>0&&(o=u[0],r=o.Queries.filter(function(n){return n.ID==c}),r&&r.length>0&&(s=r[0],angular.forEach(s.Parameters,function(n){f.push(n)})))}return f}function CheckIfObjectType(n,t,i){var f=!1,u,e,s,o,r;if(t!=undefined&&t!=""&&(u=i.filter(function(n){return n.ID==t}),u&&u.length>0))if(e=u[0],n.contains("."))for(s=n.split("."),o=0;o<s.length;o++)f=!1,r=SearchAttributeInEntity(e,s[o]),r&&r.DataType=="Object"&&(f=!0),r&&r.Entity!=undefined&&r.Entity!=""&&(u=i.filter(function(n){return n.ID==r.Entity}),u&&u.length>0&&(e=u[0]));else r=SearchAttributeInEntity(e,n),r&&r.DataType=="Object"&&(f=!0);return f}function SearchAttributeInEntity(n,t){var r,i=n.Attributes.filter(function(n){return n.ID==t});return i&&i.length>0&&(r=i[0]),r}function GetQueryListFromObject(n){var r=[],t=n.Elements.filter(function(n){return n.Name=="initialload"});if(t.length>0)for(i=0;i<t[0].Elements.length;i++)t[0].Elements[i].Name=="query"&&r.push(t[0].Elements[i]);return r}function GetMainQueryFromFormObject(n,t){var r=n.Elements.filter(function(n){return n.Name=="initialload"}),u,f;if(r&&r.length>0)for(i=0;i<r[0].Elements.length;i++)f=r[0].Elements[i].dictAttributes.sfwQueryRef,IsSubQuery(f,t)||(u=r[0].Elements[i]);return u}function IsSubQuery(n,t){function e(n){r||n.ID==f&&n.QueryType&&n.QueryType.toLowerCase()=="subselectquery"&&(r=!0)}var r=!1,u,i,f;return n!=""&&n!=undefined&&(u=n.substring(0,n.indexOf(".")),i=t.filter(function(n){return n.ID==u}),i&&i.length>0&&(f=n.substring(n.indexOf(".")+1),angular.forEach(i[0].Queries,e))),r}function getEntityBasedOnControl(n){var t="",e=getCurrentFileScope(),r,i,u,f;return n.Name=="sfwGridView"?t=n.dictAttributes.sfwEntityField:n.Name=="sfwDialogPanel"?(r=n.dictAttributes.ID,r&&(i=GetFieldFromFormObject(e.SfxMainTable,"sfwButton","sfwRelatedDialogPanel",r),i&&i.length>0&&i[0].dictAttributes.sfwRelatedControl?(u=GetFieldFromFormObject(e.SfxMainTable,"sfwGridView","ID",i[0].dictAttributes.sfwRelatedControl),u&&u.length>0&&(t=u[0].dictAttributes.sfwEntityField)):(f=GetFieldFromFormObject(e.SfxMainTable,"sfwScheduler","sfwRelatedDialogPanel",r),f&&f.length>0&&(t=f[0].dictAttributes.sfwEntityField)))):n.Name=="sfwListView"&&(t=n.dictAttributes.sfwEntityField),t}function GetNewSeriesName(n,t,i){for(var r=String.format("{0}{1}",n,i.toString());CheckForDuplicateName(r,t);)i++,r=String.format("{0}{1}",n,i.toString());return r}function CheckForDuplicateName(n,t){var i=!1;return t&&(t.dictAttributes.Name?i=t.dictAttributes.Name==n:t.dictAttributes.ID&&(i=t.dictAttributes.ID==n),i||angular.forEach(t.Elements,function(t){!i&&(i=CheckForDuplicateName(n,t),i)})),i}function GetNavParamCollection(n,t,i,r,u){var h,c,o,v,e,f;if(n)if(n.dictAttributes.sfwType=="Lookup")h=n.Elements.filter(function(n){return n.Name=="sfwTable"}),h&&h.length>0&&(c=GetCriteriaPanel(h[0])),c&&angular.forEach(c.Elements,function(n){angular.forEach(n.Elements,function(n){n&&angular.forEach(n.Elements,function(n){if("sfwDataField"in n.dictAttributes){var t=n.dictAttributes.sfwDataField,r=n.dictAttributes.ID;t!=""&&t!=undefined&&AddParamGridRow("Criteria Field",t,"",r,i)}})})});else{var l=t.dictAttributes.sfwMethodName,a=l=="btnNew_Click"||l=="btnUpdate_Click"||l=="btnSaveNew_Click",s,f=n.Elements.filter(function(n){return n.Name=="initialload"});if(f&&f.length>0&&(s=f[0]),s){if(o="",f=s.Elements.filter(function(n){return n.Name=="callmethods"&&(n.dictAttributes.sfwMode==""||n.dictAttributes.sfwMode==undefined||n.dictAttributes.sfwMode=="Update")}),f&&f.length&&(o=f[0].dictAttributes.sfwMethodName),a&&(f=s.Elements.filter(function(n){return n.Name=="callmethods"&&(n.dictAttributes.sfwMode==""||n.dictAttributes.sfwMode==undefined||n.dictAttributes.sfwMode=="New")}),f&&f.length&&(o=f[0].dictAttributes.sfwMethodName)),o!=undefined&&o!="")if(n.dictAttributes.sfwRemoteObject!=undefined&&n.dictAttributes.sfwRemoteObject!=""){if(v=GetServerMethodObject(n.dictAttributes.sfwRemoteObject,u.RemoteObjectCollection),e=GetSrvMethodParameters(v,o),e)for(j=0;j<e.length;j++)AddParamGridRow(e[j].dictAttributes.sfwDataType,e[j].dictAttributes.ID,"","",i)}else e=GetEntityXMLMethodParameters(r,n.dictAttributes.sfwEntity,o),e&&angular.forEach(e,function(n){AddParamGridRow(n.DataType,n.ID,n.Value,"",i)});a&&(f=s.Elements.filter(function(n){return n.Name=="session"}),f&&f.length>0&&angular.forEach(f[0].Elements,function(n){AddParamGridRow("Session Field",n.dictAttributes.ID,"","",i)}))}}}function AddParamGridRow(n,t,i,r,u){var f={};f.Type=n;f.ParameterField=t;i!=undefined&&i!=""&&(i.match("^#")?(f.Constants=!0,f.ParameterValue=i.substring(1)):f.ParameterValue=i,f.IsReadOnly=!0);f.ControlID=r;u.push(f)}function PopulateParamValues(n,t){var i;t!=undefined&&t!=""&&(t.match("^@")?(t=t.substring(1),i=t.split(";"),angular.forEach(i,function(t){var r=t,i=t,u=!1;t.contains("=")&&(r=t.substring(0,t.indexOf("=")),i=t.substring(t.indexOf("=")+1),i.match("^#")&&(i=i.substring(1),u=!0));angular.forEach(n,function(n){n.ControlID==r&&(n.ParameterValue=i,n.Constants=u)})})):(i=t.split(";"),angular.forEach(i,function(t){var r=t,i=t,u=!1;t.contains("=")&&(r=t.substring(0,t.indexOf("=")),i=t.substring(t.indexOf("=")+1),i.match("^#")?(i=i.substring(1),u=!0):i.match("^~")&&(i=i.substring(1)));angular.forEach(n,function(n){n.ParameterField.toLowerCase()==r.toLowerCase()&&(n.ParameterValue=i,n.Constants=u)})})))}function GetNavigationParameterValue(n){var t="";return angular.forEach(n,function(n){var u=n.ParameterField,i=n.ParameterValue,f,r;(i!=undefined&&i!=""||u!=undefined&&u!="")&&(f=n.Constants,f&&(i="#"+i),r=i,i!=undefined&&i!=""&&i.toLowerCase()!=u.toLowerCase()&&(r=u+"="+i),r!=undefined&&r!=""&&(t==""?t=r:t+=";"+r))}),t}function GetAttribute(n,t){var r,i=t.Attributes.filter(function(t){return t.ID==n});return i&&i.length>0&&(r=i[0]),r}function getEntityObject(n,t){var r,u=t.getEntityIntellisense(),i=u.filter(function(t){return t.ID==n});return i&&i.length>0&&(r=i[0]),r}function persistAttributes(n,t){if(n&&t&&n.dictAttributes&&t.dictAttributes){if(n.dictAttributes.ID&&n.dictAttributes.ID.trim().length>0){var u=n.Name=="sfwLabel"&&n.dictAttributes.sfwIsCaption&&n.dictAttributes.sfwIsCaption=="True",i=getControlIDPrefix(n.Name,u),r=getControlIDPrefix(t.Name);r+=n.Name=="sfwLabel"&&(n.dictAttributes.ID.startsWith("cap")||n.dictAttributes.ID.startsWith("lbl"))?n.dictAttributes.ID.substring(3):n.dictAttributes.ID.startsWith(i)?n.dictAttributes.ID.substring(i.length):n.dictAttributes.ID;t.dictAttributes.ID=r}n.dictAttributes.Visible&&n.dictAttributes.Visible.trim().length>0&&(t.dictAttributes.Visible=n.dictAttributes.Visible);n.dictAttributes.sfwResource&&n.dictAttributes.sfwResource.trim().length>0&&(t.dictAttributes.sfwResource=n.dictAttributes.sfwResource);n.dictAttributes.sfwVisibleRule&&n.dictAttributes.sfwVisibleRule.trim().length>0&&(t.dictAttributes.sfwVisibleRule=n.dictAttributes.sfwVisibleRule);n.dictAttributes.sfwEnableRule&&n.dictAttributes.sfwEnableRule.trim().length>0&&t.Name=="sfwButton"&&(t.dictAttributes.sfwEnableRule=n.dictAttributes.sfwEnableRule);n.dictAttributes.CssClass&&n.dictAttributes.CssClass.trim().length>0&&(t.dictAttributes.CssClass=n.dictAttributes.CssClass);n.dictAttributes.sfwCustomAttributes&&n.dictAttributes.sfwCustomAttributes.trim().length>0&&(t.dictAttributes.sfwCustomAttributes=n.dictAttributes.sfwCustomAttributes);n.dictAttributes.sfwMode&&n.dictAttributes.sfwMode.trim().length>0&&(t.dictAttributes.sfwMode=n.dictAttributes.sfwMode);t.Name=="sfwButton"||t.Name=="sfwImageButton"||t.Name=="sfwSoftErrors"||t.Name=="sfwLinkButton"||t.Name=="sfwToolTipButton"||t.Name=="CompareValidator"||t.Name=="sfwDialogPanel"||t.Name=="sfwListBox"||t.Name=="sfwButtonGroup"||t.Name=="sfwLabel"&&t.dictAttributes.sfwIsCaption=="True"||(n.dictAttributes.sfwEntityField&&n.dictAttributes.sfwEntityField.trim().length>0?t.dictAttributes.sfwEntityField=n.dictAttributes.sfwEntityField:n.dictAttributes.sfwDataField&&n.dictAttributes.sfwDataField.trim().length>0?t.dictAttributes.sfwDataField=n.dictAttributes.sfwDataField:n.dictAttributes.sfwObjectField&&n.dictAttributes.sfwObjectField.trim().length>0&&(t.dictAttributes.sfwObjectField=n.dictAttributes.sfwObjectField))}}function getEntityAttributeByType(n,t,i){var r=[],u=n.filter(function(n){return n.ID==t}),f;return u.length>0&&(f=u[0].Attributes,r=f.filter(function(n){return n.Type==i})),r}function PopulateColumnList(n,t,i,r){var u=[],s="ID",f={},e,h,o,c;return n?u=PopulateQueryColumnFromList(n,r,t):t&&(e=GetMainQueryFromFormObject(t,i),e?u=PopulateQueryColumnFromList(e.dictAttributes.ID,r,t):(s="Value",t.dictAttributes.sfwEntity&&(h=i,o=h.filter(function(n){return n.ID==t.dictAttributes.sfwEntity}),o.length>0&&(c=o[0].Attributes,u=c.filter(function(n){return n.Type=="Column"}))))),f.list=u,f.attribute=s,f}function PopulateQueryColumnFromList(n,t,i){var e=!1,o=[],f,r,u;return t&&(r=t.filter(function(t){return t.EntityName==n}),r&&r.length>0&&(o=JSON.parse(JSON.stringify(r[0].lstselectedobjecttreefields)),e=!0)),!e&&t&&(f=GetQueryListFromObject(i),f&&f.length>0&&(r=f.filter(function(t){return t.dictAttributes.ID==n}),r&&r.length>0&&(u={EntityName:r[0].dictAttributes.ID,IsVisible:!0,selectedobjecttreefield:undefined,lstselectedobjecttreefields:[],IsQuery:!0},t.push(u),r[0].dictAttributes.sfwQueryRef&&$.connection.hubForm.server.getEntityQueryColumns(r[0].dictAttributes.sfwQueryRef,"LoadQueryFieldsForLookup").done(function(n){var t=GetFormFileScope(i);t&&t.receiveQueryFields&&t.receiveQueryFields(n,r[0].dictAttributes.sfwQueryRef)}),e=!0,u.lstselectedobjecttreefields||(u.lstselectedobjecttreefields=[]),o=u.lstselectedobjecttreefields))),o}function getQueryBookMarksID(n){var i=[],t=n.Elements.filter(function(n){return n.Name=="sfwQueryBookMarks"});return t&&t.length>0&&angular.forEach(t[0].Elements,function(n){i.push(n.dictAttributes.ID)}),i}function PopulateControlsForActiveForm(n,t,i,r){var f=!1,u,e,o;(t.dictAttributes.sfwType=="FormLinkLookup"||t.dictAttributes.sfwType=="FormLinkMaintenance"||t.dictAttributes.sfwType=="FormLinkWizard")&&(f=!0);u=[];i.dictAttributes.sfwMethodName=="btnNew_Click"||i.dictAttributes.sfwMethodName=="btnNewUpdate_Click"?r?GetAllControls(t,"sfwLabel,sfwTextBox,sfwDropDownList,sfwCheckBox,sfwRadioButtonList,sfwLinkButton","tblcriteria","",f,u,!1):GetAllControls(t,"sfwLabel,sfwTextBox,sfwDropDownList,sfwCheckBox,sfwRadioButtonList,sfwLinkButton,sfwScheduler","","",f,u,!0):i.dictAttributes.sfwMethodName=="btnOpen_Click"&&(e=i.dictAttributes.sfwRelatedControl,o=FindParent(i,"sfwGridView"),o&&o.dictAttributes&&(e=o.dictAttributes.ID),e!=""&&GetAllControls(t,"","",e,f,u));angular.forEach(u,function(t){var i="";"sfwLoadSource"in t.dictAttributes&&(i=t.dictAttributes.sfwLoadSource);(i==""||i=="0")&&(i="~",t.Elements.length>0&&angular.forEach(t.Elements,function(n){n.Name=="ListItem"&&n.dictAttributes.Value!=undefined&&n.dictAttributes.Value!=""&&(i+=n.dictAttributes.Value+",")}));"sfwEntityField"in t.dictAttributes&&t.dictAttributes.sfwEntityField!=undefined&&t.dictAttributes.sfwEntityField!=""&&n.push(t.dictAttributes.sfwEntityField+"~"+i)})}function CheckForFilterGrid(n){var t=[],i,r,u;if(FindControlListByNames(n,["sfwButton","sfwLinkButton","sfwImageButton"],t),t&&t.length>0&&(t=t.filter(function(n){return n.dictAttributes.sfwMethodName=="btnGridSearch_Click"}),t&&t.length>0))for(i=0;i<t.length;i++)if(t[i].dictAttributes.sfwNavigationParameter&&(r=t[i].dictAttributes.sfwNavigationParameter.split(";"),r&&r.length>0))for(j=0;j<r.length;j++)u=FindControlByID(n,r[j]),u&&(u.IsShowDataField=!0)}function CanAddControlToDropList(n,t,i){var r=!1;return t&&t.dictAttributes&&t.dictAttributes.sfwType=="Lookup"&&n.lstCustom&&n.lstCustom.some(function(n){return n.PropertyName=="sfwDataField"})?r=!0:t&&t.dictAttributes&&(t.dictAttributes.sfwType=="Maintenance"||t.dictAttributes.sfwType=="Wizard"||t.dictAttributes.sfwType=="UserControl")&&n.lstCustom&&n.lstCustom.some(function(n){return n.PropertyName=="sfwEntityField"})?r=!0:t&&t.dictAttributes&&t.dictAttributes.sfwType=="Correspondence"&&n.lstCustom&&n.lstCustom.some(function(n){return n.PropertyName=="sfwQueryID"})&&(r=!0),(i.Name=="sfwLabel"&&i.dictAttributes.sfwIsCaption=="True"||i.Name=="sfwGridView"||i.Name=="sfwChart"||i.Name=="sfwListView"||i.Name=="sfwPanel"||i.Name=="sfwCheckBoxList"||i.Name=="sfwButton"||i.Name=="sfwLinkButton"||i.Name=="sfwImageButton")&&(r=!1),r}function PopulateButtonID(n,t){return angular.forEach(n.Elements,function(n){n.Name=="sfwButton"&&n.dictAttributes.sfwMethodName=="btnNew_Click"&&n.dictAttributes.ID&&t.push(n);n.Elements.length>0&&PopulateButtonID(n,t)}),t}function PopulateControlID(n,t){return angular.forEach(n.Elements,function(n){(n.Name=="sfwTextBox"||n.Name=="sfwDropDownList"||n.Name=="sfwCascadingDropDownList"||n.Name=="sfwMultiSelectDropDownList")&&n.dictAttributes.ID&&n.dictAttributes.ID!=""&&t.push(n.dictAttributes.ID);n.Elements.length>0&&n.Name!="sfwGridView"&&PopulateControlID(n,t)}),t}function CreateCompatibleLabel(n,t,i,r){var e="",f=n.dictAttributes.sfwDataField,o,s,h,c,l,a,v;if(f||(f=n.dictAttributes.sfwEntityField,f||(f=n.dictAttributes.sfwObjectField),f||t.dictAttributes.sfwType!="Correspondence"||(f=n.dictAttributes.sfwQueryID)),o=getCurrentFileScope(),s=GetAttributesFromList(f,t,i),s&&(e=t&&!t.IsLookupCriteriaEnabled?GetCaptionFromField(s):!o||t.IsLookupCriteriaEnabled!=!0||o.MainQuery||o.SelectedQuery&&(!o.SelectedQuery||o.SelectedQuery.dictAttributes.ID)?GetCaptionFromFieldName(f):GetCaptionFromField(s)),f?(e||(e=GetCaptionFromFieldName(f)),n.Name!="sfwGridView"&&e&&e.trim().length>0&&!e.contains(":")&&(e+=" :")):e="Error! No field is binded with the control",h=n.ParentVM,h&&(c=h.ParentVM,c&&(l=c.Elements.indexOf(h),l>0))){var y=c.Elements[l-1],u={Name:"sfwLabel",value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]};u.ParentVM=y;u.dictAttributes.Text=e;u.dictAttributes.sfwIsCaption="True";a=u.Name;u.Name&&u.Name.startsWith("sfw")&&(a=u.Name.substring(3));u.dictAttributes.ID=CreateControlID(t,a,u.Name,!0);v=n.dictAttributes.ID;v&&(u.dictAttributes.AssociatedControlID=v);r.PushItem(u,y.Elements)}}function GetAttributesFromList(n,t,i){var f=getEntityObject(t.dictAttributes.sfwEntity,i),r,o=n,e,u;if(n!=undefined&&n!=""&&n.contains("."))for(e=n.split("."),u=0;u<e.length;u++)r&&r.Entity!=undefined&&r.Entity!=""&&(f=getEntityObject(r.Entity,i)),r=GetAttribute(e[u],f),o=e[u];return f&&(r=GetAttribute(o,f)),r}function getFilteredAttribute(n,t,i,r){var u=[];return n&&t&&t.length>0&&(u="sfwChart"==n&&r&&(r=="XAxisTitle"||r=="YAxisTitle"||r=="ChartName")?i?t.filter(function(n){return n.Type&&n.Type=="Object"}):t.filter(function(n){return n.Type&&n.Type.toLowerCase()!="expression"}):["sfwGridView","sfwChart","sfwListView"].indexOf(n)>-1?i?t.filter(function(n){return n.Type&&n.Type=="Object"}):t.filter(function(n){return n.Type&&(n.Type.toLowerCase()=="object"||n.Type.toLowerCase()=="collection")}):"sfwCheckBoxList"==n&&r&&r=="sfwEntityField"?i?t.filter(function(n){return n.Type&&n.Type=="Object"}):t.filter(function(n){return n.Type&&n.Type=="CDOCollection"}):"sfwCalendar"==n&&r&&r=="sfwEntityField"?i?t.filter(function(n){return n.Type&&n.Type=="Object"}):t.filter(function(n){return n.Type&&(n.Type.toLowerCase()=="object"||n.Type.toLowerCase()=="collection")}):n=="sfwLabel"?t:n=="udc"?t.filter(function(n){return n.Type&&n.Type=="Object"}):t.filter(function(n){return n.Type&&n.Type.toLowerCase()!="expression"})),u}function PopulateGridIDForNewButton(n,t){angular.forEach(n.Elements,function(n){n.Name=="sfwGridView"&&n.dictAttributes.ID&&t.push(n.dictAttributes.ID);n.Elements&&n.Elements.length>0&&PopulateGridIDForNewButton(n,t)})}function GetFormFileScope(n){var t="",u,i,r;return n&&n.dictAttributes&&(t=n.dictAttributes.ID),u=getScopeByFileName("MainPage"),t&&(i=getScopeByFileName(t),i||(t=t.substring(3),t="htx"+t,i=getScopeByFileName(t))),i||mainscope&&(r=mainscope.$root.currentopenfile.file.FileName,i=getScopeByFileName(r)),i}function GetObjectFields(n,t,i){var r=n.dictAttributes.sfwType.toUpperCase()=="LOOKUP";t.push("");n.Elements.length>0&&angular.forEach(n.Elements,function(n){n.Name=="sfwTable"&&GetObjectFieldForTable(i,n,r,t)})}function IsSearchCriteria(n){function i(n){t||(t=IsSearchCriteria(n))}var t=!1;return n&&n.Name=="sfwTable"&&(n.dictAttributes.ID=="tblCriteria"||n.dictAttributes.ID=="tblAdvCriteria"||n.dictAttributes.ID=="tblAdvSort"||n.dictAttributes.ID=="tblSql")&&(t=!0),t||n&&n.Elements.length>0&&angular.forEach(n.Elements,i),t}function GetObjectFieldForTable(n,t,i,r,u,f){angular.forEach(t.Elements,function(t){angular.forEach(t.Elements,function(t){angular.forEach(t.Elements,function(t){if(i){if(t.Name=="sfwPanel"&&IsSearchCriteria(t))t.Elements.length>0&&t.Elements[0].Name=="sfwTable"&&GetObjectFieldForTable(n,t.Elements[0],i,r,!0,!0);else if(t.Name=="sfwTabContainer"&&t.Elements.length>0&&t.Elements[0].Name=="Tabs"){var e=t.Elements[0];angular.forEach(e.Elements,function(t){t.Elements.length>0&&t.Elements[0].Name=="sfwTable"&&GetObjectFieldForTable(n,t.Elements[0],i,r,!0,!0)})}}else t.Name=="sfwPanel"&&t.Elements.length>0&&t.Elements[0].Name=="sfwTable"&&GetObjectFieldForTable(n,t.Elements[0],i,r,!0,!1);i&&u&&f?t.dictAttributes.sfwDataField!=undefined&&t.dictAttributes.sfwDataField!=""&&(n.dictAttributes.sfwMethodName=="btnNew_Click"?(t.Name=="sfwLabel"||t.Name=="sfwTextBox"||t.Name=="sfwDropDownList"||t.Name=="sfwCheckBox"||t.Name=="sfwRadioButtonList"||t.Name=="sfwLinkButton")&&r.push(t.dictAttributes.ID):r.push(t.dictAttributes.sfwDataField)):u&&t.dictAttributes.sfwEntityField!=undefined&&t.dictAttributes.sfwEntityField!=""&&(n.dictAttributes.sfwMethodName=="btnNew_Click"?(t.Name=="sfwLabel"||t.Name=="sfwTextBox"||t.Name=="sfwDropDownList"||t.Name=="sfwCheckBox"||t.Name=="sfwRadioButtonList"||t.Name=="sfwLinkButton")&&r.push(t.dictAttributes.ID):r.push(t.dictAttributes.sfwEntityField))})})})}function InsertRow(n,t,i){var o="swc",r={Name:"sfwRow",value:"",prefix:o,dictAttributes:{},Elements:[],Children:[]},u,s,f,e;for(r.ParentVM=i,n.Name=="sfwColumn"?u=n.ParentVM:n.Name=="sfwRow"&&(u=n),s=GetMaxColCount(u,i),f=0;f<s;f++)e={Name:"sfwColumn",value:"",prefix:o,dictAttributes:{},Elements:[],Children:[]},e.ParentVM=r,r.Elements.push(e);return r}function GetIndexToInsert(n,t){return n?t+1:t}function AddListViewTable(n,t){var u="swc",f={Name:"sfwTable",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},e,r,i;return f.ParentVM=t,e=CreateControlID(n,"NewPage","sfwTable"),f.dictAttributes.ID=e,r={Name:"sfwRow",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},r.ParentVM=f,i={Name:"sfwColumn",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},i.ParentVM=r,r.Elements.push(i),i={Name:"sfwColumn",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},i.ParentVM=r,r.Elements.push(i),i={Name:"sfwColumn",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},i.ParentVM=r,r.Elements.push(i),i={Name:"sfwColumn",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},i.ParentVM=r,r.Elements.push(i),f.Elements.push(r),f}function GetVisiblePropertyForHtmlControls(n){var t=[];return n=="sfwGridView"?t=["Visible","AllowGrouping","AllowPaging","AllowEditing","AllowFiltering","AllowSorting","ShowHeader","EmptyDataText","PageSize","ShowHeaderWhenEmpty"]:n=="TemplateField"?t=["Visible","HeaderText","SortExpression"]:n=="sfwTabSheet"?t=["Visible","HeaderText","DefaultButton"]:n=="sfwDropDownList"?t=["Visible","OnClientChange","DataTextField","DataValueField","AutoPostBack"]:n=="sfwCascadingDropDownList"||n=="sfwListPicker"||n=="sfwSourceList"?t=["Visible","DataTextField","DataValueField"]:n=="sfwCheckBoxList"?t=["Visible","RepeatColumns","RepeatDirection","DataTextField","DataValueField"]:n=="sfwButton"||n=="sfwLinkButton"?t=["Visible","OnClientClick"]:n=="sfwRadioButton"?t=["Visible","GroupName","AutoPostBack"]:n=="sfwRadioButtonList"?t=["Visible","RepeatColumns","RepeatDirection","DataTextField","DataValueField"]:n=="sfwPanel"?t=["Visible","DefaultButton"]:n=="sfwFileUpload"?t=["Visible","HeaderStatusUpload","SelectButtonText","StatusFailedMessage","StatusUploadedMessage","UploadButtonText","UploadClick","AllowMultiple"]:n=="sfwIamge"?t=["Visible","ImageUrl"]:n=="sfwImageButton"?t=["Visible","ImageUrl","ImageAlign"]:n=="sfwLabel"?t=["Visible","AssociatedControlID","ToolTip"]:n=="sfwTextBox"?t=["Visible","TextMode"]:n=="ListItem"?t=["Visible","Text","Value"]:n=="sfwMultiSelectDropDownList"&&(t=["AutoPostBack"]),t}function GetEntityFieldNameFromControl(n,t){var i="",u,r,f,e;return t.Name=="sfwGridView"?i=t.dictAttributes.sfwEntityField:t.Name=="sfwDialogPanel"?(u=t.dictAttributes.ID,u&&(r=GetFieldFromFormObject(n,"sfwButton","sfwRelatedDialogPanel",u),r&&r.length>0&&r[0].dictAttributes.sfwRelatedControl?(f=GetFieldFromFormObject(n,"sfwGridView","ID",r[0].dictAttributes.sfwRelatedControl),f&&f.length>0&&(i=f[0].dictAttributes.sfwEntityField)):(e=GetFieldFromFormObject(n,"sfwScheduler","sfwRelatedDialogPanel",u),e&&e.length>0&&(i=e[0].dictAttributes.sfwEntityField)))):t.Name=="sfwListView"&&(i=t.dictAttributes.sfwEntityField),i}function hasCaption(n){var r=!1,t,u,i;return n&&(t=FindParent(n,"sfwTable"),t&&(u=getDescendents(t),i=u.filter(function(t){return t.dictAttributes&&t.dictAttributes.sfwIsCaption==="True"&&n.dictAttributes.ID&&t.dictAttributes.AssociatedControlID===n.dictAttributes.ID}),i&&i.length>0&&(r=!0))),r}function isGridPresentInsidePanel(n){var i=!1,t;if(n&&n.Elements.length>0)for(t=0;t<n.Elements.length;t++)if(n.Elements[t].Name=="sfwGridView"){i=!0;break}else n.Elements[t].Elements.length>0&&!i&&(i=isGridPresentInsidePanel(n.Elements[t]));return i}function PopulateAvailableControl(n,t,i,r){if(!r){var u={Text:"Main",Items:[],IsSelected:!1,IsCheckBoxVisible:!1},f="sfwEntityField",e=!1;i&&(f="ID",e=!0);PopulateAvailableFields(f,t,u,!0,!1,e);u.Items.length>0&&n.push(u)}}function PopulateGlobalParameters(n,t){function u(n){var t,u;n.dictAttributes&&n.dictAttributes.ID&&(t=n.dictAttributes.ID,r.filter(function(n){return n==t.trim()})||r.push(t.trim()),u={Text:"~"+t,Items:[],IsSelected:!1,IsCheckBoxVisible:!0},i.Items.push(u))}var r,i;n&&(r=[],n.Elements.length>0&&(i={Text:"Global Parameters",Items:[],IsSelected:!1,IsCheckBoxVisible:!1},angular.forEach(n.Elements,u),i.Items.length>0&&t.push(i)))}function GetNavigationParameters(n){var u="",r,t,o,f,e;if(n)for(i=0;i<n.length;i++)(r=n[i],r)&&(t=r.ParmeterValue,t&&(o=r.ParmeterConstant,o&&(t="#"+t),f=t,e=r.ParmeterField,t.toLowerCase()!=e.toLowerCase()&&(f=e+"="+t),u==""?u=f:u+=";"+f));return u}function LoadDetails(n,t,i,r,u){for(var s,a,h,o,c,f=[],l=!1,e=0,v=n.Elements.length;e<v;e++)if(n.Elements[e].Name==="initialload"){for(s=0,a=n.Elements[e].Elements.length;s<a;s++)if(n.Elements[e].Elements[s].Name==="callmethods"&&n.Elements[e].Elements[s].dictAttributes.sfwMethodName){l=!0;break}break}for(h=0;h<n.Elements.length;h++)if(n.Elements[h].Name=="loaddetails"){t=n.Elements[h];break}if(i&&r.UndRedoBulkOp("Start"),o=undefined,u?o=n.Elements.filter(function(n){return n.Name=="items"}):u||(o=n.Elements.filter(function(n){return n.Name=="sfwTable"})),o&&o.length>0)for(t||(t={dictAttributes:{},Children:[],Elements:[],Name:"loaddetails",Value:""},i?r.PushItem(t,n.Elements):n.Elements.push(t)),UpdateLoadDetailsNodes(o[0],f,r,i,l),angular.forEach(t.Elements,function(n){var t=f.filter(function(t){return t.dictAttributes.ID==n.dictAttributes.ID});t&&t.length>0&&(t[0].isLoadWhenRequired||(i?(r.EditPropertyValue(t[0].dictAttributes.sfwUpdateAutoLoad,t[0].dictAttributes,"sfwUpdateAutoLoad",n.dictAttributes.sfwUpdateAutoLoad),r.EditPropertyValue(t[0].dictAttributes.sfwNewAutoLoad,t[0].dictAttributes,"sfwNewAutoLoad",n.dictAttributes.sfwNewAutoLoad)):(t[0].dictAttributes.sfwUpdateAutoLoad=n.dictAttributes.sfwUpdateAutoLoad,t[0].dictAttributes.sfwNewAutoLoad=n.dictAttributes.sfwNewAutoLoad)))}),i?r.EditPropertyValue(t.Elements,t,"Elements",[]):t.Elements=[],c=0;c<f.length;c++)i?r.PushItem(f[c],t.Elements):t.Elements.push(f[c]);return i&&r.UndRedoBulkOp("End"),f}function UpdateLoadDetailsNodes(n,t,i,r,u){var o=n.dictAttributes.sfwEntityField,e,f;(n.Name!="sfwGridView"||n.dictAttributes.sfwXMLLoadMethod)&&n.Name!="sfwChart"&&n.Name!="sfwListView"&&n.Name!="sfwCheckBoxList"&&n.Name!="sfwCalendar"&&n.Name!="sfwScheduler"&&n.Name!="udc"?(o&&o.contains(".")&&(o=o.substring(0,o.lastIndexOf(".")),e=t.filter(function(n){return n.Name=="entityfield"&&n.dictAttributes.ID==o}),e.length==0&&(f={Name:"entityfield",value:"",prefix:"",dictAttributes:{},Elements:[],Children:[]},f.dictAttributes.ID=o,u?(f.dictAttributes.sfwNewAutoLoad="False",f.dictAttributes.sfwUpdateAutoLoad="False"):(f.dictAttributes.sfwUpdateAutoLoad="True",f.dictAttributes.sfwNewAutoLoad="True"),r?i.PushItem(f,t):t.push(f))),angular.forEach(n.Elements,function(n){UpdateLoadDetailsNodes(n,t,i,r,u)})):o&&(e=t.filter(function(n){return n.Name=="entityfield"&&n.dictAttributes.ID==o}),e.length==0?(f={Name:"entityfield",value:"",prefix:"",dictAttributes:{},Elements:[],Children:[]},f.dictAttributes.ID=o,f.isLoadWhenRequired=!1,n.dictAttributes.sfwLoadWhenRequired&&n.dictAttributes.sfwLoadWhenRequired=="True"?(f.dictAttributes.sfwUpdateAutoLoad="False",f.dictAttributes.sfwNewAutoLoad="False",f.isLoadWhenRequired=!0):u?(f.dictAttributes.sfwNewAutoLoad="False",f.dictAttributes.sfwUpdateAutoLoad="False"):(f.dictAttributes.sfwUpdateAutoLoad="True",f.dictAttributes.sfwNewAutoLoad="True"),r?i.PushItem(f,t):t.push(f)):n.dictAttributes.sfwLoadWhenRequired&&n.dictAttributes.sfwLoadWhenRequired=="True"&&(r?(i.EditPropertyValue(e[0].dictAttributes.sfwUpdateAutoLoad,e[0].dictAttributes,"sfwUpdateAutoLoad","False"),i.EditPropertyValue(e[0].dictAttributes.sfwNewAutoLoad,e[0].dictAttributes,"sfwNewAutoLoad","False"),i.EditPropertyValue(e[0].isLoadWhenRequired,e[0],"isLoadWhenRequired",!0)):(e[0].dictAttributes.sfwUpdateAutoLoad="False",e[0].dictAttributes.sfwNewAutoLoad="False",e[0].isLoadWhenRequired=!0)));n.Name=="sfwListView"&&angular.forEach(n.Elements,function(n){UpdateLoadDetailsNodes(n,t,i,r,u)})}function onTrackingIDDrop(n){for(var r=angular.element($(n.target)).scope(),i=r.$parent,t,u;i&&!i.objNewButtonOpenWordDoc.SelectedField;)i=i.$parent;if(r&&r.$parent&&i.objNewButtonOpenWordDoc.SelectedField){for(t=i.objNewButtonOpenWordDoc.SelectedField,u=t.ID;t.objParent&&!t.objParent.IsMainEntity;)t=t.objParent,u=[t.ID,u].join(".");r.$apply(function(){r.objNewButtonOpenWordDoc.TrackingID=u})}}function onFieldCollectionDrop(n){n.preventDefault();var t=angular.element(n.target).scope();t&&t.objNewButtonCustomAttr&&t.objNewButtonCustomAttr.AddToGridClick&&t.$apply(function(){t.objNewButtonCustomAttr.AddToGridClick()})}function TraverseFieldCollection(n){angular.forEach(n.Items,function(n){n.Items.length>0?(TraverseFieldCollection(n),n.IsSelected=!1):n.IsSelected=!1})}function GetGridObject(n,t,i,r){angular.forEach(t.Elements,function(t){t.Name==n&&t.dictAttributes.ID==i&&r.push(t);t.Elements.length>0&&GetGridObject(n,t,i,r)})}function CanShowContextMenu(n,t){if(n&&t&&t.dictAttributes.sfwType==="Lookup"){var i=FindParent(n,"sfwColumn",!0);return i&&i.Elements&&i.Elements.length>0&&i.Elements[0].Name==="sfwTabContainer"?!1:!0}return!0}function getDisplayClass(n){var t="";return t=n.Name=="sfwTextBox"?n.IsSelected?"select-textbox-control":"form-control-textbox":n.Name=="sfwLabel"?n.IsSelected?"select-label-control":"form-fixed-width":n.Name=="sfwDropDownList"||n.Name=="sfwMultiSelectDropDownList"?n.IsSelected?"select-dropdown-control":"form-control-dropdown":n.Name=="sfwCascadingDropDownList"?n.IsSelected?"select-cascading-dropdown-control":"form-control-cascading-dropdown":n.Name=="sfwButton"?n.IsSelected?"select-button-control":"form-control-button":n.Name=="sfwToolTipButton"?n.IsSelected?"select-tooltip-button-control":"form-control-tooltip-button":n.Name=="sfwLinkButton"?n.IsSelected?"select-link-control-button":"link-control-button":n.Name=="sfwImageButton"?n.IsSelected?"select-image-control-button":"image-control-button":n.Name=="sfwHyperLink"?n.IsSelected?"select-hyperlink-control":"form-control-hyperlink":n.IsSelected?"select-label-control":"form-fixed-width",t+=n.dictAttributes&&n.dictAttributes.Text?" ":n.dictAttributes&&n.dictAttributes.sfwCaption?" ":n.dictAttributes&&n.dictAttributes.sfwEntityField?" font-entityfield":n.dictAttributes&&n.dictAttributes.sfwObjectField?" font-entityfield":n.dictAttributes&&n.dictAttributes.ID?" font-controlid":" font-controlid",n.isAdvanceSearched&&(t+=" bckgGrey"),n.IsSelected&&n.isAdvanceSearched&&(t+=" bckgGreen"),t}function selectControlOnDoubleClick(n,t){var i=getCurrentFileScope();i&&i.selectControlOnDoubleClick&&i.selectControlOnDoubleClick(n,t)}function selectControl(n,t,i){var r=getCurrentFileScope();r&&r.selectControl&&(r.selectControl(n,t,i),$("#"+r.currentfile.FileName).find("[drag-handler-btn]").remove());n.Name!="sfwColumn"&&n.Name!="TemplateField"&&n.Name!="sfwToolTipButton"&&(t?funcontrolDragEnter($(t.currentTarget)[0],n,i):n.IsSelected&&funcontrolDragEnter($(element).find("[control-head]")[0],n,i))}function OnInsertRowAboveClick(n,t,i){var r=t.Elements.indexOf(n.ParentVM),u=InsertRow(n,r,t),f=GetIndexToInsert(!1,r);i.InsertItem(u,t.Elements,f)}function OnInsertRowBelowClick(n,t,i){var r=t.Elements.indexOf(n.ParentVM),u=InsertRow(n,r,t),f=GetIndexToInsert(!0,r);i.InsertItem(u,t.Elements,f)}function OnInsertColumnLeftClick(n,t){var r=n.ParentVM.Elements.indexOf(n),i=getCurrentFileScope();i&&i.InsertColumn&&i.InsertColumn(n,!1,r,t)}function OnInsertColumnRightClick(n,t){var r=n.ParentVM.Elements.indexOf(n),i=getCurrentFileScope();i&&i.InsertColumn&&i.InsertColumn(n,!0,r,t)}function ClearCell(n,t,i){for(i&&t.UndRedoBulkOp("Start");n.Elements.length>0;)t.DeleteItem(n.Elements[0],n.Elements);i&&t.UndRedoBulkOp("End")}function OnClearGridClick(n,t){function i(n){angular.forEach(n.Elements,r)}function r(n){ClearCell(n,t,!1)}t.UndRedoBulkOp("Start");n&&angular.forEach(n.Elements,i);t.UndRedoBulkOp("End")}function OnDeleteRowClick(n,t,i,r){var u=t.Elements.indexOf(n);null!=t&&(n&&(t.Elements.length>1?i.DeleteItem(n,t.Elements):r.Message("Message","Atleast one row should be present.")),u=u-1)}function OnDeleteColumnClick(n,t,i,r,u){function s(n){for(var r,t=0;t<n.Elements.length;t++)if(r=n.Elements[t],t==o){i.DeleteItem(r,n.Elements);break}}var f=n.ParentVM.Elements.indexOf(n),e,o;n&&(e=GetMaxColCount(n.ParentVM,t),e>1?(o=n.ParentVM.Elements.indexOf(n),i.UndRedoBulkOp("Start"),angular.forEach(t.Elements,s),i.UndRedoBulkOp("End")):u.Message("Message","Atleast one column should be present"));f>0&&(f=f-1);f>-1&&f<n.ParentVM.Elements.length&&n.ParentVM.Elements[f]&&SetFormSelectedControl(r,n.ParentVM.Elements[f],null)}function AddControlToCell(n,t,i,r,u,f,e,o,s,h){if(i||(i=CreateControl(u,n,t,r)),i!=null&&n&&i.Name!="udc"&&((i.Name=="sfwDialogPanel"||i.Name=="sfwPanel")&&(i.initialvisibilty=!0,i.isLoaded=!0),e.UndRedoBulkOp("Start"),e.PushItem(i,n.Elements),r&&u&&u.dictAttributes.sfwType!="Lookup"&&i.Name!="sfwLabel"&&i.Name!="sfwButton"&&i.Name!="sfwLinkButton"&&i.Name!="sfwImageButton"&&i.Name!=="sfwButtonGroup"&&f.Name=="sfwGridView"&&(e.EditPropertyValue(f.dictAttributes.sfwTwoWayBinding,f.dictAttributes,"sfwTwoWayBinding","True"),e.EditPropertyValue(f.dictAttributes.AllowEditing,f.dictAttributes,"AllowEditing","True"),e.EditPropertyValue(f.dictAttributes.sfwCommonFilterBox,f.dictAttributes,"sfwCommonFilterBox","False"),e.EditPropertyValue(f.dictAttributes.sfwFilterOnKeyPress,f.dictAttributes,"sfwFilterOnKeyPress","False")),e.UndRedoBulkOp("End"),SetFormSelectedControl(u,i)),i!=undefined&&i.Name=="udc"){o.objSetUCProp={StrId:i.dictAttributes.ID,StrName:i.dictAttributes.Name,StrEntityField:i.dictAttributes.sfwEntityField,StrResource:i.dictAttributes.sfwResource,formObject:u};o.objSetUCProp.IsAddedFromObjectTree=!1;o.onUserControlOkClick=function(){if(i.dictAttributes.ID=o.objSetUCProp.StrId,i.dictAttributes.Name=o.objSetUCProp.StrName,i.dictAttributes.sfwEntityField=u.dictAttributes.sfwEntity!=undefined&&u.dictAttributes.sfwEntity!=""&&o.objSetUCProp.StrEntityField!=undefined&&o.objSetUCProp.StrEntityField!=""?o.objSetUCProp.StrEntityField.match("^"+u.dictAttributes.sfwEntity)?u.dictAttributes.sfwEntity+"."+o.objSetUCProp.StrEntityField:o.objSetUCProp.StrEntityField:o.objSetUCProp.StrEntityField,i.dictAttributes.sfwResource=o.objSetUCProp.StrResource,i.dictAttributes.Name!=undefined&&i.dictAttributes.Name!=""){var t=[],r={FileName:i.dictAttributes.Name,ID:i.dictAttributes.ID};t.push(r);$.connection.hubForm.server.getUserControlModel(t,"").done(function(n){var t=getCurrentFileScope();t.receiveUcMainTable(n)})}e.PushItem(i,n.Elements);o.onUserControlCancelClick()};o.onUserControlCancelClick=function(){var n=getCurrentFileScope();n&&n.validationErrorList&&s.removeObjInToArray(n.validationErrorList,o.objSetUCProp);c&&c.close()};o.ValidateUserProp=function(){var n=!1,t,i;return o.ErrorMessageForDisplay="",o.objSetUCProp.StrId==undefined||o.objSetUCProp.StrId==""?(o.ErrorMessageForDisplay="Error: Enter the ID.",n=!0):(t=[],CheckforDuplicateID(u,o.objSetUCProp.StrId,t),t.length>0?(o.ErrorMessageForDisplay="Error: Duplicate ID.",n=!0):isValidIdentifier(o.objSetUCProp.StrId,!1,!1)||(o.ErrorMessageForDisplay="Error: Invalid ID.",n=!0)),o.objSetUCProp.StrName&&o.objSetUCProp.StrName!=""?o.objSetUCProp.StrResource&&o.objSetUCProp.StrResource!=""||(o.ErrorMessageForDisplay="Please Enter Resource.",n=!0):(o.ErrorMessageForDisplay="Please Enter Active Form.",n=!0),(o.ErrorMessageForDisplay==undefined||o.ErrorMessageForDisplay=="")&&o.objSetUCProp.StrEntityField!=undefined&&o.objSetUCProp.StrEntityField!=""&&(i=h.GetEntityFieldObjectFromEntityField(o.formodel.dictAttributes.sfwEntity,o.objSetUCProp.StrEntityField),i&&i.Type=="Object"||(o.ErrorMessageForDisplay="Entity Field should be Object.",n=!0)),o.objSetUCProp.errors&&s.isEmptyObj(o.objSetUCProp.errors)&&(n=!0),n};var c=e.showDialog(o,"User Control","Form/views/SetUserControlProperties.html")}}app.controller("FormController",["$scope","$rootScope","ngDialog","$EntityIntellisenseFactory","$NavigateToFileService","$timeout","$filter","hubcontext","$compile","ConfigurationFactory","$getQueryparam","FormDetailsFactory","CONSTANTS","$ValidationService","$Errors","$GetEntityFieldObjectService","$Entityintellisenseservice","$getModelList","$SgMessagesService","$GetGridEntity",function(n,t,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,d,g,nt){function ut(n,t,i){var u=$(t),r=u.find(".HighlightRowWrapper");switch(i.toLowerCase()){case"sfwvisiblerule":r.append("<span title='"+$(n).attr("sfwVisibleRule")+"' class='blk-blue'><\/span>");break;case"sfwselectcolvisiblerule":r.append("<span title='"+$(n).attr("sfwSelectColVisibleRule")+"' class='blk-blue'><\/span>");break;case"sfwautoquery":r.append("<span title='"+$(n).attr("sfwAutoQuery")+"' class='blk-red'><\/span>");break;case"sfwretrievalquery":r.append("<span title='"+$(n).attr("sfwRetrievalQuery")+"' class='blk-green'><\/span>");break;case"sfwreadonlyrule":r.append("<span title='"+$(n).attr("sfwReadOnlyRule")+"' class='blk-purple'><\/span>");break;case"sfwvalidationrules":r.append("<span title='"+$(n).attr("sfwValidationRules")+"' class='blk-brown'><\/span>")}$(n).append(u)}function vt(n,t,i){var f=!1,r=FindParent(n,i),u=FindParent(t,i);return r||u?r&&u&&r.dictAttributes&&u.dictAttributes?r.dictAttributes.ID!=u.dictAttributes.ID&&(f=!0):r&&u||(f=!0):f=!1,f}var pt,ot,st,ht,rt,it,wt,lt,at,et,tt,yt;t.IsLoading=!0;n.lstLoadedEntityTrees=[];n.lstLoadedEntityColumnsTree=[];n.entityTreeName="";n.currentEntiyTreeObject=undefined;n.lookupTreeObject=[];n.ColumnsLimitCount=50;n.LstDisplayedEntities=[];n.MainPanels=[];n.MainPanelID="";n.selectedDesignSource=!1;n.IsEntityTreeExpanded=!1;n.IsToolsDivCollapsed=!1;n.isDeveloperView=!1;n.SelectedQuery=undefined;n.DesignHighlightAttribute=null;n.lstselectedobjecttreefields=[];n.selectedobjecttreefield=undefined;n.lstEntity=[];n.ObjgridBoundedQuery={};n.lstControl=v.FORM.CONTROL_TYPES;n.parameterList=[];n.currentfile=t.currentopenfile.file;hubMain.server.getModel(n.currentfile.FilePath,n.currentfile.FileType).done(function(i){i?n.receiveformmodel(i):t.closeFile(n.currentfile.FileName)});n.receiveformmodel=function(i){n.$apply(function(){var r,s,f,u,h,c;if(n.currentfile.FileType=="Maintenance"&&(r=a.getFormDetails(),r&&(s={FileType:"Lookup",FileName:"wfm"+r.ID+"Lookup",FilePath:r.Path,FileID:"wfm"+r.ID+"Lookup"},t.SaveModelWithPackets(r.objSfxLookupForm,s,undefined,!0),a.setFormDetails(undefined))),n.FormModel=i,n.MainPanels=[],n.UDCTableList=[],n.objFormExtraFields=[],n.SetMainTable(),n.InitialLoad||(n.InitialLoad={Name:"initialload",Value:"",dictAttributes:{},Elements:[],Children:[]}),n.FormModel.dictAttributes.sfwType!="UserControl"&&(n.FindDeepNodeUDC(n.FormModel,n.UDCTableList),n.UDCTableList.length>0&&n.SetUDCMainTable()),n.MainPanelID="MainParentPanel"+n.FormModel.dictAttributes.ID,n.MainPanels.length>0&&(n.MainPanels[0].dictAttributes.ID=="pnltoolbar"&&n.MainPanels.length>1?n.selectPanelControl(n.MainPanels[1]):n.selectPanelControl(n.MainPanels[0])),n.FormModel.dictAttributes.sfwType=="Lookup"&&n.PopulateQueryId(!0),f={EntityName:n.FormModel.dictAttributes.sfwEntity,IsVisible:!0,selectedobjecttreefield:undefined,lstselectedobjecttreefields:[],IsQuery:!1,IsMainEntity:!0},n.FormModel.IsLookupCriteriaEnabled&&(f.IsVisible=!1),n.lstLoadedEntityTrees&&n.lstLoadedEntityTrees.length>0)for(u=0;u<n.lstLoadedEntityTrees.length;u++)n.lstLoadedEntityTrees[u].IsVisible=n.lstLoadedEntityTrees[u].EntityName!=n.FormModel.dictAttributes.sfwEntity||n.lstLoadedEntityTrees[u].IsQuery?!1:!0;else n.lstLoadedEntityTrees.push(f),n.entityTreeName=n.FormModel.dictAttributes.sfwEntity,n.currentEntiyTreeObject=f;n.InitialLoadSection();(n.FormModel.dictAttributes.sfwType=="UserControl"||n.FormModel.dictAttributes.ID.startsWith("wfp"))&&(n.FormModel.IsLookupCriteriaEnabled=!1);n.objFormExtraFields=o("filter")(n.FormModel.Elements,{Name:"ExtraFields"});n.objFormExtraFields.length>0&&(n.objFormExtraFields=n.objFormExtraFields[0]);n.objFormExtraFields.length==0&&(n.objFormExtraFields={Name:"ExtraFields",Value:"",dictAttributes:{},Elements:[]});e(function(){r||(t.IsLoading=!1)});n.PopulateRemoteObjects();n.validationErrorList=[];p.validationListObj&&angular.isArray(p.validationListObj)&&(h=o("filter")(p.validationListObj,{FileName:n.currentfile.FileName}),h.length==0&&p.validationListObj.push({FileName:n.currentfile.FileName,errorList:[]}),c=o("filter")(p.validationListObj,{FileName:n.currentfile.FileName})[0],n.validationErrorList=c.errorList=[]);n.formTableModel=o("filter")(n.FormModel.Elements,{Name:"sfwTable"})[0];ht(n.FormModel.objExtraData);n.iswizard=n.FormModel.dictAttributes.sfwType=="Wizard"?!0:!1;n.isLookup=n.FormModel.dictAttributes.sfwType=="Lookup"?!0:!1;n.IsPrototype=n.FormModel.dictAttributes.ID&&n.FormModel.dictAttributes.ID.startsWith("wfp")?!0:!1});n.currentfile.SelectNodePath&&n.currentfile.SelectNodePath!=""&&n.selectElement(n.currentfile.SelectNodePath);CheckForFilterGrid(n.FormModel)};n.SetFormSelectedControl=function(t){SetFormSelectedControl(n.FormModel,t,event)};n.PopulateRemoteObjects=function(){$.connection.hubForm.server.getRemoteObjectList().done(function(t){n.$evalAsync(function(){t&&(n.FormModel.RemoteObjectCollection=t,n.FormModel.RemoteObjectCollection&&n.FormModel.RemoteObjectCollection.length>0&&n.FormModel.RemoteObjectCollection.splice(0,0,{dictAttributes:{ID:""}}))})})};n.validateFileData=function(){var t,i;p.validationListObj&&angular.isArray(p.validationListObj)&&(t=o("filter")(p.validationListObj,{FileName:n.currentfile.FileName}),t.length==0&&p.validationListObj.push({FileName:n.currentfile.FileName,errorList:[]}),i=o("filter")(p.validationListObj,{FileName:n.currentfile.FileName})[0],n.validationErrorList=i.errorList=[]);n.formTableModel&&(n.iterateModel(n.formTableModel),pt());e(function(){$("#validation-btn").prop("disabled",!1)})};pt=function(){n.lstEntity=[];n.parameterList=[];n.FormModel&&n.FormModel.dictAttributes.hasOwnProperty("sfwEntity")&&y.validateEntity(n.FormModel,undefined);n.FormModel.dictAttributes.sfwEntity&&n.FormModel.errors&&!n.FormModel.errors.invalid_entity&&(t.IsLoading=!0,n.lstEntity.push(n.FormModel.dictAttributes.sfwEntity),ot(n.FormModel,n.FormModel.dictAttributes.sfwEntity),angular.isArray(n.lstQueriesName)&&n.lstQueriesName.length>0&&$.connection.hubForm.server.getQueriesResult(n.lstQueriesName,"dummy").done(function(t){n.$evalAsync(function(){t&&(n.gridQueryResult=t)})}),$.connection.hubForm.server.getGlobleParameters().done(function(t){n.$evalAsync(function(){t&&n.objGlobleParametersList(t)})}),n.isLookup&&st(n.FormModel),$.connection.hubMain.server.getFormValidationData(n.lstEntity).done(function(i){n.$evalAsync(function(){var u,r;n.validationData=i;n.objEntityExtraData={};n.resourceList=y.getListByPropertyName(n.validationData.Resources,"ResourceID",!1);n.validationData.hasOwnProperty(n.FormModel.dictAttributes.sfwEntity)&&(ht(n.validationData[n.FormModel.dictAttributes.sfwEntity]),n.objEntityExtraData.lstHardErrors=n.createValidationRuleList(n.validationData[n.FormModel.dictAttributes.sfwEntity],!1,n.FormModel.dictAttributes.sfwHardErrorGroup));n.FormModel.dictAttributes.hasOwnProperty("sfwResource")&&n.FormModel.dictAttributes.sfwResource&&y.checkValidListValue(n.resourceList,n.FormModel,n.FormModel.dictAttributes.sfwResource,"sfwResource","invalid_resource",v.VALIDATION.RESOURCE_NOT_EXISTS,n.validationErrorList);u=y.getListByPropertyName(n.lstMessages,"MessageID",!1);n.FormModel.dictAttributes.hasOwnProperty("sfwNewMessageID")&&n.FormModel.dictAttributes.sfwNewMessageID&&y.checkValidListValue(u,n.FormModel,n.FormModel.dictAttributes.sfwNewMessageID,"sfwNewMessageID","sfwNewMessageID",v.VALIDATION.INVALID_MESSAGE_ID,n.validationErrorList);n.FormModel.dictAttributes.hasOwnProperty("sfwOpenMessageID")&&n.FormModel.dictAttributes.sfwOpenMessageID&&y.checkValidListValue(u,n.FormModel,n.FormModel.dictAttributes.sfwOpenMessageID,"sfwOpenMessageID","sfwOpenMessageID",v.VALIDATION.INVALID_MESSAGE_ID,n.validationErrorList);n.FormModel.dictAttributes.hasOwnProperty("sfwDefaultButtonID")&&n.FormModel.dictAttributes.sfwDefaultButtonID&&(r=[],FindControlListByName(n.SfxMainTable,"sfwButton",r),r=y.getListByPropertyName(r,"ID",!1),y.checkValidListValue(r,n.FormModel,n.FormModel.dictAttributes.sfwDefaultButtonID,"sfwDefaultButtonID","sfwDefaultButtonID",v.VALIDATION.BUTTON_NOT_EXISTS,n.validationErrorList));e(function(){rt(n.formTableModel,n.FormModel.dictAttributes.sfwEntity,n.objEntityExtraData);n.$evalAsync(function(){t.IsLoading=!1})})})}))};n.objGlobleParametersList=function(t){angular.forEach(t.Elements,function(t){if(t&&t.dictAttributes.ID){var i="~"+t.dictAttributes.ID;n.parameterList.push(i)}})};n.lstQueriesName=[];ot=function(t,i){angular.forEach(t.Elements,function(t){var r,u,f,e;v.FORM.COLLECTION_TYPE_NODES.indexOf(t.Name)>-1&&(r=null,t.Name=="sfwGridView"&&t.dictAttributes.sfwBoundToQuery&&t.dictAttributes.sfwBoundToQuery.toLowerCase()=="true"&&t.dictAttributes.sfwBaseQuery&&n.lstQueriesName.push(t.dictAttributes.sfwBaseQuery),t.Name=="sfwGridView"&&t.dictAttributes.sfwParentGrid?(u=FindControlByID(n.SfxMainTable,t.dictAttributes.sfwParentGrid),u&&u.dictAttributes.sfwEntityField&&(f=w.GetEntityFieldObjectFromEntityField(n.FormModel.dictAttributes.sfwEntity,u.dictAttributes.sfwEntityField),f&&(e=w.GetEntityFieldObjectFromEntityField(f.Entity,t.dictAttributes.sfwEntityField),e&&(r=e.Entity)))):r=ft(t.dictAttributes.sfwEntityField,i),r&&n.lstEntity.indexOf(r)<=-1&&n.lstEntity.push(r));t&&t.dictAttributes.ID&&n.parameterList.push(t.dictAttributes.ID);t.Elements&&t.Elements.length>0&&ot(t,i)})};st=function(t){angular.forEach(t.Elements,function(t){if(t.dictAttributes.hasOwnProperty("sfwDataField")&&t.dictAttributes.sfwDataField)var i=u.getEntityIntellisense(),r=PopulateColumnList(t.dictAttributes.sfwQueryID,n.FormModel,i,n.lstLoadedEntityColumnsTree);t.Elements&&t.Elements.length>0&&st(t)})};n.objEntityExtraData={};ht=function(t){n.objEntityExtraData.lstRules=PopulateEntityRules(t,n.iswizard,n.FormModel.dictAttributes.sfwInitialLoadGroup)};rt=function(t,i,r,f,e){angular.forEach(t.Elements,function(o){var h,ot,d,st,c,p,s,l,ht,a,g,tt,ut,et,b,k,w;o.ParentVM=t;o.dictAttributes.hasOwnProperty("sfwVisibleRule")&&o.dictAttributes.sfwVisibleRule&&(h=r.lstRules,o.dictAttributes.sfwRelatedGrid&&(h=it(o)),o.dictAttributes.sfwParentGrid&&(h=it(o)),o.Name!="HeaderTemplate"&&o.Name!="FooterTemplate"&&FindParent(o,"sfwGridView")&&(h=it(o)),y.checkValidListValue(h,o,undefined,"sfwVisibleRule","invalid_visible_rule",v.VALIDATION.VISIBLE_RULE_NOT_EXISTS,n.validationErrorList));o.dictAttributes.hasOwnProperty("sfwSelectColVisibleRule")&&o.dictAttributes.sfwSelectColVisibleRule&&(h=r.lstRules,o.dictAttributes.sfwRelatedGrid&&(h=it(o)),o.dictAttributes.sfwParentGrid&&(h=it(o)),o.Name!="HeaderTemplate"&&o.Name!="FooterTemplate"&&FindParent(o,"sfwGridView")&&(h=it(o)),y.checkValidListValue(h,o,undefined,"sfwSelectColVisibleRule","sfwSelectColVisibleRule",v.VALIDATION.VISIBLE_RULE_NOT_EXISTS,n.validationErrorList));o.dictAttributes.hasOwnProperty("sfwEnableRule")&&o.dictAttributes.sfwEnableRule&&(h=r.lstRules,o.dictAttributes.sfwRelatedGrid&&(h=it(o)),y.checkValidListValue(h,o,undefined,"sfwEnableRule","invalid_enable_rule",v.VALIDATION.ENABLE_RULE_NOT_EXISTS,n.validationErrorList));o.dictAttributes.hasOwnProperty("sfwReadOnlyRule")&&o.dictAttributes.sfwReadOnlyRule&&(h=r.lstRules,o.dictAttributes.sfwRelatedGrid&&(h=it(o)),y.checkValidListValue(h,o,undefined,"sfwReadOnlyRule","invalid_readonly_rule",v.VALIDATION.READONLY_RULE_NOT_EXISTS,n.validationErrorList));o.dictAttributes.hasOwnProperty("sfwRulesGroup")&&o.dictAttributes.sfwRulesGroup&&n.validateGroups(o,i);o.dictAttributes.hasOwnProperty("sfwEntityField")&&e?n.validateGridControlField(o,e,t):o.dictAttributes.hasOwnProperty("sfwEntityField")&&o.Name!="parameter"&&o.dictAttributes.sfwEntityField&&(ot="",s=i,FindParent(o,"sfwGridView")&&(s=nt.getEntityName(n.FormModel,o)),(o.dictAttributes.sfwEntityField=="InternalErrors"||o.dictAttributes.sfwEntityField=="ExternalErrors")&&(s="entError"),o.dictAttributes.sfwRelatedGrid&&(s=n.FindEntityName(o,n.FormModel.dictAttributes.sfwEntity)),o.dictAttributes.sfwParentGrid&&(s=n.FindEntityName(o,n.FormModel.dictAttributes.sfwEntity)),y.checkValidListValueForMultilevel([],o,o.dictAttributes.sfwEntityField,s,"sfwEntityField","sfwEntityField",v.VALIDATION.ENTITY_FIELD_INCORRECT,n.validationErrorList,!1,ot));o.dictAttributes.hasOwnProperty("sfwRetrievalQuery")&&o.dictAttributes.sfwRetrievalQuery&&y.checkValidQuery(u.getEntityIntellisense(),o,o.dictAttributes.sfwRetrievalQuery,undefined,"sfwRetrievalQuery","sfwRetrievalQuery",v.VALIDATION.INVALID_QUERY,n.validationErrorList);o.dictAttributes.hasOwnProperty("sfwRetrievalMethod")&&o.dictAttributes.sfwRetrievalMethod&&(s=i,o.dictAttributes.sfwRelatedGrid&&(s=n.FindEntityName(o,n.FormModel.dictAttributes.sfwEntity)),p=ct(s,!1,!0),y.checkValidListValue(p,o,o.dictAttributes.sfwRetrievalMethod,"sfwRetrievalMethod","invalid_retrieval_method",v.VALIDATION.INVALID_METHOD,n.validationErrorList));o.dictAttributes.hasOwnProperty("sfwAutoQuery")&&o.dictAttributes.sfwAutoQuery&&y.checkValidQuery(u.getEntityIntellisense(),o,o.dictAttributes.sfwAutoQuery,undefined,"sfwAutoQuery","sfwAutoQuery",v.VALIDATION.INVALID_QUERY,n.validationErrorList);o.dictAttributes.hasOwnProperty("sfwBaseQuery")&&o.dictAttributes.sfwBaseQuery&&y.checkValidQuery(u.getEntityIntellisense(),o,o.dictAttributes.sfwBaseQuery,undefined,"sfwBaseQuery","sfwBaseQuery",v.VALIDATION.INVALID_QUERY,n.validationErrorList);o.dictAttributes.hasOwnProperty("sfwResource")&&o.dictAttributes.sfwResource&&o.dictAttributes.sfwResource!=0&&y.checkValidListValue(n.resourceList,o,o.dictAttributes.sfwResource,"sfwResource","invalid_resource",v.VALIDATION.RESOURCE_NOT_EXISTS,n.validationErrorList);o.dictAttributes.hasOwnProperty("sfwValidationRules")&&o.dictAttributes.sfwValidationRules&&(d=r.lstHardErrors,o.dictAttributes.sfwRelatedGrid&&(d=wt(o)),y.checkMultipleValueWithList(d,o,o.dictAttributes.sfwValidationRules,";","sfwValidationRules","invalid_validation_rule",v.VALIDATION.VALIDATION_RULE_NOT_EXISTS,n.validationErrorList));o.dictAttributes.hasOwnProperty("sfwActiveForm")&&o.dictAttributes.sfwActiveForm&&lt(o);o.dictAttributes.hasOwnProperty("Name")&&o.dictAttributes.Name&&o.Name=="udc"&&lt(o);o.dictAttributes.hasOwnProperty("sfwExpression")&&o.dictAttributes.sfwExpression&&(st=u.getEntityIntellisense(),c=getEntityAttributeByType(st,i,"Expression"),c=y.getListByPropertyName(c,"ID",!1),y.checkValidListValue(c,o,o.dictAttributes.sfwExpression,"sfwExpression","invalid_expression",v.VALIDATION.INVALID_EXPRESSION,n.validationErrorList));o.dictAttributes.hasOwnProperty("sfwMessageID")&&o.dictAttributes.sfwMessageID&&(c=y.getListByPropertyName(n.lstMessages,"MessageID",!1),y.checkValidListValue(c,o,o.dictAttributes.sfwMessageID,"sfwMessageID","sfwMessageID",v.VALIDATION.INVALID_MESSAGE_ID,n.validationErrorList));(o.Name=="sfwDropDownList"||o.Name=="sfwCascadingDropDownList"||o.Name=="sfwMultiSelectDropDownList"||o.Name=="sfwListPicker"||o.Name=="sfwListBox"||o.Name=="sfwRadioButtonList")&&o.dictAttributes.sfwLoadType=="CodeGroup"&&(c=y.getListByPropertyName(n.validationData.CodeGroup,"CodeID"),c.push("0"),n.validateEmptyCodeId(o,c,i));o.dictAttributes.hasOwnProperty("sfwLoadSource")&&o.dictAttributes.sfwLoadSource&&(o.dictAttributes.sfwLoadType=="Query"?y.checkValidQuery(u.getEntityIntellisense(),o,o.dictAttributes.sfwLoadSource,undefined,"sfwLoadSource","sfwLoadSource",v.VALIDATION.INVALID_QUERY,n.validationErrorList):o.dictAttributes.sfwLoadType=="Method"?(s=i,o.dictAttributes.sfwRelatedGrid&&(s=n.FindEntityName(o,n.FormModel.dictAttributes.sfwEntity)),p=ct(s,!0,!1),y.checkValidListValue(p,o,o.dictAttributes.sfwLoadSource,"sfwLoadSource","invalid_method",v.VALIDATION.INVALID_METHOD,n.validationErrorList)):o.dictAttributes.sfwLoadType=="ServerMethod"&&bt(o));o.dictAttributes.hasOwnProperty("XValueMember")&&o.dictAttributes.XValueMember&&(y.checkValidListValueForMultilevel([],o,o.dictAttributes.XValueMember,i,"XValueMember","XValueMember",v.VALIDATION.INVALID_FIELD,n.validationErrorList,!1,""),at(o,f));o.dictAttributes.hasOwnProperty("YValueMembers")&&o.dictAttributes.YValueMembers&&(y.checkValidListValueForMultilevel([],o,o.dictAttributes.YValueMembers,i,"YValueMembers","YValueMembers",v.VALIDATION.INVALID_FIELD,n.validationErrorList,!1,""),at(o,f));o.dictAttributes.hasOwnProperty("sfwCodeTable")&&o.dictAttributes.sfwCodeTable&&y.checkValidQuery(u.getEntityIntellisense(),o,o.dictAttributes.sfwCodeTable,undefined,"sfwCodeTable","sfwCodeTable",v.VALIDATION.INVALID_CODE_TABLE,n.validationErrorList);o.dictAttributes.hasOwnProperty("sfwEntityField")&&o.dictAttributes.sfwEntityField&&o.dictAttributes.hasOwnProperty("sfwMethodName")&&o.dictAttributes.sfwMethodName=="btnOpen_Click"&&(c=n.PopulateEntityFieldsForOpenButton(o,n.isLookup),y.checkValidListValue(c,o,o.dictAttributes.sfwEntityField,"sfwEntityField","sfwEntityField",v.VALIDATION.ENTITY_FIELD_INCORRECT,n.validationErrorList));n.isLookup&&!n.IsPrototype&&o.dictAttributes.hasOwnProperty("sfwQueryID")&&o.dictAttributes.sfwQueryID&&y.checkValidListValue(n.queryIDList,o,o.dictAttributes.sfwQueryID,"sfwQueryID","invalid_query_id",v.VALIDATION.INVALID_QUERY_ID,n.validationErrorList);o.dictAttributes.hasOwnProperty("sfwParameters")&&o.dictAttributes.sfwParameters&&n.validateParameters(o,o.dictAttributes.sfwParameters,"sfwParameters");o.dictAttributes.hasOwnProperty("sfwAutoParameters")&&o.dictAttributes.sfwAutoParameters&&n.validateParameters(o,o.dictAttributes.sfwAutoParameters,"sfwAutoParameters");o.dictAttributes.hasOwnProperty("sfwCascadingRetrievalParameters")&&o.dictAttributes.sfwCascadingRetrievalParameters&&n.validateParameters(o,o.dictAttributes.sfwCascadingRetrievalParameters,"sfwCascadingRetrievalParameters");o.dictAttributes.hasOwnProperty("sfwObjectMethod")&&o.dictAttributes.sfwObjectMethod&&(p=ct(i,!1,!1),y.checkValidListValue(p,o,o.dictAttributes.sfwObjectMethod,"sfwObjectMethod","sfwObjectMethod",v.VALIDATION.INVALID_METHOD,n.validationErrorList),o&&o.errors&&o.errors.sfwObjectMethod&&bt(o,"sfwObjectMethod"));o.dictAttributes.hasOwnProperty("sfwEntityField")&&o.dictAttributes.sfwEntityField&&(o.Name=="sfwScheduler"||o.Name=="sfwCalendar")&&(s=ft(o.dictAttributes.sfwEntityField,i),o.dictAttributes.hasOwnProperty("sfwEventId")&&o.dictAttributes.sfwEventId&&y.checkValidListValueForMultilevel([],o,o.dictAttributes.sfwEventId,s,"sfwEventId","sfwEventId",v.VALIDATION.INVALID_FIELD,n.validationErrorList,!1,""),o.dictAttributes.hasOwnProperty("sfwEventName")&&o.dictAttributes.sfwEventName&&y.checkValidListValueForMultilevel([],o,o.dictAttributes.sfwEventName,s,"sfwEventName","sfwEventName",v.VALIDATION.INVALID_FIELD,n.validationErrorList,!1,""),o.dictAttributes.hasOwnProperty("sfwEventStartDate")&&o.dictAttributes.sfwEventStartDate&&y.checkValidListValueForMultilevel([],o,o.dictAttributes.sfwEventStartDate,s,"sfwEventStartDate","sfwEventStartDate",v.VALIDATION.INVALID_FIELD,n.validationErrorList,!1,""),o.dictAttributes.hasOwnProperty("sfwEventEndDate")&&o.dictAttributes.sfwEventEndDate&&y.checkValidListValueForMultilevel([],o,o.dictAttributes.sfwEventEndDate,s,"sfwEventEndDate","sfwEventEndDate",v.VALIDATION.INVALID_FIELD,n.validationErrorList,!1,""),o.dictAttributes.hasOwnProperty("sfwEventCategory")&&o.dictAttributes.sfwEventCategory&&y.checkValidListValueForMultilevel([],o,o.dictAttributes.sfwEventCategory,s,"sfwEventCategory","sfwEventCategory",v.VALIDATION.INVALID_FIELD,n.validationErrorList,!1,""));o.Elements&&o.Elements.length>0&&(f&&f.errors&&f.errors.hasOwnProperty("series_errors")&&!y.isEmptyObj(f.errors.series_errors)&&delete f.errors.series_errors,l={},o.Name=="sfwWizardStep"?(ht=o.dictAttributes.sfwRulesGroup,l.lstHardErrors=n.createValidationRuleList(n.validationData[i],n.iswizard,ht),l.lstRules=PopulateEntityRules(n.validationData[i],n.iswizard,null),rt(o,i,l,f,e)):v.FORM.COLLECTION_TYPE_NODES.indexOf(o.Name)>-1?(g="",o.dictAttributes.sfwEntityField&&(o.dictAttributes.sfwEntityField=="InternalErrors"||o.dictAttributes.sfwEntityField=="ExternalErrors")?a="entError":o.Name=="sfwGridView"&&o.dictAttributes.sfwBoundToQuery&&o.dictAttributes.sfwBoundToQuery.toLowerCase()=="true"?g=o.dictAttributes.sfwBaseQuery:a=o.dictAttributes.sfwParentGrid&&o.dictAttributes.sfwEntityField?n.FindEntityName(o,n.FormModel.dictAttributes.sfwEntity,!0):ft(o.dictAttributes.sfwEntityField,i),tt={},o.Name=="sfwChart"&&(tt=o),a?(n.validationData&&n.validationData.hasOwnProperty(a)&&(l.lstHardErrors=n.createValidationRuleList(n.validationData[a],n.iswizard,null),l.lstRules=PopulateEntityRules(n.validationData[a],n.iswizard,null)),rt(o,a,l,tt,e)):rt(o,i,r,f,g)):o.Name=="sfwDialogPanel"?(ut=o.dictAttributes.ID,ut&&(b=GetFieldFromFormObject(n.SfxMainTable,"sfwButton","sfwRelatedDialogPanel",ut),b&&b.length>0&&b[0].dictAttributes.sfwRelatedControl&&(k=GetFieldFromFormObject(n.SfxMainTable,"sfwGridView","ID",b[0].dictAttributes.sfwRelatedControl),k&&k.length>0&&(et=k[0].dictAttributes.sfwEntityField))),et&&(w=ft(et,i),n.validationData&&n.validationData.hasOwnProperty(w)&&(l.lstHardErrors=n.createValidationRuleList(n.validationData[w],n.iswizard,null),l.lstRules=PopulateEntityRules(n.validationData[w],n.iswizard,null))),w?rt(o,w,l,f,e):rt(o,i,r,f,e)):rt(o,i,r,f,e))})};n.validateParameters=function(t,i,r){var u,o,f,s,e;if(!angular.isArray(n.parameterList)||!(n.parameterList.length<=0))for(u="prop-",r=="sfwAutoParameters"?u="autoprop-":r=="sfwCascadingRetrievalParameters"&&(u="cprop-"),o=i.split(";"),f=0;f<o.length;f++)s=o[f].split("="),e=s[s.length-1],y.checkValidListValue(n.parameterList,t,e,r,u+e,"parameter value("+e+") does not exists",n.validationErrorList)};n.validateGroups=function(t,i){if(n.validationData&&n.validationData.hasOwnProperty(i)){var u=n.validationData[i],r=u&&u.lstGroupsList,f=[];angular.isArray(r)&&r.length>0&&(f=y.getListByPropertyName(r[0].Elements,"ID"));y.checkValidListValue(f,t,t.dictAttributes.sfwRulesGroup,"sfwRulesGroup","sfwRulesGroup",v.VALIDATION.INVALID_GROUP,n.validationErrorList)}};n.validateGridControlField=function(t,i,r){if((t.Name==="sfwLabel"||t.Name=="parameter")&&r&&(r.Name=="HeaderTemplate"||r.Name=="FooterTemplate"||r.Name=="Parameters"))y.checkValidListValueForMultilevel([],t,t.dictAttributes.sfwEntityField,n.FormModel.dictAttributes.sfwEntity,"sfwEntityField","sfwEntityField",v.VALIDATION.ENTITY_FIELD_INCORRECT,n.validationErrorList,!1,"");else if(n.gridQueryResult&&n.gridQueryResult.hasOwnProperty(i)){var u=y.getListByPropertyName(n.gridQueryResult[i],"CodeID",!1);y.checkValidListValue(u,t,t.dictAttributes.sfwEntityField,"sfwEntityField","sfwEntityField",v.VALIDATION.ENTITY_FIELD_INCORRECT,n.validationErrorList)}};it=function(t){var r=[],i=null;return i=FindParent(t,"sfwGridView")?nt.getEntityName(n.FormModel,t):n.FindEntityName(t,n.FormModel.dictAttributes.sfwEntity),i&&(r=PopulateEntityRules(n.validationData[i],n.iswizard,null)),r};wt=function(t){var i=[],r=n.FindEntityName(t,n.FormModel.dictAttributes.sfwEntity);return r&&(i=n.createValidationRuleList(n.validationData[r],n.iswizard,null)),i};n.validateEmptyCodeId=function(t,i,r){var f="",e;t.dictAttributes.sfwRelatedGrid&&(r=n.FindEntityName(t,n.FormModel.dictAttributes.sfwEntity));n.IsSearchCriteriaSelected&&t.dictAttributes.sfwDataField?f="sfwDataField":t.dictAttributes.sfwEntityField&&(f="sfwEntityField");t.Name=="sfwCheckBoxList"&&(f="sfwCheckBoxField");t.dictAttributes.sfwLoadSource?y.checkValidListValue(i,t,t.dictAttributes.sfwLoadSource,"sfwLoadSource","invalid_code_group",v.VALIDATION.CODE_GROUP_NOT_EXISTS,n.validationErrorList):t.dictAttributes[f]&&t.errors&&!t.errors[f]&&(e=GetCodeID(r,t.dictAttributes[f],u.getEntityIntellisense()),e||y.checkValidListValue([],t,t.dictAttributes.sfwLoadSource,"sfwLoadSource","invalid_code_group",v.VALIDATION.CODE_GROUP_NOT_EXISTS,n.validationErrorList,!0))};var bt=function(t,i){var r,u,f,e;i&&i.trim().length>0||(i="sfwLoadSource");r="srvCommon";u=[];n.FormModel&&n.FormModel.dictAttributes.sfwRemoteObject&&(r=n.FormModel.dictAttributes.sfwRemoteObject);n.validationData&&n.validationData.hasOwnProperty("RemoteObject")&&(u=n.validationData.RemoteObject);f=GetServerMethodObject(r,u);e=PopulateServerMethod([],t,f,!0);y.checkValidListValue(e,t,t.dictAttributes[i],i,i,v.VALIDATION.INVALID_METHOD,n.validationErrorList)},ct=function(n,t,i){var r=b.GetIntellisenseData(n,"","",!0,!1,!0,!0,!1,!1),u=[];return r&&r.length>0&&(t?r=o("filter")(r,{ReturnType:"Collection"}):i&&(r=o("filter")(r,{ReturnType:"Object"})),r&&r.length>0&&(u=y.getListByPropertyName(r,"ID",!1))),u},ft=function(n,t){var r="",i;return n&&(i=w.GetEntityFieldObjectFromEntityField(t,n),i&&(r=i.Entity)),r};n.iterateModel=function(t){angular.forEach(t.Elements,function(t){v.FORM.IGNORE_NODES.indexOf(t.Name)<=-1&&(t.Name=="sfwTable"&&n.currentfile.FileType=="Lookup"?y.validateID(t,n.validationErrorList,t.dictAttributes.ID):t.Name!="sfwTable"&&y.validateID(t,n.validationErrorList,t.dictAttributes.ID),y.checkDuplicateId(t,n.formTableModel,n.validationErrorList,!1,v.FORM.NODES));t.Elements&&t.Elements.length>0&&v.FORM.NODES.indexOf(t.Name)>-1&&n.iterateModel(t)})};n.findParentAndChildObject=function(t){var i=[];n.FindDeepNode(n.FormModel,t,i);n.$evalAsync(function(){var t=y.createFullPath(n.FormModel,i);n.selectElement(t)})};lt=function(t){function o(n){n.FileType==e[r]&&f.push(n.FileID)}var u="sfwActiveForm",i="Lookup,Maintenance,Wizard,FormLinkLookup,FormLinkMaintenance,FormLinkWizard",f,e,r;if(t.dictAttributes.sfwMethodName=="btnCorrespondenceRows_Click"?i="Maintenance,FormLinkMaintenance":t.dictAttributes.sfwMethodName=="btnOpenLookup_Click"&&(i="Lookup,FormLinkLookup,Maintenance,FormLinkMaintenance"),(t.dictAttributes.sfwMethodName=="btnNewUpdate_Click"||t.dictAttributes.sfwMethodName=="btnPrototypeSearch_Click")&&(i="Maintenance,FormLinkMaintenance"),t.dictAttributes.sfwMethodName==="btnRetrieve_Click"&&(i="Lookup,FormLinkLookup"),(t.Name=="sfwOpenDetail"||t.Name=="sfwMultiCorrespondence")&&(i="Maintenance,FormLinkMaintenance"),t.Name=="sfwToolTipButton"&&(i="Tooltip,"),t.Name=="udc"&&(i="UserControl,",u="Name"),f=[],i.indexOf(",")>-1)for(e=i.split(","),r=0;r<e.length;r++)angular.forEach(n.validationData.ActiveForms,o);y.checkActiveForm(f,t,t.dictAttributes[u],u,"invalid_active_form",v.VALIDATION.INVALID_ACTIVE_FORM,n.validationErrorList)};at=function(n,t){t&&t.errors&&!t.errors.hasOwnProperty("series_errors")&&(t.errors.series_errors={});for(var i in n.errors)t&&t.errors&&!t.errors.series_errors.hasOwnProperty(i)&&(t.errors.series_errors[i+"_"+n.dictAttributes.Name]=n.errors[i])};n.PopulateQueryId=function(t){n.$evalAsync(function(){function u(t){t.dictAttributes.ID&&n.queryIDList.push(t.dictAttributes.ID)}n.lstQueryID=[];var r=n.FormModel.Elements.filter(function(n){return n.Name=="initialload"});if(r.length>0)for(i=0;i<r[0].Elements.length;i++)r[0].Elements[i]&&r[0].Elements[i].dictAttributes&&r[0].Elements[i].dictAttributes.ID&&n.lstQueryID.push(r[0].Elements[i]);n.lstQueryID.length>0&&(n.SelectedQuery=n.lstQueryID[0],n.MainQuery||n.lstQueryID.splice(0,0,{Name:"",dictAttributes:{ID:""}}),n.populateQueryFields(n.SelectedQuery,t));n.queryIDList=[];angular.forEach(n.lstQueryID,u)})};n.toggleSideBar=function(){n.isDeveloperView||(n.IsToolsDivCollapsed=!n.IsToolsDivCollapsed)};n.ClearSelectedColumns=function(){for(var i,t=0;t<n.lstLoadedEntityColumnsTree.length;t++)if(n.lstLoadedEntityColumnsTree[t].IsVisible==!0){if(n.lstLoadedEntityColumnsTree[t].selectedobjecttreefield&&(n.lstLoadedEntityColumnsTree[t].selectedobjecttreefield.IsRecordSelected=!1,n.lstLoadedEntityColumnsTree[t].selectedobjecttreefield.IsSelected="False"),n.lstLoadedEntityColumnsTree[t].lstselectedobjecttreefields.length>0)for(i=0;i<n.lstLoadedEntityColumnsTree[t].lstselectedobjecttreefields.length;i++)n.lstLoadedEntityColumnsTree[t].lstselectedobjecttreefields[i].IsRecordSelected=!1,n.lstLoadedEntityColumnsTree[t].lstselectedobjecttreefields[i].IsSelected="False";break}};n.populateQueryFieldsFromLookupTree=function(t,i){t?(n.SelectedQuery=t,n.populateQueryFields(t,i)):n.SelectedQuery=undefined};n.onRefreshQueryFields=function(){n.SelectedQuery&&(n.populateQueryFields(n.SelectedQuery,!0),n.ShowRefreshCompletedDialog())};n.ShowRefreshCompletedDialog=function(){var i=n.$new(),r;i.strMessage="Refresh Completed.";i.isError=!0;r=t.showDialog(i,"","StartUp/views/TFSMessageDialog.html");i.OkClick=function(){r.close()}};n.populateQueryFields=function(t,i){var u,r;if(n.ClearSelectedColumns(),t){for(r=0;r<n.lstLoadedEntityColumnsTree.length;r++)n.lstLoadedEntityColumnsTree[r].EntityName==t.dictAttributes.ID&&n.lstLoadedEntityColumnsTree[r].IsQuery==!0?(n.lstLoadedEntityColumnsTree[r].IsVisible=!0,n.lstLoadedEntityColumnsTree[r].lstselectedobjecttreefields=[],n.lookupTreeObject=n.lstLoadedEntityColumnsTree[r],u=n.lstLoadedEntityColumnsTree[r]):n.lstLoadedEntityColumnsTree[r].IsVisible=!1;u||(u={EntityName:t.dictAttributes.ID,IsVisible:i,selectedobjecttreefield:undefined,lstselectedobjecttreefields:[],IsQuery:!0,QueryRef:t.dictAttributes.sfwQueryRef,SortedColumns:[]},n.lstLoadedEntityColumnsTree.push(u),n.lookupTreeObject=u);u.SortedColumns=u.lstselectedobjecttreefields;n.ColumnsLimitCount=50;t.dictAttributes.sfwQueryRef!=undefined&&t.dictAttributes.sfwQueryRef!=undefined&&$.connection.hubForm.server.getEntityQueryColumns(t.dictAttributes.sfwQueryRef,"LoadQueryFieldsForLookup").done(function(i){n.receiveQueryFields(i,t.dictAttributes.sfwQueryRef)})}};n.sortcolumnslist=function(t,i){var r,c;if(i!=""){var u=[],f=[],e=[],o=[],s=[],h=[];for(r=0;r<t.lstselectedobjecttreefields.length;r++)t.lstselectedobjecttreefields[r].ID==i?u.push(t.lstselectedobjecttreefields[r]):t.lstselectedobjecttreefields[r].ID.toLowerCase()==i.toLowerCase()?f.push(t.lstselectedobjecttreefields[r]):t.lstselectedobjecttreefields[r].ID.indexOf(i)==0?e.push(t.lstselectedobjecttreefields[r]):t.lstselectedobjecttreefields[r].ID.toLowerCase().indexOf(i.toLowerCase())==0?o.push(t.lstselectedobjecttreefields[r]):t.lstselectedobjecttreefields[r].ID.contains(i)?s.push(t.lstselectedobjecttreefields[r]):t.lstselectedobjecttreefields[r].ID.toLowerCase().contains(i.toLowerCase())&&h.push(t.lstselectedobjecttreefields[r]);c=u.concat(f).concat(e).concat(o).concat(s).concat(h);t.SortedColumns=c;n.ColumnsLimitCount=50}else t.SortedColumns=t.lstselectedobjecttreefields,n.ColumnsLimitCount=50};n.receiveQueryFields=function(t,i){n.$apply(function(){function e(n){var t="",i;n.Data1&&n.Data1!=null?t=n.Data1.toLowerCase():n.DataType&&(t=n.DataType.toLowerCase());i={ID:n.CodeID,DisplayName:n.CodeID,Value:n.CodeID,DataType:t,Entity:"",Direction:"",IsPrivate:"",Type:"",KeyNo:"",CodeID:""};f.lstselectedobjecttreefields.push(i)}var r,u,f;n.lstQueryID&&(r=n.lstQueryID.filter(function(n){return n.dictAttributes.sfwQueryRef==i}),r&&r.length>0&&(u=n.lstLoadedEntityColumnsTree.filter(function(n){return n.EntityName==r[0].dictAttributes.ID}),u&&u.length>0&&(f=u[0],t&&(sortListBasedOnproperty(t,"","CodeID"),angular.forEach(t,e)))))})};n.otherSelectedField=[];n.RemoveOrIsFieldPresentFromOtherSelectedField=function(t,i){for(var u=!1,r=0;r<n.otherSelectedField.length;r++)if(n.otherSelectedField[r].ID==t.ID){i=="Delete"?n.otherSelectedField.splice(r,1):i=="bool"&&(u=!0);break}return u};n.selectField=function(t,i){var u,r;if(n.selectedfield&&!i.ctrlKey?(n.selectedfield.IsRecordSelected=!1,n.ischeckboxvisible||(n.selectedfield.IsSelected="False")):n.selectedfield&&(u=n.RemoveOrIsFieldPresentFromOtherSelectedField(n.selectedfield,"bool"),u||n.otherSelectedField.push(n.selectedfield),n.selectedfield=undefined),i.ctrlKey||(n.selectedfield=t,n.selectedfield.IsRecordSelected=!0),i&&(i.stopPropagation(),i.stopImmediatePropagation()),!n.ischeckboxvisible)if(i.ctrlKey)t.IsRecordSelected?(t.IsRecordSelected=!1,t.IsSelected="False",n.RemoveOrIsFieldPresentFromOtherSelectedField(t,"Delete")):(t.IsRecordSelected=!0,t.IsSelected="True",n.otherSelectedField.push(t));else{for(r=0;r<n.otherSelectedField.length;r++)n.otherSelectedField[r].IsRecordSelected=!1,n.otherSelectedField[r].IsSelected="False";n.otherSelectedField=[];t.IsRecordSelected=!0;t.IsSelected="True"}for(r=0;r<n.lstLoadedEntityColumnsTree.length;r++)if(n.lstLoadedEntityColumnsTree[r].IsVisible==!0){n.lstLoadedEntityColumnsTree[r].selectedobjecttreefield=n.selectedfield;break}n.ObjgridBoundedQuery.IsQuery&&(n.ObjgridBoundedQuery.selectedobjecttreefield=n.selectedfield)};n.selectPanelControl=function(t){var u,i,r;if(t){if(n.CurrPanel&&n.CurrPanel!=t&&(n.CurrPanel.IsVisible=!1,n.CurrPanel.initialvisibilty=!1),t.isLoaded||(t.isLoaded=!0),n.CurrPanel=t,n.IsGridSeleected=!1,n.CurrPanel.IsVisible=!0,n.isAnyPanelOpen||(n.CurrPanel.initialvisibilty=!0,n.isAnyPanelOpen=!0),n.CurrPanel.IsPanelToggle=!n.CurrPanel.IsPanelToggle,SetFormSelectedControl(n.FormModel,n.CurrPanel),n.CurrPanel.IsHeaderTemplate=!1,u=n.GetPanelName(t),n.setobjtemplate(u),i=[],FindControlListByName(n.CurrPanel,"sfwPanel",i),FindControlListByName(n.CurrPanel,"sfwListView",i),FindControlListByName(n.CurrPanel,"sfwDialogPanel",i),FindControlListByName(n.CurrPanel,"sfwWizardStep",i),i&&i.length>0)for(r=0;r<i.length;r++)i[r].IsVisible=!0,i[r].initialvisibilty=!0,i[r].isLoaded=!0;n.setDisplayNoneToTable&&n.setDisplayNoneToTable();n.ObjgridBoundedQuery.IsQuery=!1}};n.GetPanelName=function(n){var t=n.dictAttributes.ID;return n.dictAttributes.Title?t=n.dictAttributes.Title:n.dictAttributes.sfwCaption&&(t=n.dictAttributes.sfwCaption),t};n.setobjtemplate=function(){function o(t){var i=t.dictAttributes.ID;i.contains("tshAdvCriteria")?n.IsLookupAdvCriteriaSelected=!0:i.contains("tshAdvSort")?n.IsLookupAdvSortSelected=!0:i.contains("tshSql")&&(n.IsLookupQuerySelected=!0)}var e,r,u,f,t,i;if(n.FormModel.IsLookupCriteriaEnabled=!1,n.FormModel.IsPrototypeLookupCriteriaEnabled=!1,n.FormModel.dictAttributes.sfwType=="Lookup"&&!n.FormModel.dictAttributes.ID.startsWith("wfp")&&(i=isGridPresentInsidePanel(n.CurrPanel),n.CurrPanel.dictAttributes.ID&&!i))for(n.FormModel.IsLookupCriteriaEnabled=!0,n.IsGridSeleected=!1,t=0;t<n.lstLoadedEntityColumnsTree.length;t++)n.SelectedQuery&&n.lstLoadedEntityColumnsTree[t].EntityName==n.SelectedQuery.dictAttributes.ID&&n.lstLoadedEntityColumnsTree[t].IsQuery==!0?(n.lstLoadedEntityColumnsTree[t].IsVisible=!0,n.lookupTreeObject=n.lstLoadedEntityColumnsTree[t]):n.lstLoadedEntityColumnsTree[t].IsVisible=!1;if(n.FormModel.dictAttributes.sfwType=="Lookup"&&n.CurrPanel&&n.CurrPanel.TableVM&&(e=n.CurrPanel.TableVM.Elements[0],r=e.Elements[0],r.Elements.length>0&&r.Elements[0].Name=="sfwTabContainer"&&(u=r.Elements[0],u&&(f=u.Elements[0],f&&angular.forEach(f.Elements,o)))),!n.FormModel.IsLookupCriteriaEnabled)for(t=0;t<n.lstLoadedEntityTrees.length;t++)n.lstLoadedEntityTrees[t].EntityName!=n.FormModel.dictAttributes.sfwEntity||n.lstLoadedEntityTrees[t].IsQuery?n.lstLoadedEntityTrees[t].IsVisible=!1:(n.lstLoadedEntityTrees[t].IsVisible=!0,n.entityTreeName=n.lstLoadedEntityTrees[t].EntityName,n.currentEntiyTreeObject=n.lstLoadedEntityTrees[t]);n.FormModel.dictAttributes.sfwType=="Lookup"&&n.FormModel.dictAttributes.ID.startsWith("wfp")&&(i=isGridPresentInsidePanel(n.CurrPanel),n.CurrPanel.dictAttributes.ID&&!i&&(n.FormModel.IsPrototypeLookupCriteriaEnabled=!0))};n.SetMainTable=function(){function i(t){var f,i,u,o,e,r;if(t.ParentVM=n.SfxMainTable,t.Elements.length>0)if(n.FormModel.dictAttributes.sfwType=="Wizard"){for(k=0;k<t.Elements.length;k++)if(f=t.Elements[k],f.ParentVM=t,i=f.Elements.filter(function(n){return n.Name=="sfwWizard"}),i.length>0){if(n.objWizard=i,i=i[0],n.objWizard=i,i.ParentVM=f,u=i.Elements.filter(function(n){return n.Name=="WizardSteps"}),o=i.Elements.filter(function(n){return n.Name=="HeaderTemplate"}),o.length>0&&(n.HeaderTemplate=o[0]),u.length>0)for(u=u[0],e=0;e<u.Elements.length;e++)r=u.Elements[e],r.ParentVM=u,r.Name=="sfwWizardStep"&&(r.Elements[0].Name=="sfwTable"&&(r.TableVM=r.Elements[0]),r.isLoaded=!1,n.MainPanels.push(r));break}}else angular.forEach(t.Elements,function(i){i.ParentVM=t;var r=i.Elements.filter(function(n){return n.Name=="sfwPanel"||n.Name=="sfwDialogPanel"});if(r.length>0){for(r=r[0],r.ParentVM=i,r.IsMainPanel=!0,j=0;j<r.Elements.length;j++)if(r.Elements[j].Name=="sfwTable"){r.TableVM=r.Elements[j];break}r.isLoaded=!1;n.MainPanels.push(r)}})}for(var t=0;t<n.FormModel.Elements.length;t++)n.FormModel.Elements[t].Name=="sfwTable"?(n.SfxMainTable=n.FormModel.Elements[t],angular.forEach(n.SfxMainTable.Elements,i)):n.FormModel.Elements[t].Name=="initialload"?n.InitialLoad=n.FormModel.Elements[t]:n.FormModel.Elements[t].Name=="centerleft"?n.CenterLeft=n.FormModel.Elements[t]:n.FormModel.Elements[t].Name=="validatenew"&&(n.ValidateNew=n.FormModel.Elements[t])};n.FindDeepNodeUDC=function(t,i){t&&angular.forEach(t.Elements,function(t){t.Name=="udc"&&i.push(t);t.Elements&&t.Elements.length>0&&n.FindDeepNodeUDC(t,i)})};n.SetUDCMainTable=function(){var i=[],t,r;if(n.UDCTableList&&n.UDCTableList.length>0)for(t=0;t<n.UDCTableList.length>0;t++)r={FileName:n.UDCTableList[t].dictAttributes.Name,ID:n.UDCTableList[t].dictAttributes.ID},i.push(r);$.connection.hubForm.server.getUserControlModel(i,"").done(function(t){n.receiveUcMainTable(t)})};hubMain.server.populateMessageList().done(function(t){n.lstMessages=t});n.ToggleUIDesginAttribute=function(n,t){n[0]&&n[0].Name&&(n[n.length-1].isAdvanceSearched=t)};n.receieveHTMLFromModel=function(i){i&&(n.$evalAsync(function(){t.IsLoading=!1}),n.PrepareHighlightedForm(i))};n.PrepareHighlightedForm=function(t){$("#"+n.currentfile.FileName).find("#transformedxml")[0].innerHTML=t;var i=[window.location.protocol,"//",window.location.host,"/",getWebApplicationName(),"/","Form/views/highlightElementTemplate.html"].join("");$.ajax({url:i,type:"GET",async:!1,success:function(t){var i,r,u,f,e,o;n.DesignSearchAttributes.indexOf("sfwVisibleRule")!=-1&&(i=$("#"+n.currentfile.FileName).find("#transformedxml [sfwVisibleRule]"),r=$("#"+n.currentfile.FileName).find("#transformedxml [sfwSelectColVisibleRule]"),i.each(function(){ut(this,t,"sfwvisiblerule")}),r.each(function(){var n=$(this).find("> .highlightElement .HighlightRowWrapper");n.length>0?n.append("<span title='"+$(this).attr("sfwSelectColVisibleRule")+"' class='blk-blue'><\/span>"):ut(this,t,"sfwSelectColVisibleRule")}));n.DesignSearchAttributes.indexOf("sfwAutoQuery")!=-1&&(u=$("#"+n.currentfile.FileName).find("#transformedxml [sfwAutoQuery]"),u.each(function(){var n=$(this).find("> .highlightElement .HighlightRowWrapper");n.length>0?n.append("<span title='"+$(this).attr("sfwAutoQuery")+"' class='blk-red'><\/span>"):ut(this,t,"sfwAutoQuery")}));n.DesignSearchAttributes.indexOf("sfwRetrievalQuery")!=-1&&(f=$("#"+n.currentfile.FileName).find("#transformedxml [sfwRetrievalQuery]"),f.each(function(){var n=$(this).find("> .highlightElement .HighlightRowWrapper");n.length>0?n.append("<span title='"+$(this).attr("sfwRetrievalQuery")+"' class='blk-green'><\/span>"):ut(this,t,"sfwRetrievalQuery")}));n.DesignSearchAttributes.indexOf("sfwReadOnlyRule")!=-1&&(e=$("#"+n.currentfile.FileName).find("#transformedxml [sfwReadOnlyRule]"),e.each(function(){var n=$(this).find("> .highlightElement .HighlightRowWrapper");n.length>0?n.append("<span title='"+$(this).attr("sfwReadOnlyRule")+"' class='blk-purple'><\/span>"):ut(this,t,"sfwReadOnlyRule")}));n.DesignSearchAttributes.indexOf("sfwValidationRules")!=-1&&(o=$("#"+n.currentfile.FileName).find("#transformedxml [sfwValidationRules]"),o.each(function(){var n=$(this).find("> .highlightElement .HighlightRowWrapper");n.length>0?n.append("<span title='"+$(this).attr("sfwValidationRules")+"' class='blk-brown'><\/span>"):ut(this,t,"sfwValidationRules")}))}})};n.getHightlightAttribute=function(){var i=n.$new(!0);i.attributesList=[{label:"Visible Rule",value:"sfwVisibleRule"},{label:"Auto Query",value:"sfwAutoQuery"},{label:"Retrieval Query",value:"sfwRetrievalQuery"},{label:"Readonly Rule",value:"sfwReadOnlyRule"},{label:"Validation Rules",value:"sfwValidationRules"}];i.AllFilesObj={name:"All",value:"All",selected:!1};n.DesignHighlightAttribute!=null||n.isDeveloperView?(i.DesignAttribute={},angular.copy(n.DesignHighlightAttribute,i.DesignAttribute)):(n.DesignHighlightAttribute={},i.DesignAttribute={});i.AttributeDialog=t.showDialog(i,"Select attributes to highlight","Form/views/highlightAttribute.html",{width:300,height:500,showclose:!0});i.onOKClick=function(){var c,o,r,e;if(angular.copy(i.DesignAttribute,n.DesignHighlightAttribute),i.AttributeDialog.close(),c=i.attributesList.filter(function(n){return i.DesignAttribute[n.value]}),i.$destroy(),n.DesignSearchAttributes=[],c.forEach(function(t){n.DesignSearchAttributes.push(t.value)}),n.DesignSearchAttributes.length>0){if(o=GetBaseModel(n.FormModel),o!="")if(r=JSON.stringify(o),r.length<32e3)t.IsLoading=!0,s.hubForm.server.getHTMLfromModel(r,n.currentfile).done(function(i){n.$evalAsync(function(){t.IsLoading=!1});n.PrepareHighlightedForm(i)});else{var u="",h=[],f=0;for(e=0;e<r.length;e++)f++,u=u+r[e],f==32e3&&(f=0,h.push(u),u="");f!=0&&h.push(u);t.IsLoading=!0;et(h,n.currentfile,"Highlight_XML")}n.blackStyle={height:"99%",overflow:"auto",margin:"10px","padding-top":"10px"};n.IsToolsDivCollapsed=!0;n.isDeveloperView=!0}else $("#"+n.currentfile.FileName).find("#transformedxml")[0].innerHTML="",n.isDeveloperView=!1,n.blackStyle=null};i.selectAll=function(){i.AllFilesObj.selected?i.attributesList.filter(function(n){i.DesignAttribute[n.value]=!0}):i.attributesList.filter(function(n){i.DesignAttribute[n.value]=!1})};i.close=function(){n.$evalAsync(function(){i.AttributeDialog.close();i.$destroy()})}};n.OnSwitchView=function(){n.$evalAsync(function(){n.blackStyle=null;n.isDeveloperView=!1});$("#"+n.currentfile.FileName).find("#transformedxml")[0].innerHTML="";n.DesignHighlightAttribute=null};t.isFromSource=!1;n.ShowDesign=function(){var i,r,o,e;if(n.selectedDesignSource==!0&&(i=n.editor.getValue(),i!=null&&i!="")){if(t.IsLoading=!0,r=n.editor.selection.getCursor().row,r=r+1,i.length<32e3)hubMain.server.getDesignXmlString(i,n.currentfile,r);else{o=[];o[0]=r>0?r:1;var u="",s=[],f=0;for(e=0;e<i.length;e++)f++,u=u+i[e],f==32e3&&(f=0,s.push(u),u="");f!=0&&s.push(u);et(s,n.currentfile,"Source-Design",o)}n.receiveformcorrdesignxmlobject=function(t,i){if(n.selectedDesignSource=!1,n.isSourceDirty){var r=t;n.receiveformmodel(r);n.isSourceDirty=!1}n.selectElement(i)}}};n.selectElement=function(i){$("#"+n.currentfile.FileName).find("[drag-handler-btn]").remove();n.$evalAsync(function(){var u,r;n.FormModel.dictAttributes.sfwType=="UserControl"?i!="form"&&(r=[],r=n.objectPath(i),r.length>0&&n.highlightControl(r)):(n.CurrPanel&&(n.CurrPanel.IsVisible=!1,n.CurrPanel.IsPanelToggle=!1,n.CurrPanel.initialvisibilty=!1),i!=null&&i!="form"?(r=[],r=n.objectPath(i),r&&r.length>0&&(r.length>3&&r[0].Name!="initialload"&&r[0].Name!="validatenew"&&r[r.length-1].Name!="SideBarTemplate"&&r[r.length-1].ParentVM.Name!="SideBarTemplate"?n.highlightControl(r):(u=n.MainPanels.length>1&&n.MainPanels[0].dictAttributes.ID=="pnltoolbar"?n.MainPanels[1]:n.MainPanels[0],r[r.length-1]&&r[r.length-1].Name=="sfwColumn"&&n.FormModel.dictAttributes.sfwType!="Wizard"?u=r[r.length-1].Elements[0]:r[r.length-1]&&r[r.length-1].Name=="sfwRow"&&n.FormModel.dictAttributes.sfwType!="Wizard"?u=r[r.length-1].Elements[0].Elements[0]:r[r.length-1]&&r[r.length-1].Name=="WizardSteps"||r[r.length-1].Name=="sfwWizard"?u=r[r.length-1].Name=="WizardSteps"?r[r.length-1].Elements[0]:r[r.length-1].Elements[0].Elements[0]:r[r.length-1]&&r[r.length-1].Name=="HeaderTemplate"&&n.FormModel.dictAttributes.sfwType=="Wizard"&&(u=r[r.length-1]),n.setLookupCriteriaVisiblityVariable(u),u&&n.MainPanels.some(function(t){t.dictAttributes.ID==u.dictAttributes.ID&&(n.CurrPanel.IsVisible=!1,n.CurrPanel.IsPanelToggle=!0,n.CurrPanel=t,n.CurrPanel.IsVisible=!1,n.CurrPanel.IsPanelToggle=!1,t.initialvisibilty=!0,t.IsVisible=!0,t.isLoaded=!0)}),SetFormSelectedControl(n.FormModel,u,window.event),tt(n.FormModel.SelectedControl)))):(u=n.MainPanels.length>1&&n.MainPanels[0].dictAttributes.ID=="pnltoolbar"?n.MainPanels[1]:n.MainPanels[0],n.CurrPanel&&u&&(n.CurrPanel.IsVisible=!1,n.CurrPanel.IsPanelToggle=!0,n.CurrPanel=u,n.CurrPanel.IsVisible=!1,n.CurrPanel.IsPanelToggle=!1),n.setLookupCriteriaVisiblityVariable(u),u&&(u.initialvisibilty=!0,u.IsVisible=!0,u.isLoaded=!0,SetFormSelectedControl(n.FormModel,u,window.event),tt(n.FormModel.SelectedControl))));t.IsLoading=!1;e(function(){var t=$("#"+n.FormModel.dictAttributes.ID),i=$(t).find(".select-label-control,.select-textbox-control,.select-button-control,.select-hyperlink-control,.select-gridview-control,.select-cell-control,.select-dropdown-control,.select-cascading-dropdown-control");t&&i&&i.length&&($(t).find(".form-area-editable").animate({scrollTop:$(i).offset().top-300},100),$(t).find(".form-area-editable").animate({scrollLeft:$(i).offset().left-400},100))})})};n.setLookupCriteriaVisiblityVariable=function(t){var i;n.FormModel.IsLookupCriteriaEnabled=!1;(n.FormModel.dictAttributes.sfwType=="Lookup"||n.FormModel.dictAttributes.sfwType=="FormLinkLookup")&&(i=isGridPresentInsidePanel(t),t&&t.dictAttributes&&t.dictAttributes.ID&&!i&&(n.FormModel.IsLookupCriteriaEnabled=!0,n.IsGridSeleected=!1));n.FormModel.IsPrototypeLookupCriteriaEnabled=!1;n.FormModel.dictAttributes.sfwType=="Lookup"&&n.FormModel.dictAttributes.ID.startsWith("wfp")&&(i=isGridPresentInsidePanel(t),t&&t.dictAttributes&&t.dictAttributes.ID&&!i&&(n.FormModel.IsPrototypeLookupCriteriaEnabled=!0,n.FormModel.IsLookupCriteriaEnabled=!1))};n.objectPath=function(t){var u=[],i,r;if(t.contains("-")||t.contains(","))for(i=n.FormModel,r=0;r<t.split(",").length;r++)i=n.FindNodeHierarchy(i,t.split(",")[r].substring(t.split(",")[r].lastIndexOf("-")+1)),i&&u.push(i);return u};n.highlightControl=function(i){for(var r,o,e,u,f=0;f<i.length;f++){if(r=i[f],r.Name=="sfwPanel"||r.Name=="sfwWizardStep"||r.Name=="HeaderTemplate")u=r,o=!1,u&&u.Name!="HeaderTemplate"&&n.MainPanels.length>0?n.MainPanels.some(function(t){var i;t.dictAttributes.ID==u.dictAttributes.ID&&(o=!0,n.CurrPanel.IsVisible=!1,n.CurrPanel.IsPanelToggle=!0,n.CurrPanel=t,n.CurrPanel.IsVisible=!1,n.CurrPanel.IsPanelToggle=!1,t.initialvisibilty=!0,t.IsVisible=!0,t.isLoaded=!0,n.FormModel.IsLookupCriteriaEnabled=!1,n.FormModel.dictAttributes.sfwType!="Lookup"&&n.FormModel.dictAttributes.sfwType!="FormLinkLookup"||n.FormModel.dictAttributes.ID.startsWith("wfp")||(i=isGridPresentInsidePanel(n.CurrPanel),n.CurrPanel.dictAttributes.ID&&!i&&(n.FormModel.IsLookupCriteriaEnabled=!0,n.IsGridSeleected=!1)),n.FormModel.IsPrototypeLookupCriteriaEnabled=!1,n.FormModel.dictAttributes.sfwType=="Lookup"&&n.FormModel.dictAttributes.ID.startsWith("wfp")&&(i=isGridPresentInsidePanel(n.CurrPanel),n.CurrPanel.dictAttributes.ID&&!i&&(n.FormModel.IsPrototypeLookupCriteriaEnabled=!0)))}):u&&u.Name=="HeaderTemplate"&&n.CurrPanel&&(o=!0,n.CurrPanel.IsVisible=!1,n.CurrPanel.IsPanelToggle=!0,n.CurrPanel=u,n.CurrPanel.IsVisible=!1,n.CurrPanel.IsPanelToggle=!1,u.initialvisibilty=!0,u.IsVisible=!0,u.isLoaded=!0),o||(u.initialvisibilty=!0,u.IsVisible=!0,u.isLoaded=!0);else if(r.Name=="sfwDialogPanel"||r.Name=="sfwListView")u=r,u.initialvisibilty=!0,u.isLoaded=!0;else if(r.Name=="sfwTabSheet")t.isFromSource=!0,u=r,u.isLoaded=!0,u.ParentVM.SelectedTabSheet=r,u.ParentVM.SelectedTabSheet.IsSelected=!0;else if(f==i.length-1&&(r.Name=="ItemTemplate"||r.Name=="Columns"))r.Name=="ItemTemplate"?(SetFormSelectedControl(n.FormModel,r.Elements[0],window.event),tt(n.FormModel.SelectedControl)):(SetFormSelectedControl(n.FormModel,i[i.length-2],window.event),tt(n.FormModel.SelectedControl));else if(f==i.length-1&&(r.Name=="sfwTabContainer"||r.Name=="Tabs"))t.isFromSource=!1,r.Name=="sfwTabContainer"?(SetFormSelectedControl(n.FormModel,r.Elements[0].Elements[0],window.event),tt(n.FormModel.SelectedControl)):(SetFormSelectedControl(n.FormModel,r.Elements[0],window.event),tt(n.FormModel.SelectedControl));else if(f==i.length-1&&r.Name=="sfwRow"){while(r.ParentVM){if(e=!1,r.ParentVM.Name=="sfwPanel"||r.ParentVM.Name=="sfwWizardStep"||r.ParentVM.Name=="HeaderTemplate"){SetFormSelectedControl(n.FormModel,r.ParentVM,window.event);tt(n.FormModel.SelectedControl);e=!0;break}else if(r.ParentVM.Name=="sfwDialogPanel"){SetFormSelectedControl(n.FormModel,r.ParentVM,window.event);tt(n.FormModel.SelectedControl);e=!0;break}else if(r.ParentVM.Name=="sfwListView"){SetFormSelectedControl(n.FormModel,r.ParentVM,window.event);tt(n.FormModel.SelectedControl);e=!0;break}else if(r.ParentVM.Name=="sfwTabSheet"){SetFormSelectedControl(n.FormModel,r.ParentVM,window.event);tt(n.FormModel.SelectedControl);e=!0;break}r=r.ParentVM}!e&&n.MainPanels.length>0&&(u=n.MainPanels.length>1&&n.MainPanels[0].dictAttributes.ID=="pnltoolbar"?n.MainPanels[1]:n.MainPanels[0],n.MainPanels.some(function(t){t.dictAttributes.ID==u.dictAttributes.ID&&(n.CurrPanel.IsVisible=!1,n.CurrPanel.IsPanelToggle=!0,n.CurrPanel=t,n.CurrPanel.IsVisible=!1,n.CurrPanel.IsPanelToggle=!1,t.initialvisibilty=!0,t.IsVisible=!0,t.isLoaded=!0)}))}else if(f==i.length-1&&(r.Name=="WizardSteps"||r.Name=="sfwWizard")){u=r.Name=="WizardSteps"?r.Elements[0]:r.Elements[0].Elements[0];n.MainPanels.length>0&&n.MainPanels.some(function(t){t.dictAttributes.ID==u.dictAttributes.ID&&(n.CurrPanel.IsVisible=!1,n.CurrPanel.IsPanelToggle=!0,n.CurrPanel=t,n.CurrPanel.IsVisible=!1,n.CurrPanel.IsPanelToggle=!1,t.initialvisibilty=!0,t.IsVisible=!0,t.isLoaded=!0)});SetFormSelectedControl(n.FormModel,u,window.event);tt(n.FormModel.SelectedControl);break}else if(f==i.length-1&&(r.Name=="Area3DStyle"||r.Name=="sfwChartArea"||r.Name=="ChartAreas"||r.Name=="Series"||r.Name=="sfwSeries")){while(r.Name!="sfwChart")r=r.ParentVM;SetFormSelectedControl(n.FormModel,r,window.event);tt(n.FormModel.SelectedControl);break}f==i.length-1&&r.Name!="ItemTemplate"&&r.Name!="Columns"&&r.Name!="sfwTabContainer"&&r.Name!="Tabs"&&r.Name!="sfwRow"&&r.Name!="Area3DStyle"&&r.Name!="sfwChartArea"&&r.Name!="ChartAreas"&&r.Name!="Series"&&r.Name!="sfwSeries"&&(SetFormSelectedControl(n.FormModel,r,window.event),tt(n.FormModel.SelectedControl))}};n.isSourceDirty;n.sourceChanged=function(){n.isSourceDirty=!0;n.isDirty=!0;n.SearchSource.IsSearchCriteriaChange=!0};et=function(n,t,i,r){for(var u=0;u<n.length;u++)hubMain.server.receiveDataPackets(n[u],n.length,t,u,i,r)};n.ShowSource=function(){var e,v,l,a,s,h,i,f;if(n.selectedDesignSource==!1&&!n.isDeveloperView&&(n.FormModel!=null&&n.FormModel!=undefined&&(n.IsPrototype||n.FormModel.dictAttributes.sfwType=="UserControl"||n.FormModel.dictAttributes.sfwType=="Lookup"||(n.dummyLstLoadDetails=LoadDetails(n.FormModel,n.objLoadDetails,!1,t,!1))),n.selectedDesignSource=!0,n.FormModel!=null&&n.FormModel!=undefined&&(t.IsLoading=!0,e=GetBaseModel(n.FormModel),e!=""))){var o=[],s;if(t.IsLoading=!0,l=[],s=n.FormModel.SelectedControl,s&&(h=[],v=n.FindDeepNode(n.FormModel,s,h),a=n.getPathSource(n.FormModel,h,l),angular.copy(a,o)),i=JSON.stringify(e),i.length<32e3)hubMain.server.getSourceXmlObject(i,n.currentfile,o);else{var r="",c=[],u=0;for(f=0;f<i.length;f++)u++,r=r+i[f],u==32e3&&(u=0,c.push(r),r="");u!=0&&c.push(r);et(c,n.currentfile,"Design-Source",o)}n.receivesourcexml=function(i,r){n.$apply(function(){n.xmlSource=i;var u=n.currentfile.FileName;setDataToEditor(n,i,r,u);n.$evalAsync(function(){t.IsLoading=!1;t.isFromSource=!1});window.navigator.userAgent.toLowerCase().contains("chrome")&&n.$evalAsync(function(){t.IsLoading=!1})})}}};n.FindNodeHierarchy=function(n,t){if(n&&n.Elements){var i=n.Elements[t];return i==undefined&&(i=n.Elements[t-1]),i&&(i.ParentVM=n),i}};n.FindDeepNode=function(t,i,r){return t&&angular.forEach(t.Elements,function(t){var u=n.isValidObject(t,i);return(u&&r.push(t),t==i)?i:t.Elements&&t.Elements.length>0?i=n.FindDeepNode(t,i,r):void 0}),i};n.getPathSource=function(n,t,i){for(var u,r=0;r<t.length;r++)r==0?(u=n.Elements.indexOf(t[r]),i.push(u)):(u=t[r-1].Elements.indexOf(t[r]),i.push(u));return i};n.isValidObject=function(t,i){var u,r;if(t==i)return!0;for(r in t.Elements){if(t.Elements[r]==i)return!0;if(t.Elements[r].Elements&&t.Elements[r].Elements.length>0)for(iele in t.Elements[r].Elements)if(u=n.isValidObject(t.Elements[r].Elements[iele],i),u==!0)return u}return u};n.OnSelectLeftFormTab=function(t){t=="Entity"?(n.ActiveTabForForm="Entity",n.IsEntityTreeExpanded||(n.IsEntityTreeExpanded=!0,n.FormModel&&(n.FormModel.IsLookupCriteriaEnabled?!n.FormModel||n.FormModel.dictAttributes.sfwType!="Lookup"||n.FormModel.IsLookupCriteriaEnabled!=!0||n.MainQuery||n.SelectedQuery&&(!n.SelectedQuery||n.SelectedQuery.dictAttributes.ID)?n.lookupTreeObject&&n.lookupTreeObject.SortedColumns&&n.lookupTreeObject.SortedColumns.length>0&&(n.selectedfield=n.lookupTreeObject.SortedColumns[0],n.selectedfield.IsRecordSelected=!0,n.selectedfield.IsSelected="True"):n.lstselectedobjecttreefields.length>0&&(n.selectedobjecttreefield=n.lstselectedobjecttreefields[0],n.selectedobjecttreefield.IsRecordSelected=!0,n.selectedobjecttreefield.IsSelected="True"):n.currentEntiyTreeObject&&n.currentEntiyTreeObject.lstselectedobjecttreefields.length>0&&(n.currentEntiyTreeObject.selectedobjecttreefield=n.currentEntiyTreeObject.lstselectedobjecttreefields[0],n.currentEntiyTreeObject.selectedobjecttreefield.IsRecordSelected=!0,n.currentEntiyTreeObject.selectedobjecttreefield.IsSelected="True")))):t=="Properties"?(n.ActiveTabForForm="Properties",n.IsPropsExpanded||(n.IsPropsExpanded=!0)):n.ActiveTabForForm="Toolbox"};n.GetMainPanelID=function(){if(n.FormModel)return"MainParentPanel"+n.FormModel.dictAttributes.ID};n.showOtherControl=!1;n.showHTMLControl=!1;n.ToggleOtherControlmenudropdown=function(){n.showHTMLControl=!1;n.showOtherControl=!n.showOtherControl};n.ToggleHTMLControlmenudropdown=function(){n.showOtherControl=!1;n.showHTMLControl=!n.showHTMLControl};n.InitialLoadSection=function(){function t(t){if(t.Name=="callmethods")t.dictAttributes.sfwMode||(n.SelectedNewMethod=t,n.SelectedUpdateMethod="",n.FormModel.IsSameAsNew=!0),(t.dictAttributes.sfwMode=="New"||t.dictAttributes.sfwMode=="All")&&(n.SelectedNewMethod=t),(t.dictAttributes.sfwMode=="Update"||t.dictAttributes.sfwMode=="All")&&(n.SelectedUpdateMethod=t);else if(t.Name=="query"){var i=t.dictAttributes.sfwQueryRef;n.IsSubQuery(i)?(n.SubQueryCollection.push(t),n.SelectedSubQuery=t):t.dictAttributes.sfwQueryRef&&(n.MainQuery=t)}else t.Name=="session"&&(n.SessionFields=t,n.SessionFields.lstselectedobjecttreefields=[],n.SessionFields.LstDisplayedEntities=[])}n.SubQueryCollection=[];n.InitialLoad?angular.forEach(n.InitialLoad.Elements,t):(n.MainQuery=undefined,n.SelectedQuery=undefined);n.FormModel.dictAttributes.sfwType=="Maintenance"&&n.InitialLoad&&n.SessionFields==undefined&&(n.SessionFields={Name:"session",Value:"",dictAttributes:{},Elements:[],Children:[]},n.SessionFields.lstselectedobjecttreefields=[],n.SessionFields.LstDisplayedEntities=[])};n.IsSubQuery=function(n){function f(n){t||n.ID==r&&n.QueryType&&n.QueryType.toLowerCase()=="subselectquery"&&(t=!0)}var t=!1,r;if(n!=""&&n!=undefined){var e=n.substring(0,n.indexOf(".")),o=u.getEntityIntellisense(),i=o.filter(function(n){return n.ID==e});i&&i.length>0&&(r=n.substring(n.indexOf(".")+1),angular.forEach(i[0].Queries,f))}return t};n.AddControlFromObjectTree=function(i){function ft(n){n.Value&&endsWith(n.Value.toLowerCase(),"_description")&&(nt=n.Value,a.push(n))}function et(n){f.splice(n,1)}function ot(n){n.Type=="Expression"&&i!="sfwLabel"&&(tt=!0,n.IsChecked=!1,f.splice(n,1))}function it(t){var u=!0;u=r&&r.Name=="sfwButtonGroup"?!1:!0;n.AddActualControl(y,i,t,!1,r,u)}function st(r){var e="asp",u={Name:"TemplateField",value:"",prefix:e,dictAttributes:{},Elements:[],Children:[]},f;u.ParentVM=c;u.dictAttributes.SortExpression=r.ID;u.dictAttributes.HeaderText=GetCaptionFromField(r);f={Name:"ItemTemplate",value:"",prefix:e,dictAttributes:{},Elements:[],Children:[]};f.ParentVM=u;n.AddActualControl(y,i,r,!1,f,!0);u.Elements.push(f);t.PushItem(u,c.Elements)}var r,o,b,e,s,f,l,k,h,d,a,nt,tt,v,y,c,p,w,u;if(i){if(r=n.GetSfxControlVM(),o=FindParent(r,"sfwGridView"),r||g.Message("Message","Select control in right panel to which elements have to be added."),n.FormModel.dictAttributes.sfwType.toLowerCase()=="maintenance"&&r.Name=="sfwGridView"&&r.dictAttributes.sfwBoundToQuery&&r.dictAttributes.sfwBoundToQuery.toLowerCase()=="true"&&["sfwLabel","sfwHyperLink","sfwButton","sfwImage","sfwToolTipButton"].indexOf(i)<=-1){g.Message("Not Allowed","Can not add this control.");return}if(n.FormModel.dictAttributes.sfwType.toLowerCase()=="maintenance"&&o&&o.dictAttributes.sfwBoundToQuery&&o.dictAttributes.sfwBoundToQuery.toLowerCase()=="true"&&["sfwLabel","sfwHyperLink","sfwButton","sfwImage","sfwToolTipButton"].indexOf(i)<=-1){g.Message("Not Allowed","Can not add this control.");return}if(n.FormModel.dictAttributes.sfwType.toLowerCase()=="maintenance"&&o&&o.dictAttributes.sfwBoundToQuery&&o.dictAttributes.sfwBoundToQuery.toLowerCase()=="true"&&["sfwLabel","sfwHyperLink","sfwButton","sfwImage","sfwToolTipButton"].indexOf(i)<=-1){g.Message("Not Allowed","Can not add this control.");return}if(n.FormModel.dictAttributes.sfwType.toLowerCase()=="lookup"&&i!="sfwButton"&&(b=FindParent(r,"sfwPanel"),b&&r.Name=="sfwColumn"&&b.dictAttributes.ID=="pnlResult")){g.Message("Not Allowed","Can not add any control outside the grid in result panel.");return}if(l=!0,s=[],n.FormModel.IsLookupCriteriaEnabled)if(n.FormModel.IsLookupCriteriaEnabled!=!0||n.MainQuery||n.SelectedQuery&&(!n.SelectedQuery||n.SelectedQuery.dictAttributes.ID)){for(u=0;u<n.lstLoadedEntityColumnsTree.length;u++)if(n.lstLoadedEntityColumnsTree[u].IsVisible==!0){e=n.lstLoadedEntityColumnsTree[u].selectedobjecttreefield;s=n.lstLoadedEntityColumnsTree[u].lstselectedobjecttreefields;break}}else e=n.selectedobjecttreefield,s=n.lstselectedobjecttreefields;else if(n.ObjgridBoundedQuery.IsQuery)e=n.ObjgridBoundedQuery.selectedobjecttreefield,s=n.ObjgridBoundedQuery.lstselectedobjecttreefields;else for(u=0;u<n.lstLoadedEntityTrees.length;u++)if(n.lstLoadedEntityTrees[u].IsVisible==!0){e=n.lstLoadedEntityTrees[u].selectedobjecttreefield;s=n.lstLoadedEntityTrees[u].lstselectedobjecttreefields;break}if(r)switch(i){case"Grid":e?e.DataType=="Collection"||e.DataType=="List"||e.DataType=="CDOCollection"?n.AddSfxGridviewToGrid(r):g.Message("Invalid Field","Select a valid one-to-many field from entity tree to add grid control."):g.Message("Invalid Field","Select a valid one-to-many field from entity tree to add grid control.");break;case"SfxChart":e?e.DataType=="Collection"||e.DataType=="List"||e.DataType=="CDOCollection"?n.AddSfxChartToGrid(r):g.Message("Invalid Field","Select a valid one-to-many field from entity tree to add chart control."):g.Message("Invalid Field","Select a valid one-to-many field from entity tree to add chart control.");break;case"UserControl":e?e.DataType!="Object"?g.Message("Invalid Field","Select a valid one-to-one field from entity tree to add user control."):r.Name=="sfwColumn"||r.Name=="sfwButtonGroup"?n.AddControlToCell(r,i,undefined):r&&r.ParentVM&&(r.ParentVM.Name=="sfwColumn"||r.ParentVM.Name=="sfwButtonGroup")&&n.AddControlToCell(r.ParentVM,i,undefined):g.Message("Invalid Field","Select a valid one-to-one field from entity tree to add user control.");break;case"sfwCalendar":e?e.DataType=="Collection"||e.DataType=="List"||e.DataType=="CDOCollection"?n.AddSfxCalendarControl(r,!1):g.Message("Invalid Field","Select a valid one-to-many field from entity tree to add calendar control."):g.Message("Invalid Field","Select a valid one-to-many field from entity tree to add calendar control.");break;case"sfwScheduler":e?FindParent(r,"sfwDialogPanel")?g.Message("Message","Select a valid one-to-many field from entity tree to add scheduler control."):e.DataType=="Collection"||e.DataType=="List"||e.DataType=="CDOCollection"?n.AddSfxCalendarControl(r,!0):g.Message("Invalid Field","Select a valid one-to-many field from entity tree to add scheduler control."):g.Message("Invalid Field","Select a valid one-to-many field from entity tree to add scheduler control.");break;case"sfwListView":e?e.DataType=="Collection"||e.DataType=="List"?n.AddSfxRepeaterControl(r):g.Message("Invalid Field","Select a valid one-to-many field from entity tree to add repeater control."):g.Message("Invalid Field","Select a valid one-to-many field from entity tree to add repeater control.");break;default:f=[];f=GetSelectedFieldList(s,f);l=!1;n.FormModel.IsLookupCriteriaEnabled||(k=getDisplayedEntity(n.LstDisplayedEntities),k&&k.isParentFieldCollection&&(f=[],l=!0));var rt=!1,l=!1,ut=!1;if(f.length>0)for(u=0;u<f.length;u++)(!f[u].DataType||f[u].DataType&&f[u].DataType.toLowerCase()=="cdocollection")&&(i!="sfwCheckBoxList"||f[u].Type&&f[u].Type==="Description"||(ut=!0)),(!f[u].DataType||f[u].DataType&&f[u].DataType.toLowerCase()!="datetime"&&f[u].DataType.toLowerCase()!="date")&&i=="sfwDateTimePicker"&&(rt=!0);if(h=!0,l?(h=!1,g.Message("Message","Collection field/s cannot be added.")):f.length==0?(h=!1,g.Message("Message","Select field/s from entity tree to add control.")):rt?(h=!1,g.Message("Invalid Field","Select valid DateTime field/s from entity tree to add DateTime Picker control.")):ut||i!="sfwCheckBoxList"||n.FormModel.IsLookupCriteriaEnabled||(h=!1,g.Message("Invalid Field","Select valid one-to-many field of type CDOCollection to add Checkbox List control.")),(i=="sfwLabel"||i=="sfwTextBox"||i=="sfwRadioButton"||i=="sfwCheckBox"||i=="sfwDateTimePicker"||i=="sfwRadioButtonList"||i=="sfwDropDownList"||i=="sfwCascadingDropDownList"||i=="sfwMultiSelectDropDownList")&&f.length>0){for(d=[],u=0;u<f.length;u++)f[u].DataType!=="Collection"&&f[u].DataType!=="List"&&f[u].DataType!=="CDOCollection"&&f[u].DataType!=="Object"&&d.push(f[u]);f=d}h&&(a=[],nt="",i=="sfwDropDownList"&&(angular.forEach(f,ft),angular.forEach(a,et)),tt=!1,angular.forEach(f,ot),f.length>0&&r&&(v=GetVM("sfwButtonGroup",r),r.Name=="ItemTemplate"?(y=n.FormModel.dictAttributes.sfwType=="Lookup",t.UndRedoBulkOp("Start"),angular.forEach(f,it),t.UndRedoBulkOp("End")):r.Name=="sfwGridView"?(y=n.FormModel.dictAttributes.sfwType=="Lookup",c=r.Elements[0],t.UndRedoBulkOp("Start"),c||(c={Name:"Columns",Value:"",dictAttributes:{},Elements:[]},t.PushItem(c,r.Elements)),angular.forEach(f,st),t.UndRedoBulkOp("End")):v||r.Name=="sfwButtonGroup"?(r=v?v:r,t.UndRedoBulkOp("Start"),angular.forEach(f,it),t.UndRedoBulkOp("End")):n.FormModel&&n.FormModel.dictAttributes.sfwType=="Lookup"&&n.FormModel.IsLookupCriteriaEnabled&&(r.Name=="sfwTabContainer"||r.Name=="sfwColumn"&&r.Elements.length>0&&r.Elements[0].Name=="sfwTabContainer")?g.Message("Not Allowed","Can not add a control outside the criteria tab container"):n.FormModel&&n.FormModel.dictAttributes.sfwType=="Lookup"&&n.FormModel.IsPrototypeLookupCriteriaEnabled&&(r.Name=="sfwTabContainer"||r.Name=="sfwColumn"&&r.Elements.length>0&&r.Elements[0].Name=="sfwTabContainer")?g.Message("Not Allowed","Can not add a control outside the criteria tab container"):(p=GetVM("sfwTable",r),w=n.GetSelectedControl(),w&&p==GetVM("sfwTable",w)&&(r=w),p&&(t.UndRedoBulkOp("Start"),n.AddControls(p,r,i,f,!1),t.UndRedoBulkOp("End")))),f.length==0&&i!="sfwDropDownList"?g.Message("Not Allowed","Select valid field/ s from entity tree to add control "+i+"."):a.length>0?(nt.slice(0,-1),g.Message("Not Allowed","Field that ends with _description can't be added as DropDownList")):tt&&g.Message("Invalid Expression","Invalid Expression Binding"))}if(ClearSelectedFieldList(s),n.FormModel.IsLookupCriteriaEnabled&&n.lstLoadedEntityColumnsTree)for(u=0;u<n.lstLoadedEntityColumnsTree.length;u++)n.lstLoadedEntityColumnsTree[u].selectedobjecttreefield=undefined;else if(n.lstLoadedEntityTrees)for(u=0;u<n.lstLoadedEntityTrees.length;u++)n.lstLoadedEntityTrees[u].selectedobjecttreefield=undefined}};n.AddControlToCell=function(i,r,u){var c,e,o,h;if(u||(u=CreateControl(n.FormModel,i,r)),u&&u.Name!="udc"&&t.PushItem(u,i.Elements),u!=undefined&&u.Name=="udc"){for(c=n.FormModel.dictAttributes.sfwEntity,o=0;o<n.lstLoadedEntityTrees.length;o++)if(n.lstLoadedEntityTrees[o].IsVisible==!0){e=n.lstLoadedEntityTrees[o].selectedobjecttreefield;break}e&&(c=e.Entity);var f=n.$new(),s=getDisplayedEntity(n.LstDisplayedEntities),l=e.ID;s&&s.strDisplayName!=""&&(l=s.strDisplayName+"."+e.ID);f.objSetUCProp={StrId:u.dictAttributes.ID,StrName:"",StrEntityField:l,StrResource:"",formObject:n.FormModel};f.formodel=n.FormModel;f.objSetUCProp.IsAddedFromObjectTree=!0;f.onUserControlOkClick=function(){if(u.dictAttributes.ID=f.objSetUCProp.StrId,u.dictAttributes.Name=f.objSetUCProp.StrName,f.objSetUCProp.StrEntityField&&(u.dictAttributes.sfwEntityField=f.objSetUCProp.StrEntityField),u.dictAttributes.sfwResource=f.objSetUCProp.StrResource,u.dictAttributes.Name!=undefined&&u.dictAttributes.Name!=""){var r=[],e={FileName:u.dictAttributes.Name,ID:u.dictAttributes.ID};r.push(e);$.connection.hubForm.server.getUserControlModel(r,"").done(function(t){n.receiveUcMainTable(t)})}t.PushItem(u,i.Elements);f.onUserControlCancelClick()};f.onUserControlCancelClick=function(){y.removeObjInToArray(n.validationErrorList,f.objSetUCProp);h&&h.close()};f.ValidateUserProp=function(){var t=!1,i,r;return f.ErrorMessageForDisplay="",f.objSetUCProp.StrId==undefined||f.objSetUCProp.StrId==""?(f.ErrorMessageForDisplay="Error: Enter the ID.",t=!0):(i=[],CheckforDuplicateID(n.FormModel,f.objSetUCProp.StrId,i),i.length>0?(f.ErrorMessageForDisplay="Error: Duplicate ID.",t=!0):isValidIdentifier(f.objSetUCProp.StrId,!1,!1)||(f.ErrorMessageForDisplay="Error: Invalid ID.",t=!0)),f.objSetUCProp.StrName&&f.objSetUCProp.StrName!=""?f.objSetUCProp.StrResource&&f.objSetUCProp.StrResource!=""||(f.ErrorMessageForDisplay="Please Enter Resource.",t=!0):(f.ErrorMessageForDisplay="Please Enter Active Form.",t=!0),(f.ErrorMessageForDisplay==undefined||f.ErrorMessageForDisplay=="")&&f.objSetUCProp.StrEntityField!=undefined&&f.objSetUCProp.StrEntityField!=""&&(r=w.GetEntityFieldObjectFromEntityField(n.FormModel.dictAttributes.sfwEntity,f.objSetUCProp.StrEntityField),r&&r.Type=="Object"||(f.ErrorMessageForDisplay="Entity Field should be Object.",t=!0)),f.objSetUCProp.errors&&y.isEmptyObj(f.objSetUCProp.errors)&&(t=!0),t};h=t.showDialog(f,"User Control","Form/views/SetUserControlProperties.html")}};n.AddControls=function(i,r,u,f,e){function ut(t){u=="sfwRange"?o=n.AddRange(v,l,u,t,o):l&&s&&s=="tshAdvCriteria"?n.AddControlInAdvCriteria(v,l,u,t,o):o=n.AddControlsGrid(v,l,u,t,o,e)}var l=n.FormModel.dictAttributes.sfwType=="Lookup",s="",tt,a,h,c,p,b,w,k,it,rt,v,o,d,y,nt;if(l&&i.ParentVM.Name=="sfwTabSheet"&&(s=i.ParentVM.dictAttributes.ID,s&&(s=="tshAdvSort"||s=="tshSql"))){g.Message("Not Allowed","New controls cannot be added in Adv Sort/Query tab.");return}if(u=="sfwHyperLink"&&(u="sfwLinkButton"),tt=.4,a=1,u=="sfwRange")if(h=f[0],h.DataType&&(h.DataType.toLowerCase()=="date"||h.DataType.toLowerCase()=="datetime"||h.DataType.toLowerCase()=="decimal"||h.DataType.toLowerCase()=="double"||startsWith(h.DataType.toLowerCase(),"int",0)))a=f.length*4;else{a=0;g.Message("Message","Only fields having datatype Date/DateTime/Decimal/Double/Int can be added for range.");return}else a=l&&s&&s=="tshAdvCriteria"?f.length*3:f.length*2;for(c=1,p=GetMaxColCount(i.Elements[0],i),c=a==p?1:a/p+tt,c=Math.round(c),c<=0&&(c=1),b=GetVM("sfwColumn",r),b?(k=b.ParentVM,it=k.ParentVM.Elements.indexOf(k),w=it):(rt=i.Elements.length,w=rt-1),v=[],o=0,rowInd=1;rowInd<=c;rowInd++){for(d="swc",y={Name:"sfwRow",value:"",prefix:d,dictAttributes:{},Elements:[],Children:[]},y.ParentVM=i,colInd=0;colInd<p;colInd++)nt={Name:"sfwColumn",value:"",prefix:d,dictAttributes:{},Elements:[],Children:[]},nt.ParentVM=y,t.PushItem(nt,y.Elements);t.InsertItem(y,i.Elements,rowInd+w);angular.forEach(i.Elements[rowInd+w].Elements,function(n){var t={};t.key=o;t.value=n;v.push(t);o++})}o=0;angular.forEach(f,ut)};n.AddControlInAdvCriteria=function(r,f,e,o,s){var l=s,a="0",v="",w,c,h,p,y,b;switch(e){case"sfwLabel":v="lblAdv";a="0";break;case"sfwTextBox":v="txtAdv";a="3";break;case"sfwDropDownList":v="ddlAdv";a="4";break;case"sfwCheckBox":v="chkAdv";a="0";break;case"sfwCheckBoxList":v="cblAdv";a="8"}for(w=CreateControlID(n.FormModel,o.ID,e),p="swc",i=0;i<r.length;i++)if(r[i].key==l){c=r[i].value;l++;h={Name:"sfwLabel",value:"",prefix:p,dictAttributes:{},Elements:[],Children:[]};h.ParentVM=c;y=CreateControlID(n.FormModel,o.ID,"sfwLabel",!0);startsWith(y,"cap",0)&&(y="capAdv"+y.substring(3));h.dictAttributes.ID=y;n.FormModel.IsLookupCriteriaEnabled?n.FormModel.IsLookupCriteriaEnabled!=!0||n.MainQuery||n.SelectedQuery&&(!n.SelectedQuery||n.SelectedQuery.dictAttributes.ID)?h.dictAttributes.Text=GetCaptionFromFieldName(o.ID)+" : ":(h.dictAttributes.Text=GetCaptionFromField(o),h.dictAttributes.Text&&h.dictAttributes.Text.trim().length>0&&!h.dictAttributes.Text.contains(":")&&(h.dictAttributes.Text=h.dictAttributes.Text+" : ")):(h.dictAttributes.Text=GetCaptionFromField(o),h.dictAttributes.Text&&h.dictAttributes.Text.trim().length>0&&!h.dictAttributes.Text.contains(":")&&(h.dictAttributes.Text=h.dictAttributes.Text+" : "));h.dictAttributes.sfwIsCaption="True";h.dictAttributes.AssociatedControlID=w;t.PushItem(h,c.Elements);break}for(i=0;i<r.length;i++)if(r[i].key==l){c=r[i].value;l++;h={Name:"sfwDropDownList",value:"",prefix:p,dictAttributes:{},Elements:[],Children:[]};h.ParentVM=c;h.dictAttributes.ID="ddlAdvOp"+CreateControlIDInCamelCase(o.ID);h.dictAttributes.sfwLoadType="CodeGroup";h.dictAttributes.sfwLoadSource=a;t.PushItem(h,c.Elements);break}for(i=0;i<r.length;i++)if(r[i].key==l){if(c=r[i].value,l++,h={Name:e,value:"",prefix:p,dictAttributes:{},Elements:[],Children:[]},h.ParentVM=c,h.dictAttributes.ID=w,n.SelectedQuery&&(h.dictAttributes.sfwQueryID=n.SelectedQuery.dictAttributes.ID),h.dictAttributes.sfwDataField=n.FormModel.IsLookupCriteriaEnabled!=!0||n.MainQuery||n.SelectedQuery&&(!n.SelectedQuery||n.SelectedQuery.dictAttributes.ID)?o.ID:o.Value,SetDefultValuesBasedOnDataType(o,e,h),(e=="sfwDropDownList"||e=="sfwCheckBoxList")&&endsWith(o.Value,"_value")&&(b=getDisplayedEntity(n.LstDisplayedEntities),b)){var d=b.strID,g=u.getEntityIntellisense(),k=0;k=GetCodeIDForLookup(d,o.Value,g);h.dictAttributes.sfwLoadType="CodeGroup";h.placeHolder=k}e=="sfwCheckBoxList"&&(h.dictAttributes.RepeatDirection="Horizontal",h.dictAttributes.RepeatColumns="4");t.PushItem(h,c.Elements);break}return l};n.GetsfwQueryID=function(){var t=n.FormModel.Elements.filter(function(n){return n.Name=="initialload"}),r;if(t.length>0)for(i=0;i<t[0].Elements.length;i++)if(r=t[0].Elements[i].dictAttributes.sfwQueryRef,!n.IsSubQuery(r))return t[0].Elements[i].dictAttributes.ID};n.AddRange=function(r,u,f,e,o){var l=o,c,h,s,a;if(e.DataType&&(e.DataType.toLowerCase()=="date"||e.DataType.toLowerCase()=="datetime"||e.DataType.toLowerCase()=="decimal"||e.DataType.toLowerCase()=="double"||startsWith(e.DataType.toLowerCase(),"int",0))){for(t.UndRedoBulkOp("Start"),c=CreateControlIDInCamelCase(e.ID),a="swc",i=0;i<r.length;i++)if(r[i].key==l){h=r[i].value;l++;s={Name:"sfwLabel",value:"",prefix:a,dictAttributes:{sfwIsCaption:"True"},Elements:[],Children:[]};s.ParentVM=h;s.dictAttributes.ID="cap"+c+"From";s.dictAttributes.Text=n.FormModel.IsLookupCriteriaEnabled?n.FormModel.IsLookupCriteriaEnabled!=!0||n.MainQuery||n.SelectedQuery&&(!n.SelectedQuery||n.SelectedQuery.dictAttributes.ID)?GetCaptionFromFieldName(e.ID)+" From : ":GetCaptionFromField(e)+" From : ":GetCaptionFromField(e)+" From : ";t.PushItem(s,h.Elements);break}for(i=0;i<r.length;i++)if(r[i].key==l){h=r[i].value;l++;s={Name:"sfwTextBox",value:"",prefix:a,dictAttributes:{},Elements:[],Children:[]};s.ParentVM=h;s.dictAttributes.ID="txt"+c+"From";n.SelectedQuery&&(s.dictAttributes.sfwQueryID=n.SelectedQuery.dictAttributes.ID);s.dictAttributes.sfwDataField=n.FormModel.IsLookupCriteriaEnabled!=!0||n.MainQuery||n.SelectedQuery&&(!n.SelectedQuery||n.SelectedQuery.dictAttributes.ID)?e.ID:e.Value;s.dictAttributes.sfwOperator="between";s.dictAttributes.sfwRelatedControl="txt"+c+"To";e.DataType&&(e.DataType.toLowerCase()=="datetime"||e.DataType.toLowerCase()=="date")?(s.dictAttributes.sfwDataType="DateTime",s.dictAttributes.sfwDataFormat="{0:d}"):s.dictAttributes.sfwDataType="Numeric";t.PushItem(s,h.Elements);s={Name:"CompareValidator",value:"",prefix:a,dictAttributes:{},Elements:[],Children:[]};s.ParentVM=h;s.dictAttributes.ID="val"+c+"From";s.dictAttributes.Text="*";s.dictAttributes.sfwOperator="DataTypeCheck";s.dictAttributes.ControlToValidate="txt"+c+"From";e.DataType&&(e.DataType.toLowerCase()=="datetime"||e.DataType.toLowerCase()=="date")?(s.dictAttributes.Type="Date",s.dictAttributes.ErrorMessage=n.FormModel.IsLookupCriteriaEnabled?n.FormModel.IsLookupCriteriaEnabled!=!0||n.MainQuery||n.SelectedQuery&&(!n.SelectedQuery||n.SelectedQuery.dictAttributes.ID)?GetCaptionFromFieldName(e.ID)+"From must be in mm/dd/yyyy format.":GetCaptionFromField(e)+"From must be in mm/dd/yyyy format.":GetCaptionFromField(e)+"From must be in mm/dd/yyyy format."):(s.dictAttributes.Type="Integer",s.dictAttributes.ErrorMessage=n.FormModel.IsLookupCriteriaEnabled?n.FormModel.IsLookupCriteriaEnabled!=!0||n.MainQuery||n.SelectedQuery&&(!n.SelectedQuery||n.SelectedQuery.dictAttributes.ID)?GetCaptionFromFieldName(e.ID)+" From must be an Integer value.":GetCaptionFromField(e)+" From must be an Integer value.":GetCaptionFromField(e)+" From must be an Integer value.");t.PushItem(s,h.Elements);break}for(i=0;i<r.length;i++)if(r[i].key==l){h=r[i].value;l++;s={Name:"sfwLabel",value:"",prefix:a,dictAttributes:{sfwIsCaption:"True"},Elements:[],Children:[]};s.ParentVM=h;s.dictAttributes.ID="cap"+c+"To";s.dictAttributes.Text=n.FormModel.IsLookupCriteriaEnabled?n.FormModel.IsLookupCriteriaEnabled!=!0||n.MainQuery||n.SelectedQuery&&(!n.SelectedQuery||n.SelectedQuery.dictAttributes.ID)?GetCaptionFromFieldName(e.ID)+" To : ":GetCaptionFromField(e)+" To : ":GetCaptionFromField(e)+" To : ";t.PushItem(s,h.Elements);break}for(i=0;i<r.length;i++)if(r[i].key==l){h=r[i].value;l++;s={Name:"sfwTextBox",value:"",prefix:a,dictAttributes:{},Elements:[],Children:[]};s.ParentVM=h;s.dictAttributes.ID="txt"+c+"To";n.SelectedQuery&&(s.dictAttributes.sfwQueryID=n.SelectedQuery.dictAttributes.ID);s.dictAttributes.sfwDataField=n.FormModel.IsLookupCriteriaEnabled!=!0||n.MainQuery||n.SelectedQuery&&(!n.SelectedQuery||n.SelectedQuery.dictAttributes.ID)?e.ID:e.Value;s.dictAttributes.sfwOperator="between";e.DataType&&(e.DataType.toLowerCase()=="datetime"||e.DataType.toLowerCase()=="date")?(s.dictAttributes.sfwDataType="DateTime",s.dictAttributes.sfwDataFormat="{0:d}"):s.dictAttributes.sfwDataType="Numeric";t.PushItem(s,h.Elements);s={Name:"CompareValidator",value:"",prefix:a,dictAttributes:{},Elements:[],Children:[]};s.ParentVM=h;s.dictAttributes.ID="val"+c+"To";s.dictAttributes.Text="*";s.dictAttributes.Operator="DataTypeCheck";s.dictAttributes.ControlToValidate="txt"+c+"To";e.DataType&&(e.DataType.toLowerCase()=="datetime"||e.DataType.toLowerCase()=="date")?(s.dictAttributes.Type="Date",s.dictAttributes.ErrorMessage=n.FormModel.IsLookupCriteriaEnabled?n.FormModel.IsLookupCriteriaEnabled!=!0||n.MainQuery||n.SelectedQuery&&(!n.SelectedQuery||n.SelectedQuery.dictAttributes.ID)?GetCaptionFromFieldName(e.ID)+"From must be in mm/dd/yyyy format.":GetCaptionFromField(e)+"From must be in mm/dd/yyyy format.":GetCaptionFromField(e)+"From must be in mm/dd/yyyy format."):(s.dictAttributes.Type="Integer",s.dictAttributes.ErrorMessage=n.FormModel.IsLookupCriteriaEnabled?n.FormModel.IsLookupCriteriaEnabled!=!0||n.MainQuery||n.SelectedQuery&&(!n.SelectedQuery||n.SelectedQuery.dictAttributes.ID)?GetCaptionFromFieldName(e.ID)+" From must be an Integer value.":GetCaptionFromField(e)+" From must be an Integer value.":GetCaptionFromField(e)+" From must be an Integer value.");t.PushItem(s,h.Elements);s={Name:"CompareValidator",value:"",prefix:a,dictAttributes:{},Elements:[],Children:[]};s.ParentVM=h;s.dictAttributes.ID="val"+c+"Range";s.dictAttributes.Text="*";s.dictAttributes.Operator="GreaterThanEqual";s.dictAttributes.ControlToValidate="txt"+c+"To";s.dictAttributes.ControlToCompare="txt"+c+"From";s.dictAttributes.ErrorMessage=n.FormModel.IsLookupCriteriaEnabled?n.FormModel.IsLookupCriteriaEnabled!=!0||n.MainQuery||n.SelectedQuery&&(!n.SelectedQuery||n.SelectedQuery.dictAttributes.ID)?GetCaptionFromFieldName(e.ID)+" To cannot be less than "+GetCaptionFromFieldName(e.ID)+" From.":GetCaptionFromField(e)+" To cannot be less than "+GetCaptionFromField(e)+" From.":GetCaptionFromField(e)+" To cannot be less than "+GetCaptionFromField(e)+" From.";s.dictAttributes.Type=e.DataType&&(e.DataType.toLowerCase()=="datetime"||e.DataType.toLowerCase()=="date")?"Date":"Integer";t.PushItem(s,h.Elements);break}t.UndRedoBulkOp("End")}return l};n.AddControlsGrid=function(r,u,f,e,o,s){var c=o,v=CreateControlID(n.FormModel,e.ID,f),l,h,a;for(i=0;i<r.length;i++)if(r[i].key==c){l=r[i].value;c++;h={Name:"sfwLabel",value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]};h.ParentVM=l;a=CreateControlID(n.FormModel,e.ID,"sfwLabel",!0);h.dictAttributes.ID=a;h.dictAttributes.Text=GetCaptionFromField(e);h.dictAttributes.Text&&h.dictAttributes.Text.trim().length>0&&!h.dictAttributes.Text.contains(":")&&(h.dictAttributes.Text=h.dictAttributes.Text+" : ");s||(h.dictAttributes.AssociatedControlID=v,h.dictAttributes.sfwIsCaption="True");t.PushItem(h,l.Elements);break}for(i=0;i<r.length;i++)if(r[i].key==c){l=r[i].value;c++;n.AddActualControl(u,f,e,s,l,!1);break}return c};n.AddActualControl=function(i,r,f,e,o,s){var h={Name:r,value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]},v=getDisplayedEntity(n.LstDisplayedEntities),a=f.ID,l,p,y,w,c;v&&v.strDisplayName!=""&&(a=v.strDisplayName+"."+f.ID);h.ParentVM=o;s?s&&r&&r=="sfwCascadingDropDownList"&&(strControlID=CreateControlID(n.FormModel,f.ID,r,!0),h.dictAttributes.ID=strControlID):(strControlID=r=="sfwLabel"?CreateControlID(n.FormModel,f.ID,r,!1):CreateControlID(n.FormModel,f.ID,r,!0),h.dictAttributes.ID=strControlID);i?(s?h.dictAttributes.sfwEntityField=a:n.FormModel.IsLookupCriteriaEnabled!=!0||n.MainQuery||n.SelectedQuery&&(!n.SelectedQuery||n.SelectedQuery.dictAttributes.ID)?n.FormModel.IsLookupCriteriaEnabled==!0?h.dictAttributes.sfwDataField=f.ID:h.dictAttributes.sfwEntityField=a:h.dictAttributes.sfwDataField=f.Value,n.FormModel.IsLookupCriteriaEnabled&&n.SelectedQuery&&(h.dictAttributes.sfwQueryID=n.SelectedQuery.dictAttributes.ID)):e?h.dictAttributes.sfwDataField=a:h.dictAttributes.sfwEntityField=h.Name=="sfwLabel"?a:a;r=="sfwLinkButton"?h.dictAttributes.sfwMethodName="btnOpen_Click":r=="sfwDropDownList"||r=="sfwCascadingDropDownList"||r=="sfwCheckBoxList"||r=="sfwRadioButtonList"||r=="sfwMultiSelectDropDownList"?endsWith(f.Value,"_value")&&(l="",v&&(l=v.strID),n.FormModel.IsLookupCriteriaEnabled!=!0||n.MainQuery||n.SelectedQuery&&(!n.SelectedQuery||n.SelectedQuery.dictAttributes.ID)?n.FormModel.IsLookupCriteriaEnabled&&n.SelectedQuery&&n.SelectedQuery.dictAttributes.sfwQueryRef.contains(".")&&(l=n.SelectedQuery.dictAttributes.sfwQueryRef.substring(0,n.SelectedQuery.dictAttributes.sfwQueryRef.indexOf("."))):l=n.FormModel.dictAttributes.sfwEntity,p=u.getEntityIntellisense(),y="",l&&(y=i?n.FormModel.IsLookupCriteriaEnabled?GetCodeIDForLookup(l,f.Value,p):GetCodeID(l,f.ID,p):GetCodeID(l,f.ID,p)),y||(y="0"),h.dictAttributes.sfwLoadType="CodeGroup",h.placeHolder=y,i&&r=="sfwDropDownList"&&(h.dictAttributes.sfwOperator="=")):r=="sfwRadioButton"&&f.Value?(w=f.Value.substring(f.Value.indexOf(".")+1),h.dictAttributes.GroupName=w):(SetDefultValuesBasedOnDataType(f,r,h),i&&f.DataType&&(f.DataType.toLowerCase()=="datetime"||f.DataType.toLowerCase()=="date"?h.dictAttributes.sfwDataType="DateTime":f.DataType.toLowerCase()=="decimal"?h.dictAttributes.sfwDataType="Decimal":(f.DataType=="Int32"||f.DataType.toLowerCase()=="int"||f.DataType=="int32")&&(h.dictAttributes.sfwDataType="Numeric")));s&&n.FormModel&&n.FormModel.dictAttributes.sfwType!="Lookup"&&h.Name!="sfwLabel"&&h.Name!="sfwButton"&&h.Name!="sfwLinkButton"&&h.Name!="sfwImageButton"&&h.Name!=="sfwButtonGroup"&&(c=FindParent(h,"sfwGridView"),c&&(t.EditPropertyValue(c.dictAttributes.AllowEditing,c.dictAttributes,"AllowEditing","True"),t.EditPropertyValue(c.dictAttributes.sfwTwoWayBinding,c.dictAttributes,"sfwTwoWayBinding","True"),t.EditPropertyValue(c.dictAttributes.sfwCommonFilterBox,c.dictAttributes,"sfwCommonFilterBox","False"),t.EditPropertyValue(c.dictAttributes.sfwFilterOnKeyPress,c.dictAttributes,"sfwFilterOnKeyPress","False")));t.PushItem(h,o.Elements,"SetFormSelectedControl");n.SetFormSelectedControl(h)};n.AddSfxChartToGrid=function(i){for(var s,h,l,u,c,r,e,f,o=0;o<n.lstLoadedEntityTrees.length;o++)if(n.lstLoadedEntityTrees[o].IsVisible==!0){f=n.lstLoadedEntityTrees[o].selectedobjecttreefield;break}f&&i&&(s=getDisplayedEntity(n.LstDisplayedEntities),h="",h=s&&s.strDisplayName!=""?s.strDisplayName+"."+f.ID:f.ID,l=h,n.ParentEntityName=f.Entity,u=null,c=GetVM("sfwButtonGroup",i),u=c?c:GetVM("sfwColumn",i),null!=u&&(r=n.$new(),r.ObjChartModel={Name:"sfwChart",prefix:"swc",Value:"",dictAttributes:{ID:"",sfwEntityField:l,ChartType:"",Width:"",Height:"",ShowLegend:"True"},Elements:[],Children:[]},r.ObjChartModel.lstselectedobjecttreefields=[],r.ObjChartModel.selectedobjecttreefield,r.lstChartType=t.ChartTypes,r.lstToolTipTypes=["None","Chart","Table","Both"],r.DataFormats=["","{0:d}","{0:C}","{0:000-##-####}","{0:(###)###-####}"],r.SeriesModel={Name:"Series",prefix:"",Value:"",dictAttributes:{},Elements:[],Children:[]},r.SeriesModel.ParentVM=r.ObjChartModel,r.ObjChartModel.Elements.push(r.SeriesModel),e={Name:"ChartAreas",prefix:"",Value:"",dictAttributes:{},Elements:[],Children:[]},e.ParentVM=r.ObjChartModel,r.ObjChartModel.Elements.push(e),r.sfwChartAreaModel={Name:"sfwChartArea",prefix:"swc",Value:"",dictAttributes:{ChartAreaName:"",BackColor:""},Elements:[],Children:[]},r.sfwChartAreaModel.ParentVM=e,e.Elements.push(r.sfwChartAreaModel),r.removeSeriescolumnValues=function(n){for(var r,i,t=0;t<n.Elements.length;t++)if(n.Elements[t].Name=="Series"){for(r=n.Elements[t],i=0;i<r.Elements.length;i++)r.Elements[i].dictAttributes.sfwSeriesColumnName="";break}},r.onChartTypeChanged=function(){r.ObjChartModel.dictAttributes.ChartType&&(r.ObjChartModel.dictAttributes.ChartType=="Donut"||r.ObjChartModel.dictAttributes.ChartType=="Pie")&&(r.ObjChartModel.dictAttributes.sfwIsDynamicSeries="False",r.removeSeriescolumnValues(r.ObjChartModel))},r.Area3DStyle={Name:"Area3DStyle",prefix:"",Value:"",dictAttributes:{IsEnable3D:"false",Inclination:"",LightStyle:""},Elements:[],Children:[]},r.Area3DStyle.ParentVM=r.sfwChartAreaModel,r.sfwChartAreaModel.Elements.push(r.Area3DStyle),r.onSfxChartFinishClick=function(){var t,i,f,e;if(r.UpdateNavigationParam(),t=null,t=u.Name=="sfwButtonGroup"?u:GetVM("sfwTable",u),t&&t.Name!="sfwButtonGroup"){for(i={Name:"sfwRow",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]},i.ParentVM=t,f={Name:"sfwColumn",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]},f.ParentVM=i,r.ObjChartModel&&r.ObjChartModel.dictAttributes&&(r.ObjChartModel.dictAttributes.ID.match("^chr")||(r.ObjChartModel.dictAttributes.ID="chr"+r.ObjChartModel.dictAttributes.ID),f.Elements.push(r.ObjChartModel)),i.Elements.push(f),e=GetMaxColCount(t.Elements[0]),ind=1;ind<e;ind++)f={Name:"sfwColumn",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]},f.ParentVM=i,i.Elements.push(f);t.Elements.push(i)}t&&t.Name=="sfwButtonGroup"&&r.ObjChartModel&&r.ObjChartModel.dictAttributes&&(r.ObjChartModel.dictAttributes.ID.match("^chr")||(r.ObjChartModel.dictAttributes.ID="chr"+r.ObjChartModel.dictAttributes.ID),t.Elements.push(r.ObjChartModel));n.selectControl(r.ObjChartModel);r.onSfxChartCancelClick()},r.UpdateNavigationParam=function(){function t(t){var i=t.ParmeterValue,f,r,u;i!=null&&i!=""&&(f=t.ParmeterConstant,f&&(i="#"+i),r=i,u=t.ParmeterField,i.toLowerCase()!=u.toLowerCase()&&(r=u+"="+i),n==""?n=r:n+=";"+r)}function i(i){n="";angular.forEach(i.FormParameters,t);i.dictAttributes.sfwNavigationParameter=n}var n="";angular.forEach(r.SeriesModel.Elements,i)},r.onSfxChartCancelClick=function(){r.CreateChartDialog&&r.CreateChartDialog.close()},r.isChartNextDisable=function(){var n=!1;return r.ObjChartModel.ErrorMessageForDisplay="",r.ObjChartModel.ValidateChartName()?r.ObjChartModel.ValidateEntityCollection()?r.ObjChartModel.ValidateChartType()?r.ObjChartModel.ValidateWidth()?r.ObjChartModel.ValidateHeight()||(n=!0):n=!0:n=!0:n=!0:n=!0,n},r.ObjChartModel.ValidateChartName=function(){var n=!0;return r.ObjChartModel.dictAttributes.ID||(r.ObjChartModel.ErrorMessageForDisplay="Error: Please enter ID.",n=!1),n},r.ObjChartModel.ValidateEntityCollection=function(){var n=!0;return r.ObjChartModel.dictAttributes.sfwEntityField||(r.ObjChartModel.ErrorMessageForDisplay="Error: Please enter a Entity.",n=!1),n},r.ObjChartModel.ValidateChartType=function(){var n=!0;return r.ObjChartModel.dictAttributes.ChartType||(r.ObjChartModel.ErrorMessageForDisplay="Error: Please Select a ChartType.",n=!1),n},r.ObjChartModel.ValidateWidth=function(){var n=!0;return r.ObjChartModel.dictAttributes.Width||(r.ObjChartModel.ErrorMessageForDisplay="Error: Please enter a Width.",n=!1),n},r.ObjChartModel.ValidateHeight=function(){var n=!0;return r.ObjChartModel.dictAttributes.Height||(r.ObjChartModel.ErrorMessageForDisplay="Error: Please enter a Height.",n=!1),n},r.ShowSeriesDetail=function(n){n.ShowDetails=!n.ShowDetails},r.SelectSeries=function(n){r.ObjSeriesModel&&r.ObjSeriesModel!=n&&r.ObjSeriesModel.ShowDetails&&(r.ObjSeriesModel.ShowDetails=!1);r.ObjSeriesModel=n},r.GetSeriesID=function(){for(var t="Series",i=0,n=t,u=r.SeriesModel.Elements.filter(function(t){return t.dictAttributes.Name==n});u.length>0;)i++,n=t+i,u=r.SeriesModel.Elements.filter(function(t){return t.dictAttributes.Name==n});return n},r.OnAddSeriesClick=function(){var i=r.$new(),u;i.ObjSeriesModel={Name:"sfwSeries",prefix:"swc",Value:"",dictAttributes:{Name:"",XValueMember:"",YValueMembers:"",YMemberColor:"",IsValueShownAsLabel:"False",sfwFormatField:"",sfwTooltipType:"",sfwTooltipTableParams:"",sfwActiveForm:""},Elements:[],Children:[]};i.ObjSeriesModel.dictAttributes.Name=r.GetSeriesID();i.ObjSeriesModel.ParentVM=r.SeriesModel;i.ObjSeriesModel.lstselectedobjecttreefields=[];i.ObjSeriesModel.selectedobjecttreefield;i.ObjSeriesModel.ShowDetails=!0;i.ObjSeriesModel.FormParameters=[];i.ShowParameters=!1;n.receiveFormParameters=function(n){n&&i.$evalAsync(function(){i.ObjSeriesModel.FormParameters=n;i.ShowParameters=!0})};i.ClearParamtersForform=function(){i.ObjSeriesModel&&i.ObjSeriesModel.FormParameters&&(i.ObjSeriesModel.FormParameters="");i.ObjSeriesModel&&i.ObjSeriesModel.dictAttributes.sfwActiveForm!=""&&(i.seriesactiveform=!0);i.ShowParameters=!1};i.isChartFinishDisable=function(){var n=!1;return i.ErrorMessageForDisplay="",i.ObjSeriesModel&&(i.ValidateSeriesName()?i.ValidateXValue()?i.ValidateYValue()||(n=!0):n=!0:n=!0),n};i.ValidateSeriesName=function(){var n=!0;return i.ObjSeriesModel.dictAttributes.Name||(i.ErrorMessageForDisplay="Error: Please enter a Series Name.",n=!1),n};i.ValidateXValue=function(){var n=!0;return i.ObjSeriesModel.dictAttributes.XValueMember||(i.ErrorMessageForDisplay="Error: Please enter a Series XValueMember.",n=!1),n};i.ValidateYValue=function(){var n=!0;return i.ObjSeriesModel.dictAttributes.YValueMembers||(i.ErrorMessageForDisplay="Error: Please enter a Series YValueMembers.",n=!1),n};i.ValidateYValue=function(){var n=!0;return i.ObjSeriesModel.dictAttributes.YValueMembers||(i.ErrorMessageForDisplay="Error: Please enter a Series YValueMembers.",n=!1),n};i.OpenTooltipParams=function(){r.OpenTooltipParams(i)};i.onAdditionalChartColumnClick=function(){r.onAdditionalChartColumnClick(i)};i.onCancelClick=function(){u&&u.close()};i.OnOkClick=function(){i.ObjSeriesModel.dictAttributes.ChartType=r.ObjChartModel.dictAttributes.ChartType;r.SeriesModel.Elements.push(i.ObjSeriesModel);u&&u.close()};u=t.showDialog(i,"Add Series","Form/views/AddEditSeries.html",{width:600,height:600})},r.OpenTooltipParams=function(n){var i=n.$new();r.objTooltipParamsVM=t.showDialog(i,"Set Tooltip Parameters","Form/views/SetToolTipParameters.html",{width:500,height:420});i.onSfxChartTooltipTableCancelClick=function(){r.objTooltipParamsVM&&r.objTooltipParamsVM.close()};i.onSfxChartTooltipTableOKClick=function(){function e(n){var i=n.ID;f&&(i=f+"."+i);t=t?t+";"+i:i}var r=[],u,f,t;r=GetSelectedFieldList(n.ObjSeriesModel.lstselectedobjecttreefields,r);u=getDisplayedEntity(n.ObjSeriesModel.LstDisplayedEntities);f="";u&&u.strDisplayName!=""&&(f=u.strDisplayName);r.length>0&&(angular.forEach(r,e),n.ObjSeriesModel.dictAttributes.sfwTooltipTableParams=t);i.onSfxChartTooltipTableCancelClick()}},r.OnRemoveSeriesClick=function(){if(r.ObjSeriesModel){var n=r.SeriesModel.Elements.indexOf(r.ObjSeriesModel);r.SeriesModel.Elements.splice(n,1);n<r.SeriesModel.Elements.length?r.SelectSeries(r.SeriesModel.Elements[n]):r.SeriesModel.Elements.length>0?r.SelectSeries(r.SeriesModel.Elements[n-1]):r.ObjSeriesModel=undefined}},r.OnEditSeries=function(i){var u=r.$new(),f;u.ObjSeriesModel=i;u.ObjSeriesModel.ParentVM=undefined;u.ShowParameters=u.ObjSeriesModel.FormParameters&&u.ObjSeriesModel.FormParameters.length>0?!0:!1;u.seriesactiveform=!0;n.receiveFormParameters=function(n){n&&u.$evalAsync(function(){function i(n){var i=t.filter(function(t){return n.ParmeterField==t.ParmeterField});i&&i.length>0&&(n.ParmeterValue=i[0].ParmeterValue,n.ParmeterConstant=i[0].ParmeterConstant)}var t=u.ObjSeriesModel.FormParameters;u.ObjSeriesModel.FormParameters=[];t&&t.length>0&&angular.forEach(n,i);u.ObjSeriesModel.FormParameters=n;u.ShowParameters=!0})};u.ClearParamtersForform=function(){u.ObjSeriesModel&&u.ObjSeriesModel.FormParameters&&(u.ObjSeriesModel.FormParameters="");u.ObjSeriesModel&&u.ObjSeriesModel.dictAttributes.sfwActiveForm!=""&&(u.seriesactiveform=!0);u.ShowParameters=!1};u.isChartFinishDisable=function(){var n=!1;return u.ErrorMessageForDisplay="",u.ObjSeriesModel&&(u.ValidateSeriesName()?u.ValidateXValue()?u.ValidateYValue()||(n=!0):n=!0:n=!0),n};u.ValidateSeriesName=function(){var n=!0;return u.ObjSeriesModel.dictAttributes.Name||(u.ErrorMessageForDisplay="Error: Please enter a Series Name.",n=!1),n};u.ValidateXValue=function(){var n=!0;return u.ObjSeriesModel.dictAttributes.XValueMember||(u.ErrorMessageForDisplay="Error: Please enter a Series XValueMember.",n=!1),n};u.ValidateYValue=function(){var n=!0;return u.ObjSeriesModel.dictAttributes.YValueMembers||(u.ErrorMessageForDisplay="Error: Please enter a Series YValueMembers.",n=!1),n};r.ValidateActiveForm=function(){var n=!0;return u.ObjSeriesModel.dictAttributes.sfwActiveForm||(u.ErrorMessageForDisplay="Error: Please enter a Series Navigation Form.",n=!1),n};r.ValidateYValue=function(){var n=!0;return u.ObjSeriesModel.dictAttributes.YValueMembers||(u.ErrorMessageForDisplay="Error: Please enter a Series YValueMembers.",n=!1),n};u.OpenTooltipParams=function(){r.OpenTooltipParams(u)};u.onAdditionalChartColumnClick=function(){r.onAdditionalChartColumnClick(u)};u.onCancelClick=function(){f&&f.close()};u.OnOkClick=function(){u.ObjSeriesModel.ParentVM=r.SeriesModel;u.onCancelClick()};f=t.showDialog(u,"Edit Series","Form/views/AddEditSeries.html",{width:600,height:600})},r.onAdditionalChartColumnClick=function(n){var i=n.$new(),u,r,f;if(i.sfwAddtionalChartColumns=[],i.SelectedObject=n.ObjSeriesModel,n.ObjSeriesModel.dictAttributes.swfAddtionalChartColumns)for(u=n.ObjSeriesModel.dictAttributes.swfAddtionalChartColumns.split(","),r=0;r<u.length;r++)i.sfwAddtionalChartColumns.push({Property:u[r]});f=t.showDialog(i,"Multiple Objects Selection","Form/views/AdditionalChartColumnsDialog.html",{width:1e3,height:490});i.onCancelClick=function(){f.close()};i.onOkClick=function(){for(var u="",r=0;r<i.sfwAddtionalChartColumns.length;r++)i.sfwAddtionalChartColumns[r].Property!=""&&(u==""?u=i.sfwAddtionalChartColumns[r].Property:u+=","+i.sfwAddtionalChartColumns[r].Property);t.EditPropertyValue(n.ObjSeriesModel.dictAttributes.swfAddtionalChartColumns,n.ObjSeriesModel.dictAttributes,"swfAddtionalChartColumns",u);f.close()};i.selectRow=function(n){i.selectedRow=n};i.addProperty=function(){i.sfwAddtionalChartColumns.push({Property:""})};i.deleteProperty=function(){var n=-1,t;if(i.selectedRow)for(t=0;t<i.sfwAddtionalChartColumns.length;t++)if(i.selectedRow==i.sfwAddtionalChartColumns[t]){n=t;break}n>-1&&(i.sfwAddtionalChartColumns.splice(n,1),i.selectedRow=i.sfwAddtionalChartColumns.length>0?n>0?i.sfwAddtionalChartColumns[n-1]:i.sfwAddtionalChartColumns[i.sfwAddtionalChartColumns.length-1]:undefined)}},r.title="Create Chart",r.CreateChartDialog=t.showDialog(r,r.title,"Form/views/CreateChart.html",{width:1e3,height:700}),r.setTitle=function(n){r.title&&(r.title=n,r.CreateChartDialog.updateTitle(r.title))}))};n.AddSfxCalendarControl=function(i,r){for(var e,h,u,c,s,l,f,o=0;o<n.lstLoadedEntityTrees.length;o++)if(n.lstLoadedEntityTrees[o].IsVisible==!0){f=n.lstLoadedEntityTrees[o].selectedobjecttreefield;break}f&&i&&(e=null,h=GetVM("sfwButtonGroup",i),e=h?h:GetVM("sfwColumn",i),e&&(u=n.$new(),u.ShowNewParameters=!1,u.ShowOpenParameters=!1,u.IsAddScheduler=r,c="sfwCalendar",r&&(c="sfwScheduler"),u.objCalendar={Name:c,prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]},u.objCalendar.isNewSelected=!1,u.objCalendar.NewbuttonID="",u.objCalendar.NewformID="",u.objCalendar.isOpenSelected=!1,u.objCalendar.OpenbuttonID="",u.objCalendar.OpenformID="",s=getDisplayedEntity(n.LstDisplayedEntities),l=f.ID,s&&s.strDisplayName!=""&&(l=s.strDisplayName+"."+f.ID),strControlID=CreateControlID(n.FormModel,f.ID,"sfwCalendar"),u.objCalendar.dictAttributes.ID=strControlID,u.objCalendar.dictAttributes.sfwEntityField=l,u.FormModel=n.FormModel,u.ParentEntityName=f.Entity,u.SfxMainTable=n.SfxMainTable,u.title="Create New Calendar",r&&(u.title="Create New Scheduler",startsWith(strControlID,"cal",0)&&(strSchedulerID=strControlID.substring(3)),u.objCalendar.NewbuttonID||(u.objCalendar.NewbuttonID="btnNew"+strSchedulerID),u.objCalendar.OpenbuttonID||(u.objCalendar.OpenbuttonID="btnOpen"+strSchedulerID)),u.onAddButtons=function(){var t="swc",n;u.ialGridButtons=[];u.objCalendar.isNewSelected&&u.objCalendar.isNewSelected=="True"&&(n={Name:"sfwButton",prefix:t,Value:"",dictAttributes:{},Elements:[],Children:[]},n.dictAttributes.ID=u.objCalendar.NewbuttonID,n.dictAttributes.sfwMethodName="btnNew_Click",n.dictAttributes.sfwActiveForm=u.objCalendar.NewformID,n.dictAttributes.sfwRelatedControl=u.objCalendar.dictAttributes.ID,n.dictAttributes.Text="New",n.dictAttributes.sfwNavigationParameter=GetNavigationParameters(u.FormNewParameters),u.ialGridButtons.push(n));u.objCalendar.isOpenSelected&&u.objCalendar.isOpenSelected=="True"&&(n={Name:"sfwButton",prefix:t,Value:"",dictAttributes:{},Elements:[],Children:[]},n.dictAttributes.ID=u.objCalendar.OpenbuttonID,n.dictAttributes.sfwMethodName="btnOpen_Click",n.dictAttributes.sfwActiveForm=u.objCalendar.OpenformID,n.dictAttributes.sfwRelatedControl=u.objCalendar.dictAttributes.ID,n.dictAttributes.Text="Open",n.dictAttributes.sfwNavigationParameter=GetNavigationParameters(u.FormOpenParameters),u.ialGridButtons.push(n));u.ShowNewParameters=!1;u.ShowOpenParameters=!1},u.ValidateCalendar=function(){if(u.ErrorMessageForDisplay="",u.objCalendar.dictAttributes.ID==undefined||u.objCalendar.dictAttributes.ID=="")return u.ErrorMessageForDisplay="Enter ID.",!0;if(u.objCalendar.dictAttributes.ID&&!isValidIdentifier(u.objCalendar.dictAttributes.ID,!1,!1))return u.ErrorMessageForDisplay="Invalid ID.",!0;var t=[];return(CheckforDuplicateID(n.FormModel,u.objCalendar.dictAttributes.ID,t),t.length>0)?(u.ErrorMessageForDisplay="Duplicate ID.",!0):u.objCalendar.dictAttributes.sfwEventId==undefined||u.objCalendar.dictAttributes.sfwEventId==""?(u.ErrorMessageForDisplay="Enter Event Id.",!0):u.objCalendar.dictAttributes.sfwEventName==undefined||u.objCalendar.dictAttributes.sfwEventName==""?(u.ErrorMessageForDisplay="Enter Event Name.",!0):u.objCalendar.dictAttributes.sfwEventStartDate==undefined||u.objCalendar.dictAttributes.sfwEventStartDate==""?(u.ErrorMessageForDisplay="Enter Event Start Date.",!0):u.objCalendar.dictAttributes.sfwEventEndDate==undefined||u.objCalendar.dictAttributes.sfwEventEndDate==""?(u.ErrorMessageForDisplay="Enter Event End Date.",!0):u.objCalendar.errors&&y.isEmptyObj(u.objCalendar.errors)?!0:!1},u.onOkClick=function(){var i,h,o,c,s,r,f;if(u.onAddButtons(),i=null,i=e.Name=="sfwButtonGroup"?e:GetVM("sfwTable",e),i&&i.Name!="sfwButtonGroup"){if(h=GetMaxColCount(i.Elements[0],i),u.ialGridButtons.length>0){for(o={Name:"sfwRow",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]},o.ParentVM=i,ind=0;ind<h;ind++)s={Name:"sfwColumn",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]},s.ParentVM=o,o.Elements.push(s);c=0;function l(n){n.ParentVM=s;s.Elements.push(n)}s=o.Elements[c];angular.forEach(u.ialGridButtons,l);t.PushItem(o,i.Elements)}for(r={Name:"sfwRow",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]},r.ParentVM=i,f={Name:"sfwColumn",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]},f.ParentVM=r,f.Elements.push(u.objCalendar),r.Elements.push(f),ind=1;ind<h;ind++)f={Name:"sfwColumn",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]},f.ParentVM=r,r.Elements.push(f);t.PushItem(r,i.Elements);SetFormSelectedControl(n.FormModel,u.objCalendar,event)}if(i&&i.Name=="sfwButtonGroup"&&u.objCalendar){if(u.ialGridButtons.length>0){function a(n){t.PushItem(n,i.Elements)}angular.forEach(u.ialGridButtons,a)}t.PushItem(u.objCalendar,i.Elements);SetFormSelectedControl(n.FormModel,u.objCalendar,event)}u.onCancelClick()},u.onCancelClick=function(){u.objCalendar.errors&&(u.objCalendar.errors={},y.removeObjInToArray(n.validationErrorList,u.objCalendar));u.objCalendarDialog&&u.objCalendarDialog.close()},u.showParametersForScheduler=function(t){u.FieldControlCollection=[];t=="New"?(u.ShowOpenParameters=!1,u.ShowNewParameters=u.ShowNewParameters?!1:!0):t=="Open"&&(u.ShowNewParameters&&(u.ShowNewParameters=!1),u.ShowOpenParameters=u.ShowOpenParameters?!1:!0);PopulateAvailableControl(u.FieldControlCollection,u.SfxMainTable,u.ShowNewParameters,!1);$.connection.hubForm.server.getGlobleParameters().done(function(t){n.$apply(function(){u.objGlobleParameters=t;PopulateGlobalParameters(u.objGlobleParameters,u.FieldControlCollection)})})},u.populateParamtersForform=function(n,t){if(n){var i=n;t=="New"?u.ShowNewParameters=!1:t=="Open"&&(u.ShowOpenParameters=!1);$.connection.hubForm.server.getFormParameters(i,t).done(function(n){u.receiveFormParameters(n,t)})}},u.receiveFormParameters=function(n,t){n&&(t=="New"?u.FormNewParameters=n:t=="Open"&&(u.FormOpenParameters=n))},u.ExpandCollapsedCustomAttrField=function(n){n.IsExpanded=!n.IsExpanded},u.SetFieldClass=function(n){if(n==u.SelectedField)return"selected"},u.SelectFieldClick=function(n,t){u.SelectedField=n;t&&t.stopPropagation()},u.onChangeSchedulerCheckBox=function(n){n=="New"?(u.FormNewParameters=[],u.objCalendar.NewformID="",u.ShowNewParameters=!1):n=="Open"&&(u.FormOpenParameters=[],u.objCalendar.OpenformID="",u.ShowOpenParameters=!1)},u.objCalendarDialog=t.showDialog(u,u.title,"Form/views/AddCalendarControl.html",{width:700,height:700}),ComponentsPickers.init()))};n.AddSfxRepeaterControl=function(i){for(var s,a,f,w,b,k,d,e,c,v,g=CreateControlID(n.FormModel,"RepeaterViewPanel","sfwListView"),y="swc",o,h=0;h<n.lstLoadedEntityTrees.length;h++)if(n.lstLoadedEntityTrees[h].IsVisible==!0){o=n.lstLoadedEntityTrees[h].selectedobjecttreefield;break}if(o){var r={Name:"sfwListView",value:"",prefix:y,dictAttributes:{ID:g},Elements:[],Children:[]},l=getDisplayedEntity(n.LstDisplayedEntities),p=o.ID;if(l&&l.strDisplayName!=""&&(p=l.strDisplayName+"."+o.ID),strControlID=CreateControlID(n.FormModel,o.ID,"sfwListView"),r.dictAttributes.ID=strControlID,r.dictAttributes.sfwEntityField=p,s=null,a=GetVM("sfwButtonGroup",i),s=a?a:GetVM("sfwColumn",i),s&&(f=null,f=s.Name=="sfwButtonGroup"?s:GetVM("sfwTable",s),f&&r)){if(r.dictAttributes.sfwSelection="Many",r.dictAttributes.sfwCaption="List View",r.dictAttributes.AllowPaging="True",r.dictAttributes.PageSize="1",w=o.Entity,b=u.getEntityIntellisense(),r.dictAttributes.sfwDataKeyNames=GetTableKeyFields(w,b),y="swc",k=AddListViewTable(n.FormModel,r),r.Elements.push(k),r.initialvisibilty=!0,r.isLoaded=!0,t.UndRedoBulkOp("Start"),f.Name=="sfwButtonGroup")t.PushItem(r,f.Elements);else for(d=GetMaxColCount(f.Elements[0],f),e={Name:"sfwRow",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]},e.ParentVM=f,c={Name:"sfwColumn",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]},c.ParentVM=e,e.Elements.push(c),t.PushItem(e,f.Elements),t.PushItem(r,c.Elements),ind=1;ind<d;ind++)v={Name:"sfwColumn",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]},v.ParentVM=e,t.PushItem(v,e.Elements);t.UndRedoBulkOp("End");n.selectControl&&n.selectControl(r)}}};n.AddSfxGridviewToGrid=function(t){for(var r,i=0;i<n.lstLoadedEntityTrees.length;i++)if(n.lstLoadedEntityTrees[i].IsVisible==!0){r=n.lstLoadedEntityTrees[i].selectedobjecttreefield;break}n.AddGridControl(r,t)};n.AddGridControl=function(i,r,u,f,e){var s,h,o;i&&r&&(s=null,h=GetVM("sfwButtonGroup",r),s=h?h:GetVM("sfwColumn",r),s&&(o=n.$new(),o.objGridView={Name:"sfwGridView",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]},o.objGridView.LstDisplayedEntities=[],o.objGridView.lstselectedmultiplelevelfield=[],o.objGridView.selectedentityobjecttreefields=[],o.cellVM=s,o.IsAddToExistingCell=u,o.IsAddGridWithPanel=f,o.selectedEntityField=i,o.FormModel=n.FormModel,o.ParentEntityName=i.Entity,o.SfxMainTable=n.SfxMainTable,o.GridEntityField=e,o.IsGridInsideListView=!1,(r.Name==="sfwListView"||FindParent(r,"sfwListView"))&&(o.objGridView.IsGridInsideListView=!0),o.title="Create New Grid",o.LstDisplayedEntities=n.LstDisplayedEntities,n.FormModel.dictAttributes.sfwType=="Tooltip"&&(o.skipSecondStep=!0),o.IsPrototype=o.FormModel&&o.FormModel.dictAttributes.ID.startsWith("wfp")?!0:!1,o.objGridDialog=t.showDialog(o,o.title,"Form/views/CreateGridViewControl.html",{width:1e3,height:700}),o.setTitle=function(n){o.title&&(o.title=n,o.objGridDialog.updateTitle(o.title))}))};n.GetSfxControlVM=function(){var t=n.GetSelectedControl(),u,o,s,f,e,r,i;return t&&(t&&(t.Name=="sfwDialogPanel"||t.Name=="sfwPanel")&&t.IsMainPanel?(u=t,null!=u.TableVM&&u.TableVM.Elements.length>0?(i=u.TableVM.Elements[u.TableVM.Elements.length-1],null!=i&&i.Elements.length>0?n.FormModel.IsLookupCriteriaEnabled?(o=n.GetTabsVM(u.TableVM),o?t=n.GetDefaultControlVM(o):i.Elements[0].Name=="sfwColumn"&&(t=i.Elements[0])):i.Elements[0].Name=="sfwColumn"&&(t=i.Elements[0]):t=undefined):t=undefined):t.Name=="sfwWizardStep"||t.Name=="HeaderTemplate"?(r=t,r.TableVM&&r.TableVM.Elements.length>0?(i=r.TableVM.Elements[r.TableVM.Elements.length-1],i&&i.Elements.length>0?i.Elements[0].Name=="sfwColumn"&&(t=i.Elements[0]):t=null):t=null):t.Name=="sfwTabSheet"||t.Name==="sfwListView"?(s=t,f=s.Elements[0],null!=f&&(i=f.Elements[f.Elements.length-1],t=null!=i&&i.Elements.length>0?i.Elements[0].Name=="sfwColumn"?i.Elements[0]:null:null)):t.Name=="sfwTable"?(e=t,null!=e&&(i=e.Elements[e.Elements.length-1],t=null!=i&&i.Elements.length>0?i.Elements[0].Name=="sfwColumn"?i.Elements[0]:null:null)):t.Name=="TemplateField"&&t.Elements.length>0?t.Elements[0].Name=="ItemTemplate"&&(t=t.Elements[0]):t.Name=="sfwWizard"?n.CurrPanel&&n.CurrPanel.Name=="sfwWizardStep"&&(t=n.CurrPanel,r=t,r.TableVM&&r.TableVM.Elements.length>0?(i=r.TableVM.Elements[r.TableVM.Elements.length-1],i&&i.Elements.length>0?i.Elements[0].Name=="sfwColumn"&&(t=i.Elements[0]):t=null):t=null):t.Name=="sfwButtonGroup"||t.ParentVM&&t.ParentVM.Name=="ItemTemplate"&&(t=t.ParentVM)),t};n.GetDefaultControlVM=function(n){var u,r,t;if(n.SelectedTabSheet)for(i=0;i<n.SelectedTabSheet.Elements.length;i++)if(n.SelectedTabSheet.Elements[i].Name=="sfwTable"){r=n.SelectedTabSheet.Elements[i];r&&(t=r.Elements[r.Elements.length-1],t&&t.Elements.length>0&&t.Elements[0].Name=="sfwColumn"&&(u=t.Elements[0]));break}return u};n.GetTabsVM=function(n){var r,t,i;return n&&(t=n.Elements[0].Elements[0],t.Elements.length>0&&t.Elements[0].Name=="sfwTabContainer"&&(i=t.Elements[0],i.Elements.length>0&&i.Elements[0].Name=="Tabs"&&(r=i.Elements[0]))),r};n.GetSelectedControl=function(){return n.FormModel.SelectedControl};n.onUserControlDetailsClick=function(){var i=n.$new(),r;i.objExtraFields=[];i.objDirFunctions={};i.showExtraFieldsTab=!1;i.SelectedNewMethod=undefined;i.formName="Form";r=n.FormModel.dictAttributes.sfwEntity;i.Init=function(){n.InitialLoad?(i.InitialLoad={},angular.copy(n.InitialLoad,i.InitialLoad)):i.InitialLoad={Name:"initialload",Value:"",dictAttributes:{},Elements:[],Children:[]};i.FormModel={dictAttributes:{}};angular.forEach(n.FormModel.dictAttributes,function(n,t){i.FormModel.dictAttributes[t]=n});i.InitialLoadSectionForDetail();n.FormModel.errors&&(i.FormModel.errors={},i.FormModel.errors=n.FormModel.errors,y.removeObjInToArray(n.validationErrorList,n.FormModel),y.isEmptyObj(n.FormModel.errors)&&n.validationErrorList.push(i.FormModel));n.FormModel.dictAttributes.sfwType=="Tooltip"&&(i.PopulateXmlMethodForTooltip(r),i.SelectedNewMethod||(i.SelectedNewMethod={Name:"callmethods",Value:"",dictAttributes:{},Elements:[]},i.InitialLoad.Elements.push(i.SelectedNewMethod)),i.SelectedNewMethod&&i.populateXmlMethodParamtersForTooltip(i.SelectedNewMethod.dictAttributes.sfwMethodName))};i.InitialLoadSectionForDetail=function(){function n(n){n.Name=="callmethods"&&(i.SelectedNewMethod=n)}i.InitialLoad&&angular.forEach(i.InitialLoad.Elements,n)};i.ErrorMessageForDisplay="";i.validateUCDetails=function(){if(!n.FormModel.dictAttributes.sfwEntity)return i.ErrorMessageForDisplay="Entity Should be required",!1;i.objDirFunctions.getExtraFieldData&&(i.objExtraFields=i.objDirFunctions.getExtraFieldData());var t=validateExtraFields(i);return t?(i.ErrorMessageForDisplay=i.FormDetailsErrorMessage,!1):(i.ErrorMessageForDisplay="",!0)};i.updateEntityTree=function(t){n.entityTreeName=t};i.openEntityClick=function(t){t&&t!=""&&(n.FormModel&&n.FormModel.dictAttributes&&n.FormModel.dictAttributes.hasOwnProperty("sfwEntity")&&y.validateEntity(n.FormModel,n.validationErrorList),n.FormModel.errors&&!n.FormModel.errors.invalid_entity&&(i.userControlOkClick(),f.NavigateToFile(t,"","")))};i.selectXmlMethodClick=function(t){t&&t!=""&&t!="NewObject"&&(i.userControlOkClick(),f.NavigateToFile(n.FormModel.dictAttributes.sfwEntity,"methods",t))};i.PopulateXmlMethodForTooltip=function(n){function r(n){n.MethodType=="Load"&&i.XmlMethodsCollectionForTooltip.push(n)}i.XmlMethodsCollectionForTooltip=[];i.entityTreeName=n;i.XmlMethodsCollectionForTooltip.push({ID:""});i.XmlMethodsCollectionForTooltip.push({ID:"NewObject"});var t=u.getXmlMethods(n,!0);t&&t.length>0&&angular.forEach(t,r)};i.populateXmlMethodParamtersForTooltip=function(n){function r(n){i.paramtersForXmlMethodforTooltip.push(n)}if(i.paramtersForXmlMethodforTooltip=[],n){var t=i.XmlMethodsCollectionForTooltip.filter(function(t){return t.ID==n});t&&t.length>0&&angular.forEach(t[0].Parameters,r)}};i.userControlOkClick=function(){var f,s,e,h,o,u;if(i.validateUCDetails()){if(t.UndRedoBulkOp("Start"),i.objDirFunctions.prepareExtraFieldData&&i.objDirFunctions.prepareExtraFieldData(),r&&r!=i.FormModel.dictAttributes.sfwEntity){for(u=0;u<n.lstLoadedEntityTrees.length;u++)if(n.lstLoadedEntityTrees[u].EntityName==r){n.lstLoadedEntityTrees[u].EntityName=n.FormModel.dictAttributes.sfwEntity;break}if(i.updateEntityTree(i.FormModel.dictAttributes.sfwEntity),r==="entPrototype")for(f=getDescendents(n.FormModel,"sfwGridView"),u=0,s=f.length;u<s;u++)for(e=0,h=f[u].Elements.length;e<h;e++)if(f[u].Elements[e].Name.toLowerCase()==="data"){t.DeleteItem(f[u].Elements[e],f[u].Elements);t.EditPropertyValue(f[u].prototypemodel,f[u],"prototypemodel",null);break}}if(i.FormModel.dictAttributes.sfwType=="Tooltip"){if(i.objDirFunctions.prepareExtraFieldData&&i.objDirFunctions.prepareExtraFieldData(),angular.forEach(i.FormModel.dictAttributes,function(i,r){t.EditPropertyValue(n.FormModel.dictAttributes[r],n.FormModel.dictAttributes,r,i)}),n.FormModel.errors={},i.FormModel.errors&&(n.FormModel.errors=i.FormModel.errors,y.removeObjInToArray(n.validationErrorList,i.FormModel),y.isEmptyObj(i.FormModel.errors)&&n.validationErrorList.push(n.FormModel)),i.SelectedNewMethod&&(i.SelectedNewMethod.dictAttributes.sfwMethodName==undefined||i.SelectedNewMethod.dictAttributes.sfwMethodName=="")&&(o=i.InitialLoad.Elements.indexOf(i.SelectedNewMethod),o>-1&&(i.InitialLoad.Elements.splice(o,1),i.SelectedNewMethod=undefined)),i.SelectedNewMethod||(i.InitialLoad=undefined),i.InitialLoad&&!n.FormModel.Elements.some(function(n){return n.Name=="initialload"}))t.InsertItem(i.InitialLoad,n.FormModel.Elements,0);else if(i.InitialLoad&&n.FormModel.Elements.some(function(n){return n.Name=="initialload"})){for(u=0;u<n.FormModel.Elements.length;u++)if(n.FormModel.Elements[u].Name=="initialload"){t.DeleteItem(n.FormModel.Elements[u],n.FormModel.Elements);t.InsertItem(i.InitialLoad,n.FormModel.Elements,u);break}}else if(!i.InitialLoad)for(u=0;u<n.FormModel.Elements.length;u++)if(n.FormModel.Elements[u].Name=="initialload"){t.DeleteItem(n.FormModel.Elements[u],n.FormModel.Elements);break}t.EditPropertyValue(n.InitialLoad,n,"InitialLoad",i.InitialLoad)}else i.objDirFunctions.prepareExtraFieldData&&i.objDirFunctions.prepareExtraFieldData(),angular.forEach(i.FormModel.dictAttributes,function(i,r){t.EditPropertyValue(n.FormModel.dictAttributes[r],n.FormModel.dictAttributes,r,i)}),n.FormModel.errors={},i.FormModel.errors&&(n.FormModel.errors=i.FormModel.errors,y.removeObjInToArray(n.validationErrorList,i.FormModel),y.isEmptyObj(i.FormModel.errors)&&n.validationErrorList.push(n.FormModel));t.UndRedoBulkOp("End")}i.dialogObj.close()};i.dialogObj=t.showDialog(i,"Details","Form/views/userControlDetails.html",{width:550,height:555});i.Init()};n.onDetailClick=function(){var i,r,e,h,o,s;t.IsLoading=!0;i=n.$new(!0);i.MainQuery=undefined;i.objExtraFields=[];i.objFormExtraFields=n.objFormExtraFields;i.objDirFunctions={};i.showExtraFieldsTab=!1;i.formName="Form";i.FormModel={};i.remoteObject=null;n.InitialLoad?(i.InitialLoad={},angular.copy(n.InitialLoad,i.InitialLoad)):i.InitialLoad={Name:"initialload",Value:"",dictAttributes:{},Elements:[],Children:[]};i.InitialLoadSectionForDetail=function(){i.$evalAsync(function(){function t(t){if(t.Name=="callmethods")t.dictAttributes.sfwMode||(i.SelectedNewMethod=t,i.SelectedUpdateMethod="",i.FormModel.IsSameAsNew=!0),(t.dictAttributes.sfwMode=="New"||t.dictAttributes.sfwMode=="All")&&(i.SelectedNewMethod=t),(t.dictAttributes.sfwMode=="Update"||t.dictAttributes.sfwMode=="All")&&(i.SelectedUpdateMethod=t);else if(t.Name=="query"){var r=t.dictAttributes.sfwQueryRef;n.IsSubQuery(r)?(i.SubQueryCollection.Elements.push(t),i.SelectedSubQuery=t):i.MainQuery?i.SubQueryCollection.Elements.push(t):i.MainQuery=t}else t.Name=="session"&&(i.SessionFields=t,i.SessionFields.lstselectedobjecttreefields=[],i.SessionFields.LstDisplayedEntities=[])}i.SubQueryCollection={Elements:[]};i.InitialLoad&&angular.forEach(i.InitialLoad.Elements,t);n.FormModel.dictAttributes.sfwType=="Maintenance"&&i.InitialLoad&&i.SessionFields==undefined&&(i.SessionFields={Name:"session",Value:"",dictAttributes:{},Elements:[],Children:[]},i.SessionFields.lstselectedobjecttreefields=[],i.SessionFields.LstDisplayedEntities=[])})};i.FormModel={dictAttributes:{}};angular.forEach(n.FormModel.dictAttributes,function(n,t){i.FormModel.dictAttributes[t]=n});n.FormModel.errors&&(i.FormModel.errors={},i.FormModel.errors=n.FormModel.errors,y.removeObjInToArray(n.validationErrorList,n.FormModel),y.isEmptyObj(n.FormModel.errors)&&n.validationErrorList.push(i.FormModel));i.FormModel.RemoteObjectCollection=[];n.FormModel.RemoteObjectCollection&&angular.copy(n.FormModel.RemoteObjectCollection,i.FormModel.RemoteObjectCollection);i.$evalAsync(function(){i.IsPrototypeDetails=!1});n.FormModel.dictAttributes.ID.startsWith("wfp")&&i.$evalAsync(function(){i.IsPrototypeDetails=!0});r=n.FormModel.dictAttributes.sfwEntity;$.connection.hubMain.server.getFormExtraData(r).done(function(n){i.$evalAsync(function(){i.FormModel.objExtraData=n;i.populateXmlMethods(i.MethodType);i.Init()})});i.populateXmlMethods=function(n){var r,u,f,t;if(i.XmlNewMethodsCollection=[],i.XmlUpdateMethodsCollection=[],n!="SrvMethod"&&(i.paramtersForNewMethod=[],i.paramtersForUpdateMethod=[]),i.FormModel.objExtraData&&(u={Name:"",Value:"",dictAttributes:{ID:""},Elements:[],Children:[]},i.FormModel.objExtraData.lstMethodsList&&(r=i.FormModel.objExtraData.lstMethodsList.filter(function(n){return n.Name.toLowerCase()=="methods"}),i.XmlUpdateMethodsCollection.push(u),i.XmlNewMethodsCollection.push(u),u={Name:"",Value:"",dictAttributes:{ID:"NewObject"},Elements:[],Children:[]},i.XmlNewMethodsCollection.push(u),r&&r.length>0)))for(f=0;f<r.length;f++)for(j=0;j<r[f].Elements.length;j++)t=r[f].Elements[j],t.Name=="method"&&((t.dictAttributes.sfwMode=="New"||t.dictAttributes.sfwMode=="All")&&i.XmlNewMethodsCollection.push(t),(t.dictAttributes.sfwMode=="Update"||t.dictAttributes.sfwMode=="All")&&i.XmlUpdateMethodsCollection.push(t))};n.FormModel.dictAttributes.sfwType!="Lookup"&&i.populateXmlMethods();i.RemoteObjectCollection=[];i.IsEntityTabSelected=!1;i.IsGroupTabSelected=!1;i.IsSessionTabSelected=!1;i.SrvMethodCollection=[];i.lstWebsite=[];h=c.getLastProjectDetails();h&&h!=null&&(o=c.getLastProjectDetails().Website,o&&o!=null&&o.contains(";")?i.lstWebsite=c.getLastProjectDetails().Website.split(";"):i.lstWebsite.push(c.getLastProjectDetails().Website),i.lstWebsite.splice(0,0,""));i.Init=function(){i.IsSameAsNewDisabled=!0;var r=n.lstControl.filter(function(n){return n.attributetype&&n.attributetype==="value"}).map(function(n){return n.method}),u=getDescendents(n.FormModel);i.valueTypeFormControls=u.filter(function(n){return r.indexOf(n.Name)>-1&&n.dictAttributes.ID&&n.dictAttributes.sfwIsCaption!=="True"}).map(function(n){return n.dictAttributes.ID});n.PopulateRemoteObjects();i.FormModel.dictAttributes.sfwNewMessageID&&i.populateMessageForNewMessage(i.FormModel.dictAttributes.sfwNewMessageID);i.FormModel.dictAttributes.sfwOpenMessageID&&i.populateMessageForOpenMessage(i.FormModel.dictAttributes.sfwOpenMessageID);i.MethodType="XmlMethod";i.FormModel.dictAttributes.sfwRemoteObject?(i.MethodType="SrvMethod",i.remoteObject=i.FormModel.dictAttributes.sfwRemoteObject,$.connection.hubForm.server.getRemoteObjectList().done(function(n){i.$evalAsync(function(){n&&(i.FormModel.RemoteObjectCollection=n,i.FormModel.RemoteObjectCollection&&i.FormModel.RemoteObjectCollection.length>0&&i.FormModel.RemoteObjectCollection.splice(0,0,{dictAttributes:{ID:""}}),i.PopulateRemoteObject())})})):(i.SelectedNewMethod?i.populateParamtersForNew(i.SelectedNewMethod):i.SelectedNewMethod={Name:"callmethods",Value:"",dictAttributes:{sfwMode:"New"},Elements:[]},i.SelectedUpdateMethod?i.populateParamtersForUpdate(i.SelectedUpdateMethod):i.SelectedUpdateMethod={Name:"callmethods",Value:"",dictAttributes:{sfwMode:"Update"},Elements:[]});i.lstButtons=[];i.FormModel.objExtraData&&i.FormModel.objExtraData.lstRulesList&&(i.lstLogRules=i.FormModel.objExtraData.lstRulesList,i.lstLogRules.splice(0,0,{dictAttributes:{ID:""}}));n.SfxMainTable&&n.SfxMainTable.Elements&&FindControlListByName(n.SfxMainTable,"sfwButton",i.lstButtons);n.FormModel.dictAttributes.sfwType=="Lookup"&&(i.MainQuery||(i.MainQuery={Name:"query",Value:"",dictAttributes:{},Elements:[]},i.InitialLoad.Elements.push(i.MainQuery)));i.SessionFields&&(angular.forEach(i.SessionFields.Elements,function(n){i.validateSeesionID(n)}),i.valiidateSessionField());i.SubQueryCollection&&i.SubQueryCollection.Elements.length>0&&i.validateQueryID();t.IsLoading=!1;e=t.showDialog(i,"Form Details","Form/views/FormDetails.html",{width:700,height:700})};i.PopulateRemoteObject=function(){i.RemoteObjectCollection=i.FormModel.RemoteObjectCollection;i.RemoteObjectCollection&&i.RemoteObjectCollection.length>0&&(i.RemoteObjectCollection[0].dictAttributes.ID!=""&&i.RemoteObjectCollection.splice(0,0,{dictAttributes:{ID:""}}),i.onRemoteObjectChange());i.FormModel&&i.FormModel.dictAttributes&&i.FormModel.dictAttributes.sfwType!="Lookup"&&(i.SelectedNewMethod?i.populateSrvParamtersForNew(i.SelectedNewMethod):i.SelectedNewMethod={Name:"callmethods",Value:"",dictAttributes:{sfwMode:"New"},Elements:[]},i.SelectedUpdateMethod?i.populateSrvParamtersForUpdate(i.SelectedUpdateMethod):i.SelectedUpdateMethod={Name:"callmethods",Value:"",dictAttributes:{sfwMode:"Update"},Elements:[]})};i.onRemoteObjectChange=function(){if(i.isReset=!0,i.SrvMethodCollection=[],i.FormModel.dictAttributes.sfwRemoteObject!=undefined&&i.FormModel.dictAttributes.sfwRemoteObject!=""){i.remoteObject!=i.FormModel.dictAttributes.sfwRemoteObject&&(i.SelectedNewMethod&&(i.SelectedNewMethod.dictAttributes.sfwMethodName=""),i.SelectedUpdateMethod&&(i.SelectedUpdateMethod.dictAttributes.sfwMethodName=""),i.paramtersForNewMethod=[],i.paramtersForUpdateMethod=[]);var n=i.RemoteObjectCollection.filter(function(n){return n.dictAttributes.ID==i.FormModel.dictAttributes.sfwRemoteObject});n&&n.length>0&&(i.SrvMethodCollection=n[0].Elements,i.SrvNewMethodCollection=n[0].Elements.filter(function(n){return n.dictAttributes.sfwMode=="New"||n.dictAttributes.sfwMode=="All"}),i.SrvUpdateMethodCollection=n[0].Elements.filter(function(n){return n.dictAttributes.sfwMode=="Update"||n.dictAttributes.sfwMode=="All"}),i.SrvMethodCollection.splice(0,0,{dictAttributes:{ID:""}}))}else i.SrvNewMethodCollection=[],i.SrvUpdateMethodCollection=[]};i.onMethodTypeChange=function(n){i.MethodType=n;i.PopulateRemoteObject();i.MainQuery&&i.MainQuery.dictAttributes&&(i.MainQuery.dictAttributes.sfwMethodName="");i.SelectedNewMethod&&(i.SelectedNewMethod.dictAttributes.sfwMethodName="");i.SelectedUpdateMethod&&(i.SelectedUpdateMethod.dictAttributes.sfwMethodName="");i.FormModel.dictAttributes.sfwRemoteObject="";i.FormModel.dictAttributes.sfwGridCollection="";i.paramtersForNewMethod=[];i.paramtersForUpdateMethod=[];i.SrvMethodCollection=[];i.SrvNewMethodCollection=[];i.SrvUpdateMethodCollection=[]};i.selectXmlMethodClick=function(n){n&&n!=""&&n!="NewObject"&&(i.OkClick(),f.NavigateToFile(i.FormModel.dictAttributes.sfwEntity,"methods",n))};i.openMainQueryDialog=function(){var r=i.$new();r.strSelectedQuery=i.MainQuery.dictAttributes.sfwQueryRef;r.QueryDialog=t.showDialog(r,"Browse For Query","Form/views/BrowseForQuery.html",{width:1e3,height:700});r.$on("onQueryClick",function(t,r){n.IsSubQuery(r)||(r.contains(".")&&(i.MainQuery.dictAttributes.ID=r.split(".")[0]),i.MainQuery.dictAttributes.sfwQueryRef=r);t&&t.stopPropagation()})};i.onMainQueryChange=function(t){i.updateMainQueryChange();n.IsSubQuery(t)||(i.MainQuery||(i.MainQuery={Name:"query",Value:"",dictAttributes:{},Elements:[]},i.InitialLoad.Elements.push(i.MainQuery)),t&&t.contains(".")?i.MainQuery.dictAttributes.ID||(i.MainQuery.dictAttributes.ID=t.split(".")[0],i.MainQueryIDChange(i.MainQuery)):t||(i.MainQuery.dictAttributes.ID="",i.MainQueryIDChange(i.MainQuery)))};i.MainQueryIDChange=function(n){if(i.InitialLoad&&i.InitialLoad.Elements)for(var t=0;t<i.InitialLoad.Elements.length;t++)i.InitialLoad.Elements[t].dictAttributes&&i.InitialLoad.Elements[t].dictAttributes.sfwQueryRef==n.dictAttributes.sfwQueryRef&&(i.InitialLoad.Elements[t].dictAttributes.ID=n.dictAttributes.ID)};i.updateMainQueryChange=function(){if(i.InitialLoad&&i.InitialLoad.Elements)for(var n=0;n<i.InitialLoad.Elements.length;n++)i.InitialLoad.Elements[n].dictAttributes&&i.InitialLoad.Elements[n].dictAttributes.ID==i.MainQuery.dictAttributes.ID&&(i.InitialLoad.Elements[n].dictAttributes.sfwQueryRef=i.MainQuery.dictAttributes.sfwQueryRef)};i.onSubQueryClick=function(n){n&&(i.SelectedSubQuery=n)};i.getGroupList=function(n){var t=$(n.target),r=[],u;r=s();r.length>0&&r[0].Elements.length>0?(u=r[0].Elements,n.ctrlKey&&n.keyCode==$.ui.keyCode.SPACE?($(t).data("ui-autocomplete")&&$(t).autocomplete("search",$(t).val()),n.preventDefault()):setSingleLevelAutoComplete(t,u,i,"ID")):n.ctrlKey&&n.keyCode==$.ui.keyCode.SPACE&&n.preventDefault()};i.showGroupList=function(n){var t=$(n.target).prevAll("input[type='text']"),r=[],u;r=s();r.length>0&&r[0].Elements.length>0?(u=r[0].Elements,t.focus(),setSingleLevelAutoComplete(t,u,i,"ID"),$(t).data("ui-autocomplete")&&$(t).autocomplete("search",$(t).val())):setSingleLevelAutoComplete(t,[],i,"ID");n&&n.stopPropagation()};i.validdateGroupList=function(t){var r,u,f;t&&(r=s(),u=[],r&&r.length>0&&angular.forEach(r[0].Elements,function(n){n.dictAttributes&&n.dictAttributes.ID&&u.push(n.dictAttributes.ID)}),f=i.FormModel.dictAttributes&&i.FormModel.dictAttributes[t]?i.FormModel.dictAttributes[t]:"",y.checkValidListValue(u,i.FormModel,f,t,t,v.VALIDATION.INVALID_GROUP,n.validationErrorList))};s=function(){if(i.FormModel.objExtraData){var n=i.FormModel.objExtraData.lstGroupsList;return n&&n.length>0?n:[]}};i.selectGroupClick=function(n,t){t&&i.validdateGroupList(t);i.FormModel.errors&&!i.FormModel.errors[t]&&n&&n!=" "&&(e.close(),f.NavigateToFile(i.FormModel.dictAttributes.sfwEntity,"groupslist",n))};i.populateMessageForNewMessage=function(t){var r=!1,i;t&&t.trim().length>0&&(i=n.lstMessages.filter(function(n){return n.MessageID==t}),i&&i.length>0&&(n.newDisplayMessage=i[0].DisplayMessage,i[0].SeverityValue=="I"?n.newSeverityValue="Information":i[0].SeverityValue=="E"?n.newSeverityValue="Error":i[0].SeverityValue=="W"&&(n.newSeverityValue="Warnings"),r=!0));r||(n.newDisplayMessage="",n.newSeverityValue="")};i.populateMessageForOpenMessage=function(t){var r=!1,i;t&&t.trim().length>0&&(i=n.lstMessages.filter(function(n){return n.MessageID==t}),i&&i.length>0&&(n.openDisplayMessage=i[0].DisplayMessage,i[0].SeverityValue=="I"?n.openSeverityValue="Information":i[0].SeverityValue=="E"?n.openSeverityValue="Error":i[0].SeverityValue=="W"&&(n.openSeverityValue="Warnings"),r=!0));r||(n.openDisplayMessage="",n.openSeverityValue="")};i.populateXmlMethodsForEntityChange=function(n){var r,f,t;i.isReset=!0;r=n;i.XmlNewMethodsCollection=[];i.XmlUpdateMethodsCollection=[];i.lstLogRules=[];i.FormModel.objExtraData={};i.MethodType=="XmlMethod"&&(i.SelectedNewMethod&&i.SelectedNewMethod.dictAttributes.sfwMethodName&&(i.SelectedNewMethod.dictAttributes.sfwMethodName=""),i.SelectedUpdateMethod&&i.SelectedUpdateMethod.dictAttributes.sfwMethodName&&(i.SelectedUpdateMethod.dictAttributes.sfwMethodName=""),i.paramtersForUpdateMethod=[],i.paramtersForNewMethod=[]);f=u.getEntityIntellisense();t=f.filter(function(t){return t.ID==n});t&&t.length>0&&$.connection.hubMain.server.getFormExtraData(r).done(function(n){i.FormModel.objExtraData=n;i.populateXmlMethods(i.MethodType);i.lstLogRules=i.FormModel.objExtraData.lstRulesList;i.lstLogRules.splice(0,0,{dictAttributes:{ID:""}})});i.SessionFields&&i.valiidateSessionField()};i.populateParamtersForNew=function(n){function r(n){n.Name=="parameter"&&i.paramtersForNewMethod.push(n)}var t;i.paramtersForNewMethod=[];i.SelectedNewMethod||(i.SelectedNewMethod={Name:"callmethods",Value:"",Elements:[],dictAttributes:{sfwMethodName:n.dictAttributes.sfwMethodName}});i.InitialLoad.Elements.indexOf(i.SelectedNewMethod)<=-1&&i.InitialLoad.Elements.push(i.SelectedNewMethod);n.dictAttributes.sfwMethodName&&i.XmlNewMethodsCollection&&(t=i.XmlNewMethodsCollection.filter(function(t){return t.dictAttributes.ID==n.dictAttributes.sfwMethodName&&t.dictAttributes.sfwMode!="Update"}),t&&t.length>0&&angular.forEach(t[0].Elements,r));i.XmlUpdateMethodsCollection&&(t=i.XmlUpdateMethodsCollection.filter(function(t){return n.dictAttributes.sfwMethodName&&t.dictAttributes.ID==n.dictAttributes.sfwMethodName&&t.dictAttributes.sfwMode!="New"}),t&&t.length>0?i.IsSameAsNewDisabled=!1:(i.IsSameAsNewDisabled=!0,i.FormModel.IsSameAsNew=!1));!i.FormModel.IsSameAsNew&&i.SelectedNewMethod&&(i.SelectedNewMethod.dictAttributes.sfwMode="New")};i.populateSrvParamtersForNew=function(n){function r(n){n.Name=="parameter"&&i.paramtersForNewMethod.push(n)}var t;i.SelectedNewMethod||(i.SelectedNewMethod={Name:"callmethods",Value:"",Elements:[],dictAttributes:{sfwMethodName:n.dictAttributes.sfwMethodName}});i.InitialLoad.Elements.indexOf(i.SelectedNewMethod)<=-1&&i.InitialLoad.Elements.push(i.SelectedNewMethod);i.paramtersForNewMethod=[];n.dictAttributes.sfwMethodName&&i.SrvNewMethodCollection&&(t=i.SrvNewMethodCollection.filter(function(t){return t.dictAttributes.ID==n.dictAttributes.sfwMethodName&&t.dictAttributes.sfwMode!="Update"}),t&&t.length>0&&angular.forEach(t[0].Elements,r));i.SrvUpdateMethodCollection&&(t=i.SrvUpdateMethodCollection.filter(function(t){return t.dictAttributes.ID==n.dictAttributes.sfwMethodName&&t.dictAttributes.sfwMode!="New"}),t&&t.length>0?i.IsSameAsNewDisabled=!1:(i.IsSameAsNewDisabled=!0,i.FormModel.IsSameAsNew=!1));!i.FormModel.IsSameAsNew&&i.SelectedNewMethod&&(i.SelectedNewMethod.dictAttributes.sfwMode="New")};i.populateParamtersForUpdate=function(n){function r(n){n.Name=="parameter"&&i.paramtersForUpdateMethod.push(n)}if(i.paramtersForUpdateMethod=[],i.SelectedUpdateMethod||(i.SelectedUpdateMethod={Name:"callmethods",Value:"",Elements:[],dictAttributes:{sfwMethodName:n.dictAttributes.sfwMethodName,sfwMode:"Update"}}),i.InitialLoad.Elements.indexOf(i.SelectedUpdateMethod)<=-1&&i.InitialLoad.Elements.push(i.SelectedUpdateMethod),n.dictAttributes.sfwMode="Update",i.paramtersForUpdateMethod=[],n.dictAttributes.sfwMethodName&&i.XmlUpdateMethodsCollection){var t=i.XmlUpdateMethodsCollection.filter(function(t){return t.dictAttributes.ID==n.dictAttributes.sfwMethodName&&t.dictAttributes.sfwMode!="New"});t&&t.length>0&&angular.forEach(t[0].Elements,r)}};i.populateSrvParamtersForUpdate=function(n){function r(n){n.Name=="parameter"&&i.paramtersForUpdateMethod.push(n)}if(i.SelectedUpdateMethod||(i.SelectedUpdateMethod={Name:"callmethods",Value:"",Elements:[],dictAttributes:{sfwMethodName:n.dictAttributes.sfwMethodName,sfwMode:"Update"}}),i.InitialLoad.Elements.indexOf(i.SelectedUpdateMethod)<=-1&&i.InitialLoad.Elements.push(i.SelectedUpdateMethod),n.dictAttributes.sfwMode="Update",i.paramtersForUpdateMethod=[],n.dictAttributes.sfwMethodName&&i.SrvUpdateMethodCollection){var t=i.SrvUpdateMethodCollection.filter(function(t){return t.dictAttributes.ID==n.dictAttributes.sfwMethodName&&t.dictAttributes.sfwMode!="New"});t&&t.length>0&&angular.forEach(t[0].Elements,r)}};i.openSubQueryDialog=function(){var r=n.$new();r.subQueryType="SubSelectQuery";r.QueryDialog=t.showDialog(r,"Browse For Query","Form/views/BrowseForQuery.html",{width:1e3,height:700});r.$on("onQueryClick",function(n,t){var r={Name:"query",Value:"",dictAttributes:{},Elements:[],Children:[]},u;t.contains(".")&&(u=i.InitialLoad.Elements.filter(function(n){return n.dictAttributes.ID&&n.dictAttributes.ID.contains(t.split(".")[0])}),r.dictAttributes.ID=u&&u.length>0?GetInitialLoadQueryID(t.split(".")[0],i.InitialLoad.Elements,1):GetInitialLoadQueryID(t.split(".")[0],i.SubQueryCollection.Elements,1));r.dictAttributes.sfwQueryRef=t;i.InitialLoad&&(i.InitialLoad.Elements.push(r),i.SubQueryCollection.Elements.push(r),i.SelectedSubQuery=r);n&&n.stopPropagation()})};i.onChangeSubQuery=function(n){if(i.SelectedSubQuery&&n&&n.contains(".")){var t=i.GetQueryId(n.split(".")[0]);i.SelectedSubQuery.dictAttributes.ID=t}};i.GetQueryId=function(n){var u=0,f=n,t=f,r;if(i.InitialLoad)for(r=i.InitialLoad.Elements.filter(function(n){return n.dictAttributes.ID==t});r&&r.length>0;)u++,t=f+u,r=i.InitialLoad.Elements.filter(function(n){return n.dictAttributes.ID==t});return t};i.openEditQueryDialog=function(){var n=i.$new();i.SelectedSubQuery&&(n.strSelectedQuery=i.SelectedSubQuery.dictAttributes.sfwQueryRef,n.subQueryType="SubSelectQuery",n.QueryDialog=t.showDialog(n,"Browse For Query","Form/views/BrowseForQuery.html",{width:1e3,height:700}),n.$on("onQueryClick",function(n,t){t.contains(".")&&(i.SelectedSubQuery.dictAttributes.ID=t.split(".")[0]);i.SelectedSubQuery.dictAttributes.sfwQueryRef=t}),event&&event.stopPropagation())};i.deleteSelectedSubQuery=function(){var n,t;i.SelectedSubQuery&&(n=-1,i.SelectedSubQuery&&(n=i.SubQueryCollection.Elements.indexOf(i.SelectedSubQuery)),i.SubQueryCollection.Elements.splice(n,1),t=-1,i.SelectedSubQuery&&(t=i.InitialLoad.Elements.indexOf(i.SelectedSubQuery)),t>-1&&i.InitialLoad.Elements.splice(t,1),i.SelectedSubQuery=undefined,n<i.SubQueryCollection.Elements.length?i.SelectedSubQuery=i.SubQueryCollection.Elements[n]:i.SubQueryCollection.Elements.length>0&&(i.SelectedSubQuery=i.SubQueryCollection.Elements[n-1]))};i.canDelete=function(){return i.SelectedSubQuery?!0:!1};i.moveUpClick=function(){if(i.SelectedSubQuery){var t=i.SubQueryCollection.Elements.indexOf(i.SelectedSubQuery),r=i.SubQueryCollection.Elements[t-1];i.SubQueryCollection.Elements[t-1]=i.SelectedSubQuery;i.SubQueryCollection.Elements[t]=r;n.scrollBySelectedField(".manage-subquery-scroll",".selected",{offsetTop:480,offsetLeft:0})}};i.canmoveUp=function(){if(i.Flag=!0,i.SelectedSubQuery!=undefined)for(var n=0;n<i.SubQueryCollection.Elements.length;n++)i.SubQueryCollection.Elements[n]==i.SelectedSubQuery&&n>0&&(i.Flag=!1);return i.Flag};i.moveDownClick=function(){if(i.SelectedSubQuery){var t=i.SubQueryCollection.Elements.indexOf(i.SelectedSubQuery),r=i.SubQueryCollection.Elements[t+1];i.SubQueryCollection.Elements[t+1]=i.SelectedSubQuery;i.SubQueryCollection.Elements[t]=r;n.scrollBySelectedField(".manage-subquery-scroll",".selected",{offsetTop:480,offsetLeft:0})}};i.canMoveDown=function(){if(i.Flag=!0,i.SelectedSubQuery!=undefined)for(var n=0;n<i.SubQueryCollection.Elements.length;n++)i.SubQueryCollection.Elements[n]==i.SelectedSubQuery&&n<i.SubQueryCollection.Elements.length-1&&(i.Flag=!1);return i.Flag};i.getButtonList=function(n){i.lstButtons&&i.lstButtons.length>0&&(i.inputElement||(i.inputElement=$(n.target)),n.ctrlKey&&n.keyCode==$.ui.keyCode.SPACE&&(setSingleLevelAutoComplete($(i.inputElement),i.lstButtons,i,"ID"),$(i.inputElement).data("ui-autocomplete")&&$(i.inputElement).autocomplete("search",$(i.inputElement).val()),n.preventDefault()),setSingleLevelAutoComplete($(i.inputElement),i.lstButtons,i,"ID"))};i.showButtonList=function(n){i.inputElement||(i.inputElement=$(n.target).prevAll("input[type='text']"));i.inputElement.focus();i.inputElement&&(setSingleLevelAutoComplete(i.inputElement,i.lstButtons,i,"ID"),$(i.inputElement).data("ui-autocomplete")&&$(i.inputElement).autocomplete("search",$(i.inputElement).val()));n&&n.stopPropagation()};i.validateButtonName=function(){var t=[];i.lstButtons&&angular.forEach(i.lstButtons,function(n){n.dictAttributes&&n.dictAttributes.ID&&t.push(n.dictAttributes.ID)});y.checkValidListValue(t,i.FormModel,$(i.inputElement).val(),"sfwDefaultButtonID","sfwDefaultButtonID",v.VALIDATION.BUTTON_NOT_EXISTS,n.validationErrorList)};i.CheckAndAddSessionFields=function(){i.InitialLoad&&(i.InitialLoad.Elements.some(function(n){return n.Name=="session"})||i.InitialLoad.Elements.push(i.SessionFields))};i.addSessionFields=function(){function t(n){var t=getDisplayedEntity(i.SessionFields.LstDisplayedEntities),r=n.ID,u,f;t&&t.strDisplayName!=""&&(r=t.strDisplayName+"."+n.ID);n.IsSelected.toLowerCase()=="true"&&(i.SessionFields.Elements.some(function(t){return t.dictAttributes.ID==n.ID})||(u=r,f={Name:"field",Value:"",dictAttributes:{ID:n.ID,sfwEntityField:u},Elements:[]},i.SessionFields.Elements.push(f)),n.IsRecordSelected=!1)}i.CheckAndAddSessionFields();var n=[];n=GetSelectedFieldList(i.SessionFields.lstselectedobjecttreefields,n);n&&n.length>0&&angular.forEach(n,t);i.SessionFields.lstselectedobjecttreefields&&i.SessionFields.lstselectedobjecttreefields.length>0&&ClearSelectedFieldList(i.SessionFields.lstselectedobjecttreefields)};i.selectedSessionFieldClick=function(n){n&&(i.selectedCurrentSessionRow=n)};i.deleteSelectedRow=function(){var t=-1;i.selectedCurrentSessionRow&&(t=i.SessionFields.Elements.indexOf(i.selectedCurrentSessionRow));i.SessionFields.Elements.splice(t,1);y.removeObjInToArray(n.validationErrorList,i.SessionFields);i.selectedCurrentSessionRow=undefined;t<i.SessionFields.Elements.length?i.selectedCurrentSessionRow=i.SessionFields.Elements[t]:i.SessionFields.Elements.length>0&&(i.selectedCurrentSessionRow=i.SessionFields.Elements[t-1])};i.canDeleteRow=function(){return i.selectedCurrentSessionRow?!0:!1};i.moveSelectedRowUp=function(){if(i.selectedCurrentSessionRow){var t=i.SessionFields.Elements.indexOf(i.selectedCurrentSessionRow),t=i.SessionFields.Elements.indexOf(i.selectedCurrentSessionRow),r=i.SessionFields.Elements[t-1];i.SessionFields.Elements[t-1]=i.selectedCurrentSessionRow;i.SessionFields.Elements[t]=r;n.scrollBySelectedField(".details-session-panel-body",".selected",{offsetTop:300,offsetLeft:0})}};i.canmoveSelectedRowUp=function(){var t=!0,n;if(i.selectedCurrentSessionRow!=undefined)for(n=0;n<i.SessionFields.Elements.length;n++)i.SessionFields.Elements[n]==i.selectedCurrentSessionRow&&n>0&&(t=!1);return t};i.moveSelectedRowDown=function(){if(i.selectedCurrentSessionRow){var t=i.SessionFields.Elements.indexOf(i.selectedCurrentSessionRow),t=i.SessionFields.Elements.indexOf(i.selectedCurrentSessionRow),r=i.SessionFields.Elements[t+1];i.SessionFields.Elements[t+1]=i.selectedCurrentSessionRow;i.SessionFields.Elements[t]=r;n.scrollBySelectedField(".details-session-panel-body",".selected",{offsetTop:300,offsetLeft:0})}};i.canmoveSelectedRowDown=function(){var t=!0,n;if(i.selectedCurrentSessionRow!=undefined)for(n=0;n<i.SessionFields.Elements.length;n++)i.SessionFields.Elements[n]==i.selectedCurrentSessionRow&&n<i.SessionFields.Elements.length-1&&(t=!1);return t};i.InitialLoadSectionForDetail();i.OnSelectDetailTab=function(n){i.selectedDetailTab=n;n=="Entity"&&(i.IsEntityTabSelected||(i.IsEntityTabSelected=!0));n=="Group"&&(i.IsGroupTabSelected||(i.IsGroupTabSelected=!0));n=="Session"&&(i.IsSessionTabSelected||(i.IsSessionTabSelected=!0));n=="ExtraFields"&&(i.IsExtraFieldTabSelected||(i.IsExtraFieldTabSelected=!0))};i.OkClick=function(){var f,o,s,u,h;if(e.close(),r!=i.FormModel.dictAttributes.sfwEntity)for(n.entityTreeName=i.FormModel.dictAttributes.sfwEntity,u=0;u<n.lstLoadedEntityTrees.length;u++)if(n.lstLoadedEntityTrees[u].EntityName==r){n.lstLoadedEntityTrees[u].EntityName=i.FormModel.dictAttributes.sfwEntity;break}if(t.UndRedoBulkOp("Start"),i.objDirFunctions.prepareExtraFieldData&&i.objDirFunctions.prepareExtraFieldData(),angular.forEach(i.FormModel.dictAttributes,function(i,r){t.EditPropertyValue(n.FormModel.dictAttributes[r],n.FormModel.dictAttributes,r,i)}),n.selectControl(n.FormModel.SelectedControl),n.FormModel.errors={},i.FormModel.errors&&(n.FormModel.errors=i.FormModel.errors,y.removeObjInToArray(n.validationErrorList,i.FormModel),y.isEmptyObj(i.FormModel.errors)&&n.validationErrorList.push(n.FormModel)),i.MainQuery&&n.MainQuery&&i.MainQuery.dictAttributes.ID!=n.MainQuery.dictAttributes.ID&&(f=GetCriteriaPanel(n.FormModel),n.setNewQueryIdForLookupControl(f,n.MainQuery.dictAttributes.ID,i.MainQuery.dictAttributes.ID,!0)),i.removeObjectFromErrorList(),n.FormModel.dictAttributes.sfwType=="Lookup"){if(i.MainQuery&&!i.MainQuery.dictAttributes.sfwQueryRef&&(i.MainQuery=undefined,i.InitialLoad=undefined,t.EditPropertyValue(n.MainQuery,n,"MainQuery",undefined),t.EditPropertyValue(n.SelectedQuery,n,"SelectedQuery",undefined)),i.MainQuery&&i.SubQueryCollection.Elements&&n.SubQueryCollection&&n.MainQuery?(f=GetCriteriaPanel(n.FormModel),angular.forEach(n.SubQueryCollection,function(t){var r=!1,u=!0,e="";i.SubQueryCollection&&i.SubQueryCollection.Elements.length>0?angular.forEach(i.SubQueryCollection.Elements,function(n){t.dictAttributes.ID!=n.dictAttributes.ID&&t.dictAttributes.sfwQueryRef==n.dictAttributes.sfwQueryRef&&(r=!0,e=n.dictAttributes.ID,u=!1);t.dictAttributes.ID==n.dictAttributes.ID&&(u=!1)}):r=!0;r&&n.setNewQueryIdForLookupControl(f,t.dictAttributes.ID,e);u&&n.setNewQueryIdForLookupControl(f,t.dictAttributes.ID,"")})):n.SubQueryCollection?(f=GetCriteriaPanel(n.FormModel),angular.forEach(n.SubQueryCollection,function(t){t.dictAttributes&&t.dictAttributes.ID&&n.setNewQueryIdForLookupControl(f,t.dictAttributes.ID,"")})):!i.MainQuery&&n.MainQuery&&n.MainQuery.dictAttributes&&n.MainQuery.dictAttributes.ID&&(f=GetCriteriaPanel(n.FormModel),n.setNewQueryIdForLookupControl(f,n.MainQuery.dictAttributes.ID,i.MainQuery.dictAttributes.ID,!0)),i.MainQuery&&i.InitialLoad){for(u=0;u<i.InitialLoad.Elements.length;u++)if(i.InitialLoad.Elements[u].dictAttributes.sfwQueryRef==i.MainQuery.dictAttributes.sfwQueryRef){i.InitialLoad.Elements[u]=i.MainQuery;break}if(n.FormModel.Elements.some(function(n){return n.Name=="initialload"})){for(u=0;u<n.FormModel.Elements.length;u++)if(n.FormModel.Elements[u].Name=="initialload"){t.DeleteItem(n.FormModel.Elements[u],n.FormModel.Elements);t.InsertItem(i.InitialLoad,n.FormModel.Elements,u);n.FormModel.Elements[u]=i.InitialLoad;break}}else i.InitialLoad&&!n.FormModel.Elements.some(function(n){return n.Name=="initialload"})&&t.InsertItem(i.InitialLoad,n.FormModel.Elements,0)}else for(u=0;u<n.FormModel.Elements.length;u++)if(n.FormModel.Elements[u].Name=="initialload"){t.DeleteItem(n.FormModel.Elements[u],n.FormModel.Elements);break}}else if(n.FormModel&&(n.FormModel.dictAttributes.sfwType=="Maintenance"||n.FormModel.dictAttributes.sfwType=="Wizard")){if(i.SelectedNewMethod&&(i.SelectedNewMethod.dictAttributes.sfwMethodName==undefined||i.SelectedNewMethod.dictAttributes.sfwMethodName=="")&&(o=i.InitialLoad.Elements.indexOf(i.SelectedNewMethod),o>-1&&(i.InitialLoad.Elements.splice(o,1),i.SelectedNewMethod=undefined)),i.SelectedUpdateMethod&&(i.SelectedUpdateMethod.dictAttributes.sfwMethodName==undefined||i.SelectedUpdateMethod.dictAttributes.sfwMethodName=="")&&(s=i.InitialLoad.Elements.indexOf(i.SelectedUpdateMethod),s>-1&&(i.InitialLoad.Elements.splice(s,1),i.SelectedUpdateMethod=undefined)),i.InitialLoad.Elements.some(function(n){return n.Name=="session"})){for(u=0;u<i.InitialLoad.Elements.length;u++)if(i.InitialLoad.Elements[u].Name=="session"){i.SessionFields&&i.SessionFields.Elements.length>0?i.InitialLoad.Elements[u]=i.SessionFields:i.InitialLoad.Elements.splice(u,1);break}}else i.SessionFields&&i.SessionFields.Elements.length>0&&i.InitialLoad.Elements.push(i.SessionFields);if(i.SelectedNewMethod||i.SelectedUpdateMethod||i.SessionFields&&(!i.SessionFields||i.SessionFields.Elements.length!=0)||(i.InitialLoad=undefined),i.InitialLoad&&!n.FormModel.Elements.some(function(n){return n.Name=="initialload"}))t.InsertItem(i.InitialLoad,n.FormModel.Elements,0);else if(i.InitialLoad&&n.FormModel.Elements.some(function(n){return n.Name=="initialload"})){for(u=0;u<n.FormModel.Elements.length;u++)if(n.FormModel.Elements[u].Name=="initialload"){t.DeleteItem(n.FormModel.Elements[u],n.FormModel.Elements);t.InsertItem(i.InitialLoad,n.FormModel.Elements,u);break}}else if(!i.InitialLoad)for(u=0;u<n.FormModel.Elements.length;u++)if(n.FormModel.Elements[u].Name=="initialload"){t.DeleteItem(n.FormModel.Elements[u],n.FormModel.Elements);break}}t.EditPropertyValue(n.InitialLoad,n,"InitialLoad",i.InitialLoad);n.InitialLoadSection();t.UndRedoBulkOp("End");n.FormModel.dictAttributes.sfwType=="Lookup"&&(h=!1,n.FormModel.IsLookupCriteriaEnabled&&(h=!0),n.PopulateQueryId(h))};n.setNewQueryIdForLookupControl=function(i,r,u,f){i&&angular.forEach(i.Elements,function(i){i.dictAttributes&&i.dictAttributes.sfwQueryID&&i.dictAttributes.sfwQueryID==r&&(u&&u!=""?(t.EditPropertyValue(i.dictAttributes.sfwQueryID,i.dictAttributes,"sfwQueryID",""),i.dictAttributes.sfwQueryID=u):(t.EditPropertyValue(i.dictAttributes.sfwQueryID,i.dictAttributes,"sfwQueryID",""),i.dictAttributes.sfwQueryID="",f||(t.EditPropertyValue(i.dictAttributes.sfwDataField,i.dictAttributes,"sfwDataField",""),i.dictAttributes.sfwDataField="")));i.Elements&&n.setNewQueryIdForLookupControl(i,r,u,f)})};i.validateFormDetails=function(){if(!i.IsPrototypeDetails){i.FormDetailsErrorMessage="";i.objDirFunctions.getExtraFieldData&&(i.objExtraFields=i.objDirFunctions.getExtraFieldData());return validateExtraFields(i)}};i.NavigateToEntityQuery=function(n){if(n&&n!=""&&n.contains(".")){i.OkClick();var t=n.split(".");f.NavigateToFile(t[0],"queries",t[1])}};i.openEntityClick=function(n){n&&n!=""&&(i.OkClick(),f.NavigateToFile(n,"",""))};i.openQueryEditClick=function(n,r){var u=i.$new();u.Title=r;u.newID="";n&&n.dictAttributes.ID&&(u.newID=n.dictAttributes.ID);u.QueryEditDialog=t.showDialog(u,u.Title,"Form/views/SetQueryName.html",{width:500,height:150});u.setQueryName=function(){n.dictAttributes.ID=u.newID;u.closeQueryDialog()};u.closeQueryDialog=function(){u.QueryEditDialog.close()}};i.IsSameAsNewChecked=function(){function f(n){n.Name=="callmethods"&&(n.dictAttributes.sfwMode=="Update"&&(u=!0),n.dictAttributes.sfwMode||(n.dictAttributes.sfwMode="New"))}function e(n){n.Name=="callmethods"&&(n.dictAttributes.sfwMode=="New"&&(n.dictAttributes.sfwMode=""),n.dictAttributes.sfwMode=="Update"&&(r=i.InitialLoad.Elements.indexOf(n)))}var r,u,t;i.SelectedUpdateMethod={Name:"callmethods",Value:"",Elements:[],dictAttributes:{sfwMethodName:"",sfwMode:"Update"}};i.FormModel.IsSameAsNew?(i.paramtersForUpdateMethod=[],r=-1,angular.forEach(i.InitialLoad.Elements,e),r>-1&&i.InitialLoad.Elements.splice(r,1)):(u=!1,angular.forEach(i.InitialLoad.Elements,f),u||(t={Name:"callmethods",value:"",prefix:"",dictAttributes:{},Elements:[],Children:[]},t.ParentVM=n.InitialLoad,t.dictAttributes.sfwMode="Update",i.InitialLoad.Elements.push(t),i.SelectedUpdateMethod=t))};i.validateSeesionID=function(t){y.validateID(t,n.validationErrorList,t.dictAttributes.ID,undefined,!0);angular.forEach(i.SessionFields.Elements,function(t){y.checkDuplicateId(t,i.SessionFields,n.validationErrorList,!0,["session","field"])})};i.valiidateSessionField=function(){angular.forEach(i.SessionFields.Elements,function(t){y.checkValidListValueForMultilevel([],t,t.dictAttributes.sfwEntityField,i.FormModel.dictAttributes.sfwEntity,"sfwEntityField","sfwEntityField",v.VALIDATION.ENTITY_FIELD_INCORRECT,n.validationErrorList,!1,"")})};i.validateQueryID=function(){i.SubQueryCollection&&n.FormModel.dictAttributes.sfwType=="Lookup"&&angular.forEach(i.SubQueryCollection.Elements,function(t){y.checkDuplicateId(t,i.SubQueryCollection,n.validationErrorList,!0,["query"]);y.checkValidQuery(u.getEntityIntellisense(),t,t.dictAttributes.sfwQueryRef,"SubSelectQuery","sfwQueryRef","sfwQueryRef",v.VALIDATION.INVALID_QUERY,n.validationErrorList)})};i.removeObjectFromErrorList=function(){y.removeObjInToArray(n.validationErrorList,i.FormModel);i.SessionFields&&i.SessionFields.Elements&&angular.forEach(i.SessionFields.Elements,function(t){y.removeObjInToArray(n.validationErrorList,t)});i.SubQueryCollection&&i.SubQueryCollection.Elements.length>0&&angular.forEach(i.SubQueryCollection.Elements,function(t){y.removeObjInToArray(n.validationErrorList,t)})};i.closeDetailDialog=function(){i.removeObjectFromErrorList();e.close()}};n.receiveUcMainTable=function(t){var i,r;for(n.tableTemp,i=0;i<n.FormModel.Elements.length;i++)if(n.FormModel.Elements[i].Name=="sfwTable"){n.tableTemp=n.FormModel.Elements[i];break}for(i=0;i<t.length;i++)r=FindControlByID(n.tableTemp,t[i].ID),r&&n.$apply(function(){r.UcChild=t?[t[i].udcModel]:[];setParentControlName(r.UcChild[0])})};n.onActionKeyDown=function(i){var h=i.target,f=[],l,v,y,b,a,p,o,c,r,e;if(n.ObjgridBoundedQuery&&!n.ObjgridBoundedQuery.IsQuery){v=n.lstLoadedEntityTrees.filter(function(n){return n.IsVisible});l=v&&v.length>0?v[0].EntityName:n.FormModel.SelectedControl&&!n.FormModel.IsLookupCriteriaEnabled&&FindParent(n.FormModel.SelectedControl,"sfwDialogPanel")?"":n.FormModel.dictAttributes.sfwEntity;n.FormModel.SelectedControl&&n.FormModel.SelectedControl.dictAttributes.sfwRelatedGrid&&(y=FindControlByID(n.FormModel,n.FormModel.SelectedControl.dictAttributes.sfwRelatedGrid),y&&y.dictAttributes.sfwEntityField?(b=w.GetEntityFieldObjectFromEntityField(n.FormModel.dictAttributes.sfwEntity,y.dictAttributes.sfwEntityField),b&&(l=b.Entity)):l="");n.FormModel.SelectedControl&&n.FormModel.SelectedControl.IsChildOfGrid&&(a=FindParent(n.FormModel.SelectedControl,"sfwGridView"),a&&a.dictAttributes.sfwParentGrid&&a.dictAttributes.sfwEntityField&&(l=n.FindEntityName(a,n.FormModel.dictAttributes.sfwEntity,!0)));p=!1;n.FormModel.SelectedControl.Name=="sfwLabel"&&(p=!0);for(var d=u.getEntityIntellisense(),k=d,s=l;s;)f=f.concat(t.getEntityAttributeIntellisense(s,!1,!1,!1,!1,!1,p)),c=k.filter(function(n){return n.ID==s}),s=c.length>0?c[0].ParentId:""}else n.ObjgridBoundedQuery.lstselectedobjecttreefields&&n.ObjgridBoundedQuery.lstselectedobjecttreefields.length>0&&(f=n.ObjgridBoundedQuery.lstselectedobjecttreefields);if(o=getSplitArray(h.innerText,getCaretCharacterOffsetWithin(h)),o.length>0)for(e=0;e<o.length;e++)if(r=f.filter(function(n){return n.ID==o[e]}),r.length>0)if(r[0].Type=="Constant"&&r[0].ID==o[e])break;else if(r[0].ID=="RFunc"&&o[e]=="RFunc")f=t.rFuncMethods;else if(typeof r[0].DataType!="undefined"&&(r[0].DataType=="Object"||r[0].DataType=="Collection"||r[0].DataType=="CDOCollection"||r[0].DataType=="List")&&typeof r[0].Entity!="undefined"&&r[0].ID==o[e]&&e<o.length-1)for(s=r[0].Entity,f=[];s;)f=f.concat(t.getEntityAttributeIntellisense(s,!1,!1,!1,!1,!1,p,!1)),c=k.filter(function(n){return n.ID==s}),s=c.length>0?c[0].ParentId:"";else f=r[0].DataType!="undefined"&&r[0].DataType!="Object"&&r[0].DataType!="Collection"&&r[0].DataType!="CDOCollection"&&r[0].DataType!="List"&&r[0].DataType!="AliasObject"?[]:r;if(r=[],o.length>0){for(e=0;e<o.length;e++)r=f.filter(function(n){if(n.ID)return n.ID.toLowerCase().contains(o[e].toLowerCase())});f=r}setRuleIntellisense($(h),f);i.ctrlKey&&i.keyCode==$.ui.keyCode.SPACE&&$(h).data("ui-autocomplete")&&($(h).autocomplete("search",$(h).val()),i.preventDefault())};n.OpenValidateNewDialog=function(){var i=n.$new(),r;if(i.lstButton=[],i.lstButton=PopulateButtonID(n.FormModel,i.lstButton),n.ValidateNew){if(i.objValidateNew={},angular.copy(n.ValidateNew,i.objValidateNew),i.objValidateNew.Elements.length>0)for(r=0;r<i.objValidateNew.Elements.length;r++)i.objValidateNew.Elements[r].IsFieldVisibility=!1}else i.objValidateNew={dictAttributes:{},Children:[],Elements:[],Name:"validatenew",Value:""};dialog=t.showDialog(i,"Set New Validation","Form/views/ValidateNewDialog.html",{width:1280,height:450});i.onOkClick=function(){var u=n.FormModel.Elements.filter(function(n){return n.Name==="validatenew"}),r;if(u&&u.length>0){if(t.UndRedoBulkOp("Start"),n.ValidateNew&&t.EditPropertyValue(n.ValidateNew.Elements,n.ValidateNew,"Elements",[]),i.objValidateNew&&i.objValidateNew.Elements)for(r=0;r<i.objValidateNew.Elements.length>0;r++)t.PushItem(i.objValidateNew.Elements[r],n.ValidateNew.Elements);t.UndRedoBulkOp("End")}else t.UndRedoBulkOp("Start"),t.PushItem(i.objValidateNew,n.FormModel.Elements),t.EditPropertyValue(n.ValidateNew,n,"ValidateNew",i.objValidateNew),t.UndRedoBulkOp("End");i.onCancelClick()};i.onCancelClick=function(){dialog.close()};i.GetButtonIntellisense=function(n){var t;n.type=="click"?(t=$(n.target).prevAll("input"),t&&($(t).focus(),setSingleLevelAutoComplete(t,i.lstButton,i,"ID"),$(t).data("ui-autocomplete")&&$(t).autocomplete("search",$(t).val())),n.preventDefault()):(t=$(n.target),n.ctrlKey&&n.keyCode==$.ui.keyCode.SPACE&&$(t).data("ui-autocomplete")?($(t).autocomplete("search",$(t).val()),n.preventDefault()):setSingleLevelAutoComplete(t,i.lstButton,i,"ID"))};i.validateButtonID=function(t){var r=[];i.lstButton&&i.lstButton.length>0&&angular.forEach(i.lstButton,function(n){n.dictAttributes&&n.dictAttributes.ID&&r.push(n.dictAttributes.ID)});y.checkValidListValue(r,t,t.dictAttributes.ButtonID,"ButtonID","inValid_id",v.VALIDATION.NOT_VALID_ID,n.validationErrorList)};i.AddNewValidationRule=function(){var n={dictAttributes:{},Elements:[],Children:[],Name:"button",Value:""};i.objValidateNew.Elements.push(n);i.objSelectedRule=i.objValidateNew.Elements[i.objValidateNew.Elements.length-1];i.ExpandRule(n)};i.selectedValidateRule=function(n){i.selectedItem=null;i.objSelectedRule=n};i.canDeleteRule=function(){return i.objSelectedRule?!0:!1};i.DeleteValidationRule=function(){var n=i.objValidateNew.Elements.indexOf(i.objSelectedRule);n>-1&&(i.objValidateNew.Elements.splice(n,1),i.objValidateNew.Elements.length==0?i.objSelectedRule=undefined:i.objValidateNew.Elements.length>n?i.objSelectedRule=i.objValidateNew.Elements[n]:i.objValidateNew.Elements.length>0&&(i.objSelectedRule=i.objValidateNew.Elements[n-1]))};i.ExpandRule=function(n){if(!n.IsFieldVisibility&&i.objValidateNew.Elements.length>0)for(var t=0;t<i.objValidateNew.Elements.length;t++)i.objValidateNew.Elements[t].IsFieldVisibility=!1;n.IsFieldVisibility=!n.IsFieldVisibility};i.selectItem=function(n,t){i.selectedItem=n;i.objSelectedRule=t};i.canMoveItemsDown=function(){if(i.selectedItem){var n=i.objSelectedRule.Elements.indexOf(i.selectedItem);return n<i.objSelectedRule.Elements.length-1?!0:!1}return!1};i.canMoveItemsUp=function(){if(i.selectedItem){var n=i.objSelectedRule.Elements.indexOf(i.selectedItem);return n<=i.objSelectedRule.Elements.length&&n>0?!0:!1}return!1};i.canDeleteItems=function(){if(i.selectedItem){if(i.objSelectedRule&&i.objSelectedRule.Elements.indexOf(i.selectedItem)>-1)return!0}else return!1};i.moveItemsDown=function(n){var t=n.Elements.indexOf(i.selectedItem),r;t>-1&&(r=n.Elements[t],n.Elements[t]=n.Elements[t+1],n.Elements[t+1]=r)};i.moveItemsUp=function(n){var t=n.Elements.indexOf(i.selectedItem),r;t>-1&&(r=n.Elements[t],n.Elements[t]=n.Elements[t-1],n.Elements[t-1]=r)};i.deleteItems=function(n){i.objSelectedRule=n;var t=n.Elements.indexOf(i.selectedItem);t>-1&&(n.Elements.splice(t,1),n.Elements.length==0?i.selectedItem=undefined:n.Elements.length>t?i.selectedItem=n.Elements[t]:n.Elements.length>0&&(i.selectedItem=n.Elements[t-1]))};i.EditItems=function(n,t){i.selectedItem=t;i.addItems(n,"Update")};i.addItems=function(r,u){var f,e,o,s,h;if(i.objSelectedRule=r,f=n.$new(),f.lstControlID=[],f.lstControlID=PopulateControlID(n.FormModel,f.lstControlID),f.lstMethodParam=[],i.lstButton.length>0&&i.objSelectedRule&&i.objSelectedRule.dictAttributes.ButtonID)for(e=0;e<i.lstButton.length;e++)if(i.lstButton[e].dictAttributes.ID==i.objSelectedRule.dictAttributes.ButtonID&&i.lstButton[e].dictAttributes.sfwNavigationParameter!=""&&i.lstButton[e].dictAttributes.sfwNavigationParameter!=undefined)for(o=i.lstButton[e].dictAttributes.sfwNavigationParameter.split(";"),s=0;s<o.length;s++)o[e]!=""&&(h=o[s].split("="),f.lstMethodParam.push(h[0]));f.objItem=u=="Add"?{dictAttributes:{sfwValidationType:"Required",sfwRequired:"True"},Name:"item",Value:"",Children:[],Elements:[]}:i.selectedItem;f.lstoperator=["","=","!=","<",">","<=",">="];dialogItem=t.showDialog(f,"Add New Items","Form/views/AddNewItemsInValidationRule.html",{width:690,height:420});f.onOkClick=function(n){u=="Add"&&t.PushItem(n,i.objSelectedRule.Elements);dialogItem.close()};f.getControlIDIntellisense=function(n){var t;n&&(n.type=="click"?(t=$(n.target).prevAll("input"),t&&(setSingleLevelAutoComplete(t,f.lstControlID),$(t).data("ui-autocomplete")&&$(t).autocomplete("search",$(t).val())),n.preventDefault()):(t=$(n.target),n.ctrlKey&&n.keyCode==$.ui.keyCode.SPACE&&$(t).data("ui-autocomplete")?($(t).autocomplete("search",$(t).val()),n.preventDefault()):setSingleLevelAutoComplete(t,f.lstControlID)))};f.validateNewItem=function(t){if(t){var i=f.lstControlID&&f.lstControlID.length>0?f.lstControlID:[];y.checkValidListValue(i,t,t.dictAttributes.sfwControlID,"sfwControlID","sfwControlID",v.VALIDATION.NOT_VALID_ID,n.validationErrorList)}};f.QueryChange=function(){f.objItem.dictAttributes.sfwParameters=""};f.objItem&&!f.objItem.TempQueryParameters&&f.objItem.dictAttributes.sfwQueryID!=undefined&&f.objItem.dictAttributes.sfwQueryID!=""&&(f.objItem.TempQueryParameters=l.get(f.objItem.dictAttributes.sfwQueryID));f.openQueryParameterDialog=function(){var n=f.$new(),o,u,r,i,s,e;if(n.objParameter=[],n.lstParameters=f.lstMethodParam,f.objItem.dictAttributes.sfwParameters)for(o=f.objItem.dictAttributes.sfwParameters.split(";"),i=0;i<o.length;i++)u=o[i].split("="),u[0]!=""&&n.objParameter.push({ParameterField:u[0],ParameterValue:u[1]});if(f.objItem.TempQueryParameters)for(r=f.objItem.TempQueryParameters.split(";"),i=0;i<r.length;i++){for(s=!0,e=0;e<n.objParameter.length;e++)if(n.objParameter[e].ParameterField==r[i].replace("=","")){s=!1;break}s&&r[i]!=""&&n.objParameter.push({ParameterField:r[i].replace("=",""),ParameterValue:""})}dialogParam=t.showDialog(n,"Set Query Parameters","Form/views/SetQueryParameter.html",{width:550,height:300});n.paraOkClick=function(){for(var i="",t=0;t<n.objParameter.length;t++)n.objParameter[t].ParameterValue&&n.objParameter[t].ParameterValue!=""&&(i+=n.objParameter[t].ParameterField+"="+n.objParameter[t].ParameterValue+";");f.objItem.dictAttributes.sfwParameters=i;dialogParam.close()};n.paraCancelClick=function(){dialogParam.close()}}}};n.showWizardProperty=function(){SetFormSelectedControl(n.FormModel,n.objWizard);n.ActiveTabForForm="Properties";n.IsToolsDivCollapsed=!1};n.OnAddPanelClick=function(i,r){var u=n.$new();u.formmodel=n.FormModel;u.AddPanelType="AddPanel";u.OkClick=function(){u.AddPanelType==="AddPanel"?(n.AddPanel(i,r),u.closeDetailDialog()):u.AddPanelType==="AddPanelWithTab"?(n.AddPanelWithTabContainer(i,r),u.closeDetailDialog()):u.AddPanelType==="AddPanelWithGrid"&&(n.AddPanelWithGrid(i,r),u.closeDetailDialog())};u.validatePanel=function(){var n=!1;return u.ErrorMessage="",u.AddPanelType||(u.ErrorMessage="Select Option.",n=!0),n};u.closeDetailDialog=function(){u.dialogToAddPanel.close()};u.dialogToAddPanel=t.showDialog(u,"Add Panel","Form/views/AddPanels.html",{width:500,height:195})};n.AddPanel=function(i,r){var c,o,h,f,l,s,e,u;t.UndRedoBulkOp("Start");o={Name:"sfwRow",prefix:"swc",Value:"",dictAttributes:{},Elements:[]};o.ParentVM=n.SfxMainTable;h={Name:"sfwColumn",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]};h.ParentVM=o;c=CreateControlID(n.FormModel,"NewPanel","sfwPanel",!1);f={Name:"sfwPanel",prefix:"swc",Value:"",dictAttributes:{ID:c,sfwCaption:"New Page"},Elements:[],Children:[]};f.ParentVM=h;t.PushItem(f,h.Elements);t.PushItem(h,o.Elements);l=CreateControlID(n.FormModel,"NewPage","sfwTable",!1);s={Name:"sfwTable",prefix:"swc",Value:"",dictAttributes:{ID:l},Elements:[],Children:[]};s.ParentVM=f;e={Name:"sfwRow",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]};e.ParentVM=s;u={Name:"sfwColumn",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]};u.ParentVM=e;t.PushItem(u,e.Elements);u={Name:"sfwColumn",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]};u.ParentVM=e;t.PushItem(u,e.Elements);u={Name:"sfwColumn",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]};u.ParentVM=e;t.PushItem(u,e.Elements);u={Name:"sfwColumn",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]};u.ParentVM=e;t.PushItem(u,e.Elements);t.PushItem(e,s.Elements);t.PushItem(s,f.Elements);n.MainPanels.some(function(t){if(t.dictAttributes.ID==n.CurrPanel.dictAttributes.ID)return t.initialvisibilty=!1,t.IsVisible=!1,t.IsPanelToggle=!1,!0});n.SfxMainTable||(n.SfxMainTable={Name:"sfwTable",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]},t.PushItem(n.SfxMainTable,n.FormModel.Elements));r&&i>-1?(t.InsertItem(o,n.SfxMainTable.Elements,i),t.InsertItem(f,n.MainPanels,i)):(t.PushItem(o,n.SfxMainTable.Elements),t.PushItem(f,n.MainPanels));f.initialvisibilty=!0;f.TableVM=s;f.IsMainPanel=!0;n.selectPanelControl(f);t.UndRedoBulkOp("End")};n.AddPanelWithTabContainer=function(i,r){var c,f,o,u,l,e,s,h,a;t.UndRedoBulkOp("Start");f={Name:"sfwRow",prefix:"swc",Value:"",dictAttributes:{},Elements:[]};f.ParentVM=n.SfxMainTable;o={Name:"sfwColumn",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]};o.ParentVM=f;c=CreateControlID(n.FormModel,"NewPanel","sfwPanel",!1);u={Name:"sfwPanel",prefix:"swc",Value:"",dictAttributes:{ID:c,sfwCaption:"New Page"},Elements:[],Children:[]};u.ParentVM=o;t.PushItem(u,o.Elements);t.PushItem(o,f.Elements);l=CreateControlID(n.FormModel,"NewPage","sfwTable",!1);e={Name:"sfwTable",prefix:"swc",Value:"",dictAttributes:{ID:l},Elements:[],Children:[]};e.ParentVM=u;s={Name:"sfwRow",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]};s.ParentVM=e;h={Name:"sfwColumn",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]};h.ParentVM=s;a=CreateTabContainer(n.FormModel,h);t.PushItem(a,h.Elements);t.PushItem(h,s.Elements);t.PushItem(s,e.Elements);t.PushItem(e,u.Elements);n.MainPanels.some(function(t){if(t.dictAttributes.ID==n.CurrPanel.dictAttributes.ID)return t.initialvisibilty=!1,t.IsVisible=!1,t.IsPanelToggle=!1,!0});n.SfxMainTable||(n.SfxMainTable={Name:"sfwTable",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]},t.PushItem(n.SfxMainTable,n.FormModel.Elements));r&&i>-1?(t.InsertItem(f,n.SfxMainTable.Elements,i),t.InsertItem(u,n.MainPanels,i)):(t.PushItem(f,n.SfxMainTable.Elements),t.PushItem(u,n.MainPanels));u.initialvisibilty=!0;u.TableVM=e;u.IsMainPanel=!0;n.selectPanelControl(u);t.UndRedoBulkOp("End")};n.AddPanelWithGrid=function(i,r){var l,e,o,s,a,f,h,c,u;t.UndRedoBulkOp("Start");e={Name:"sfwRow",prefix:"swc",Value:"",dictAttributes:{},Elements:[]};e.ParentVM=n.SfxMainTable;o={Name:"sfwColumn",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]};o.ParentVM=e;l=CreateControlID(n.FormModel,"NewPanel","sfwPanel",!1);s={Name:"sfwPanel",prefix:"swc",Value:"",dictAttributes:{ID:l,sfwCaption:"New Page"},Elements:[],Children:[]};s.ParentVM=o;t.PushItem(s,o.Elements);t.PushItem(o,e.Elements);a=CreateControlID(n.FormModel,"NewPage","sfwTable",!1);f={Name:"sfwTable",prefix:"swc",Value:"",dictAttributes:{ID:a},Elements:[],Children:[]};f.ParentVM=s;h={Name:"sfwRow",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]};h.ParentVM=f;c={Name:"sfwColumn",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]};c.ParentVM=h;u=n.$new();u.formobject=n.FormModel;u.model=undefined;u.dropdata=c;u.IsAddNewGrid=!0;u.IsAddGridWithPanel=!0;u.BindToQueryDialog=t.showDialog(u,"Bind to Query","Form/views/BindToQuery.html",{width:600,height:250});u.onAfterOkClick=function(){n.AddPanelToList(e,f,r,i)};t.PushItem(c,h.Elements);t.PushItem(h,f.Elements);t.PushItem(f,s.Elements)};n.AddPanelToList=function(i,r,u,f){var e=FindParent(r,"sfwPanel");n.MainPanels.some(function(t){if(t.dictAttributes.ID==n.CurrPanel.dictAttributes.ID)return t.initialvisibilty=!1,t.IsVisible=!1,t.IsPanelToggle=!1,!0});n.SfxMainTable||(n.SfxMainTable={Name:"sfwTable",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]},t.PushItem(n.SfxMainTable,n.FormModel.Elements));u&&f>-1?(t.InsertItem(i,n.SfxMainTable.Elements,f),t.InsertItem(e,n.MainPanels,f)):(t.PushItem(i,n.SfxMainTable.Elements),t.PushItem(e,n.MainPanels));e.initialvisibilty=!0;e.TableVM=r;e.IsMainPanel=!0;n.selectPanelControl(e);t.UndRedoBulkOp("End")};n.OnAddWizardStepClick=function(i,r){var u=n.$new();u.formmodel=n.FormModel;u.AddPanelType="AddWizardStep";u.OkClick=function(){u.AddPanelType==="AddWizardStep"?(n.OnAddWizardStep(i,r),u.closeDetailDialog()):u.AddPanelType==="AddWizardStepWithTab"?(n.OnAddWizardStepWithTabContainer(i,r),u.closeDetailDialog()):u.AddPanelType==="AddWizardStepWithGrid"&&(n.OnAddWizardStepWithGridView(i,r),u.closeDetailDialog())};u.validatePanel=function(){var n=!1;return u.ErrorMessage="",u.AddPanelType||(u.ErrorMessage="Select Option.",n=!0),n};u.closeDetailDialog=function(){u.dialogToAddPanel.close()};u.dialogToAddPanel=t.showDialog(u,"Add Panel","Form/views/AddPanels.html",{width:620,height:195})};n.OnAddWizardStep=function(i,r){var c,f,w,u,e,h,y,p;if(t.UndRedoBulkOp("Start"),c=[],FindControlListByName(n.SfxMainTable,"WizardSteps",c),c.length>0&&(f=c[0]),f){for(var o=CreateControlID(n.FormModel,"wzsStep","sfwWizardStep",!1),a=f.Elements.filter(function(n){return n.dictAttributes.ID==o}),l=0,b=o;a&&a.length>0;)l++,o=b+l,a=f.Elements.filter(function(n){return n.dictAttributes.ID==o});w=o;u={Name:"sfwWizardStep",prefix:"swc",Value:"",dictAttributes:{},Elements:[]};u.ParentVM=f;u.dictAttributes.runat="server";u.dictAttributes.sfwShowInHeader="True";u.dictAttributes.ID=o;u.dictAttributes.Title=w.replace("wzsStep","New Step ");e={Name:"sfwTable",prefix:"swc",Value:"",dictAttributes:{},Elements:[]};e.ParentVM=u;e.dictAttributes.runat="server";e.dictAttributes.CssClass="Table";for(var s="tblStep1",v=f.Elements.filter(function(n){return n.Elements[0].dictAttributes.ID==s}),l=0,k=s;v&&v.length>0;)l++,s=k+l,v=f.Elements.filter(function(n){return n.Elements[0].dictAttributes.ID==s});for(e.dictAttributes.ID=s,t.PushItem(e,u.Elements),h={Name:"sfwRow",prefix:"swc",Value:"",dictAttributes:{},Elements:[]},h.ParentVM=e,t.PushItem(h,e.Elements),y=0;y<4;y++)p={Name:"sfwColumn",prefix:"swc",Value:"",dictAttributes:{},Elements:[]},p.ParentVM=h,t.PushItem(p,h.Elements);n.MainPanels.some(function(t){if(t.dictAttributes.ID==n.CurrPanel.dictAttributes.ID)return t.initialvisibilty=!1,t.IsVisible=!1,t.IsPanelToggle=!1,!0});r&&i>-1?(t.InsertItem(u,f.Elements,i),t.InsertItem(u,n.MainPanels,i)):(t.PushItem(u,f.Elements),t.PushItem(u,n.MainPanels));u.initialvisibilty=!0;u.TableVM=e;n.selectPanelControl(u)}t.UndRedoBulkOp("End")};n.OnAddWizardStepWithTabContainer=function(i,r){var l,f,p,u,e,h,c,w;if(t.UndRedoBulkOp("Start"),l=[],FindControlListByName(n.SfxMainTable,"WizardSteps",l),l.length>0&&(f=l[0]),f){for(var o=CreateControlID(n.FormModel,"wzsStep","sfwWizardStep",!1),v=f.Elements.filter(function(n){return n.dictAttributes.ID==o}),a=0,b=o;v&&v.length>0;)a++,o=b+a,v=f.Elements.filter(function(n){return n.dictAttributes.ID==o});p=o;u={Name:"sfwWizardStep",prefix:"swc",Value:"",dictAttributes:{},Elements:[]};u.ParentVM=f;u.dictAttributes.runat="server";u.dictAttributes.sfwShowInHeader="True";u.dictAttributes.ID=o;u.dictAttributes.Title=p.replace("wzsStep","New Step ");e={Name:"sfwTable",prefix:"swc",Value:"",dictAttributes:{},Elements:[]};e.ParentVM=u;e.dictAttributes.runat="server";e.dictAttributes.CssClass="Table";for(var s="tblStep1",y=f.Elements.filter(function(n){return n.Elements[0].dictAttributes.ID==s}),a=0,k=s;y&&y.length>0;)a++,s=k+a,y=f.Elements.filter(function(n){return n.Elements[0].dictAttributes.ID==s});e.dictAttributes.ID=s;t.PushItem(e,u.Elements);h={Name:"sfwRow",prefix:"swc",Value:"",dictAttributes:{},Elements:[]};h.ParentVM=e;t.PushItem(h,e.Elements);c={Name:"sfwColumn",prefix:"swc",Value:"",dictAttributes:{},Elements:[]};c.ParentVM=h;w=CreateTabContainer(n.FormModel,c);t.PushItem(w,c.Elements);t.PushItem(c,h.Elements);n.MainPanels.some(function(t){if(t.dictAttributes.ID==n.CurrPanel.dictAttributes.ID)return t.initialvisibilty=!1,t.IsVisible=!1,t.IsPanelToggle=!1,!0});r&&i>-1?(t.InsertItem(u,f.Elements,i),t.InsertItem(u,n.MainPanels,i)):(t.PushItem(u,f.Elements),t.PushItem(u,n.MainPanels));u.initialvisibilty=!0;u.TableVM=e;n.selectPanelControl(u)}t.UndRedoBulkOp("End")};n.OnAddWizardStepWithGridView=function(i,r){var l,o,w,u,f,c,v,e;if(t.UndRedoBulkOp("Start"),l=[],FindControlListByName(n.SfxMainTable,"WizardSteps",l),l.length>0&&(o=l[0]),o){for(var s=CreateControlID(n.FormModel,"wzsStep","sfwWizardStep",!1),y=o.Elements.filter(function(n){return n.dictAttributes.ID==s}),a=0,b=s;y&&y.length>0;)a++,s=b+a,y=o.Elements.filter(function(n){return n.dictAttributes.ID==s});w=s;u={Name:"sfwWizardStep",prefix:"swc",Value:"",dictAttributes:{},Elements:[]};u.ParentVM=o;u.dictAttributes.runat="server";u.dictAttributes.sfwShowInHeader="True";u.dictAttributes.ID=s;u.dictAttributes.Title=w.replace("wzsStep","New Step ");f={Name:"sfwTable",prefix:"swc",Value:"",dictAttributes:{},Elements:[]};f.ParentVM=u;f.dictAttributes.runat="server";f.dictAttributes.CssClass="Table";for(var h="tblStep1",p=o.Elements.filter(function(n){return n.Elements[0].dictAttributes.ID==h}),a=0,k=h;p&&p.length>0;)a++,h=k+a,p=o.Elements.filter(function(n){return n.Elements[0].dictAttributes.ID==h});f.dictAttributes.ID=h;t.PushItem(f,u.Elements);c={Name:"sfwRow",prefix:"swc",Value:"",dictAttributes:{},Elements:[]};c.ParentVM=f;t.PushItem(c,f.Elements);v={Name:"sfwColumn",prefix:"swc",Value:"",dictAttributes:{},Elements:[]};v.ParentVM=c;e=n.$new();e.formobject=n.FormModel;e.model=undefined;e.dropdata=v;e.IsAddNewGrid=!0;e.IsAddGridWithPanel=!0;e.BindToQueryDialog=t.showDialog(e,"Bind to Query","Form/views/BindToQuery.html",{width:600,height:250});e.onAfterOkClick=function(){n.AddWizardStepToList(u,f,o,r,i)};t.PushItem(v,c.Elements)}};n.AddWizardStepToList=function(i,r,u,f,e){n.MainPanels.some(function(t){if(t.dictAttributes.ID==n.CurrPanel.dictAttributes.ID)return t.initialvisibilty=!1,t.IsVisible=!1,t.IsPanelToggle=!1,!0});f&&e>-1?(t.InsertItem(i,u.Elements,e),t.InsertItem(i,n.MainPanels,e)):(t.PushItem(i,u.Elements),t.PushItem(i,n.MainPanels));i.initialvisibilty=!0;i.TableVM=r;n.selectPanelControl(i);t.UndRedoBulkOp("End")};n.addExtraFieldsDataInToMainModel=function(){if(n.objFormExtraFields&&n.objFormExtraFields.Elements&&n.objFormExtraFields.Elements.length>0){var t=n.FormModel.Elements.indexOf(n.objFormExtraFields);t==-1&&n.FormModel.Elements.push(n.objFormExtraFields)}};n.BeforeSaveToFile=function(){n.addExtraFieldsDataInToMainModel();!n.IsPrototype&&n.FormModel&&n.FormModel.dictAttributes&&n.FormModel.dictAttributes.sfwType!="UserControl"&&n.FormModel.dictAttributes.sfwType!="Lookup"&&(n.dummyLstLoadDetails=LoadDetails(n.FormModel,n.objLoadDetails,!1,t,!1))};n.AfterSaveToFile=function(){};n.ClearSelectFields=function(){lstEntityTreeFieldData=null};n.OpenLoadDetailsDialog=function(){var i=n.$new();n.dummyLstLoadDetails=LoadDetails(n.FormModel,n.objLoadDetails,!0,t,!1);dialog=t.showDialog(i,"Load Details","Form/views/LoadDetails.html",{width:500,height:400});i.onOkClick=function(){dialog.close()}};n.createValidationRuleList=function(n,t,i){var u=[],r;return t?(lstHardErrorsTemp=GetBuisnessRules(n,"","",i,!0),angular.forEach(lstHardErrorsTemp,function(n){n!=undefined&&n!=""&&u.push(n)})):n&&n.lstHardErrorList&&(r=n.lstHardErrorList[0],r&&r.Elements.length>0&&angular.forEach(r.Elements,function(n){n!=undefined&&n.dictAttributes.ID!=""&&u.push(n.dictAttributes.ID)})),u};tt=function(t){var i,r,u;i=t&&t.Name=="sfwGridView"?t:FindParent(t,"sfwGridView");i?n.loadGridEntityTree(i):n.FormModel.IsLookupCriteriaEnabled||(r=FindParent(t,"sfwDialogPanel"),r?n.loadGridEntityTree(r):(u=FindParent(t,"sfwListView"),u?n.loadGridEntityTree(u):n.loadFormEntityTree(t)))};n.loadGridEntityTree=function(t){var k,p,e,i,h,c,l,s,a,v,o,u,y,b,f,r;n.IsGridSeleected=!0;n.IsListViewSelected=!1;n.FormModel.SelectedControl.IsGridChildOfListView=!1;k=!1;p=!1;n.IsGridCollectionEmpty=!1;e=FindParent(t,"sfwListView");t&&(t.Name=="sfwGridView"&&e?(n.FormModel.SelectedControl.IsGridChildOfListView=!0,o=w.GetEntityFieldObjectFromEntityField(n.FormModel.dictAttributes.sfwEntity,e.dictAttributes.sfwEntityField),o&&(r=w.GetEntityFieldObjectFromEntityField(o.Entity,t.dictAttributes.sfwEntityField),r&&(i=r.Entity))):t.Name=="sfwGridView"?t.dictAttributes.sfwParentGrid?(u=FindControlByID(n.SfxMainTable,t.dictAttributes.sfwParentGrid),u&&u.dictAttributes.sfwEntityField&&(h=null,c=w.GetEntityFieldObjectFromEntityField(n.FormModel.dictAttributes.sfwEntity,u.dictAttributes.sfwEntityField),c&&(i=c.ID,h=c.Entity,h&&n.FormModel.SelectedControl&&t.dictAttributes.sfwEntityField?(f=w.GetEntityFieldObjectFromEntityField(h,t.dictAttributes.sfwEntityField),f&&f.DataType&&f.DataType.toLowerCase()=="collection"&&(i=f.Entity,p=!0)):n.FormModel.SelectedControl.Name!="TemplateField"&&(n.IsGridCollectionEmpty=!0)))):i=t.dictAttributes.sfwEntityField:t.Name=="sfwDialogPanel"?(l=t.dictAttributes.ID,l&&(s=GetFieldFromFormObject(n.SfxMainTable,"sfwButton","sfwRelatedDialogPanel",l),s&&s.length>0&&s[0].dictAttributes.sfwRelatedControl?(a=GetFieldFromFormObject(n.SfxMainTable,"sfwGridView","ID",s[0].dictAttributes.sfwRelatedControl),a&&a.length>0&&(i=a[0].dictAttributes.sfwEntityField)):(v=GetFieldFromFormObject(n.SfxMainTable,"sfwScheduler","sfwRelatedDialogPanel",l),v&&v.length>0&&(i=v[0].dictAttributes.sfwEntityField)))):t.Name=="sfwListView"&&(n.IsListViewSelected=!0,i=t.dictAttributes.sfwEntityField),i?(i=="InternalErrors"||i=="ExternalErrors"?i="entError":(r=undefined,t.Name=="sfwGridView"&&e?(n.FormModel.SelectedControl.IsGridChildOfListView=!0,o=w.GetEntityFieldObjectFromEntityField(n.FormModel.dictAttributes.sfwEntity,e.dictAttributes.sfwEntityField),o&&(r=w.GetEntityFieldObjectFromEntityField(o.Entity,i),r&&(i=r.Entity))):n.FormModel.SelectedControl&&n.FormModel.SelectedControl.IsChildOfGrid&&n.FormModel.SelectedControl&&n.FormModel.SelectedControl.Name!="TemplateField"?(u=FindParent(n.FormModel.SelectedControl,"sfwGridView"),u&&u.dictAttributes.sfwParentGrid&&u.dictAttributes.sfwEntityField?(y=FindControlByID(n.FormModel,u.dictAttributes.sfwParentGrid),y&&y.dictAttributes.sfwEntityField&&(b=w.GetEntityFieldObjectFromEntityField(n.FormModel.dictAttributes.sfwEntity,y.dictAttributes.sfwEntityField),b&&(i=b.Entity,FindParent(n.FormModel.SelectedControl,"ItemTemplate")&&(f=w.GetEntityFieldObjectFromEntityField(i,u.dictAttributes.sfwEntityField),f&&(i=f.Entity))))):u&&u.dictAttributes.sfwEntityField&&(r=w.GetEntityFieldObjectFromEntityField(n.FormModel.dictAttributes.sfwEntity,u.dictAttributes.sfwEntityField),r&&(i=r.Entity))):p||(r=w.GetEntityFieldObjectFromEntityField(n.FormModel.dictAttributes.sfwEntity,i),i=r&&t.Name!="sfwGridView"?r.Entity:r&&t.Name=="sfwGridView"&&r.DataType&&r.DataType.toLowerCase()!="object"?r.Entity:"")),n.CheckAndLoadEntityTree(i)):n.FormModel.dictAttributes.sfwType!=="Lookup"&&n.$evalAsync(function(){if(!(t.Name=="sfwGridView"&&e)){for(var i=0;i<n.lstLoadedEntityTrees.length;i++)n.lstLoadedEntityTrees[i].IsVisible=!1;n.entityTreeName="";n.currentEntiyTreeObject=undefined}}))};n.CheckAndLoadEntityTree=function(t){for(var r,u=!1,i=0;i<n.lstLoadedEntityTrees.length;i++)if(n.lstLoadedEntityTrees[i].EntityName!=t||n.lstLoadedEntityTrees[i].IsQuery)n.lstLoadedEntityTrees[i].IsVisible=!1;else{u=!0;n.lstLoadedEntityTrees[i].IsVisible=!0;n.entityTreeName=n.lstLoadedEntityTrees[i].EntityName;n.currentEntiyTreeObject=n.lstLoadedEntityTrees[i];break}u||(r={EntityName:t,IsVisible:!0,selectedobjecttreefield:undefined,lstselectedobjecttreefields:[],IsQuery:!1},n.lstLoadedEntityTrees.push(r),n.entityTreeName=r.EntityName,n.currentEntiyTreeObject=r)};n.PopulateEntityFieldsForOpenButton=function(t,i){var u=[],e,s,f,r,o;if(PopulateControlsForActiveForm(u,n.FormModel,t,i),e=[],s=FindParent(t,"sfwGridView"),(t.dictAttributes.sfwRelatedControl||s)&&u.length>0)for(f=0;f<u.length;f++)r=u[f],o="",o=r.indexOf("~")>-1?r.substring(0,r.indexOf("~")):r,e.push(o);return e};n.loadFormEntityTree=function(){var r,t,i;if(n.FormModel&&n.FormModel.IsLookupCriteriaEnabled==!1&&(n.IsGridSeleected=!1,r=!1,n.lstLoadedEntityTrees)){for(t=0;t<n.lstLoadedEntityTrees.length;t++)n.lstLoadedEntityTrees[t].EntityName!=n.FormModel.dictAttributes.sfwEntity||n.lstLoadedEntityTrees[t].IsQuery?n.lstLoadedEntityTrees[t].IsVisible=!1:(r=!0,n.lstLoadedEntityTrees[t].IsVisible=!0,n.entityTreeName=n.lstLoadedEntityTrees[t].EntityName,n.currentEntiyTreeObject=n.lstLoadedEntityTrees[t]);r||(i={EntityName:n.FormModel.dictAttributes.sfwEntity,IsVisible:!0,selectedobjecttreefield:undefined,lstselectedobjecttreefields:[],IsQuery:!1},n.lstLoadedEntityTrees.push(i),n.entityTreeName=i.EntityName,n.currentEntiyTreeObject=i)}};n.OnCutControlClick=function(t){var i=[];i.push(t);n.CopyToClipBoard(i,"Control",!0)};n.OnCopyControlClick=function(t){var i=[];i.push(t);n.CopyToClipBoard(i,"Control",!1)};n.GetParent=function(n){var t=FindParent(n,"sfwGridView",!0);return t||(t=FindParent(n,"sfwDialogPanel",!0),t||(t=FindParent(n,"sfwListView",!0))),t};n.CanPasteControl=function(t,i,r){var u=!0,f,e,o;if(i&&i.Name=="sfwTable")return!1;if(f=FindParent(r,"sfwGridView"),e=FindParent(t,"sfwGridView"),f&&e&&f.dictAttributes.ID==e.dictAttributes.ID)u=!0;else if(FindParent(t,"sfwTable")&&FindParent(r,"sfwGridView"))return!1;if(o=n.GetParent(t),["sfwScheduler","sfwGridView","sfwListView","sfwChart","sfwCalendar"].indexOf(i.Name)>-1&&FindParent(t,"sfwDialogPanel"))u=!1;else{if(FindParent(t,"sfwGridView")&&FindParent(r,"sfwDialogPanel")||FindParent(t,"sfwListView")&&FindParent(r,"sfwDialogPanel"))return!1;if(["sfwScheduler","sfwDialogPanel","sfwListView","sfwChart","sfwCalendar"].indexOf(i.Name)>-1&&FindParent(t,"sfwGridView"))u=!1;else if((i.Name==="sfwGridView"||i.Name==="sfwDialogPanel"||i.Name==="sfwListView"||i.Name==="sfwChart"||i.Name==="sfwCalendar"||i.Name==="sfwScheduler")&&o)u=vt(r,t,"sfwListView")?!1:!0;else if(i.Name==="sfwGridView"&&!o&&vt(r,t,"sfwListView"))u=!1;else if(vt(r,t,"sfwGridView"))return!1}return u};n.OnPasteControl=function(i){n.ClipboardData&&n.$evalAsync(function(){function r(r){var u=GetBaseModel(r),f,e;n.FormModel.dictAttributes&&n.FormModel.dictAttributes.sfwType=="Lookup"&&n.FormModel.IsLookupCriteriaEnabled&&u&&u.Name=="sfwLabel"&&!u.dictAttributes.sfwIsCaption||n.CanPasteControl(i,u,r)&&(f=FindParent(i,"ItemTemplate"),e=FindParent(r,"ItemTemplate"),f&&e?t.PushItem(u,f.Elements):t.PushItem(u,i.Elements),n.IsCutOper?n.OnDeleteControlClick(r):(r.Name=="sfwLabel"&&r.dictAttributes&&r.dictAttributes.sfwIsCaption&&u.dictAttributes.ID?u.dictAttributes.ID=GetControlIDForCaption(n.FormModel,r.Name,!0):u.dictAttributes.ID&&(u.dictAttributes.ID=GetControlID(n.FormModel,r.Name)),u&&u.Elements.length>0&&n.ChangeControlID(u)),r.Name=="udc"&&(u.UcChild=[],u.UcChild.push(r.UcChild[0])),n.FormModel.dictAttributes&&n.FormModel.dictAttributes.sfwType=="Lookup"&&(n.FormModel.IsLookupCriteriaEnabled&&(u.dictAttributes.sfwEntityField||u.dictAttributes.sfwLinkable||u.dictAttributes.sfwRelatedControl)?(u.dictAttributes.sfwEntityField&&delete u.dictAttributes.sfwEntityField,u.dictAttributes.sfwLinkable&&delete u.dictAttributes.sfwLinkable,u.dictAttributes.sfwRelatedControl&&delete u.dictAttributes.sfwRelatedControl):!n.FormModel.IsLookupCriteriaEnabled&&(u.dictAttributes.sfwDataField||u.dictAttributes.sfwQueryId)&&(u.dictAttributes.sfwDataField&&delete u.dictAttributes.sfwDataField,u.dictAttributes.sfwQueryID&&delete u.dictAttributes.sfwQueryID)),n.IsCutOper&&n.CheckForFilterGrid(r,u),u.ParentVM=i)}t.UndRedoBulkOp("Start");angular.forEach(n.ClipboardData,r);n.IsCutOper&&(n.ClipboardData=[],n.ClipboardDataOpeType="",n.IsCutOper=!1);t.UndRedoBulkOp("End")})};n.ChangeControlID=function(t){angular.forEach(t.Elements,function(t){var i=t;t.Name=="sfwLabel"&&t.dictAttributes&&t.dictAttributes.sfwIsCaption&&i.dictAttributes.ID?i.dictAttributes.ID=GetControlIDForCaption(n.FormModel,t.Name,!0):i.dictAttributes.ID&&(i.dictAttributes.ID=GetControlID(n.FormModel,t.Name));i&&i.Elements&&i.Elements.length>0&&n.ChangeControlID(i)})};n.selectControlOnDoubleClick=function(t,i){n.selectControl(t,i);n.OnSelectLeftFormTab("Properties");n.IsToolsDivCollapsed&&(n.IsToolsDivCollapsed=!n.IsToolsDivCollapsed)};n.selectControl=function(t,i){var r,f,e,u;n.isTemplateFieldSelected=!1;n.IsGridCollectionEmpty=!1;t&&(t.isLoaded||(t.isLoaded=!0),n.FormModel&&(n.FormModel.SelectedControl&&(n.FormModel.SelectedControl.Name=="sfwPanel"||n.FormModel.SelectedControl.Name=="sfwDialogPanel"||n.FormModel.SelectedControl.Name=="sfwListView")&&(n.FormModel.SelectedControl.IsVisible=!1),SetFormSelectedControl(n.FormModel,t,i),t.Name=="sfwTabSheet"&&(t.ParentVM.SelectedTabSheet=t,t.ParentVM.SelectedTabSheet.IsSelected=!0),(t.Name=="sfwPanel"||t.Name=="sfwDialogPanel"||t.Name=="sfwListView")&&(t.IsVisible=!0),t.Name=="sfwGridView"?t.dictAttributes.sfwBoundToQuery&&t.dictAttributes.sfwBoundToQuery.toLowerCase()=="true"?n.setQueryFieldsIfGridisBoundedToQuery(t):(n.loadGridEntityTree(t),n.ObjgridBoundedQuery.IsQuery=!1):t.Name=="sfwDialogPanel"?(n.loadGridEntityTree(t),n.ObjgridBoundedQuery.IsQuery=!1):t.Name=="sfwListView"?(n.loadGridEntityTree(t),n.ObjgridBoundedQuery.IsQuery=!1):(r=FindParent(t,"sfwGridView"),r&&t.Name=="TemplateField"&&(n.isTemplateFieldSelected=!0),r?r.dictAttributes.sfwBoundToQuery&&r.dictAttributes.sfwBoundToQuery.toLowerCase()=="true"?n.setQueryFieldsIfGridisBoundedToQuery(r):(n.FormModel.SelectedControl.IsChildOfGrid=!0,n.loadGridEntityTree(r),n.ObjgridBoundedQuery.IsQuery=!1):(n.ObjgridBoundedQuery.IsQuery=!1,n.FormModel.IsLookupCriteriaEnabled||(f=FindParent(t,"sfwDialogPanel"),f?n.loadGridEntityTree(f):(e=FindParent(t,"sfwListView"),e?n.loadGridEntityTree(e):(u=FindParent(t,"sfwGridView"),u&&u.dictAttributes.sfwParentGrid?n.loadGridEntityTree(u):n.loadFormEntityTree(t)))))),n.setDisplayNoneToTable&&n.setDisplayNoneToTable(),i&&i.stopPropagation&&i.stopPropagation()))};n.onRefreshBoundtoQueryFields=function(){n.FormModel.SelectedControl&&(n.selectControl(n.FormModel.SelectedControl,event),n.ShowRefreshCompletedDialog())};n.setQueryFieldsIfGridisBoundedToQuery=function(t){if(t&&t.dictAttributes.sfwBoundToQuery&&t.dictAttributes.sfwBoundToQuery.toLowerCase()=="true"||ObjGrid){var i=t.dictAttributes.sfwBaseQuery;n.ObjgridBoundedQuery.lstselectedobjecttreefields=[];n.ObjgridBoundedQuery.SortedColumns=[];$.connection.hubForm.server.getEntityQueryColumns(i,"dummy").done(function(t){n.$evalAsync(function(){if(t&&t.length>0){var i=t;sortListBasedOnproperty(i,"","CodeID");n.ObjgridBoundedQuery.lstselectedobjecttreefields=n.getModelForBoundedQueryList(i);n.ObjgridBoundedQuery.SortedColumns=n.ObjgridBoundedQuery.lstselectedobjecttreefields}})});n.IsGridSeleected=!0;i&&(n.ObjgridBoundedQuery.IsQuery=!0);n.entityTreeName=n.FormModel.dictAttributes.sfwEntity}else n.ObjgridBoundedQuery.IsQuery=!1};n.getModelForBoundedQueryList=function(n){return d.getModelListFromQueryFieldlist(n)};n.OnDeleteControlClick=function(i){i&&(t.DeleteItem(i,i.ParentVM.Elements),i.ParentVM&&n.selectControl(i.ParentVM,null))};n.OnCreateCompatibleLabelClickForPanel=function(i){i&&(t.UndRedoBulkOp("Start"),n.CreateCompatibleLabelForControls(i),t.UndRedoBulkOp("End"))};n.CreateCompatibleLabelForControls=function(i){function r(t){n.CreateCompatibleLabelForControls(t)}n.ValidateControl(i)&&CreateCompatibleLabel(i,n.FormModel,u,t);angular.forEach(i.Elements,r)};n.ValidateControl=function(n){if(n&&n.dictAttributes.sfwIsCaption||n&&(n.Name=="sfwGridView"||n.Name=="sfwChart"||n.Name=="sfwPanel"||n.Name=="sfwDialogPanel"||n.Name=="sfwButton"||n.Name=="sfwTabContainer"||n.Name=="sfwTabSheet"||n.Name=="udc"||n.Name=="sfwListViewer"))return!1;n.IsChildOfGrid=!1;var t=FindParent(n,"sfwGridView");if(t&&(n.IsChildOfGrid=!0),n.IsChildOfGrid)return!1;if(!n.dictAttributes||n.dictAttributes.sfwEntityField||n.dictAttributes.sfwDataField){if(hasCaption(n))return!1}else return!1;return!0};n.OnCutCell=function(t){n.CopyToClipBoard(t.Elements,"Cell",!0)};n.OnCopyCell=function(t){n.CopyToClipBoard(t.Elements,"Cell",!1)};n.CopyToClipBoard=function(t,i,r){function u(t){n.ClipboardData.push(t)}n.ClipboardData=[];n.ClipboardDataOpeType=i;n.IsCutOper=r;angular.forEach(t,u)};n.OnPasteCell=function(i){n.ClipboardData&&n.$evalAsync(function(){function r(r){n.IsCutOper&&n.ClearCell(r.ParentVM);var u=GetBaseModel(r);t.PushItem(u,i.Elements);n.IsCutOper||(u.dictAttributes.ID=r.Name=="sfwLabel"&&r.dictAttributes&&r.dictAttributes.sfwIsCaption?GetControlIDForCaption(n.FormModel,r.Name,!0):GetControlID(n.FormModel,r.Name),u&&u.Elements.length>0&&n.ChangeControlID(u));n.IsCutOper&&n.CheckForFilterGrid(r,u);r.Name=="udc"&&(u.UcChild=[],u.UcChild.push(r.UcChild[0]));u.ParentVM=i}t.UndRedoBulkOp("Start");angular.forEach(n.ClipboardData,r);n.IsCutOper&&(n.ClipboardData=[],n.ClipboardDataOpeType="",n.IsCutOper=!1);t.UndRedoBulkOp("End")})};n.CheckForFilterGrid=function(t,i){function r(i){for(var r=0;r<t.Elements.length;r++)i.Name==t.Elements[r].Name&&i.dictAttributes.ID==t.Elements[r].dictAttributes.ID&&n.CheckForFilterGrid(t.Elements[r],i)}t.IsShowDataField&&(i.IsShowDataField=t.IsShowDataField);angular.forEach(i.Elements,r)};n.ClearCell=function(n){while(n.Elements.length>0)t.DeleteItem(n.Elements[0],n.Elements)};n.OnCopyCutPasteControlClick=function(t){n.FormModel&&n.FormModel.SelectedControl&&n.FormModel.dictAttributes.sfwType=="Lookup"&&(n.FormModel.SelectedControl.Name=="sfwTabContainer"||n.FormModel.SelectedControl.Name=="sfwGridView")||n.FormModel&&n.FormModel.SelectedControl&&n.FormModel.SelectedControl.Name=="sfwToolTipButton"||n.FormModel&&n.FormModel.SelectedControl&&n.FormModel.SelectedControl.Name=="sfwPanel"&&n.FormModel.SelectedControl.IsMainPanel||(n.FormModel&&n.FormModel.SelectedControl&&n.FormModel.SelectedControl.Name!="TemplateField"?t=="cut"?n.FormModel.SelectedControl.Name!="sfwColumn"?n.OnCutControlClick(n.FormModel.SelectedControl):(n.FormModel.SelectedControl.Name=="sfwColumn"||n.FormModel.SelectedControl.Name=="sfwButtonGroup")&&n.OnCutCell(n.FormModel.SelectedControl):t=="copy"?n.FormModel.SelectedControl.Name!="sfwColumn"?n.OnCopyControlClick(n.FormModel.SelectedControl):(n.FormModel.SelectedControl.Name=="sfwColumn"||n.FormModel.SelectedControl.Name=="sfwButtonGroup")&&n.OnCopyCell(n.FormModel.SelectedControl):t=="paste"&&n.FormModel.SelectedControl.Name=="sfwColumn"||n.FormModel.SelectedControl.Name=="sfwButtonGroup"?n.ClipboardData&&n.ClipboardDataOpeType=="Control"?n.OnPasteControl(n.FormModel.SelectedControl):n.ClipboardData&&n.ClipboardDataOpeType=="Cell"&&n.OnPasteCell(n.FormModel.SelectedControl):t=="paste"&&FindParent(n.FormModel.SelectedControl,"sfwGridView")&&n.ClipboardData&&n.ClipboardDataOpeType=="Control"&&n.OnPasteControl(n.FormModel.SelectedControl):n.FormModel&&n.FormModel.SelectedControl&&n.FormModel.SelectedControl.Name=="TemplateField"&&t=="paste"&&n.ClipboardData&&n.ClipboardDataOpeType=="Control"&&n.OnPasteControl(n.FormModel.SelectedControl.Elements[0]))};n.OnRowColumnInsertMoveClick=function(i){if(n.FormModel&&n.FormModel.SelectedControl){if(n.FormModel.SelectedControl.Name=="sfwPanel"&&n.FormModel.SelectedControl.IsMainPanel)return;var r=null,u=null;r=n.FormModel.SelectedControl.Name=="sfwColumn"?n.FormModel.SelectedControl:FindParent(n.FormModel.SelectedControl,"sfwColumn");u=r&&r.ParentVM?r.ParentVM.ParentVM:null;u&&r&&n.$evalAsync(function(){var e;if(i=="InsertRowAbove"){var f=u.Elements.indexOf(r.ParentVM),o=InsertRow(r,f,u),s=GetIndexToInsert(!1,f);t.InsertItem(o,u.Elements,s)}else if(i=="InsertRowBelow"){var f=u.Elements.indexOf(r.ParentVM),o=InsertRow(r,f,u),s=GetIndexToInsert(!0,f);t.InsertItem(o,u.Elements,s)}else i=="InsertColumnLeft"?(e=r.ParentVM.Elements.indexOf(r),n.InsertColumn(r,!1,e,u)):i=="InsertColumnRight"?(e=r.ParentVM.Elements.indexOf(r),n.InsertColumn(r,!0,e,u)):i=="MoveRowUp"?n.MoveRowUp(r,u):i=="MoveRowDown"?n.MoveRowDown(r,u):i=="MoveColumnLeft"?n.MoveColumnLeft(r,u):i=="MoveColumnRight"&&n.MoveColumnRight(r,u)})}};n.InsertColumn=function(i,r,u,f){function e(i){for(var e,r,f=0;f<i.Elements.length;f++)if(e=i.Elements[f],i.Elements.indexOf(e)==u){r=e;break}if(r||n.CheckAndAddColumnsToRow(i,u,u),r){var s=i.Elements.indexOf(r),o={Name:"sfwColumn",value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]};o.ParentVM=i;s<i.Elements.length?t.InsertItem(o,i.Elements,s):t.PushItem(o,i.Elements)}}function o(t){n.CheckAndAddColumnsToRow(t,s,u)}if(i)if(r){var s=n.GetNextColIndex(i);t.UndRedoBulkOp("Start");angular.forEach(f.Elements,o);t.UndRedoBulkOp("End")}else t.UndRedoBulkOp("Start"),angular.forEach(f.Elements,e),t.UndRedoBulkOp("End")};n.CheckAndAddColumnsToRow=function(i,r,u){for(var e=0,l=!1,o,s,c,h,f;e<=r;){for(o=undefined,s=0;s<i.Elements.length;s++)if(c=i.Elements[s],i.Elements.indexOf(c)==e){o=c;break}o?e=n.GetNextColIndex(o):(h="swc",f={Name:"sfwColumn",value:"",prefix:h,dictAttributes:{},Elements:[],Children:[]},f.ParentVM=i,t.PushItem(f,i.Elements),l=!0,e++)}l||(h="swc",f={Name:"sfwColumn",value:"",prefix:h,dictAttributes:{},Elements:[],Children:[]},f.ParentVM=i,r<i.Elements.length?t.InsertItem(f,i.Elements,u+1):t.PushItem(f,i.Elements))};n.GetNextColIndex=function(t){var i=t.ParentVM.Elements.indexOf(t),r=n.getColspan(t);return r>0?i=t.ParentVM.Elements.indexOf(t)+r:i++,i};n.getColspan=function(n){return n&&n.dictAttributes.ColumnSpan&&parseInt(n.dictAttributes.ColumnSpan)?n.dictAttributes.ColumnSpan:1};n.InsertCell=function(n,i,r){var u=-1,e,f;r?u=n.Elements.indexOf(i)+1:(u=n.Elements.indexOf(i),u>0&&(u-=u));u>-1&&(e="swc",f={Name:"sfwColumn",value:"",prefix:e,dictAttributes:{},Elements:[],Children:[]},f.ParentVM=n,u<n.Elements.length?t.InsertItem(f,n.Elements,u):t.PushItem(f,n.Elements))};n.deleteCellClick=function(){if(n.FormModel&&n.FormModel.SelectedControl){if(n.FormModel.SelectedControl.Name=="sfwPanel"&&n.FormModel.SelectedControl.IsMainPanel)return;var t=null;t=n.FormModel.SelectedControl.Name=="sfwColumn"?n.FormModel.SelectedControl:FindParent(n.FormModel.SelectedControl,"sfwColumn");n.deleteCell(t)}};n.deleteCell=function(i){i.ParentVM&&i.ParentVM.ParentVM&&i.ParentVM.ParentVM.Name=="sfwTable"&&i.ParentVM.ParentVM.Elements.length==1&&i.ParentVM.Elements.length==1?g.Message("Message","Cannot delete as only one cell present."):(t.DeleteItem(i,i.ParentVM.Elements),n.FormModel&&n.FormModel.SelectedControl&&n.FormModel.SelectedControl.ParentVM&&(n.FormModel.SelectedControl.ParentVM.Elements.length==0&&n.FormModel.SelectedControl.ParentVM.Name=="sfwRow"?(t.DeleteItem(n.FormModel.SelectedControl.ParentVM,n.FormModel.SelectedControl.ParentVM.ParentVM.Elements),n.selectControl(n.FormModel.SelectedControl.ParentVM.ParentVM,null)):n.selectControl(n.FormModel.SelectedControl.ParentVM,null)))};n.OnInsertCellClick=function(t){if(n.FormModel&&n.FormModel.SelectedControl){if(n.FormModel.SelectedControl.Name=="sfwPanel"&&n.FormModel.SelectedControl.IsMainPanel)return;var i=null,r=null;i=n.FormModel.SelectedControl.Name=="sfwColumn"?n.FormModel.SelectedControl:FindParent(n.FormModel.SelectedControl,"sfwColumn");r=i&&i.ParentVM?i.ParentVM.ParentVM:null;r&&i&&n.$evalAsync(function(){t=="InsertCellLeft"?n.InsertCell(i.ParentVM,i,!1):t=="InsertCellRight"&&n.InsertCell(i.ParentVM,i,!0)})}};n.MoveRowUp=function(n,i){if(n){var r=n,u=i.Elements.indexOf(r.ParentVM);u>0&&(t.UndRedoBulkOp("Start"),t.DeleteItem(r.ParentVM,i.Elements),t.InsertItem(r.ParentVM,i.Elements,u-1),t.UndRedoBulkOp("End"))}};n.MoveRowDown=function(n,i){if(n){var r=n,f=i.Elements.length,u=i.Elements.indexOf(r.ParentVM);u<f-1&&(t.UndRedoBulkOp("Start"),t.DeleteItem(r.ParentVM,i.Elements),t.InsertItem(r.ParentVM,i.Elements,u+1),t.UndRedoBulkOp("End"))}};n.MoveColumnLeft=function(i,r){var o=FindParent(n.FormModel.SelectedControl,"sfwGridView"),f,e,u;if(o)f=FindParent(n.FormModel.SelectedControl,"TemplateField"),n.FormModel.SelectedControl.Name=="TemplateField"&&(f=n.FormModel.SelectedControl),f&&(u=f.ParentVM.Elements.indexOf(f),u>0&&(t.UndRedoBulkOp("Start"),e=f.ParentVM.Elements[u],t.DeleteItem(f.ParentVM.Elements[u],f.ParentVM.Elements),t.InsertItem(e,f.ParentVM.Elements,u-1),t.UndRedoBulkOp("End")));else{function s(n){var i=n.Elements[u];i&&(t.DeleteItem(n.Elements[u],n.Elements),t.InsertItem(i,n.Elements,u-1))}i&&(u=i.ParentVM.Elements.indexOf(i),u>0&&(t.UndRedoBulkOp("Start"),angular.forEach(r.Elements,s),t.UndRedoBulkOp("End")))}};n.MoveColumnRight=function(i,r){var s=FindParent(n.FormModel.SelectedControl,"sfwGridView"),u,o,e,f;if(s)u=FindParent(n.FormModel.SelectedControl,"TemplateField"),n.FormModel.SelectedControl.Name=="TemplateField"&&(u=n.FormModel.SelectedControl),u&&(e=u.ParentVM.Elements.length,f=u.ParentVM.Elements.indexOf(u),f<e-1&&(t.UndRedoBulkOp("Start"),o=u.ParentVM.Elements[f],t.DeleteItem(u.ParentVM.Elements[f],u.ParentVM.Elements),t.InsertItem(o,u.ParentVM.Elements,f+1),t.UndRedoBulkOp("End")));else{function h(n){var i=n.Elements[f];i&&(t.DeleteItem(n.Elements[f],n.Elements),t.InsertItem(i,n.Elements,f+1))}i&&(e=GetMaxColCount(i.ParentVM,r),f=i.ParentVM.Elements.indexOf(i),f<e-1&&(t.UndRedoBulkOp("Start"),angular.forEach(r.Elements,h),t.UndRedoBulkOp("End")))}};n.ButtonsDetailsCollection=[];n.LoadButtonDetails=function(){var i=n.currentfile.FileType,r=[];i&&(i=="Lookup"?r=t.LstButtonMethodLookup:i=="Wizard"?r=t.LstButtonMethodWizard:(i=="Maintenance"||i=="UserControl")&&(r=t.LstButtonMethodMaintenance),r.length>0&&angular.forEach(r,function(t){var i={},r=null;r=t.Attribute;i.Method=t.Code;i.Description=t.Description;i.Category=t.Category;n.ButtonsDetailsCollection.push(i)}))};n.LoadButtonDetails();n.FindEntityName=function(t,i,r){var u=i,s,f,o,e;return t.dictAttributes.sfwParentGrid&&t.dictAttributes.sfwEntityField?(s=FindControlByID(n.FormModel,t.dictAttributes.sfwParentGrid),f=w.GetEntityFieldObjectFromEntityField(n.FormModel.dictAttributes.sfwEntity,s.dictAttributes.sfwEntityField),f&&(u=f.Entity,r&&(o=w.GetEntityFieldObjectFromEntityField(f.Entity,t.dictAttributes.sfwEntityField),o&&(u=o.Entity)))):(e=FindControlByID(n.FormModel,t.dictAttributes.sfwRelatedGrid),e&&e.dictAttributes.sfwEntityField&&(u=ft(e.dictAttributes.sfwEntityField,i))),u};n.clearCell=function(n){while(n.Elements.length>0)t.DeleteItem(n.Elements[0],n.Elements)};n.clearPanel=function(){var i,r,u,f,e,o;if(n.FormModel.SelectedControl){if(n.FormModel.dictAttributes.sfwType&&n.FormModel.dictAttributes.sfwType.toLowerCase()=="lookup"&&!n.FormModel.IsLookupCriteriaEnabled&&!n.FormModel.IsPrototypeLookupCriteriaEnabled)return;if(n.FormModel.dictAttributes.sfwType==="Lookup"&&(i=FindParent(n.FormModel.SelectedControl,"sfwColumn",!0),i&&i.Elements&&i.Elements.length>0&&i.Elements[0].Name==="sfwTabContainer"))return;if(r=null,r=n.FormModel.SelectedControl.Name==="sfwPanel"?n.FormModel.SelectedControl.Elements[0]:FindParent(n.FormModel.SelectedControl,"sfwTable",!0),r){for(t.UndRedoBulkOp("Start"),u=0;u<r.Elements.length;u++)if(f=r.Elements[u],f)for(e=0;e<f.Elements.length;e++)n.clearCell(f.Elements[e]);n.FormModel.SelectedControl.Name!=="sfwPanel"&&n.FormModel.SelectedControl.Name!=="sfwTable"&&n.FormModel.SelectedControl.Name!=="sfwColumn"&&(o=FindParent(n.FormModel.SelectedControl,"sfwColumn",!0),o&&n.selectControl(o));t.UndRedoBulkOp("End")}}};n.deleteRow=function(){var i,r;n.FormModel.SelectedControl&&(i=FindParent(n.FormModel.SelectedControl,"sfwRow",!0),i&&i.ParentVM&&i.ParentVM.Elements&&(i.ParentVM.Elements.length>1?(r=i.ParentVM.Elements.indexOf(i),t.UndRedoBulkOp("Start"),t.DeleteItem(i,i.ParentVM.Elements),r===i.ParentVM.Elements.length&&r--,r>-1&&i.ParentVM.Elements.length>0&&i.ParentVM.Elements[r].Elements.length>0&&n.selectControl(i.ParentVM.Elements[r].Elements[0]),t.UndRedoBulkOp("End")):g.Message("Message","Atleast one row should be present")))};n.deleteColumn=function(){var i,u,f,r,e;if(n.FormModel.SelectedControl){if(i=FindParent(n.FormModel.SelectedControl,"sfwColumn",!0),i&&i.Elements&&i.Elements.length>0&&i.Elements[0].Name==="sfwTabContainer")return;i&&i.ParentVM&&i.ParentVM.ParentVM&&(u=i.ParentVM.ParentVM,f=GetMaxColCount(i.ParentVM,u),f>1?(r=i.ParentVM.Elements.indexOf(i),e=function(n){n.Elements.length>r&&(t.DeleteItem(n.Elements[r],n.Elements),n.Elements&&n.Elements.length==0&&n.ParentVM&&t.DeleteItem(n,n.ParentVM.Elements))},t.UndRedoBulkOp("Start"),angular.forEach(u.Elements,e),r===i.ParentVM.Elements.length&&r--,r>-1&&i.ParentVM.Elements.length>r&&n.selectControl(i.ParentVM.Elements[r]),t.UndRedoBulkOp("End")):g.Message("Message","Atleast one column should be present"))}};n.showControlbasedOnType=function(t){var r=!1,i=undefined,u;if(n.FormModel)if(n.FormModel.IsLookupCriteriaEnabled)if(n.FormModel.IsLookupCriteriaEnabled!=!0||n.MainQuery||n.SelectedQuery&&(!n.SelectedQuery||n.SelectedQuery.dictAttributes.ID)){for(u=0;u<n.lstLoadedEntityColumnsTree.length;u++)if(n.lstLoadedEntityColumnsTree[u].IsVisible==!0){i=n.selectedfield;break}}else i=n.selectedobjecttreefield;else for(u=0;u<n.lstLoadedEntityTrees.length;u++)if(n.lstLoadedEntityTrees[u].IsVisible==!0){i=n.lstLoadedEntityTrees[u].selectedobjecttreefield;break}return n.FormModel&&n.FormModel.dictAttributes&&n.FormModel.dictAttributes.sfwType&&i&&(t=="sfwLabel"&&["Lookup","Tooltip"].indexOf(n.FormModel.dictAttributes.sfwType)===-1&&!n.FormModel.IsLookupCriteriaEnabled&&["Collection","Object","List","CDOCollection"].indexOf(i.Type)==-1&&i.DataType&&i.DataType.toLowerCase()!="datetime"?r=!0:t!="sfwLabel"||n.FormModel.dictAttributes.sfwType!=="Tooltip"||n.FormModel.IsLookupCriteriaEnabled||["Collection","Object","List","CDOCollection"].indexOf(i.Type)!=-1?(t=="sfwTextBox"||t=="sfwRadioButtonList"||t=="sfwDropDownList"||t=="sfwMultiSelectDropDownList"||t=="sfwCheckBox")&&n.FormModel.dictAttributes.sfwType!="Tooltip"&&["Collection","Object","CDOCollection","List",].indexOf(i.Type)==-1&&i.DataType&&i.DataType.toLowerCase()!="datetime"?r=!0:t=="sfwCascadingDropDownList"&&n.FormModel.dictAttributes.sfwType!="Tooltip"&&!n.IsGridSeleected&&["Collection","Object","CDOCollection","List",].indexOf(i.Type)==-1&&i.DataType&&i.DataType.toLowerCase()!="datetime"?r=!0:t=="sfwRadioButton"&&["Tooltip","Lookup"].indexOf(n.FormModel.dictAttributes.sfwType)==-1&&["Collection","Object","CDOCollection","List",].indexOf(i.Type)==-1&&i.DataType&&i.DataType.toLowerCase()!="datetime"?r=!0:t=="sfwCheckBoxList"&&!n.IsGridSeleected&&n.FormModel.dictAttributes.sfwType!="Tooltip"&&["CDOCollection"].indexOf(i.Type)>-1?r=!0:(t=="Grid"||t=="SfxChart")&&!n.IsGridSeleected&&n.FormModel.dictAttributes.sfwType!="Lookup"&&["Collection","List"].indexOf(i.Type)>-1?r=!0:t=="UserControl"&&!n.IsGridSeleected&&["Lookup","UserControl","Tooltip"].indexOf(n.FormModel.dictAttributes.sfwType)==-1&&["Object"].indexOf(i.Type)>-1?r=!0:t=="sfwRange"&&!n.IsGridSeleected&&["Lookup"].indexOf(n.FormModel.dictAttributes.sfwType)>-1&&i.DataType&&["DateTime","Int","Decimal","Double"].indexOf(i.DataType)>-1?r=!0:t=="sfwDateTimePicker"&&["Tooltip"].indexOf(n.FormModel.dictAttributes.sfwType)==-1&&i.DataType&&["DateTime","datetime"].indexOf(i.DataType)>-1?r=!0:t=="sfwCalendar"&&!n.IsGridSeleected&&["Maintenance","Wizard"].indexOf(n.FormModel.dictAttributes.sfwType)>-1&&["Collection","List"].indexOf(i.Type)>-1?r=!0:t=="sfwListView"&&["Maintenance","Wizard"].indexOf(n.FormModel.dictAttributes.sfwType)>-1&&!n.IsGridSeleected&&["Collection","List"].indexOf(i.Type)>-1?r=!0:t=="sfwJSONData"&&["Maintenance","Wizard","UserControl"].indexOf(n.FormModel.dictAttributes.sfwType)>-1&&!n.IsGridSeleected&&["string","String"].indexOf(i.DataType)>-1?r=!0:t=="sfwScheduler"&&!n.IsGridSeleected&&["Maintenance","Wizard"].indexOf(n.FormModel.dictAttributes.sfwType)>-1&&["Collection","List"].indexOf(i.Type)>-1&&(r=!0):r=!0),r};n.scrollBySelectedField=function(n,t,i){e(function(){var r=$(n);if(r&&r.hasScrollBar())return r.scrollTo(r.find(t),i,null),!1})};n.OpenCentreLeftDialog=function(){var i=n.$new();i.formmodel=n.FormModel;n.CenterLeft?(i.CenterLeft={},angular.copy(n.CenterLeft,i.CenterLeft)):i.CenterLeft={Name:"centerleft",Value:"",dictAttributes:{},Elements:[],Children:[]};dialog=t.showDialog(i,"Centre Left","Form/views/CentreLeft.html",{width:900,height:600});i.onOkClick=function(){var u=n.FormModel.Elements.filter(function(n){return n.Name==="centerleft"}),r;if(u&&u.length>0){if(t.UndRedoBulkOp("Start"),n.CenterLeft&&t.EditPropertyValue(n.CenterLeft.Elements,n.CenterLeft,"Elements",[]),i.CenterLeft&&i.CenterLeft.Elements)for(r=0;r<i.CenterLeft.Elements.length>0;r++)t.PushItem(i.CenterLeft.Elements[r],n.CenterLeft.Elements);t.UndRedoBulkOp("End")}else t.UndRedoBulkOp("Start"),t.PushItem(i.CenterLeft,n.FormModel.Elements),t.EditPropertyValue(n.CenterLeft,n,"CenterLeft",i.CenterLeft),t.UndRedoBulkOp("End");i.onCancelClick()};i.onCancelClick=function(){dialog.close()}};n.showFormTreeMap=function(){n.viewTreeMap=!n.viewTreeMap;n.viewTreeMap?e(function(){$("#"+n.FormModel.dictAttributes.ID).find(".xml-control-tree").slideDown()}):e(function(){$("#"+n.FormModel.dictAttributes.ID).find(".xml-control-tree").slideUp()});n.TreeObject={};n.TreeObject.btnLabel="Expand All";n.TreeObject.formTableModel=n.formTableModel};n.searchControlID=function(i){t.$broadcast("searchById",{model:n.TreeObject.formTableModel,input:n.TreeObject.ID});i&&i.keyCode==13};n.expandOrCollapseAll=function(){var t=!0;n.TreeObject.btnLabel=="Expand All"?(t=!0,n.TreeObject.btnLabel="Collapse All"):n.TreeObject.btnLabel=="Collapse All"&&(t=!1,n.TreeObject.btnLabel="Expand All");yt(n.formTableModel.Elements,t)};yt=function(n,t){angular.forEach(n,function(n){n.isExpand=t;n.Elements.length&&yt(n.Elements,t)})}}]);app.directive("panelaccordiantemplate",["$compile","$rootScope","$EntityIntellisenseFactory","$timeout","$SgMessagesService",function(n,t,i,r,u){return{restrict:"E",scope:{model:"=",formodel:"=",objparent:"=",parentaccordianid:"=",initialvisibilty:"=",panelindex:"@",lstloadedentitytrees:"=",lstloadedentitycolumnstree:"=",lstdisplayentities:"=",entitytreename:"=",buttonsCollection:"="},replace:!0,templateUrl:"Form/views/Controls/PanelControlView.html",link:function(i){var f=getCurrentFileScope();i.ShowPanelButtons=function(){return f&&f.CurrPanel&&f.CurrPanel.Name!="sfwDialogPanel"&&f.CurrPanel.dictAttributes.ID&&f.CurrPanel.dictAttributes.ID==i.model.dictAttributes.ID?!0:!1};i.setInitialVisibility=function(){i.initialvisibilty=!i.initialvisibilty};i.objSelectionClassAttributes={};i.ChangeSelection=function(n,t){f&&(t=="LookupAdvCriteria"&&(f.IsLookupAdvCriteriaSelected=n=="panel-adv-criteria-icon active"?!0:!1),t=="LookupAdvSort"&&(f.IsLookupAdvSortSelected=n=="panel-adv-sort-icon active"?!0:!1),t=="LookupQuery"&&(f.IsLookupQuerySelected=n=="panel-query-icon active"?!0:!1))};Object.defineProperty(i.objSelectionClassAttributes,"LookupAdvCriteria",{get:function(){return f&&f.IsLookupAdvCriteriaSelected?"panel-adv-criteria-icon active":"panel-adv-criteria-icon"},set:function(n){i.ChangeSelection(n,"LookupAdvCriteria")}});Object.defineProperty(i.objSelectionClassAttributes,"LookupAdvSort",{get:function(){return f&&f.IsLookupAdvSortSelected?"panel-adv-sort-icon active":"panel-adv-sort-icon"},set:function(n){i.ChangeSelection(n,"LookupAdvSort")}});Object.defineProperty(i.objSelectionClassAttributes,"LookupQuery",{get:function(){return f&&f.IsLookupQuerySelected?"panel-query-icon active":"panel-query-icon"},set:function(n){i.ChangeSelection(n,"LookupQuery")}});i.SetParentVM=function(n,t){t.ParentVM=n};i.objparent&&(i.model.ParentVM=i.objparent);i.getValue=function(n){return getDisplayValue(n)};i.getColspan=function(n){return n&&n.dictAttributes.ColumnSpan!=undefined&&n.dictAttributes.ColumnSpan!=""?n.dictAttributes.ColumnSpan:1};i.loadFormEntityTree=function(){var r,n,t;if(i.FormModel.IsLookupCriteriaEnabled==!1){for(f.IsGridSeleected=!1,r=!1,n=0;n<f.lstLoadedEntityTrees.length;n++)f.lstLoadedEntityTrees[n].EntityName!=i.formodel.dictAttributes.sfwEntity||f.lstLoadedEntityTrees[n].IsQuery?f.lstLoadedEntityTrees[n].IsVisible=!1:(r=!0,f.lstLoadedEntityTrees[n].IsVisible=!0,f.entityTreeName=f.lstLoadedEntityTrees[n].EntityName,f.currentEntiyTreeObject=f.lstLoadedEntityTrees[n]);r||(t={EntityName:i.formodel.dictAttributes.sfwEntity,IsVisible:!0,selectedobjecttreefield:undefined,lstselectedobjecttreefields:[],IsQuery:!1},f.lstLoadedEntityTrees.push(t),f.entityTreeName=t.EntityName,f.currentEntiyTreeObject=t)}};i.selectControl=function(n,t){SetFormSelectedControl(i.formodel,n,t);i.loadFormEntityTree(n)};i.OnAdvCriteriaClick=function(n){i.CheckAndUpdateCriteria("AdvCriteria",n)};i.OnAdvSortClick=function(n){i.CheckAndUpdateCriteria("AdvSort",n)};i.OnQueryClick=function(n){i.CheckAndUpdateCriteria("Query",n)};i.ChangeSelectionProperty=function(n){f&&n=="Query"&&(f.IsLookupQuerySelected?t.EditPropertyValue("panel-query-icon",i.objSelectionClassAttributes,"LookupQuery","panel-query-icon active"):t.EditPropertyValue("panel-query-icon active",i.objSelectionClassAttributes,"LookupQuery","panel-query-icon"));f&&n=="AdvSort"&&(f.IsLookupAdvSortSelected?t.EditPropertyValue("panel-adv-sort-icon",i.objSelectionClassAttributes,"LookupAdvSort","panel-adv-sort-icon active"):t.EditPropertyValue("panel-adv-sort-icon active",i.objSelectionClassAttributes,"LookupAdvSort","panel-adv-sort-icon"));f&&n=="AdvCriteria"&&(f.IsLookupAdvCriteriaSelected?t.EditPropertyValue("panel-adv-criteria-icon",i.objSelectionClassAttributes,"LookupAdvCriteria","panel-adv-criteria-icon active"):t.EditPropertyValue("panel-adv-criteria-icon active",i.objSelectionClassAttributes,"LookupAdvCriteria","panel-adv-criteria-icon"))};i.CheckAndUpdateCriteria=function(n,r){function ft(t){var i=t.dictAttributes.ID;n=="AdvCriteria"&&i.contains("tshAdvCriteria")?(g=t,w=!0,f.IsLookupAdvCriteriaSelected=!1):n=="AdvSort"&&i.contains("tshAdvSort")?(g=t,w=!0,f.IsLookupAdvSortSelected=!1):n=="Query"&&i.contains("tshSql")&&(g=t,w=!0,f.IsLookupQuerySelected=!1)}var o,h,b,c,s,v,y,k,p,d,u,g,w,it,e;if(t.UndRedoBulkOp("Start"),o=null,h=f.CurrPanel.Elements[0],h){var rt=h.Elements.length,tt=h.Elements[0],ut=tt.Elements.length;rt==1&&ut==1&&(b=tt.Elements[0],b.Elements.length>0&&b.Elements[0].Name=="sfwTabContainer"&&(o=b.Elements[0]))}if(!o){var l=f.CurrPanel.dictAttributes.ID,nt="",a="";for(startsWith(l,"pnl",0)?(nt=l.substring(3),a=l.substring(3)):(nt=l,a=l),c="swc",s={Name:"sfwTable",value:"",prefix:c,dictAttributes:{},Elements:[],Children:[]},s.ParentVM=f.CurrPanel,s.dictAttributes.ID=nt,o={Name:"sfwTabContainer",value:"",prefix:c,dictAttributes:{},Elements:[],Children:[]},o.ParentVM=s,a=CreateControlID(i.formodel,a,"sfwTabContainer",!1),o.dictAttributes.ID=a,v={Name:"Tabs",value:"",prefix:"",dictAttributes:{},Elements:[],Children:[]},v.ParentVM=o,e={Name:"sfwTabSheet",value:"",prefix:c,dictAttributes:{},Elements:[],Children:[]},e.ParentVM=v,y="",k=h.dictAttributes.ID,y=startsWith(k,"tbl",0)?k.substring(3):k,y=CreateControlID(i.formodel,y,"sfwTabSheet",!1),e.dictAttributes.ID=y,e.dictAttributes.HeaderText="Criteria",e.Elements.push(h),v.Elements.push(e),o.Elements.push(v),p={Name:"sfwRow",value:"",prefix:c,dictAttributes:{},Elements:[],Children:[]},p.ParentVM=s,d={Name:"sfwColumn",value:"",prefix:c,dictAttributes:{},Elements:[],Children:[]},d.ParentVM=p,d.Elements.push(o),p.Elements.push(d),s.Elements.push(p);f.CurrPanel.Elements.length>0;)t.DeleteItem(f.CurrPanel.Elements[0],f.CurrPanel.Elements);t.PushItem(s,f.CurrPanel.Elements)}if(o&&(u=o.Elements[0],u))if(u.LookupCriPanelVM=f.CurrPanel,w=!1,angular.forEach(u.Elements,ft),w){if(t.DeleteItem(g,u.Elements),u.Elements.length==1&&u.Elements[0].Elements[0].Name=="sfwTable"){for(it=u.Elements[0].Elements[0];f.CurrPanel.Elements.length>0;)t.DeleteItem(f.CurrPanel.Elements[0],f.CurrPanel.Elements);t.PushItem(it,f.CurrPanel.Elements)}}else n=="AdvCriteria"?(e=i.AddAdvCriteriaPanel(u),f.IsLookupAdvCriteriaSelected=!0):n=="AdvSort"?(e=i.AddAdvSortPanel(u),f.IsLookupAdvSortSelected=!0):n=="Query"&&(e=i.AddQueryPanel(u),f.IsLookupQuerySelected=!0),u&&(t.PushItem(e,u.Elements),e.isLoaded||(e.isLoaded=!0),u.SelectedTabSheet=e,u.SelectedTabSheet.IsSelected=!0,SetFormSelectedControl(i.formodel,e,undefined));i.ChangeSelectionProperty(n);t.UndRedoBulkOp("End");r&&r.stopPropagation()};i.AddAdvCriteriaPanel=function(n){var r="swc",f={Name:"sfwTabSheet",value:"",prefix:r,dictAttributes:{},Elements:[],Children:[]},e,u,i,t;return f.ParentVM=n,f.dictAttributes.ID="tshAdvCriteria",f.dictAttributes.HeaderText="Adv. Criteria",e={Name:"sfwTable",value:"",prefix:r,dictAttributes:{},Elements:[],Children:[]},e.ParentVM=f,e.dictAttributes.ID="tblAdvCriteria",u={Name:"sfwRow",value:"",prefix:r,dictAttributes:{},Elements:[],Children:[]},u.ParentVM=e,i={Name:"sfwColumn",value:"",prefix:r,dictAttributes:{},Elements:[],Children:[]},i.ParentVM=u,t={Name:"sfwButton",value:"",prefix:r,dictAttributes:{},Elements:[],Children:[]},t.ParentVM=i,t.dictAttributes.ID="btnAdvSearch",t.dictAttributes.sfwMethodName="btnSearch_Click",t.dictAttributes.sfwOperateOn="tblAdvCriteria",t.dictAttributes.Text="Adv Search",i.Elements.push(t),t={Name:"sfwButton",value:"",prefix:r,dictAttributes:{},Elements:[],Children:[]},t.ParentVM=i,t.dictAttributes.ID="btnAdvReset",t.dictAttributes.sfwMethodName="btnReset_Click",t.dictAttributes.sfwOperateOn="tblAdvCriteria",t.dictAttributes.Text="Adv Reset",i.Elements.push(t),u.Elements.push(i),i={Name:"sfwColumn",value:"",prefix:r,dictAttributes:{},Elements:[],Children:[]},i.ParentVM=u,t={Name:"sfwButton",value:"",prefix:r,dictAttributes:{},Elements:[],Children:[]},t.ParentVM=i,t.dictAttributes.ID="btnAdvStoreSearch",t.dictAttributes.sfwMethodName="btnStoreUserDefaults_Click",t.dictAttributes.sfwOperateOn="tblAdvCriteria",t.dictAttributes.Text="Adv Store Search",i.Elements.push(t),u.Elements.push(i),i={Name:"sfwColumn",value:"",prefix:r,dictAttributes:{},Elements:[],Children:[]},i.ParentVM=u,u.Elements.push(i),e.Elements.push(u),f.Elements.push(e),f};i.AddAdvSortPanel=function(n){var u="swc",e={Name:"sfwTabSheet",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},f,i,r,t;return e.ParentVM=n,e.dictAttributes.ID="tshAdvSort",e.dictAttributes.HeaderText="Adv. Sort",f={Name:"sfwTable",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},f.ParentVM=e,f.dictAttributes.ID="tblAdvSort",i={Name:"sfwRow",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},i.ParentVM=f,r={Name:"sfwColumn",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},r.ParentVM=i,t={Name:"sfwAdvSort",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},t.ParentVM=r,t.dictAttributes.ID="AdvSort",t.dictAttributes.sfwRelatedControl="dgrResult",r.Elements.push(t),i.Elements.push(r),f.Elements.push(i),i={Name:"sfwRow",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},i.ParentVM=f,r={Name:"sfwColumn",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},r.ParentVM=i,t={Name:"sfwButton",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},t.ParentVM=r,t.dictAttributes.ID="btnApplySort",t.dictAttributes.sfwMethodName="btnApplySort_Click",t.dictAttributes.sfwOperateOn="tblAdvSort",t.dictAttributes.sfwRelatedControl="dgrResult",t.dictAttributes.Text="Apply Sort",r.Elements.push(t),i.Elements.push(r),f.Elements.push(i),e.Elements.push(f),e};i.AddQueryPanel=function(n){var u="swc",t={Name:"sfwTabSheet",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},i,f,e,r;return t.ParentVM=n,t.dictAttributes.ID="tshSql",t.dictAttributes.HeaderText="Query",i={Name:"sfwTable",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},i.ParentVM=t,i.dictAttributes.ID="tblSql",f={Name:"sfwRow",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},f.ParentVM=i,e={Name:"sfwColumn",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},e.ParentVM=f,r={Name:"sfwTextBox",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},r.ParentVM=e,r.dictAttributes.ID="txbSql",r.dictAttributes.TextMode="MultiLine",r.dictAttributes.Rows="5",e.Elements.push(r),f.Elements.push(e),i.Elements.push(f),t.Elements.push(i),t};i.DeleteWizardStepClick=function(){f.CurrPanel&&(f.CurrPanel.Name=="HeaderTemplate"?u.Message("Message","HeaderTemplate can not be deleted."):u.Message("Delete","The selected wizard "+f.CurrPanel.dictAttributes.Title+" will be deleted.\nAre you sure you want to delete it?",!0,function(n){if(n){t.UndRedoBulkOp("Start");var r=f.CurrPanel.ParentVM,i=f.MainPanels.indexOf(f.CurrPanel);t.DeleteItem(f.CurrPanel,f.MainPanels,"selectPanelControl");r&&t.DeleteItem(f.CurrPanel,r.Elements);i<f.MainPanels.length?f.selectPanelControl(f.MainPanels[i]):f.MainPanels.length>0&&f.selectPanelControl(f.MainPanels[i-1]);t.UndRedoBulkOp("End")}}))};i.scrollPanel=function(){r(function(){var n=$("#"+i.formodel.dictAttributes.ID).find(".form-area-editable");if(n&&n.hasScrollBar())return n.scrollTo(n.find(".active.form-panel-wrapper"),{offsetTop:0,offsetLeft:0},null),!1})};i.MoveUpWizardClick=function(){var n,r,e;f.CurrPanel&&(n=f.CurrPanel.ParentVM,n&&(r=n.Elements.indexOf(f.CurrPanel),r>-1&&(r==0?u.Message("Message","Wizard step cannot be arranged before header template."):(t.UndRedoBulkOp("Start"),t.DeleteItem(f.CurrPanel,n.Elements),t.InsertItem(f.CurrPanel,n.Elements,r-1),e=f.MainPanels.indexOf(f.CurrPanel),t.DeleteItem(f.CurrPanel,f.MainPanels),t.InsertItem(f.CurrPanel,f.MainPanels,e-1),t.UndRedoBulkOp("End"),i.scrollPanel()))))};i.canMoveUpWizardDisable=function(){var n=!1,t,i;return f.CurrPanel?(t=f.CurrPanel.ParentVM,t&&(i=t.Elements.indexOf(f.CurrPanel),i==0&&(n=!0))):n=!0,n};i.MoveDownWizardClick=function(){var n,r,u;f.CurrPanel&&(n=f.CurrPanel.ParentVM,n&&(r=n.Elements.indexOf(f.CurrPanel),r>-1&&f.MainPanels.length>r+1&&(t.UndRedoBulkOp("Start"),t.DeleteItem(f.CurrPanel,n.Elements),t.InsertItem(f.CurrPanel,n.Elements,r+1),u=f.MainPanels.indexOf(f.CurrPanel),t.DeleteItem(f.CurrPanel,f.MainPanels),t.InsertItem(f.CurrPanel,f.MainPanels,u+1),t.UndRedoBulkOp("End"),i.scrollPanel())))};i.canMoveDownWizardDisable=function(){var t=!1,n,i;return f.CurrPanel?(n=f.CurrPanel.ParentVM,n&&(i=n.Elements.indexOf(f.CurrPanel),n.Elements.length==i+1&&(t=!0))):t=!0,t};i.addPanel=function(n,t){event.stopPropagation();switch(n){case"wizard":f.OnAddWizardStepClick(t,!0);break;case"maintenance":case"tooltip":f.OnAddPanelClick(t,!0)}};i.DeleteMainPanelClick=function(){f.CurrPanel&&u.Message("Delete","The selected panel "+f.CurrPanel.dictAttributes.ID+" will be deleted.\nAre you sure you want to delete it?",!0,function(n){if(n){t.UndRedoBulkOp("Start");var r=FindParent(f.CurrPanel,"sfwRow"),i=f.MainPanels.indexOf(f.CurrPanel);t.DeleteItem(f.CurrPanel,f.MainPanels,"selectPanelControl");i<f.MainPanels.length?f.selectPanelControl(f.MainPanels[i]):f.MainPanels.length>0&&f.selectPanelControl(f.MainPanels[i-1]);r&&t.DeleteItem(r,f.SfxMainTable.Elements);t.UndRedoBulkOp("End")}})};i.MoveUpMainPanelClick=function(){var n,r,u;f.CurrPanel&&(n=FindParent(f.CurrPanel,"sfwRow"),n&&(r=f.SfxMainTable.Elements.indexOf(n),r>-1&&r>0&&(t.UndRedoBulkOp("Start"),t.DeleteItem(n,f.SfxMainTable.Elements),t.InsertItem(n,f.SfxMainTable.Elements,r-1),u=f.MainPanels.indexOf(f.CurrPanel),t.DeleteItem(f.CurrPanel,f.MainPanels),t.InsertItem(f.CurrPanel,f.MainPanels,u-1),t.UndRedoBulkOp("End"),i.scrollPanel())))};i.MoveDownMainPanelClick=function(){var n,r,u;f.CurrPanel&&(n=FindParent(f.CurrPanel,"sfwRow"),n&&(r=f.SfxMainTable.Elements.indexOf(n),r>-1&&f.MainPanels.length>r+1&&(t.UndRedoBulkOp("Start"),t.DeleteItem(n,f.SfxMainTable.Elements),t.InsertItem(n,f.SfxMainTable.Elements,r+1),u=f.MainPanels.indexOf(f.CurrPanel),t.DeleteItem(f.CurrPanel,f.MainPanels),t.InsertItem(f.CurrPanel,f.MainPanels,u+1),t.UndRedoBulkOp("End"),i.scrollPanel())))};i.canMoveUpDisable=function(){var n=!1,t,i;return f.CurrPanel?(t=FindParent(f.CurrPanel,"sfwRow"),t&&(i=f.SfxMainTable.Elements.indexOf(t),i==0&&(n=!0))):n=!0,n};i.canMoveDownDisable=function(){var n=!1,t,i;return f.CurrPanel?(t=FindParent(f.CurrPanel,"sfwRow"),t&&(i=f.SfxMainTable.Elements.indexOf(t),f.SfxMainTable.Elements.length==i+1&&(n=!0))):n=!0,n};i.getAddpanelTrigger=function(t,r,u){var o,e,s;r=r?r.trim().toLowerCase():"";o=u!=undefined?parseInt(u)+1:0;e="Add Panel";i.formodel.dictAttributes.sfwType=="Wizard"&&(e="Add Wizard Step");i.formodel.dictAttributes.sfwType!="Lookup"&&(elhover=n('<button class="addPanelDivTrigger" ng-click="addPanel(\''+r+"',"+o+')">'+e+"<\/button>")(i),elhover.css({left:t.clientX-50}),f&&!f.IsToolsDivCollapsed&&(s=$("div[id='"+f.currentfile.FileName+"']").find(".toolbox-wrapper"),elhover.css({left:t.clientX-20-s.width()})),t.currentTarget.appendChild(elhover[0]))};i.deleteAddpanelTrigger=function(){$(".addPanelDivTrigger").remove()};i.panelMenuOption=[["Create Compatible Caption",function(){var n=getCurrentFileScope();i.model&&n&&n.OnCreateCompatibleLabelClickForPanel&&n.OnCreateCompatibleLabelClickForPanel(i.model)}]]}}}]);var setParentControlName=function(n){for(var t=0;t<n.Elements.length>0;t++)(n.Elements[t].Name=="sfwPanel"||n.Elements[t].Name=="sfwDialogPanel"||n.Elements[t].Name=="sfwListView")&&(n.Elements[t].ParentControlName="udc"),n.Elements[t].Elements.length>0&&setParentControlName(n.Elements[t])};app.directive("formcontroldraggable",[function(){return{restrict:"A",scope:{dragdata:"=",dragfromleft:"="},link:function(n,t){function r(t){dragDropData=null;dragDropDataObject=null;dragfromleft=undefined;t.dataTransfer.effectAllowed="move";dragDropData=n.dragdata;draggingDataFromLeft=n.dragfromleft;dragDropDataObject=null;t.dataTransfer.setData("Text","")}if(n.dragdata){var i=t[0];i.draggable=!0;i.addEventListener("dragstart",r,!1)}}}}]);app.directive("formcontroldroppable",["$rootScope","ngDialog","$compile","$EntityIntellisenseFactory","$timeout","$GetEntityFieldObjectService","$ValidationService","$SgMessagesService",function(n,t,i,r,u,f,e,o){return{restrict:"A",scope:{dropdata:"=",formodel:"=",lstdisplayentities:"=",entitytreename:"="},link:function(t,u){function y(n){return b(dragDropData,t.dropdata)&&(n&&n.preventDefault&&n.preventDefault(),n.dataTransfer.dropEffect="move"),!1}function p(i){var g=i.dataTransfer.getData("Text"),w,ut,et,lt,nt,u,c,s,b,f,v,y,tt,at,h,it,d,st,e;if(g&&(i&&i.preventDefault(),g=""),w=!1,i.stopPropagation&&i.stopPropagation(),ut="",g==""&&lstEntityTreeFieldData!=null){i.preventDefault();var l=lstEntityTreeFieldData,ft=l[0],ht=l[1],ct=l[2],u=l[3],yt=l[4],pt=l[5];ut=l[6];dragDropData=ft;t.formodel&&(et=r.getEntityIntellisense(),lt=GetMainQueryFromFormObject(t.formodel,et),!lt&&u&&(dragDropData=u.Value));dragDropDataObject=u;nt=ft;ht!=""&&(nt=ht+"."+ft);pt=="Column"?w=!0:(w=t.isValidField(nt),w=!0);lstEntityTreeFieldData=null}else(g==null||g=="")&&(w=!0),lstEntityTreeFieldData=null,i&&i.preventDefault&&i.preventDefault();if(u=dragDropData,c=u,u&&typeof u=="object"&&u.Name&&(c=u.Name),w){if(t.dropdata&&["sfwHyperLink","sfwCascadingDropDownList","sfwCheckBox","sfwDropDownList","sfwMultiSelectDropDownList","sfwImage","sfwLabel","sfwRadioButton","sfwRadioButtonList","sfwTextBox","sfwDateTimePicker","sfwToolTipButton","sfwJSONData","sfwButton","sfwButtonGroup"].indexOf(c)<=-1&&t.dropdata.Name=="TemplateField")o.Message("Message","Cannot add the control "+c+" inside grid");else if(t.dropdata.Name=="sfwButtonGroup"&&FindParent(t.dropdata,"sfwGridView")&&["sfwHyperLink","sfwCascadingDropDownList","sfwCheckBox","sfwDropDownList","sfwMultiSelectDropDownList","sfwImage","sfwLabel","sfwRadioButton","sfwRadioButtonList","sfwTextBox","sfwDateTimePicker","sfwToolTipButton","sfwJSONData","sfwButton","sfwButtonGroup"].indexOf(c)<=-1)o.Message("Message","Cannot add the control "+c+" inside button group present in a grid");else if(dragDropDataObject){if(ct!=undefined)if(t.formodel&&t.formodel.dictAttributes.sfwType=="Lookup"&&t.formodel.IsLookupCriteriaEnabled&&t.dropdata&&t.dropdata.Elements.length>0&&t.dropdata.Elements[0].Name=="sfwTabContainer")o.Message("Message","Can not add a control outside the criteria tab container");else if(t.formodel&&t.formodel.dictAttributes.sfwType=="Lookup"&&t.formodel.IsPrototypeLookupCriteriaEnabled&&t.dropdata&&t.dropdata.Elements.length>0&&t.dropdata.Elements[0].Name=="sfwTabContainer")o.Message("Message","Can not add a control outside the criteria tab container");else if(t.CanDropControl()){if(s=ct,b="",yt=="true"?o.Message("Message","Can't Drop Collection field."):s=="Object"||s=="List"||s=="Collection"||s=="CDOCollection"?(o.Message("Message","You can't drop collection/object."),dragDropData=null,s=null):b=t.formodel&&t.formodel.dictAttributes.sfwType=="Tooltip"?"sfwLabel":s=="bool"?"sfwCheckBox":dragDropDataObject.Value&&dragDropDataObject.Value.endsWith("_value")?"sfwDropDownList":dragDropDataObject.Value&&dragDropDataObject.Value.endsWith("_description")||dragDropDataObject.Type=="Expression"?"sfwLabel":"sfwTextBox",b!=undefined&&b!=""&&(f=CreateControl(t.formodel,t.dropdata,b)),f){for(v="",y="",y=dragDropDataObject.Type==="Expression"?dragDropDataObject.ID:dragDropDataObject.Value,tt=!1,h=0;h<y.length;h++)h==0?v=y[h].toUpperCase():y[h]=="_"?tt=!0:tt?(v=v+y[h].toUpperCase(),tt=!1):v=v+y[h];if(f.dictAttributes.ID=CreateControlID(t.formodel,v,b,!1),t.formodel.dictAttributes.sfwType=="Lookup"&&IsCriteriaField(t.dropdata)?(f.dictAttributes.sfwDataField=dragDropData,f.dictAttributes.sfwQueryID=ut):f.dictAttributes.sfwEntityField=nt,f.Name=="sfwTextBox"||f.Name=="sfwLabel")t.formodel.dictAttributes.sfwType=="Lookup"&&(f.dictAttributes.sfwDataType=s.toLowerCase()=="datetime"||s.toLowerCase()=="date"?"DateTime":s.toLowerCase()=="decimal"||s.toLowerCase().indexOf("int")>-1?"Numeric":"String"),f.Name=="sfwLabel"&&(dragDropDataObject.Value.toLowerCase()=="created_date"||dragDropDataObject.Value.toLowerCase()=="modified_date")?f.dictAttributes.sfwDataFormat="{0:G}":s.toLowerCase()=="datetime"||s.toLowerCase()=="date"?f.dictAttributes.sfwDataFormat="{0:d}":s.toLowerCase()=="decimal"&&(dragDropDataObject.Value.indexOf("_amt")>-1||dragDropDataObject.Value.indexOf("_amount")>-1)?f.dictAttributes.sfwDataFormat="{0:C}":dragDropDataObject.Value.contains("ssn")?f.dictAttributes.sfwDataFormat="{0:000-##-####}":(dragDropDataObject.Value.contains("phone")||dragDropDataObject.Value.contains("fax"))&&(f.dictAttributes.sfwDataFormat="{0:(###)###-####}");else if(f.Name=="sfwDropDownList"&&endsWith(dragDropDataObject.Value,"_value")){var wt=getDisplayedEntity(t.lstdisplayentities),bt=wt.strID,et=r.getEntityIntellisense(),ot=GetCodeIDByValue(bt,dragDropDataObject.Value,et);ot||(ot="0");f.dictAttributes.sfwLoadType="CodeGroup";f.placeHolder=ot}}for(at=0,h=0;h<t.dropdata.Elements.length;h++)it=!1,n.lstWebControls&&n.lstWebControls.length>0&&(d=n.lstWebControls.filter(function(n){return n.ControlName==t.dropdata.Elements[h].Name}),d=JSON.parse(JSON.stringify(d)),d&&d.length>0&&(it=CanAddControlToDropList(d[0],t.formodel,t.dropdata.Elements[h],!0),it&&at++));if(t.formodel&&t.formodel.dictAttributes&&t.formodel.dictAttributes.sfwType=="Tooltip"&&(dragDropDataObject.Type=="Object"||["DateTime","datetime"].indexOf(dragDropDataObject.DataType)>-1)||t.formodel&&t.formodel.dictAttributes&&t.formodel.dictAttributes.sfwType=="Lookup"&&["Object","Collection","CDOCollection","List"].indexOf(dragDropDataObject.Type)>-1||FindParent(t.dropdata,"sfwDialogPanel")&&["Object","Collection","CDOCollection","List"].indexOf(dragDropDataObject.Type)>-1)return it=!1,o.Message("Message","drop is not allowed."),!0;f&&t.$apply(function(){var i=t.dropdata;t.dropdata.Name=="TemplateField"&&(i=t.dropdata.Elements.filter(function(n){return n.Name=="ItemTemplate"})[0]);n.PushItem(f,i.Elements);SetFormSelectedControl(t.formodel,f)})}}else if(typeof dragDropData=="string")st=["sfwCascadingDropDownList","sfwTextBox","sfwSwitchCheckBox","sfwRadioButtonList","sfwRadioButton","sfwMultiSelectDropDownList","sfwDropDownList","sfwCheckBoxList","sfwCheckBox","sfwDateTimePicker"],e=FindParent(t.dropdata,"sfwGridView"),u!=undefined&&u!=null&&u!=""&&(t.formodel&&t.formodel.dictAttributes.sfwType=="Lookup"&&t.formodel.IsLookupCriteriaEnabled&&t.dropdata&&t.dropdata.Elements.length>0&&t.dropdata.Elements[0].Name=="sfwTabContainer"?o.Message("Message","Can not add a control outside the criteria tab container"):t.formodel&&t.formodel.dictAttributes.sfwType=="Lookup"&&t.formodel.IsPrototypeLookupCriteriaEnabled&&t.dropdata&&t.dropdata.Elements.length>0&&t.dropdata.Elements[0].Name=="sfwTabContainer"?o.Message("Message","Can not add a control outside the criteria tab container"):t.formodel.dictAttributes.sfwType.toLowerCase()=="lookup"&&st.indexOf(dragDropData)>-1&&e?o.Message("Message","Can not add control inside the Grid."):e&&e.dictAttributes.sfwBoundToQuery&&e.dictAttributes.sfwBoundToQuery.toLowerCase()=="true"&&st.indexOf(dragDropData)>-1?o.Message("Message","Can not add control inside the Grid."):e&&["sfwHyperLink","sfwCascadingDropDownList","sfwCheckBox","sfwDropDownList","sfwMultiSelectDropDownList","sfwImage","sfwLabel","sfwRadioButton","sfwRadioButtonList","sfwTextBox","sfwDateTimePicker","sfwToolTipButton","sfwJSONData","sfwButton","sfwButtonGroup"].indexOf(c)<=-1?o.Message("Message","Can not add a control "+c+" inside grid"):(e&&t.dropdata.Name!="sfwLabel"&&t.dropdata.Name!="sfwButton"&&t.dropdata.Name!="sfwLinkButton"&&t.dropdata.Name!="sfwImageButton"&&t.dropdata.Name!=="sfwButtonGroup"&&(n.EditPropertyValue(e.dictAttributes.AllowEditing,e.dictAttributes,"AllowEditing","True"),n.EditPropertyValue(e.dictAttributes.sfwTwoWayBinding,e.dictAttributes,"sfwTwoWayBinding","True"),n.EditPropertyValue(e.dictAttributes.sfwCommonFilterBox,e.dictAttributes,"sfwCommonFilterBox","False"),n.EditPropertyValue(e.dictAttributes.sfwFilterOnKeyPress,e.dictAttributes,"sfwFilterOnKeyPress","False")),k(u,t.dropdata,i,t.formodel)));else if(u){for(var p={},rt=t.dropdata.ParentVM,vt=!1;rt;){if(rt==u){vt=!0;break}rt=rt.ParentVM}vt?toastr.error("Same item cannot be dropped as child."):t.CanDropControlFromOneCellToAnother()&&(angular.copy(u,p),n.UndRedoBulkOp("Start"),t.$apply(function(){var r,i,f,e;p.isSelected=!0;t.dropdata.Name==="TemplateField"?FindParent(dragDropData,"sfwGridView")&&(r=t.dropdata.Elements.filter(function(n){return n.Name=="ItemTemplate"}),r&&r.length>0&&(n.PushItem(p,r[0].Elements),p.ParentVM=r[0]),u&&u.ParentVM&&n.DeleteItem(u,u.ParentVM.Elements)):dragDropData.Name==="sfwScheduler"&&FindParent(t.dropdata,"sfwDialogPanel")||dragDropData.Name==="sfwTable"?o.Message("Message","drop is not allowed."):dragDropData.Name==="sfwGridView"&&a(dragDropData,t.dropdata,"sfwListView")?o.Message("Message","drop is not allowed."):a(dragDropData,t.dropdata,"sfwDialogPanel")?o.Message("Message","drop is not allowed."):dragDropData.Name==="sfwTabSheet"&&FindParent(t.dropdata,"sfwTabContainer")&&t.dropdata.Name==="sfwTabSheet"?dragDropData.ParentVM.Name==="Tabs"&&(i=dragDropData.ParentVM.Elements.indexOf(dragDropData),f=t.dropdata.ParentVM.Elements.indexOf(t.dropdata),i>-1&&f>-1&&(n.UndRedoBulkOp("Start"),e=dragDropData.ParentVM.Elements[i],i<f?(n.DeleteItem(dragDropData.ParentVM.Elements[i],dragDropData.ParentVM.Elements),n.InsertItem(e,dragDropData.ParentVM.Elements,f)):(n.DeleteItem(dragDropData.ParentVM.Elements[i],dragDropData.ParentVM.Elements),n.InsertItem(e,dragDropData.ParentVM.Elements,f)),n.UndRedoBulkOp("End"))):t.$evalAsync(function(){n.PushItem(p,t.dropdata.Elements);p.ParentVM=t.dropdata;SetFormSelectedControl(t.formodel,p,null);u&&u.ParentVM&&n.DeleteItem(u,u.ParentVM.Elements)})}),n.UndRedoBulkOp("End"))}dragDropData=null;dragDropDataObject=null}}function w(){}function b(n,i){if(FindParent(n,"sfwGridView")&&i.Name==="sfwColumn")return!1;if(FindParent(n,"sfwGridView")||i.Name!=="TemplateField"){if(FindParent(n,"sfwGridView")!==FindParent(i,"sfwGridView"))return!1;if(t.formodel.dictAttributes.sfwType.toLowerCase()=="lookup"&&"sfwButton"!==n&&!isGridPresentInsidePanel(i)){var r=FindParent(i,"sfwPanel");if(r&&i.Name=="sfwColumn"&&r.dictAttributes.ID=="pnlResult")return!1}}else return!1;return!0}function a(n,i,r){var e=!1,u=FindParent(t.dropdata,r),f=FindParent(dragDropData,r);return f||u?f&&u&&f.dictAttributes&&u.dictAttributes?f.dictAttributes.ID!=u.dictAttributes.ID&&(e=!0):f&&u||(e=!0):e=!1,e}function k(i,u,f,e){var c,l,a,h;if(i)if(c=i,e.dictAttributes.sfwType==="Report")l="",draggingDataFromLeft&&(c="sfwTextBox",l=i),objControl=v(c,undefined,u,e),objControl&&l&&(t.$evalAsync(function(){objControl.dictAttributes.sfwObjectField=l}),objControl.dictAttributes.ID=l);else if(c=="sfwButton")h=t.$new(!0),h.item=u,h.formodel=t.formodel,a=FindParent(u,"sfwListView"),h.ParentModel=a,a&&(h.ParentModel=a),h.CreateButtonDialog=n.showDialog(h,"Button Details","Form/views/CreateButtonWizard/CreateButtonControl.html",{width:660,height:550});else if(c=="sfwListView"){var y=CreateControlID(t.formodel,"RepeaterViewPanel","sfwListView"),s=t.$new();s.ValidateRepeaterProp=function(){var n=!1,i;return s.ErrorMessageForDisplay="",s.objRepeaterControl.dictAttributes.ID?s.objRepeaterControl.dictAttributes.ID&&!isValidIdentifier(s.objRepeaterControl.dictAttributes.ID,!1,!1)?(n=!0,s.ErrorMessageForDisplay="Error : Invalid ID."):s.objRepeaterControl.dictAttributes.ID&&(i=[],CheckforDuplicateID(t.formodel,s.objRepeaterControl.dictAttributes.ID,i),i.length>0&&(n=!0,s.ErrorMessageForDisplay="Error : Duplicate ID.")):(n=!0,s.ErrorMessageForDisplay="Error : Please Enter ID."),s.objRepeaterControl.selectedobjecttreefield?s.objRepeaterControl.selectedobjecttreefield&&s.objRepeaterControl.selectedobjecttreefield.DataType!="Collection"&&s.objRepeaterControl.selectedobjecttreefield.DataType!="CDOCollection"&&s.objRepeaterControl.selectedobjecttreefield.DataType!="List"&&(s.ErrorMessageForDisplay="Error : Please Select a valid collection.",n=!0):(n=!0,s.ErrorMessageForDisplay="Error : Please Select a valid collection."),n};s.onRepeaterControlOkClick=function(){var e,h,o,c,l,a,u,f,v,i,t;s.objRepeaterControl&&(s.objRepeaterControl.dictAttributes.sfwSelection="Many",s.objRepeaterControl.dictAttributes.sfwCaption="List View",s.objRepeaterControl.dictAttributes.AllowPaging="True",s.objRepeaterControl.dictAttributes.PageSize="1",e=s.objRepeaterControl.selectedobjecttreefield,e&&(h=getDisplayedEntity(s.objRepeaterControl.LstDisplayedEntities),o=h.strDisplayName,fieldName=e.ID,o!=""&&(fieldName=o+"."+e.ID),c=fieldName,s.objRepeaterControl.dictAttributes.sfwEntityField=c,l=e.Entity,a=r.getEntityIntellisense(),s.objRepeaterControl.dictAttributes.sfwDataKeyNames=GetTableKeyFields(l,a)),u="swc",f={Name:"sfwTable",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},f.ParentVM=s.objRepeaterControl,v=CreateControlID(s.formodel,"NewPage","sfwTable"),f.dictAttributes.ID=v,i={Name:"sfwRow",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},i.ParentVM=f,t={Name:"sfwColumn",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},t.ParentVM=i,i.Elements.push(t),t={Name:"sfwColumn",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},t.ParentVM=i,i.Elements.push(t),t={Name:"sfwColumn",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},t.ParentVM=i,i.Elements.push(t),t={Name:"sfwColumn",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},t.ParentVM=i,i.Elements.push(t),f.Elements.push(i),s.objRepeaterControl.Elements.push(f),s.objRepeaterControl.initialvisibilty=!0,s.objRepeaterControl.isLoaded=!0,n.PushItem(s.objRepeaterControl,s.dropdata.Elements));s.onRepeaterControlCancelClick()};s.onRepeaterControlCancelClick=function(){s.RepeaterControldialog.close()};s.objRepeaterControl={Name:"sfwListView",value:"",prefix:"swc",dictAttributes:{ID:y},Elements:[],Children:[]};s.ParentEntityName=e.dictAttributes.sfwEntity;s.objRepeaterControl.selectedobjecttreefield;s.objRepeaterControl.lstselectedobjecttreefields=[];s.dropdata=t.dropdata;s.formodel=t.formodel;s.RepeaterControldialog=n.showDialog(s,"Repeater Control","Form/views/RepeaterControlTemplate.html",{width:500,height:600})}else c=="sfwGridView"?FindParent(u,"sfwDialogPanel")?o.Message("Message","Cannot drop a grid inside dialog panel."):(h=t.$new(),h.formobject=e,h.model=undefined,h.dropdata=t.dropdata,h.IsAddNewGrid=!0,h.IsAddFromToolBox=!0,c=="sfwGridView"&&FindParent(u,"sfwListView")&&(h.formobject.SelectedControl.IsGridChildOfListView=!0,u.IsGridChildOfListView=!0),h.BindToQueryDialog=n.showDialog(h,"Bind to Query","Form/views/BindToQuery.html",{width:600,height:250})):v(c,undefined,u,e)}function v(i,r,u,o){var s,h;return r||(r=CreateControl(o,u,i)),r!=null&&r.Name!="udc"&&t.$apply(function(){function h(n){if(!f){var i=n.dictAttributes.sfwQueryRef;n.Name!="query"||t.IsSubQuery(i)||(f=n)}}var i,s,f,e;(r.Name=="sfwDialogPanel"||r.Name=="sfwPanel")&&(r.initialvisibilty=!0,r.isLoaded=!0);r.Name!="udc"&&(u.Name=="TemplateField"?(i=u.Elements.filter(function(n){return n.Name=="ItemTemplate"}),i&&i.length>0&&(n.PushItem(r,i[0].Elements),r.ParentVM=i[0])):n.PushItem(r,u.Elements));SetFormSelectedControl(o,r);o&&o.dictAttributes&&o.dictAttributes.sfwType=="Lookup"&&r.Name!="sfwLabel"&&r.Name!="sfwLiteral"&&r.Name!="RequiredFieldValidator"&&r.Name!="CompareValidator"&&r.Name!="hr"&&r.Name!="br"&&r.Name!="sfwUserDefaults"&&r.Name!="CompareValidator"&&(i=o.Elements.filter(function(n){return n.Name=="initialload"}),i&&i.length>0&&(s=i[0],angular.forEach(s.Elements,h),f&&(r.dictAttributes.sfwQueryID=f.dictAttributes.ID)));e=getCurrentFileScope();e&&e.selectControl&&e.selectControl(r,event)}),r!=undefined&&r.Name=="udc"&&(s=t.$new(),s.dropdata=t.dropdata,s.formodel=t.formodel,s.objSetUCProp={StrId:r.dictAttributes.ID,StrName:"",StrEntityField:"",StrResource:""},s.objSetUCProp.IsAddedFromObjectTree=!1,s.onUserControlOkClick=function(){if(r.dictAttributes.ID=s.objSetUCProp.StrId,r.dictAttributes.Name=s.objSetUCProp.StrName,r.dictAttributes.sfwEntityField=t.formodel.dictAttributes.sfwEntity!=undefined&&t.formodel.dictAttributes.sfwEntity!=""&&s.objSetUCProp.StrEntityField!=undefined&&s.objSetUCProp.StrEntityField!=""?s.objSetUCProp.StrEntityField.match("^"+t.formodel.dictAttributes.sfwEntity)?t.formodel.dictAttributes.sfwEntity+"."+s.objSetUCProp.StrEntityField:s.objSetUCProp.StrEntityField:s.objSetUCProp.StrEntityField,r.dictAttributes.sfwResource=s.objSetUCProp.StrResource,r.dictAttributes.Name!=undefined&&r.dictAttributes.Name!=""){var i=[],f={FileName:r.dictAttributes.Name,ID:r.dictAttributes.ID};i.push(f);$.connection.hubForm.server.getUserControlModel(i,"").done(function(n){var t=getCurrentFileScope();t.receiveUcMainTable(n)})}n.PushItem(r,u.Elements);SetFormSelectedControl(t.formodel,r);s.onUserControlCancelClick()},s.onUserControlCancelClick=function(){var n=getCurrentFileScope();n&&n.validationErrorList&&e.removeObjInToArray(n.validationErrorList,s.objSetUCProp);h&&h.close()},s.ValidateUserProp=function(){var n=!1,i,r;return s.ErrorMessageForDisplay="",s.objSetUCProp.StrId==undefined||s.objSetUCProp.StrId==""?(s.ErrorMessageForDisplay="Error: Enter the ID.",n=!0):(i=[],CheckforDuplicateID(t.formodel,s.objSetUCProp.StrId,i),i.length>0?(s.ErrorMessageForDisplay="Error: Duplicate ID.",n=!0):isValidIdentifier(s.objSetUCProp.StrId,!1,!1)||(s.ErrorMessageForDisplay="Error: Invalid ID.",n=!0)),s.objSetUCProp.StrName&&s.objSetUCProp.StrName!=""?s.objSetUCProp.StrResource&&s.objSetUCProp.StrResource!=""||(s.ErrorMessageForDisplay="Please Enter Resource.",n=!0):(s.ErrorMessageForDisplay="Please Enter Active Form.",n=!0),(s.ErrorMessageForDisplay==undefined||s.ErrorMessageForDisplay=="")&&s.objSetUCProp.StrEntityField!=undefined&&s.objSetUCProp.StrEntityField!=""&&(r=f.GetEntityFieldObjectFromEntityField(s.formodel.dictAttributes.sfwEntity,s.objSetUCProp.StrEntityField),r&&r.Type=="Object"||(s.ErrorMessageForDisplay="Entity Field should be Object.",n=!0)),s.objSetUCProp.errors&&e.isEmptyObj(s.objSetUCProp.errors)&&(n=!0),n},h=n.showDialog(s,"User Control","Form/views/SetUserControlProperties.html"),s.receiveUcMainTable=function(n,i){for(var u,f,r=0;r<t.formodel.Elements.length;r++)if(t.formodel.Elements[r].Name=="sfwTable"){f=t.formodel.Elements[r];break}u=FindControlByID(f,i);u&&(u.UcChild=n)}),r}var c=u[0],s,l,h;c.addEventListener("dragover",y,!1);c.addEventListener("drop",p,!1);c.addEventListener("dragleave",w,!1);s=$(u);t.openControlList=function(){h&&h.remove();h=i('<div id="controlmenudropdown" class="dropdown-content-common" onclick="stopPropogation(event)" addcontroltemplate item="dropdata" formodel="formodel"><\/div>')(t);h.css({left:t.rect.right-200,top:t.rect.top+8,bottom:t.rect.bottom});l.append(h)};$(u).hover(function(){t.dropdata&&!FindParent(t.dropdata,"sfwGridView")&&t.dropdata.Name!="sfwTabSheet"&&($("[add-control-hover-trigger]").remove(),l=i('<i class="fa fa-plus-circle plusicon" add-control-hover-trigger ng-click="openControlList()" aria-hidden="true" style="z-index:999"><\/i>')(t),t.rect=this.getBoundingClientRect(),s.css({position:"relative"}),s.append(l))},function(){s.find("[add-control-hover-trigger]").remove();s.css({position:""})});t.getCellEntityName=function(n){var i="",f=FindParent(n,"sfwGridView"),r,u;return f?i=getEntityBasedOnControl(f):(r=FindParent(n,"sfwDialogPanel"),r?i=getEntityBasedOnControl(r):(u=FindParent(n,"sfwListView"),i=u?getEntityBasedOnControl(u):t.formodel.dictAttributes.sfwEntity)),i};t.GetParent=function(n){var t=FindParent(n,"sfwGridView",!0);return t||(t=FindParent(n,"sfwDialogPanel",!0),t||(t=FindParent(n,"sfwListView",!0))),t};t.GetEntityNameFromObject=function(n){var r,u=t.formodel.Elements.filter(function(n){return n.Name=="sfwTable"}),i,e;return u&&u.length>0&&(i=GetEntityFieldNameFromControl(u[0],n),i&&(i=="InternalErrors"||i=="ExternalErrors"?r="entError":(e=f.GetEntityFieldObjectFromEntityField(t.formodel.dictAttributes.sfwEntity,i),r=e?e.Entity:""))),r};t.CanDropControlFromOneCellToAnother=function(){var i=t.GetParent(t.dropdata),n=t.GetParent(t.formodel.SelectedControl);return(t.formodel.SelectedControl&&(t.formodel.SelectedControl.Name=="sfwScheduler"||t.formodel.SelectedControl.Name=="sfwCalendar"||t.formodel.SelectedControl.Name=="sfwChart")&&(n=t.formodel.SelectedControl),i!=n)?!1:!0};t.CanDropControl=function(){var e=!0,n=getDisplayedEntity(t.lstdisplayentities),i,u,o,s,r,h;if(n){if((i=t.GetParent(t.dropdata),u=t.GetParent(t.formodel.SelectedControl),i&&!u||!i&&u)||i&&u&&(o=t.GetEntityNameFromObject(i),s=t.GetEntityNameFromObject(u),!o||!s||o!=s))return!1;if(r=t.formodel.dictAttributes.sfwEntity,i&&(r=t.GetEntityNameFromObject(i)),n.strDisplayName&&n.strDisplayName.contains("."))if(h=f.GetEntityFieldObjectFromEntityField(r,n.strDisplayName),h){if(n.strID!==h.Entity)return!1}else return!1;else if(n.strParentID||n.strID===r)n.strID===r&&dragDropDataObject&&dragDropDataObject.DataType&&dragDropDataObject.DataType.indexOf(["Collection","List","Object","CDOCollection"])>-1?e=!1:n.strParentID&&n.strParentID!==r&&(e=!1);else return!1}return e};t.isValidField=function(n){var l=getDisplayedEntity(t.lstdisplayentities),h=n.split("."),u=!1,a=r.getEntityIntellisense(),v=t.getCellEntityName(t.dropdata),i=t.entitytreename,c="",f,e,o,s;if(i==v){for(f=0;f<h.length;f++)u=!1,e=[],i!=""&&(o=a.filter(function(n){return n.ID==i}),o.length>0&&(e=o[0].Attributes),e.length>0?(s=e.filter(function(n){return n.ID==h[f]}),s.length>0?(c=i,i=s[0].Entity,u=!0):i=""):i="");u&&c!=l.strID&&(u=!1)}return u};t.objRepeaterControl;t.IsSubQuery=function(n){function f(n){t||n.ID==u&&n.QueryType.toLowerCase()=="subselectquery"&&(t=!0)}var t=!1,u;if(n!=""&&n!=undefined){var e=n.substring(0,n.indexOf(".")),o=r.getEntityIntellisense(),i=o.filter(function(n){return n.ID==e});i&&i.length>0&&(u=n.substring(n.indexOf(".")+1),angular.forEach(i[0].Queries,f))}return t};t.receiveUcMainTable=function(n,i){for(var u,f,r=0;r<t.formodel.Elements.length;r++)if(t.formodel.Elements[r].Name=="sfwTable"){f=t.formodel.Elements[r];break}u=FindControlByID(f,i);u&&(u.UcChild=n)}}}}]);app.directive("commonpropertiesdirective",["$compile","$rootScope","ngDialog","$filter","$EntityIntellisenseFactory","$NavigateToFileService","hubcontext","$ValidationService","CONSTANTS","$ValidateBaseModelStructure","$Entityintellisenseservice","$GetEntityFieldObjectService","$SgMessagesService","$GetGridEntity",function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){return{restrict:"E",replace:!0,scope:{model:"=",parent:"=",formobject:"=",currentpanel:"=",isformlink:"=",lstloadedentitytrees:"=",lstloadedentitycolumnstree:"=",entityTreeName:"=",objgridboundedquery:"="},link:function(n,i){function rt(t){t&&(nt&&(n.Init(),nt=!1),n.setEntityName(),n.InitByControl())}var it=n.$watch("entityTreeName",function(){n.entityName=n.entityTreeName;n.setEntityName()}),d,y,g,p,w,b,k,nt,tt;n.InitByControl=function(){var r,f,e,o,h,i,c,t;if(n.ResetAdvanceProperties(),n.Title="Object Method",n.formobject&&n.formobject.SelectedControl&&n.formobject.SelectedControl.dictAttributes.sfwExecuteMethodType&&(n.formobject.SelectedControl.dictAttributes.sfwExecuteMethodType=="ObjectMethod"?n.Title="Object Method":n.formobject.SelectedControl.dictAttributes.sfwExecuteMethodType=="XmlMethod"?n.Title="Xml Method":n.formobject.SelectedControl.dictAttributes.sfwExecuteMethodType=="Rule"&&(n.Title="Rule")),n.model&&n.model.Name=="udc"&&(n.model.dictAttributes.Visible||(n.model.dictAttributes.Visible="True")),n.lstHardErrorData=undefined,n.$evalAsync(function(){var r,t,i;n.IsSearchCriteriaSelected=!1;n.IsLookup?n.IsSearchCriteriaSelected=IsCriteriaField(n.model):(n.isFilterCriteria=!1,r=FindParent(n.model,"sfwPanel"),r&&(t=[],FindControlListByName(r,"sfwButton",t),i=t.filter(function(n){return n.dictAttributes.sfwMethodName==="btnGridSearch_Click"}),i.some(function(t){return!t.dictAttributes.sfwNavigationParameter||t.dictAttributes.sfwNavigationParameter&&t.dictAttributes.sfwNavigationParameter.contains(n.model.dictAttributes.ID)})?n.isFilterCriteria=!0:(t=getDescendents(n.formobject,"sfwButton"),i=t.filter(function(n){return n.sfwMethodName==="btnGridSearch_Click"}),i.some(function(t){return t.dictAttributes.sfwNavigationParameter&&t.dictAttributes.sfwNavigationParameter.contains(n.model.dictAttributes.ID)})&&(n.isFilterCriteria=!0))));n.formobject&&n.formobject.dictAttributes&&n.formobject.dictAttributes.ID.startsWith("wfp")&&(n.IsSearchCriteriaSelected=!1)}),n.model.IsChildOfGrid=!1,i=FindParent(n.model,"sfwGridView"),i&&(n.objGridView=i,n.model.IsChildOfGrid=!0,n.setEntityName()),n.RelatedControls=[],n.RelatedControls.push(""),n.lstRelatedGrid=[],n.lstMethodType=[],n.lstRelatedGrid.push(""),n.lstRelatedDialog=[],n.lstServerMethod=[],n.lstBooleanValues=[],n.lstExecuteAfterSuccessButton=[],n.lstCascadingDropDwonParent=[],n.lstCascadingDropDwonParent.push(""),n.lstMethodType.push("ObjectMethod"),n.lstMethodType.push("XmlMethod"),n.lstMethodType.push("Rule"),n.LoadWebControlProperties(),n.isformlink!=undefined&&n.isformlink||n.LoadControlToValidate(),n.findCascadingParentControl(),n.currentpanel&&n.currentpanel.Elements.length>0&&(n.CurrentTable=n.currentpanel.Elements[0]),n.isformlink!=undefined&&n.isformlink||n.LoadControlToCompare(),n.LoadRelatedControlTextbox(),n.model&&(n.RelatedControls=n.model.Name=="sfwImageButton"?PopulateAssociatedControlsForRetriveButton(n.model):PopulateAssociatedControls(n.model),n.model.IsChildOfGrid?(r=FindParent(n.model,"sfwTable"),r&&(FindControlListByName(r,"sfwButton",n.lstRelatedGrid),n.lstRelatedGrid.length>0&&(f=[],angular.copy(n.lstRelatedGrid,f),n.lstRelatedGrid=[],f.filter(function(t){t.dictAttributes&&t.dictAttributes.ID&&n.lstRelatedGrid.push(t.dictAttributes.ID)}))),n.lstRelatedGrid.splice(0,0,"")):n.model.dictAttributes.sfwMethodName!=undefined&&n.model.dictAttributes.sfwMethodName!=""&&n.model.dictAttributes.sfwMethodName=="btnResetFilterGrid_Click"?PopulateRelatedGrid(n.formobject,n.lstRelatedGrid,!0):PopulateRelatedGrid(n.formobject,n.lstRelatedGrid,!1)),n.InitOnDblClick(),n.PopulateSelection(),n.model&&(n.model.Name=="sfwMultiSelectDropDownList"||n.model.Name=="sfwChart")&&n.PopulateBooleanValues(),n.model&&n.model.Name=="sfwWizardStep"&&n.PopulateRelatedButton(),n.model&&(n.model.Name=="sfwButton"||n.model.Name=="sfwLinkButton"||n.model.Name=="sfwImageButton")&&(n.MessageIDText="Message ID:",n.LoadButtonMethodDescription(),n.PopulateOnClientClick(),n.PopulateSecurityLevel(),n.PopulateExecuteAfterSuccessButton(),n.model.dictAttributes.sfwMethodName=="btnNew_Click"&&n.PoulateRelatedControlForNew(),(n.model.dictAttributes.sfwMethodName=="btnOpenPopupDialog_Click"||n.model.dictAttributes.sfwMethodName=="btnNewPopupDialog_Click"||n.model.dictAttributes.sfwMethodName=="btnFinishPopupDialog_Click"||n.model.dictAttributes.sfwMethodName=="btnClosePopupDialog_Click")&&(n.lstRelatedDialog=PopulateRelatedDialogList(n.MainTable,n.model)),e="srvCommon",n.formobject&&n.formobject.dictAttributes.sfwRemoteObject&&(e=n.formobject.dictAttributes.sfwRemoteObject),o=GetServerMethodObject(e,n.formobject.RemoteObjectCollection),h=GetObjectMethods(u.getEntityIntellisense(),n.formobject.dictAttributes.sfwEntity),n.lstServerMethod=PopulateServerMethod(h,n.model,o),n.model.ObjectMethodText="Server Method :",(n.model.dictAttributes.sfwMethodName=="btnCopyRecord_Click"||n.model.dictAttributes.sfwMethodName=="btnExecuteBusinessMethodSelectRows_Click"||n.model.dictAttributes.sfwMethodName=="btnValidateExecuteBusinessMethod_Click"||n.model.dictAttributes.sfwMethodName=="btnExecuteBusinessMethod_Click"||n.model.dictAttributes.sfwMethodName=="btnBack_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardCancel_Click"||n.model.dictAttributes.sfwMethodName=="btnCompleteWorkflowActivities_Click")&&(n.model.ObjectMethodText="Object Method :"),n.PopulateBooleanValues(),n.model.dictAttributes.sfwMethodName=="btnPdfCorrespondence_Click"&&n.InitPDFCorrespondenceNavigationParam(),n.model.dictAttributes.sfwMethodName=="btnExportToPDF_Click"&&(n.lstPageType=s.FORM.LIST_OF_PAGETYPE),n.PopulateWizardSteps(),n.lstEntityFields=[],n.model.dictAttributes.sfwMethodName=="btnOpen_Click"&&n.PopulateEntityFieldsForOpenButton()),n.model&&n.model.Name=="sfwImageButton"&&(n.PopulateTextRelatedControl(),n.lstSelectedIndex=[],n.MessageIDText="Lookup Messages :",n.OnActiveFormValueChange(),n.PopulateImageAlign()),n.PopulateKnobStyle=function(){n.lstKnobStyle=["butt","round"];n.model.dictAttributes.sfwKnobLineStyle||(n.model.dictAttributes.sfwKnobLineStyle="butt")},n.PopulateKnobRotation=function(){n.lstKnobRotation=["clockwise","anticlockwise"];n.model.dictAttributes.sfwKnobRotation||(n.model.dictAttributes.sfwKnobRotation="clockwise")},n.PopulateKnobThickness=function(){n.lstKnobThickness=["0.1","0.2","0.3","0.4","0.5"];n.model.dictAttributes.sfwThickness||(n.model.dictAttributes.sfwThickness="0.1")},n.model&&n.model.Name=="sfwKnob"&&(n.PopulateKnobStyle(),n.PopulateKnobRotation(),n.PopulateKnobThickness()),n.model.Name=="TemplateField"){for(n.lstSortExpressions=[],n.lstSortExpressions.push(""),i=FindParent(n.model,"sfwGridView"),i&&PopulateSortExpressions(i,n.lstSortExpressions),n.model.HeaderTemplateLabel=undefined,t=0;t<n.model.Elements.length;t++)n.model.Elements[t].Name=="HeaderTemplate"&&(n.model.HeaderTemplateLabel=n.model.Elements[t].Elements[0]);n.model.HeaderTemplateLabel==undefined&&(c={dictAttributes:{},Elements:[{dictAttributes:{sfwEntityField:""},Elements:[],Children:[],Name:"sfwLabel",Value:"",prefix:"swc"}],Children:[],Name:"HeaderTemplate",Value:"",prefix:"asp"},n.model.HeaderTemplateLabel=c.Elements[0])}if(n.addHeaderTemplate=function(){var i,t,r;n.model&&n.model.Elements.length>0&&(i=n.model.Elements.filter(function(n){return n.Name=="HeaderTemplate"}),t=n.model.Elements.indexOf(i[0]),t>-1&&n.model.Elements.splice(t,1));n.model.HeaderTemplateLabel&&n.model.HeaderTemplateLabel.dictAttributes.sfwEntityField&&(r={dictAttributes:{},Elements:[n.model.HeaderTemplateLabel],Name:"HeaderTemplate",Value:"",prefix:"asp"},n.model.Elements.push(r))},n.model.Name=="sfwCommandButton"&&(n.PopulateOnClientClick(),n.PopulateSecurityLevel(),n.PopulateOnCommandName()),n.IsMultiActiveForm=!1,n.model.SelectActiveFormType?n.model.SelectActiveFormType==="Multiple"&&(n.IsMultiActiveForm=!0):n.model.SelectActiveFormType="Single",n.model.dictAttributes.sfwActiveForm!=undefined&&n.model.dictAttributes.sfwActiveForm!=""&&n.model.dictAttributes.sfwActiveForm.contains("=")&&(n.model.SelectActiveFormType="Multiple",n.IsMultiActiveForm=!0),n.setActiveForm(),n.model.Name=="sfwGridView"&&(n.lstParentGrid=[],PopulateGridID(n.formobject,n.model.dictAttributes.ID,n.lstParentGrid),n.lstParentGrid.splice(0,0,"")),n.IsActiveFormRadioDisabled=function(){return n.model.Name=="sfwOpenDetail"||n.model.Name=="sfwMultiCorrespondence"||n.model.dictAttributes.sfwMethodName=="btnWizardFinish_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardCancel_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardFindAndNext_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardNext_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardPrevious_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardSaveAndNext_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardSaveAndPrevious_Click"?!0:!1},n.model.Name=="sfwChart")for(t=0;t<n.model.Elements.length;t++)n.model.Elements[t].Name=="ChartAreas"&&(n.chartArea=n.model.Elements[t].Elements[0],n.chartArea&&n.chartArea.Elements.length>0&&(n.Area3D=n.chartArea.Elements[0]));n.model.Name=="sfwRuleViewer"&&n.PopulateRulesBasedOnEntity(n.model.dictAttributes.sfwEntityName);n.ShowPropertyBasedOnCondition();n.model&&n.model.Name=="sfwDateTimePicker"&&n.LoadDataFormatsForDateTimePicker();n.model&&(n.model.Name=="sfwCheckBoxList"||n.model.Name=="sfwCalendar"||n.model.Name=="sfwScheduler")&&n.LoadCollectionFieldEntity();n.model&&(n.model.retrievalType="Query","sfwRetrievalMethod"in n.model.dictAttributes&&n.model.dictAttributes.sfwRetrievalMethod!=undefined&&n.model.dictAttributes.sfwRetrievalMethod!=""&&(n.model.retrievalType="Method"));n.model&&(n.model.autocompleteType="Query",n.model.dictAttributes.sfwAutoMethod&&(n.model.autocompleteType="Method"));n.model&&n.model.dictAttributes.sfwRetrievalQuery&&n.RetrievalQueryInputChange(!0);n.LoadClientVisibilitySource();n.CheckForFilterGridControl();n.$evalAsync(function(){n.setDefaultCodeGroup()});n.model&&n.model.Name==="sfwLabel"&&n.model.ParentVM&&(n.model.ParentVM.Name==="HeaderTemplate"||n.model.ParentVM.Name==="FooterTemplate")&&(n.model.IsHeaderOrFooterField=!0)};n.setActiveForm=function(){var t,i;n.ActiveFormType="Lookup,Maintenance,Wizard,FormLinkLookup,FormLinkMaintenance,FormLinkWizard";n.model&&(n.model.dictAttributes.sfwMethodName=="btnCorrespondenceRows_Click"?n.ActiveFormType="Maintenance,FormLinkMaintenance":n.model.dictAttributes.sfwMethodName=="btnOpenLookup_Click"?n.ActiveFormType="Lookup,FormLinkLookup,Maintenance,FormLinkMaintenance":(n.model.dictAttributes.sfwMethodName=="btnNew_Click"||n.model.dictAttributes.sfwMethodName=="btnOpen_Click")&&(t=!1,n.model.dictAttributes.sfwRelatedControl&&(i=FindControlByID(n.formobject,n.model.dictAttributes.sfwRelatedControl),i&&i.Name==="sfwScheduler"&&(t=!0)),n.ActiveFormType=t?"Maintenance,FormLinkMaintenance":"Wizard,Maintenance,FormLinkMaintenance,FormLinkWizard"),(n.model.dictAttributes.sfwMethodName=="btnNewUpdate_Click"||n.model.dictAttributes.sfwMethodName=="btnPrototypeSearch_Click")&&(n.ActiveFormType="Maintenance,FormLinkMaintenance"),n.model.dictAttributes.sfwMethodName==="btnRetrieve_Click"&&(n.ActiveFormType="Lookup,FormLinkLookup"),(n.model.Name=="sfwOpenDetail"||n.model.Name=="sfwMultiCorrespondence")&&(n.ActiveFormType="Maintenance,FormLinkMaintenance"),n.model.Name=="sfwSeries"&&(n.ActiveFormType="Maintenance,FormLinkMaintenance"),(n.model.Name=="sfwOpenDetail"||n.model.Name=="sfwMultiCorrespondence"||n.model.dictAttributes.sfwMethodName=="btnWizardAddNewChild_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardFinish_Click"||n.model.dictAttributes.sfwMethodName=="btnRetrieve_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardCancel_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardDeleteChild_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardUpdateChild_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardFindAndNext_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardNext_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardPrevious_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardSaveAndNext_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardSaveAndPrevious_Click")&&(n.IsMultiActiveForm=!1))};n.setDefaultCodeGroup=function(){var r,i,t;n.model&&n.entityName&&(n.model.Name=="sfwDropDownList"||n.model.Name=="sfwCascadingDropDownList"||n.model.Name=="sfwMultiSelectDropDownList"||n.model.Name=="sfwListPicker"||n.model.Name=="sfwListBox"||n.model.Name=="sfwRadioButtonList")?(i=u.getEntityIntellisense(),t="",(n.IsSearchCriteriaSelected||n.isFilterCriteria)&&n.model.dictAttributes.sfwDataField?t=GetCodeIDForLookup(n.entityName,n.model.dictAttributes.sfwDataField,i):n.model.dictAttributes.sfwEntityField&&(t=GetCodeID(n.entityName,n.model.dictAttributes.sfwEntityField,i)),n.model.placeHolder=t?t:"",r="",(n.IsSearchCriteriaSelected||n.isFilterCriteria)&&n.model.dictAttributes.sfwDataField?r="sfwDataField":n.model.dictAttributes.sfwEntityField&&(r="sfwEntityField"),n.validateEmptyCodeId(r)):n.model&&n.model.Name=="sfwCheckBoxList"&&n.model.CollectionFieldEntity&&(i=u.getEntityIntellisense(),t="",n.model.dictAttributes.sfwCheckBoxField&&(t=GetCodeID(n.model.CollectionFieldEntity,n.model.dictAttributes.sfwCheckBoxField,i)),n.model.placeHolder=t?t:"",n.validateEmptyCodeId("sfwCheckBoxField"))};n.validateEmptyCodeId=function(t){n.model.errors||(n.model.errors={});n.model.dictAttributes[t]&&n.model.errors&&!n.model.errors[t]?n.model.dictAttributes.sfwLoadType=="CodeGroup"&&n.model.placeHolder&&n.model.errors.invalid_code_group==s.VALIDATION.EMPTY_FIELD?o.checkValidListValue([],n.model,n.model.dictAttributes.sfwLoadSource,"sfwLoadSource","invalid_code_group",s.VALIDATION.CODE_GROUP_NOT_EXISTS,undefined,!0):n.model.errors&&n.model.errors.invalid_code_group!=s.VALIDATION.CODE_GROUP_NOT_EXISTS&&o.checkValidListValue([n.model.dictAttributes.sfwLoadSource],n.model,n.model.dictAttributes.sfwLoadSource,"sfwLoadSource","invalid_code_group",s.VALIDATION.CODE_GROUP_NOT_EXISTS,undefined):n.model.errors&&n.model.errors.invalid_code_group!=s.VALIDATION.CODE_GROUP_NOT_EXISTS&&o.checkValidListValue([n.model.dictAttributes.sfwLoadSource],n.model,n.model.dictAttributes.sfwLoadSource,"sfwLoadSource","invalid_code_group",s.VALIDATION.CODE_GROUP_NOT_EXISTS,undefined)};n.Init=function(){n.IsLookup=n.formobject.dictAttributes.sfwType=="Lookup"?!0:!1;n.IsReport=n.formobject.dictAttributes.sfwType=="Report"?!0:!1;n.IsCorrespondence=n.formobject.dictAttributes.sfwType=="Correspondence"?!0:!1;n.LoadModes();n.LoadDataFormats();n.LoadTextMode();n.LoadDefaultTypes();n.LoadOperators();n.LoadValidatorOperators();n.LoadSelectionMode();n.LoadRepeatDirection();n.LoadAlignment();n.LoadGridSelection();n.getGroupList();n.MainTable=undefined;var t;n.isformlink!=undefined&&n.isformlink==!0?n.MainTable=n.formobject.Children:(t=n.formobject.Elements.filter(function(n){return n.Name=="sfwTable"}),t&&t.length>0&&(n.MainTable=t[0]));n.LoadDataType();n.LoadType();n.LoadAxisFormatsForChart()};n.ResetAdvanceProperties=function(){n.SelectedTab="General";$(i).find("[header-properties-row][category!='Accessibility'] td").addClass("prop-close")};n.ShowPropertyBasedOnCondition=function(){n.IsShowModePropertyVisible();n.IsShowVisibleRulePropertyVisible();n.IsShowResourcePropertyVisible();n.IsShowCssClassPropertyVisible();n.IsShowCustomAttributePropertyVisible()};n.renderTypes=["None","RichText","Rating","NumSpinner"];n.InitOnDblClick=function(){(n.model.Name=="sfwListPicker"||n.model.Name=="sfwSourceList"||n.model.Name=="sfwRadioButtonList"||n.model.Name=="sfwCascadingDropDownList"||n.model.Name=="sfwMultiSelectDropDownList"||n.model.Name=="sfwDropDownList"||n.model.Name=="sfwListBox"||n.model.Name=="sfwCheckBoxList")&&(n.PopulateLoadTyeps(),n.InitializeDropDownItems())};n.PopulateLoadTyeps=function(){if(n.lstLoadTypes=[],n.lstLoadTypes.push("CodeGroup"),n.lstLoadTypes.push("Query"),(!n.IsLookup||n.model&&n.model.Name!="sfwDropDownList"&&n.model.Name!="sfwMultiSelectDropDownList")&&!n.IsReport){n.lstLoadTypes.push("Method");var t=FindParent(n.model,"sfwListView");n.model&&(n.model.IsChildOfGrid||t)&&n.lstLoadTypes.push("ChildMethod")}n.lstLoadTypes.push("ServerMethod");n.model.Name=="sfwCascadingDropDownList"&&(n.model.Name!="sfwCascadingDropDownList"||n.model.dictAttributes.sfwParentControl)||n.lstLoadTypes.push("Items")};n.GetCodeValueFields=function(){function f(t){var r=t.ID,u=t.KeyNo,i=t.Value;i||(i="");u!="0"||IsAuditField(r)||n.lstCodeValues.push({CodeID:i,Description:r})}var r=u.getEntityIntellisense(),t=r.filter(function(n){return n.ID=="entCodeValue"}),i;t&&t.length>0&&(i=t[0],angular.forEach(i.Attributes,f))};n.InitializeDropDownItems=function(){if(n.model)if(n.model.CommonProp=n.model.dictAttributes.sfwLoadType,n.lstCodeValues=[],n.lstQryField=[],n.GetCodeValueFields(),n.model.CommonProp==undefined||n.model.CommonProp=="")n.model.CommonProp="CodeGroup",n.model.dictAttributes.sfwLoadType="CodeGroup";else if(n.model.CommonProp=="Query")n.LoadQueryColumns(n.model.dictAttributes.sfwLoadSource);else if(n.model.CommonProp=="ServerMethod")n.onRemoteObjectChanged(!0)};n.$on("onOKClick",function(i,r){t.EditPropertyValue(n.model.dictAttributes.sfwLoadSource,n.model.dictAttributes,"sfwLoadSource",r.ID)});n.onQuerySearchClick=function(i){n.attributeName="sfwLoadSource";i=="DefaultValue"&&(n.attributeName="sfwDefaultValue");n.strSelectedQuery=n.model.dictAttributes[n.attributeName];var r=n.$new(!0);r.attributeName="sfwLoadSource";i=="DefaultValue"&&(r.attributeName="sfwDefaultValue");r.strSelectedQuery=n.model.dictAttributes[n.attributeName];r.QueryDialog=t.showDialog(r,"Browse For Query","Form/views/BrowseForQuery.html",{width:1e3,height:700})};n.$on("onQueryClick",function(i,r){t.EditPropertyValue(n.model.dictAttributes[n.attributeName],n.model.dictAttributes,n.attributeName,r);n.LoadQueryColumns(n.model.dictAttributes[n.attributeName])});n.LoadQueryColumnsOnChange=function(i){t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter","");n.LoadQueryColumns(i)};n.LoadQueryColumns=function(t){var i,e,r,o;if(t!=undefined&&t!=""&&(i=t.split("."),i&&i.length==2)){var s=i[0],h=i[1],c=u.getEntityIntellisense(),f=c.filter(function(n){return n.ID==s});f&&f.length>0&&(e=f[0],r=e.Queries.filter(function(n){return n.ID==h}),r&&r.length>0?(o=r[0],n.selectedCurrentQuery=o,$.connection.hubForm.server.getEntityQueryColumns(t,"MainParentPanelCommonProp"+n.formobject.dictAttributes.ID).done(function(t){n.$evalAsync(function(){n.lstQryField=[];n.lstQryField=t})})):n.lstQryField=[])}};n.onBaseQuerySearchClick=function(){var i=n.$new(!0);i.strSelectedQuery=n.model.dictAttributes.sfwBaseQuery;i.IsBaseQuery=!0;i.QueryDialog=t.showDialog(i,"Browse For Query","Form/views/BrowseForQuery.html",{width:1e3,height:700})};n.$on("onBaseQueryClick",function(i,r){t.EditPropertyValue(n.model.dictAttributes.sfwBaseQuery,n.model.dictAttributes,"sfwBaseQuery",r);n.onBaseQueryChange(r)});n.onMethodQueryParamClick=function(){var i=n.$new(!0);i.selectedCurrentQuery=n.selectedCurrentQuery;i.SelectedObject=n.model;i.IsForm=!0;i.IsMultiActiveForm=!1;i.formobject=n.formobject;i.isFormLink=n.isformlink;i.NavigationParameterDialog=t.showDialog(i,"Navigation Parameters","Form/views/ParameterNavigation.html",{width:1e3,height:520})};n.canDisabledParameters=function(){var t=!1;return n.model&&(n.model.dictAttributes.sfwLoadType=="CodeGroup"?n.model.placeHolder||n.model.dictAttributes.sfwLoadSource||(t=!0):n.model.dictAttributes.sfwLoadSource||(t=!0)),t};n.PopulateRelatedButton=function(){function i(t){t.dictAttributes.ID!==n.model.dictAttributes.ID&&n.lstExecuteAfterSuccessButton.push(t.dictAttributes.ID)}n.lstExecuteAfterSuccessButton=[];n.lstExecuteAfterSuccessButton.push("");var t=[];FindControlListByNames(n.model,["sfwButton","sfwLinkButton","sfwImageButton"],t);angular.forEach(t,i)};n.LoadModes=function(){n.lstModes=[];n.lstModes.push("All");n.lstModes.push("New");n.lstModes.push("Update")};n.LoadSelectionMode=function(){n.lstSelectionMode=[];n.lstSelectionMode.push("Single");n.lstSelectionMode.push("Multiple")};n.LoadDataFormats=function(){n.lstDataFormats=[];n.lstDataFormats.push("");n.lstDataFormats.push("{0:d}");n.lstDataFormats.push("{0:C}");n.lstDataFormats.push("{0:G}");n.lstDataFormats.push("{0:#0.00'%}");n.lstDataFormats.push("{0:#0.000'%}");n.lstDataFormats.push("{0:#0.0000'%}");n.lstDataFormats.push("{0:#0.00000'%}");n.lstDataFormats.push("{0:000-##-####}");n.lstDataFormats.push("{0:(###)###-####}")};n.LoadDataFormatsForDateTimePicker=function(){n.lstDataFormatsForDateTime=[];n.lstDataFormatsForDateTime.push("");n.lstDataFormatsForDateTime.push("{0:d}");n.lstDataFormatsForDateTime.push("{0:G}")};n.LoadTextMode=function(){n.lstTextModes=[];n.lstTextModes.push("SingleLine");n.lstTextModes.push("MultiLine");n.lstTextModes.push("Password");n.lstTextModes.push("Color");n.lstTextModes.push("Date");n.lstTextModes.push("DateTime");n.lstTextModes.push("DateTimeLocal");n.lstTextModes.push("Email");n.lstTextModes.push("Month");n.lstTextModes.push("Number");n.lstTextModes.push("Range");n.lstTextModes.push("Search");n.lstTextModes.push("Phone");n.lstTextModes.push("Time");n.lstTextModes.push("Url");n.lstTextModes.push("Week")};n.LoadDefaultTypes=function(){n.lstDefaultType=[];n.lstDefaultType.push("None");n.lstDefaultType.push("TextValue");n.lstDefaultType.push("TodaysDate");n.lstDefaultType.push("TodaysDateTime");n.lstDefaultType.push("MethodOnServer");n.lstDefaultType.push("MethodOnClient");n.lstDefaultType.push("SystemConstant");n.lstDefaultType.push("ScalarQuery")};n.LoadControlToValidate=function(){if(n.lstControlToValidate=[],n.lstControlToValidate.push(""),n.model.ParentVM!=undefined&&n.model.ParentVM.Elements.length>0)for(var t=0;t<n.model.ParentVM.Elements.length;t++)(n.model.ParentVM.Elements[t].Name=="sfwDropDownList"||n.model.ParentVM.Elements[t].Name=="sfwTextBox")&&n.lstControlToValidate.push(n.model.ParentVM.Elements[t].dictAttributes.ID)};n.findCascadingParentControl=function(){var t=[],i;(n.model.Name=="sfwCascadingDropDownList"||n.model.Name==="sfwMultiSelectDropDownList")&&(i=FindParent(n.model,"sfwGridView"),i&&i.Elements.length>0?FindControlListByName(i,"sfwCascadingDropDownList",t):FindControlListByName(n.MainTable,"sfwCascadingDropDownList",t),t&&t.filter(function(t){t.dictAttributes.ID!=n.model.dictAttributes.ID&&n.lstCascadingDropDwonParent.push(t.dictAttributes.ID)}))};n.LoadControlToCompare=function(){n.lstControlToCompare=[];n.lstControlToCompare.push({dictAttributes:{ID:""}});n.MainTable&&(FindControlListByName(n.MainTable,"sfwDropDownList",n.lstControlToCompare),FindControlListByName(n.MainTable,"sfwTextBox",n.lstControlToCompare))};n.LoadType=function(){n.lstType=[];n.lstType.push("String");n.lstType.push("Integer");n.lstType.push("Double");n.lstType.push("Date");n.lstType.push("Currency")};n.LoadDataType=function(){n.lstDataType=[];n.lstDataType.push("String");n.lstDataType.push("Numeric");n.lstDataType.push("Decimal");n.lstDataType.push("DateTime");n.lstDataType.push("Long")};n.LoadOperators=function(){n.lstOperators=[];n.lstOperators.push("=");n.lstOperators.push("!=");n.lstOperators.push("<");n.lstOperators.push("<=");n.lstOperators.push(">");n.lstOperators.push(">=");n.lstOperators.push("in");n.lstOperators.push("not in");n.lstOperators.push("like");n.lstOperators.push("exists");n.lstOperators.push("between");n.lstOperators.push("is null");n.lstOperators.push("is not null")};n.LoadValidatorOperators=function(){n.lstValidatorOperators=[];n.lstValidatorOperators.push("Equal");n.lstValidatorOperators.push("NotEqual");n.lstValidatorOperators.push("GreaterThan");n.lstValidatorOperators.push("GreaterThanEqual");n.lstValidatorOperators.push("LessThan");n.lstValidatorOperators.push("LessThanEqual");n.lstValidatorOperators.push("DataTypeCheck")};n.LoadRepeatDirection=function(){n.lstRepeatDirection=[];n.lstRepeatDirection.push("Horizontal");n.lstRepeatDirection.push("Vertical")};n.LoadAlignment=function(){n.lstAlignment=[];n.lstAlignment.push("Left");n.lstAlignment.push("Center");n.lstAlignment.push("Right");n.lstAlignment.push("Justify");n.lstAlignment.push("NotSet")};n.LoadGridSelection=function(){n.lstGridSelection=[];n.lstGridSelection.push("None");n.lstGridSelection.push("One");n.lstGridSelection.push("Many");n.lstGridSelection.splice(0,0,"")};n.LoadRelatedControlTextbox=function(){n.lstRelatedControlTextbox=[];n.lstRelatedControlTextbox.push({dictAttributes:{ID:""}});n.MainTable&&FindControlListByNameForTextBox(n.MainTable,"sfwTextBox",n.lstRelatedControlTextbox,n.formobject)};n.setClientVisibilityClick=function(){var i=n.$new();i.model=n.model;i.formobject=n.formobject;i.strAttributeName="sfwClientVisibility";i.CurrentTable=n.CurrentTable;i.Title="Set Client Visibility";i.IsForm=!0;n.isformlink&&(i.IsForm=!1);i.objNewDialog=t.showDialog(i,"Set Client Visibility","Form/views/ClientVisibility.html",{width:900,height:500})};n.setClientEnableClick=function(){var i=n.$new();i.strAttributeName="sfwClientEnable";i.Title="Set Client Enability";i.CurrentTable=n.CurrentTable;i.IsForm=!0;n.isformlink&&(i.IsForm=!1);i.objNewDialog=t.showDialog(i,"Set Client Enability","Form/views/ClientVisibility.html",{width:900,height:500})};n.onCustomAttributeClick=function(){var i=n.$new();i.propertyName="sfwCustomAttributes";i.model=n.model;i.formobject=n.formobject;i.isFormLink=n.isformlink;i.CurrentTable=n.CurrentTable;i.UserLogParaDialog=t.showDialog(i,"Set Custom Attributes","Form/views/CustomAttributes.html",{width:900,height:500})};n.onQueryParameterClick=function(){var i=n.$new(!0);i.SelectedObject=n.model;i.selectedCurrentQuery=n.selectedCurrentQuery;i.formobject=n.formobject;i.isFormLink=n.isformlink;i.NavigationParameterDialog=t.showDialog(i,"Navigation Parameters","Form/views/ParameterNavigation.html",{width:1e3,height:520})};n.onCodeGroupParameterClick=function(){var i=n.$new(!0);i.SelectedObject=n.model;i.formobject=n.formobject;i.IsFormCodeGroup=!0;i.NavigationParameterDialog=t.showDialog(i,"Set Parameters","Form/views/ParameterNavigation.html",{width:1e3,height:520})};n.onSetParameterClick=function(){n.model.CommonProp=="CodeGroup"?n.onCodeGroupParameterClick():n.onQueryParameterClick()};n.openImageConditionClick=function(i){var r=n.$new(!0);r.oldConditions=i;r.formobject=n.formobject;r.model=n.model;r.ImageConditionDialog=t.showDialog(r,"Image Condition","Form/views/ImageCondition.html",{width:600,height:500})};n.openBindtoQueryClick=function(i){var r=n.$new();r.gridmodel=i;r.formobject=n.formobject;r.model=n.model;r.BindToQueryDialog=t.showDialog(r,"Bind to Query","Form/views/BindToQuery.html",{width:600,height:500})};n.openCellFormatClick=function(i,r){var u=n.$new(!0),f,o,e;u.TemplateFieldModel=i;u.formEntity=n.formobject.dictAttributes.sfwEntity;u.isLookup=n.IsLookup;u.IsCellOrRow=r;f=i.Elements.filter(function(n){return n.Name=="rowformat"});r!="CellFormat"&&(!f||f&&f.length==0)&&(o={Name:"rowformat",Value:"",dictAttributes:{},Elements:[],Children:[]},i.Elements.push(o));e="Row Format";u.IsCellOrRow=="CellFormat"&&(e="Cell Format");u.CellFormatDialog=t.showDialog(u,e,"Form/views/CellFormate.html",{width:600,height:565})};n.openSetFooterClick=function(i){var r=n.$new(!0),f=FindParent(i,"sfwGridView"),u,o,e;i&&f&&f.dictAttributes.sfwParentGrid?(u=FindControlByID(n.formobject,f.dictAttributes.sfwParentGrid),u&&u.dictAttributes.sfwEntityField&&(o=null,e=l.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,u.dictAttributes.sfwEntityField),e&&(r.formEntity=e.Entity))):r.formEntity=n.formobject.dictAttributes.sfwEntity;r.TemplateFieldModel=i;r.SetFoterDialog=t.showDialog(r,"Footer Details","Form/views/SetFooter.html",{width:600})};n.openDataKeyAndSortExxpressionClick=function(i){var r=n.$new(!0);r.model=i;r.DataKeyAndSortExpressionDialog=t.showDialog(r,"DataKey And Sort Expression","Form/views/DataKeysAndSortExpression.html",{width:800})};n.openGroupExpression=function(){var i=n.$new(!0);i.model=n.model;i.GroupExpressionDialog=t.showDialog(i,"Group Expression","Form/views/ControlProperties/GroupExpression.html",{width:800})};n.onValidationRulesClick=function(i){var r=n.$new(!0);r.model=n.model;r.formobject=n.formobject;r.entityID=i;r.validateValidationRules=n.validateValidationRules;r.dialogValidation=t.showDialog(r,"Hard Errors","Form/views/SetValidationRules.html",{width:700,height:460})};n.FuncSetColSpanRowSpan=function(){var r=n.model.ParentVM,f=r?r.ParentVM:null,o=f.Elements.indexOf(r),s=r.Elements,c=s.indexOf(n.model),i=n.$new(!0),u=parseInt(n.model.dictAttributes.ColumnSpan)?parseInt(n.model.dictAttributes.ColumnSpan):1,e=parseInt(n.model.dictAttributes.RowSpan)?parseInt(n.model.dictAttributes.RowSpan):1;i.ColumnSpan=n.model.dictAttributes.ColumnSpan;i.RowSpan=n.model.dictAttributes.RowSpan;i.objTableModel=angular.copy(f,i.objTableModel);i.formodel=n.formobject;i.SetColRowSpanDialog=t.showDialog(i,"Set Column/Row Span","Form/views/SetColRowSpan.html",{width:1e3,height:500,showclose:!0});setTimeout(function(){var n=$("#ColSpan_Dialog_"+i.$id+" #virtual_column_"+o+"_"+c);n&&n.length>0&&n[0].scrollIntoView()},500);i.okClick=function(r){function ft(n){n.isDeleting=!1;n.isAdding=!1;n.isEditing=!1}function nt(n){var t=0,i=[];return{resetCount:function(){t=0},setCount:function(r,u,f){t+=parseInt(r.dictAttributes[n])?parseInt(r.dictAttributes[n]):1;u==f.length-1&&i.push(t)},getCount:function(){return t},getCounts:function(){return i}}}function et(n,t,i){y.setCount(n,t,i)}function tt(n,t){t!=a&&(y.resetCount(),n.Elements.forEach(et))}function ot(n,t){t>c&&(w-=parseInt(n.dictAttributes.ColumnSpan)?parseInt(n.dictAttributes.ColumnSpan):1)}function st(n,t,i){if(t==c)y.setCount(n,t,i);else if(t>c)return!0}function ht(n,t){t<c&&(b+=parseInt(n.dictAttributes.ColumnSpan)?parseInt(n.dictAttributes.ColumnSpan):1)}function tt(n,t){t>a?n.Elements.some(st):t==a&&n.Elements.some(ht)}function it(n,i,u){h.is_validModelElements(n,"sfwColumn",!1)&&n.dictAttributes.ColumnSpan&&parseInt(n.dictAttributes.ColumnSpan)>1?(r&&(n.isEditing=!0),t.EditPropertyValue(n.dictAttributes.ColumnSpan,n.dictAttributes,"ColumnSpan",n.dictAttributes.ColumnSpan-1)):r?n.isDeleting=!0:t.DeleteItem(n,u)}function ct(n,t){t>c&&(l-=parseInt(n.dictAttributes.ColumnSpan)?parseInt(n.dictAttributes.ColumnSpan):1)}function lt(n,t){t>c&&(l-=parseInt(n.dictAttributes.ColumnSpan)?parseInt(n.dictAttributes.ColumnSpan):1)}var v,rt,d,b,y,ut,l,w,f,k,p;if(h.is_validModelElements(s,"sfwRow",!0)&&h.is_validModelElements(o,"sfwTable",!0)){var s=n.model.ParentVM,o=s?s.ParentVM:null,a=o.Elements.indexOf(s),g=s.Elements,c=g.indexOf(n.model),at=g.length;if(r&&(i.objTableModel=angular.copy(o,i.objTableModel),o=i.objTableModel,s=o.Elements[a],s.Elements.forEach(ft),i.objCtrlModel=s.Elements[c]),r||t.UndRedoBulkOp("Start"),parseInt(i.ColumnSpan)&&parseInt(n.model.dictAttributes.ColumnSpan)!==parseInt(i.ColumnSpan)&&(v=0,c>-1)){if(y=nt("ColumnSpan"),o.Elements.forEach(tt),v=Math.max.apply(null,y.getCounts()),g.some(function(n,t){if(t<c)v-=n.dictAttributes.ColumnSpan?n.dictAttributes.ColumnSpan:1;else return!0}),v<parseInt(i.ColumnSpan))for(f=at-1;f>c;f--)r?s.Elements[f].isDeleting=!0:t.DeleteItem(s.Elements[f],s.Elements);if(v>=parseInt(i.ColumnSpan))if(parseInt(i.ColumnSpan)>u)for(rt=parseInt(i.ColumnSpan)-u,f=c+rt;f>c;f--)r?s.Elements[f].isDeleting=!0:t.DeleteItem(s.Elements[f],s.Elements);else if(parseInt(i.ColumnSpan)<u&&(p=function(){return r?{Name:"sfwColumn",value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[],ParentVM:s,isAdding:!0}:{Name:"sfwColumn",value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[],ParentVM:s}},parseInt(i.ColumnSpan)<=v))if(w=v-(parseInt(i.ColumnSpan)?parseInt(i.ColumnSpan):1),s.Elements.forEach(ot),c<s.Elements.length-1)for(f=0;f<w;f++)t.InsertItem(new p,s.Elements,c+1);else for(f=0;f<w;f++)t.PushItem(new p,s.Elements);r||t.EditPropertyValue(n.model.dictAttributes.ColumnSpan,n.model.dictAttributes,"ColumnSpan",i.ColumnSpan)}if(u=parseInt(n.model.dictAttributes.ColumnSpan)?parseInt(n.model.dictAttributes.ColumnSpan):1,parseInt(i.RowSpan)&&parseInt(n.model.dictAttributes.RowSpan)!==parseInt(i.RowSpan)&&(d=0,b=0,a>-1)){if(y=nt("RowSpan"),o.Elements.forEach(tt),d=y.getCount()+1,d<parseInt(i.RowSpan))for(f=a+1;f<o.Elements.length;f++)for(l=o.Elements[f].Elements.length-1,o.Elements[f].Elements.forEach(ct);l>=b;)it(o.Elements[f].Elements[l],l,o.Elements[f].Elements),l-=1;if(d>=parseInt(i.RowSpan))if(parseInt(i.RowSpan)>e)for(ut=parseInt(i.RowSpan)-e,f=a+1,k=0;k<ut;f++,k++)for(l=o.Elements[f].Elements.length-1,o.Elements[f].Elements.forEach(lt);l>=b;)it(o.Elements[f].Elements[l],l,o.Elements[f].Elements),l-=1;else for(w=parseInt(n.model.dictAttributes.RowSpan)-(parseInt(i.RowSpan)?parseInt(i.RowSpan):1),f=a+parseInt(n.model.dictAttributes.RowSpan)-1,k=0;f<o.Elements.length&&k<w;f++,k++)p=function(){return r?{Name:"sfwColumn",value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[],ParentVM:o.Elements[f],isAdding:!0}:{Name:"sfwColumn",value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[],ParentVM:o.Elements[f]}},b<o.Elements[f].Elements.length-1?t.InsertItem(new p,o.Elements[f].Elements,b):t.PushItem(new p,o.Elements[f].Elements);r||t.EditPropertyValue(n.model.dictAttributes.RowSpan,n.model.dictAttributes,"RowSpan",i.RowSpan)}r||t.UndRedoBulkOp("End")}r||i.closeClick()};i.closeClick=function(){n.$evalAsync(function(){i.SetColRowSpanDialog.close();i.$destroy()})}};n.validateValidationRules=function(t){var i,r,u,f;n.model&&n.model.dictAttributes&&(i=[],n.lstHardErrorData,r=n.model.dictAttributes.sfwValidationRules,n.$parent.iswizard?(u=FindParent(n.model,"sfwWizardStep"),u&&(f=u.dictAttributes.sfwRulesGroup,i=n.$parent.createValidationRuleList(n.formobject.objExtraData,n.$parent.iswizard,f))):!n.entityName||n.lstHardErrorData||t?i=n.$parent.createValidationRuleList(n.formobject.objExtraData,!1,null):(n.lstHardErrorData=[],hubMain.server.getEntityExtraData(n.entityName).done(function(t){n.$evalAsync(function(){if(t&&t.lstHardErrorList){var u=t.lstHardErrorList[0];u.Elements.length>0&&angular.forEach(u.Elements,function(t){t&&t.dictAttributes.ID&&n.lstHardErrorData.push(t.dictAttributes.ID)});i=n.lstHardErrorData;o.checkMultipleValueWithList(n.lstHardErrorData,n.model,r,";","sfwValidationRules","invalid_validation_rule",s.VALIDATION.VALIDATION_RULE_NOT_EXISTS,undefined)}})})),t?i=t:n.lstHardErrorData&&(i=n.lstHardErrorData),o.checkMultipleValueWithList(i,n.model,r,";","sfwValidationRules","invalid_validation_rule",s.VALIDATION.VALIDATION_RULE_NOT_EXISTS,undefined))};n.OpenImageUrl=function(t){n.formobject.dictAttributes.WebSite?$.connection.hubForm.server.openImageUrlClick(n.formobject.dictAttributes.WebSite,t).done(function(t){t&&t.length==2&&n.receiveImageFileName(t[0],t[1])}):a.Message("Message","Please select the appropriate 'Website' from the form details page.")};n.receiveImageFileName=function(t,i){t!=""&&n.$apply(function(){n.model.dictAttributes.ImageUrl=t});i!=""&&i!=undefined&&a.Message("Message",i)};n.openRetrievalTemplateProp=function(t){n.template="Form/views/Retrieval.html";n.model=t;n.formobject=n.formobject};n.openAutoCompleteTemplateProp=function(t){n.template="Form/views/AutoComplete.html";n.model=t;n.formobject=n.formobject};n.getQuery_dialog=function(){var i=n.$new(!0);n.model.dictAttributes.sfwQueryID!=undefined&&(i.strSelectedQuery=n.model.dictAttributes.sfwQueryID);i.IsForm=!0;i.QueryDialog=t.showDialog(i,"Browse For Query","Form/views/BrowseForQuery.html",{width:1e3,height:700})};n.$on("onFormQueryClick",function(t,i){n.model.dictAttributes.sfwQueryID=i});n.onAddItem=function(){n.model.Elements.push({dictAttributes:{Text:"",Value:""},Elements:[],Children:[],Name:"ListItem",Value:"",prefix:"asp"})};n.SelectItem=function(t){n.selectedItem=t};n.onDeleteItem=function(){if(n.selectedItem!=undefined){var t=n.model.Elements.indexOf(n.selectedItem);t>-1?n.model.Elements.splice(t,1):n.selectedItem==undefined;n.selectedItem=t>0?n.model.Elements[t-1]:n.model.Elements[t]}};n.commonTemplateSelectionChange=function(){t.UndRedoBulkOp("Start");t.EditPropertyValue(n.model.Elements,n.model,"Elements",[]);t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter","");n.model.Name=="sfwCascadingDropDownList"&&t.EditPropertyValue(n.model.dictAttributes.sfwParameters,n.model.dictAttributes,"sfwParameters","");t.EditPropertyValue(n.model.dictAttributes.DataTextField,n.model.dictAttributes,"DataTextField","");t.EditPropertyValue(n.model.dictAttributes.DataValueField,n.model.dictAttributes,"DataValueField","");t.EditPropertyValue(n.model.dictAttributes.sfwLoadSource,n.model.dictAttributes,"sfwLoadSource","");t.EditPropertyValue(n.model.dictAttributes.sfwImageField,n.model.dictAttributes,"sfwImageField","");n.model&&n.model.Name=="sfwCheckBoxList"&&t.EditPropertyValue(n.model.dictAttributes.sfwDefaultValue,n.model.dictAttributes,"sfwDefaultValue","");n.model&&(n.model.Name=="sfwDropDownList"||n.model.Name=="sfwCascadingDropDownList")&&t.EditPropertyValue(n.model.dictAttributes.sfwImageField,n.model.dictAttributes,"sfwImageField","");t.UndRedoBulkOp("End");n.InitializeDropDownItems();n.setDefaultCodeGroup()};n.onEntityFieldTextChange=function(){if(n.model.CollectionFieldEntity="",n.model.Name=="sfwCheckBoxList")t.EditPropertyValue(n.model.dictAttributes.sfwCheckBoxField,n.model.dictAttributes,"sfwCheckBoxField","");else if(n.model.Name=="sfwCalendar"||n.model.Name=="sfwScheduler"){if(t.UndRedoBulkOp("Start"),t.EditPropertyValue(n.model.dictAttributes.sfwEventId,n.model.dictAttributes,"sfwEventId",""),t.EditPropertyValue(n.model.dictAttributes.sfwEventName,n.model.dictAttributes,"sfwEventName",""),t.EditPropertyValue(n.model.dictAttributes.sfwEventStartDate,n.model.dictAttributes,"sfwEventStartDate",""),t.EditPropertyValue(n.model.dictAttributes.sfwEventEndDate,n.model.dictAttributes,"sfwEventEndDate",""),n.model.Name=="sfwScheduler"&&t.EditPropertyValue(n.model.dictAttributes.sfwEventCategory,n.model.dictAttributes,"sfwEventCategory",""),n.model.hasOwnProperty("errors"))for(var i in n.model.errors)["sfwEventId","sfwEventName","sfwEventStartDate","sfwEventEndDate","sfwEventCategory"].indexOf(i)>-1&&delete n.model.errors[i];t.UndRedoBulkOp("Start")}};n.LoadCollectionFieldEntity=function(){var t,i;n.model.dictAttributes.sfwEntityField!=undefined&&n.model.dictAttributes.sfwEntityField!=""&&(t=n.formobject.dictAttributes.sfwEntity,n.entityName&&(t=n.entityName),i=l.GetEntityFieldObjectFromEntityField(t,n.model.dictAttributes.sfwEntityField),i&&n.$evalAsync(function(){n.model.CollectionFieldEntity=i.Entity}))};n.getEntityObject=function(n){var i,r=u.getEntityIntellisense(),t=r.filter(function(t){return t.ID==n});return t&&t.length>0&&(i=t[0]),i};n.onQueryIDChange=function(t){var i=$(t.target);n.queryIdInput=i;t&&t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE&&$(i).data("ui-autocomplete")?($(i).autocomplete("search",$(i).val()),t.preventDefault()):d(i)};n.showQueryIDIntellisenseList=function(t){var i;i=$(t.target).prevAll("input[type='text']");n.queryIdInput=i;i.focus();i&&(d(i),$(i).data("ui-autocomplete")&&$(i).autocomplete("search",$(i).val()));t&&t.stopPropagation()};d=function(t){function r(n){i.push(n.dictAttributes.ID)}if(n.queryIdList=[],n.formobject){var u=GetQueryListFromObject(n.formobject),i=[];angular.forEach(u,r);n.queryIdList=i;setSingleLevelAutoComplete(t,i,n)}};n.PopulateRulesBasedOnEntity=function(t){n.Rules=[];var i=u.getEntityIntellisense().filter(function(n){return n.ID==t});i&&i.length>0&&i[0].Rules.length>0&&(n.Rules=i[0].Rules)};n.validateQueryId=function(t){o.checkValidListValue(n.queryIdList,t,n.queryIdInput?n.queryIdInput.val():"","sfwQueryID","invalid_query_id",s.VALIDATION.INVALID_QUERY_ID,undefined)};n.onBaseQueryChange=function(i,r){function k(n){var i={Name:"parameter",Value:"",dictAttributes:{ID:n.ID},Elements:[],Children:[]},u=v.filter(function(n){return n.dictAttributes.ID==i.dictAttributes.ID});u&&u.length>0&&(i.dictAttributes.sfwEntityField=u[0].dictAttributes.sfwEntityField);r?f.Elements.push(i):t.PushItem(i,f.Elements)}var v=[],l=getCurrentFileScope(),o,y,p,s,w,h,b,c,a,e,f;if(l&&l.selectControl&&l.selectControl(n.model),n.model.dictAttributes.sfwBaseQuery=i,n.model.dictAttributes.sfwBaseQuery&&n.model.dictAttributes.sfwBaseQuery!=""){if(o=n.model.dictAttributes.sfwBaseQuery.split("."),o&&o.length==2){if(y=o[0],p=o[1],r||t.UndRedoBulkOp("Start"),e=n.model.Elements.filter(function(n){return n.Name=="Parameters"}),!e||e&&e.length==0?(f={Name:"Parameters",Value:"",dictAttributes:{},Elements:[],Children:[]},r?n.model.Elements.push(f):t.PushItem(f,n.model.Elements)):f=e[0],f){if(f.Elements.length>0)for(s=0;s<f.Elements.length;s++)v.push(f.Elements[s]);f.Elements=[];w=u.getEntityIntellisense();h=w.filter(function(n){return n.ID==y});h&&h.length>0&&(b=h[0],c=b.Queries.filter(function(n){return n.ID==p}),c&&c.length>0&&(a=c[0],a.Parameters.length>0&&angular.forEach(a.Parameters,k)))}r||t.UndRedoBulkOp("End")}}else e=n.model.Elements.filter(function(n){return n.Name=="Parameters"}),e&&e.length>0&&(f=e[0],f.Elements=[])};n.openBaseQueryParamClick=function(){var i,r,u,f;n.onBaseQueryChange(n.model.dictAttributes.sfwBaseQuery,!0);if(i=n.$new(),i.Elements=[],r=n.model.Elements.filter(function(n){return n.Name=="Parameters"}),r&&r.length>0&&r[0]&&r[0].Elements&&r[0].Elements.length>0)for(u=0;u<r[0].Elements.length;u++)f={},angular.copy(r[0].Elements[u],f),i.Elements.push(f);i.entityTreeBinding={selectedobject:null,lstselectedobjects:[],lstentities:[]};i.FormEntity=n.formobject.dictAttributes.sfwEntity;i.onOkClick=function(){if(i.Elements&&i.Elements.length>0){if(t.UndRedoBulkOp("Start"),r&&r.length>0){t.EditPropertyValue(r[0].Elements,r[0],"Elements",[]);for(var n=0;n<i.Elements.length;n++)t.PushItem(i.Elements[n],r[0].Elements)}t.UndRedoBulkOp("End")}i.dialog.close()};i.onParameterSelected=function(n){i.SelectedParameter=n};i.dialog=t.showDialog(i,"Base Query Parameters","Form/views/ControlProperties/GridBaseQueryParameter.html",{width:800,height:525})};n.onEditablePropertyChange=function(){t.UndRedoBulkOp("Start");n.model&&(n.model.dictAttributes.AllowEditing=="True"?(t.EditPropertyValue(n.model.dictAttributes.sfwTwoWayBinding,n.model.dictAttributes,"sfwTwoWayBinding","True"),t.EditPropertyValue(n.model.dictAttributes.sfwCommonFilterBox,n.model.dictAttributes,"sfwCommonFilterBox","False"),t.EditPropertyValue(n.model.dictAttributes.sfwFilterOnKeyPress,n.model.dictAttributes,"sfwFilterOnKeyPress","False")):t.EditPropertyValue(n.model.dictAttributes.sfwTwoWayBinding,n.model.dictAttributes,"sfwTwoWayBinding","False"));t.UndRedoBulkOp("End")};n.onGridDataSourceTypeChange=function(){var t=getCurrentFileScope();t.loadFormEntityTree&&t.loadGridEntityTree(n.model)};n.LoadAxisFormatsForChart=function(){n.lstAxisFormat=[];n.lstAxisFormat.push("");n.lstAxisFormat.push("{0:C}");n.lstAxisFormat.push("{0:c}");n.lstAxisFormat.push("{0:d}");n.lstAxisFormat.push("{0:%}");n.lstAxisFormat.push("{0:#0.00'%}");n.lstAxisFormat.push("{0:#0.000'%}");n.lstAxisFormat.push("{0:#0.0000'%}");n.lstAxisFormat.push("{0:#0.00000'%}")};n.CheckForFilterGridControl=function(){var t=[],r,i,u,f;if(n.lstBaseQueryColumns=[],n.model&&n.MainTable&&(FindControlListByNames(n.MainTable,["sfwButton","sfwLinkButton","sfwImageButton"],t),t&&t.length>0&&(t=t.filter(function(n){return n.dictAttributes.sfwMethodName=="btnGridSearch_Click"}),t&&t.length>0))){for(i=0;i<t.length;i++)if(t[i].dictAttributes.sfwNavigationParameter&&(u=t[i].dictAttributes.sfwNavigationParameter.split(";"),u&&u.length>0&&u.some(function(t){return t==n.model.dictAttributes.ID}))){n.model.IsShowDataField=!0;r=t[i];break}r&&r.dictAttributes.sfwRelatedControl&&(f=FindControlByID(n.MainTable,r.dictAttributes.sfwRelatedControl),f&&f.dictAttributes.sfwBaseQuery&&$.connection.hubForm.server.getEntityQueryColumns(f.dictAttributes.sfwBaseQuery,"ScopeId_"+n.$id).done(function(t){if(t)for(var i=0;i<t.length;i++)n.lstBaseQueryColumns.push(t[i].CodeID)}))}};n.PopulateEntityFieldsForOpenButton=function(i){var u=[],f,r,e;if(PopulateControlsForActiveForm(u,n.formobject,n.model,n.IsLookup),i&&t.EditPropertyValue(n.model.dictAttributes.sfwEntityField,n.model.dictAttributes,"sfwEntityField",""),n.model.IsEntityFieldReset=!0,n.lstEntityFields=[],(n.model.dictAttributes.sfwRelatedControl||n.model.IsChildOfGrid)&&u.length>0)for(f=0;f<u.length;f++)r=u[f],e="",e=r.indexOf("~")>-1?r.substring(0,r.indexOf("~")):r,n.lstEntityFields.some(function(n){return n===e})||n.lstEntityFields.push(e)};n.LoadButtonMethodDescription=function(){if(n.model.MethodDescription="",n.model.dictAttributes.sfwMethodName!=undefined&&n.model.dictAttributes.sfwMethodName!=""){var i=t.LstButtonMethodLookup.filter(function(t){return t.Code==n.model.dictAttributes.sfwMethodName});i&&i.length>0?n.model.MethodDescription=i[0].Description:(i=t.LstButtonMethodMaintenance.filter(function(t){return t.Code==n.model.dictAttributes.sfwMethodName}),i&&i.length>0?n.model.MethodDescription=i[0].Description:(i=t.LstButtonMethodWizard.filter(function(t){return t.Code==n.model.dictAttributes.sfwMethodName}),i&&i.length>0&&(n.model.MethodDescription=i[0].Description)))}};n.PopulateOnCommandName=function(){n.lstOnCommandName=[];n.lstOnCommandName.push("");n.lstOnCommandName.push("Cancel")};n.PopulateOnClientClick=function(){n.lstOnClientClick=[];n.lstOnClientClick.push("");n.lstOnClientClick.push("return confirm('Type your message here.')")};n.PopulateSecurityLevel=function(){n.lstSecurityLevel=[];n.lstSecurityLevel.push({Code:"0",Description:" None"});n.lstSecurityLevel.push({Code:"1",Description:" Read"});n.lstSecurityLevel.push({Code:"2",Description:" Modify"});n.lstSecurityLevel.push({Code:"3",Description:" New"});n.lstSecurityLevel.push({Code:"4",Description:" Delete"});n.lstSecurityLevel.push({Code:"5",Description:" Execute"})};n.PopulateSelection=function(){n.lstSelection=[];n.lstSelection.push("None");n.lstSelection.push("One");n.lstSelection.push("Many")};n.PoulateRelatedControlForNew=function(){n.RelatedControlsForNew=[];n.IsLookup?GetAllControls(n.formobject,"sfwLabel,sfwTextBox,sfwDropDownList,sfwCheckBox,sfwRadioButtonList,sfwLinkButton","tblcriteria","",!1,n.RelatedControlsForNew,!1):GetAllControls(n.formobject,"sfwLabel,sfwTextBox,sfwDropDownList,sfwCheckBox,sfwRadioButtonList,sfwLinkButton,sfwScheduler","","",!1,n.RelatedControlsForNew,!0);n.RelatedControlsForNew.splice(0,0,{dictAttributes:{ID:""}})};n.PoulateRelatedControlForFinishScheduler=function(){n.lstSchedulerControl=[];FindControlListByName(n.MainTable,"sfwScheduler",n.lstSchedulerControl);n.lstSchedulerControl.splice(0,0,{dictAttributes:{ID:""}})};n.CustomMethodNameChange=function(){var n=getCurrentFileScope();n&&(n.isDirty=!0)};n.onRelatedControlandEntityFieldChange=function(){var i=n.model.dictAttributes.sfwActiveForm,f,s,e,r,o;if(i!=undefined&&i!=""){if(f=i.split(";"),f.length>0)for(i=f[0],s="",e=0;e<f.length;e++)r=f[e],r.contains("=")&&(r=r.substring(r.indexOf("=")+1)),s+=s==""?r:";"+r;i.contains("=")&&(i=i.substring(i.indexOf("=")+1));o=[];$.connection.hubMain.server.getSingleFileDetail(i).done(function(i){var s=u.getEntityIntellisense(),r,f,e;GetNavParamCollection(i,n.model,o,s,n.formobject);PopulateParamValues(o,n.model.dictAttributes.sfwNavigationParameter);r=GetNavigationParameterValue(o);n.model.dictAttributes.sfwMethodName=="btnNew_Click"?(f=n.model.dictAttributes.sfwActiveForm.contains("=")?n.model.dictAttributes.sfwRelatedControl:"",n.$evalAsync(function(){r==""?t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter",f):f!=undefined&&f!=""?t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter",r+";"+f):t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter",r)})):n.model.dictAttributes.sfwMethodName=="btnOpen_Click"&&(e=n.model.dictAttributes.sfwActiveForm.contains("=")?n.model.dictAttributes.sfwEntityField:"",n.$evalAsync(function(){n.model.dictAttributes.sfwActiveForm.contains("=")?r==""?t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter",e):e!=undefined&&e!=""?t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter",r+";"+e):t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter",r):t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter",r)}))})}else t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter","");n.setActiveForm()};n.PopulateExecuteAfterSuccessButton=function(){function i(t){t.dictAttributes.ID!==n.model.dictAttributes.ID&&n.lstExecuteAfterSuccessButton.push(t.dictAttributes.ID)}n.lstExecuteAfterSuccessButton=[];n.lstExecuteAfterSuccessButton.push("");var t=[];FindControlListByName(n.MainTable,"sfwButton",t);angular.forEach(t,i)};n.PopulateMessageDescription=function(){n.model.MessageDescription="";n.model.dictAttributes.sfwMessageID!=undefined&&n.model.dictAttributes.sfwMessageID!=""&&hubMain.server.populateMessageList().done(function(t){t&&t.length>0&&n.$evalAsync(function(){var i=t.filter(function(t){return t.MessageID==n.model.dictAttributes.sfwMessageID});i&&i.length>0&&(n.model.MessageDescription=i[0].DisplayMessage)})})};n.PopulateBooleanValues=function(){n.lstBooleanValues.push("True");n.lstBooleanValues.push("False")};n.PopulateWizardSteps=function(){function r(t){var i=t.dictAttributes.Title;(t.dictAttributes.Title==undefined||t.dictAttributes.Title=="")&&(i=t.dictAttributes.ID);n.WizardStepNames.push({Code:t.dictAttributes.ID,Description:i})}var t,i;n.WizardStepNames=[];t=[];FindControlListByName(n.MainTable,"WizardSteps",t);t.length>0&&(i=t[0],i&&angular.forEach(i.Elements,r))};n.onRemoteObjectChanged=function(t){var i="srvCommon",r,f;n.formobject&&n.formobject.dictAttributes.sfwRemoteObject&&(i=n.formobject.dictAttributes.sfwRemoteObject);r=GetServerMethodObject(i,n.formobject.RemoteObjectCollection);f=GetObjectMethods(u.getEntityIntellisense(),n.formobject.dictAttributes.sfwEntity);n.lstServerMethod=PopulateServerMethod(f,n.model,r,t)};n.InitPDFCorrespondenceNavigationParam=function(){var t='"True"';n.model.dictAttributes.sfwNavigationParameter!=undefined&&n.model.dictAttributes.sfwNavigationParameter!=""&&(n.model.IsShowDownloadDialog=n.model.dictAttributes.sfwNavigationParameter.contains("sfwShowDownloadDialog="+t)?!0:!1,n.model.IsLaunchNewWindow=n.model.dictAttributes.sfwNavigationParameter.contains("sfwLaunchNewWindow="+t)?!0:!1)};n.onUserLogParametersClick=function(){var i=n.$new(!0);i.model=n.model;i.formobject=n.formobject;i.propertyName="sfwUserLogParameters";i.isFormLink=n.isformlink;i.CurrentTable=n.CurrentTable;i.UserLogParaDialog=t.showDialog(i,"Set User Log Parameters","Form/views/CustomAttributes.html",{width:800,height:525})};n.onSearchActiveFormClick=function(){};n.onAddMultipleActiveFormClick=function(){};n.onNavigationParamsClick=function(){var r,u,i,f,e;n.model.dictAttributes.sfwMethodName=="btnOpenDoc_Click"?(i=n.$new(!0),i.formobject=n.formobject,i.model=n.model,i.NavigationParameterOpenWordDialog=t.showDialog(i,"Navigation Parameter","Form/views/ParameterNavigationOpenWord.html",{width:800,height:500})):n.model.dictAttributes.sfwMethodName=="btnGridSearch_Click"?(i=n.$new(!0),i.selectedCurrentQuery=n.selectedCurrentQuery,i.SelectedObject=n.model,i.currentTable=n.CurrentTable,i.IsForm=!0,i.IsMultiActiveForm=!1,i.formobject=n.formobject,i.isFormLink=n.isformlink,i.dialog=t.showDialog(i,"Navigation Parameters","Form/views/NavParamGridSearch.html",{width:1e3,height:520})):n.model.dictAttributes.sfwMethodName=="btnOpenReport_Click"?(i=n.$new(!0),i.model=n.model,i.istrEntityName="",n.model.dictAttributes.sfwRelatedControl?(r=FindControlByID(n.formobject,n.model.dictAttributes.sfwRelatedControl),r&&r.dictAttributes.sfwEntityField&&(u=l.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,r.dictAttributes.sfwEntityField),u&&(i.istrEntityName=u.Entity))):n.formobject.dictAttributes.sfwEntity&&(i.istrEntityName=n.formobject.dictAttributes.sfwEntity),i.ParameterNavigationOpenReportDialog=t.showDialog(i,"Navigation Parameter","Form/views/ParameterNavigationOpenReport.html",{width:700,height:400})):(i=n.$new(!0),i.selectedCurrentQuery=n.selectedCurrentQuery,i.SelectedObject=n.model,i.IsForm=!0,i.IsMultiActiveForm=!1,i.formobject=n.formobject,i.isFormLink=n.isformlink,f=FindParent(i.SelectedObject,"sfwGridView"),f&&(i.ParentModel=f),e=FindParent(i.SelectedObject,"sfwListView"),e&&(i.ParentModel=e),i.NavigationParameterDialog=t.showDialog(i,"Navigation Parameters","Form/views/ParameterNavigation.html",{width:1e3,height:520}))};n.onTooltipNavigationParamsClick=function(){if(n.model.dictAttributes&&n.model.dictAttributes.sfwActiveForm){var i=n.$new(!0);i.formobject=n.formobject;i.SelectedObject=n.model;i.NavigationParameterDialog=t.showDialog(i,"Navigation Parameter","Form/views/ParameterNavigationForTooltipForm.html",{width:800,height:520})}else a.Message("Message","Please select active tooltip form")};n.onMessageIdClick=function(){};n.onWorkflowActivitesClick=function(){};n.onCheckedChanged=function(){if(n.model.dictAttributes.sfwMethodName=="btnPdfCorrespondence_Click"){var i='"True"',r="";n.model.IsLaunchNewWindow&&n.model.IsShowDownloadDialog?t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter",r,"sfwLaunchNewWindow="+i+";sfwShowDownloadDialog="+i):n.model.IsLaunchNewWindow&&!n.model.IsShowDownloadDialog?t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter",r,"sfwLaunchNewWindow="+i):!n.model.IsLaunchNewWindow&&n.model.IsShowDownloadDialog?t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter",r,"sfwShowDownloadDialog="+i):n.model.IsLaunchNewWindow||n.model.IsShowDownloadDialog||t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter",r,"")}};n.PopulateTextRelatedControl=function(){n.TextRelatedControls=[];PopulateTextRelatedControls(n.formobject,n.TextRelatedControls);n.TextRelatedControls.splice(0,0,"")};n.PopulateImageAlign=function(){n.lstImageAlign=[];n.lstImageAlign.push("NotSet");n.lstImageAlign.push("Left");n.lstImageAlign.push("Right");n.lstImageAlign.push("Baseline");n.lstImageAlign.push("Top");n.lstImageAlign.push("Middle");n.lstImageAlign.push("Bottom");n.lstImageAlign.push("AbsBottom");n.lstImageAlign.push("AbsMiddle");n.lstImageAlign.push("TextTop")};n.OnActiveFormValueChange=function(t){n.model.Name=="sfwImageButton"&&(n.model.dictAttributes.sfwActiveForm?(t&&(n.lstSelectedIndex=[],n.lstSelectedIndex.push(""),n.model.dictAttributes.sfwSelectedIndex=""),(!n.model.errors||n.model.errors.invalid_active_form)&&n.model.errors||$.connection.hubForm.server.getNewFormModel(n.model.dictAttributes.sfwActiveForm).done(function(t){n.receivenewformmodel(t)})):(n.lstSelectedIndex=[],n.lstSelectedIndex.push(""),n.model.dictAttributes.sfwSelectedIndex=""))};n.onActiveFormTypeChange=function(i){t.UndRedoBulkOp("Start");t.EditPropertyValue(n.IsMultiActiveForm,n,"IsMultiActiveForm",i);n.model.dictAttributes.sfwMethodName!="btnOpen_Click"||i||t.EditPropertyValue(n.model.dictAttributes.sfwEntityField,n.model.dictAttributes,"sfwEntityField","");t.EditPropertyValue(n.model.dictAttributes.sfwActiveForm,n.model.dictAttributes,"sfwActiveForm","");t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter","");n.model&&n.model.Name=="sfwLinkButton"&&n.model.dictAttributes.sfwMethodName=="btnOpen_Click"&&!i&&t.EditPropertyValue(n.model.dictAttributes.sfwActiveFormField,n.model.dictAttributes,"sfwActiveFormField","");t.UndRedoBulkOp("End")};n.receivenewformmodel=function(t){n.$apply(function(){var i;n.objActiveFormModel=t;n.objActiveFormModel&&(n.objActiveFormModel.dictAttributes.sfwType==="Lookup"?(i=n.objActiveFormModel.Elements.filter(function(n){return n.Name=="sfwTable"}),i&&i.length>0&&GetControlNames(i[0],n.lstSelectedIndex)):(i=n.objActiveFormModel.Elements.filter(function(n){return n.Name=="items"}),i&&i.length>0&&GetControlNames(i[0],n.lstSelectedIndex)))})};n.onRetrievalParametersClick=function(i){if(i.dictAttributes.sfwActiveForm){var r=n.$new(!0);r.model=i;r.formmodel=n.formobject;r.targetFormModel=n.objActiveFormModel;r.RetrievalButtonParaDialog=t.showDialog(r,"Retrieval Parameters","Form/views/RetrievalButtonParameters.html",{width:800,height:600})}else a.Message("Message","Target Form not present.")};n.LoadWebControlProperties=function(){var i,r;t.lstWebControls&&t.lstWebControls.length>0&&n.model&&(i=t.lstWebControls.filter(function(t){return t.ControlName==n.model.Name}),i=JSON.parse(JSON.stringify(i)),i&&i.length>0&&(n.IsAdvancedOpen&&(n.objAdvanceProperties={},n.objAdvanceProperties.isAccessibilityPropertiesExist=i[0].lstAccessibility&&i[0].lstAccessibility.length>0?!0:!1,n.objAdvanceProperties.isAppearancePropertiesExist=i[0].lstAppearance&&i[0].lstAppearance.length>0?!0:!1,n.objAdvanceProperties.isBehaviorPropertiesExist=i[0].lstBehavior&&i[0].lstBehavior.length>0?!0:!1,n.objAdvanceProperties.isCustomPropertiesExist=i[0].lstCustom&&i[0].lstCustom.length>0?!0:!1,n.objAdvanceProperties.isLayoutPropertiesExist=i[0].lstLayout&&i[0].lstLayout.length>0?!0:!1,n.objAdvanceProperties.isNavigationPropertiesExist=i[0].lstNavigation&&i[0].lstNavigation.length>0?!0:!1,n.objAdvanceProperties.isExtraPropertiesExist=i[0].lstExtra&&i[0].lstExtra.length>0?!0:!1,n.objAdvanceProperties.isMiscPropertiesExist=i[0].lstMisc&&i[0].lstMisc.length>0?!0:!1,n.objAdvanceProperties.lstAccessibility=i[0].lstAccessibility),n.SetDefaultValueToModel(i[0]),n.model.Name=="sfwLabel"&&"sfwIsCaption"in n.model.dictAttributes&&n.model.dictAttributes.sfwIsCaption&&(r=n.GetPropertyListByName(i[0],"sfwIsCaption"),r&&r.length>0&&(r[0].IsVisible=!1))));n.SetDataToWebControl()};n.SetDefaultValueToModel=function(t){function r(t){t.DefaultValue!=undefined&&t.DefaultValue!=""&&(n.model.dictAttributes[t.PropertyName]==undefined||n.model.dictAttributes[t.PropertyName]=="")&&n.model.dictAttributes[t.PropertyName]!=t.DefaultValue&&(n.model.dictAttributes[t.PropertyName]=t.DefaultValue)}var i=n.GetPropertyList(t,"Common");i&&i.length>0&&angular.forEach(i,r)};n.GetPropertyList=function(n){function t(n){i.push(n)}var i=[];return n&&(n.lstAccessibility&&angular.forEach(n.lstAccessibility,t),n.lstAppearance&&angular.forEach(n.lstAppearance,t),n.lstBehavior&&angular.forEach(n.lstBehavior,t),n.lstCustom&&angular.forEach(n.lstCustom,t),n.lstLayout&&angular.forEach(n.lstLayout,t),n.lstNavigation&&angular.forEach(n.lstNavigation,t),n.lstExtra&&angular.forEach(n.lstExtra,t),n.lstAutoComplete&&angular.forEach(n.lstAutoComplete,t),n.lstRetrieval&&angular.forEach(n.lstRetrieval,t)),i};n.GetPropertyListByName=function(n,t){function i(n){return n.PropertyName==t}function r(n){u.push(n)}var u=[],f,e,o,s,h,c,l,a,v,y;return n&&(n.lstAccessibility&&(f=n.lstAccessibility.filter(i),angular.forEach(f,r)),n.lstAppearance&&(e=n.lstAppearance.filter(i),angular.forEach(e,r)),n.lstBehavior&&(o=n.lstBehavior.filter(i),angular.forEach(o,r)),n.lstCustom&&(s=n.lstCustom.filter(i),angular.forEach(s,r)),n.lstLayout&&(h=n.lstLayout.filter(i),angular.forEach(h,r)),n.lstNavigation&&(c=n.lstNavigation.filter(i),angular.forEach(c,r)),n.lstExtra&&(l=n.lstExtra.filter(i),angular.forEach(l,r)),n.lstAutoComplete&&(a=n.lstAutoComplete.filter(i),angular.forEach(a,r)),n.lstRetrieval&&(v=n.lstRetrieval.filter(i),angular.forEach(v,r)),n.lstMisc&&(y=n.lstMisc.filter(i),angular.forEach(y,r))),u};n.SetDataToWebControl=function(){if(n.model){var i=t.lstWebControls.filter(function(t){return t.ControlName==n.model.Name});i=JSON.parse(JSON.stringify(i));n.ClearWebControlPropertyValue(i[0]);function r(t,i){var r=n.GetPropertyListByName(n.objAdvanceProperties,i);r&&r.length>0&&(r[0].PropertyValue=t)}angular.forEach(n.model.dictAttributes,r)}};n.ClearWebControlPropertyValue=function(n){function t(n){n.PropertyValue!=n.DefaultValue&&(n.PropertyValue="")}n&&(n.lstAccessibility&&angular.forEach(n.lstAccessibility,t),n.lstAppearance&&angular.forEach(n.lstAppearance,t),n.lstBehavior&&angular.forEach(n.lstBehavior,t),n.lstCustom&&angular.forEach(n.lstCustom,t),n.lstLayout&&angular.forEach(n.lstLayout,t),n.lstNavigation&&angular.forEach(n.lstNavigation,t),n.lstExtra&&angular.forEach(n.lstExtra,t),n.lstAutoComplete&&angular.forEach(n.lstAutoComplete,t),n.lstRetrieval&&angular.forEach(n.lstRetrieval,t),n.lstMisc&&angular.forEach(n.lstMisc,t))};n.onWebControlPropdbClick=function(i){if(i.lstValues&&i.lstValues.length>0){var r=i.lstValues.indexOf(i.PropertyValue);r==i.lstValues.length-1&&(r=-1);t.UndRedoBulkOp("Start");t.EditPropertyValue(i.PropertyValue,i,"PropertyValue",i.lstValues[r+1]);n.onWebControlPropValueChange(i);t.UndRedoBulkOp("End")}event&&event.stopPropagation()};n.onWebControlPropValueChange=function(i){i&&(i.DefaultValue&&(n.model.dictAttributes[i.PropertyName]=i.DefaultValue),t.EditPropertyValue(n.model.dictAttributes[i.PropertyName],n.model.dictAttributes,i.PropertyName,i.PropertyValue))};n.onWebControlValueChange=function(i){i&&t.EditPropertyValue(n.model.dictAttributes[i.key],n.model.dictAttributes,i.key,i.val)};n.DeletePropertyFromModel=function(i){var r,f,u;n.model&&i&&(t.UndRedoBulkOp("Start"),r=t.lstWebControls.filter(function(t){return t.ControlName==n.model.Name}),r=JSON.parse(JSON.stringify(r)),f="",r&&r.length>0&&(u=n.GetPropertyListByName(r[0],i.PropertyName),u&&u.length>0&&(f=u[0].DefaultValue)),t.EditPropertyValue(n.model.dictAttributes[i.PropertyName],n.model.dictAttributes,i.PropertyName,f),t.DeleteItem(i,n.dictAttributesArray),n.model.UcChild&&t.EditPropertyValue(n.model.UcChild,n.model,"UcChild",[]),t.UndRedoBulkOp("End"))};n.visibleRuleTextChanged=function(t){var i=[],u=$(t.target),r;n.formobject&&n.formobject.objExtraData&&(r=n.formobject.dictAttributes.sfwType=="Wizard"?!0:!1,i=PopulateEntityRules(n.formobject.objExtraData,r,n.formobject.dictAttributes.sfwInitialLoadGroup),setSingleLevelAutoComplete(u,i))};n.RetrievalMethodInputChange=function(){n.lstColumns=[];t.UndRedoBulkOp("Start");n.model&&n.model.Name=="sfwCascadingDropDownList"?t.EditPropertyValue(n.model.dictAttributes.sfwCascadingRetrievalParameters,n.model.dictAttributes,"sfwCascadingRetrievalParameters",""):t.EditPropertyValue(n.model.dictAttributes.sfwParameters,n.model.dictAttributes,"sfwParameters","");t.EditPropertyValue(n.model.dictAttributes.sfwRetrievalControls,n.model.dictAttributes,"sfwRetrievalControls","");t.EditPropertyValue(n.model.dictAttributes.sfwClientVisibilitySource,n.model.dictAttributes,"sfwClientVisibilitySource","");t.UndRedoBulkOp("End")};n.RetrievalQueryInputChange=function(i){var f,s,e,a;if(n.lstColumns=[],n.model.dictAttributes.sfwRetrievalQuery&&(f=n.model.dictAttributes.sfwRetrievalQuery.split("."),f&&f.length==2)){var h=f[0],c=f[1],l=u.getEntityIntellisense(),o=r("filter")(l,{ID:h},!0);o&&o.length>0&&(s=o[0],e=s.Queries.filter(function(n){return n.ID==c}),e&&e.length>0&&(a=e[0],$.connection.hubForm.server.getEntityQueryColumns(n.model.dictAttributes.sfwRetrievalQuery,"ScopeId_"+n.$id).done(function(t){n.$evalAsync(function(){t.splice(0,0,{CodeID:"",Description:""});n.lstColumns=t})})))}i||(t.UndRedoBulkOp("Start"),n.model&&n.model.Name=="sfwCascadingDropDownList"?t.EditPropertyValue(n.model.dictAttributes.sfwCascadingRetrievalParameters,n.model.dictAttributes,"sfwCascadingRetrievalParameters",""):t.EditPropertyValue(n.model.dictAttributes.sfwParameters,n.model.dictAttributes,"sfwParameters",""),t.EditPropertyValue(n.model.dictAttributes.sfwRetrievalControls,n.model.dictAttributes,"sfwRetrievalControls",""),t.EditPropertyValue(n.model.dictAttributes.sfwClientVisibilitySource,n.model.dictAttributes,"sfwClientVisibilitySource",""),t.UndRedoBulkOp("End"))};n.RetrievalMethodChange=function(i){n.lstColumns=[];t.UndRedoBulkOp("Start");n.model.retrievalType=="Method"&&(t.EditPropertyValue(n.model.dictAttributes.sfwRetrievalQuery,n.model.dictAttributes,"sfwRetrievalQuery",""),i==!0&&(n.model&&n.model.Name=="sfwCascadingDropDownList"?t.EditPropertyValue(n.model.dictAttributes.sfwCascadingRetrievalParameters,n.model.dictAttributes,"sfwCascadingRetrievalParameters",""):t.EditPropertyValue(n.model.dictAttributes.sfwParameters,n.model.dictAttributes,"sfwParameters",""),t.EditPropertyValue(n.model.dictAttributes.sfwRetrievalControls,n.model.dictAttributes,"sfwRetrievalControls",""),t.EditPropertyValue(n.model.dictAttributes.sfwClientVisibilitySource,n.model.dictAttributes,"sfwClientVisibilitySource","")),t.UndRedoBulkOp("End"))};n.model&&n.model.dictAttributes.sfwRetrievalMethod?(n.model.retrievalType="Method",n.RetrievalMethodChange(!1)):n.model&&(n.model.retrievalType="Query");n.getParameterRet_dialog=function(){var i=n.$new(!0),f,v,s,p,r,e,h,d,o;if(i.model={},angular.copy(n.model,i.model),i.formobject={},angular.copy(n.formobject,i.formobject),n.model.Name=="sfwCascadingDropDownList"?n.model.dictAttributes.sfwCascadingRetrievalParameters!=undefined&&(i.strSelectedParameters=n.model.dictAttributes.sfwCascadingRetrievalParameters):n.model.dictAttributes.sfwParameters!=undefined&&(i.strSelectedParameters=n.model.dictAttributes.sfwParameters),n.model.retrievalType=="Query"&&n.model.dictAttributes.sfwRetrievalQuery&&(f=n.model.dictAttributes.sfwRetrievalQuery.split("."),f&&f.length==2)){var w=f[0],b=f[1],k=u.getEntityIntellisense(),a=k.filter(function(n){return n.ID==w});a&&a.length>0&&(v=a[0],s=v.Queries.filter(function(n){return n.ID==b}),s&&s.length>0&&(p=s[0],i.selectedCurrentQuery=p))}if(n.model.retrievalType=="Method"&&(n.lstMethods=[],r=[],n.model.IsChildOfGrid?(e=FindParent(n.model,"sfwGridView"),e==null&&(e=FindParent(n.model,"sfwListView")),e&&(h=l.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,e.dictAttributes.sfwEntityField),h&&h.Entity&&(r=c.GetIntellisenseData(h.Entity,"","",!0,!1,!0,!1,!1,!1)))):r=c.GetIntellisenseData(n.formobject.dictAttributes.sfwEntity,"","",!0,!1,!0,!1,!1,!1),d=[],r&&n.model.dictAttributes.sfwRetrievalMethod))for(o=0;o<r.length;o++)r[o].ID==n.model.dictAttributes.sfwRetrievalMethod&&(i.selectedCurrentQuery=r[o]);i.objNewDialog=t.showDialog(i,"Retrieval Parameters","Form/views/RetrievalParameters.html",{width:700,height:500});i.$on("onRetrievalParameterClick",function(i,r){n.model.Name=="sfwCascadingDropDownList"?(t.EditPropertyValue(n.model.dictAttributes.sfwCascadingRetrievalParameters,n.model.dictAttributes,"sfwCascadingRetrievalParameters",r),y(n.model.dictAttributes.sfwCascadingRetrievalParameters,"sfwCascadingRetrievalParameters")):(t.EditPropertyValue(n.model.dictAttributes.sfwParameters,n.model.dictAttributes,"sfwParameters",r),y(n.model.dictAttributes.sfwParameters,"sfwParameters"));i.stopPropagation()})};n.$on("onRetrievalParameterClick",function(i,r){n.model.Name=="sfwCascadingDropDownList"?(t.EditPropertyValue(n.model.dictAttributes.sfwCascadingRetrievalParameters,n.model.dictAttributes,"sfwCascadingRetrievalParameters",r),y(n.model.dictAttributes.sfwCascadingRetrievalParameters,"sfwCascadingRetrievalParameters")):(t.EditPropertyValue(n.model.dictAttributes.sfwParameters,n.model.dictAttributes,"sfwParameters",r),y(n.model.dictAttributes.sfwParameters,"sfwParameters"));i.stopPropagation()});n.parameterList=[];y=function(t,i){$.connection.hubForm.server.getGlobleParameters().done(function(r){n.$evalAsync(function(){r?(angular.forEach(r.Elements,function(t){if(t&&t.dictAttributes.ID){var i="~"+t.dictAttributes.ID;n.parameterList.push(i)}}),n.validateParameters(t,i)):n.validateParameters(t,i)})})};g=function(t){angular.forEach(t.Elements,function(t){t&&t.dictAttributes.ID&&n.parameterList.push(t.dictAttributes.ID);t.Elements.length>0&&g(t)})};n.validateParameters=function(t,i){var r,u,s,f,h,e;if(g(n.formobject),r="prop-",i=="sfwAutoParameters"?r="autoprop-":i=="sfwCascadingRetrievalParameters"&&(r="cprop-"),angular.isObject(n.model.errors))for(u in n.model.errors)u&&u.startsWith(r)&&delete n.model.errors[u];if(t)for(s=t.split(";"),f=0;f<s.length;f++)h=s[f].split("="),e=h[h.length-1],o.checkValidListValue(n.parameterList,n.model,e,i,r+e,"parameter value("+e+") does not exists",null)};n.LoadClientVisibilitySource=function(){function i(t){if(t.indexOf("=")>0){var i=t.substring(t.indexOf("=")+1);n.lstColumns.push({CodeID:i,Description:i})}}if(n.model&&n.model.retrievalType&&n.model.retrievalType=="Method"&&(n.lstColumns=[],n.lstColumns.push({CodeID:"",Description:""}),n.model&&n.model.dictAttributes&&n.model.dictAttributes.sfwRetrievalControls)){var t=n.model.dictAttributes.sfwRetrievalControls.split(";");t&&t.length>0&&angular.forEach(t,i)}};p=function(){return{setnewScope:function(){dialogScope=n.$new(!0)},loadDialog:function(){var i=n.$new(!0);n.model.dictAttributes.sfwRetrievalControls!=undefined&&(i.strSelectedRetrievalControls=n.model.dictAttributes.sfwRetrievalControls);i.model={};angular.copy(n.model,i.model);i.formobject={};angular.copy(n.formobject,i.formobject);i.IsRetrievalQuery=!0;i.OnOkClick=function(){n.LoadClientVisibilitySource()};i.RetrievalControlsDialog=t.showDialog(i,"Retrieval Controls","Form/views/RetrievalControls.html",{width:700,height:500})},afterDialog:function(i){t.EditPropertyValue(n.model.dictAttributes.sfwRetrievalControls,n.model.dictAttributes,"sfwRetrievalControls",i);dialogScope.$destroy()}}}();n.getRetrievalControl_dialog=function(){p.setnewScope();p.loadDialog()};n.$on("onRetrievalControlClick",function(n,t){p.afterDialog(t)});n.RetrievalQueryChange=function(){n.lstColumns=[];n.model.retrievalType=="Query"&&(t.UndRedoBulkOp("Start"),t.EditPropertyValue(n.model.dictAttributes.sfwRetrievalMethod,n.model.dictAttributes,"sfwRetrievalMethod",""),n.model&&n.model.Name=="sfwCascadingDropDownList"?t.EditPropertyValue(n.model.dictAttributes.sfwCascadingRetrievalParameters,n.model.dictAttributes,"sfwCascadingRetrievalParameters",""):t.EditPropertyValue(n.model.dictAttributes.sfwParameters,n.model.dictAttributes,"sfwParameters",""),t.EditPropertyValue(n.model.dictAttributes.sfwRetrievalControls,n.model.dictAttributes,"sfwRetrievalControls",""),t.EditPropertyValue(n.model.dictAttributes.sfwClientVisibilitySource,n.model.dictAttributes,"sfwClientVisibilitySource",""),t.UndRedoBulkOp("End"))};n.model&&n.model.Name=="sfwTextBox"&&(n.model.dictAttributes.sfwAutoMinLength==undefined||n.model.dictAttributes.sfwAutoMinLength=="")&&(n.model.dictAttributes.sfwAutoMinLength="3");n.model&&n.model.Name=="sfwTextBox"&&(n.model.dictAttributes.sfwDelay==undefined||n.model.dictAttributes.sfwDelay=="")&&(n.model.dictAttributes.sfwDelay="1000");w=function(){return{setnewScope:function(){dialogScope=n.$new(!0)},loadDialog:function(){n.model.dictAttributes.sfwAutoQuery!=undefined&&(dialogScope.strSelectedQuery=n.model.dictAttributes.sfwAutoQuery);dialogScope.IsAutoComplete=!0;dialogScope.QueryDialog=t.showDialog(dialogScope,"Browse For Query","Form/views/BrowseForQuery.html",{width:1e3,height:700})},afterDialog:function(i){t.EditPropertyValue(n.model.dictAttributes.sfwAutoQuery,n.model.dictAttributes,"sfwAutoQuery",i);dialogScope.$destroy()}}}();n.AutoCompleteQueryChange=function(){t.UndRedoBulkOp("Start");t.EditPropertyValue(n.model.dictAttributes.sfwAutoParameters,n.model.dictAttributes,"sfwAutoParameters","");t.EditPropertyValue(n.model.dictAttributes.sfwAutoColumns,n.model.dictAttributes,"sfwAutoColumns","");t.EditPropertyValue(n.model.dictAttributes.sfwAutoFillMapping,n.model.dictAttributes,"sfwAutoFillMapping","");t.UndRedoBulkOp("End")};n.getQueryParameter_dialog=function(){w.setnewScope();w.loadDialog()};n.$on("onAutoCompleteClick",function(n,t){w.afterDialog(t)});n.getParameter_dialog=function(){var i=n.$new(!0),r;i.model={};angular.copy(n.model,i.model);i.formobject={};angular.copy(n.formobject,i.formobject);i.IsAutoComplete=!0;i.FormType=n.formobject.dictAttributes.sfwType;n.model&&n.model.dictAttributes.sfwAutoParameters!=undefined&&(i.strSelectedParameters=n.model.dictAttributes.sfwAutoParameters);n.model.autocompleteType==="Query"&&n.model.dictAttributes.sfwAutoQuery?i.selectedCurrentQuery=u.getQueryByQueryName(n.model.dictAttributes.sfwAutoQuery):n.model.autocompleteType==="Method"&&n.model.dictAttributes.sfwAutoMethod&&(r=c.GetIntellisenseData(n.entityName,null,null,!0,!1,!0,!1,!1,!1),r=r.filter(function(t){return t.ID.toLowerCase()===n.model.dictAttributes.sfwAutoMethod.toLowerCase()}),r&&r.length&&(i.selectedMethod=r[0]));i.objNewDialog=t.showDialog(i,"AutoComplete Parameter","Form/views/AutoCompleteParameter.html",{width:800,height:500})};n.$on("onAutoCompleteParameterClick",function(i,r){t.EditPropertyValue(n.model.dictAttributes.sfwAutoParameters,n.model.dictAttributes,"sfwAutoParameters",r);y(n.model.dictAttributes.sfwAutoParameters,"sfwAutoParameters")});b=function(){return{setnewScope:function(){dialogScope=n.$new(!0)},loadDialog:function(){var i=n.$new(!0);n.model.dictAttributes.sfwAutoFillMapping!=undefined&&(i.strSelectedRetrievalControls=n.model.dictAttributes.sfwAutoFillMapping);i.model={};angular.copy(n.model,i.model);i.formobject={};angular.copy(n.formobject,i.formobject);i.IsAutoComplete=!0;i.RetrievalControlsDialog=t.showDialog(i,"Auto Complete Control Mapping","Form/views/RetrievalControls.html",{width:700,height:500})},afterDialog:function(i){t.EditPropertyValue(n.model.dictAttributes.sfwAutoFillMapping,n.model.dictAttributes,"sfwAutoFillMapping",i);dialogScope.$destroy()}}}();n.getRetrievalControlMethod_dialog=function(){b.setnewScope();b.loadDialog()};n.$on("onAutoCompletelControlClick",function(n,t){b.afterDialog(t)});k=function(){return{setnewScope:function(){dialogScope=n.$new(!0)},loadDialog:function(){var i=n.$new(!0);n.model&&n.model.dictAttributes.sfwAutoColumns!=undefined&&(i.strSelectedAutoColumns=n.model.dictAttributes.sfwAutoColumns);i.model={};angular.copy(n.model,i.model);i.formobject={};angular.copy(n.formobject,i.formobject);i.IsAutoComplete=!0;i.entityName=n.entityName;i.AutoCompleteColumnDialog=t.showDialog(i,"AutoComplete Columns","Form/views/AutoCompleteColumns.html",{width:1e3,height:500})},afterDialog:function(i){t.EditPropertyValue(n.model.dictAttributes.sfwAutoColumns,n.model.dictAttributes,"sfwAutoColumns",i);dialogScope.$destroy()}}}();n.getColumns_dialog=function(){k.setnewScope();k.loadDialog()};n.$on("onAutoCompletelColumnsClick",function(n,t){k.afterDialog(t)});n.okClick=function(){n.model&&n.model.dictAttributes.sfwAutoMinLength=="3"&&(n.model.dictAttributes.sfwAutoMinLength="");n.model&&n.model.dictAttributes.sfwDelay=="1000"&&(n.model.dictAttributes.sfwDelay="");n.onCancelClick()};n.autocompleteMethodInputChange=function(){n.lstColumns=[];t.UndRedoBulkOp("Start");t.EditPropertyValue(n.model.dictAttributes.sfwAutoParameters,n.model.dictAttributes,"sfwAutoParameters","");t.EditPropertyValue(n.model.dictAttributes.sfwAutoColumns,n.model.dictAttributes,"sfwAutoColumns","");t.EditPropertyValue(n.model.dictAttributes.sfwAutoFillMapping,n.model.dictAttributes,"sfwAutoFillMapping","");t.UndRedoBulkOp("End")};n.onAutocompleteMethodChange=function(t){if(n.lstColumns=[],n.model.autocompleteType=="Method"){if(t)n.onAutocompleteChange(n.model.autocompleteType);n.model.dictAttributes.sfwAutoQuery=""}};n.onAutocompleteQueryChange=function(t){if(n.lstColumns=[],n.model.autocompleteType=="Query"){if(t)n.onAutocompleteChange(n.model.autocompleteType);n.model.dictAttributes.sfwAutoMethod=""}};n.onAutocompleteChange=function(i,r){r===undefined&&(r=!0);r?(t.UndRedoBulkOp("Start"),i==="Query"?t.EditPropertyValue(n.model.dictAttributes.sfwRetrievalMethod,n.model.dictAttributes,"sfwAutoMethod",""):i==="Method"&&t.EditPropertyValue(n.model.dictAttributes.sfwRetrievalQuery,n.model.dictAttributes,"sfwAutoQuery",""),t.EditPropertyValue(n.model.dictAttributes.sfwAutoParameters,n.model.dictAttributes,"sfwAutoParameters",""),t.EditPropertyValue(n.model.dictAttributes.sfwAutoColumns,n.model.dictAttributes,"sfwAutoColumns",""),t.EditPropertyValue(n.model.dictAttributes.sfwAutoFillMapping,n.model.dictAttributes,"sfwAutoFillMapping",""),t.UndRedoBulkOp("End")):(i==="Query"?n.model.dictAttributes.sfwRetrievalMethod="":i==="Method"&&(n.model.dictAttributes.sfwRetrievalQuery=""),n.model.dictAttributes.sfwAutoParameters="",n.model.dictAttributes.sfwAutoColumns="",n.model.dictAttributes.sfwAutoFillMapping="")};nt=!0;n.getGroupList=function(){n.lstGroupList=[];n.formobject.objExtraData&&n.formobject.objExtraData.lstGroupsList[0]&&(n.lstGroupList=n.formobject.objExtraData.lstGroupsList[0].Elements);n.lstGroupList.splice(0,0,{dictAttributes:{ID:""}})};n.setEntityName=function(){var r,i,t;n.formobject&&n.formobject.SelectedControl&&n.formobject.SelectedControl.IsGridChildOfListView?n.model&&n.model.Name=="sfwGridView"?(r=FindParent(n.model,"sfwListView"),r&&(t=l.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,r.dictAttributes.sfwEntityField),t&&(n.entityName=t.Entity))):n.entityName=n.entityTreeName:n.model&&n.model.dictAttributes.sfwRelatedGrid?(i=FindControlByID(n.formobject,n.model.dictAttributes.sfwRelatedGrid),i&&i.dictAttributes.sfwEntityField?(t=l.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,i.dictAttributes.sfwEntityField),t&&(n.entityName=t.Entity)):n.entityName=""):n.formobject&&n.model&&n.model.IsChildOfGrid?n.entityName=v.getEntityName(n.formobject,n.model):n.formobject&&n.model&&n.model.dictAttributes.sfwEntityField&&n.model.dictAttributes.sfwEntityField.indexOf(".")>-1?(t=l.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,n.model.dictAttributes.sfwEntityField),t&&t.Entity&&(n.entityName=t.Entity)):n.entityName=n.entityTreeName};it=n.$watch("model",rt);n.IsShowModePropertyVisible=function(){n.IsShowModeProperty=n.model&&n.model.Name!="sfwLiteral"&&n.model.Name!="RequiredFieldValidator"&&n.model.Name!="CompareValidator"&&n.model.Name!="sfwSoftErrors"&&n.model.Name!="TemplateField"&&n.model.Name!="sfwColumn"&&n.model.Name!="sfwPanel"&&n.model.Name!="sfwRuleViewer"?n.model.Name=="sfwTable"||!n.IsLookup&&n.model&&(n.model.Name=="sfwLabel"||n.model.Name=="sfwDropDownList"||n.model.Name=="sfwCascadingDropDownList"||n.model.Name=="sfwMultiSelectDropDownList"||n.model.Name=="sfwCheckBox"||n.model.Name=="sfwRadioButton"||n.model.Name=="sfwTextBox"||n.model.Name=="sfwTargetList"||n.model.Name=="sfwListPicker"||n.model.Name=="sfwSourceList"||n.model.Name=="sfwMultiCorrespondence"||n.model.Name=="sfwOpenDetail"||n.model.Name=="sfwDateTimePicker")||n.model.Name=="RangeValidator"||n.model.Name=="ValidationSummary"||n.model.Name=="RegularExpressionValidator"||n.model.Name=="sfwCheckBoxList"||n.model.Name=="sfwRadioButtonList"||n.model.Name=="sfwButton"||n.model.Name=="sfwLinkButton"||n.model.Name=="sfwCommandButton"||n.model.Name=="sfwSlider"||n.model.Name=="sfwKnob"||n.model.Name=="sfwJSONData"||n.model.Name=="sfwButtonGroup"?!0:!1:!1};n.IsShowVisibleRulePropertyVisible=function(){n.IsShowVisibleRuleProperty=n.IsReport?!1:n.IsCorrespondence&&n.model&&n.model.Name!="sfwColumn"?!0:n.IsLookup?n.model.IsChildOfGrid&&n.objGridView?!0:!1:n.model&&n.model.Name!="sfwLiteral"&&n.model.Name!="RequiredFieldValidator"&&n.model.Name!="CompareValidator"&&n.model.Name!="sfwSoftErrors"&&n.model.Name!="TemplateField"&&n.model.Name!="sfwWizard"&&n.model.Name!="udc"&&n.model.Name!="sfwRuleViewer"&&n.model.Name!="TemplateField"?n.model.Name=="sfwTable"||n.model&&n.model.Name!="sfwColumn"&&n.model.Name!="hr"&&n.model.Name!="br"&&n.model.Name!="sfwCRViewer"&&n.model.Name!="sfwFileLayout"&&n.model.Name!="sfwFileUpload"&&n.model.Name!="sfwTabContainer"&&n.model.Name!="sfwWizardProgress"||n.model.Name=="RangeValidator"||n.model.Name=="ValidationSummary"||n.model.Name=="RegularExpressionValidator"||n.model.Name=="sfwTabSheet"||n.model.Name=="sfwCheckBoxList"||n.model.Name=="sfwRadioButtonList"||n.model.Name=="sfwHyperLink"||n.model.Name=="sfwTable"||n.model.Name=="sfwGridView"?n.model.IsChildOfGrid&&n.objGridView?!0:!0:!1:!1};n.IsShowResourcePropertyVisible=function(){n.IsShowResourceProperty=!1;n.IsLookup||n.model&&!n.model.IsChildOfGrid&&n.model&&n.model.Name!="sfwLiteral"&&n.model.Name!="RequiredFieldValidator"&&n.model.Name!="CompareValidator"&&n.model.Name!="sfwSoftErrors"&&n.model.Name!="TemplateField"&&n.model.Name!="sfwWizard"&&n.model.Name!="sfwColumn"&&n.model.Name!="sfwRuleViewer"&&(n.model.Name=="sfwTable"||n.model&&n.model.Name!="hr"&&n.model.Name!="br"&&n.model.Name!="sfwCRViewer"&&n.model.Name!="sfwFileLayout"&&n.model.Name!="sfwFileUpload"&&n.model.Name!="sfwTabContainer"&&n.model.Name!="sfwWizardProgress"||n.model.Name=="RangeValidator"||n.model.Name=="ValidationSummary"||n.model.Name=="RegularExpressionValidator"||n.model.Name=="sfwTabSheet"||n.model.Name=="sfwCheckBoxList"||n.model.Name=="sfwRadioButtonList"||n.model.Name=="sfwHyperLink"||n.model.Name=="sfwPanel"||n.model.Name=="sfwTable"||n.model.Name=="sfwGridView"||!n.IsLookup&&n.model.Name=="sfwDateTimePicker")&&(n.IsShowResourceProperty=!0)};n.IsShowCssClassPropertyVisible=function(){n.IsShowCssClassProperty=n.model&&n.model.Name!="hr"&&n.model.Name!="sfwToolTipButton"&&n.model.Name!="br"&&n.model.Name!="TemplateField"&&n.model.Name!="sfwTable"&&n.model.Name!="sfwGridView"&&n.model.Name!="udc"&&n.model.Name!="sfwRuleViewer"&&n.model.Name!="sfwJSONData"?!0:!1};n.IsShowCustomAttributePropertyVisible=function(){n.IsShowCustomAttributeProperty=n.IsReport?n.model&&["sfwDropDownList","sfwImageButton","sfwCascadingDropDownList","sfwRadioButtonList"].indexOf(n.model.Name)>-1?!0:!1:n.IsCorrespondence?!0:!0};n.onUserControlTextChange=function(){if(n.model.dictAttributes.Name&&n.model.errors&&!n.model.errors.invalid_active_form){var t=[],i={FileName:n.model.dictAttributes.Name,ID:n.model.dictAttributes.ID};t.push(i);$.connection.hubForm.server.getUserControlModel(t,"").done(function(n){var t=getCurrentFileScope();t.receiveUcMainTable(n)})}else n.model.UcChild=[]};n.lstChartType=t.ChartTypes;n.Enable3DChnage=function(t){!n.Area3D&&(t||t=="True")&&(n.Area3D={dictAttributes:{IsEnable3D:"True",LightStyle:"",Inclination:""},Elements:[],Children:[],Name:"Area3DStyle",Value:""});t&&t!="False"||(n.Area3D.dictAttributes.LightStyle="",n.Area3D.dictAttributes.Inclination="")};n.removeSeriescolumnValues=function(i){var u,r,f;if(n.model.dictAttributes.sfwIsDynamicSeries=="False")for(u=0;u<i.Elements.length;u++)if(i.Elements[u].Name=="Series"){if(r=i.Elements[u],r&&r.Elements.length>0){for(t.UndRedoBulkOp("Start"),f=0;f<r.Elements.length;f++)t.EditPropertyValue(r.Elements[f].dictAttributes.sfwSeriesColumnName,r.Elements[f].dictAttributes,"sfwSeriesColumnName","");t.UndRedoBulkOp("End")}break}};n.onChartTypeChanged=function(){n.model.dictAttributes.ChartType&&(n.model.dictAttributes.ChartType=="Donut"||n.model.dictAttributes.ChartType=="Pie")&&(n.model.dictAttributes.sfwIsDynamicSeries="False",n.removeSeriescolumnValues(n.model))};n.setSeriesClick=function(){var i=n.$new(),u,r,f;for(n.model.dictAttributes.sfwEntityField&&n.formobject.dictAttributes.sfwEntity&&(u=l.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,n.model.dictAttributes.sfwEntityField),u&&(i.ParentEntityName=u.Entity)),i.ChartModel=n.model,i.lstToolTipTypes=["None","Chart","Table","Both"],i.DataFormats=["","{0:d}","{0:C}","{0:000-##-####}","{0:(###)###-####}"],r=0;r<n.model.Elements.length;r++)n.model.Elements[r].Name=="Series"&&(i.chartSeries=n.model.Elements[r],i.chartSeries.Elements.length>0&&(i.ObjSeriesModel=i.chartSeries.Elements[0],i.ObjSeriesModel.dictAttributes.ChartType=n.model.dictAttributes.ChartType));f=t.showDialog(i,"Series Properties","Form/views/SeriesProperties.html",{width:1e3,height:720});i.onOkClick=function(){var r,t,u,e,s;for(n.model.hasOwnProperty("errors")||(n.model.errors={}),n.model.errors.series_errors={},r=0;r<i.chartSeries.Elements.length;r++)if(t=i.chartSeries.Elements[r],t.errors&&!angular.equals({},t.errors))for(u in t.errors)n.model.errors.series_errors.hasOwnProperty(u)||(n.model.errors.series_errors[u+"_"+t.dictAttributes.Name]=t.errors[u]);angular.equals({},n.model.errors.series_errors)&&(e=Object.keys(n.model.errors),s=e.length,n.model.errors.hasOwnProperty("series_errors")&&s==1&&o.checkValidListValue([],n.model,"","series_errors","series_errors","",undefined),delete n.model.errors.series_errors);f.close()};i.selectSeries=function(t){i.ObjSeriesModel=t;i.ObjSeriesModel.dictAttributes.ChartType=n.model.dictAttributes.ChartType};i.validateSeriesNameNotEmpty=function(){if(i.strError=null,i.chartSeries&&i.chartSeries.Elements)for(var n=0;n<i.chartSeries.Elements.length;n++)if(!i.chartSeries.Elements[n].dictAttributes.Name){i.strError="Error: Please enter a Series Name.";break}};i.addSeries=function(){i.chartSeries||(i.chartSeries={dictAttributes:{},Elements:[],Children:[],Name:"Series",Value:""});var u=GetNewSeriesName("Series",i.chartSeries,1),r={dictAttributes:{Name:u,ChartType:n.model.dictAttributes.ChartType},Elements:[],Children:[],Name:"sfwSeries",Value:"",prefix:"swc"};t.PushItem(r,i.chartSeries.Elements);i.selectSeries(r)};i.deleteSeries=function(){var n=-1,r;if(i.ObjSeriesModel)for(r=0;r<i.chartSeries.Elements.length;r++)if(i.chartSeries.Elements[r]==i.ObjSeriesModel){n=r;break}n>-1&&(t.DeleteItem(i.chartSeries.Elements[n],i.chartSeries.Elements),i.ObjSeriesModel=i.chartSeries.Elements.length>0?n>0?i.chartSeries.Elements[n-1]:i.chartSeries.Elements[i.chartSeries.Elements.length-1]:undefined)};i.validateSeriesNameNotEmpty();i.onNavigationParamsClick=function(){var r=i.$new();r.SelectedObject=i.ObjSeriesModel;r.IsForm=!0;r.IsMultiActiveForm=!1;r.formobject=n.formobject;r.NavigationParameterDialog=t.showDialog(r,"Navigation Parameters","Form/views/ParameterNavigation.html",{width:1e3,height:520})};i.onAdditionalChartColumnClick=function(){var r=i.$new(),u,f,e;if(r.sfwAddtionalChartColumns=[],r.SelectedObject=i.ObjSeriesModel,u="",n.model.dictAttributes.sfwEntityField&&n.formobject.dictAttributes.sfwEntity&&(u=l.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,n.model.dictAttributes.sfwEntityField)),u&&(r.ParentEntityName=u.Entity),i.ObjSeriesModel.dictAttributes.swfAddtionalChartColumns)for(u=i.ObjSeriesModel.dictAttributes.swfAddtionalChartColumns.split(","),f=0;f<u.length;f++)r.sfwAddtionalChartColumns.push({Property:u[f]});e=t.showDialog(r,"Multiple Objects Selection","Form/views/AdditionalChartColumnsDialog.html",{width:1e3,height:490});r.onCancelClick=function(){e.close()};r.onOkClick=function(){for(var u="",n=0;n<r.sfwAddtionalChartColumns.length;n++)r.sfwAddtionalChartColumns[n].Property!=""&&(u==""?u=r.sfwAddtionalChartColumns[n].Property:u+=","+r.sfwAddtionalChartColumns[n].Property);t.EditPropertyValue(i.ObjSeriesModel.dictAttributes.swfAddtionalChartColumns,i.ObjSeriesModel.dictAttributes,"swfAddtionalChartColumns",u);e.close()};r.selectRow=function(n){r.selectedRow=n};r.addProperty=function(){r.sfwAddtionalChartColumns.push({Property:""})};r.deleteProperty=function(){var n=-1,t;if(r.selectedRow)for(t=0;t<r.sfwAddtionalChartColumns.length;t++)if(r.selectedRow==r.sfwAddtionalChartColumns[t]){n=t;break}n>-1&&(r.sfwAddtionalChartColumns.splice(n,1),r.selectedRow=r.sfwAddtionalChartColumns.length>0?n>0?r.sfwAddtionalChartColumns[n-1]:r.sfwAddtionalChartColumns[r.sfwAddtionalChartColumns.length-1]:undefined)}};i.ClearParameter=function(){i.ObjSeriesModel&&i.ObjSeriesModel.dictAttributes&&(i.ObjSeriesModel.dictAttributes.sfwNavigationParameter="")};i.NavigateToActiveForm=function(n){n&&n!=""&&(i.onOkClick(),e.hubMain.server.navigateToFile(n,"").done(function(n){t.openFile(n,!1)}))};i.OpenTooltipParams=function(){var n=i.$new();i.objTooltipParamsVM=t.showDialog(n,"Set Tooltip Parameters","Form/views/SetToolTipParameters.html",{width:500,height:420});n.onSfxChartTooltipTableCancelClick=function(){i.objTooltipParamsVM&&i.objTooltipParamsVM.close()};n.onSfxChartTooltipTableOKClick=function(){function o(n){var t=n.ID;e&&(t=e+"."+t);r=r?r+";"+t:t}var u=[],f,e,r;u=GetSelectedFieldList(i.ObjSeriesModel.lstselectedobjecttreefields,u);f=getDisplayedEntity(i.ObjSeriesModel.LstDisplayedEntities);e="";f&&f.strDisplayName!=""&&(e=f.strDisplayName);u.length>0&&(angular.forEach(u,o),t.EditPropertyValue(i.ObjSeriesModel.dictAttributes.sfwTooltipTableParams,i.ObjSeriesModel.dictAttributes,"sfwTooltipTableParams",r));n.onSfxChartTooltipTableCancelClick()}}};n.selectQueryClick=function(n){if(n&&n!=""&&n.contains(".")){var t=n.split(".");f.NavigateToFile(t[0],"queries",t[1])}};n.NavigateToEntityQueryFromDetailQueryID=function(t){var r,i,u;t&&n.IsLookup&&n.IsSearchCriteriaSelected&&n.formobject&&n.formobject.Elements&&(r=n.formobject.Elements.filter(function(n){return n.Name&&n.Name=="initialload"}),r&&r.length>0&&r[0].Elements&&(i=r[0].Elements.filter(function(n){return n.dictAttributes&&n.dictAttributes.ID==t}),i&&i.length>0&&i[0].dictAttributes.sfwQueryRef&&i[0].dictAttributes.sfwQueryRef.contains(".")&&(u=i[0].dictAttributes.sfwQueryRef.split("."),f.NavigateToFile(u[0],"queries",u[1]))))};n.selectMethodClick=function(t){t&&t!=""&&f.NavigateToFile(n.formobject.dictAttributes.sfwEntity,"objectmethods",t)};n.selectExpressionClick=function(t){t&&t!=""&&f.NavigateToFile(n.formobject.dictAttributes.sfwEntity,"attributes",t)};n.selectGroupClick=function(t){t&&t!=""&&f.NavigateToFile(n.formobject.dictAttributes.sfwEntity,"groupslist",t)};n.NavigateToRuleClick=function(n){n&&n!=""&&e.hubMain.server.navigateToFile(n,"").done(function(n){t.openFile(n,!1)})};n.NavigateToActiveForm=function(i,r){if(i&&i!=""){if(i.contains("=")){var f=i.split(";"),u=f[0].split("=");u&&u.length>1&&(i=u[1])}t.IsLoading=!0;e.hubMain.server.navigateToFile(i,"").done(function(i){n.$evalAsync(function(){t.IsLoading=!1;t.openFile(i,undefined)})})}else r&&r!=""&&(t.IsLoading=!0,e.hubMain.server.navigateToFile(r,"").done(function(i){n.$evalAsync(function(){t.IsLoading=!1;t.openFile(i,!1)})}))};n.ClickCommonPropsPanels=function(t){n.SelectedTab=t;t=="General"?(n.IsGeneralOpen||(n.IsGeneralOpen=!0),n.setEntityName&&n.setEntityName()):t=="Advanced"?n.IsAdvancedOpen?n.SetDataToWebControl():(n.IsAdvancedOpen=!0,n.LoadWebControlProperties()):t=="Configured"&&(n.dictAttributesArray=[],n.ConvertTodictAttributesArray(),n.IsConfiguredOpen||(n.IsConfiguredOpen=!0))};n.ConvertTodictAttributesArray=function(){var r=[],i;n.model&&(i=t.lstWebControls.filter(function(t){return t.ControlName==n.model.Name}),i=JSON.parse(JSON.stringify(i)),angular.forEach(n.model.dictAttributes,function(t,u){var f,e;t&&(f=[],i&&i.length>0&&(f=n.GetPropertyListByName(i[0],u)),(!f||f&&f.length==0||f&&f.length>0&&f[0].DefaultValue!=t)&&(e={PropertyName:u,PropertyValue:t},f&&f.length>0&&(e.lstValues=f[0].lstValues),e.PropertyName!="runat"&&r.push(e)))}),n.dictAttributesArray=r)};n.ClickCommonAdvPropsPanels=function(r){var f,u;n.model&&(f=t.lstWebControls.filter(function(t){return t.ControlName==n.model.Name}),f=JSON.parse(JSON.stringify(f)),f&&f.length>0&&(u=$(i).find("[advance-property-table]"),r=="Accessibility"?($(u).find("[header-properties-row][category='Accessibility'] td").toggleClass("prop-close"),$(u).find("tr[category='Accessibility ']:not([header-properties-row])").toggle()):r=="Appearance"?($(u).find("[header-properties-row][category='Appearance'] td").toggleClass("prop-close"),$(u).find("tr[category='Appearance ']:not([header-properties-row])").toggle(),n.objAdvanceProperties.lstAppearance==undefined&&(n.objAdvanceProperties.lstAppearance=f[0].lstAppearance)):r=="Behaviour"?($(u).find("[header-properties-row][category='Behaviour'] td").toggleClass("prop-close"),$(u).find("tr[category='Behaviour ']:not([header-properties-row])").toggle(),n.objAdvanceProperties.lstBehavior==undefined&&(n.objAdvanceProperties.lstBehavior=f[0].lstBehavior)):r=="Custom"?($(u).find("[header-properties-row][category='Custom'] td").toggleClass("prop-close"),$(u).find("tr[category='Custom ']:not([header-properties-row])").toggle(),n.objAdvanceProperties.lstCustom==undefined&&(n.objAdvanceProperties.lstCustom=f[0].lstCustom)):r=="Layout"?($(u).find("[header-properties-row][category='Layout'] td").toggleClass("prop-close"),$(u).find("tr[category='Layout ']:not([header-properties-row])").toggle(),n.objAdvanceProperties.lstLayout==undefined&&(n.objAdvanceProperties.lstLayout=f[0].lstLayout)):r=="Navigation"?($(u).find("[header-properties-row][category='Navigation'] td").toggleClass("prop-close"),$(u).find("tr[category='Navigation ']:not([header-properties-row])").toggle(),n.objAdvanceProperties.lstNavigation==undefined&&(n.objAdvanceProperties.lstNavigation=f[0].lstNavigation)):r=="Extra"?($(u).find("[header-properties-row][category='Extra'] td").toggleClass("prop-close"),$(u).find("tr[category='Extra ']:not([header-properties-row])").toggle(),n.objAdvanceProperties.lstExtra==undefined&&(n.objAdvanceProperties.lstExtra=f[0].lstExtra)):r=="Misc"&&($(u).find("[header-properties-row][category='Misc'] td").toggleClass("prop-close"),$(u).find("tr[category='Misc ']:not([header-properties-row])").toggle(),n.objAdvanceProperties.lstMisc==undefined&&(n.objAdvanceProperties.lstMisc=f[0].lstMisc)),n.SetDataToWebControl()))};n.selectActiveFormClick=function(n){n&&e.hubMain.server.navigateToFile(n,"").done(function(n){t.openFile(n,!1)})};n.onCorrespondenceQueryIDKeyDown=function(t){var i=$(t.target);n.queryIdInput=i;t&&t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE&&$(i).data("ui-autocomplete")?($(i).autocomplete("search",$(i).val()),t.preventDefault()):tt(i)};n.showBookMarksQueryIDIntellisenseList=function(t){var i;i=$(t.target).prevAll("input[type='text']");n.queryIdInput=i;i.focus();i&&(tt(i),$(i).data("ui-autocomplete")&&$(i).autocomplete("search",$(i).val()));t&&t.stopPropagation()};tt=function(t){var i=getQueryBookMarksID(n.formobject);n.queryIdList=i;i&&i.length>0&&setSingleLevelAutoComplete(t,i)};n.validateId=function(t){n.$parent&&n.$parent.validationErrorList&&(t.hasOwnProperty("IsChildOfGrid")&&t.IsChildOfGrid?o.validateID(t,n.$parent.validationErrorList,t.dictAttributes.ID,!0):t.Name!="sfwTable"&&o.validateID(t,n.$parent.validationErrorList,t.dictAttributes.ID))};n.validateDuplicateId=function(){if(n.$parent&&n.$parent.iterateModel){var t;n.$parent.formTableModel?t=n.$parent.formTableModel:n.$parent.objQueryForm&&(t=n.$parent.objQueryForm);n.$parent.iterateModel(t)}};n.NavigateToEntityField=function(i,r,e){var w,nt,ut,g,s,v,d,ft,tt,et,b,y,k,a,it,rt,c,h;if(i&&n.model){var o=i.split("."),p=[],st=u.getEntityIntellisense(),ot=st,s="",y=null;if(n.model.Name=="TemplateField"&&(y=FindParent(n.model,"sfwGridView")),n.model.Name=="sfwGridView"||n.model.Name=="sfwListView"||n.model.Name=="sfwChart"||y&&y.Name=="sfwGridView")k=FindParent(n.model,"sfwListView"),a=y?y:n.model,k?(c=l.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,k.dictAttributes.sfwEntityField),c&&(it=l.GetEntityFieldObjectFromEntityField(c.Entity,a.dictAttributes.sfwEntityField),it&&(s=c.Entity))):a.dictAttributes.sfwParentGrid&&n.model.Name=="TemplateField"?s=n.entityName:a.dictAttributes.sfwParentGrid&&a.dictAttributes.sfwEntityField?(rt=FindControlByID(n.formobject,a.dictAttributes.sfwParentGrid),c=l.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,rt.dictAttributes.sfwEntityField),c&&(s=c.Entity)):s=n.formobject.dictAttributes.sfwEntity;else if(r)s=r;else if((n.model.Name=="sfwButton"||n.model.Name=="sfwLinkButton")&&n.model.dictAttributes.sfwMethodName&&n.model.dictAttributes.sfwMethodName=="btnOpen_Click"&&n.model.dictAttributes.sfwRelatedControl)if(w=GetFieldFromFormObject(n.formobject,"sfwGridView","ID",n.model.dictAttributes.sfwRelatedControl),w&&w.length>0&&w[0].dictAttributes.sfwEntityField&&n.formobject.dictAttributes.sfwEntity){for(nt=n.formobject.dictAttributes.sfwEntity,ut=[];nt;)v=ot.filter(function(n){return n.ID==nt}),v.length>0?(d=v[0].Attributes,ut=ut.concat(d),nt=v[0].ParentId):nt="";w[0].dictAttributes.sfwEntityField&&(w[0].dictAttributes.sfwEntityField=="InternalErrors"||w[0].dictAttributes.sfwEntityField=="ExternalErrors")?(s="entError",r=s):(h=ut.filter(function(n){return n.ID==w[0].dictAttributes.sfwEntityField}),h&&h.length>0&&h[0].Entity&&(s=h[0].Entity,r=s))}else n.formobject.dictAttributes.sfwEntity&&(s=n.formobject.dictAttributes.sfwEntity);else s=n.entityName;while(s)v=ot.filter(function(n){return n.ID==s}),v.length>0?(d=v[0].Attributes,ft=getFilteredAttribute(n.model.Name,d,o.length>1,e),p=p.concat(ft),s=v[0].ParentId):s="";if(o.length>1)for(g=0;g<o.length-1;g++)if(h=p.filter(function(n){return n.ID==o[g]}),h.length>0&&typeof h[0].DataType!="undefined"&&(h[0].DataType=="Object"||h[0].DataType=="Collection"||h[0].DataType=="CDOCollection"||h[0].DataType=="List")&&typeof h[0].Entity!="undefined")for(s=h[0].Entity,g<o.length-2&&(p=[]);s;)v=ot.filter(function(n){return n.ID==s}),v.length>0?(d=v[0].Attributes,ft=getFilteredAttribute(n.model.Name,d,g<o.length-2,e),p=p.concat(ft),s=v[0].ParentId):s="";p&&p.length>0&&(tt=p.filter(function(n){return n.ID==o[o.length-1]}),tt&&tt.length>0&&(et=o[o.length-1],tt[0].Type&&tt[0].Type=="Description"&&o[o.length-1]&&o[o.length-1].toLowerCase().endsWith("description")&&(et=o[o.length-1].substr(0,o[o.length-1].length-11)+"Value"),o.length==1?(b="",y=null,n.model.Name=="TemplateField"&&(y=FindParent(n.model,"sfwGridView")),n.model.Name=="sfwGridView"||n.model.Name=="sfwListView"||n.model.Name=="sfwChart"||y&&y.Name=="sfwGridView"?(k=FindParent(n.model,"sfwListView"),a=y?y:n.model,k?(c=l.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,k.dictAttributes.sfwEntityField),c&&(it=l.GetEntityFieldObjectFromEntityField(c.Entity,a.dictAttributes.sfwEntityField),it&&(b=c.Entity))):a.dictAttributes.sfwParentGrid&&n.model.Name=="TemplateField"?b=n.entityName:a.dictAttributes.sfwParentGrid&&a.dictAttributes.sfwEntityField?(rt=FindControlByID(n.formobject,a.dictAttributes.sfwParentGrid),c=l.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,rt.dictAttributes.sfwEntityField),c&&(b=c.Entity)):b=n.formobject.dictAttributes.sfwEntity):b=r?r:n.entityName,t.IsLoading=!0,b&&f.NavigateToFile(b,"attributes",et)):o.length>1&&(h=p.filter(function(n){return n.ID==o[o.length-2]}),h&&h!=""&&h[0].Entity&&(t.IsLoading=!0,f.NavigateToFile(h[0].Entity,"attributes",et)))))}};n.setDefaultValueForCheckBoxList=function(){var i=n.$new(),r;i.selectAll=!1;i.lstValues=[];i.checkBoxListDefaultValueSelectAllChange=function(n){i.lstValues.length>0&&angular.forEach(i.lstValues,function(t){t.selected=n})};i.selectDefaultValueCheckBox=function(){if(n.model.dictAttributes.sfwDefaultValue&&n.model.dictAttributes.sfwDefaultValue=="FW_CHECKALL")i.selectAll=!0,i.checkBoxListDefaultValueSelectAllChange(!0);else if(n.model.dictAttributes.sfwDefaultValue&&i.lstValues&&i.lstValues.length>0){var t=n.model.dictAttributes.sfwDefaultValue.split(";");angular.forEach(t,function(n){for(var t=0;t<i.lstValues.length;t++)i.lstValues[t].CodeValue===n&&(i.lstValues[t].selected=!0)})}};n.model.dictAttributes.sfwLoadType=="CodeGroup"?(r="",n.model.dictAttributes.sfwLoadSource&&n.model.dictAttributes.sfwLoadType=="CodeGroup"?r=n.model.dictAttributes.sfwLoadSource:n.model.placeHolder&&(r=n.model.placeHolder),r&&(t.IsLoading=!0,$.connection.hubMain.server.getCodeValuesForDropDown(r).done(function(r){n.$evalAsync(function(){t.IsLoading=!1;r&&r.length>0&&(i.lstValues=r,i.selectDefaultValueCheckBox())})}))):n.model.dictAttributes.sfwLoadType=="Items"&&n.model.Elements.length>0&&(angular.forEach(n.model.Elements,function(n){var t={CodeValue:"",Description:""};n.dictAttributes.Value&&(t.CodeValue=n.dictAttributes.Value);n.dictAttributes.Text&&(t.Description=n.dictAttributes.Text);i.lstValues.push(t)}),i.selectDefaultValueCheckBox());dialog=t.showDialog(i,"CheckBoxList Default Values","Form/views/SetDefaultValueForCheckBoxList.html");i.checkBoxListDefaultValueOkClick=function(){t.UndRedoBulkOp("Start");var r="";n.model.dictAttributes.sfwDefaultValue="";i.selectAll?r="FW_CHECKALL":i.lstValues&&i.lstValues.length>0&&angular.forEach(i.lstValues,function(n){n.selected&&n.CodeValue&&(r?r+=";"+n.CodeValue:r=n.CodeValue)});t.EditPropertyValue(n.model.dictAttributes.sfwDefaultValue,n.model.dictAttributes,"sfwDefaultValue",r);t.UndRedoBulkOp("End");i.closeDialog()};i.closeDialog=function(){dialog.close()}};n.onchangeOfEntityField=function(){var t=getCurrentFileScope();t&&t.selectControl&&t.selectControl(n.model,event)};n.ClearSelectColVisibleRule=function(){n.model.dictAttributes.sfwSelectColVisibleRule&&n.model.dictAttributes.sfwSelection!="Many"&&n.model.dictAttributes.sfwSelection!="One"&&t.EditPropertyValue(n.model.dictAttributes.sfwSelectColVisibleRule,n.model.dictAttributes,"sfwSelectColVisibleRule","")};n.onChangeOfParentGrid=function(){var t=getCurrentFileScope();t&&t.selectControl&&(n.model&&n.model.dictAttributes.sfwEntityField&&(n.model.dictAttributes.sfwEntityField=null),t.selectControl(n.model,event))};n.onChangeOfMethodType=function(i){t.UndRedoBulkOp("Start");n.showRules=!1;n.showObjectMethod=!1;n.showXmlMethod=!1;i=="ObjectMethod"?(n.showObjectMethod=!0,n.Title="Object Method"):i=="XmlMethod"?(n.showXmlMethod=!0,n.Title="Xml Method"):i=="Rule"&&(n.showRules=!0,n.Title="Rule");n.model.dictAttributes.sfwObjectMethod="";n.model.dictAttributes.sfwNavigationParameter="";t.UndRedoBulkOp("End")};n.setQueryParametersForOpenDetail=function(){var i=n.$new(),r,u,f,e,o;if(i.Elements=[],r=n.model.Elements.filter(function(n){return n.Name=="Parameters"}),r&&r.length>0&&r[0]&&r[0].Elements&&r[0].Elements.length>0)for(u=0;u<r[0].Elements.length;u++)f={},angular.copy(r[0].Elements[u],f),i.Elements.push(f);i.entityTreeBinding={selectedobject:null,lstselectedobjects:[],lstentities:[]};n.model.dictAttributes.sfwRelatedControl&&(e=FindControlByID(n.formobject,n.model.dictAttributes.sfwRelatedControl),e&&(o=l.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,e.dictAttributes.sfwEntityField),o&&(i.FormEntity=o.Entity)));i.FormEntity||(i.FormEntity=n.formobject.dictAttributes.sfwEntity);i.onOkClick=function(){if(i.Elements&&i.Elements.length>0){if(t.UndRedoBulkOp("Start"),r&&r.length>0){t.EditPropertyValue(r[0].Elements,r[0],"Elements",[]);for(var n=0;n<i.Elements.length;n++)t.PushItem(i.Elements[n],r[0].Elements)}t.UndRedoBulkOp("End")}i.dialog.close()};i.onParameterSelected=function(n){i.SelectedParameter=n};i.dialog=t.showDialog(i,"Base Query Parameters","Form/views/ControlProperties/GridBaseQueryParameter.html",{width:800,height:525})};n.updateOpenDetailQueryParameters=function(){var i,r,f,o,e,s,h;if(t.UndRedoBulkOp("Start"),i=n.model.Elements.filter(function(n){return n.Name==="Parameters"})[0],n.model.dictAttributes.sfwQueryID){if(i||(i={Name:"Parameters",dictAttributes:{},Elements:[]},t.PushItem(i,n.model.Elements)),t.EditPropertyValue(i.Elements,i,"Elements",[]),r=u.getQueryByQueryName(n.model.dictAttributes.sfwQueryID),r)for(f=0,o=r.Parameters.length;f<o;f++)e=r.Parameters[f],s={Name:"Parameter",dictAttributes:{ID:e.ID,sfwDataType:e.DataType},Elements:[]},t.PushItem(s,i.Elements)}else i&&(h=n.model.Elements.indexOf(i),h>-1&&t.DeleteItem(i,n.model.Elements));t.UndRedoBulkOp("End")};n.onTextModeChanged=function(){if(n.model.dictAttributes.TextMode==="MultiLine"){var i=["None","RichText"];i.indexOf(n.model.dictAttributes.sfwRenderType)===-1&&t.EditPropertyValue(n.model.dictAttributes.sfwRenderType,n.model.dictAttributes,"sfwRenderType","None");t.EditPropertyValue(n.renderTypes,n,"renderTypes",i)}else n.model.dictAttributes.TextMode==="SingleLine"?t.EditPropertyValue(n.renderTypes,n,"renderTypes",["None","RichText","Rating","NumSpinner"]):n.model.dictAttributes.sfwRenderType!=="None"&&t.EditPropertyValue(n.model.dictAttributes.sfwRenderType,n.model.dictAttributes,"sfwRenderType","None")};n.onRenderTypeChange=function(i){t.UndRedoBulkOp("Start");switch(i){case"None":case"RichText":t.EditPropertyValue(n.model.dictAttributes.RatingFullStar,n.model.dictAttributes,"RatingFullStar","True");t.EditPropertyValue(n.model.dictAttributes.RatingNormalFill,n.model.dictAttributes,"RatingNormalFill","");t.EditPropertyValue(n.model.dictAttributes.RatingRatedFill,n.model.dictAttributes,"RatingRatedFill","");t.EditPropertyValue(n.model.dictAttributes.RatingStarWidth,n.model.dictAttributes,"RatingStarWidth","");t.EditPropertyValue(n.model.dictAttributes.sfwMinValue,n.model.dictAttributes,"sfwMinValue","");t.EditPropertyValue(n.model.dictAttributes.sfwMaxValue,n.model.dictAttributes,"sfwMaxValue","");break;case"Rating":t.EditPropertyValue(n.model.dictAttributes.sfwMinValue,n.model.dictAttributes,"sfwMinValue","");t.EditPropertyValue(n.model.dictAttributes.sfwMaxValue,n.model.dictAttributes,"sfwMaxValue","");break;case"NumSpinner":t.EditPropertyValue(n.model.dictAttributes.RatingFullStar,n.model.dictAttributes,"RatingFullStar","True");t.EditPropertyValue(n.model.dictAttributes.RatingNormalFill,n.model.dictAttributes,"RatingNormalFill","");t.EditPropertyValue(n.model.dictAttributes.RatingRatedFill,n.model.dictAttributes,"RatingRatedFill","");t.EditPropertyValue(n.model.dictAttributes.RatingStarWidth,n.model.dictAttributes,"RatingStarWidth","")}t.UndRedoBulkOp("End")}},templateUrl:"Form/views/ControlProperties/ControlCommonProperties.html"}}]);app.service("share",[function(){return{}}]);app.directive("addcontroltemplate",["$compile","$rootScope","ngDialog","$EntityIntellisenseFactory","$GetEntityFieldObjectService","$ValidationService",function(n,t,i,r,u,f){var e=function(n,t){var i="";return n=="Lookup"&&t||n=="Correspondence"||(i+="<span ng-click='OnAddControlToCellClick(\"sfwLabel\")'>Label<\/span>"),n=="Tooltip"&&(i+="<span ng-click='OnAddControlToCellClick(\"Panel\")'>Panel<\/span>"),i+="<span ng-click='OnAddControlToCellClick(\"Caption\")'>Caption<\/span>",n!="Report"&&n!="Correspondence"&&n!="Tooltip"&&n!="Lookup"&&(i+="<span ng-click='OnAddControlToCellClick(\"sfwHyperLink\")'>HyperLink<\/span>"),n!="Correspondence"&&n!="Tooltip"&&(i+="<span ng-click='OnAddControlToCellClick(\"sfwLiteral\")'>Literal<\/span>"),n!="Tooltip"&&(i+="<span ng-click='OnAddControlToCellClick(\"sfwTextBox\")'>TextBox<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"sfwDropDownList\")'>DropDownList<\/span>",n!="Report"&&n!="Correspondence"&&(i+="<span ng-click='OnAddControlToCellClick(\"sfwMultiSelectDropDownList\")'>MultiSelectDropDownList<\/span>"),i+="<span ng-click='OnAddControlToCellClick(\"sfwCheckBox\")'>CheckBox<\/span>",n!="Lookup"&&(i+="<span ng-click='OnAddControlToCellClick(\"sfwCheckBoxList\")'>CheckBoxList<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"sfwRadioButtonList\")'>RadioButton List<\/span>")),n=="Report"&&(i+="<span ng-click='OnAddControlToCellClick(\"sfwCascadingDropDownList\")'>CascadingDropDownList<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"sfwRadioButton\")'>Radio Button<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"sfwImageButton\")'>Retrieve Button<\/span>"),n!="Report"&&n!="Correspondence"&&n!="Tooltip"&&(i+="<span ng-click='OnAddControlToCellClick(\"sfwButton\")'>Button<\/span>"),n=="Correspondence"&&(i+="<span ng-click='OnAddControlToCellClick(\"sfwRadioButton\")'>Radio Button<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"Panel\")'>Panel<\/span>"),n!="Correspondence"&&n!="Tooltip"&&(i+="<span ng-click='OnAddControlToCellClick(\"RequiredFieldValidator\")'>RequiredFieldValidator<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"CompareValidator\")'>CompareValidator<\/span>"),n=="Lookup"?i+="<span ng-click='OnAddControlToCellClick(\"sfwUserDefaults\")'>User Defaults<\/span>":n!="Report"&&n!="Correspondence"&&n!="Tooltip"&&(i+="<span ng-click='OnAddControlToCellClick(\"sfwCRViewer\")'>CR Viwer<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"sfwFileLayout\")'>File Layout<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"sfwFileUpload\")'>File Upload<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"sfwSoftErrors\")'>Soft Errors<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"sfwEmployerSoftErrors\")'>Employer Soft Errors<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"sfwRadioButton\")'>Radio Button<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"Panel\")'>Panel<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"sfwListPicker\")'>List Picker<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"sfwSourceList\")'>Source List<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"sfwTargetList\")'>Target List<\/span>"),n!="Report"&&n!="Correspondence"&&n!="Tooltip"&&(i+="<span ng-click='OnAddControlToCellClick(\"hr\")'>Horizontal Rule<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"br\")'>Break<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"sfwCascadingDropDownList\")'>CascadingDropDownList<\/span>",n!="Lookup"&&(i+="<span ng-click='OnAddControlToCellClick(\"sfwMultiCorrespondence\")'>Multi Correspondence<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"DialogPanel\")'>Dialog Panel<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"sfwImage\")'>Image<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"sfwOpenDetail\")'>Open Detail<\/span>")),n=="Wizard"&&(i+="<span ng-click='OnAddControlToCellClick(\"sfwCommandButton\")'>Command Button<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"sfwWizardProgress\")'>Wizard Progress<\/span>"),n!="Report"&&n!="Correspondence"&&n!="Tooltip"&&n!="Lookup"&&(i+="<span ng-click='OnAddControlToCellClick(\"TabContainer\")'>Tab Container<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"sfwListBox\")'>ListBox<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"RangeValidator\")'>Range Validator<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"RegularExpressionValidator\")'>Regular Expression Validator<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"ValidationSummary\")'>Validation Summary<\/span>"),n!="Report"&&n!="Correspondence"&&n!="Tooltip"&&(n!="Lookup"&&(i+=n!="UserControl"?"<span ng-click='OnAddControlToCellClick(\"UserControl\")'>UserControl<\/span>":"",i+="<span ng-click='OnAddControlToCellClick(\"sfwRuleViewer\")'>RuleViewer<\/span>"),i+="<span ng-click='OnAddControlToCellClick(\"sfwSwitchCheckBox\")'>SwitchCheckBox<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"sfwSlider\")'>Slider<\/span>",i+="<span ng-click='OnAddControlToCellClick(\"sfwKnob\")'>Knob<\/span>"),n!="Report"&&n!="Lookup"&&n!="Correspondence"&&n!="Tooltip"&&(i+="<span ng-click='OnAddControlToCellClick(\"sfwQuestionnairePanel\")'>Questionnaire Panel<\/span>"),n!="Report"&&n!="Correspondence"&&n!="Tooltip"&&(i+="<span ng-click='OnAddControlToCellClick(\"sfwDateTimePicker\")'>DateTime Picker<\/span>"),n!="Report"&&n!="Correspondence"&&n!="Lookup"&&n!="Tooltip"&&(i+="<span ng-click='OnAddControlToCellClick(\"sfwJSONData\")'>JSON Data<\/span>"),i+"<span ng-click='OnAddControlToCellClick(\"sfwButtonGroup\")'>Button Group<\/span>"};return{restrict:"A",replace:!0,scope:{item:"=",formodel:"="},link:function(i,o){var s,h,c;angular.isArray(i.item.Elements)&&(s=i.formodel.dictAttributes.sfwType,h=i.formodel.IsLookupCriteriaEnabled,o.html(e(s,h)),n(o.contents())(i));i.objRepeaterControl;i.OnAddControlToCellClick=function(n){var f,u,e,o,r;n&&($(".plusicon").remove(),f=n,f=="sfwButton"?(u=i.$new(!0),u.item=i.item,u.formodel=i.formodel,u.CreateButtonDialog=t.showDialog(u,"Button Details","Form/views/CreateButtonWizard/CreateButtonControl.html",{width:660,height:550})):f=="sfwListView"?(e=CreateControlID(i.formodel,"RepeaterViewPanel","sfwListView"),o="swc",i.objRepeaterControl={Name:"sfwListView",value:"",prefix:o,dictAttributes:{ID:e},Elements:[],Children:[]},i.ParentEntityName=formodel.dictAttributes.sfwEntity,i.objRepeaterControl.selectedobjecttreefield,i.objRepeaterControl.lstselectedobjecttreefields=[],r=i.$new(!0),r.objRepeaterControl=i.objRepeaterControl,r.objRepeaterControl.LstDisplayedEntities=[],r.ParentEntityName=i.ParentEntityName,r.RepeaterControldialog=t.showDialog(r,"Repeater Control","Form/views/RepeaterControlTemplate.html",{width:500,height:600})):i.AddControlToCell(f))};i.onRepeaterControlOkClick=function(){var o,h,s,c,l,a,f,e,v,u,n;i.objRepeaterControl&&(i.objRepeaterControl.dictAttributes.sfwSelection="Many",i.objRepeaterControl.dictAttributes.sfwCaption="List View",i.objRepeaterControl.dictAttributes.AllowPaging="True",i.objRepeaterControl.dictAttributes.PageSize="1",o=i.objRepeaterControl.selectedobjecttreefield,o&&(h=getDisplayedEntity(i.objRepeaterControl.LstDisplayedEntities),s=h.strDisplayName,fieldName=o.ID,s!=""&&(fieldName=s+"."+o.ID),c=fieldName,i.objRepeaterControl.dictAttributes.sfwEntityField=c,l=o.Entity,a=r.getEntityIntellisense(),i.objRepeaterControl.dictAttributes.sfwDataKeyNames=GetTableKeyFields(l,a)),f="swc",e={Name:"sfwTable",value:"",prefix:f,dictAttributes:{},Elements:[],Children:[]},e.ParentVM=i.objRepeaterControl,v=CreateControlID(i.formodel,"NewPage","sfwTable"),e.dictAttributes.ID=v,u={Name:"sfwRow",value:"",prefix:f,dictAttributes:{},Elements:[],Children:[]},u.ParentVM=e,n={Name:"sfwColumn",value:"",prefix:f,dictAttributes:{},Elements:[],Children:[]},n.ParentVM=u,u.Elements.push(n),n={Name:"sfwColumn",value:"",prefix:f,dictAttributes:{},Elements:[],Children:[]},n.ParentVM=u,u.Elements.push(n),n={Name:"sfwColumn",value:"",prefix:f,dictAttributes:{},Elements:[],Children:[]},n.ParentVM=u,u.Elements.push(n),n={Name:"sfwColumn",value:"",prefix:f,dictAttributes:{},Elements:[],Children:[]},n.ParentVM=u,u.Elements.push(n),e.Elements.push(u),i.objRepeaterControl.Elements.push(e),i.objRepeaterControl.initialvisibilty=!0,i.objRepeaterControl.isLoaded=!0,t.PushItem(i.objRepeaterControl,i.dropdata.Elements));i.onRepeaterControlCancelClick()};i.onRepeaterControlCancelClick=function(){c.close()};i.AddControlToCell=function(n,r){var e,o;r||(r=CreateControl(i.formodel,i.item,n));r!=null&&r.Name!="udc"&&((r.Name=="sfwDialogPanel"||r.Name=="sfwPanel")&&(r.initialvisibilty=!0,r.isLoaded=!0),t.PushItem(r,i.item.Elements),SetFormSelectedControl(i.formodel,r));r!=undefined&&r.Name=="udc"&&(e=i.$new(),e.formodel=i.formodel,e.objSetUCProp={StrId:r.dictAttributes.ID,StrName:"",StrEntityField:"",StrResource:""},e.objSetUCProp.IsAddedFromObjectTree=!1,e.onUserControlOkClick=function(){if(r.dictAttributes.ID=e.objSetUCProp.StrId,r.dictAttributes.Name=e.objSetUCProp.StrName,r.dictAttributes.sfwEntityField=i.formodel.dictAttributes.sfwEntity!=undefined&&i.formodel.dictAttributes.sfwEntity!=""&&e.objSetUCProp.StrEntityField!=undefined&&e.objSetUCProp.StrEntityField!=""?e.objSetUCProp.StrEntityField.match("^"+i.formodel.dictAttributes.sfwEntity)?i.formodel.dictAttributes.sfwEntity+"."+e.objSetUCProp.StrEntityField:e.objSetUCProp.StrEntityField:e.objSetUCProp.StrEntityField,r.dictAttributes.sfwResource=e.objSetUCProp.StrResource,r.dictAttributes.Name!=undefined&&r.dictAttributes.Name!=""){var n=[],u={FileName:r.dictAttributes.Name,ID:r.dictAttributes.ID};n.push(u);$.connection.hubForm.server.getUserControlModel(n,"").done(function(n){var t=getCurrentFileScope();t.receiveUcMainTable(n)})}t.PushItem(r,i.item.Elements);e.onUserControlCancelClick()},e.onUserControlCancelClick=function(){var n=getCurrentFileScope();n&&n.validationErrorList&&f.removeObjInToArray(n.validationErrorList,e.objSetUCProp);o&&o.close()},e.ValidateUserProp=function(){var n=!1,t,r;return e.ErrorMessageForDisplay="",e.objSetUCProp.StrId==undefined||e.objSetUCProp.StrId==""?(e.ErrorMessageForDisplay="Error: Enter the ID.",n=!0):(t=[],CheckforDuplicateID(i.formodel,e.objSetUCProp.StrId,t),t.length>0?(e.ErrorMessageForDisplay="Error: Duplicate ID.",n=!0):isValidIdentifier(e.objSetUCProp.StrId,!1,!1)||(e.ErrorMessageForDisplay="Error: Invalid ID.",n=!0)),e.objSetUCProp.StrName&&e.objSetUCProp.StrName!=""?e.objSetUCProp.StrResource&&e.objSetUCProp.StrResource!=""||(e.ErrorMessageForDisplay="Please Enter Resource.",n=!0):(e.ErrorMessageForDisplay="Please Enter Active Form.",n=!0),(e.ErrorMessageForDisplay==undefined||e.ErrorMessageForDisplay=="")&&e.objSetUCProp.StrEntityField!=undefined&&e.objSetUCProp.StrEntityField!=""&&(r=u.GetEntityFieldObjectFromEntityField(e.formodel.dictAttributes.sfwEntity,e.objSetUCProp.StrEntityField),r&&r.Type=="Object"||(e.ErrorMessageForDisplay="Entity Field should be Object.",n=!0)),e.objSetUCProp.errors&&f.isEmptyObj(e.objSetUCProp.errors)&&(n=!0),n},o=t.showDialog(e,"User Control","Form/views/SetUserControlProperties.html"))}}}}]);app.directive("newbuttoncommonproptemplate",[function(){return{restrict:"A",replace:!0,scope:!1,templateUrl:"Form/views/CreateButtonWizard/NewButtonCommonProperties.html"}}]);app.directive("navigationparamtreetemplatefornewbutton",[function(){return{restrict:"A",replace:!0,scope:!1,templateUrl:"Form/views/CreateButtonWizard/NavigationParamTreeForNewButton.html"}}]);app.directive("controlistchildtreetemplate",["$compile",function(){return{restrict:"A",replace:!0,scope:!1,templateUrl:"Form/views/ClientVisibilityChildTree.html"}}]);app.directive("customattributetreetemplate",[function(){return{restrict:"A",replace:!0,scope:!1,templateUrl:"Common/views/CustomAttributeTreeTemplate.html"}}]);app.directive("commonparametertree",[function(){return{restrict:"A",replace:!0,scope:!1,templateUrl:"Form/views/CommonParameterTree.html"}}]);app.directive("clientvisibilitychildtree",[function(){return{restrict:"A",replace:!0,scope:!1,template:function(){var n="<div>";return n+='<ul ng-if="field.Items.length > 0" ng-show="field.IsExpanded" role="group">',n+='<li ng-repeat="field in field.Items" ng-click="SelectFieldClick(field, $event)" ng-mousedown="SelectFieldClick(field, $event)" class="common-tree-list client-visibility-tree-option">',n+='<i ng-class="field.IsExpanded?\'fa fa-minus\':\'fa fa-plus\'" ng-click="ExpandCollapsedControl(field,$event)" ng-show="field.Items.length>0" class="client-visibility-icon"><\/i>',n+='<input type="checkbox" ng-model="field.IsSelected" ng-show="field.IsCheckBoxVisible" />',n+='<span ng-bind="field.Text" class="client-visibility-tree-option-text"><\/span>',n+='<div clientvisibilitychildtree ng-if="field.Items.length > 0"><\/div>',n+="<\/li>",n+="<\/ul>",n+"<\/div>"}}}]);app.directive("customattributechildtree",[function(){return{restrict:"A",replace:!0,scope:!1,templateUrl:"Form/views/CustomAttributeTree.html"}}]);app.directive("chartcolumndroppable",[function(){return{restrict:"A",scope:{dropdata:"=",lstcolumns:"="},link:function(n,t){var i=t[0];i.addEventListener("drop",function(t){var o=t.dataTransfer.getData("Text");if(o==""&&lstEntityTreeFieldData!=null){var i=lstEntityTreeFieldData,u=i[0],f=i[1],r=i[2],s=i[3],h=i[4],e=u;f!=""&&(e=f+"."+u);dragDropData=e}else lstEntityTreeFieldData=null;dragDropData&&n.$apply(function(){var i,t;if(r!="Collection"&&r!="CDOCollection"&&r!="Object"&&r!="List"){if(i=!0,n.lstcolumns.length>0)for(t=0;t<n.lstcolumns.length;t++)n.lstcolumns[t].Property==dragDropData&&(i=!1);i&&n.lstcolumns.push({Property:dragDropData})}dragDropData=null});t.preventDefault&&t.preventDefault();t.stopPropagation&&t.stopPropagation()});$(i).on("dragenter",function(n){n.preventDefault()});$(i).on("dragleave",function(){});$(i).on("dragover",function(n){n.preventDefault()})}}}]);app.directive("basequeryparamdroppable",["$rootScope",function(){return{restrict:"A",scope:{dropdata:"=",dragdata:"="},link:function(n,t){var i=t[0];i.addEventListener("dragover",function(n){n.dataTransfer.dropEffect="copy";n.preventDefault&&n.preventDefault()});i.addEventListener("drop",function(t){var r;if(t.preventDefault(),r=t.dataTransfer.getData("Text"),r==""&&lstEntityTreeFieldData!=null){var i=lstEntityTreeFieldData,u=i[0],f=i[1],o=i[2],s=i[3],h=i[4],e=u;f!=""&&(e=f+"."+u)}else lstEntityTreeFieldData=null;n.dragdata&&r==""&&lstEntityTreeFieldData!=null&&(n.$evalAsync(function(){n.dropdata.dictAttributes.sfwDataType=o;n.dropdata.dictAttributes.sfwEntityField=e}),lstEntityTreeFieldData=null);t.stopPropagation&&t.stopPropagation()},!1)}}}]);app.directive("navigationparamchildtemplate",[function(){return{restrict:"A",replace:!0,scope:!1,templateUrl:"Form/views/NavigationParamChildTree.html"}}]);app.directive("addrowsandcolumnstotable",["$rootScope",function(n){return{restrict:"E",replace:!0,templateUrl:"Form/views/AddOrDeleteCellsToTable.html",link:function(t){t.getArrayCount=function(n,t){var r=[],i;for(n=n&&n+5>10?n+5:10,t&&t=="Delete"&&(n=n+1),i=1;i<=n;i++)r.push(i);return r};t.AddRowsAndColumns=function(n,i){if(t.objRowAndColumnIndex={},t.objRowAndColumnIndex.RowIndex=0,t.objRowAndColumnIndex.lstDeleteRowIndex=[],t.objRowAndColumnIndex.lstDeleteColumnIndex=[],t.objRowAndColumnIndex.ColumnIndex=0,t.objRowAndColumnIndex.CurrentRowIndex=0,t.objRowAndColumnIndex.CurrentColumnIndex=0,t.objFileModelForTable={},t.objFileModelForTable=t.currentfile&&t.currentfile.FileType=="Correspondence"?t.objCorrespondenceDetails:t.currentfile&&t.currentfile.FileType=="Report"?t.ReportModel:t.FormModel,t.setMaxRowAndColumnIndex(n),n.Name=="sfwTable"&&i){var u="tablediv_"+t.currentfile.FileName,r=document.getElementById(u);$(r).css({left:i.clientX-50,top:i.clientY});r.style.display="block"}};t.setMaxRowAndColumnIndex=function(n){if(n){t.objRowAndColumnIndex.CurrentRowIndex=n.Elements.length;for(var i=0;i<n.Elements.length;i++)t.objRowAndColumnIndex.CurrentColumnIndex<n.Elements[i].Elements.length&&(t.objRowAndColumnIndex.CurrentColumnIndex=n.Elements[i].Elements.length)}};t.onDeleteColumnOrRowCellClick=function(n,i,r){var u,f;n&&(i!=0&&(r=="Row"?i<=t.objRowAndColumnIndex.CurrentRowIndex&&(u=t.objRowAndColumnIndex.lstDeleteRowIndex.indexOf(i),u==-1?t.objRowAndColumnIndex.lstDeleteRowIndex.push(i):t.objRowAndColumnIndex.lstDeleteRowIndex.splice(u,1)):r=="Column"&&i<=t.objRowAndColumnIndex.CurrentColumnIndex&&(f=t.objRowAndColumnIndex.lstDeleteColumnIndex.indexOf(i),f==-1?t.objRowAndColumnIndex.lstDeleteColumnIndex.push(i):t.objRowAndColumnIndex.lstDeleteColumnIndex.splice(f,1))),n.stopPropagation())};t.isCellDelete=function(n,i){var r=!1;return t.objRowAndColumnIndex&&t.objRowAndColumnIndex.lstDeleteRowIndex.indexOf(n)>-1&&(r=!0),t.objRowAndColumnIndex&&t.objRowAndColumnIndex.lstDeleteColumnIndex.indexOf(i)>-1&&(r=!0),r&&(t.objRowAndColumnIndex.CurrentRowIndex>=n&&t.objRowAndColumnIndex.CurrentColumnIndex>=i||(r=!1)),r};t.AddCellsFromTable1=function(n,i,r,u){t.clearCellsFromtable();t.AddCellsFromTable(n,i,r,u);n&&t.objRowAndColumnIndex&&(t.objRowAndColumnIndex.lstDeleteRowIndex.length!=0||t.objRowAndColumnIndex.lstDeleteColumnIndex.length!=0)?n.stopPropagation():t.setDisplayNoneToTable()};t.setDisplayNoneToTable=function(){var i="tablediv_"+t.currentfile.FileName,n=document.getElementById(i);n&&n.style.display=="block"&&(n.style.display="none");t.objRowAndColumnIndex&&(t.objRowAndColumnIndex.lstDeleteRowIndex=[],t.objRowAndColumnIndex.lstDeleteColumnIndex=[],t.objRowAndColumnIndex.ColumnIndex=0,t.objRowAndColumnIndex.CurrentRowIndex=0,t.objRowAndColumnIndex.CurrentColumnIndex=0)};t.AddCellsFromTable=function(i,r,u,f){var c,o,e,h,s;if(t.objRowAndColumnIndex&&t.objRowAndColumnIndex.lstDeleteRowIndex.length==0&&t.objRowAndColumnIndex.lstDeleteColumnIndex.length==0&&t.objFileModelForTable&&t.objFileModelForTable.SelectedControl.Name=="sfwTable"){if(t.objRowAndColumnIndex.RowIndex=r,t.objRowAndColumnIndex.ColumnIndex=u,f||n.UndRedoBulkOp("Start"),r>t.objFileModelForTable.SelectedControl.Elements.length)for(c=t.objFileModelForTable.SelectedControl.Elements.length;c<r;c++)h="swc",o={Name:"sfwRow",value:"",prefix:h,dictAttributes:{},Elements:[],Children:[]},o.ParentVM=t.objFileModelForTable.SelectedControl,f?(o.isDummy=!0,t.objFileModelForTable.SelectedControl.Elements.push(o)):n.PushItem(o,t.objFileModelForTable.SelectedControl.Elements);else while(r<t.objFileModelForTable.SelectedControl.Elements.length)if(t.objFileModelForTable.SelectedControl.Elements[t.objFileModelForTable.SelectedControl.Elements.length-1].isDummy)t.objFileModelForTable.SelectedControl.Elements.splice(t.objFileModelForTable.SelectedControl.Elements.length-1,1);else break;for(e=0;e<t.objFileModelForTable.SelectedControl.Elements.length;e++)if(u>t.objFileModelForTable.SelectedControl.Elements[e].Elements.length)for(k=t.objFileModelForTable.SelectedControl.Elements[e].Elements.length;k<u;k++)h="swc",s={Name:"sfwColumn",value:"",prefix:h,dictAttributes:{},Elements:[],Children:[]},s.ParentVM=t.objFileModelForTable.SelectedControl.Elements[e],f?(s.isDummy=!0,t.objFileModelForTable.SelectedControl.Elements[e].Elements.push(s)):n.PushItem(s,t.objFileModelForTable.SelectedControl.Elements[e].Elements);else while(u<t.objFileModelForTable.SelectedControl.Elements[e].Elements.length)if(t.objFileModelForTable.SelectedControl.Elements[e].Elements[t.objFileModelForTable.SelectedControl.Elements[e].Elements.length-1].isDummy)t.objFileModelForTable.SelectedControl.Elements[e].Elements.splice(t.objFileModelForTable.SelectedControl.Elements[e].Elements.length-1,1);else break;f||n.UndRedoBulkOp("End")}};t.DeleteSelectedRowsAndColumns=function(){t.$evalAsync(function(){var u,f,i,e,o,s,r,h;if(t.objFileModelForTable&&t.objFileModelForTable.SelectedControl&&t.objFileModelForTable.SelectedControl.Name=="sfwTable"&&t.objRowAndColumnIndex&&(t.objRowAndColumnIndex.lstDeleteColumnIndex.length>0||t.objRowAndColumnIndex.lstDeleteRowIndex.length>0)){if(n.UndRedoBulkOp("Start"),t.objRowAndColumnIndex.lstDeleteRowIndex&&t.objRowAndColumnIndex.lstDeleteRowIndex.length>0)for(t.objRowAndColumnIndex.lstDeleteRowIndex.sort(function(n,t){return t-n}),u=0;u<t.objRowAndColumnIndex.lstDeleteRowIndex.length;u++)f=t.objRowAndColumnIndex.lstDeleteRowIndex[u]-1,f>-1&&t.objFileModelForTable.SelectedControl.Elements[f]&&n.DeleteItem(t.objFileModelForTable.SelectedControl.Elements[f],t.objFileModelForTable.SelectedControl.Elements);if(t.objRowAndColumnIndex.lstDeleteColumnIndex&&t.objRowAndColumnIndex.lstDeleteColumnIndex.length>0)for(t.objRowAndColumnIndex.lstDeleteColumnIndex.sort(function(n,t){return t-n}),i=t.objFileModelForTable.SelectedControl.Elements.length-1;i>=0;i--){for(e=0;e<t.objRowAndColumnIndex.lstDeleteColumnIndex.length;e++)o=t.objRowAndColumnIndex.lstDeleteColumnIndex[e]-1,o>-1&&t.objFileModelForTable.SelectedControl.Elements[i].Elements[o]&&n.DeleteItem(t.objFileModelForTable.SelectedControl.Elements[i].Elements[o],t.objFileModelForTable.SelectedControl.Elements[i].Elements);t.objFileModelForTable.SelectedControl.Elements[i].Elements.length==0&&n.DeleteItem(t.objFileModelForTable.SelectedControl.Elements[i],t.objFileModelForTable.SelectedControl.Elements)}t.objFileModelForTable.SelectedControl.Elements.length==0&&(s="swc",r={Name:"sfwRow",value:"",prefix:s,dictAttributes:{},Elements:[],Children:[]},r.ParentVM=t.objFileModelForTable.SelectedControl,n.PushItem(r,t.objFileModelForTable.SelectedControl.Elements),h={Name:"sfwColumn",value:"",prefix:s,dictAttributes:{},Elements:[],Children:[]},h.ParentVM=r,n.PushItem(h,r.Elements));n.UndRedoBulkOp("End")}t.setDisplayNoneToTable()})};t.clearCellsFromtable=function(n){if(t.objRowAndColumnIndex.ColumnIndex=0,t.objRowAndColumnIndex.RowIndex=0,t.objFileModelForTable&&t.objFileModelForTable.SelectedControl.Name=="sfwTable"){while(t.objFileModelForTable.SelectedControl.Elements.length>0&&t.objFileModelForTable.SelectedControl.Elements[t.objFileModelForTable.SelectedControl.Elements.length-1].isDummy)t.objFileModelForTable.SelectedControl.Elements.splice(t.objFileModelForTable.SelectedControl.Elements.length-1,1);for(var i=0;i<t.objFileModelForTable.SelectedControl.Elements.length;i++)while(t.objFileModelForTable.SelectedControl.Elements[i].Elements.length>0&&t.objFileModelForTable.SelectedControl.Elements[i].Elements[t.objFileModelForTable.SelectedControl.Elements[i].Elements.length-1].isDummy)t.objFileModelForTable.SelectedControl.Elements[i].Elements.splice(t.objFileModelForTable.SelectedControl.Elements[i].Elements.length-1)}n&&n.stopPropagation()}}}}]);app.controller("CustomAttributesController",["$scope","$rootScope","$SgMessagesService",function(n,t,i){n.IsShowAllControl=!1;n.Init=function(){n.FieldCollection=[];n.ParameterCollection=[];n.IsLookup=n.formobject.dictAttributes.sfwType=="Lookup"||n.formobject.dictAttributes.sfwType=="FormLinkLookup";n.IsReport=n.formobject.dictAttributes.sfwType=="Report";n.IsCorrespondence=n.formobject.dictAttributes.sfwType=="Correspondence";n.LoadAvailableFields();n.Initialize()};n.Initialize=function(){var t,i;n.propertyName==undefined&&(n.propertyName=n.$parent.propertyName);t=n.model.dictAttributes[n.propertyName];t!=undefined&&t!=""&&(i=t.split(";"),angular.forEach(i,function(t){var f;if(t!=undefined&&t!=""){var r=t,i=t,u=!1;t.contains("=")&&(r=t.substring(0,t.indexOf("=")),i=t.substring(t.indexOf("=")+1),i.match("^#")&&(i=i.substring(1),u=!0));f={ParameterField:r,ParameterValue:i,Constants:u};n.ParameterCollection.push(f)}}))};n.LoadAvailableFields=function(){var r="",i,f,t,u;if(n.IsLookup)r="sfwDataField";else if(n.IsReport){for(r="sfwObjectField",t=0;t<n.formobject.Elements.length;t++)if(n.formobject.Elements[t].Name=="sfwTable"){n.CurrentTable=n.formobject.Elements[t];break}}else r="sfwEntityField";if(n.FieldCollection=[],i={Text:"Main",Items:[],IsSelected:!1,IsCheckBoxVisible:!1},n.isFormLink)u=GetFormLinkItemsModel(n.model,n.formobject),null!=u&&(PopulateAvailableFieldsForFormLink(r,u,i,!0),i.Items.length>0&&n.FieldCollection.push(i));else{if(n.IsShowAllControl){for(t=0;t<n.formobject.Elements.length;t++)if(n.formobject.Elements[t].Name=="sfwTable"){f=n.formobject.Elements[t];break}PopulateAvailableFields(r,f,i,!0,n.IsLookup,!1)}else PopulateAvailableFields(r,n.CurrentTable,i,!0,n.IsLookup,!1);i.Items.length>0&&n.$evalAsync(function(){n.FieldCollection.push(i)})}};n.ExpandCollapsedCustomAttrField=function(n){n.IsExpanded=!n.IsExpanded};n.SetFieldClass=function(t){if(t==n.SelectedField)return"selected"};n.SelectFieldClick=function(t,i){n.SelectedField=t;i&&i.stopPropagation()};n.showAllControlChange=function(){n.LoadAvailableFields()};n.AddToGridClick=function(){n.FieldCollection.length>0&&(n.TraverseFieldCollection(n.FieldCollection[0].Items),n.ParameterCollection.length>0&&(n.SelectedParameter=n.ParameterCollection[n.ParameterCollection.length-1]))};n.SelectParameter=function(t){n.SelectedParameter=t};n.SetClassForParameter=function(t){if(n.SelectedParameter==t)return"selected"};n.onAddParameter=function(){n.ParameterCollection.push({ParameterField:"",ParameterValue:""});n.ParameterCollection.length>0&&(n.SelectedParameter=n.ParameterCollection[n.ParameterCollection.length-1])};n.onDeleteParameter=function(){if(n.SelectedParameter){var t=n.ParameterCollection.indexOf(n.SelectedParameter);n.ParameterCollection.splice(t,1);t<n.ParameterCollection.length?n.SelectedParameter=n.ParameterCollection[t]:n.ParameterCollection.length>0?n.SelectedParameter=n.ParameterCollection[t-1]:n.ParameterCollection.length==0&&(n.SelectedParameter=undefined)}};n.TraverseFieldCollection=function(t){angular.forEach(t,function(t){var u,o;if(t.IsSelected){var r=t.Text,f=!1,e=n.ParameterCollection.filter(function(n){return n.ParameterValue==r});e&&e.length>0&&(f=!0);f?i.Message("Message",r+" Column is already added in Collection, please check."):(u=n.GetCaptionFromFieldName(r),u=n.RemoveInternalSpace(u),o={ParameterField:u,ParameterValue:r},n.ParameterCollection.push(o));t.IsSelected=!1}t.Items.length>0&&n.TraverseFieldCollection(t.Items)})};n.RemoveInternalSpace=function(n){for(n=n.trim();n.indexOf(" ")>0;)n=n.substring(0,n.indexOf(" ")).trim()+n.substring(n.indexOf(" ")).trim();return n};n.GetCaptionFromFieldName=function(n){var t,r,i,u,f;for(n.match("^icdo")&&(n=n.replace("icdo","")),t="",r=!0,i=0;i<n.length;i++)"._".contains(""+n[i])?(r=!0,t+=" "):(t+=r?n.toUpperCase()[i]:n[i],r=!1);return t.match(" Id$")&&(t=t.replace(" Id"," ID")),t.contains("Ssn")&&(t=t.replace("Ssn","SSN")),u=t.indexOf(" Value"),u>0&&(t=t.substring(0,u)),f=t.indexOf(" Description"),f>0&&(t=t.substring(0,f)),t};n.GetSavedString=function(){var t="";return angular.forEach(n.ParameterCollection,function(n){var r=n.ParameterField,i=n.ParameterValue,f,u;(i!=undefined&&i!=""||r!=undefined&&r!="")&&(f=n.Constants,f&&(i="#"+i),u=i,i.toLowerCase()!=r.toLowerCase()&&(u=r+"="+i),t==""?t=u:t+=";"+u)}),t};n.onOkClick=function(){var i=n.GetSavedString();t.EditPropertyValue(n.model.dictAttributes[n.propertyName],n.model.dictAttributes,n.propertyName,i);n.onCancelClick()};n.onCancelClick=function(){n.UserLogParaDialog.close()};n.Init()}]);app.controller("RetrievalParametersController",["$scope","$rootScope","$filter",function(n){n.ShowAll={};n.ShowAll.isShowAll=!1;n.lstParameters=[];var t;n.Init=function(){var r,i;if(n.formobject){if(r=n.formobject.dictAttributes.sfwType=="Wizard",r)t=GetVM("sfwWizardStep",n.model);else if(n.formobject.dictAttributes.sfwType=="FormLinkLookup"||n.formobject.dictAttributes.sfwType=="FormLinkMaintenance"||n.formobject.dictAttributes.sfwType=="FormLinkWizard"){if(n.formobject&&n.formobject.Elements)for(i=0;i<n.formobject.Elements.length;i++)if(n.formobject.Elements[i].Name=="items"){n.PopulateRetrievalParametersForHtml(n.formobject.Elements[i],n.lstParameters,n.formobject.dictAttributes.sfwType);break}}else t=n.formobject.dictAttributes.sfwType=="Correspondence"||n.formobject.dictAttributes.sfwType=="UserControl"?GetVM("sfwTable",n.model):GetVM("sfwPanel",n.model);t&&PopulateRetrievalOrAutoCompleteParameters(t,n.lstParameters,n.formobject.dictAttributes.sfwType,!0)}$.connection.hubForm.server.getGlobleParameters().done(function(t){n.$apply(function(){n.objGlobleParameters=t;n.PopulateGlobalParameters()})})};n.ShowAllControls=function(){if(n.lstParameters=[],n.ShowAll.isShowAll){if(n.formobject&&n.formobject.Elements)for(var i=0;i<n.formobject.Elements.length;i++){if(n.formobject.dictAttributes.sfwType=="Correspondence"&&n.formobject.Elements[i].Name=="sfwQueryForm"&&n.formobject.Elements[i].Elements.length>0&&n.formobject.Elements[i].Elements[0].Name=="sfwTable"){PopulateRetrievalOrAutoCompleteParameters(n.formobject.Elements[i].Elements[0],n.lstParameters,n.formobject.dictAttributes.sfwType,!0);break}if(n.formobject.Elements[i].Name=="sfwTable"){PopulateRetrievalOrAutoCompleteParameters(n.formobject.Elements[i],n.lstParameters,n.formobject.dictAttributes.sfwType,!0);break}}}else PopulateRetrievalOrAutoCompleteParameters(t,n.lstParameters,n.formobject.dictAttributes.sfwType,!0);n.PopulateGlobalParameters();n.bindParameterValue()};n.PopulateGlobalParameters=function(){function r(n){var r,u;n.dictAttributes&&n.dictAttributes.ID&&(r=n.dictAttributes.ID,i.filter(function(n){return n==r.trim()})||i.push(r.trim()),u={ID:"~"+r,IsExpanded:!1,IsSelected:!1,Elements:[]},t.Elements.push(u))}var u,i,t;if(n.objGlobleParameters&&(u=n.formobject.dictAttributes.sfwType,n.model.Name=="sfwTextBox"||n.model.Name=="sfwButton"||n.model.Name=="sfwMultiSelectDropDownList"||n.model.Name=="sfwCascadingDropDownList"||n.model.Name=="sfwDropDownList"||n.model.Name=="sfwCheckBoxList"||n.model.Name=="sfwRadioButtonList")){if(n.model.Name=="sfwButton"&&n.model.dictAttributes.sfwMethodName!="btnOpen_Click"&&n.model.dictAttributes.sfwMethodName!="btnNew_Click")return;i=[];n.objGlobleParameters.Elements.length>0&&(t={ID:"Global Parameters",IsExpanded:!1,IsSelected:!1,Elements:[]},angular.forEach(n.objGlobleParameters.Elements,r),t.Elements.length>0&&n.lstParameters.push(t))}};n.ExpandCollapsedControl=function(n){n.IsExpanded=!n.IsExpanded};n.selectParameter=function(t,i){n.selectedParameter=t;i&&i.stopPropagation()};n.bindParameterValue=function(){var r,i,u,t;if(n.selectedCurrentQuery!=undefined&&n.selectedCurrentQuery!=""&&(n.ParameterCollection=[],angular.forEach(n.selectedCurrentQuery.Parameters,function(t){ParameterField=t.ID;strParamField=ParameterField.contains("@")?ParameterField.substring(ParameterField.indexOf("@")+1,ParameterField.length):ParameterField;var i={ParameterField:strParamField,ParameterValue:""};n.ParameterCollection.push(i)})),n.ParameterCollection!=undefined&&n.ParameterCollection.length>0&&n.strSelectedParameters!=undefined)for(r=n.strSelectedParameters.split(";"),i=0;i<r.length;i++)for(u=r[i].split("="),t=0;t<n.ParameterCollection.length;t++)n.ParameterCollection[t].ParameterField==u[0]&&(n.ParameterCollection[t].ParameterValue=u[1])};n.bindParameterValue();n.okClick=function(){if(n.strSelectedParameters="",n.ParameterCollection!=undefined)for(var t=0;t<n.ParameterCollection.length;t++)n.ParameterCollection[t].ParameterValue!=""&&(n.strSelectedParameters!=undefined&&n.strSelectedParameters!=""?n.strSelectedParameters+=";"+n.ParameterCollection[t].ParameterField+"="+n.ParameterCollection[t].ParameterValue:(n.strSelectedParameters==undefined||n.strSelectedParameters=="")&&(n.strSelectedParameters=n.ParameterCollection[t].ParameterField+"="+n.ParameterCollection[t].ParameterValue));n.$emit("onRetrievalParameterClick",n.strSelectedParameters);n.closeClick()};n.closeClick=function(){n.objNewDialog.close()};n.SelectFieldClick=function(n,t){t&&t.stopPropagation()};n.PopulateRetrievalParametersForHtml=function(t,i,r){t&&angular.forEach(t.Elements,function(t){var e,u,f;t.Name!="sfwPanel"&&t.Name!="sfwWizardStep"&&t.Name!="sfwGridView"&&(r=="FormLinkLookup"&&t.dictAttributes.sfwDataField&&t.dictAttributes.ID?(f={ID:t.dictAttributes.ID,ControlID:"",Elements:[],IsExpanded:!1},i.push(f)):(r=="FormLinkMaintenance"||r=="FormLinkWizard")&&t.dictAttributes.sfwEntityField&&t.dictAttributes.ID&&(f={ID:t.dictAttributes.ID,ControlID:"",Elements:[],IsExpanded:!1},i.push(f)));t.Elements.length>0&&(e=i,(t.Name=="sfwPanel"||t.Name=="sfwDialogPanel")&&(u=t.dictAttributes.sfwCaption,(u==undefined||u=="")&&(u=t.dictAttributes.ID),f={ID:u,Elements:[],IsExpanded:!1},i.push(f),e=i[i.length-1].Elements),t.Name=="sfwWizardStep"&&(u=t.dictAttributes.Title,(u==undefined||u=="")&&(u=t.dictAttributes.ID),f={ID:u,Elements:[],IsExpanded:!1},i.push(f),e=i[i.length-1].Elements),n.PopulateRetrievalParametersForHtml(t,e,r))})};n.Init()}]);app.directive("retrievalparameterdraggable",[function(){return{restrict:"A",scope:{dragdata:"="},link:function(n,t){function r(t){t.stopPropagation();n.dragdata!=undefined&&n.dragdata!=""&&t.dataTransfer.setData("text",JSON.stringify(n.dragdata))}var i=t[0];i.draggable=!0;i.addEventListener("dragstart",r,!1)}}}]);app.directive("retrievalparameterdroppable",[function(){return{restrict:"A",scope:{dropdata:"="},link:function(n,t){var i=t[0];i.addEventListener("dragover",function(n){n.dataTransfer.dropEffect="copy";n.preventDefault&&n.preventDefault()});i.addEventListener("drop",function(t){t.preventDefault();var i=JSON.parse(t.dataTransfer.getData("text"));i!=undefined&&i!=""&&n.$apply(function(){n.dropdata=i});t.stopPropagation&&t.stopPropagation()})}}}]);app.controller("RetrievalControlsController",["$scope","$rootScope","$filter","ngDialog","$EntityIntellisenseFactory",function(n,t,i,r,u){n.lstRetrievalControl=[];n.lstColumns=[];n.ShowAll={};n.ShowAll.isShowAll=!1;var f;n.Init=function(){function a(t){t.DataType!="Collection"&&t.DataType!="Object"&&t.DataType!="CDOCollection"&&t.Type!="Expression"&&n.lstColumns.push({CodeID:t.ID})}function v(n){var f,t,e;n&&n.ID==r&&n.Entity!=undefined&&n.Entity!=""&&(f=u.getEntityIntellisense(),t=i("filter")(f,{ID:n.Entity},!0),t&&t.length>0&&(e=t[0],angular.forEach(e.Attributes,a)))}var h,e,w,r,o,c,l,t;if(n.model.dictAttributes.sfwRetrievalQuery||n.IsAutoComplete&&n.model.autocompleteType==="Query"&&n.model.dictAttributes.sfwAutoQuery){if(n.IsAutoComplete&&n.model.dictAttributes.sfwAutoQuery?t=n.model.dictAttributes.sfwAutoQuery.split("."):n.IsRetrievalQuery&&n.model.dictAttributes.sfwRetrievalQuery&&(t=n.model.dictAttributes.sfwRetrievalQuery.split(".")),t&&t.length==2){var y=t[0],p=t[1],o=u.getEntityIntellisense(),s=i("filter")(o,{ID:y},!0);s&&s.length>0&&(h=s[0],e=h.Queries.filter(function(n){return n.ID==p}),e&&e.length>0&&(w=e[0],n.IsAutoComplete?$.connection.hubForm.server.getEntityQueryColumns(n.model.dictAttributes.sfwAutoQuery,"RetrievalControlsController").done(function(t){n.receiveQueryColumns(t)}):$.connection.hubForm.server.getEntityQueryColumns(n.model.dictAttributes.sfwRetrievalQuery,"RetrievalControlsController").done(function(t){n.receiveQueryColumns(t)})))}}else if(n.model.dictAttributes.sfwRetrievalMethod||n.IsAutoComplete&&n.model.autocompleteType==="Method"&&n.model.dictAttributes.sfwAutoMethod){if(r=null,r=n.IsAutoComplete?n.model.dictAttributes.sfwAutoMethod:n.model.dictAttributes.sfwRetrievalMethod.trim(),!r)return;o=u.getEntityIntellisense();n.lstColumns=[];c=GetObjectMethods(o,n.formobject.dictAttributes.sfwEntity,r);angular.forEach(c,v)}n.receiveQueryColumns=function(t){n.$apply(function(){n.lstColumns=t})};l=n.formobject.dictAttributes.sfwType=="Wizard";f=l?GetVM("sfwWizardStep",n.model):n.formobject.dictAttributes.sfwType=="Correspondence"||n.formobject.dictAttributes.sfwType=="UserControl"?GetVM("sfwTable",n.model):GetVM("sfwPanel",n.model);n.formobject.dictAttributes.sfwType=="FormLinkLookup"||n.formobject.dictAttributes.sfwType=="FormLinkMaintenance"||n.formobject.dictAttributes.sfwType=="FormLinkWizard"?(t=n.formobject.Elements.filter(function(n){return n.Name=="items"}),t&&t.length>0&&PopulateRetrievalControls(t[0],n.lstRetrievalControl)):PopulateRetrievalControls(f,n.lstRetrievalControl);n.bindControlsID()};n.bindControlsID=function(){var r,i,u,t;if(n.strSelectedRetrievalControls!=undefined)for(r=n.strSelectedRetrievalControls.split(";"),i=0;i<r.length;i++)for(u=r[i].split("="),t=0;t<n.lstRetrievalControl.length;t++)n.lstRetrievalControl[t].ID==u[0]&&(n.lstRetrievalControl[t].ControlID=u[1])};n.ShowAllControls=function(){n.GetRetrievalControlValue();n.lstRetrievalControl=[];n.ShowAll.isShowAll?PopulateRetrievalControls(n.formobject,n.lstRetrievalControl):PopulateRetrievalControls(f,n.lstRetrievalControl);n.bindControlsID()};n.closeClick=function(){n.RetrievalControlsDialog.close()};n.GetRetrievalControlValue=function(){n.strSelectedRetrievalControls="";for(var t=0;t<n.lstRetrievalControl.length;t++)n.lstRetrievalControl[t].ControlID!=""&&(n.strSelectedRetrievalControls!=undefined&&n.strSelectedRetrievalControls!=""?n.strSelectedRetrievalControls+=";"+n.lstRetrievalControl[t].ID+"="+n.lstRetrievalControl[t].ControlID:(n.strSelectedRetrievalControls==undefined||n.strSelectedRetrievalControls=="")&&(n.strSelectedRetrievalControls=n.lstRetrievalControl[t].ID+"="+n.lstRetrievalControl[t].ControlID))};n.okClick=function(){n.GetRetrievalControlValue();n.IsAutoComplete?n.$emit("onAutoCompletelControlClick",n.strSelectedRetrievalControls):n.$emit("onRetrievalControlClick",n.strSelectedRetrievalControls);n.closeClick();n.OnOkClick&&n.OnOkClick()};n.Init()}]);app.directive("retrievalcontroldraggable",[function(){return{restrict:"A",scope:{dragdata:"="},link:function(n,t){function r(t){t.stopPropagation();n.dragdata!=undefined&&n.dragdata!=""&&t.dataTransfer.setData("text",JSON.stringify(n.dragdata))}var i=t[0];i.draggable=!0;i.addEventListener("dragstart",r,!1)}}}]);app.directive("retrievalcontroldroppable",[function(){return{restrict:"A",scope:{dropdata:"="},link:function(n,t){var i=t[0];i.addEventListener("dragover",function(n){n.dataTransfer.dropEffect="copy";n.preventDefault&&n.preventDefault()});i.addEventListener("drop",function(t){t.preventDefault();var i=JSON.parse(t.dataTransfer.getData("text"));i!=undefined&&i!=""&&n.$apply(function(){n.dropdata=i});t.stopPropagation&&t.stopPropagation()})}}}]);app.controller("AutoCompleteParameterController",["$scope","$rootScope","$filter","ngDialog",function(n){n.ShowAll={};n.ShowAll.isShowAll=!1;n.lstParameters=[];var t;n.Init=function(){var r,i;if(n.lstParameters.push({ID:"Main",Name:"sfwPanel",Elements:[],IsExpanded:!1}),t=GetVM("sfwPanel",n.model),n.formobject.dictAttributes.sfwType=="UserControl"&&(t=GetVM("sfwTable",n.model)),r=n.formobject.dictAttributes.sfwType=="Wizard",r&&(t=GetVM("sfwWizardStep",n.model)),n.IsAutoComplete)if(n.FormType=="FormLinkLookup"||n.FormType=="FormLinkMaintenance"||n.FormType=="FormLinkWizard"){if(n.formobject&&n.formobject.Elements)for(i=0;i<n.formobject.Elements.length;i++)n.formobject.Elements[i].Name=="items"&&n.PopulateAutoCompleteParametersForHtml(n.formobject,n.lstParameters[0].Elements,n.FormType)}else t&&PopulateRetrievalOrAutoCompleteParameters(t,n.lstParameters[0].Elements,n.FormType,!1);$.connection.hubForm.server.getGlobleParameters().done(function(t){n.$apply(function(){n.objGlobleParameters=t;n.PopulateGlobalParameters()})})};n.PopulateGlobalParameters=function(){function u(n){var i,u;n.dictAttributes&&n.dictAttributes.ID&&(i=n.dictAttributes.ID,r.filter(function(n){return n==i.trim()})||r.push(i.trim()),u={ID:"~"+i,IsExpanded:!1,IsSelected:!1,Elements:[]},t.Elements.push(u))}var i,r,t;if(n.objGlobleParameters&&(i=n.formobject.dictAttributes.sfwType,(n.model.Name=="sfwTextBox"||n.model.Name=="sfwButton"||n.model.Name=="sfwCascadingDropDownList"||n.model.Name=="sfwDropDownList"||n.model.Name=="sfwMultiSelectDropDownList")&&i!="Report"&&i!="Correspondence")){if(n.model.Name=="sfwButton"&&n.model.dictAttributes.sfwMethodName!="btnOpen_Click"&&n.model.dictAttributes.sfwMethodName!="btnNew_Click")return;r=[];n.objGlobleParameters.Elements.length>0&&(t={ID:"Global Parameters",IsExpanded:!1,IsSelected:!1,Elements:[]},angular.forEach(n.objGlobleParameters.Elements,u),t.Elements.length>0&&n.lstParameters.push(t))}};n.ShowAllControls=function(){var r,i;if(n.lstParameters=[],r={ID:"Main",Name:"sfwPanel",Elements:[],IsExpanded:!1},n.lstParameters.push(r),n.ShowAll.isShowAll){if(n.formobject&&n.formobject.Elements)for(i=0;i<n.formobject.Elements.length;i++)if(n.formobject.Elements[i].Name=="sfwTable"){PopulateRetrievalOrAutoCompleteParameters(n.formobject.Elements[i],n.lstParameters[0].Elements,n.FormType,!1);break}}else t&&PopulateRetrievalOrAutoCompleteParameters(t,n.lstParameters[0].Elements,n.FormType,!1);n.PopulateGlobalParameters()};n.ExpandCollapsedControl=function(n){n.IsExpanded=!n.IsExpanded};n.selectParameter=function(t,i){n.selectedParameter=t;i&&i.stopPropagation()};n.bindParameterValue=function(){var f,e,r,t,u,i;if(n.model.autocompleteType==="Query"&&n.selectedCurrentQuery)n.ParameterCollection=[],angular.forEach(n.selectedCurrentQuery.Parameters,function(t){ParameterField=t.ID;strParamField=ParameterField.contains("@")?ParameterField.substring(ParameterField.indexOf("@")+1,ParameterField.length):ParameterField;var i={ParameterField:strParamField,ParameterValue:""};n.ParameterCollection.push(i)});else if(n.model.autocompleteType==="Method"&&n.selectedMethod)for(n.ParameterCollection=[],t=0,f=n.selectedMethod.Parameters.length;t<f;t++)e={ParameterField:n.selectedMethod.Parameters[t].ID,ParameterValue:""},n.ParameterCollection.push(e);if(n.ParameterCollection!=undefined&&n.ParameterCollection.length>0&&n.strSelectedParameters!=undefined)for(r=n.strSelectedParameters.split(";"),t=0;t<r.length;t++)for(u=r[t].split("="),i=0;i<n.ParameterCollection.length;i++)n.ParameterCollection[i].ParameterField==u[0]&&(n.ParameterCollection[i].ParameterValue=u[1])};n.bindParameterValue();n.okClick=function(){if(n.strSelectedParameters="",n.ParameterCollection!=undefined)for(var t=0;t<n.ParameterCollection.length;t++)n.ParameterCollection[t].ParameterValue!=""&&(n.strSelectedParameters!=undefined&&n.strSelectedParameters!=""?n.strSelectedParameters+=";"+n.ParameterCollection[t].ParameterField+"="+n.ParameterCollection[t].ParameterValue:(n.strSelectedParameters==undefined||n.strSelectedParameters=="")&&(n.strSelectedParameters=n.ParameterCollection[t].ParameterField+"="+n.ParameterCollection[t].ParameterValue));n.IsAutoComplete&&n.$emit("onAutoCompleteParameterClick",n.strSelectedParameters);n.closeClick()};n.closeClick=function(){n.objNewDialog.close()};n.PopulateAutoCompleteParametersForHtml=function(t,i,r){t&&angular.forEach(t.Elements,function(t){var e,u,f;t.Name!="sfwPanel"&&t.Name!="sfwWizardStep"&&t.Name!="sfwGridView"&&(r=="FormLinkLookup"&&t.dictAttributes.sfwDataField&&t.dictAttributes.ID?(f={ID:t.dictAttributes.ID,ControlID:"",Elements:[],IsExpanded:!1},i.push(f)):(r=="FormLinkMaintenance"||r=="FormLinkWizard")&&t.dictAttributes.sfwEntityField&&t.dictAttributes.ID&&(f={ID:t.dictAttributes.ID,ControlID:"",Elements:[],IsExpanded:!1},i.push(f)));t.Elements.length>0&&(e=i,t.Name=="sfwPanel"&&(u=t.dictAttributes.sfwCaption,(u==undefined||u=="")&&(u=t.dictAttributes.ID),f={ID:u,Elements:[],IsExpanded:!1},i.push(f),e=i[i.length-1].Elements),t.Name=="sfwWizardStep"&&(u=t.dictAttributes.Title,(u==undefined||u=="")&&(u=t.dictAttributes.ID),f={ID:u,Elements:[],IsExpanded:!1},i.push(f),e=i[i.length-1].Elements),n.PopulateAutoCompleteParametersForHtml(t,e,r))})};n.Init()}]);app.controller("AutoCompleteColumnsController",["$scope","$rootScope","$filter","ngDialog","$Entityintellisenseservice","$timeout","$SgMessagesService",function(n,t,i,r,u,f,e){n.lstColumns=[];n.lstAddedColumns=[];n.lstOperators=["","=","!=","<","<=",">",">=","like","contains"];n.init=function(){var e,r,i,o,t,f;if(n.strSelectedAutoColumns)for(e=n.strSelectedAutoColumns.split(";"),r=0;r<e.length;r++)i=e[r].split(","),o={ColumnName:i[0],Header:i[1],Operator:i[2],DataType:i[3]},n.lstAddedColumns.push(o);n.model.autocompleteType==="Query"&&n.model.dictAttributes.sfwAutoQuery?n.IsAutoComplete&&$.connection.hubForm.server.getEntityQueryColumns(n.model.dictAttributes.sfwAutoQuery,"AutoCompleteColumnsController").done(function(t){n.receiveQueryColumns(t)}):n.model.autocompleteType==="Method"&&n.model.dictAttributes.sfwAutoMethod&&(t=u.GetIntellisenseData(n.entityName,null,null,!0,!1,!0,!1,!1,!1),t=t.filter(function(t){return t.ID.toLowerCase()===n.model.dictAttributes.sfwAutoMethod.toLowerCase()}),t&&t.length&&t[0].Entity&&(f=u.GetIntellisenseData(t[0].Entity,null,null,!0,!0,!1,!1,!1,!1),f=f.map(function(n){return{CodeID:n.ID,Description:n.ID,DataType:n.DataType}}),n.receiveQueryColumns(f)))};n.receiveQueryColumns=function(t){n.$evalAsync(function(){for(var i=0;i<t.length;i++)t[i].isChecked=!1;n.lstColumns=t})};n.AddColumns=function(){var t,r,i,u,f;if(n.lstColumns.length>0)for(t=0;t<n.lstColumns.length;t++)if(n.lstColumns[t].isChecked){for(r=!0,i=0;i<n.lstAddedColumns.length;i++)if(n.lstAddedColumns[i].ColumnName==n.lstColumns[t].CodeID){r=!1;e.Message("Message",n.lstColumns[t].CodeID+" is already added in Collection, please Check.");break}r==!0&&(u=n.lstColumns[t].DataType,(n.lstColumns[t].DataType=="Decimal"||n.lstColumns[t].DataType.indexOf("Int")==0)&&(u="Numeric"),f={ColumnName:n.lstColumns[t].CodeID,Header:n.lstColumns[t].CodeID.split("_").join(" "),Operator:"",DataType:u},n.lstAddedColumns.push(f))}};n.okClick=function(){var i,t;if(n.strSelectedAutoColumns="",n.lstAddedColumns.length>0)for(i=0;i<n.lstAddedColumns.length;i++)t=n.lstAddedColumns[i],n.strSelectedAutoColumns==""?n.strSelectedAutoColumns=t.ColumnName+","+t.Header+","+t.Operator+","+t.DataType:n.strSelectedAutoColumns+=";"+t.ColumnName+","+t.Header+","+t.Operator+","+t.DataType;n.$emit("onAutoCompletelColumnsClick",n.strSelectedAutoColumns);n.closeClick()};n.closeClick=function(){n.AutoCompleteColumnDialog.close()};n.selectColumn=function(t){n.selectedColumn=t};n.isMoveUp=function(){if(n.selectedColumn==undefined)return!0;var t=n.lstAddedColumns.indexOf(n.selectedColumn);return t>0?!1:!0};n.isMoveDown=function(){if(n.selectedColumn==undefined)return!0;var t=n.lstAddedColumns.indexOf(n.selectedColumn);return t!=n.lstAddedColumns.length-1&&t!=-1?!1:!0};n.MoveUp=function(){var t=n.lstAddedColumns.indexOf(n.selectedColumn),i=n.lstAddedColumns[t-1];n.lstAddedColumns[t-1]=n.lstAddedColumns[t];n.lstAddedColumns[t]=i;n.scrollToSelectedField("#form-autocomplete-column-param",".selected")};n.MoveDown=function(){var t=n.lstAddedColumns.indexOf(n.selectedColumn),i=n.lstAddedColumns[t+1];n.lstAddedColumns[t+1]=n.lstAddedColumns[t];n.lstAddedColumns[t]=i;n.scrollToSelectedField("#form-autocomplete-column-param",".selected")};n.deleteColumns=function(){if(n.lstAddedColumns.length>1){var t=n.lstAddedColumns.indexOf(n.selectedColumn);n.lstAddedColumns.splice(t,1);n.selectedColumn=undefined}};n.scrollToSelectedField=function(n,t){f(function(){var i=$(n).find("table tbody");if(i&&i.hasScrollBar())return i.scrollTo(i.find(t),{offsetTop:200,offsetLeft:0},null),!1})};n.init()}]);app.controller("NavigationParameterController",["$scope","$rootScope","ngDialog","$filter","ParameterFactory","$EntityIntellisenseFactory","$Entityintellisenseservice","$GetEntityFieldObjectService",function(n,t,i,r,u,f,e,o){var h,s;n.SelectedObject.IsShowAllControl=!1;n.currentPanel;n.ParameterCollection=[];n.MethodParameterCollection=[];n.LookupParameterCollection=[];n.XmlParameterCollection=[];n.thisQuery;n.activeFormEntity;n.TargetFormCaption="Target Form :";n.TargetForm="";n.IsParentAsCollection=!1;n.ParentModel&&n.ParentModel.dictAttributes.sfwEntityField&&(n.IsParentAsCollection=!0,h=o.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,n.ParentModel.dictAttributes.sfwEntityField),h&&(n.entityName=h.Entity));n.formobject&&n.formobject.dictAttributes.sfwEntity&&n.formobject.dictAttributes.sfwType=="Correspondence"&&(n.entityName=n.formobject.dictAttributes.sfwEntity);n.Init=function(){var r=getCurrentFileScope(),k,d,s,c,g,l,b,i,y,it,p,u,nt,a,tt,v,t,w,h,o;if(n.SelectedObject.dictAttributes.sfwMethodName==="btnNew_Click"&&n.formobject&&(k=getDescendents(n.formobject,"sfwPanel"),k&&k.length>0&&(n.currentPanel=k.filter(function(n){return n.dictAttributes.ID==="pnlMain"||n.dictAttributes.ID==="pnlCriteria"})[0])),n.currentPanel||(r.CurrPanel?n.currentPanel=r.CurrPanel:r.MainTable?n.currentPanel=r.MainTable:r.objQueryForm&&(d=r.objQueryForm.Elements.filter(function(n){return n.Name=="sfwTable"}),d&&d.length>0&&(n.currentPanel=d[0])),r&&r.currentfile&&r.currentfile.FileType=="UserControl"&&(n.currentPanel=r.FormModel)),n.ParameterCollection=[],n.TargetForm=n.SelectedObject.dictAttributes.sfwActiveForm,n.SelectedObject.Name=="sfwCascadingDropDownList"||n.SelectedObject.Name=="sfwDropDownList"||n.SelectedObject.Name=="sfwCheckBoxList"||n.SelectedObject.Name=="sfwRadioButtonList"||n.SelectedObject.Name=="sfwSourceList"||n.SelectedObject.Name=="sfwListPicker"||n.SelectedObject.Name=="sfwMultiSelectDropDownList"||n.SelectedObject.Name=="sfwListBox")n.PopulateNavigationParameters(),n.EntityFieldCollection=[];else if(n.SelectedObject.dictAttributes.sfwMethodName=="btnSave_Click"||n.SelectedObject.dictAttributes.sfwMethodName=="btnNoChangesSave_Click"||n.SelectedObject.dictAttributes.sfwMethodName=="btnSaveAndNext_Click"||n.SelectedObject.dictAttributes.sfwMethodName=="btnForceSave_Click"||n.SelectedObject.dictAttributes.sfwMethodName=="btnWizardSaveAndNext_Click"||n.SelectedObject.dictAttributes.sfwMethodName=="btnSaveIgnoreReadOnly_Click"||n.SelectedObject.dictAttributes.sfwMethodName=="btnWizardSaveAndPrevious_Click"){if(n.TargetFormCaption="Target Form:",n.formobject&&(n.TargetForm=n.formobject.dictAttributes.ID,s="",c=n.formobject.Elements.filter(function(n){return n.Name=="initialload"}),c&&c.length>0&&(g=c[0],l=g.Elements.filter(function(n){return n.Name=="callmethods"&&n.dictAttributes.sfwMode!="New"}),l&&l.length>0&&(s=l[0].dictAttributes.sfwMethodName)),s)){var rt=[],ut="",ft="",et=!1;if(n.formobject.dictAttributes.sfwRemoteObject!=undefined&&n.formobject.dictAttributes.sfwRemoteObject!=""){if(b=GetServerMethodObject(n.formobject.dictAttributes.sfwRemoteObject,n.formobject.RemoteObjectCollection),u=GetSrvMethodParameters(b,s),u)for(j=0;j<u.length;j++)o={ParameterField:u[j].dictAttributes.ID,ParameterValue:"",Constants:!1},n.XmlParameterCollection.push(o)}else if(i=f.getXmlMethodParameters(n.formobject.dictAttributes.sfwEntity,s,!0),i&&i.length)for(j=0,len=i.length;j<len;j++)o={ParameterField:i[j].ID,EntityField:i[j].Value,ParameterValue:i[j].Value,Constants:!1},n.XmlParameterCollection.push(o);n.PopulateParamValues(n.XmlParameterCollection)}}else if(n.SelectedObject.dictAttributes.sfwMethodName=="btnSaveNew_Click"){if(n.TargetFormCaption="Target Form:",n.TargetForm=n.formobject.dictAttributes.ID,n.formobject&&(s="",c=n.formobject.Elements.filter(function(n){return n.Name=="initialload"}),c&&c.length>0&&(g=c[0],l=g.Elements.filter(function(n){return n.Name=="callmethods"&&n.dictAttributes.sfwMode!="Update"}),l&&l.length>0&&(s=l[0].dictAttributes.sfwMethodName)),s)){var rt=[],ut="",ft="",et=!1;if(n.formobject.dictAttributes.sfwRemoteObject!=undefined&&n.formobject.dictAttributes.sfwRemoteObject!=""){if(b=GetServerMethodObject(n.formobject.dictAttributes.sfwRemoteObject,n.formobject.RemoteObjectCollection),u=GetSrvMethodParameters(b,s),u)for(j=0;j<u.length;j++)o={ParameterField:u[j].dictAttributes.ID,ParameterValue:"",Constants:!1},n.XmlParameterCollection.push(o)}else if(i=f.getXmlMethodParameters(n.formobject.dictAttributes.sfwEntity,s,!0),i&&i.length)for(j=0,len=i.length;j<len;j++)o={ParameterField:i[j].ID,EntityField:i[j].Value,ParameterValue:i[j].Value,Constants:!1},n.XmlParameterCollection.push(o);n.PopulateParamValues(n.XmlParameterCollection)}}else if(n.SelectedObject.dictAttributes.sfwMethodName=="btnWorkflowExecuteMethod_Click")n.TargetFormCaption="",o={ParameterField:"aintActivityInstanceId",ParameterValue:"",Constants:!1},n.XmlParameterCollection.push(o),n.PopulateParamValues(n.XmlParameterCollection);else if(n.SelectedObject.dictAttributes.sfwMethodName=="btnValidateExecuteBusinessMethod_Click"||n.SelectedObject.dictAttributes.sfwMethodName=="btnExecuteBusinessMethodSelectRows_Click"||n.SelectedObject.dictAttributes.sfwMethodName=="btnExecuteBusinessMethod_Click"||n.SelectedObject.dictAttributes.sfwMethodName=="btnCopyRecord_Click"||n.SelectedObject.dictAttributes.sfwMethodName=="btnWizardCancel_Click"||n.SelectedObject.dictAttributes.sfwMethodName=="btnCompleteWorkflowActivities_Click")n.SelectedObject.dictAttributes.sfwObjectMethod!=undefined&&n.SelectedObject.dictAttributes.sfwObjectMethod!=""&&(n.TargetFormCaption="Object Method:",y=[],n.SelectedObject.dictAttributes.hasOwnProperty("sfwExecuteMethodType")&&n.SelectedObject.dictAttributes.sfwExecuteMethodType=="Rule"?(n.TargetFormCaption="Rule:",y=n.entityName?e.GetIntellisenseData(n.entityName,"","",!0,!1,!1,!0,!1,!1):e.GetIntellisenseData(n.formobject.dictAttributes.sfwEntity,"","",!0,!1,!1,!0,!1,!1)):n.SelectedObject.dictAttributes.hasOwnProperty("sfwExecuteMethodType")&&n.SelectedObject.dictAttributes.sfwExecuteMethodType=="ObjectMethod"?(n.TargetFormCaption="Object Method:",y=n.entityName?e.GetIntellisenseData(n.entityName,"","",!0,!1,!0,!1,!1,!1):e.GetIntellisenseData(n.formobject.dictAttributes.sfwEntity,"","",!0,!1,!0,!1,!1,!1)):n.SelectedObject.dictAttributes.hasOwnProperty("sfwExecuteMethodType")&&n.SelectedObject.dictAttributes.sfwExecuteMethodType=="XmlMethod"?(n.TargetFormCaption="Xml Method:",y=n.entityName?e.GetIntellisenseData(n.entityName,"","",!0,!1,!1,!1,!1,!0):e.GetIntellisenseData(n.formobject.dictAttributes.sfwEntity,"","",!0,!1,!1,!1,!1,!0)):y=n.entityName?e.GetIntellisenseData(n.entityName,"","",!0,!1,!0,!1,!1,!1):e.GetIntellisenseData(n.formobject.dictAttributes.sfwEntity,"","",!0,!1,!0,!1,!1,!1),a=n.SelectedObject.dictAttributes.sfwObjectMethod.trim(),n.TargetForm=a,it=[],y&&angular.forEach(y,function(n){p||n.ID==a&&(p=n)}),p&&(u=p.Parameters,u&&(angular.forEach(u,function(t){var i;p.RuleType&&["LogicalRule","DecisionTable","ExcelMatrix"].indexOf(p.RuleType)>-1?t.Direction=="In"&&(n.SelectedObject.dictAttributes.sfwMethodName=="btnExecuteBusinessMethodSelectRows_Click"?["Object","Collection","List"].indexOf(t.DataType)>-1?(i={ParameterField:t.ID,ParameterValue:null,IsObject:!0},n.MethodParameterCollection.push(i)):(i={ParameterField:t.ID,ParameterValue:null,IsObject:!1},n.MethodParameterCollection.push(i)):(i={ParameterField:t.ID,ParameterValue:null,IsObject:!1},n.MethodParameterCollection.push(i))):(i={ParameterField:t.ID,ParameterValue:null,IsObject:!1},n.MethodParameterCollection.push(i))}),n.PopulateParamValues(n.MethodParameterCollection))));else if(n.SelectedObject.dictAttributes.sfwMethodName=="btnExecuteServerMethod_Click"||n.SelectedObject.dictAttributes.sfwMethodName=="btnWizardFindAndNext_Click"||n.SelectedObject.dictAttributes.sfwMethodName=="btnDownload_Click"){if(n.TargetFormCaption="Server Method:",nt=n.SelectedObject.dictAttributes.sfwObjectMethod,nt==undefined||nt=="")return;if(a=nt.trim(),n.TargetForm=a,a==""||a==undefined)return;tt="srvCommon";n.formobject&&n.formobject.dictAttributes.sfwRemoteObject&&(tt=n.formobject.dictAttributes.sfwRemoteObject);var ot=f.getEntityIntellisense(),b=GetServerMethodObject(tt,n.formobject.RemoteObjectCollection),u=GetSrvMethodParameters(b,a);u&&(angular.forEach(u,function(t){var i={ParameterField:t.dictAttributes.ID};n.MethodParameterCollection.push(i)}),n.PopulateParamValues(n.MethodParameterCollection))}else if(n.SelectedObject.dictAttributes.sfwActiveForm||n.SelectedObject.dictAttributes.sfwXmlDocument){if(v=n.SelectedObject.dictAttributes.sfwActiveForm,v||n.SelectedObject.Name!=="sfwXMLPanel"?t=n.SelectedObject.dictAttributes.sfwActiveForm.split(";"):(v=n.SelectedObject.dictAttributes.sfwXmlDocument,t=n.SelectedObject.dictAttributes.sfwXmlDocument.split(";")),t.length>0){for(w="",h=0;h<t.length;h++)t[h]&&t[h].contains("=")&&(w==""?w=t[h].substring(t[h].indexOf("=")+1):w+=","+t[h].substring(t[h].indexOf("=")+1));w!=""&&(v=w)}n.TargetFormCaption="Target Form :";n.TargetForm=v;t&&t.length>0&&t[0].contains("=")&&(v=t[0].substring(t[0].indexOf("=")+1));v&&$.connection.hubMain.server.getSingleFileDetail(v).done(function(t){n.receiveSingleFileDetail(t)})}else n.SelectedObject.dictAttributes.sfwMethodName&&(n.SelectedObject.dictAttributes.sfwMethodName=="btnOpen_Click"||n.SelectedObject.dictAttributes.sfwMethodName=="btnWizardFinish_Click")&&(o={ParameterField:"aintPrimaryKey",ParameterValue:"",Constants:!1},n.XmlParameterCollection.some(function(n){return n.ParameterField==o.ParameterField})||n.XmlParameterCollection.push(o),n.PopulateParamValues(n.XmlParameterCollection));r.currentfile.FileType=="FormLinkMaintenance"||r.currentfile.FileType=="FormLinkLookup"||r.currentfile.FileType=="FormLinkWizard"?(n.PopulateAvailableFieldsForFormLink(undefined),n.isFormLink=!0):(n.PopulateAvailableFields(),n.isFormLink=!1);$.connection.hubForm.server.getGlobleParameters().done(function(t){n.$apply(function(){n.objGlobleParameters=t;n.PopulateGlobalParameters()})})};n.PopulateParamValues=function(t){var i=n.SelectedObject.dictAttributes.sfwNavigationParameter,r;i!=undefined&&i!=""&&(r=i.split(";"),angular.forEach(r,function(n){var r=n,i=n,u=!1;n.contains("=")&&(r=n.substring(0,n.indexOf("=")),i=n.substring(n.indexOf("=")+1),i.match("^#")&&(i=i.substring(1),u=!0),angular.forEach(t,function(n){n.ParameterField&&r&&n.ParameterField.toLowerCase()==r.toLowerCase()&&(n.ParameterValue=i,n.Constants=u)}))}))};n.receiveSingleFileDetail=function(i){n.sigleFileDetail=i;n.$apply(function(){var k,h,d,y,l,r,v,w,p,g,b,u,t,o,a,e;if(n.newFormModel=i,n.newFormModel!=null&&n.newFormModel!=undefined)if((n.newFormModel.dictAttributes.sfwType=="Maintenance"||n.newFormModel.dictAttributes.sfwType=="Wizard"||n.newFormModel.dictAttributes.sfwType=="FormLinkMaintenance"||n.newFormModel.dictAttributes.sfwType=="FormLinkWizard")&&n.newFormModel.dictAttributes.sfwEntity!=undefined&&n.newFormModel.dictAttributes.sfwEntity!=""){for(k=n.SelectedObject.dictAttributes.sfwMethodName=="btnNew_Click"||n.SelectedObject.dictAttributes.sfwMethodName=="btnUpdate_Click"||n.SelectedObject.dictAttributes.sfwMethodName=="btnSaveNew_Click",n.activeFormEntity=n.newFormModel.dictAttributes.sfwEntity,h="",t=0;t<n.newFormModel.Elements.length;t++)if(n.newFormModel.Elements[t].Name=="initialload")for(r=0;r<n.newFormModel.Elements[t].Elements.length;r++)if(k){if(n.newFormModel.Elements[t].Elements[r].Name=="callmethods"&&(!n.newFormModel.Elements[t].Elements[r].dictAttributes.sfwMode||n.newFormModel.Elements[t].Elements[r].dictAttributes.sfwMode=="New"))if(n.newFormModel.dictAttributes.sfwRemoteObject!=undefined&&n.newFormModel.dictAttributes.sfwRemoteObject!=""){h=n.newFormModel.Elements[t].Elements[r].dictAttributes.sfwMethodName;break}else{h=n.newFormModel.Elements[t].Elements[r].dictAttributes.sfwMethodName;break}}else if(n.newFormModel.Elements[t].Elements[r].Name=="callmethods"&&(!n.newFormModel.Elements[t].Elements[r].dictAttributes.sfwMode||n.newFormModel.Elements[t].Elements[r].dictAttributes.sfwMode=="Update"))if(n.newFormModel.dictAttributes.sfwRemoteObject!=undefined&&n.newFormModel.dictAttributes.sfwRemoteObject!=""){h=n.newFormModel.Elements[t].Elements[r].dictAttributes.sfwMethodName;break}else{h=n.newFormModel.Elements[t].Elements[r].dictAttributes.sfwMethodName;break}var c=[];if(n.newFormModel.dictAttributes.sfwRemoteObject!=undefined&&n.newFormModel.dictAttributes.sfwRemoteObject!=""){if(d=GetServerMethodObject(n.newFormModel.dictAttributes.sfwRemoteObject,n.formobject.RemoteObjectCollection),y=GetSrvMethodParameters(d,h),y)for(r=0;r<y.length;r++)u={ParameterField:y[r].dictAttributes.ID,ParameterValue:"",Constants:!1},c.push(u)}else if(h&&(l=f.getXmlMethodParameters(n.activeFormEntity,h,!0),l&&l.length))for(r=0,len=l.length;r<len;r++)u={ParameterField:l[r].ID,EntityField:l[r].Value,ParameterValue:l[r].Value,Constants:!1},c.push(u);if(n.SelectedObject&&n.SelectedObject.dictAttributes.sfwMethodName=="btnNew_Click")for(t=0;t<n.newFormModel.Elements.length;t++)if(n.newFormModel.Elements[t].Name=="initialload"){for(r=0;r<n.newFormModel.Elements[t].Elements.length;r++)if(n.newFormModel.Elements[t].Elements[r].Name=="session"){if(v=n.newFormModel.Elements[t].Elements[r],v.Elements&&v.Elements.length>0)for(e=0;e<v.Elements.length;e++)u={ParameterField:v.Elements[e].dictAttributes.ID,ParameterValue:"",Constants:!1},c.push(u);break}break}for(n.SelectedObject&&(n.SelectedObject.dictAttributes.sfwMethodName=="btnOpen_Click"||n.SelectedObject.dictAttributes.sfwMethodName=="btnWizardFinish_Click")&&n.newFormModel.Elements&&(w=!0,p=n.newFormModel.Elements.filter(function(n){return n.Name&&n.Name=="initialload"}),p.length>0&&p[0].Elements&&(g=p[0].Elements.filter(function(n){return n.Name&&n.Name=="callmethods"}),g.length>0&&(w=!1)),w&&(u={ParameterField:"aintPrimaryKey",ParameterValue:"",Constants:!1},c.push(u))),b=[],t=0;t<c.length;t++)n.XmlParameterCollection.some(function(n){return n.ParameterField==c[t].ParameterField})||(u={ParameterField:c[t].ParameterField,EntityField:c[t].EntityField,ParameterValue:"",Constants:!1},b.push(u));angular.forEach(b,function(t){n.XmlParameterCollection.push(t)});o=n.SelectedObject.dictAttributes.sfwNavigationParameter;o!=undefined&&o!=""&&n.PopulateParameters(o,"Maintenance")}else if(n.newFormModel.dictAttributes.sfwType=="Lookup")for(t=0;t<n.newFormModel.Elements.length;t++)if(n.newFormModel.Elements[t].Name=="sfwTable"){if(n.isPanelCriteria=!1,n.PopulateLookupPanel(n.newFormModel.Elements[t]),o=n.SelectedObject.dictAttributes.sfwNavigationParameter,o!=undefined&&o!="")for(n.PopulateXmlParameters(o,"Lookup"),n.IsNewActiveForm=!0,t=0;t<s.length;t++)for(r=0;r<n.LookupParameterCollection.length;r++)n.LookupParameterCollection[r].ParameterField==s[t].ParameterField&&(n.IsNewActiveForm=!1);if(o==undefined||o==""||n.LookupParameterCollection.length==s.length||n.IsNewActiveForm)if(n.LookupParameterCollection.length!=s.length||n.IsNewActiveForm)n.LookupParameterCollection=[],s.length>0&&angular.forEach(s,function(t){if(t&&t.ParameterField){var i=n.LookupParameterCollection.filter(function(n){return n.ParameterField&&n.ParameterField==t.ParameterField});i.length==0&&n.LookupParameterCollection.push(t)}});else for(t=0;t<s.length;t++)for(r=0;r<n.LookupParameterCollection.length;r++)n.LookupParameterCollection[r].ParameterField==s[t].ParameterField&&(n.LookupParameterCollection[r].ControlId=s[t].ControlId);else{for(a=[],t=0;t<s.length;t++)for(r=0;r<n.LookupParameterCollection.length;r++)if(n.LookupParameterCollection[r].ParameterField!=s[t].ParameterField){var u={ControlId:s[t].ControlId,ParameterField:s[t].ParameterField,ParameterValue:"",Constants:!1},nt=!1,tt=!1;if(a.length>0)for(e=0;e<a.length;e++)a[e].ParameterField==u.ParameterField&&(nt=!0);if(n.LookupParameterCollection.length>0)for(e=0;e<n.LookupParameterCollection.length;e++)n.LookupParameterCollection[e].ParameterField==u.ParameterField&&(tt=!0);!nt&&!tt&&u&&u.ParameterField&&a.push(u)}else n.LookupParameterCollection[r].ParameterField==s[t].ParameterField&&(n.LookupParameterCollection[r].ControlId=s[t].ControlId);angular.forEach(a,function(t){if(t&&t.ParameterField){var i=n.LookupParameterCollection.filter(function(n){return n.ParameterField&&n.ParameterField==t.ParameterField});i.length==0&&n.LookupParameterCollection.push(t)}})}break}});n.$evalAsync(function(){t.IsLoading=!1})};n.receivenewformmodel=function(i){n.$apply(function(){var r,v,c,p,k,l,o,t,u,a,e;if(n.newFormModel=i,n.newFormModel!=null&&n.newFormModel!=undefined)if(n.ActiveFormType=="Maintenance"&&n.newFormModel.dictAttributes.sfwEntity!=undefined&&n.newFormModel.dictAttributes.sfwEntity!=""){for(n.activeFormEntity=n.newFormModel.dictAttributes.sfwEntity,v="",t=0;t<n.newFormModel.Elements.length;t++)if(n.newFormModel.Elements[t].Name=="initialload")for(r=0;r<n.newFormModel.Elements[t].Elements.length;r++)n.newFormModel.Elements[t].Elements[r].dictAttributes.sfwMode&&(v=n.newFormModel.Elements[t].Elements[r].dictAttributes.sfwMethodName);var h=[];if(v&&(c=f.getXmlMethodParameters(n.activeFormEntity,v,!0),c&&c.length)){for(r=0,len=c.length;r<len;r++)o={ParameterField:c[r].ID,EntityField:c[r].Value,ParameterValue:c[r].Value,Constants:!1},h.push(o);if(u=n.SelectedObject.dictAttributes.sfwNavigationParameter,u!=undefined&&u!="")for(n.PopulateXmlParameters(u,"Maintenance"),n.IsNewActiveForm=!0,t=0;t<h.length;t++)for(r=0;r<n.XmlParameterCollection.length;r++)n.XmlParameterCollection[r].ParameterField==h[t].ParameterField&&(n.IsNewActiveForm=!1);if(u==undefined||u==""||n.XmlParameterCollection.length==h.length||n.IsNewActiveForm)(n.XmlParameterCollection.length!=h.length||n.IsNewActiveForm)&&(n.XmlParameterCollection=[],angular.forEach(h,function(t){n.XmlParameterCollection.push(t)}));else{for(p=[],t=0;t<h.length;t++)for(r=0;r<n.XmlParameterCollection.length;r++)n.XmlParameterCollection[r].ParameterField!=h[t].ParameterField&&(o={ParameterField:h[t].ParameterField,EntityField:h[t].EntityField,ParameterValue:"",Constants:!1},p.push(o));angular.forEach(p,function(t){n.XmlParameterCollection.push(t)})}}var b=[],y=[],w=n.formobject.Elements.filter(function(n){return n.Name=="initialload"});if(n.SelectedObject&&n.SelectedObject.Name=="sfwButton"&&n.SelectedObject.dictAttributes.sfwMethodName&&n.SelectedObject.dictAttributes.sfwMethodName=="btnNew_Click"&&w&&w.length>0&&(k=w[0],l=k.Elements.filter(function(n){return n.Name=="session"}),l&&l.Elements&&l.Elements.length>0))for(e=0;e<l.Elements.length;e++)o={ParameterField:l.Elements[e].dictAttributes.ID,ParameterValue:"",Constants:!1},y.push(o);for(t=0;t<y.length;t++)n.XmlParameterCollection.some(function(n){return n.ParameterField==y[t].ParameterField})||(o={ParameterField:y[t].ParameterField,ParameterValue:"",Constants:!1},b.push(o));angular.forEach(b,function(t){n.XmlParameterCollection.push(t)})}else if(n.ActiveFormType=="Lookup")for(t=0;t<n.newFormModel.Elements.length;t++)if(n.newFormModel.Elements[t].Name=="sfwTable"){if(n.isPanelCriteria=!1,n.PopulateLookupPanel(n.newFormModel.Elements[t]),u=n.SelectedObject.dictAttributes.sfwNavigationParameter,u!=undefined&&u!="")for(n.PopulateXmlParameters(u,"Lookup"),n.IsNewActiveForm=!0,t=0;t<s.length;t++)for(r=0;r<n.LookupParameterCollection.length;r++)n.LookupParameterCollection[r].ParameterField==s[t].ParameterField&&(n.IsNewActiveForm=!1);if(u==undefined||u==""||n.LookupParameterCollection.length==s.length||n.IsNewActiveForm)if(n.LookupParameterCollection.length!=s.length||n.IsNewActiveForm)n.LookupParameterCollection=[],s.length>0&&angular.forEach(s,function(t){n.LookupParameterCollection.push(t)});else for(t=0;t<s.length;t++)for(r=0;r<n.LookupParameterCollection.length;r++)n.LookupParameterCollection[r].ParameterField==s[t].ParameterField&&(n.LookupParameterCollection[r].ControlId=s[t].ControlId);else{for(a=[],t=0;t<s.length;t++)for(r=0;r<n.LookupParameterCollection.length;r++)if(n.LookupParameterCollection[r].ParameterField!=s[t].ParameterField){var o={ControlId:s[t].ControlId,ParameterField:s[t].ParameterField,ParameterValue:"",Constants:!1},d=!1,g=!1;if(a.length>0)for(e=0;e<a.length;e++)a[e].ParameterField==o.ParameterField&&(d=!0);if(n.LookupParameterCollection.length>0)for(e=0;e<n.LookupParameterCollection.length;e++)n.LookupParameterCollection[e].ParameterField==o.ParameterField&&(g=!0);d||g||a.push(o)}else n.LookupParameterCollection[r].ParameterField==s[t].ParameterField&&(n.LookupParameterCollection[r].ControlId=s[t].ControlId);angular.forEach(a,function(t){var i=n.LookupParameterCollection.filter(function(n){return t==n.ParameterField});n.LookupParameterCollection.push(t)})}break}});n.$evalAsync(function(){t.IsLoading=!1})};n.PopulateAvailableFields=function(){var t,e,i,h,o,y,c,u;if(n.EntityFieldCollection=[],t={ID:"Main",IsExpanded:!1,IsSelected:!1,Elements:[]},n.IsLookup=n.formobject.dictAttributes.sfwType=="Lookup"?!0:!1,n.blnIsReport=n.formobject.dictAttributes.sfwType=="Report"?!0:!1,n.blnIsCorr=n.formobject.dictAttributes.sfwType=="Correspondence"?!0:!1,e=n.IsFormCodeGroup||n.SelectedObject.dictAttributes.sfwMethodName=="btnNew_Click"||n.SelectedObject.Name=="sfwCascadingDropDownList"||n.SelectedObject.Name=="sfwSeries"?"ID":n.IsLookup?"sfwDataField":n.blnIsReport||n.blnIsCorr?"ID":"sfwEntityField",n.SelectedObject.Name=="sfwOpenDetail"){if(n.SelectedObject.dictAttributes.sfwQueryID&&(i=n.SelectedObject.dictAttributes.sfwQueryID.split("."),i&&i.length==2)){var l=i[0],a=i[1],v=f.getEntityIntellisense(),s=r("filter")(v,{ID:l},!0);s&&s.length>0&&(h=s[0],o=h.Queries.filter(function(n){return n.ID==a}),o&&o.length>0&&(y=o[0],$.connection.hubForm.server.getEntityQueryColumns(n.SelectedObject.dictAttributes.sfwQueryID,"NavigationParameterController").done(function(t){n.receiveQueryColumns(t)})))}}else{if(n.SelectedObject.IsShowAllControl==!0){for(u=0;u<n.formobject.Elements.length;u++)if(n.formobject.Elements[u].Name=="sfwTable"){c=n.formobject.Elements[u];break}n.PopulateControls(c,t,e)}else n.blnIsReport||n.blnIsCorr?n.PopulateControls(n.currentPanel,t,e):n.PopulateControls(n.currentPanel.Elements[0],t,e);n.EntityFieldCollection.push(t)}};n.receiveQueryColumns=function(t){n.$apply(function(){for(var u,r={ID:n.SelectedObject.dictAttributes.sfwQueryID,IsSelected:!1,Elements:[]},i=0;i<t.length;i++)u={ID:t[i].CodeID,IsSelected:!1,Elements:[]},r.Elements.push(u);n.EntityFieldCollection.push(r)})};n.PopulateControls=function(t,i,r){var u="";t&&angular.forEach(t.Elements,function(t){for(var e,f=0;f<t.Elements.length;f++)e=t.Elements[f],e&&angular.forEach(e.Elements,function(t){var f,h,c,s,e,o,l,a;if(t.Name=="sfwPanel"||t.Name=="sfwDialogPanel"||t.Name=="sfwListView")u=t.dictAttributes.ID,(u==""||u==undefined)&&(u=t.Name),f={ID:u,IsSelected:!1,Elements:[]},f.IsExpanded=!1,t.Elements.length>0&&t.Elements[0].Name=="sfwTable"&&n.PopulateControls(t.Elements[0],f,r),i.Elements.push(f);else if(t.Name=="sfwTabContainer")t.Elements.length>0&&t.Elements[0].Name=="Tabs"&&(h=t.Elements[0],angular.forEach(h.Elements,function(t){u=t.dictAttributes.HeaderText;u==""&&(u=t.dictAttributes.ID);var f={ID:u,IsSelected:!1,Elements:[]};t.Elements.length>0&&t.Elements[0].Name=="sfwTable"&&n.PopulateControls(t.Elements[0],f,r);f.Elements.length>0&&i.Elements.push(f)}));else if(t.Name=="sfwWizard")angular.forEach(t.Elements,function(t){if(t.Name=="HeaderTemplate"){u="HeaderTemplate";var f={ID:u,IsSelected:!1,Elements:[]};t.Elements.length>0&&t.Elements[0].Name=="sfwTable"&&n.PopulateControls(t.Elements[0],f,r);f.Elements.length>0&&i.Elements.push(f)}else angular.forEach(t.Elements,function(t){u=t.dictAttributes.Title;u==""&&(u=t.dictAttributes.ID);var f={ID:u,IsSelected:!1,Elements:[]};t.Elements.length>0&&t.Elements[0].Name=="sfwTable"&&(n.PopulateControls(t.Elements[0],f,r),f.Elements.length>0&&i.Elements.push(f))})});else if(t.Elements.length>0&&t.Name=="sfwGridView"){if(c=t.dictAttributes.ID,s={ID:c+" (Data Keys)",IsSelected:!1,Elements:[]},i.Elements.push(s),t.Elements.length>0&&t.Elements[0].Name=="Columns")for(e=0;e<t.Elements[0].Elements.length;e++)o=t.Elements[0].Elements[e],o.Elements.length>0&&o.Elements[0].Name=="ItemTemplate"&&(l=o.Elements[0],angular.forEach(l.Elements,function(n){if("sfwEntityField"in n.dictAttributes){var t="";t=n.dictAttributes.sfwEntityField;t!=""&&t!=undefined&&s.Elements.push({ID:t,IsSelected:!1,Elements:[]})}}))}else r!=undefined&&r!=""?n.blnIsReport||n.blnIsCorr?u=t.dictAttributes[r]:(n.IsLookup&&!IsCriteriaField(t)&&(r="sfwEntityField"),"sfwDataField"in t.dictAttributes?u=t.dictAttributes[r]:"sfwEntityField"in t.dictAttributes&&(u=t.dictAttributes[r])):u=t.dictAttributes.ID,u!=""&&u!=undefined&&t.Name!="sfwButton"&&t.Name!="sfwLinkButton"&&t.Name!="sfwImageButton"&&(i.Elements.some(function(n){return n.ID==u})||(a={ID:u,Elements:[]},i.Elements.push(a)))})})};n.PopulateEntityFields=function(t,i){for(var r=0;r<t.Elements.length;r++)t.Elements[r].dictAttributes.sfwEntityField!=undefined&&i.Elements.push({ID:t.Elements[r].dictAttributes.sfwEntityField,Elements:[]}),t.Elements[r].Elements.length>0&&n.PopulateEntityFields(t.Elements[r],i)};n.PopulateGlobalParameters=function(){function u(n){var r,u;n.dictAttributes&&n.dictAttributes.ID&&(r=n.dictAttributes.ID,i.filter(function(n){return n==r.trim()})||i.push(r.trim()),u={ID:"~"+r,IsExpanded:!1,IsSelected:!1,Elements:[]},t.Elements.push(u))}var r,i,t;if(n.GlobalParamCollection=[],n.objGlobleParameters&&(r=n.formobject.dictAttributes.sfwType,n.SelectedObject.Name=="sfwTextBox"||n.SelectedObject.Name=="sfwButton"||n.SelectedObject.Name=="sfwCascadingDropDownList"||n.SelectedObject.Name=="sfwDropDownList"||n.SelectedObject.Name=="sfwMultiSelectDropDownList"||n.SelectedObject.Name=="sfwSeries"||n.SelectedObject.Name=="sfwListBox"||n.SelectedObject.Name=="sfwCheckBoxList"||n.SelectedObject.Name=="sfwRadioButtonList"||n.SelectedObject.Name=="sfwMultiCorrespondence")){if(n.SelectedObject.Name=="sfwButton"&&n.SelectedObject.dictAttributes.sfwMethodName!="btnOpen_Click"&&n.SelectedObject.dictAttributes.sfwMethodName!="btnNew_Click")return;i=[];n.objGlobleParameters.Elements.length>0&&(t={ID:"Global Parameters",IsExpanded:!1,IsSelected:!1,Elements:[],IsVisible:!0},angular.forEach(n.objGlobleParameters.Elements,u),t.Elements.length>0&&(n.EntityFieldCollection.push(t),r=="Correspondence"&&n.GlobalParamCollection.push(t)))}};n.GetQueryFromEntity=function(){var e,t,o,i;if(n.SelectedObject.dictAttributes.sfwLoadSource&&n.SelectedObject.dictAttributes.sfwLoadType=="Query"&&(t=n.SelectedObject.dictAttributes.sfwLoadSource.split("."),t&&t.length==2)){var s=t[0],h=t[1],c=f.getEntityIntellisense(),u=r("filter")(c,{ID:s},!0);u&&u.length>0&&(o=u[0],i=o.Queries.filter(function(n){return n.ID==h}),i&&i.length>0&&(e=i[0]))}return e};n.PopulateNavigationParameters=function(){var h,l,s,p,u,t,a,w,i,b,y,v,r;if(n.strSelectedParameters=n.SelectedObject.Name==="sfwCascadingDropDownList"||n.SelectedObject.Name==="sfwMultiSelectDropDownList"&&n.SelectedObject.dictAttributes.sfwLoadType==="CodeGroup"?n.SelectedObject.dictAttributes.sfwParameters:n.SelectedObject.dictAttributes.sfwNavigationParameter,n.SelectedObject.dictAttributes.sfwLoadSource&&n.SelectedObject.dictAttributes.sfwLoadType=="Query")n.thisQuery=n.GetQueryFromEntity(),n.thisQuery!=undefined&&n.thisQuery!=""&&(n.ParameterCollection=[],angular.forEach(n.thisQuery.Parameters,function(t){ParameterField=t.ID;strParamField=ParameterField.contains("@")?ParameterField.substring(ParameterField.indexOf("@")+1,ParameterField.length):ParameterField;var i={ParameterField:strParamField,ParameterValue:""};n.ParameterCollection.push(i)}));else if(n.SelectedObject.dictAttributes.sfwLoadSource&&n.SelectedObject.dictAttributes.sfwLoadType=="ChildMethod"){if(t=n.SelectedObject.dictAttributes.sfwLoadSource.trim(),n.TargetForm=t,t==""||t==undefined)return;n.TargetForm=t;h=FindParent(n.SelectedObject,"sfwGridView");h==null&&(h=FindParent(n.SelectedObject,"sfwListView"));h&&(l=o.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,h.dictAttributes.sfwEntityField),l&&l.Entity&&(s=e.GetIntellisenseData(l.Entity,"","",!0,!1,!0,!1,!1,!1),p=[],s&&angular.forEach(s,function(n){u||n.ID==t&&(u=n)}),u&&(i=u.Parameters,i&&angular.forEach(i,function(t){var i={ParameterField:t.ID,ParameterValue:""};n.ParameterCollection.push(i)}))))}else if(n.SelectedObject.dictAttributes.sfwLoadSource&&n.SelectedObject.dictAttributes.sfwLoadType=="Method"){if(t=n.SelectedObject.dictAttributes.sfwLoadSource.trim(),n.TargetForm=t,t==""||t==undefined)return;n.TargetForm=t;s=e.GetIntellisenseData(n.formobject.dictAttributes.sfwEntity,"","",!0,!1,!0,!1,!1,!1);p=[];s&&angular.forEach(s,function(n){u||n.ID==t&&(u=n)});u&&(i=u.Parameters,i&&angular.forEach(i,function(t){var i={ParameterField:t.ID,ParameterValue:""};n.ParameterCollection.push(i)}))}else if(n.SelectedObject&&n.SelectedObject.dictAttributes.sfwLoadSource&&n.SelectedObject.dictAttributes.sfwLoadType=="ServerMethod"){if(t=n.SelectedObject.dictAttributes.sfwLoadSource.trim(),n.TargetForm=t,t==""||t==undefined)return;if(n.TargetForm=t,a="srvCommon",n.formobject&&n.formobject.dictAttributes.sfwRemoteObject&&(a=n.formobject.dictAttributes.sfwRemoteObject),a&&(w=GetServerMethodObject(a,n.formobject.RemoteObjectCollection),i=GetSrvMethodParameters(w,t),i))for(r=0;r<i.length;r++)b={ParameterField:i[r].dictAttributes.ID,ParameterValue:"",Constants:!1},n.XmlParameterCollection.push(b)}else(n.SelectedObject.Name=="sfwCascadingDropDownList"||n.SelectedObject.Name=="sfwMultiSelectDropDownList")&&(n.SelectedObject.dictAttributes.sfwLoadSource||n.SelectedObject.placeHolder)&&n.SelectedObject.dictAttributes.sfwLoadType=="CodeGroup"&&(n.ParameterCollection.push({ParameterField:"data1",ParameterValue:""}),n.ParameterCollection.push({ParameterField:"data2",ParameterValue:""}),n.ParameterCollection.push({ParameterField:"data3",ParameterValue:""}));if(n.ParameterCollection!=undefined&&n.ParameterCollection.length>0&&n.strSelectedParameters!=undefined)for(y=n.strSelectedParameters.split(";"),v=0;v<y.length;v++){var f=y[v],k=f,c=f,d=!1;for(f.contains("=")&&(k=f.substring(0,f.indexOf("=")),c=f.substring(f.indexOf("=")+1),c.match("^#")&&(c=c.substring(1),d=!0)),r=0;r<n.ParameterCollection.length;r++)n.ParameterCollection[r].ParameterField==k&&(n.ParameterCollection[r].ParameterValue=c,n.ParameterCollection[r].Constants=d)}};s=[];n.PanelCriteria;n.PopulateLookupPanel=function(t){var i,f,e,r,u,o;if(t&&(i=getDescendents(t),i&&i.length>0&&(i=i.filter(function(n){return n.Name=="sfwPanel"}),i&&i.length>0)))for(f=0;f<i.length;f++)if(e=getDescendents(i[f]),e&&e.length>0&&e.some(function(n){return n.Name=="sfwTable"&&n.dictAttributes.ID=="tblCriteria"})){if(n.PanelCriteria=i[f],r=getDescendents(n.PanelCriteria),r&&r.length>0)for(u=0;u<r.length;u++)r[u]&&r[u].dictAttributes.sfwDataField&&(o={ControlId:r[u].dictAttributes.ID,ParameterField:r[u].dictAttributes.sfwDataField,ParameterValue:"",Constants:!1},s.push(o));break}};n.XmlParameterCollection=[];n.PopulateXmlParameters=function(t,i){var r=t.split(";");angular.forEach(r,function(t){var u;if(t!=undefined&&t!=""){var f=t,r=t,e=!1;t.contains("=")&&(f=t.substring(0,t.indexOf("=")),r=t.substring(t.indexOf("=")+1),r.match("^#")&&(r=r.substring(1),e=!0));i=="Maintenance"?(u={ParameterField:f,EntityField:r,ParameterValue:r,Constants:e},n.XmlParameterCollection.push(u)):i=="Lookup"?(u={ControlId:"",ParameterField:f,ParameterValue:r,Constants:e},n.LookupParameterCollection.push(u)):(u={ParameterField:f,ParameterValue:r,Constants:e},n.MethodParameterCollection.push(u))}})};n.PopulateParameters=function(t,i){var r=t.split(";");angular.forEach(r,function(t){var r;if(t!=undefined&&t!=""){var f=t,u=t,e=!1;t.contains("=")&&(f=t.substring(0,t.indexOf("=")),u=t.substring(t.indexOf("=")+1),u.match("^#")&&(u=u.substring(1),e=!0));i=="Maintenance"?(r=n.XmlParameterCollection.filter(function(n){return n.ParameterField==f}),r&&r.length>0&&(r[0].ParameterValue=u,r[0].Constants=e)):i=="Lookup"?(r=n.LookupParameterCollection.filter(function(n){return n.ParameterField==f}),r&&r.length>0&&(r[0].ParameterValue=u,r[0].Constants=e)):(r=n.MethodParameterCollection.filter(function(n){return n.ParameterField==f}),r&&r.length>0&&(r[0].ParameterValue=u,r[0].Constants=e))}})};n.showAllControlChange=function(){n.PopulateAvailableFields();n.PopulateGlobalParameters()};n.ExpandCollapsedControl=function(n){n.IsExpanded=!n.IsExpanded};n.SelectFieldClick=function(t,i){n.SelectedField=t;i&&i.stopPropagation()};n.SetFieldClass=function(t){if(t==n.SelectedField)return"selected"};n.strSelectedParameters;n.onOkClick=function(){var i="",r,u;n.ParameterCollection.length>0?i=n.GetSavedString(n.ParameterCollection):n.LookupParameterCollection.length>0?i=n.GetSavedString(n.LookupParameterCollection):n.XmlParameterCollection.length>0?i=n.GetSavedString(n.XmlParameterCollection):n.MethodParameterCollection.length>0&&(i=n.GetSavedString(n.MethodParameterCollection));i!=undefined&&(n.SelectedObject.Name=="sfwCascadingDropDownList"||n.SelectedObject.Name==="sfwMultiSelectDropDownList"&&n.SelectedObject.dictAttributes.sfwLoadType==="CodeGroup"?t.EditPropertyValue(n.SelectedObject.dictAttributes.sfwParameters,n.SelectedObject.dictAttributes,"sfwParameters",i):n.SelectedObject.dictAttributes.sfwActiveForm&&n.SelectedObject.dictAttributes.sfwActiveForm.trim().length>0?n.SelectedObject.dictAttributes.sfwMethodName=="btnNew_Click"?(r=n.SelectedObject.dictAttributes.sfwActiveForm.contains("=")?n.SelectedObject.dictAttributes.sfwRelatedControl:"",i==""?t.EditPropertyValue(n.SelectedObject.dictAttributes.sfwNavigationParameter,n.SelectedObject.dictAttributes,"sfwNavigationParameter",r):r&&r!=""?t.EditPropertyValue(n.SelectedObject.dictAttributes.sfwNavigationParameter,n.SelectedObject.dictAttributes,"sfwNavigationParameter",i+";"+r):t.EditPropertyValue(n.SelectedObject.dictAttributes.sfwNavigationParameter,n.SelectedObject.dictAttributes,"sfwNavigationParameter",i)):n.SelectedObject.dictAttributes.sfwMethodName=="btnOpen_Click"?(u=n.SelectedObject.dictAttributes.sfwActiveForm.contains("=")?n.SelectedObject.dictAttributes.sfwEntityField:"",i==""?t.EditPropertyValue(n.SelectedObject.dictAttributes.sfwNavigationParameter,n.SelectedObject.dictAttributes,"sfwNavigationParameter",u):u?t.EditPropertyValue(n.SelectedObject.dictAttributes.sfwNavigationParameter,n.SelectedObject.dictAttributes,"sfwNavigationParameter",i+";"+u):t.EditPropertyValue(n.SelectedObject.dictAttributes.sfwNavigationParameter,n.SelectedObject.dictAttributes,"sfwNavigationParameter",i)):t.EditPropertyValue(n.SelectedObject.dictAttributes.sfwNavigationParameter,n.SelectedObject.dictAttributes,"sfwNavigationParameter",i):t.EditPropertyValue(n.SelectedObject.dictAttributes.sfwNavigationParameter,n.SelectedObject.dictAttributes,"sfwNavigationParameter",i));n.onCancelClick()};n.onCancelClick=function(){n.NavigationParameterDialog.close()};n.GetSavedString=function(n){var t="";return angular.forEach(n,function(n){var u=n.ParameterField,i=n.ParameterValue,f,r;i!=""&&u!=undefined&&i!=undefined&&i!=""&&u!=undefined&&u!=""&&(f=n.Constants,f&&(i="#"+i),r=i,i!=undefined&&i!=""&&i.toLowerCase()!=u.toLowerCase()&&(r=u+"="+i),r!=undefined&&r!=""&&(t==""?t=r:t+=";"+r))}),t};n.PopulateAvailableFieldsForFormLink=function(t){var c,i,l,u,b,e,o;if(n.EntityFieldCollection=[],n.formobject){var h=[],a=n.formobject.dictAttributes.sfwType,v=a.toUpperCase().trim()=="FORMLINKLOOKUP";if(n.SourceForm=n.formobject.dictAttributes.ID,c=n.IsFormCodeGroup||n.SelectedObject.dictAttributes.sfwMethodName&&n.SelectedObject.dictAttributes.sfwMethodName=="btnNew_Click"||n.SelectedObject.Name=="sfwCascadingDropDownList"||n.SelectedObject.Name=="sfwSeries"?"ID":v?"sfwDataField":"sfwEntityField",n.SelectedObject.Name=="sfwOpenDetail"){if(n.SelectedObject.dictAttributes.sfwQueryID&&(i=n.SelectedObject.dictAttributes.sfwQueryID.split("."),i&&i.length==2)){var y=i[0],p=i[1],w=f.getEntityIntellisense(),s=r("filter")(w,{ID:y},!0);s&&s.length>0&&(l=s[0],u=l.Queries.filter(function(n){return n.ID==p}),u&&u.length>0&&(b=u[0],$.connection.hubForm.server.getEntityQueryColumns(n.SelectedObject.dictAttributes.sfwQueryID,"NavigationParameterController").done(function(t){n.receiveQueryColumns(t)})))}}else e={ID:"Main",IsExpanded:!1,IsSelected:!1,Elements:[]},o=n.GetItemsModel(),o&&(t!=undefined&&t!=""&&n.PopulateChildIDsFormLink(t,o,h),n.PopulateAvailableFieldsFormLink(c,o,e.Elements,h,t)),e.Elements.length>0&&n.EntityFieldCollection.push(e)}};n.GetSelectedWizardStep=function(n){for(var i=null,t=n.ParentVM;null!=t;){if(t.Name=="sfwWizardStep"){i=t;break}t=t.ParentVM}return i};n.GetItemsModel=function(){var t;return(t=n.formobject.Elements.filter(function(n){return n.Name=="items"}),t&&t.length>0)?t[0]:t};n.PopulateChildIDsFormLink=function(n,t,i){function r(t){if(t._dictAttributes.hasOwnProperty("sfwParentControl")){var r=t.dictAttributes.ID,u=t.dictAttributes.sfwParentControl;u==n&&(i.push(r),PopulateChildIDsFormLink(r,t,i))}}t&&angular.foreach(t.Elements,r)};n.PopulateAvailableFieldsFormLink=function(t,i,r,u,f){function o(n){if(n==strCtrlID){blnAdd=!1;return}}function s(i){strTreeCaption=i.dictAttributes.Title;(strTreeCaption==""||strTreeCaption==undefined)&&(strTreeCaption=i.dictAttributes.ID);r.push({ID:strTreeCaption,Elements:[],IsExpanded:!1,IsSelected:!1});i.Elements.length>0&&(n.PopulateAvailableFieldsFormLink(t,i.Elements[0],r[e].Elements,u,f),r[e].Elements.length==0?r.splice(e,1):e++)}function h(i){i.Name=="HeaderTemplate"?(strTreeCaption="HeaderTemplate",r.push({ID:strTreeCaption,Elements:[],IsExpanded:!1,IsSelected:!1}),i.Elements.length>0&&n.PopulateAvailableFieldsFormLink(t,i.Elements[0],r[e].Elements,u,f),r[e].Elements.length==0?r.splice(e,1):e++):angular.forEach(i.Elements,s)}function c(i){strTreeCaption=i.dictAttributes.HeaderText;(strTreeCaption==""||strTreeCaption==undefined)&&(strTreeCaption=i.dictAttributes.ID);r.push({ID:strTreeCaption,Elements:[],IsExpanded:!1,IsSelected:!1});i.Elements.length>0&&n.PopulateAvailableFieldsFormLink(t,i.Elements[0],r[e].Elements,u,f);r[e].Elements.length==0?r.splice(e,1):e++}function l(i){var s="",l,b,k,p,w,nt,a,v,d,g,tt,y;if(i.Name=="items")n.PopulateAvailableFieldsFormLink(t,i,r[e].Elements,u,f);else if(i.Name=="sfwListView")s=i.dictAttributes.sfwCaption,s||(s=i.dictAttributes.ID),l={ID:s,Elements:[],IsExpanded:!1,IsSelected:!1},i.Elements.length>0&&n.PopulateAvailableFieldsFormLink(t,i,l.Elements,u,f),r.push(l);else if(i.Name=="sfwPanel"||i.Name=="sfwDialogPanel")s=i.dictAttributes.sfwCaption,s||(s=i.dictAttributes.ID),l={ID:s,Elements:[],IsExpanded:!1,IsSelected:!1},i.Elements.length>0&&n.PopulateAvailableFieldsFormLink(t,i.Elements[0],l.Elements,u,f),r.push(l);else if(i.Name=="sfwTabContainer")i.Elements.length>0&&i.Elements[0].Name=="Tabs"&&(b=i.Elements[0],angular.forEach(b.Elements,c));else if(i.Name=="sfwWizard")angular.forEach(i.Elements,h);else if(i.Name=="sfwGridView"&&n.SelectedObject.Name!="sfwTextBox"){if(k=i.dictAttributes.ID,p={ID:k+" (Data Keys)",Elements:[],IsSelected:!1,IsExpanded:!1},r.push(p),w=i.dictAttributes.sfwDataKeyNames,w&&(nt=w.split(",")),i.Elements.length>0&&i.Elements[0].Name=="Columns")for(a=0;a<i.Elements[0].Elements.length;a++)v=i.Elements[0].Elements[a],v.Elements.length>0&&v.Elements[0].Name=="ItemTemplate"&&(d=v.Elements[0],angular.forEach(d.Elements,function(n){if("sfwEntityField"in n.dictAttributes){var t="";t=f!=""&&f!=undefined?i.dictAttributes.ID:n.dictAttributes.sfwEntityField;t!=undefined&&t!=""&&p.Elements.push({ID:t,Elements:[],IsSelected:!1,IsExpanded:!1})}}))}else t in i.dictAttributes&&(g=!0,tt=i.dictAttributes.ID,angular.forEach(u,o),g&&(y="",y=f!=undefined&&f!=""?i.dictAttributes.ID:i.dictAttributes[t],y&&i.Name!="sfwButton"&&r.push({ID:y,Elements:[],IsSelected:!1,IsExpanded:!1}),i.Elements.length>0&&n.PopulateAvailableFieldsFormLink(t,i.Elements[0],r[e].Elements,u,f),e++))}var e=0;i!=null&&angular.forEach(i.Elements,l)};n.Init()}]);app.directive("parameterdraggable",[function(){return{restrict:"A",scope:{dragdata:"="},link:function(n,t){function r(t){t.stopPropagation();n.dragdata!=undefined&&n.dragdata!=""&&(dragDropData=n.dragdata,t.dataTransfer.setData("text",JSON.stringify(n.dragdata)))}var i=t[0];i.draggable=!0;i.addEventListener("dragstart",r,!1)}}}]);app.directive("parameterdroppable",[function(){return{restrict:"A",scope:{dropdata:"="},link:function(n,t){var i=t[0];i.addEventListener("dragover",function(n){n.dataTransfer.dropEffect="copy";n.preventDefault&&n.preventDefault()});i.addEventListener("drop",function(t){var r;if(t.preventDefault(),r=t.dataTransfer.getData("Text"),r==""&&lstEntityTreeFieldData!=null){var i=lstEntityTreeFieldData,u=i[0],f=i[1],e=i[2],o=i[3],h=i[4],s=u;f!=""&&(s=f+"."+u);h=="false"&&e!=="Collection"&&e!=="List"&&o!=undefined&&o!=""&&n.$apply(function(){n.dropdata=s});lstEntityTreeFieldData=null}else lstEntityTreeFieldData=null,dragDropData&&n.$apply(function(){n.dropdata=dragDropData;dragDropData=null});t.stopPropagation&&t.stopPropagation()},!1)}}}]);app.controller("NavParamGridSearchController",["$scope","$rootScope","$filter","ParameterFactory","$EntityIntellisenseFactory","$ValidationService",function(n,t,i,r,u,f){n.SelectedObject.IsShowAllControl=!1;n.FieldCollection=[];n.Init=function(){var r,f,i,u,t;if(n.formobject.dictAttributes.sfwType=="FormLinkMaintenance"||n.formobject.dictAttributes.sfwType=="FormLinkLookup"||n.formobject.dictAttributes.sfwType=="FormLinkWizard"){if(i={ID:"Main",IsExpanded:!1,IsSelected:!1,Elements:[]},u=n.SelectedObject.dictAttributes.sfwNavigationParameter,u&&(f=u.split(";")),n.formobject)for(t=0;t<n.formobject.Elements.length;t++)if(n.formobject.Elements[t].Name=="items"){r=n.formobject.Elements[t];break}r&&(n.PopulateAvailableFieldsFormLink(f,r,i),i.Elements.length>0&&n.FieldCollection.push(i));n.isFormLink=!0}else n.PopulateAvailableFields(),n.isFormLink=!1};n.PopulateAvailableFields=function(){var r,t,u,f,i;if(n.FieldCollection=[],t={ID:"Main",IsExpanded:!1,IsSelected:!1,Elements:[]},u=n.SelectedObject.dictAttributes.sfwNavigationParameter,u&&(r=u.split(";")),n.SelectedObject.IsShowAllControl==!0){for(i=0;i<n.formobject.Elements.length;i++)if(n.formobject.Elements[i].Name=="sfwTable"){f=n.formobject.Elements[i];break}n.PopulateControls(f,t,r)}else n.currentTable&&n.PopulateControls(n.currentTable,t,r);t.Elements.length>0&&n.FieldCollection.push(t)};n.PopulateControls=function(t,i,r){function f(t){u=t.dictAttributes.Title;(u==""||u==undefined)&&(u=t.dictAttributes.ID);var f={ID:u,Elements:[],IsExpanded:!1,IsSelected:!1};t.Elements.length>0&&(n.PopulateControls(t.Elements[0],f,r),f.Elements.length>0&&(i.Elements.push(f),i.IsExpanded=!0))}function e(t){if(t.Name=="HeaderTemplate"){u="HeaderTemplate";var e={ID:u,Elements:[],IsExpanded:!1,IsSelected:!1};t.Elements.length>0&&n.PopulateControls(t.Elements[0],e,r);e.Elements.length>0&&(i.Elements.push(e),i.IsExpanded=!0)}else angular.forEach(t.Elements,f)}function o(t){u=t.dictAttributes.HeaderText;(u==undefined||u=="")&&(u=t.dictAttributes.ID);var f={ID:u,IsExpanded:!1,IsSelected:!1,Elements:[]};t.Elements.length>0&&t.Elements[0].Name=="sfwTable"&&(n.PopulateControls(t.Elements[0],f,r),f.IsExpanded=!0);f.Elements.length>0&&(i.Elements.push(f),i.IsExpanded=!0)}function s(t){var f,c,s,h;t.Name=="sfwPanel"?(u=t.dictAttributes.sfwCaption,(u==undefined||u=="")&&(u=t.dictAttributes.ID),f={ID:u,IsExpanded:!1,IsSelected:!1,Elements:[]},t.Elements.length>0&&t.Elements[0].Name=="sfwTable"&&(n.PopulateControls(t.Elements[0],f,r),f.IsExpanded=!0),f.Elements.length>0&&(i.Elements.push(f),i.IsExpanded=!0)):t.Name=="sfwTabContainer"?t.Elements.length>0&&t.Elements[0].Name=="Tabs"&&(c=t.Elements[0],angular.forEach(c.Elements,o)):t.Name=="sfwWizard"?angular.forEach(t.Elements,e):(t.Name=="sfwTextBox"||t.Name=="sfwDropDownList"||t.Name=="sfwCascadingDropDownList")&&(s=t.dictAttributes.ID,s!=undefined&&s!=""&&(h={ID:s,IsExpanded:!1,IsSelected:!1,IsCheckBoxVisible:!0,Elements:[]},r&&angular.forEach(r,function(n){n==s&&(h.IsSelected=!0)}),i.Elements.push(h)))}function h(n){for(var i,t=0;t<n.Elements.length;t++)i=n.Elements[t],i&&angular.forEach(i.Elements,s)}var u="";t&&angular.forEach(t.Elements,h)};n.showAllControlChange=function(){n.PopulateAvailableFields()};n.ExpandCollapsedControl=function(n){n.IsExpanded=!n.IsExpanded};n.SelectFieldClick=function(t,i){n.SelectedField=t;i&&i.stopPropagation()};n.onOkClick=function(){var e=n.RetrieveNavParams(),r,u,i;if(t.UndRedoBulkOp("Start"),n.SelectedObject.dictAttributes.sfwNavigationParameter){if(r=n.SelectedObject.dictAttributes.sfwNavigationParameter.split(";"),u=e.split(";"),r&&r.length>0)for(j=0;j<r.length;j++)u.some(function(n){return n==r[j]})||(i=FindControlByID(n.formobject,r[j]),i&&n.CheckOtherFilterGridButton(i));if(u&&u.length>0)for(j=0;j<u.length;j++)r.some(function(n){return n==u[j]})||(i=FindControlByID(n.formobject,u[j]),i&&(n.CheckOtherFilterGridButton(i),i.IsShowDataField||(t.EditPropertyValue(i.dictAttributes.sfwEntityField,i.dictAttributes,"sfwEntityField",""),f.checkValidListValue([],i,undefined,"sfwEntityField","sfwEntityField","",undefined),i.IsShowDataField=!0)))}t.EditPropertyValue(n.SelectedObject.dictAttributes.sfwNavigationParameter,n.SelectedObject.dictAttributes,"sfwNavigationParameter",e);t.UndRedoBulkOp("End");n.onCancelClick()};n.CheckOtherFilterGridButton=function(i){var r=[],u,f;if(FindControlListByNames(n.formobject,["sfwButton","sfwLinkButton","sfwImageButton"],r),r&&r.length>0&&(r=r.filter(function(n){return n.dictAttributes.sfwMethodName=="btnGridSearch_Click"}),r&&r.length>0))for(u=0;u<r.length;u++)if(r[u]!=n.SelectedObject&&r[u].dictAttributes.sfwNavigationParameter&&(f=r[u].dictAttributes.sfwNavigationParameter.split(";"),f&&f.length>0))for(j=0;j<f.length;j++)i&&i.dictAttributes&&i.dictAttributes.ID==f[j]&&t.EditPropertyValue(i.IsShowDataField,i,"IsShowDataField",!0)};n.RetrieveNavParams=function(){function i(i){i.Elements.length>0&&(t+=n.RetrieveNavParamsForChild(i))}var t="";return angular.forEach(n.FieldCollection,i),t=t.trim(),t.length>0&&t[t.length-1]==";"&&(t=t.substring(0,t.length-1)),t};n.RetrieveNavParamsForChild=function(t){function r(t){t.Elements.length>0?i+=n.RetrieveNavParamsForChild(t):t.IsSelected&&(i+=t.ID+";")}var i="";return angular.forEach(t.Elements,r),i};n.onCancelClick=function(){n.dialog&&n.dialog.close()};n.PopulateAvailableFieldsFormLink=function(t,i,r){function f(i){u=i.dictAttributes.Title;(u==""||u==undefined)&&(u=i.dictAttributes.ID);var f={ID:u,Elements:[],IsExpanded:!1,IsSelected:!1};i.Elements.length>0&&(n.PopulateControls(i.Elements[0],f,t),f.Elements.length>0&&(r.Elements.push(f),r.IsExpanded=!0))}function e(i){if(i.Name=="HeaderTemplate"){u="HeaderTemplate";var e={ID:u,Elements:[],IsExpanded:!1,IsSelected:!1};i.Elements.length>0&&n.PopulateControls(i.Elements[0],e,t);e.Elements.length>0&&(r.Elements.push(e),r.IsExpanded=!0)}else angular.forEach(i.Elements,f)}function o(i){u=i.dictAttributes.HeaderText;(u==undefined||u=="")&&(u=i.dictAttributes.ID);var f={ID:u,IsExpanded:!1,IsSelected:!1,Elements:[]};i.Elements.length>0&&(n.PopulateAvailableFieldsFormLink(t,i.Elements[0],f),f.IsExpanded=!0);f.Elements.length>0&&(r.Elements.push(f),r.IsExpanded=!0)}function s(i){var f,c,s,h;i.Name=="items"?n.PopulateAvailableFieldsFormLink(t,i,r):i.Name=="sfwPanel"||i.Name=="sfwDialogPanel"?(u=i.dictAttributes.sfwCaption,(u==undefined||u=="")&&(u=i.dictAttributes.ID),f={ID:u,IsExpanded:!1,IsSelected:!1,Elements:[]},i.Elements.length>0&&(n.PopulateAvailableFieldsFormLink(t,i.Elements[0],f),f.IsExpanded=!0),f.Elements.length>0&&(r.Elements.push(f),r.IsExpanded=!0)):i.Name=="sfwTabContainer"?i.Elements.length>0&&i.Elements[0].Name=="Tabs"&&(c=i.Elements[0],angular.forEach(c.Elements,o)):i.Name=="sfwWizard"?angular.forEach(i.Elements,e):(i.Name=="sfwTextBox"||i.Name=="sfwDropDownList")&&(s=i.dictAttributes.ID,s!=undefined&&s!=""&&(h={ID:s,IsExpanded:!1,IsSelected:!1,IsCheckBoxVisible:!0,Elements:[]},t&&angular.forEach(t,function(n){n==s&&(h.IsSelected=!0)}),r.Elements.push(h)))}var u="";angular.forEach(i.Elements,s)};n.Init()}]);app.controller("TooltipNavigationParameterController",["$scope","$rootScope","$filter","$EntityIntellisenseFactory",function(n,t,r,u){n.SelectedObject.IsShowAllControl=!1;n.currentPanel;n.ParameterCollection=[];n.MethodParameterCollection=[];n.XmlParameterCollection=[];n.EntityFieldCollection=[];n.thisQuery;n.TargetFormCaption="Target Form :";n.TargetForm="";n.Init=function(){var t=getCurrentFileScope(),i;t.CurrPanel?n.currentPanel=t.CurrPanel:t.MainTable?n.currentPanel=t.MainTable:t.objQueryForm&&(i=t.objQueryForm.Elements.filter(function(n){return n.Name=="sfwTable"}),i&&i.length>0&&(n.currentPanel=i[0]));n.ParameterCollection=[];n.SelectedObject.IsChildOfGrid&&(n.TargetForm=n.SelectedObject.dictAttributes.sfwActiveForm);n.TargetForm&&(n.TargetFormCaption="Target Form :",$.connection.hubMain.server.getSingleFileDetail(n.TargetForm).done(function(t){n.receiveSingleFileDetail(t)}));$.connection.hubForm.server.getGlobleParameters().done(function(t){n.$apply(function(){n.objGlobleParameters=t;n.PopulateGlobalParameters()})});n.formobject&&n.formobject.dictAttributes&&(n.formobject.dictAttributes.sfwType=="FormLinkMaintenance"||n.formobject.dictAttributes.sfwType=="FormLinkLookup"||n.formobject.dictAttributes.sfwType=="FormLinkWizard"?n.PopulateAvailableFieldsForFormLink(undefined):n.PopulateAvailableFields())};n.receiveSingleFileDetail=function(r){n.sigleFileDetail=r;n.$apply(function(){var f,e,s,o,h;if(n.newFormModel=r,n.newFormModel&&(e=n.newFormModel.Elements.filter(function(n){return n.Name=="initialload"}),e&&e.length>0&&(s=e[0],o=s.Elements.filter(function(n){return n.Name=="callmethods"}),o&&o.length>0&&(f=o[0].dictAttributes.sfwMethodName)),f)){var c=u.getEntityIntellisense(),t=c.filter(function(t){return t.ID==n.newFormModel.dictAttributes.sfwEntity})[0];if(t.XmlMethods&&t.XmlMethods.length>0&&f)for(i=0;i<t.XmlMethods.length;i++)if(t.XmlMethods[i].ID==f)for(j=0;j<t.XmlMethods[i].Parameters.length;j++)h={ParameterField:t.XmlMethods[i].Parameters[j].ID,ParameterValue:t.XmlMethods[i].Parameters[j].Value,Constants:!1},n.XmlParameterCollection.push(h);n.PopulateParamValues(n.XmlParameterCollection)}});n.$evalAsync(function(){t.IsLoading=!1})};n.PopulateGlobalParameters=function(){function r(n){var r,u;n.dictAttributes&&n.dictAttributes.ID&&(r=n.dictAttributes.ID,i.filter(function(n){return n==r.trim()})||i.push(r.trim()),u={ID:"~"+r,IsExpanded:!1,IsSelected:!1,Elements:[]},t.Elements.push(u))}if(n.objGlobleParameters&&n.objGlobleParameters.Elements.length>0){var t={ID:"Global Parameters",IsExpanded:!1,IsSelected:!1,Elements:[]},i=[];angular.forEach(n.objGlobleParameters.Elements,r);t.Elements.length>0&&n.EntityFieldCollection.push(t);console.log("PopulateGlobalParameters ",n.EntityFieldCollection)}};n.PopulateParamValues=function(t){var i=n.SelectedObject.dictAttributes.sfwNavigationParameter,r;i&&(r=i.split(";"),angular.forEach(r,function(n){var r=n,i=n,u=!1;n.contains("=")&&(r=n.substring(0,n.indexOf("=")),i=n.substring(n.indexOf("=")+1),i.match("^#")&&(i=i.substring(1),u=!0));angular.forEach(t,function(n){n.ParameterField&&r&&n.ParameterField.toLowerCase()==r.toLowerCase()&&(n.ParameterValue=i,n.Constants=u)})}))};n.PopulateAvailableFields=function(){var t,e,i,h,o,y,c,f;if(n.EntityFieldCollection=[],t={ID:"Main",IsExpanded:!1,IsSelected:!1,Elements:[]},n.IsLookup=n.formobject.dictAttributes.sfwType=="Lookup"?!0:!1,n.blnIsReport=n.formobject.dictAttributes.sfwType=="Report"?!0:!1,n.blnIsCorr=n.formobject.dictAttributes.sfwType=="Correspondence"?!0:!1,e=n.SelectedObject.dictAttributes.sfwMethodName=="btnNew_Click"?"ID":n.IsLookup?"sfwDataField":n.blnIsReport||n.blnIsCorr?"ID":"sfwEntityField",n.SelectedObject.Name=="sfwOpenDetail"){if(n.SelectedObject.dictAttributes.sfwQueryID&&(i=n.SelectedObject.dictAttributes.sfwQueryID.split("."),i&&i.length==2)){var l=i[0],a=i[1],v=u.getEntityIntellisense(),s=r("filter")(v,{ID:l},!0);s&&s.length>0&&(h=s[0],o=h.Queries.filter(function(n){return n.ID==a}),o&&o.length>0&&(y=o[0],$.connection.hubForm.server.getEntityQueryColumns(n.SelectedObject.dictAttributes.sfwQueryID,"TooltipNavigationParameterController").done(function(t){n.receiveQueryColumns(t)})))}}else{if(n.SelectedObject.IsShowAllControl==!0){for(f=0;f<n.formobject.Elements.length;f++)if(n.formobject.Elements[f].Name=="sfwTable"){c=n.formobject.Elements[f];break}n.PopulateControls(c,t,e)}else n.blnIsReport||n.blnIsCorr?n.PopulateControls(n.currentPanel,t,e):n.PopulateControls(n.currentPanel.Elements[0],t,e);n.EntityFieldCollection.push(t)}};n.receiveQueryColumns=function(t){n.$evalAsync(function(){for(var u,r={ID:n.SelectedObject.dictAttributes.sfwQueryID,IsSelected:!1,Elements:[]},i=0;i<t.length;i++)u={ID:t[i].CodeID,IsSelected:!1,Elements:[]},r.Elements.push(u);n.EntityFieldCollection.push(r)})};n.PopulateControls=function(t,i,r){var u="";t&&angular.forEach(t.Elements,function(t){for(var e,f=0;f<t.Elements.length;f++)e=t.Elements[f],e&&angular.forEach(e.Elements,function(t){var f,h,c,s,e,o,l,a;if(t.Name=="sfwPanel")u=t.dictAttributes.ID,(u==""||u==undefined)&&(u=t.Name),f={ID:u,IsSelected:!1,Elements:[]},f.IsExpanded=!1,t.Elements.length>0&&t.Elements[0].Name=="sfwTable"&&n.PopulateControls(t.Elements[0],f,r),i.Elements.push(f);else if(t.Name=="sfwTabContainer")t.Elements.length>0&&t.Elements[0].Name=="Tabs"&&(h=t.Elements[0],angular.forEach(h.Elements,function(t){u=t.dictAttributes.HeaderText;u==""&&(u=t.dictAttributes.ID);var f={ID:u,IsSelected:!1,Elements:[]};t.Elements.length>0&&t.Elements[0].Name=="sfwTable"&&n.PopulateControls(t.Elements[0],f,r);f.Elements.length>0&&i.Elements.push(f)}));else if(t.Name=="sfwWizard")angular.forEach(t.Elements,function(t){if(t.Name=="HeaderTemplate"){u="HeaderTemplate";var f={ID:u,IsSelected:!1,Elements:[]};t.Elements.length>0&&t.Elements[0].Name=="sfwTable"&&n.PopulateControls(t.Elements[0],f,r);f.Elements.length>0&&i.Elements.push(f)}else angular.forEach(t.Elements,function(t){u=t.dictAttributes.Title;u==""&&(u=t.dictAttributes.ID);var f={ID:u,IsSelected:!1,Elements:[]};t.Elements.length>0&&t.Elements[0].Name=="sfwTable"&&(n.PopulateControls(t.Elements[0],f,r),f.Elements.length>0&&i.Elements.push(f))})});else if(t.Elements.length>0&&t.Name=="sfwGridView"){if(c=t.dictAttributes.ID,s={ID:c+" (Data Keys)",IsSelected:!1,Elements:[]},i.Elements.push(s),t.Elements.length>0&&t.Elements[0].Name=="Columns")for(e=0;e<t.Elements[0].Elements.length;e++)o=t.Elements[0].Elements[e],o.Elements.length>0&&o.Elements[0].Name=="ItemTemplate"&&(l=o.Elements[0],angular.forEach(l.Elements,function(n){if("sfwEntityField"in n.dictAttributes){var t="";t=n.dictAttributes.sfwEntityField;t!=""&&t!=undefined&&s.Elements.push({ID:t,IsSelected:!1,Elements:[]})}}))}else r!=undefined&&r!=""?n.blnIsReport||n.blnIsCorr?u=t.dictAttributes[r]:(n.IsLookup&&!IsCriteriaField(t)&&(r="sfwEntityField"),"sfwDataField"in t.dictAttributes?u=t.dictAttributes[r]:"sfwEntityField"in t.dictAttributes&&(u=t.dictAttributes[r])):u=t.dictAttributes.ID,u!=""&&u!=undefined&&(i.Elements.some(function(n){return n.ID==u})||(a={ID:u,Elements:[]},i.Elements.push(a)))})})};n.PopulateAvailableFieldsForFormLink=function(t){var f,i,r;if(n.EntityFieldCollection=[],n.formobject){var u=[],e=n.formobject.dictAttributes.sfwType,o=e.toUpperCase().trim()=="FORMLINKLOOKUP";n.SourceForm=n.formobject.dictAttributes.ID;f=n.IsFormCodeGroup||n.SelectedObject.dictAttributes.sfwMethodName&&n.SelectedObject.dictAttributes.sfwMethodName=="btnNew_Click"||n.SelectedObject.Name=="sfwCascadingDropDownList"||n.SelectedObject.Name=="sfwSeries"?"ID":o?"sfwDataField":"sfwEntityField";i={ID:"Main",IsExpanded:!1,IsSelected:!1,Elements:[]};r=n.GetItemsModel();r&&(t!=undefined&&t!=""&&n.PopulateChildIDsFormLink(t,r,u),n.PopulateAvailableFieldsFormLink(f,r,i.Elements,u,t));i.Elements.length>0&&n.EntityFieldCollection.push(i)}};n.GetItemsModel=function(){var t;return(t=n.formobject.Elements.filter(function(n){return n.Name=="items"}),t&&t.length>0)?t[0]:t};n.PopulateChildIDsFormLink=function(n,t,i){function r(t){if(t._dictAttributes.hasOwnProperty("sfwParentControl")){var r=t.dictAttributes.ID,u=t.dictAttributes.sfwParentControl;u==n&&(i.push(r),PopulateChildIDsFormLink(r,t,i))}}t&&angular.foreach(t.Elements,r)};n.PopulateAvailableFieldsFormLink=function(t,i,r,u,f){function o(n){if(n==strCtrlID){blnAdd=!1;return}}function s(i){strTreeCaption=i.dictAttributes.Title;(strTreeCaption==""||strTreeCaption==undefined)&&(strTreeCaption=i.dictAttributes.ID);r.push({ID:strTreeCaption,Elements:[],IsExpanded:!1,IsSelected:!1});i.Elements.length>0&&(n.PopulateAvailableFieldsFormLink(t,i.Elements[0],r[e].Elements,u,f),r[e].Elements.length==0?r.splice(e,1):e++)}function h(i){i.Name=="HeaderTemplate"?(strTreeCaption="HeaderTemplate",r.push({ID:strTreeCaption,Elements:[],IsExpanded:!1,IsSelected:!1}),i.Elements.length>0&&n.PopulateAvailableFieldsFormLink(t,i.Elements[0],r[e].Elements,u,f),r[e].Elements.length==0?r.splice(e,1):e++):angular.forEach(i.Elements,s)}function c(i){strTreeCaption=i.dictAttributes.HeaderText;(strTreeCaption==""||strTreeCaption==undefined)&&(strTreeCaption=i.dictAttributes.ID);r.push({ID:strTreeCaption,Elements:[],IsExpanded:!1,IsSelected:!1});i.Elements.length>0&&n.PopulateAvailableFieldsFormLink(t,i.Elements[0],r[e].Elements,u,f);r[e].Elements.length==0?r.splice(e,1):e++}function l(i){var s="",w,b,y,p,g,a,v,k,d,nt,l;if(i.Name=="items")n.PopulateAvailableFieldsFormLink(t,i,r[e].Elements,u,f);else if(i.Name=="sfwPanel"||i.Name=="sfwDialogPanel")s=i.dictAttributes.sfwCaption,(s==""||s==undefined)&&(s=i.dictAttributes.ID),r.push({ID:s,Elements:[],IsExpanded:!1,IsSelected:!1}),i.Elements.length>0&&n.PopulateAvailableFieldsFormLink(t,i.Elements[0],r[e].Elements,u,f),r[e].Elements.length==0?r.splice(e,1):e++;else if(i.Name=="sfwTabContainer")i.Elements.length>0&&i.Elements[0].Name=="Tabs"&&(w=i.Elements[0],angular.forEach(w.Elements,c));else if(i.Name=="sfwWizard")angular.forEach(i.Elements,h);else if(i.Name=="sfwGridView"&&n.SelectedObject.Name!="sfwTextBox"){if(b=i.dictAttributes.ID,y={ID:b+" (Data Keys)",Elements:[],IsSelected:!1,IsExpanded:!1},r.push(y),p=i.dictAttributes.sfwDataKeyNames,p&&(g=p.split(",")),i.Elements.length>0&&i.Elements[0].Name=="Columns")for(a=0;a<i.Elements[0].Elements.length;a++)v=i.Elements[0].Elements[a],v.Elements.length>0&&v.Elements[0].Name=="ItemTemplate"&&(k=v.Elements[0],angular.forEach(k.Elements,function(n){if("sfwEntityField"in n.dictAttributes){var t="";t=f!=""&&f!=undefined?i.dictAttributes.ID:n.dictAttributes.sfwEntityField;t!=undefined&&t!=""&&y.Elements.push({ID:t,Elements:[],IsSelected:!1,IsExpanded:!1})}}))}else t in i.dictAttributes&&(d=!0,nt=i.dictAttributes.ID,angular.forEach(u,o),d&&(l="",l=f!=undefined&&f!=""?i.dictAttributes.ID:i.dictAttributes[t],l!=undefined&&l!=""&&i.Name!="sfwButton"&&(r.push({ID:l,Elements:[],IsSelected:!1,IsExpanded:!1}),e++)))}var e=0;i!=null&&angular.forEach(i.Elements,l)};n.PanelCriteria;n.XmlParameterCollection=[];n.showAllControlChange=function(){n.PopulateAvailableFields();n.PopulateGlobalParameters()};n.ExpandCollapsedControl=function(n){n.IsExpanded=!n.IsExpanded};n.SelectFieldClick=function(t,i){n.SelectedField=t;i&&i.stopPropagation()};n.SetFieldClass=function(t){if(t==n.SelectedField)return"selected"};n.strSelectedParameters;n.onOkClick=function(){var i="";n.XmlParameterCollection.length>0&&(i=n.GetSavedString(n.XmlParameterCollection));i!=undefined&&t.EditPropertyValue(n.SelectedObject.dictAttributes.sfwNavigationParameter,n.SelectedObject.dictAttributes,"sfwNavigationParameter",i);n.onCancelClick()};n.onCancelClick=function(){n.NavigationParameterDialog.close()};n.GetSavedString=function(n){var t="";return angular.forEach(n,function(n){var r=n.ParameterField,i=n.ParameterValue,f,u;i!=""&&r!=undefined&&i!=undefined&&i!=""&&r!=undefined&&r!=""&&(f=n.Constants,f&&(i="#"+i),u=i,i.toLowerCase()!=r.toLowerCase()&&(u=r+"="+i),t==""?t=u:t+=";"+u)}),t};n.Init()}]);app.controller("ClientVisibilityController",["$scope","$rootScope","$filter","ngDialog","$EntityIntellisenseFactory","$SgMessagesService",function(n,t,i,r,u,f){n.FieldCollection=[];n.ControlCollection=[];n.SavedControlList=[];n.arrSavedControlIdList=[];n.CodeValues=[];n.lstQryField=[];n.lstItems=[];n.InitForm=function(){n.IsWizard=n.formobject.dictAttributes.sfwType=="Wizard"?!0:!1;n.SetClientVisibility();n.ClientVisibility=n.model.dictAttributes[n.strAttributeName];n.LoadSavedData();angular.forEach(n.SavedControlList,function(t){angular.forEach(t.arrVisibleControl,function(t){t.Content&&(n.ControlCollection.some(function(n){return n.Content==t.Content})||n.ControlCollection.push({Content:t.Content}))})});angular.forEach(n.arrSavedControlIdList,function(t){t&&(n.ControlCollection.some(function(n){return n.Content==t})||n.ControlCollection.push({Content:t}))});n.PopulateAvailableFields();n.SetRemoveButtonText()};n.InitFormLink=function(){n.IsWizard=n.formobject.dictAttributes.sfwType=="Wizard"?!0:!1;n.SetClientVisibility();n.ClientVisibility=n.model.dictAttributes[n.strAttributeName];n.LoadSavedData();angular.forEach(n.SavedControlList,function(t){angular.forEach(t.arrVisibleControl,function(t){t.Content&&(n.ControlCollection.some(function(n){return n.Content==t.Content})||n.ControlCollection.push({Content:t.Content}))})});angular.forEach(n.arrSavedControlIdList,function(t){t&&(n.ControlCollection.some(function(n){return n.Content==t})||n.ControlCollection.push({Content:t}))});n.PopulateHtxAvailableFields();n.SetRemoveButtonText()};n.SetClientVisibility=function(){n.CodeValues.push({CodeValue:"default",CodeValueDescription:"default"});n.lstQryField.push({CodeID:"default",CodeValue:"default"});n.model.dictAttributes.sfwLoadType=="CodeGroup"?n.CheckAndPopulateCodeIDValues(n.formobject):n.model.dictAttributes.sfwLoadType=="Query"?n.GetQuerySchema(n.model.dictAttributes.sfwLoadSource):n.model.dictAttributes.sfwLoadType=="Items"&&n.model.Elements.length>0&&n.GetItemsList(n.model)};n.CheckAndPopulateCodeIDValues=function(){n.model.dictAttributes.sfwLoadSource?$.connection.hubMain.server.getCodeValues("ScopeId_"+n.$id,n.model.dictAttributes.sfwLoadSource):n.model.placeHolder&&$.connection.hubMain.server.getCodeValues("ScopeId_"+n.$id,n.model.placeHolder)};n.receiveList=function(t){n.$evalAsync(function(){t&&t.length>0&&(n.CodeValues=n.CodeValues&&n.CodeValues.length>0?n.CodeValues.concat(t):t)})};n.LoadSavedData=function(){var i,r,s,h,u,t,f,e,c,o,l;if(n.ClientVisibility!=undefined&&n.ClientVisibility!=""){for(r=n.ClientVisibility.split("#"),r[0]=r[0].substring(r[0].indexOf(":")+1),s=r[0].split(","),t=0;t<s.length;t++)n.arrSavedControlIdList.push(s[t]);if(h=!1,r.length>1)for(u=r[1].split(";"),t=0;t<u.length;t++)if(u[t]!=undefined&&u[t]!=""){if(i={arrVisibleControl:[]},f=u[t].split(":"),i.Value=f[0],n.lstItems&&n.lstItems.length>0&&(e=n.lstItems.filter(function(n){return n.dictAttributes.Value&&n.dictAttributes.Value==f[0]}),e&&e.length>0&&(i.Value=e[0].dictAttributes.Text)),i.Value.trim()=="default"&&(h=!0),f.length>1)for(c=f[1].split(","),o=0;o<c.length;o++)l={},l.Content=c[o],i.arrVisibleControl.push(l);n.SavedControlList.push(i)}h||n.SavedControlList.length!=0||(i={arrVisibleControl:[]},i.Value="default",n.SavedControlList.push(i))}};n.PopulateAvailableFields=function(){var u,i,r,t;if(n.FieldCollection=[],u=!1,i={Text:n.formobject.dictAttributes.ID,IsExpanded:!0,IsSelected:!1,Items:[],IsCheckBoxVisible:!1},n.IsWizard||n.formobject.dictAttributes.sfwType=="Correspondence")n.CurrentTable&&(r=n.CurrentTable);else for(t=0;t<n.formobject.Elements.length;t++)if(n.formobject.Elements[t].Name=="sfwTable"){r=n.formobject.Elements[t];break}n.PopulateControls(r,i,u);i&&n.FieldCollection.push(i)};n.PopulateControls=function(t,i,r){var u="",f,e;t&&(u=t.dictAttributes.ID,(u==""||u==undefined)&&(u=t.Name),f={Text:u,IsSelected:!1,Items:[],IsCheckBoxVisible:!0},n.arrSavedControlIdList&&n.arrSavedControlIdList.length>0&&n.arrSavedControlIdList.some(function(n){return n==u})&&(e=n.arrSavedControlIdList.indexOf(u),n.arrSavedControlIdList.splice(e,1),f.IsSelected=!0),angular.forEach(t.Elements,function(t){for(var e,i=0;i<t.Elements.length;i++)e=t.Elements[i],e&&angular.forEach(e.Elements,function(t){var o,e,h,s,l,c,i;t==n.model&&(r=!0);t.dictAttributes.ID==""||t.dictAttributes.ID==undefined||(t.Name=="sfwPanel"||t.Name=="sfwDialogPanel"?(u=t.dictAttributes.ID,(u==""||u==undefined)&&(u=t.Name),o={Text:u,IsSelected:!1,Items:[],IsCheckBoxVisible:!0},n.arrSavedControlIdList&&n.arrSavedControlIdList.length>0&&n.arrSavedControlIdList.some(function(n){return n==u})&&(i=n.arrSavedControlIdList.indexOf(u),n.arrSavedControlIdList.splice(i,1),o.IsSelected=!0),!r,t.Elements.length>0&&t.Elements[0].Name=="sfwTable"&&n.PopulateControls(t.Elements[0],o,r),f.Items.push(o)):t.Name=="sfwWizard"?(u=t.dictAttributes.ID,(u==""||u==undefined)&&(u=t.Name),e={Text:u,Items:[],IsCheckBoxVisible:!0},n.arrSavedControlIdList&&n.arrSavedControlIdList.length>0&&n.arrSavedControlIdList.some(function(n){return n==u})&&(i=n.arrSavedControlIdList.indexOf(u),n.arrSavedControlIdList.splice(i,1),e.IsSelected=!0),h={Text:"WizardStep",Items:[],IsCheckBoxVisible:!0},e.Items.push(h),angular.forEach(t.Elements,function(t){var i,f;t.Name=="HeaderTemplate"?(i={Text:"HeaderTemplate",Items:[],IsCheckBoxVisible:!0},t.Elements.length>0&&t.Elements[0].Name=="sfwTable"&&n.PopulateControls(t.Elements[0],i,r),e.Items.push(i)):t.Name=="WizardSteps"?angular.forEach(t.Elements,function(t){var i,f;u=t.dictAttributes.ID;(u==""||u==undefined)&&(u=t.Name);i={Text:u,Items:[],IsCheckBoxVisible:!0};n.arrSavedControlIdList&&n.arrSavedControlIdList.length>0&&n.arrSavedControlIdList.some(function(n){return n==u})&&(f=n.arrSavedControlIdList.indexOf(u),n.arrSavedControlIdList.splice(f,1),i.IsSelected=!0);t.Elements.length>0&&t.Elements[0].Name=="sfwTable"&&n.PopulateControls(t.Elements[0],i,r);h.Items.push(i)}):(f={Text:"SideBarTemplate",Items:[],IsCheckBoxVisible:!0},t.Elements.length>0&&t.Elements[0].Name=="sfwTable"&&n.PopulateControls(t.Elements[0],f,r),e.Items.push(f))}),f.Items.push(e)):t.Name=="sfwTabContainer"?(u=t.dictAttributes.ID,(u==""||u==undefined)&&(u=t.Name),s={Text:u,Items:[],IsCheckBoxVisible:!0},n.arrSavedControlIdList&&n.arrSavedControlIdList.length>0&&n.arrSavedControlIdList.some(function(n){return n==u})&&(i=n.arrSavedControlIdList.indexOf(u),n.arrSavedControlIdList.splice(i,1),s.IsSelected=!0),t.Elements.length>0&&t.Elements[0].Name=="Tabs"&&(l=t.Elements[0],angular.forEach(l.Elements,function(t){var i,f;u=t.dictAttributes.ID;u==""&&(u=t.Name);i={Text:u,Items:[],IsCheckBoxVisible:!0};n.arrSavedControlIdList&&n.arrSavedControlIdList.length>0&&n.arrSavedControlIdList.some(function(n){return n==u})&&(f=n.arrSavedControlIdList.indexOf(u),n.arrSavedControlIdList.splice(f,1),i.IsSelected=!0);t.Elements.length>0&&t.Elements[0].Name=="sfwTable"&&n.PopulateControls(t.Elements[0],i,r);s.Items.push(i)})),f.Items.push(s)):(u=t.dictAttributes.ID,(u==""||u==undefined)&&(u=t.Name),c={Text:u,Items:[],IsCheckBoxVisible:!0},f.Items.push(c),n.arrSavedControlIdList&&n.arrSavedControlIdList.length>0&&n.arrSavedControlIdList.some(function(n){return n==u})&&(i=n.arrSavedControlIdList.indexOf(u),n.arrSavedControlIdList.splice(i,1),c.IsSelected=!0)))})}),i.Items.push(f))};n.SetRemoveButtonText=function(){n.strAttributeName=="sfwClientEnable"?(n.StrRemoveButtonText="Remove Client Enable ",n.StrControlHeader="Enabled Control(s)"):n.strAttributeName=="sfwClientVisibility"&&(n.StrRemoveButtonText="Remove Client Visibility",n.StrControlHeader="Visible Control(s)")};n.GetQuerySchema=function(){n.model.dictAttributes.sfwLoadSource&&$.connection.hubForm.server.getQueryColumnValues(n.model.dictAttributes.sfwLoadSource,n.model.dictAttributes.DataValueField).done(function(t){n.$evalAsync(function(){t&&t.length>0&&(n.lstQryField=n.lstQryField&&n.lstQryField.length>0?n.lstQryField.concat(t):t)})})};n.GetItemsList=function(t){angular.forEach(t.Elements,function(t){t.Name=="ListItem"&&n.lstItems.push(t)});n.lstItems.splice(0,0,{dictAttributes:{Text:"default"}})};n.GetDataFromGrid=function(){var i="",t="",r;return angular.forEach(n.ControlCollection,function(n){t=t==undefined||t==""?n.Content:t+","+n.Content}),t="controllist:"+t,r=t,t="",angular.forEach(n.SavedControlList,function(r){var f,u;i=r.Value;n.lstItems&&n.lstItems.length>0&&(f=n.lstItems.filter(function(n){return n.dictAttributes.Value&&n.dictAttributes.Text==r.Value}),i=f&&f.length>0?f[0].dictAttributes.Value:r.Value);u="";angular.forEach(r.arrVisibleControl,function(n){u=u==undefined||u==""?n.Content:u+","+n.Content});t=t+i+":"+u+";"}),t!=undefined&&t!=""&&(t=r+"#"+t),t};n.UpdateClientVisibility=function(){t.EditPropertyValue(n.model.dictAttributes[n.strAttributeName],n.model.dictAttributes,n.strAttributeName,n.ClientVisibility)};n.ExpandCollapsedControl=function(n){n.IsExpanded=!n.IsExpanded};n.SelectFieldClick=function(t,i){n.SelectedField=t;i&&i.stopPropagation()};n.SetFieldClass=function(t){if(t==n.SelectedField)return"selected"};n.onRemoveClientVisibilityClick=function(){n.ClientVisibility="";n.UpdateClientVisibility();n.onCancelClick()};n.onSaveClick=function(){n.ClientVisibility=n.GetDataFromGrid();n.UpdateClientVisibility();n.onCancelClick()};n.onCancelClick=function(){n.objNewDialog.close()};n.SelectControlFromList=function(t){n.SelectedControl=t};n.SelectSaveControlClick=function(t){n.SelectedVisibility=t};n.SelectVisibleControlClick=function(t){n.SelectedItem=t};n.AddToListboxClick=function(){n.FieldCollection.length>0&&n.AddFieldsToControlCollection(n.FieldCollection[0].Items)};n.AddFieldsToControlCollection=function(t){angular.forEach(t,function(t){if(t.IsSelected&&t.Text){var i={Content:t.Text};n.ControlCollection.some(function(n){return n.Content==t.Text})||n.ControlCollection.push(i)}t.Items.length>0&&n.AddFieldsToControlCollection(t.Items)})};n.DeleteToListboxClick=function(){if(n.SelectedControl!=null){var t=n.ControlCollection.indexOf(n.SelectedControl);n.ControlCollection.splice(t,1);angular.forEach(n.SavedControlList,function(t){angular.forEach(t.arrVisibleControl,function(i){if(i.Content==n.SelectedControl.Content){var r=t.arrVisibleControl.indexOf(i);t.arrVisibleControl.splice(r,1)}})});t<n.ControlCollection.length?n.SelectedControl=n.ControlCollection[t]:n.ControlCollection.length>0&&(n.SelectedControl=n.ControlCollection[t-1]);n.ControlCollection.length==0&&(n.SelectedControl=undefined)}else f.Message("Message","Select control to remove.")};n.AddToGridClick=function(){n.ControlCollection.length==0?f.Message("Message","Please add some control in List."):n.AddRowToGrid()};n.AddRowToGrid=function(){var t={Value:"",arrVisibleControl:[]};n.SavedControlList.length==0&&(t.Value="default",angular.forEach(n.ControlCollection,function(n){var i={Content:n.Content};t.arrVisibleControl.push(i)}));n.SavedControlList.push(t)};n.DeleteToGridClick=function(){if(n.SelectedVisibility!=null){var t=n.SavedControlList.indexOf(n.SelectedVisibility);n.SavedControlList.splice(t,1);t<n.SavedControlList.length?n.SelectedVisibility=n.SavedControlList[t]:n.SavedControlList.length>0&&(n.SelectedVisibility=n.SavedControlList[t-1]);n.SavedControlList.length==0&&(n.SelectedVisibility=undefined)}};n.DeleteSaveControlFromList=function(){if(n.SelectedVisibility&&n.SelectedItem){var t=n.SelectedVisibility.arrVisibleControl.indexOf(n.SelectedItem);n.SelectedVisibility.arrVisibleControl.splice(t,1);t<n.SelectedVisibility.arrVisibleControl.length?n.SelectedItem=n.SelectedVisibility.arrVisibleControl[t]:n.SelectedVisibility.arrVisibleControl.length>0&&(n.SelectedItem=n.SelectedVisibility.arrVisibleControl[t-1])}};n.SaveControlListMenu=[["Delete",function(t){n.SelectedItem=t.ctrl;t.$parent&&t.$parent.saveCtrl&&(n.SelectedVisibility=t.$parent.saveCtrl);n.DeleteSaveControlFromList()},null]];n.PopulateHtxAvailableFields=function(t){var u,f,r,e,i;n.FieldCollection=[];t?(u=n.formobject.Elements.filter(function(n){return n.Name=="items"}),u&&u.length>0&&(f=u[0].Elements.filter(function(n){return n.Name=="sfwWizard"}),f&&f.length>0&&(r={Text:f.dictAttributes.ID,IsSelected:!1,Items:[]},r&&(e=n.GetSelectedWizardStep(n.model),e&&(i=n.CrateHtxAvailableField(e),i&&(i.IsCheckBoxVisible=!1,r.Items.push(i))),r.IsExpanded=!0,n.FieldCollection.push(r))))):(i=n.CrateHtxAvailableField(n.formobject),i&&(i.IsExpanded=!0,i.IsCheckBoxVisible=!1,n.FieldCollection.push(i)))};n.GetSelectedWizardStep=function(n){for(var i=null,t=n.ParentVM;t;){if(t.Name=="sfwWizardStep"){i=t;break}t=t.ParentVM}return i};n.CrateHtxAvailableField=function(t){function u(t){var i=n.CrateHtxAvailableField(t);i&&r.Items.push(i)}var r=null,i;return t.dictAttributes.ID!=undefined&&t.dictAttributes.ID!=""&&(r={Text:t.dictAttributes.ID,IsCheckBoxVisible:!0,Items:[],IsSelected:n.arrSavedControlIdList.some(function(n){return n==t.dictAttributes.ID})},i=null,i=t.Name=="sfwTabContainer"?t.Elements.filter(function(n){return n.Name=="Tabs"}):t.Elements.filter(function(n){return n.Name=="items"}),i&&i.length>0&&angular.forEach(i[0].Elements,u)),r};n.IsForm?n.InitForm():n.InitFormLink()}]);app.directive("clientvisibilitydraggable",[function(){return{restrict:"A",scope:{dragdata:"="},link:function(n,t){function r(t){n.dragdata!=undefined&&n.dragdata!=""&&t.dataTransfer.setData("text",JSON.stringify(n.dragdata))}var i=t[0];i.draggable=!0;i.addEventListener("dragstart",r,!1)}}}]);app.directive("clientvisibilitydroppable",[function(){return{restrict:"A",scope:{dropdata:"="},link:function(n,t){var i=t[0];i.addEventListener("dragover",function(n){n.dataTransfer.dropEffect="copy";n.preventDefault&&n.preventDefault()});i.addEventListener("drop",function(t){t.preventDefault();var i=JSON.parse(t.dataTransfer.getData("text"));i!=undefined&&i!=""&&n.$apply(function(){jQuery.type(n.dropdata)==="array"&&(n.dropdata.some(function(n){return n.Content==i.Content})||n.dropdata.push(i))});t.stopPropagation&&t.stopPropagation()},!1)}}}]);app.controller("CreateButtonController",["$scope","$rootScope",function(n,t){n.ErrorMessageForDisplay="";n.strButtonType="sfwButton";n.strCustomMethod="";n.Init=function(){n.ButtonsDetailsCollection=[];n.LoadButtonDetails();n.LoadNewButtonList()};n.LoadButtonDetails=function(){function u(t){var i={},r=null;r=t.Attribute;i.Method=t.Code;i.Description=t.Description;i.Category=t.Category;n.ButtonsDetailsCollection.push(i)}var r=n.formodel.dictAttributes.sfwType,i;r&&(i=[],r=="Lookup"?i=t.LstButtonMethodLookup:r=="Wizard"?i=t.LstButtonMethodWizard:(r=="Maintenance"||r=="UserControl")&&(i=t.LstButtonMethodMaintenance),i!=null&&angular.forEach(i,u))};n.LoadNewButtonList=function(){lstNewButtons=[];var t=n.formodel.dictAttributes.sfwType;t=="Lookup"&&(lstNewButtons.push({Group:"New",MethodName:"btnNew_Click"}),lstNewButtons.push({Group:"New",MethodName:"btnNewUpdate_Click"}),lstNewButtons.push({Group:"Open",MethodName:"btnOpenLookup"}),lstNewButtons.push({Group:"Open",MethodName:"btnOpenDoc_Click"}),lstNewButtons.push({Group:"Delete",MethodName:"btnDelete_Click"}));(t=="Maintenance"||t=="Wizard")&&(lstNewButtons.push({Group:"New",MethodName:"btnNew_Click"}),lstNewButtons.push({Group:"New",MethodName:"btnNewUpdate_Click"}),lstNewButtons.push({Group:"New",MethodName:"btnNewPopupDialog_Click"}),lstNewButtons.push({Group:"Open",MethodName:"btnOpen_Click"}),lstNewButtons.push({Group:"Open",MethodName:"btnOpenDoc_Click"}),lstNewButtons.push({Group:"Open",MethodName:"btnOpenPopupDialog_Click"}),lstNewButtons.push({Group:"Finish",MethodName:"btnFinishPopupDialog_Click"}),lstNewButtons.push({Group:"Grid",MethodName:"btnGridSearch_Click"}),lstNewButtons.push({Group:"Grid",MethodName:"btnGridSearchCriteriaReq_Click"}),lstNewButtons.push({Group:"Save",MethodName:"btnSave_Click"}),lstNewButtons.push({Group:"Save",MethodName:"btnSaveIgnoreReadOnly_Click"}),lstNewButtons.push({Group:"Save",MethodName:"btnForceSave_Click"}),lstNewButtons.push({Group:"Save",MethodName:"btnNoChangesSave_Click"}),lstNewButtons.push({Group:"Save",MethodName:"btnSaveNew_Click"}),lstNewButtons.push({Group:"Save",MethodName:"btnSaveAndNext_Click"}),lstNewButtons.push({Group:"Download",MethodName:"btnDownload_Click"}),lstNewButtons.push({Group:"Execute",MethodName:"btnExecuteServerMethod_Click"}),lstNewButtons.push({Group:"Execute",MethodName:"btnValidateExecuteBusinessMethod_Click"}),lstNewButtons.push({Group:"Execute",MethodName:"btnExecuteBusinessMethodSelectRows_Click"}),lstNewButtons.push({Group:"Execute",MethodName:"btnExecuteBusinessMethod_Click"}),lstNewButtons.push({Group:"Workflow",MethodName:"btnCompleteWorkflowActivities_Click"}));t=="Wizard"&&(lstNewButtons.push({Group:"Grid",MethodName:"btnGridSearch_Click"}),lstNewButtons.push({Group:"Grid",MethodName:"btnGridSearchCriteriaReq_Click"}),lstNewButtons.push({Group:"Execute",MethodName:"btnExecuteServerMethod_Click"}))};n.AddControlToCell=function(i,r){if(r||(r=CreateControl(n.formodel,n.item,i)),r!=null){if(["btnCompleteWorkflowActivities_Click","btnExecuteBusinessMethodSelectRows_Click","btnValidateExecuteBusinessMethod_Click","btnExecuteBusinessMethod_Click"].indexOf(r.dictAttributes.sfwMethodName)>-1&&(r.dictAttributes.sfwExecuteMethodType="ObjectMethod"),n.item.Name==="TemplateField"){var u=n.item.Elements.filter(function(n){return n.Name==="ItemTemplate"});u&&u.length>0&&t.PushItem(r,u[0].Elements)}else t.PushItem(r,n.item.Elements);SetFormSelectedControl(n.formodel,r)}};n.selectButton=function(t){n.SelectedButtonDetail=t};n.onAddButtonOkClick=function(r){var e,u,f;if(n.SelectedButtonDetail&&n.SelectedButtonDetail.Method){for(f=!0,i=0;i<lstNewButtons.length;i++)if(lstNewButtons[i].MethodName==n.SelectedButtonDetail.Method){e=lstNewButtons[i];break}r&&!e&&(n.item.Name=="sfwColumn"||n.item.Name=="TemplateField"||n.item.Name=="ItemTemplate"||n.item.Name=="sfwButtonGroup")&&n.AddControlToCell(r+"."+n.SelectedButtonDetail.Method);e&&(n.item.Name=="TemplateField"&&(n.SelectedButtonDetail.Method=="btnGridSearch_Click"||n.SelectedButtonDetail.Method=="btnGridSearchCriteriaReq_Click"||"btnOpenPopupDialog_Click")?n.AddControlToCell(r+"."+n.SelectedButtonDetail.Method):(f=!1,u=n.$new(),u.formodel=n.formodel,u.sfxCell=n.item,u.SelectedButtonDetails=n.SelectedButtonDetail,u.ControlName=r,t.IsLoading=!0,u.beforeClose=function(){n.onAddButtonCancelClick()},u.title="Create New Button",u.ButtonWizardDialog=t.showDialog(u,u.title,"Form/views/CreateButtonWizard/NewButtonWizard.html",{width:1e3,height:660,beforeClose:u.beforeClose})))}else n.strButtonType=="CustomButton"&&n.strCustomMethod&&(f=!0,n.AddControlToCell("sfwButton."+n.strCustomMethod));f&&n.onAddButtonCancelClick()};n.onAddButtonCancelClick=function(){n.CreateButtonDialog.close()};n.$on("AddButtonCancel",function(){n.onAddButtonCancelClick()});n.CreateDummyObject=function(){};n.onChangeButtonType=function(){var t,i,r;n.SelectedButtonDetail={};n.strCustomMethod="";n.strButtonType=="sfwImageButton"?(t={},t.Method="btnRetrieve_Click",t.Description="Retrieve Button",t.Category="ImageButton",n.ButtonsDetailsCollection.push(t),n.SelectedButtonDetail=t):(i=n.ButtonsDetailsCollection.filter(function(n){return n.Method=="btnRetrieve_Click"}),i&&i.length>0&&(r=n.ButtonsDetailsCollection.indexOf(i[0]),n.ButtonsDetailsCollection.splice(r,1)))};n.ValidateButton=function(){return n.SelectedButtonDetail&&n.SelectedButtonDetail.Method?(n.ErrorMessageForDisplay="",!1):n.strButtonType=="CustomButton"&&n.strCustomMethod?(n.ErrorMessageForDisplay="",isValidIdentifier(n.strCustomMethod,!1,!1)?!1:(n.ErrorMessageForDisplay="Invalid method name",!0)):(n.ErrorMessageForDisplay="Select Button Method",!0)};n.Init()}]);app.controller("NewButtonWizardController",["$scope","$http","$rootScope","$EntityIntellisenseFactory","$ValidationService","CONSTANTS","$GetEntityFieldObjectService","$Entityintellisenseservice","$SgMessagesService","$timeout","$GetGridEntity",function(n,t,i,r,u,f,e,o,s,h){if(n.objNewButtonDialogForGrid={},n.objCreateNewGrid={},n.objGridObjectField={},n.objGridObjectField.lstselectedmultiplelevelfield=[],n.objGridField={},n.objNewButtonActiveForm={},n.objNewButtonNaviagtionParam={},n.objNewButtonGeneralProp={},n.objNewButtonCustomAttr={},n.objNewButtonFilterGrid={},n.objNewButtonFilterGridQueryParam={},n.objNewButtonFilterGridCriteria={},n.objNewButtonServerMethod={},n.objNewButtonOpenWordDoc={},n.lstMode=[],n.IsPopupStepDisable=!0,n.IsNewButtonStepDisable=!0,n.IsNewGridStepDisable=!0,n.IsNewFilterGridSearchCriteriaStepDisable=!0,n.IsNewSaveStepsDisable=!0,n.IsNewExecuteStepsDisable=!0,n.IsOpenWordDocStepsDisable=!0,n.IsNewExecuteBusinessStepsDisable=!0,n.IsGeneralPropStepsDisable=!0,n.objNewButtonCustomAttr.CustomAttributeText="Custom Attributes",n.ControlTypes=["","TextBox","DropDownList"],n.lstControlTypes=["","Label"],n.objFilterGridFieldsDetails={},n.objFilterGridFieldsDetails.AvailableFieldColletion=[],n.objFilterGridFieldsDetails.lstResultFieldsForGrid=[],n.objFilterGridFieldsDetails.GridNonAvailableControlCollection=[],n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection=[],n.objNewButtonFilterGridCriteria.AvailableFieldColletion=[],n.IsParentAsCollection=!1,n.entityName=undefined,n.formodel&&n.formodel.dictAttributes.sfwEntity&&(n.entityName=n.formodel.dictAttributes.sfwEntity),n.ParentModel&&n.ParentModel.dictAttributes.sfwEntityField){n.IsParentAsCollection=!0;var c=e.GetEntityFieldObjectFromEntityField(n.formodel.dictAttributes.sfwEntity,n.ParentModel.dictAttributes.sfwEntityField);c&&(n.entityName=c.Entity)}n.Init=function(){n.sfxControl={Name:n.ControlName,Value:"",prefix:"swc",dictAttributes:{Visible:"True"},Elements:[],Children:[]};CheckAndSetSfwButtonDefaultValues(n.formodel,n.sfxControl,n.SelectedButtonDetails.Method);n.SelectedButtonDetails.Method=="btnOpenPopupDialog_Click"||n.SelectedButtonDetails.Method=="btnNewPopupDialog_Click"||n.SelectedButtonDetails.Method=="btnFinishPopupDialog_Click"||n.SelectedButtonDetails.Method=="btnClosePopupDialog_Click"?(n.InitForGrid(),n.IsPopupStepDisable=!1):n.SelectedButtonDetails.Method=="btnNew_Click"||n.SelectedButtonDetails.Method=="btnNewUpdate_Click"||n.SelectedButtonDetails.Method=="btnOpen_Click"?(n.InitForNewButtonMethod(),n.InitForGridControl(),n.IsNewButtonStepDisable=!1):n.SelectedButtonDetails.Method=="btnGridSearch_Click"?(n.IsNewGridStepDisable=!1,n.objNewButtonFilterGrid.SelectGridOption="CreateNewGrid",n.InitForGridControl()):n.SelectedButtonDetails.Method=="btnSave_Click"||n.SelectedButtonDetails.Method=="btnForceSave_Click"||n.SelectedButtonDetails.Method=="btnSaveNew_Click"||n.SelectedButtonDetails.Method=="btnSaveAndNext_Click"||n.SelectedButtonDetails.Method=="btnSaveIgnoreReadOnly_Click"||n.SelectedButtonDetails.Method=="btnNoChangesSave_Click"?n.IsNewSaveStepsDisable=!1:n.SelectedButtonDetails.Method=="btnOpenDoc_Click"?(n.IsOpenWordDocStepsDisable=!1,n.InitForGridControl(),i.IsLoading=!0,$.connection.hubCreateNewObject.server.loadCorrespondenceTemplate(!1).done(function(t){n.receiveCorrespondenceTemplateForForm(t)})):n.SelectedButtonDetails.Method=="btnExecuteServerMethod_Click"||n.SelectedButtonDetails.Method=="btnExecuteBusinessMethod_Click"||n.SelectedButtonDetails.Method=="btnValidateExecuteBusinessMethod_Click"||n.SelectedButtonDetails.Method=="btnDownload_Click"||n.SelectedButtonDetails.Method=="btnCompleteWorkflowActivities_Click"?(n.IsNewExecuteStepsDisable=!1,n.objNewButtonServerMethod.Init()):n.SelectedButtonDetails.Method=="btnExecuteBusinessMethodSelectRows_Click"?(n.IsNewExecuteBusinessStepsDisable=!1,n.objNewButtonServerMethod.Init()):n.IsGeneralPropStepsDisable=!1;n.objNewButtonGeneralProp.PopulateMode();n.objNewButtonGeneralProp.IsLookup=n.formodel.dictAttributes.sfwType.toUpperCase()=="LOOKUP";n.objNewButtonGeneralProp.PopulateSecurityLevel();n.$evalAsync(function(){i.IsLoading=!1})};n.objNewButtonGeneralProp.PopulateMode=function(){n.objNewButtonGeneralProp.lstMode=[];n.objNewButtonGeneralProp.lstMode.push("All");n.objNewButtonGeneralProp.lstMode.push("New");n.objNewButtonGeneralProp.lstMode.push("Update")};n.objNewButtonGeneralProp.PopulateSecurityLevel=function(){n.objNewButtonGeneralProp.lstSecurityLevel=[];n.objNewButtonGeneralProp.lstSecurityLevel.push({Code:"0",Description:" None"});n.objNewButtonGeneralProp.lstSecurityLevel.push({Code:"1",Description:" Read"});n.objNewButtonGeneralProp.lstSecurityLevel.push({Code:"2",Description:" Modify"});n.objNewButtonGeneralProp.lstSecurityLevel.push({Code:"3",Description:" New"});n.objNewButtonGeneralProp.lstSecurityLevel.push({Code:"4",Description:" Delete"});n.objNewButtonGeneralProp.lstSecurityLevel.push({Code:"5",Description:" Execute"})};n.CloseWizardClick=function(){n.ButtonWizardDialog.close()};n.objNewButtonDialogForGrid.IsNextDisable=function(){var t=!0;return n.objNewButtonDialogForGrid.SelectGridOption=="CreateNewGrid"&&(n.objNewButtonDialogForGrid.ErrorMessageForDisplay="",n.objNewButtonDialogForGrid.ValidateDialogPanel()||(t=!1)),t};n.objNewButtonDialogForGrid.IsFinishDisable=function(){var t=!0;return n.objNewButtonDialogForGrid.SelectGridOption=="UseExistingGrid"&&(n.objNewButtonDialogForGrid.ErrorMessageForDisplay="",n.objNewButtonDialogForGrid.ValidateDialogPanel()||n.objNewButtonDialogForGrid.ValidateGridControl()||(t=!1)),t};n.objCreateNewGrid.IsNextDisable=function(){var t=!0;return n.objCreateNewGrid.ErrorMessageForDisplay="",n.objCreateNewGrid.SelectedEntityField&&(n.objCreateNewGrid.SelectedEntityField.DataType=="Collection"||n.objCreateNewGrid.SelectedEntityField.DataType=="CDOCollection"||n.objCreateNewGrid.SelectedEntityField.DataType=="List")?t=!1:n.objCreateNewGrid.ErrorMessageForDisplay="Error: A valid collection needs to be selected for the grid.",t};n.objGridObjectField.IsNextDisable=function(){var t=!0,i;return n.objGridObjectField.ErrorMessageForDisplay="",n.objGridObjectField.lstFields&&n.objGridObjectField.lstFields.length>0?(i=[],i=n.objGridObjectField.lstselectedmultiplelevelfield,i.length>0?t=!1:n.objGridObjectField.ErrorMessageForDisplay="Error: Please select atleast one value from the list."):n.isAnyErrors()&&(t=!1),t};n.objNewButtonActiveForm.IsNextDisable=function(){var r,t,i;if(n.objNewButtonActiveForm.ErrorMessageForDisplay="",n.sfxControl.dictAttributes.ID==undefined||n.sfxControl.dictAttributes.ID=="")return n.objNewButtonActiveForm.ErrorMessageForDisplay="Enter the button ID.",!0;if(n.isAnyErrors())return!0;if(n.objNewButtonActiveForm.ActiveFormType=="SingleForm"){if(n.objNewButtonActiveForm.StrActiveForm==undefined||n.objNewButtonActiveForm.StrActiveForm=="")return n.objNewButtonActiveForm.ErrorMessageForDisplay="Select active form.",!0;if(n.objNewButtonActiveForm.StrActiveForm==n.formodel.dictAttributes.ID)return n.objNewButtonActiveForm.ErrorMessageForDisplay="Can not select same form as active form.",!0}else if(n.objNewButtonActiveForm.ActiveFormType=="MultipleForm"){if(n.objNewButtonActiveForm.ActiveFormCollection.length==0)return n.objNewButtonActiveForm.ErrorMessageForDisplay="Atleast one active form has to be added.",!0;for(r=0,t=0;t<n.objNewButtonActiveForm.ActiveFormCollection.length;t++){if(i=n.objNewButtonActiveForm.ActiveFormCollection[t],i.FieldValue=="ACTV"&&r++,!i.FieldValue)return n.objNewButtonActiveForm.ErrorMessageForDisplay="Please Select or enter field value of row number "+(t+1),!0;if(i.ActiveForm){if(i.ActiveForm==n.formodel.dictAttributes.ID)return n.objNewButtonActiveForm.ErrorMessageForDisplay="Can not select same form as active form.",!0}else return n.objNewButtonActiveForm.ErrorMessageForDisplay="Please enter active form value of row number "+(t+1),!0}return r>1?(n.objNewButtonActiveForm.ErrorMessageForDisplay="Cannot add multiple active forms with same field value - ACTV",!0):!1}return!1};n.objNewButtonFilterGrid.IsNextDisable=function(){var i,t,f,u;if(n.objNewButtonFilterGrid.ErrorMessageForDisplay="",n.isAnyErrors())return!0;if(n.objNewButtonFilterGrid.SelectGridOption&&n.objNewButtonFilterGrid.SelectGridOption=="UseExistingGrid")if(n.sfxControl.dictAttributes.sfwRelatedControl){if(i=n.objNewButtonFilterGrid.lstRelatedGrid.filter(function(t){return t==n.sfxControl.dictAttributes.sfwRelatedControl}),!i||i&&i.length==0)return n.objNewButtonFilterGrid.ErrorMessageForDisplay="Invalid Grid Selected",!0}else return n.objNewButtonFilterGrid.ErrorMessageForDisplay="Please Select Grid View",!0;return n.objNewButtonFilterGrid.StrBaseQuery==undefined||n.objNewButtonFilterGrid.StrBaseQuery==""?(this.ErrorMessageForDisplay="Please Select Base Query.",!0):(t=n.objNewButtonFilterGrid.StrBaseQuery.split("."),t.length>0)?(f=r.getEntityIntellisense(),u=f.filter(function(n){return n.ID==t[0]}),u&&u.length>0&&t.length>1?n.objNewButtonFilterGrid.ValidateQuery(u[0],t[1]):(n.objNewButtonFilterGrid.ErrorMessageForDisplay="Invalid Base Query",!0)):!1};n.objNewButtonFilterGridCriteria.IsFinishDisable=function(){return(n.objNewButtonFilterGridCriteria.ErrorMessageForDisplay="",n.objNewButtonFilterGridCriteria.StrNoOfColumn==undefined||n.objNewButtonFilterGridCriteria.StrNoOfColumn=="")?(n.objNewButtonFilterGridCriteria.ErrorMessageForDisplay="Please Select No of column to be Created.",!0):!1};n.objNewButtonServerMethod.onMethodTypeChange=function(t){n.showRules=!1;n.showObjectMethod=!1;n.showXmlMethod=!1;n.objNewButtonServerMethod.StrServerMethod="";t=="ObjectMethod"?(n.showObjectMethod=!0,n.Title="Object Method :"):t=="XmlMethod"?(n.showXmlMethod=!0,n.Title="Xml Method :"):t=="Rule"&&(n.showRules=!0,n.Title="Rule :");n.objNewButtonServerMethod.IsNextDisable()};n.objNewButtonServerMethod.IsFinishDisable=function(){if(n.SelectedButtonDetails.Method=="btnGridSearchCriteriaReq_Click"){if(n.objNewButtonServerMethod.ErrorMessageForDisplay="",n.objNewButtonServerMethod.StrServerMethod==undefined||n.objNewButtonServerMethod.StrServerMethod=="")return n.objNewButtonServerMethod.ErrorMessageForDisplay="Select Object Method",!0}else return!0;return!1};n.objNewButtonServerMethod.IsNextDisable=function(){if(n.SelectedButtonDetails.Method!="btnGridSearchCriteriaReq_Click"){if(n.objNewButtonServerMethod.ErrorMessageForDisplay="",n.SelectedButtonDetails.Method=="btnExecuteServerMethod_Click"||n.SelectedButtonDetails.Method=="btnExecuteBusinessMethod_Click"||n.SelectedButtonDetails.Method=="btnDownload_Click"||n.SelectedButtonDetails.Method=="btnValidateExecuteBusinessMethod_Click"||n.SelectedButtonDetails.Method=="btnExecuteBusinessMethodSelectRows_Click"||n.SelectedButtonDetails.Method=="btnCompleteWorkflowActivities_Click")if(n.SelectedButtonDetails.Method=="btnExecuteServerMethod_Click"||n.SelectedButtonDetails.Method=="btnDownload_Click"){if(n.objNewButtonServerMethod.StrServerMethod==undefined||n.objNewButtonServerMethod.StrServerMethod=="")return n.objNewButtonServerMethod.ErrorMessageForDisplay="Select Server Method.",!0;if(n.objNewButtonServerMethod.StrServerMethod&&!n.objNewButtonServerMethod.lstXmlMethods.some(function(t){return t==n.objNewButtonServerMethod.StrServerMethod}))return n.objNewButtonServerMethod.ErrorMessageForDisplay="Invalid Server Method.",!0}else if(!n.objNewButtonServerMethod.StrServerMethod)return n.objNewButtonServerMethod.ErrorMessageForDisplay=n.objNewButtonServerMethod.sfwExecuteMethodType=="ObjectMethod"?"Select Object Method.":n.objNewButtonServerMethod.sfwExecuteMethodType=="XmlMethod"?"Select Xml Method.":n.objNewButtonServerMethod.sfwExecuteMethodType=="Rule"?"Select Rule.":"Select Object Method.",!0;return n.isAnyErrors()?!0:!1}return!0};n.objNewButtonOpenWordDoc.IsNextDisable=function(){if(n.objNewButtonOpenWordDoc.ErrorMessageForDisplay="",n.objNewButtonOpenWordDoc.TemplateName&&n.objNewButtonOpenWordDoc.lstCorrTemplates!=undefined){var t=n.objNewButtonOpenWordDoc.lstCorrTemplates.filter(function(t){return t==n.objNewButtonOpenWordDoc.TemplateName});if(!t||t&&t.length==0)return n.objNewButtonOpenWordDoc.ErrorMessageForDisplay="Invalid Template Name.",!0}return!1};n.objNewButtonDialogForGrid.lstDialogPanel=[];n.objNewButtonDialogForGrid.lstRelatedGrid=[];n.objCreateNewGrid.lstselectedobjecttreefields=[];n.objGridObjectField.lstFields=[];n.InitForGrid=function(){n.objNewButtonDialogForGrid.SelectGridOption="CreateNewGrid";n.objNewButtonDialogForGrid.SelectDialogPanelOption="CreateNewDialogPanel";n.objNewButtonDialogForGrid.lstRelatedGrid.push("");PopulateRelatedGrid(n.formodel,n.objNewButtonDialogForGrid.lstRelatedGrid,!1);n.PopulateDialogPanels();n.objGridField.LoadControlTypes();n.objGridField.LoadDataFormat();n.objGridField.LoadDataKey();n.objGridField.LoadSort();n.objGridField.LoadOrder();n.CreateGridView()};n.CreateGridView=function(){n.objGridView={Name:"sfwGridView",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]};n.objGridView.dictAttributes.ID="dgrResult";n.objGridView.dictAttributes.AllowPaging="True";n.objGridView.dictAttributes.AllowSorting="True";n.objGridView.dictAttributes.sfwSelection="Many"};n.PopulateDialogPanels=function(){var t=[];FindControlListByName(n.formodel,"sfwDialogPanel",t);n.objNewButtonDialogForGrid.lstDialogPanel.push("");t&&t.length>0&&angular.forEach(t,function(t){n.objNewButtonDialogForGrid.lstDialogPanel.push(t.dictAttributes.ID)})};n.objNewButtonDialogForGrid.ValidateDialogPanel=function(){var t=!1;return n.objNewButtonDialogForGrid.SelectDialogPanel==undefined||n.objNewButtonDialogForGrid.SelectDialogPanel==""?(n.objNewButtonDialogForGrid.ErrorMessageForDisplay="Error: Dialog Panel ID can not be empty.",t=!0):n.objNewButtonDialogForGrid.SelectDialogPanelOption=="CreateNewDialogPanel"&&n.objNewButtonDialogForGrid.SelectDialogPanel!=undefined&&n.objNewButtonDialogForGrid.SelectDialogPanel!=""&&n.objNewButtonDialogForGrid.lstDialogPanel.some(function(t){return t==n.objNewButtonDialogForGrid.SelectDialogPanel})&&(n.objNewButtonDialogForGrid.ErrorMessageForDisplay="Error: Dialog Panel ID already exist.",t=!0),t};n.objNewButtonDialogForGrid.ValidateGridControl=function(){var t=!1;return n.objNewButtonDialogForGrid.SelectGridOption=="UseExistingGrid"&&(n.objNewButtonDialogForGrid.SelectGrid==undefined||n.objNewButtonDialogForGrid.SelectGrid=="")&&(n.objNewButtonDialogForGrid.ErrorMessageForDisplay="Error: Related Control can not be empty.",t=!0),t};n.objCreateNewGrid.OnNextClick=function(){if(n.objGridObjectField.lstFields&&n.objGridObjectField.lstFields.length>0){var t=r.getEntityIntellisense(),i=getPrimarykey(t,n.objGridObjectField.lstFields[0].Entity);n.objGridView&&n.objGridView.dictAttributes&&n.objCreateNewGrid.SelectedEntityField&&(n.objGridView.dictAttributes.sfwEntityField=n.objCreateNewGrid.SelectedEntityField.ID)}n.objGridView&&n.objGridView.dictAttributes&&n.objCreateNewGrid.SelectedEntityField&&(n.objGridView.dictAttributes.sfwEntityField=n.objCreateNewGrid.SelectedEntityField.ID)};n.objGridObjectField.OnNextClick=function(){var t=[],r,u,i;n.objGridField.FieldCollection=[];t=n.objGridObjectField.lstselectedmultiplelevelfield;t.length>0&&(r=[],u=0,angular.forEach(t,function(t){var r=t.FieldObject,i={},u,f;i.istrFieldName=r.ID;i.istrObjectID=r.Value;i.istrDataType=r.DataType;u=t.Entity;i.istrEntityName=u;i.istrItemPath=t.EntityField;i.istrControlType="Label";r&&(f=GetCaptionFromField(r),i.istrHeader=f);i.istrPropertyName=t.EntityField;i.istrVisible="True";n.objGridField.FieldCollection.push(i)}));n.objCreateNewGrid&&n.objCreateNewGrid.SelectedEntityField&&(i=n.objCreateNewGrid.SelectedEntityField.ID,i=CreateControlID(n.formodel,n.objCreateNewGrid.SelectedEntityField.ID,"sfwGridView"),n.objGridView.dictAttributes.ID=i)};n.objGridField.ArrControlTypes=[];n.objGridField.ArrDataFormat=[];n.objGridField.ArrDataKey=[];n.objGridField.ArrSort=[];n.objGridField.ArrOrder=[];n.objGridField.ArrRelativeControl=[];n.objGridField.FieldCollection=[];n.objGridField.ChangeSortExpression=function(n){n&&!n.istrSort&&(n.istrOrder="")};n.objGridField.LoadControlTypes=function(){n.objGridField.ArrControlTypes=[];n.objGridField.ArrControlTypes.push("");n.objGridField.ArrControlTypes.push("Label");n.objGridField.ArrControlTypes.push("HyperLink");n.objGridField.ArrControlTypes.push("TextBox");n.objGridField.ArrControlTypes.push("Checkbox");n.objGridField.ArrControlTypes.push("DropDownList")};n.objGridField.LoadDataFormat=function(){n.objGridField.ArrDataFormat=[];n.objGridField.ArrDataFormat.push("");n.objGridField.ArrDataFormat.push("{0:d}");n.objGridField.ArrDataFormat.push("{0:C}");n.objGridField.ArrDataFormat.push("{0:000-##-####}");n.objGridField.ArrDataFormat.push("{0:(###)###-####}")};n.objGridField.LoadDataKey=function(){n.objGridField.ArrDataKey=[];n.objGridField.ArrDataKey.push("");n.objGridField.ArrDataKey.push("1");n.objGridField.ArrDataKey.push("2");n.objGridField.ArrDataKey.push("3");n.objGridField.ArrDataKey.push("4");n.objGridField.ArrDataKey.push("5")};n.objGridField.LoadSort=function(){n.objGridField.ArrSort=[];n.objGridField.ArrSort.push("");n.objGridField.ArrSort.push("1");n.objGridField.ArrSort.push("2");n.objGridField.ArrSort.push("3")};n.objGridField.LoadOrder=function(){n.objGridField.ArrOrder=[];n.objGridField.ArrOrder.push("");n.objGridField.ArrOrder.push("asc");n.objGridField.ArrOrder.push("desc")};n.objGridField.LoadRelativeControl=function(){n.objGridField.ArrRelativeControl=[];n.objGridField.ArrRelativeControl.push("");angular.forEach(ialGridButtons,function(t){var i=t.dictAttributes.ID;i&&n.objGridField.ArrRelativeControl.push(i)})};n.objGridField.onFieldClick=function(t){n.objGridField.SelectGridField=t};n.objGridField.MoveUpField=function(){if(n.objGridField.SelectGridField){var t=n.objGridField.FieldCollection.indexOf(n.objGridField.SelectGridField),i=n.objGridField.FieldCollection[t-1];n.objGridField.FieldCollection[t-1]=n.objGridField.SelectGridField;n.objGridField.FieldCollection[t]=i}};n.objGridField.MoveDownField=function(){if(n.objGridField.SelectGridField){var t=n.objGridField.FieldCollection.indexOf(n.objGridField.SelectGridField),i=n.objGridField.FieldCollection[t+1];n.objGridField.FieldCollection[t+1]=n.objGridField.SelectGridField;n.objGridField.FieldCollection[t]=i}};n.objGridField.CanMoveUp=function(){var t=!1,i;return n.objGridField.SelectGridField?(i=n.objGridField.FieldCollection.indexOf(n.objGridField.SelectGridField),i==0&&(t=!0)):t=!0,t};n.objGridField.CanMoveDown=function(){var t=!1,i;return n.objGridField.SelectGridField?(i=n.objGridField.FieldCollection.indexOf(n.objGridField.SelectGridField),i==n.objGridField.FieldCollection.length-1&&(t=!0)):t=!0,t};n.InitForNewButtonMethod=function(){function f(t){t&&n.objNewButtonActiveForm.lstRelatedControl.push(t)}var u=FindParent(n.sfxCell,"sfwGridView"),t,i,r;u&&(n.objNewButtonActiveForm.objRelatedGrid=u,n.alControls=[],n.PopulateControlsForActiveForm(n.alControls,t));n.objNewButtonActiveForm.ActiveFormCollection=[];n.objNewButtonActiveForm.lstRelatedControl=[];t=n.formodel.dictAttributes.sfwType.toUpperCase()=="LOOKUP";i="";n.sfxControl.dictAttributes.sfwMethodName=="btnNew_Click"||n.sfxControl.dictAttributes.sfwMethodName=="btnNewUpdate_Click"?i=t?"tblCriteria panel fields":"Form fields":n.sfxControl.dictAttributes.sfwMethodName=="btnOpen_Click"&&(PopulateRelatedGrid(n.formodel,n.objNewButtonActiveForm.lstRelatedControl,!1),r=n.sfxControl.dictAttributes.sfwRelatedControl,i=r==""?"Grid fields":r+" fields");n.alControls=[];n.PopulateControlsForActiveForm(n.alControls,t);n.objNewButtonActiveForm.StrActiveForm=n.sfxControl.dictAttributes.sfwActiveForm;n.objNewButtonActiveForm.StrEntityField=n.sfxControl.dictAttributes.sfwEntityField;n.InitializeActiveForms(n.objNewButtonActiveForm.StrActiveForm,n.sfxControl.dictAttributes.sfwEntityField,n.alControls,i);n.objNewButtonActiveForm.ActiveFormType="SingleForm";n.sfxControl.dictAttributes.sfwMethodName=="btnNew_Click"&&n.objNewButtonActiveForm.lstFields&&n.objNewButtonActiveForm.lstFields.length>0&&angular.forEach(n.objNewButtonActiveForm.lstFields,f)};n.objNewButtonActiveForm.onRelatedControlChanged=function(){var r,i,t;n.objNewButtonActiveForm.ActiveFormCollection=[];r=n.formodel.dictAttributes.sfwType.toUpperCase()=="LOOKUP";n.sfxControl.dictAttributes.sfwRelatedControl!=undefined&&n.sfxControl.dictAttributes.sfwRelatedControl!=""&&(n.sfxControl.dictAttributes.sfwMethodName=="btnOpen_Click"?(i=n.sfxControl.dictAttributes.sfwRelatedControl,strParent=i==""?"Grid fields":i+" fields",n.alControls=[],n.PopulateControlsForActiveForm(n.alControls,r),n.objNewButtonActiveForm.StrActiveForm=n.sfxControl.dictAttributes.sfwActiveForm,n.objNewButtonActiveForm.StrEntityField=n.sfxControl.dictAttributes.sfwEntityField,n.InitializeActiveForms(n.objNewButtonActiveForm.StrActiveForm,n.sfxControl.dictAttributes.sfwEntityField,n.alControls,strParent)):n.sfxControl.dictAttributes.sfwMethodName=="btnNew_Click"&&(n.objNewButtonActiveForm.alCodeVal=[],n.sfxControl.dictAttributes.sfwRelatedControl&&(t=FindControlByID(n.formodel,n.sfxControl.dictAttributes.sfwRelatedControl),t&&t.dictAttributes&&t.dictAttributes.sfwLoadType=="CodeGroup"?(n.IsValue=!0,t.dictAttributes.sfwLoadSource?$.connection.hubMain.server.getCodeValues("ScopeId_"+n.$id,t.dictAttributes.sfwLoadSource):t.placeHolder&&$.connection.hubMain.server.getCodeValues("ScopeId_"+n.$id,t.placeHolder)):n.IsValue=!1)))};n.PopulateControlsForActiveForm=function(t,i){var r,u;n.sfxControl&&(r=[],n.sfxControl.dictAttributes.sfwMethodName=="btnNew_Click"||n.sfxControl.dictAttributes.sfwMethodName=="btnNewUpdate_Click"?i?GetAllControls(n.formodel,"sfwLabel,sfwTextBox,sfwDropDownList,sfwCheckBox,sfwRadioButtonList,sfwLinkButton","tblcriteria","",!1,r,!1):GetAllControls(n.formodel,"sfwLabel,sfwTextBox,sfwDropDownList,sfwCheckBox,sfwRadioButtonList,sfwLinkButton,sfwScheduler","","",!1,r,!0):n.sfxControl.dictAttributes.sfwMethodName=="btnOpen_Click"&&(u=n.sfxControl.dictAttributes.sfwRelatedControl,n.objNewButtonActiveForm.objRelatedGrid&&n.objNewButtonActiveForm.objRelatedGrid.dictAttributes&&(u=n.objNewButtonActiveForm.objRelatedGrid.dictAttributes.ID),u!=""&&GetAllControls(n.formodel,"","",u,!1,r)),angular.forEach(r,function(r){var u="";"sfwLoadSource"in r.dictAttributes&&(u=r.dictAttributes.sfwLoadSource);(u==""||u=="0")&&(u="~",r.Elements.length>0&&angular.forEach(r.Elements,function(n){n.Name=="ListItem"&&n.dictAttributes.Value&&(u+=n.dictAttributes.Value+",")}));i?"sfwDataField"in r.dictAttributes&&r.dictAttributes.sfwDataField&&(n.sfxControl.dictAttributes.sfwMethodName=="btnNew_Click"?t.push(r.dictAttributes.ID+"~"+u):t.push(r.dictAttributes.sfwDataField+"~"+u)):"sfwEntityField"in r.dictAttributes&&r.dictAttributes.sfwEntityField&&t.push(r.dictAttributes.sfwEntityField)}))};n.InitializeActiveForms=function(t,i,r,u){var s,e,f,o;if(n.objNewButtonActiveForm.lstFields=[],ilAvlFlds=r,n.sfxControl.dictAttributes.sfwMethodName=="btnNew_Click"||n.sfxControl.dictAttributes.sfwMethodName=="btnNewUpdate_Click")GetObjectFields(n.formodel,n.objNewButtonActiveForm.lstFields,n.sfxControl);else if(n.sfxControl.dictAttributes.sfwMethodName!="btnDelete_Click"&&n.sfxControl.dictAttributes.sfwMethodName=="btnOpen_Click"&&(s="(Object Fields are populated from the "+u+".)",n.objNewButtonActiveForm.lstFields.push(""),r.length>0))for(e=0;e<r.length;e++)f=r[e],o="",o=f.indexOf("~")>-1?f.substring(0,f.indexOf("~")):f,n.objNewButtonActiveForm.lstFields.push(o)};n.objNewButtonActiveForm.OnAddExpressionClick=function(){var t={FieldValue:"",ActiveForm:""};n.objNewButtonActiveForm.ActiveFormCollection.push(t);n.objNewButtonActiveForm.SelectedExpression=t};n.objNewButtonActiveForm.OnDeleteExpressionClick=function(){if(n.objNewButtonActiveForm.SelectedExpression!=null){var t=n.objNewButtonActiveForm.lstFields.indexOf(n.objNewButtonActiveForm.SelectedExpression);n.objNewButtonActiveForm.ActiveFormCollection.splice(t,1);n.objNewButtonActiveForm.SelectedExpression=n.objNewButtonActiveForm.ActiveFormCollection.length>0?n.objNewButtonActiveForm.ActiveFormCollection[n.objNewButtonActiveForm.ActiveFormCollection.length-1]:n.objNewButtonActiveForm.ActiveFormCollection[0]}};n.objNewButtonActiveForm.onEntityFieldChange=function(){var h,t,i,u,f,o,c,s,l;n.IsValue=!1;n.objNewButtonActiveForm.alCodeVal=[];n.objNewButtonActiveForm.StrEntityField&&(h=n.objNewButtonActiveForm.StrEntityField,t=n.formodel.dictAttributes.sfwEntity,n.sfxControl.dictAttributes.sfwMethodName=="btnOpen_Click"&&(objControl=FindControlByID(n.formodel,n.sfxControl.dictAttributes.sfwRelatedControl),n.objNewButtonActiveForm.objRelatedGrid&&n.objNewButtonActiveForm.objRelatedGrid.dictAttributes&&(objControl=n.objNewButtonActiveForm.objRelatedGrid),objControl&&objControl.dictAttributes&&objControl.dictAttributes.sfwEntityField&&(i=e.GetEntityFieldObjectFromEntityField(t,objControl.dictAttributes.sfwEntityField),i&&(t=i.Entity))),u=r.getEntityIntellisense().filter(function(n){return n.ID==t}),u&&u.length>0&&(f=e.GetEntityFieldObjectFromEntityField(t,h),f&&(o=f.Value,o.match("_value$")&&(c=o.replace("_value","_id"),s=e.GetEntityFieldObjectFromFieldValue(t,c),s&&(n.IsValue=!0,l=s.CodeID,$.connection.hubMain.server.getCodeValues("ScopeId_"+n.$id,l))))))};n.receiveList=function(t){n.$evalAsync(function(){var i=t;i&&i.length>0&&(n.objNewButtonActiveForm.alCodeVal.push(""),angular.forEach(i,function(t){n.objNewButtonActiveForm.alCodeVal.push(t.CodeValue)}))})};n.objNewButtonActiveForm.objActiveFormTypeChange=function(){n.objNewButtonActiveForm.StrActiveForm="";n.objNewButtonActiveForm.StrEntityField="";n.objNewButtonActiveForm.ActiveFormCollection=[]};n.objNewButtonNaviagtionParam.showAllControlChange=function(){n.$evalAsync(function(){n.objNewButtonNaviagtionParam.PopulateAvailableFields()})};n.objNewButtonNaviagtionParam.Init=function(){var t,i,r,f,u;n.IsOpenWordDocStepsDisable&&(n.objNewButtonNaviagtionParam.ParameterCollection=[],n.objNewButtonNaviagtionParam.FieldCollection=[],n.objNewButtonNaviagtionParam.PopulateAvailableFields(),t=n.sfxControl.dictAttributes.sfwMethodName,i="",t=="btnExecuteServerMethod_Click"||t=="btnDownload_Click"?i=n.sfxControl.dictAttributes.sfwObjectMethod:t=="btnExecuteBusinessMethod_Click"||t=="btnCompleteWorkflowActivities_Click"||t=="btnValidateExecuteBusinessMethod_Click"?i=n.sfxControl.dictAttributes.sfwEntityMethod?n.sfxControl.dictAttributes.sfwEntityMethod+"."+n.sfxControl.dictAttributes.sfwObjectMethod:n.sfxControl.dictAttributes.sfwObjectMethod:t=="btnExecuteBusinessMethodSelectRows_Click"?(r=n.sfxControl.dictAttributes.sfwRelatedControl,f="",r!=undefined&&r!=""?(u=n.formodel.Elements.filter(function(n){return n.Name=="sfwTable"}),u&&u.length>0&&(i=r+":"+n.PopulateDataKeyForGrid(r,u[0],f))):i=""):i=t=="btnWizardFindAndNext_Click"?n.sfxControl.dictAttributes.sfwObjectMethod:t=="btnSaveNew_Click"?n.formodel.dictAttributes.ID:n.sfxControl.dictAttributes.sfwActiveForm!=undefined&&n.sfxControl.dictAttributes.sfwActiveForm!=""?n.sfxControl.dictAttributes.sfwActiveForm:n.sfxControl.dictAttributes.sfwXmlDocument,n.objNewButtonNaviagtionParam.PopulateParameters(t,i))};n.objNewButtonNaviagtionParam.PopulateAvailableFields=function(){var i,f,r,e,t;if(n.objMainTable=undefined,i=undefined,n.formodel&&n.sfxControl&&n.sfxControl.dictAttributes&&n.sfxControl.dictAttributes.sfwMethodName=="btnNew_Click"&&(f=getDescendents(n.formodel,"sfwPanel"),f&&f.length>0&&(r=f.filter(function(n){return n.dictAttributes.ID==="pnlMain"||n.dictAttributes.ID==="pnlCriteria"})[0],r&&r.Elements&&r.Elements.length>0&&(i=r.Elements[0]))),i||(i=FindParent(n.sfxCell,"sfwTable")),e=n.formodel.Elements.filter(function(n){return n.Name=="sfwTable"}),e&&e.length>0&&(n.objMainTable=e[0]),n.objNewButtonNaviagtionParam.FieldCollection=[],n.formodel){var h=n.formodel.dictAttributes.sfwType,o=h.toUpperCase().trim()=="LOOKUP",u,s=!1;n.sfxControl&&n.sfxControl.dictAttributes&&n.sfxControl.dictAttributes.sfwMethodName=="btnNew_Click"?(u="ID",s=!0):u=o?"sfwDataField":"sfwEntityField";t={Text:"Main",Items:[],IsSelected:!1,IsCheckBoxVisible:!1};t.ControlName="Main";n.objNewButtonNaviagtionParam.IsShowAllControl?PopulateAvailableFields(u,n.objMainTable,t,!1,o,s):i?PopulateAvailableFields(u,i,t,!1,o,s):PopulateAvailableFields(u,n.objMainTable,t,!1,o,s);t.Items.length>0&&n.objNewButtonNaviagtionParam.FieldCollection.push(t)}};n.objNewButtonNaviagtionParam.AddParamGridRow=function(t,i,r,u){var f={};f.Type=t;f.ParameterField=i;r&&(r.match("^#")?(f.Constants=!0,f.ParameterValue=r.substring(1)):f.ParameterValue=r,f.EntityField=r,f.IsReadOnly=!0);f.ControlID=u;n.objNewButtonNaviagtionParam.ParameterCollection.push(f)};n.objNewButtonNaviagtionParam.PopulateParameters=function(t,u){var g,y,c,h,d,nt,b,a,f,tt,it,p,s,l,w,k,e,v;if(n.objNewButtonNaviagtionParam.IsControlIDVisible=!1,n.objNewButtonNaviagtionParam.TargetFormCaption="Target Form:",d=r.getEntityIntellisense(),t=="btnSave_Click"||t=="btnNoChangesSave_Click"||t=="btnForceSave_Click"||t=="btnWizardSaveAndNext_Click"||t=="btnWizardSaveAndPrevious_Click"||t=="btnSaveAndNext_Click"||t=="btnSaveIgnoreReadOnly_Click"){if(n.formodel&&(n.objNewButtonNaviagtionParam.TargetForm=n.formodel.dictAttributes.ID,c=n.formodel.Elements.filter(function(n){return n.Name=="initialload"}),c&&c.length>0&&(g=c[0]),g&&(y="",c=g.Elements.filter(function(n){return n.Name=="callmethods"&&(n.dictAttributes.sfwMode==""||n.dictAttributes.sfwMode==undefined||n.dictAttributes.sfwMode=="Update")}),c&&c.length&&(y=c[0].dictAttributes.sfwMethodName),y!=undefined&&y!="")))if(n.formodel.dictAttributes.sfwRemoteObject){if(b=GetServerMethodObject(n.formodel.dictAttributes.sfwRemoteObject,n.formodel.RemoteObjectCollection),s=GetSrvMethodParameters(b,y),s)for(j=0;j<s.length;j++)n.objNewButtonNaviagtionParam.AddParamGridRow(s[j].dictAttributes.sfwDataType,s[j].dictAttributes.ID,"")}else if(h=d.filter(function(t){return t.ID==n.formodel.dictAttributes.sfwEntity}),h&&h[0].XmlMethods!=undefined&&h[0].XmlMethods.length>0)for(e=0;e<h[0].XmlMethods.length;e++)if(h[0].XmlMethods[e].ID==y)for(j=0;j<h[0].XmlMethods[e].Parameters.length;j++)n.objNewButtonNaviagtionParam.AddParamGridRow(h[0].XmlMethods[e].Parameters[j].DataType,h[0].XmlMethods[e].Parameters[j].ID,h[0].XmlMethods[e].Parameters[j].Value)}else if(t=="btnExecuteServerMethod_Click"||t=="btnWizardFindAndNext_Click"||t=="btnDownload_Click"){if(n.objNewButtonNaviagtionParam.TargetFormCaption="Server Method:",u==undefined||u=="")return;if(f=u.trim(),n.objNewButtonNaviagtionParam.TargetForm=f,f==""||f==undefined)return;d=r.getEntityIntellisense();nt="srvCommon";n.formodel&&n.formodel.dictAttributes.sfwRemoteObject&&(nt=n.formodel.dictAttributes.sfwRemoteObject);b=GetServerMethodObject(nt,n.formodel.RemoteObjectCollection);s=GetSrvMethodParameters(b,f);angular.forEach(s,function(t){n.objNewButtonNaviagtionParam.AddParamGridRow(t.dictAttributes.sfwDataType,t.dictAttributes.ID,"")})}else if(t=="btnExecuteBusinessMethod_Click"||t=="btnValidateExecuteBusinessMethod_Click"||t=="btnCompleteWorkflowActivities_Click"){if(a=[],n.objNewButtonServerMethod&&n.objNewButtonServerMethod.sfwExecuteMethodType?n.objNewButtonServerMethod.sfwExecuteMethodType=="ObjectMethod"?(n.objNewButtonNaviagtionParam.TargetFormCaption="Object Method:",a=n.entityName?o.GetIntellisenseData(n.entityName,"","",!0,!1,!0,!1,!1,!1):o.GetIntellisenseData(n.formodel.dictAttributes.sfwEntity,"","",!0,!1,!0,!1,!1,!1)):n.objNewButtonServerMethod.sfwExecuteMethodType=="XmlMethod"?(n.objNewButtonNaviagtionParam.TargetFormCaption="Xml Method:",a=n.entityName?o.GetIntellisenseData(n.entityName,"","",!0,!1,!1,!1,!1,!0):o.GetIntellisenseData(n.formodel.dictAttributes.sfwEntity,"","",!0,!1,!1,!1,!1,!0)):n.objNewButtonServerMethod.sfwExecuteMethodType=="Rule"&&(n.objNewButtonNaviagtionParam.TargetFormCaption="Rule:",a=n.entityName?o.GetIntellisenseData(n.entityName,"","",!0,!1,!1,!0,!1,!1):o.GetIntellisenseData(n.formodel.dictAttributes.sfwEntity,"","",!0,!1,!1,!0,!1,!1)):(n.objNewButtonNaviagtionParam.TargetFormCaption="Object Method:",a=n.entityName?o.GetIntellisenseData(n.entityName,"","",!0,!1,!0,!1,!1,!1):o.GetIntellisenseData(n.formodel.dictAttributes.sfwEntity,"","",!0,!1,!0,!1,!1,!1)),f=u.trim(),n.objNewButtonNaviagtionParam.TargetForm=f,f==""||f==undefined)return;tt="";f.contains(".")&&(tt=f.substring(0,f.indexOf(".")),f=f.substring(f.indexOf(".")+1));it=[];a&&angular.forEach(a,function(n){p||n.ID==f&&(p=n)});p&&(s=p.Parameters,s&&angular.forEach(s,function(i){p.RuleType&&["LogicalRule","DecisionTable","ExcelMatrix"].indexOf(p.RuleType)>-1?i.Direction=="In"&&(t=="btnExecuteBusinessMethodSelectRows_Click"?["Object","Collection","List"].indexOf(i.DataType)>-1&&n.objNewButtonNaviagtionParam.AddParamGridRow(i.DataType,i.ID,null):n.objNewButtonNaviagtionParam.AddParamGridRow(i.DataType,i.ID,null)):n.objNewButtonNaviagtionParam.AddParamGridRow(i.DataType,i.ID,null)}))}else if(t=="btnSaveNew_Click")n.objNewButtonNaviagtionParam.TargetForm=n.formodel.dictAttributes.ID,n.receivenewformmodel(n.formodel);else{if(u==undefined||u=="")return;if(l=u.trim(),w=l.split(";"),w.length>0)for(l=w[0],k="",e=0;e<w.length;e++)v=w[e],v.contains("=")&&(v=v.substring(v.indexOf("=")+1)),k+=k==""?v:";"+v;l.contains("=")&&(l=l.substring(l.indexOf("=")+1));n.objNewButtonNaviagtionParam.TargetForm=k;$.connection.hubForm.server.getNewFormModel(l).done(function(t){n.receivenewformmodel(t)});i.IsLoading=!0}};n.receivenewformmodel=function(t){n.$evalAsync(function(){var f,h,v,y,c,l,a,s,o,p,w,e,u;if(i.IsLoading=!1,f=t,h=n.sfxControl.dictAttributes.sfwMethodName,f)if(v=f.dictAttributes.sfwType,y=v.toUpperCase().trim()=="LOOKUP",y)n.objNewButtonNaviagtionParam.IsSaveWithControlIDVisible=!0,n.objNewButtonNaviagtionParam.IsControlIDVisible=!0,c=f.Elements.filter(function(n){return n.Name=="sfwTable"}),c&&c.length>0&&(l=GetCriteriaPanel(c[0]),l&&angular.forEach(l.Elements,function(t){angular.forEach(t.Elements,function(t){t&&angular.forEach(t.Elements,function(t){if("sfwDataField"in t.dictAttributes){var i=t.dictAttributes.sfwDataField,r=t.dictAttributes.ID;i!=""&&i!=undefined&&n.objNewButtonNaviagtionParam.AddParamGridRow("Criteria Field",i,"",r)}})})}));else if(a=h=="btnNew_Click"||h=="btnUpdate_Click"||h=="btnSaveNew_Click",u=f.Elements.filter(function(n){return n.Name=="initialload"}),u&&u.length>0&&(s=u[0]),s){if(o="",u=s.Elements.filter(function(n){return n.Name=="callmethods"&&(n.dictAttributes.sfwMode==""||n.dictAttributes.sfwMode==undefined||n.dictAttributes.sfwMode=="Update")}),u&&u.length&&(o=u[0].dictAttributes.sfwMethodName),a&&(u=s.Elements.filter(function(n){return n.Name=="callmethods"&&(n.dictAttributes.sfwMode==""||n.dictAttributes.sfwMode==undefined||n.dictAttributes.sfwMode=="New")}),u&&u.length&&(o=u[0].dictAttributes.sfwMethodName)),o!=undefined&&o!="")if(p=r.getEntityIntellisense(),f.dictAttributes.sfwRemoteObject!=undefined&&f.dictAttributes.sfwRemoteObject!=""){if(w=GetServerMethodObject(f.dictAttributes.sfwRemoteObject,n.formodel.RemoteObjectCollection),e=GetSrvMethodParameters(w,o),e)for(j=0;j<e.length;j++)n.objNewButtonNaviagtionParam.AddParamGridRow(e[j].dictAttributes.sfwDataType,e[j].dictAttributes.ID,"")}else e=GetEntityXMLMethodParameters(p,f.dictAttributes.sfwEntity,o),e&&angular.forEach(e,function(t){n.objNewButtonNaviagtionParam.AddParamGridRow(t.DataType,t.ID,t.Value)});a&&(u=s.Elements.filter(function(n){return n.Name=="session"}),u&&u.length>0&&angular.forEach(u[0].Elements,function(t){n.objNewButtonNaviagtionParam.AddParamGridRow("Session Field",t.dictAttributes.ID)}))}})};n.ExpandCollapsedCustomAttrField=function(n){n.IsExpanded=!n.IsExpanded};n.SetFieldClass=function(t){if(t==n.SelectedField)return"selected"};n.SelectFieldClick=function(t,i){n.SelectedField=t;i&&i.stopPropagation()};n.objNewButtonNaviagtionParam.onMessageIdChange=function(){n.objNewButtonNaviagtionParam.MessageDescription="";n.sfxControl.dictAttributes.sfwMessageId!=undefined&&n.sfxControl.dictAttributes.sfwMessageId!=""&&hubMain.server.populateMessageList().done(function(t){n.$evalAsync(function(){if(t&&t.length>0){var i=t.filter(function(t){return t.MessageID==n.sfxControl.dictAttributes.sfwMessageId});i&&i.length>0&&(n.objNewButtonNaviagtionParam.MessageDescription=i[0].DisplayMessage)}})})};n.objNewButtonNaviagtionParam.onMessageIdClick=function(){n.strCode="Messages";n.$on("onOKClick",function(t,i){n.sfxControl.dictAttributes.sfwMessageId=i.ID;n.objNewButtonNaviagtionParam.onMessageIdChange()});var t=n.$new(!0);t.strCode="Messages";t.SearchIDDescrDialog=i.showDialog(t,"Search ID Description","Common/views/SearchIDDescription.html",{width:800})};n.InitForCustomAttributes=function(t){n.objNewButtonCustomAttr.IsShowAllControl=!1;t=="sfwCustomAttributes"?(n.objNewButtonCustomAttr.CustomAttributeText="Custom Attributes:",n.objNewButtonCustomAttr.IsShowAllControlForCustAttr!==undefined&&(n.objNewButtonCustomAttr.IsShowAllControl=n.objNewButtonCustomAttr.IsShowAllControlForCustAttr)):(n.objNewButtonCustomAttr.CustomAttributeText="User Log Parameters:",n.objNewButtonCustomAttr.IsShowAllControlForUserParam!==undefined&&(n.objNewButtonCustomAttr.IsShowAllControl=n.objNewButtonCustomAttr.IsShowAllControlForUserParam));n.objNewButtonCustomAttr.FieldCollection=[];n.objNewButtonCustomAttr.ParameterCollection=[];n.objNewButtonCustomAttr.SelectedParameter=undefined;n.objNewButtonCustomAttr.LoadAvailableFields();n.objNewButtonCustomAttr.Initialize(t)};n.objNewButtonCustomAttr.SelectParameter=function(t){n.objNewButtonCustomAttr.SelectedParameter=t};n.objNewButtonCustomAttr.Initialize=function(t){var i=n.sfxControl.dictAttributes[t],r;i!=undefined&&i!=""&&(r=i.split(";"),angular.forEach(r,function(t){var f;if(t!=undefined&&t!=""){var r=t,i=t,u=!1;t.contains("=")&&(r=t.substring(0,t.indexOf("=")),i=t.substring(t.indexOf("=")+1),i.match("^#")&&(i=i.substring(1),u=!0));f={ParameterField:r,ParameterValue:i,Constants:u};n.objNewButtonCustomAttr.ParameterCollection.push(f)}}))};n.objNewButtonCustomAttr.LoadAvailableFields=function(){var r="",u=n.formodel.dictAttributes.sfwType.toUpperCase()=="LOOKUP",f,i,t;r=u?"sfwDataField":"sfwEntityField";n.objMainTable=undefined;f=FindParent(n.sfxCell,"sfwTable");i=n.formodel.Elements.filter(function(n){return n.Name=="sfwTable"});i&&i.length>0&&(n.objMainTable=i[0]);n.objNewButtonCustomAttr.FieldCollection=[];t={Text:"Main",Items:[],IsSelected:!1,IsCheckBoxVisible:!1};n.objNewButtonCustomAttr.IsShowAllControl?PopulateAvailableFields(r,n.objMainTable,t,!0,u,!1):PopulateAvailableFields(r,f,t,!0,u,!1);t.Items.length>0&&n.objNewButtonCustomAttr.FieldCollection.push(t)};n.objNewButtonCustomAttr.showAllControlChange=function(){n.objNewButtonCustomAttr.LoadAvailableFields()};n.objNewButtonCustomAttr.AddToGridClick=function(){n.objNewButtonCustomAttr.FieldCollection.length>0&&(n.objNewButtonCustomAttr.TraverseFieldCollection(n.objNewButtonCustomAttr.FieldCollection[0].Items),n.objNewButtonCustomAttr.ParameterCollection.length>0&&(n.objNewButtonCustomAttr.SelectedParameter=n.objNewButtonCustomAttr.ParameterCollection[n.objNewButtonCustomAttr.ParameterCollection.length-1]))};n.objNewButtonCustomAttr.onAddParameter=function(){n.objNewButtonCustomAttr.ParameterCollection.push({ParameterField:"",ParameterValue:""});n.objNewButtonCustomAttr.ParameterCollection.length>0&&(n.objNewButtonCustomAttr.SelectedParameter=n.objNewButtonCustomAttr.ParameterCollection[n.objNewButtonCustomAttr.ParameterCollection.length-1])};n.objNewButtonCustomAttr.onDeleteParameter=function(){if(n.objNewButtonCustomAttr.SelectedParameter){var t=n.objNewButtonCustomAttr.ParameterCollection.indexOf(n.objNewButtonCustomAttr.SelectedParameter);n.objNewButtonCustomAttr.ParameterCollection.splice(t,1);t<n.objNewButtonCustomAttr.ParameterCollection.length?n.SelectedParameter=n.objNewButtonCustomAttr.ParameterCollection[t]:n.objNewButtonCustomAttr.ParameterCollection.length>0?n.objNewButtonCustomAttr.SelectedParameter=n.objNewButtonCustomAttr.ParameterCollection[t-1]:n.objNewButtonCustomAttr.ParameterCollection.length==0&&(n.objNewButtonCustomAttr.SelectedParameter=undefined)}};n.objNewButtonCustomAttr.TraverseFieldCollection=function(t){angular.forEach(t,function(t){var r,e;if(t.IsSelected){var i=t.Text,u=!1,f=n.objNewButtonCustomAttr.ParameterCollection.filter(function(n){return n.ParameterValue==i});f&&f.length>0&&(u=!0);u?s.Message("Message",i+" Column is already added in Collection, please check."):(r=n.objNewButtonCustomAttr.GetCaptionFromFieldName(i),r=n.objNewButtonCustomAttr.RemoveInternalSpace(r),e={ParameterField:r,ParameterValue:i},n.objNewButtonCustomAttr.ParameterCollection.push(e));t.IsSelected=!1}t.Items.length>0&&n.objNewButtonCustomAttr.TraverseFieldCollection(t.Items)})};n.objNewButtonCustomAttr.RemoveInternalSpace=function(n){for(n=n.trim();n.indexOf(" ")>0;)n=n.substring(0,n.indexOf(" ")).trim()+n.substring(n.indexOf(" ")).trim();return n};n.objNewButtonCustomAttr.GetCaptionFromFieldName=function(n){var t,r,i,u,f;for(n.match("^icdo")&&(n=n.replace("icdo","")),t="",r=!0,i=0;i<n.length;i++)"._".contains(""+n[i])?(r=!0,t+=" "):(t+=r?n.toUpperCase()[i]:n[i],r=!1);return t.match(" Id$")&&(t=t.replace(" Id"," ID")),t.contains("Ssn")&&(t=t.replace("Ssn","SSN")),u=t.indexOf(" Value"),u>0&&(t=t.substring(0,u)),f=t.indexOf(" Description"),f>0&&(t=t.substring(0,f)),t};n.objNewButtonCustomAttr.GetSavedString=function(){var t="";return angular.forEach(n.objNewButtonCustomAttr.ParameterCollection,function(n){var r=n.ParameterField,i=n.ParameterValue,f,u;(i!=undefined&&i!=""||r!=undefined&&r!="")&&(f=n.Constants,f&&(i="#"+i),u=i,i.toLowerCase()!=r.toLowerCase()&&(u=r+"="+i),t==""?t=u:t+=";"+u)}),t};n.objNewButtonCustomAttr.OnBackClick=function(){var t=n.objNewButtonCustomAttr.GetSavedString();t!=undefined&&t!=""&&(n.sfxControl.dictAttributes.sfwUserLogParameters=t);n.objNewButtonCustomAttr.IsShowAllControlForUserParam=n.objNewButtonCustomAttr.IsShowAllControl;n.InitForCustomAttributes("sfwCustomAttributes")};n.objNewButtonCustomAttr.OnBackToGeneralPropClick=function(){var t=n.objNewButtonCustomAttr.GetSavedString();n.sfxControl.dictAttributes.sfwCustomAttributes=t;n.objNewButtonCustomAttr.IsShowAllControlForCustAttr=n.objNewButtonCustomAttr.IsShowAllControl};n.InitForGridControl=function(){n.objNewButtonFilterGrid.lstRelatedGrid=[];PopulateRelatedGrid(n.formodel,n.objNewButtonFilterGrid.lstRelatedGrid,!1)};n.objNewButtonFilterGrid.onQuerySearchClick=function(){n.IsFilterGridSearch=!0;n.QueryDialog=ngDialog.open({template:"Views/Form/BrowseForQuery.html",scope:n,closeByDocument:!1,className:"ngdialog-theme-default ngdialog-theme-custom"})};n.$on("onFilterGridSerchClick",function(t,i,r){i&&(n.objNewButtonFilterGrid.StrBaseQuery=r)});n.objNewButtonFilterGrid.PopulateQueryParam=function(t,i){var u=undefined,r,f;i&&(u=n.GetGridModel());angular.forEach(t,function(t){n.objNewButtonFilterGrid.lstQryField.push({CodeID:t.ID})});u&&(r=u.Elements.filter(function(n){return n.Name=="Parameters"}),r&&r.length>0&&(f=r[0],f.Elements.length>0&&angular.forEach(f.Elements,function(t){var i=n.objNewButtonFilterGrid.lstQryField.filter(function(n){return n.CodeID==t.dictAttributes.ID});i&&i.length>0&&(i[0].ParamValue=t.dictAttributes.sfwEntityField)})))};n.objNewButtonFilterGrid.onQueryChange=function(){var f,e,i,o,u,s;if(n.objNewButtonFilterGrid.lstQryField=[],n.objNewButtonFilterGridCriteria.AvailableFieldColletion=[],n.objFilterGridFieldsDetails.AvailableFieldColletion=[],n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection=[],n.objFilterGridFieldsDetails.lstResultFieldsForGrid=[],n.objNewButtonFilterGrid.StrBaseQuery){var h=n.objNewButtonFilterGrid.StrBaseQuery,c=r.getEntityIntellisense(),t=h.split(".");t&&t.length==2&&(f=t[0],e=t[1],n.entityName=t[0],i=c.filter(function(n){return n.ID==f}),i&&i.length>0&&(o=i[0],u=o.Queries.filter(function(n){return n.ID==e}),u&&u.length>0&&(s=u[0],n.objNewButtonFilterGrid.PopulateQueryParam(s.Parameters,!1))))}};n.objNewButtonFilterGrid.ValidateQuery=function(n,t){if(n){var i=n.Queries.filter(function(n){return n.ID==t});if(!i||i&&i.length==0)return this.ErrorMessageForDisplay="Invalid Base Query",!0}return!1};n.objNewButtonFilterGridCriteria.PopulateQueryFields=function(){angular.forEach(n.objNewButtonFilterGridCriteria.lstColumns,function(t){n.objNewButtonFilterGridCriteria.AvailableFieldColletion.length>0&&!n.objNewButtonFilterGridCriteria.AvailableFieldColletion.some(function(n){return n.ControlName==t.CodeID})&&n.objNewButtonFilterGridCriteria.AvailableFieldColletion.push({ControlName:t.CodeID,IsSelected:t.IsSelected,DataType:t.DataType});n.objNewButtonFilterGridCriteria.AvailableFieldColletion.length==0&&n.objNewButtonFilterGridCriteria.AvailableFieldColletion.push({ControlName:t.CodeID,IsSelected:t.IsSelected,DataType:t.DataType});n.objFilterGridFieldsDetails.AvailableFieldColletion=angular.copy(n.objNewButtonFilterGridCriteria.AvailableFieldColletion)})};n.objNewButtonFilterGrid.onRelatedGridChange=function(){var t=n.GetGridModel();t&&(n.objNewButtonFilterGrid.StrBaseQuery=t.dictAttributes.sfwBaseQuery,n.objNewButtonFilterGrid.onQueryChange(),n.objNewButtonFilterGrid.LoadQueryColumns(n.objNewButtonFilterGrid.StrBaseQuery,!1))};n.objNewButtonFilterGridCriteria.onMoveUpClick=function(){if(n.objNewButtonFilterGridCriteria.SelectedGridField){var t=n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection.indexOf(n.objNewButtonFilterGridCriteria.SelectedGridField),i=n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection[t-1];n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection[t-1]=n.objNewButtonFilterGridCriteria.SelectedGridField;n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection[t]=i;n.scrollBySelectedField("#filter-grid-result",".selected")}};n.objNewButtonFilterGridCriteria.CanMoveUp=function(){var t=!1,i;return n.objNewButtonFilterGridCriteria.SelectedGridField?(i=n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection.indexOf(n.objNewButtonFilterGridCriteria.SelectedGridField),i==0&&(t=!0)):t=!0,t};n.objNewButtonFilterGridCriteria.CanMoveDown=function(){var t=!1,i;return n.objNewButtonFilterGridCriteria.SelectedGridField?(i=n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection.indexOf(n.objNewButtonFilterGridCriteria.SelectedGridField),i==n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection.length-1&&(t=!0)):t=!0,t};n.objNewButtonFilterGridCriteria.onMoveDownClick=function(){if(n.objNewButtonFilterGridCriteria.SelectedGridField){var t=n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection.indexOf(n.objNewButtonFilterGridCriteria.SelectedGridField),i=n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection[t+1];n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection[t+1]=n.objNewButtonFilterGridCriteria.SelectedGridField;n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection[t]=i;n.scrollBySelectedField("#filter-grid-result",".selected")}};n.scrollBySelectedField=function(n,t){var i=$(n);if(i&&i.hasScrollBar())return i.scrollTo(i.find(t),{offsetTop:300,offsetLeft:0},null),!1};n.objNewButtonFilterGridCriteria.onDeleteControlClick=function(){if(n.objNewButtonFilterGridCriteria.SelectedGridField){var t=n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection.indexOf(n.objNewButtonFilterGridCriteria.SelectedGridField);n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection.splice(t,1);n.objNewButtonFilterGridCriteria.SelectedGridField=t<n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection.length?n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection[t]:n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection.length>0?n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection[t-1]:undefined}};n.objNewButtonFilterGridCriteria.addAvailableFields=function(){n.AddFieldsFromQuery(n.objNewButtonFilterGridCriteria.AvailableFieldColletion,n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection)};n.AddFieldsFromQuery=function(t,i){function f(t){var f,o,e;t.IsSelected&&t.IsSelected==!0&&(i&&!i.some(function(n){return n.ID==t.ControlName})&&(f={},f.ID=t.ControlName,u&&t.ControlName&&t.ControlName.indexOf("_value")>-1?(f.ControlClass="DropDownList",f.ControlName="ddl"+CreateControlIDInCamelCase(t.ControlName),e=FindControlByID(n.formodel,f.ControlName),e&&(f.ControlName=GetNewSeriesName(f.ControlName,n.formodel,1)),t.ControlName.indexOf("_value")>-1?(o=r.getEntityIntellisense(),f.CodeGroup=GetCodeIDByValue(u,t.ControlName,o)):f.CodeGroup="",f.Operator="="):(f.ControlClass="TextBox",f.ControlName="txt"+CreateControlIDInCamelCase(t.ControlName),e=FindControlByID(n.formodel,f.ControlName),e&&(f.ControlName=GetNewSeriesName(f.ControlName,n.formodel,1))),f.strDataType=t.DataType,t.DataType&&(t.DataType.toLowerCase()=="int"?f.strDataType="int":t.DataType.toLowerCase()=="string"&&(f.strDataType="string")),t&&t.Value&&(f.strHeaderText=t.Value.substring(t.Value.lastIndexOf(".")+1)),f.strHeaderText=GetCaptionFromField(f),f.IsVisible="True",f.strControlType="Label",f.strCaption=t.ControlName.Caption&&t.ControlName.Caption.trim().indexOf(":")==t.ControlName.Caption.trim().length-1?GetCaptionFromFieldName(t.ControlName):GetCaptionFromFieldName(t.ControlName)+" : ",i.push(f)),t.IsSelected=!1)}var u=n.objNewButtonFilterGrid.StrBaseQuery.split(".")[0];angular.forEach(t,f)};n.receiveCorrespondenceTemplateForForm=function(t){n.$apply(function(){n.objNewButtonOpenWordDoc.lstCorrTemplates=t;i.IsLoading=!1})};n.objNewButtonServerMethod.Init=function(){n.Title="Object Method :";n.objNewButtonServerMethod.sfwExecuteMethodType="ObjectMethod";n.showObjectMethod=!0;n.objNewButtonServerMethod.PopulateEntityXmlMethod();n.objNewButtonServerMethod.onRemoteObjectChanged()};n.objNewButtonServerMethod.onEntityChange=function(){n.objNewButtonServerMethod.lstXmlMethods=[];n.objNewButtonServerMethod.PopulateEntityXmlMethod()};n.objNewButtonServerMethod.PopulateEntityXmlMethod=function(){var t=GetObjectMethods(r.getEntityIntellisense(),n.formodel.dictAttributes.sfwEntity);n.objNewButtonServerMethod.lstXmlMethods=PopulateServerMethod(t,n.sfxControl,undefined)};n.objNewButtonServerMethod.onRemoteObjectChanged=function(){var t="srvCommon",i,u;n.formodel&&n.formodel.dictAttributes.sfwRemoteObject&&(t=n.formodel.dictAttributes.sfwRemoteObject);i=GetServerMethodObject(t,n.formodel.RemoteObjectCollection);u=GetObjectMethods(r.getEntityIntellisense(),n.formodel.dictAttributes.sfwEntity);n.objNewButtonServerMethod.lstXmlMethods=PopulateServerMethod(u,n.sfxControl,i)};n.objNewButtonActiveForm.OnNextClick=function(){n.objNewButtonActiveForm.ActiveFormType=="SingleForm"?n.sfxControl.dictAttributes.sfwActiveForm=n.objNewButtonActiveForm.StrActiveForm:(n.objNewButtonActiveForm.StrEntityField!=undefined&&n.objNewButtonActiveForm.StrEntityField!=""&&(n.sfxControl.dictAttributes.sfwEntityField=n.objNewButtonActiveForm.StrEntityField),n.objNewButtonActiveForm.UpdateActiveForms());n.objNewButtonNaviagtionParam.Init()};n.objNewButtonActiveForm.UpdateActiveForms=function(){var t="";n.objNewButtonNaviagtionParam.TargetForm="";angular.forEach(n.objNewButtonActiveForm.ActiveFormCollection,function(n){var i=n.FieldValue,r=n.ActiveForm,u;i!=undefined&&i!=""&&r!=undefined&&r!=""&&(u=i+"="+r,t==""?t=u:t+=";"+u)});n.sfxControl&&(n.sfxControl.dictAttributes.sfwActiveForm=t)};n.objNewButtonNaviagtionParam.OnNextClick=function(){n.objNewButtonNaviagtionParam.UpdateParameters();n.InitForCustomAttributes("sfwCustomAttributes")};n.objNewButtonNaviagtionParam.UpdateParameters=function(){var t="",i;angular.forEach(n.objNewButtonNaviagtionParam.ParameterCollection,function(n){var i,f,r,u;n.ParameterValue!=undefined&&n.ParameterValue!=""&&(i=n.ParameterValue,i!=""&&(f=n.Constants!=undefined?n.Constants:!1,f&&(i="#"+i),r=i,u=n.ParameterField,i.toLowerCase()!=u.toLowerCase()&&(r=u+"="+i),t==""?t=r:t+=";"+r))});n.sfxControl.dictAttributes.sfwMethodName=="btnNew_Click"?(i=n.sfxControl.dictAttributes.sfwActiveForm.contains("=")?n.sfxControl.dictAttributes.sfwRelatedControl:"",n.sfxControl.dictAttributes.sfwNavigationParameter=t==""?i:i?t+";"+i:t):n.sfxControl.dictAttributes.sfwNavigationParameter=n.sfxControl.dictAttributes.sfwActiveForm&&n.sfxControl.dictAttributes.sfwActiveForm.contains("=")?n.sfxControl.dictAttributes.sfwMethodName=="btnOpen_Click"?t==""?n.sfxControl.dictAttributes.sfwEntityField:t+";"+n.sfxControl.dictAttributes.sfwEntityField:t:t};n.objNewButtonGeneralProp.OnNextClick=function(){n.InitForCustomAttributes("sfwCustomAttributes")};n.objNewButtonCustomAttr.OnNextClick=function(){var t=n.objNewButtonCustomAttr.GetSavedString();n.sfxControl.dictAttributes.sfwCustomAttributes=t;n.objNewButtonCustomAttr.IsShowAllControlForCustAttr=n.objNewButtonCustomAttr.IsShowAllControl;n.InitForCustomAttributes("sfwUserLogParameters")};n.objNewButtonFilterGrid.OnNextClick=function(){if(n.objNewButtonFilterGrid.StrBaseQuery){if(n.objNewButtonFilterGrid.SelectGridOption=="UseExistingGrid"){var t=n.GetGridModel();t&&t.dictAttributes.sfwBaseQuery!=n.objNewButtonFilterGrid.StrBaseQuery&&(t.dictAttributes.sfwBaseQuery=n.objNewButtonFilterGrid.StrBaseQuery)}n.objNewButtonFilterGrid.LoadQueryColumns(n.objNewButtonFilterGrid.StrBaseQuery,!0);n.objNewButtonFilterGrid.SelectGridOption=="UseExistingGrid"&&n.objNewButtonFilterGrid.UpdateQueryParam();n.objNewButtonFilterGridCriteria.StrNoOfColumn="2"}};n.GetGridModel=function(){var t;return n.objMainTable=undefined,t=n.formodel.Elements.filter(function(n){return n.Name=="sfwTable"}),t&&t.length>0&&(n.objMainTable=t[0]),FindControlByID(n.objMainTable,n.sfxControl.dictAttributes.sfwRelatedControl)};n.objNewButtonFilterGrid.LoadQueryColumns=function(t,u){var f,s,e,a;if(t&&(f=t.split("."),f&&f.length==2)){var h=f[0],c=f[1],l=r.getEntityIntellisense(),o=l.filter(function(n){return n.ID==h});o&&o.length>0&&(s=o[0],e=s.Queries.filter(function(n){return n.ID==c}),e&&e.length>0&&(a=e[0],i.IsLoading=!0,u?$.connection.hubForm.server.getEntityQueryColumns(t,"").done(function(t){n.receiveGridBaseQueryColumns(t)}):$.connection.hubForm.server.getEntityQueryColumns(t,"CreateNewButton").done(function(t){n.receiveGridBaseQueryColumns(t)})))}};n.receiveGridBaseQueryColumns=function(t){n.$apply(function(){n.objNewButtonFilterGridCriteria.lstColumns=t;n.objNewButtonFilterGridCriteria.lstColumns.length>0&&n.objNewButtonFilterGridCriteria.PopulateQueryFields();i.IsLoading=!1})};n.objNewButtonFilterGrid.UpdateQueryParam=function(){var i,t,r;n.objNewButtonFilterGrid.lstQryField.length>0&&(i=n.GetGridModel(),i&&(t=i.Elements.filter(function(n){return n.Name=="Parameters"}),t&&t.length>0&&(r=i.Elements.indexOf(t[0]),i.Elements.splice(r,1)),t={Name:"Parameters",Value:"",dictAttributes:{},Elements:[],Children:[]},t.ParentVM=i,i.Elements.push(t),angular.forEach(n.objNewButtonFilterGrid.lstQryField,function(n){var i={Name:"parameter",Value:"",dictAttributes:{ID:n.CodeID,sfwEntityField:n.ParamValue},Elements:[],Children:[]};t.Elements.push(i)})))};n.objNewButtonOpenWordDoc.OnNextClick=function(){n.objNewButtonOpenWordDoc.SetNavigationParam()};n.objNewButtonOpenWordDoc.SetNavigationParam=function(){n.objNewButtonOpenWordDoc.TemplateName!=undefined&&n.objNewButtonOpenWordDoc.TemplateName!=""&&n.objNewButtonOpenWordDoc.TrackingID!=undefined&&n.objNewButtonOpenWordDoc.TrackingID!=""?n.sfxControl.dictAttributes.sfwNavigationParameter="TemplateName="+n.objNewButtonOpenWordDoc.TemplateName+";TrackingID="+n.objNewButtonOpenWordDoc.TrackingID:n.objNewButtonOpenWordDoc.TemplateName!=undefined&&n.objNewButtonOpenWordDoc.TemplateName!=""?n.sfxControl.dictAttributes.sfwNavigationParameter="TemplateName="+n.objNewButtonOpenWordDoc.TemplateName:n.objNewButtonOpenWordDoc.TrackingID!=undefined&&n.objNewButtonOpenWordDoc.TrackingID!=""&&(n.sfxControl.dictAttributes.sfwNavigationParameter="TrackingID="+n.objNewButtonOpenWordDoc.TrackingID)};n.objNewButtonServerMethod.OnNextClick=function(){(n.SelectedButtonDetails.Method=="btnExecuteServerMethod_Click"||n.SelectedButtonDetails.Method=="btnExecuteBusinessMethod_Click"||n.SelectedButtonDetails.Method=="btnValidateExecuteBusinessMethod_Click"||n.SelectedButtonDetails.Method=="btnDownload_Click"||n.SelectedButtonDetails.Method=="btnExecuteBusinessMethodSelectRows_Click"||n.SelectedButtonDetails.Method=="btnCompleteWorkflowActivities_Click")&&(n.SelectedButtonDetails.Method=="btnExecuteServerMethod_Click"||n.SelectedButtonDetails.Method=="btnDownload_Click",n.sfxControl.dictAttributes.sfwObjectMethod=n.objNewButtonServerMethod.StrServerMethod,n.objNewButtonServerMethod.sfwExecuteMethodType&&(n.sfxControl.dictAttributes.sfwExecuteMethodType=n.objNewButtonServerMethod.sfwExecuteMethodType),n.objNewButtonNaviagtionParam.Init())};n.OnFinishClick=function(){if(i.UndRedoBulkOp("Start"),n.objNewButtonFilterGrid.IsCriteriaRequired=="True"&&(n.sfxControl.dictAttributes.ID="GridSearchCriteriaReq_Click",n.sfxControl.dictAttributes.sfwMethodName="btnGridSearchCriteriaReq_Click",n.sfxControl.dictAttributes.Text="btnGridSearchCriteriaReq_Click"),n.SelectedButtonDetails.Method=="btnOpenPopupDialog_Click"||n.SelectedButtonDetails.Method=="btnNewPopupDialog_Click"||n.SelectedButtonDetails.Method=="btnFinishPopupDialog_Click"||n.SelectedButtonDetails.Method=="btnClosePopupDialog_Click")n.CreatePopupButton();else if(n.IsNewButtonStepDisable&&n.IsNewSaveStepsDisable&&n.IsOpenWordDocStepsDisable&&n.IsNewExecuteStepsDisable&&n.IsNewExecuteBusinessStepsDisable)n.IsNewGridStepDisable?n.IsNewFilterGridSearchCriteriaStepDisable?n.IsGeneralPropStepsDisable||n.sfxControl&&n.AddControlToCell("sfwButton",n.sfxCell,n.sfxControl):(n.sfxControl.dictAttributes.sfwObjectMethod=n.objNewButtonServerMethod.StrServerMethod,n.sfxControl&&n.AddControlToCell("sfwButton",n.sfxCell,n.sfxControl)):(n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection.length>0?n.objNewButtonFilterGridCriteria.AddControls(n.sfxCell,n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection):n.sfxControl&&n.AddControlToCell("sfwButton",n.sfxCell,n.sfxControl),n.objNewButtonFilterGridCriteria.SetNavigationParameter());else{var t=n.objNewButtonCustomAttr.GetSavedString();t&&(n.sfxControl.dictAttributes.sfwUserLogParameters=t);n.objNewButtonActiveForm.objRelatedGrid&&(n.sfxControl.IsChildOfGrid=!0);n.sfxControl&&n.AddControlToCell("sfwButton",n.sfxCell,n.sfxControl)}i.UndRedoBulkOp("End");n.CloseWizardClick()};n.objFilterGridFieldsDetails.Init=function(){n.objFilterGridFieldsDetails.LoadData()};n.objFilterGridFieldsDetails.moveSelectedRowUp=function(){if(n.objFilterGridFieldsDetails.SelectedCurrentResultGridRow){var t=n.objFilterGridFieldsDetails.lstResultFieldsForGrid.indexOf(n.objFilterGridFieldsDetails.SelectedCurrentResultGridRow),i=n.objFilterGridFieldsDetails.lstResultFieldsForGrid[t-1];n.objFilterGridFieldsDetails.lstResultFieldsForGrid[t-1]=n.objFilterGridFieldsDetails.SelectedCurrentResultGridRow;n.objFilterGridFieldsDetails.lstResultFieldsForGrid[t]=i;n.scrollBySelectedField(".lookup-result-grid",".selected")}};n.objFilterGridFieldsDetails.canmoveSelectedRowUp=function(){if(n.Flag=!0,n.objFilterGridFieldsDetails.SelectedCurrentResultGridRow)for(var t=0;t<n.objFilterGridFieldsDetails.lstResultFieldsForGrid.length;t++)n.objFilterGridFieldsDetails.lstResultFieldsForGrid[t]==n.objFilterGridFieldsDetails.SelectedCurrentResultGridRow&&t>0&&(n.Flag=!1);return n.Flag};n.scrollBySelectedField=function(n,t){h(function(){var i=$(n);if(i&&i.hasScrollBar())return i.scrollTo(i.find(t),{offsetTop:300,offsetLeft:0},null),!1})};n.objFilterGridFieldsDetails.moveSelectedRowDown=function(){if(n.objFilterGridFieldsDetails.SelectedCurrentResultGridRow){var t=n.objFilterGridFieldsDetails.lstResultFieldsForGrid.indexOf(n.objFilterGridFieldsDetails.SelectedCurrentResultGridRow),i=n.objFilterGridFieldsDetails.lstResultFieldsForGrid[t+1];n.objFilterGridFieldsDetails.lstResultFieldsForGrid[t+1]=n.objFilterGridFieldsDetails.SelectedCurrentResultGridRow;n.objFilterGridFieldsDetails.lstResultFieldsForGrid[t]=i;n.scrollBySelectedField(".lookup-result-grid",".selected")}};n.objFilterGridFieldsDetails.canmoveSelectedRowDown=function(){if(n.Flag=!0,n.objFilterGridFieldsDetails.SelectedCurrentResultGridRow)for(var t=0;t<n.objFilterGridFieldsDetails.lstResultFieldsForGrid.length;t++)n.objFilterGridFieldsDetails.lstResultFieldsForGrid[t]==n.objFilterGridFieldsDetails.SelectedCurrentResultGridRow&&t<n.objFilterGridFieldsDetails.lstResultFieldsForGrid.length-1&&(n.Flag=!1);return n.Flag};n.objFilterGridFieldsDetails.deleteSelectedRow=function(){var t=n.objFilterGridFieldsDetails.lstResultFieldsForGrid.indexOf(n.objFilterGridFieldsDetails.SelectedCurrentResultGridRow);t>=0&&(n.objFilterGridFieldsDetails.lstResultFieldsForGrid.splice(t,1),t<n.objFilterGridFieldsDetails.lstResultFieldsForGrid.length?n.objFilterGridFieldsDetails.SelectedCurrentResultGridRow=n.objFilterGridFieldsDetails.lstResultFieldsForGrid[t]:n.objFilterGridFieldsDetails.lstResultFieldsForGrid.length>0&&(n.objFilterGridFieldsDetails.SelectedCurrentResultGridRow=n.objFilterGridFieldsDetails.lstResultFieldsForGrid[t-1]));n.LoadSort()};n.objFilterGridFieldsDetails.canDeleteSelectedRow=function(){var t=!1;return n.objFilterGridFieldsDetails.SelectedCurrentResultGridRow||(t=!0),n.objFilterGridFieldsDetails.lstResultFieldsForGrid.length==0&&(t=!0),t};n.objFilterGridFieldsDetails.onFinishButtonWizardClick=function(){};n.objFilterGridFieldsDetails.LoadData=function(){n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection&&n.objFilterGridFieldsDetails.lstResultFieldsForGrid&&angular.forEach(n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection,function(t){if(n.objFilterGridFieldsDetails.lstResultFieldsForGrid&&!n.objFilterGridFieldsDetails.lstResultFieldsForGrid.some(function(n){return n.ID==t.ID})){var i={};i.ID=t.ID;i.strDataType=t.strDataType;t.DataType&&(t.strDataType.toLowerCase()=="int"?i.strDataType="int":t.strDataType.toLowerCase()=="string"&&(i.strDataType="string"));t&&t.Value&&(i.strHeaderText=t.Value.substring(t.Value.lastIndexOf(".")+1));i.strHeaderText=GetCaptionFromField(i);i.IsVisible="True";i.strControlType="Label";i.strCaption=t.ControlName.Caption&&t.ControlName.Caption.trim().indexOf(":")==t.ControlName.Caption.trim().length-1?GetCaptionFromFieldName(t.ControlName):GetCaptionFromFieldName(t.ControlName)+" : ";n.objFilterGridFieldsDetails.lstResultFieldsForGrid.push(i)}});n.LoadSort();n.LoadOrder()};n.LoadSort=function(){if(n.ArrSort=[],n.ArrSort.push(""),n.objFilterGridFieldsDetails.lstResultFieldsForGrid.length>0)for(var t=0;t<n.objFilterGridFieldsDetails.lstResultFieldsForGrid.length;t++)n.ArrSort.push(t+1)};n.LoadOrder=function(){n.ArrOrder=[];n.ArrOrder.push("");n.ArrOrder.push("asc");n.ArrOrder.push("desc")};n.objFilterGridFieldsDetails.addResultFields=function(){n.AddFieldsFromQuery(n.objFilterGridFieldsDetails.AvailableFieldColletion,n.objFilterGridFieldsDetails.lstResultFieldsForGrid);n.LoadSort()};n.objFilterGridFieldsDetails.SelectedResultGridRow=function(t){t&&(n.objFilterGridFieldsDetails.SelectedCurrentResultGridRow=t)};n.objFilterGridFieldsDetails.LoadGridDataForResultFields=function(t,i){function e(t){for(var r,f,e,s=!1,o=0;o<n.objFilterGridFieldsDetails.lstResultFieldsForGrid.length;o++)if(n.objFilterGridFieldsDetails.lstResultFieldsForGrid[o].strFieldName==t.EntityField){s=!0;break}s||(r={},f=t.FieldObject,r.strFieldName=t.EntityField,i?(f=t,r.strFieldName=t.ID):r.IsAddFromResultFieldScreen=!0,r.strDataType=f.DataType,f.DataType&&(f.DataType.toLowerCase()=="int"?r.strDataType="int":f.DataType.toLowerCase()=="string"&&(r.strDataType="string")),f&&f.Value&&(r.strHeaderText=f.Value.substring(f.Value.lastIndexOf(".")+1)),r.strHeaderText=GetCaptionFromField(f),r.strDataFormat=r.strDataType&&(r.strDataType.toLowerCase()=="datetime"||r.strDataType.toLowerCase()=="date")?"{0:d}":r.strDataType&&r.strDataType.toLowerCase()=="decimal"&&(f.Value.indexOf("_amt")>-1||f.Value.indexOf("_amount")>-1)?"{0:C}":f.Value.contains("ssn")?"{0:000-##-####}":f.Value.contains("phone")||f.Value.contains("fax")?"{0:(###)###-####}":"",r.IsVisible="True",r.strControlType="Label",u.length>0&&(e=u.filter(function(n){return n.ID.toLowerCase()==f.ID.toLowerCase()}),e&&e.length>0&&(r.strDataKey=e[0].KeyNo)),n.objFilterGridFieldsDetails.lstResultFieldsForGrid.some(function(n){return n.strFieldName==t.ID})||n.objFilterGridFieldsDetails.lstResultFieldsForGrid.push(r));i||n.objFilterGridFieldsDetails.preselectedfields.some(function(n){return n.ID==t.EntityField})||t.FieldObject&&(t.FieldObject.IsSelected="False")}n.objFilterGridFieldsDetails.lstResultFieldsForGrid||(n.objFilterGridFieldsDetails.lstResultFieldsForGrid=[]);var f=r.getEntityIntellisense(),u=getPrimarykey(f,n.entityName);t.length>0&&angular.forEach(t,e)};n.UpdateResultFields=function(t){function u(n){var f=n.ID,h=n.strDataType,e=n.strHeaderText,o=n.strControlType,s=n.strDataFormat,i,u;strVisible=f.substring(f.lastIndexOf(".")+1);strVisible=IsAuditField(strVisible)?"False":"True";i={Name:"TemplateField",prefix:"asp",Value:"",dictAttributes:{},Elements:[],Children:[]};i.dictAttributes.HeaderText=e;i.dictAttributes.Visible=strVisible;u={Name:"ItemTemplate",prefix:"asp",Value:"",dictAttributes:{},Elements:[],Children:[]};o&&(objControl={Name:"sfwLabel",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]});objControl.Name!="sfwLabel"&&objControl.Name!="sfwButton"&&objControl.Name!="sfwLinkButton"&&objControl.Name!="sfwImageButton"&&objControl.Name!=="sfwButtonGroup"&&(t.dictAttributes.AllowEditing="True",t.dictAttributes.sfwTwoWayBinding="True",t.dictAttributes.sfwCommonFilterBox="False",t.dictAttributes.sfwFilterOnKeyPress="False");objControl.dictAttributes.sfwEntityField=n.ID;objControl.dictAttributes.sfwDataFormat=s;n.IsVisible=="False"&&(objControl.dictAttributes.Visible=n.IsVisible);u.Elements.push(objControl);i.Elements.push(u);r.Elements.push(i)}var i,r;if(n.objFilterGridFieldsDetails.lstResultFieldsForGrid&&n.objFilterGridFieldsDetails.lstResultFieldsForGrid.length>0){for(i=0;i<t.Elements.length;i++)if(t.Elements[i].Name=="Columns"){t.Elements.splice(i,1);break}r={Name:"Columns",Value:"",dictAttributes:{},Elements:[],Children:[]};angular.forEach(n.objFilterGridFieldsDetails.lstResultFieldsForGrid,u);n.UpdateGridProperties(n.objFilterGridFieldsDetails.lstResultFieldsForGrid,t);t.Elements.push(r)}};n.objNewButtonFilterGridCriteria.SetNavigationParameter=function(){var t="";angular.forEach(n.objNewButtonFilterGridCriteria.GridNonAvailableControlCollection,function(n){t+=n.ControlName+";"});t.length>0&&t[t.length-1]==";"&&(t=t.substring(0,t.length-1));n.sfxControl.dictAttributes.sfwNavigationParameter=t};n.objNewButtonFilterGridCriteria.AddControls=function(t,r){var ct=n.formodel.dictAttributes.sfwType.toUpperCase()=="LOOKUP",c="",it,p,rt,h,w,ut,b,ft,et,u,k,a,d,s,g,st,f,ht,v,e,nt,tt,y;if(!ct||$sope.sfxCell.ParentVM.Name!="sfwTabSheet"||(c=$sope.sfxCell.ParentVM.dictAttributes.ID,c==undefined||c==""||c!="tshAdvSort"&&c!="tshSql")){it=0;p=1;p=r.length*2;rt=n.objNewButtonFilterGridCriteria.StrNoOfColumn;h=p/rt+it;h=Math.round(h);h<=0&&(h=1);w=GetVM("sfwColumn",t);w?(b=w.ParentVM,ft=b.ParentVM.Elements.indexOf(b),ut=ft):(et=tableVM.Elements.length,ut=et-1);var ot=[],l=0,o={Name:"sfwPanel",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]};for(o.ParentVM=n.sfxCell,o.dictAttributes.ID=CreateControlID(n.formodel,"NewPanel","sfwPanel"),u={Name:"sfwTable",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]},u.ParentVM=o,o.IsVisible=!0,o.initialvisibilty=!0,o.isLoaded=!0,k=1;k<=h;k++){for(a={Name:"sfwRow",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]},a.ParentVM=u,e=0;e<n.objNewButtonFilterGridCriteria.StrNoOfColumn;e++)d={Name:"sfwColumn",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]},d.ParentVM=a,i.PushItem(d,a.Elements);i.PushItem(a,u.Elements)}for(i.PushItem(u,o.Elements),i.PushItem(o,n.sfxCell.Elements),angular.forEach(u.Elements,function(n){n.Name=="sfwRow"&&angular.forEach(n.Elements,function(n){var t={};t.key=l;t.value=n;ot.push(t);l++})}),l=0,angular.forEach(r,function(t){var i=undefined;t.ControlClass&&t.ControlClass=="TextBox"?i="sfwTextBox":t.ControlClass&&t.ControlClass=="DropDownList"&&(i="sfwDropDownList");l=n.objNewButtonFilterGridCriteria.AddControlsGrid(ot,i,t,l)}),s={Name:"sfwRow",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]},s.ParentVM=u,e=0;e<n.objNewButtonFilterGridCriteria.StrNoOfColumn;e++)g={Name:"sfwColumn",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]},g.ParentVM=s,i.PushItem(g,s.Elements);if(s.Elements.length>0&&(st=n.objNewButtonFilterGridCriteria.StrNoOfColumn-1,i.PushItem(n.sfxControl,s.Elements[st].Elements),i.PushItem(s,u.Elements)),n.objNewButtonFilterGrid.SelectGridOption=="CreateNewGrid"){for(f={Name:"sfwGridView",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]},ht=CreateControlID(n.formodel,"grvGridView","sfwGridView"),f.dictAttributes.ID=ht,f.dictAttributes.AllowPaging="True",f.dictAttributes.AllowSorting="True",f.dictAttributes.sfwSelection="Many",f.dictAttributes.sfwBaseQuery=n.objNewButtonFilterGrid.StrBaseQuery,f.dictAttributes.sfwBoundToQuery="True",f.dictAttributes.sfwQueryLoadType="Solution",n.sfxControl.dictAttributes.sfwRelatedControl=f.dictAttributes.ID,n.UpdateResultFields(f),v={Name:"sfwRow",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]},v.ParentVM=u,e=0;e<n.objNewButtonFilterGridCriteria.StrNoOfColumn;e++)nt={Name:"sfwColumn",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]},nt.ParentVM=v,i.PushItem(nt,v.Elements);i.PushItem(v,u.Elements);u.Elements.length>0&&(tt=u.Elements[u.Elements.length-1],tt.Elements.length>0&&(y=tt.Elements.filter(function(n){return n.Name=="sfwColumn"}),y&&y[0]&&(i.PushItem(f,y[0].Elements),n.objNewButtonFilterGrid.UpdateQueryParam())))}}};n.objNewButtonFilterGridCriteria.AddControlsGrid=function(t,u,f,e){var s,o,c,a,l,h,v,y;return s=t[e].value,e++,o={Name:"sfwLabel",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]},o.ParentVM=s,c=f.ControlName,(f.ControlName.match("^txt")||f.ControlName.match("^ddl"))&&(c=f.ControlName.substring(3)),a=CreateControlID(n.formodel,c,"sfwLabel",!0),o.dictAttributes.ID=a,o.dictAttributes.Text=GetCaptionFromFieldName(f.ID)+" : ",o.dictAttributes.AssociatedControlID=f.ControlName,o.dictAttributes.sfwIsCaption="True",i.PushItem(o,s.Elements),s=t[e].value,e++,o={Name:u,Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]},o.ParentVM=s,o.dictAttributes.ID=f.ControlName,o.dictAttributes.sfwDataField=f.ID,o.IsShowDataField=!0,u=="sfwDropDownList"&&f.ID.match("_value$")&&(l=n.GetGridModel(),l&&(h=l.dictAttributes.sfwBaseQuery,h&&(h=h.substring(0,h.indexOf("."))),v=r.getEntityIntellisense(),y=GetCodeID(h,f.strCaption,v),o.dictAttributes.sfwLoadType="CodeGroup",o.dictAttributes.sfwLoadSource=y)),i.PushItem(o,s.Elements),e};n.CreatePopupButton=function(){var t=n.sfxControl.Name+"."+n.SelectedButtonDetails.Method;n.objNewButtonDialogForGrid.SelectGridOption=="CreateNewGrid"?(n.UpdateGridPropertiesForPopUp(n.objGridField.FieldCollection,n.objGridView),n.UpdateGridFields(n.objGridField.FieldCollection),n.AddButtonOpenDialog(!0,t)):n.objNewButtonDialogForGrid.SelectGridOption=="UseExistingGrid"&&n.AddButtonOpenDialog(!1,t)};n.AddButtonOpenDialog=function(t,i){var u,f,s=FindParent(n.sfxCell,"sfwTable"),e,r=s.Elements.filter(function(n){return n.Name=="sfwRow"}),h,o;if(r&&r.length>0&&(e=r[r.length-1]),t){if(e&&(u=undefined,r=e.Elements.filter(function(n){return n.Name=="sfwColumn"}),r&&r.length>0&&(u=r[0]),u!=null))if(strRelatedControl=n.CrateGridForOpenDialogVM(u),strRelatedControl!=undefined&&strRelatedControl!="")if(n.AddControlToCell(i,n.sfxCell),f=n.sfxCell.Elements[n.sfxCell.Elements.length-1],f!=null)f.dictAttributes.sfwRelatedControl=strRelatedControl;else return;else return}else if(n.AddControlToCell(i,n.sfxCell),f=n.sfxCell.Elements[n.sfxCell.Elements.length-1],f)f.dictAttributes.sfwRelatedControl=n.objNewButtonDialogForGrid.SelectGrid;else return;r=s.Elements.filter(function(n){return n.Name=="sfwRow"});r&&r.length>0&&(e=r[r.length-1]);e!=null&&(r=e.Elements.filter(function(n){return n.Name=="sfwColumn"}),r&&r.length>0&&(u=r[0]));n.OnInsertRowBelowClick(u,s);r=s.Elements.filter(function(n){return n.Name=="sfwRow"});r&&r.length>0&&(h=r[r.length-1]);h&&(r=h.Elements.filter(function(n){return n.Name=="sfwColumn"}),r&&r.length>0&&(u=r[0]),u&&(o=n.objNewButtonDialogForGrid.SelectDialogPanel,n.objNewButtonDialogForGrid.SelectDialogPanelOption=="CreateNewDialogPanel"&&(o=n.AddDialogVM(n.objNewButtonDialogForGrid.SelectDialogPanel,u)),o!=undefined&&o!=""&&(f.dictAttributes.sfwRelatedDialogPanel=o)))};n.AddControlToCell=function(t,r,u){if(u||(u=CreateControl(n.formodel,r,t)),u&&(i.PushItem(u,r.Elements),SetFormSelectedControl(n.formodel,u)),n.objNewButtonFilterGrid.SelectGridOption=="CreateNewGrid"){var f={Name:"sfwGridView",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]},e=CreateControlID(n.formodel,"grvGridView","sfwGridView");f.dictAttributes.ID=e;f.dictAttributes.AllowPaging="True";f.dictAttributes.AllowSorting="True";f.dictAttributes.sfwSelection="Many";f.dictAttributes.sfwBoundToQuery="True";f.dictAttributes.sfwBaseQuery=n.objNewButtonFilterGrid.StrBaseQuery;n.sfxControl.dictAttributes.sfwRelatedControl=f.dictAttributes.ID;n.UpdateResultFields(f);i.PushItem(f,r.Elements);n.objNewButtonFilterGrid.UpdateQueryParam()}};n.CrateGridForOpenDialogVM=function(t){var l="",o=n.objCreateNewGrid.SelectedEntityField,f,u,r,h,e,c;if(o)if(o.DataType=="Collection"||o.DataType=="CDOCollection"||o.DataType=="List"){if(t&&(f=FindParent(t,"sfwTable"),f)){if(u={Name:"sfwRow",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]},u.ParentVM=f,r={Name:"sfwColumn",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]},r.ParentVM=u,i.PushItem(n.objGridView,r.Elements),n.objGridView.ParentVM=r,l=n.objGridView.dictAttributes.ID,i.PushItem(r,u.Elements),e=f.Elements.filter(function(n){return n.Name=="sfwRow"}),e&&e.length>0&&(h=e[e.length-1]),h)for(c=1;c<h.Elements.length;c++)r={Name:"sfwColumn",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]},r.ParentVM=u,i.PushItem(r,u.Elements);i.PushItem(u,f.Elements)}}else s.Message("Message","A valid collection needs to be selected for the grid.");return l};n.OnInsertRowBelowClick=function(t,i){var r=i.Elements.indexOf(t.ParentVM);n.InsertRow(t,!0,r,i)};n.InsertRow=function(n,t,r,u){var e,f,h,o,s,c;if(n){for(e="swc",f={Name:"sfwRow",value:"",prefix:e,dictAttributes:{},Elements:[],Children:[]},f.ParentVM=u,h=GetMaxColCount(n.ParentVM,u),o=0;o<h;o++)s={Name:"sfwColumn",value:"",prefix:e,dictAttributes:{},Elements:[],Children:[]},s.ParentVM=f,f.Elements.push(s);c=t?r+1:r;i.InsertItem(f,u.Elements,c)}};n.AddDialogVM=function(t,i){var u="",r;return n.AddControlToCell("DialogPanel",i),r=i.Elements[i.Elements.length-1],t!=undefined&&t!=""&&(r.dictAttributes.ID=t),r&&(u=r.dictAttributes.ID),u};n.UpdateGridPropertiesForPopUp=function(n,t){var f,i="",e,r="",u,o,s;n!=null&&n.length>0&&angular.forEach(n,function(n){f=n.istrKey;f!=undefined&&f!=""&&(i.length==0?i=f+";"+n.istrPropertyName:i+=","+f+";"+n.istrPropertyName);e=n.istrSort;e!=undefined&&e!=""&&(r.length==0?r=e+";"+n.istrPropertyName+" "+n.istrOrder:r+=","+e+";"+n.istrPropertyName+" "+n.istrOrder)});u={};o=i.split(",");angular.forEach(o,function(n){var t=n.substring(n.indexOf(";")+1).trim();u[n]=t});i="";angular.forEach(u,function(n){i.length==0?i=n:i+=","+n});t.dictAttributes.sfwDataKeyNames=i;u={};s=r.split(",");angular.forEach(s,function(n){var t=n.substring(n.indexOf(";")+1).trim();u[n]=t});r="";angular.forEach(u,function(n){r.length==0?r=n:r+=","+n});t.dictAttributes.sfwSortExpression=r};n.UpdateGridProperties=function(n,t){var f,i="",e,r="",u,o,s;n!=null&&n.length>0&&angular.forEach(n,function(n){f=n.istrKey;f!=undefined&&f!=""&&(i.length==0?i=f+";"+n.ID:i+=","+f+";"+n.ID);e=n.strSort;e&&(r.length==0?r=e+";"+n.ID+" "+n.strOrder:r+=","+e+";"+n.ID+" "+n.strOrder)});u={};o=i.split(",");angular.forEach(o,function(n){var t=n.substring(n.indexOf(";")+1).trim();u[n]=t});i="";angular.forEach(u,function(n){i.length==0?i=n:i+=","+n});t.dictAttributes.sfwDataKeyNames=i;u={};s=r.split(",");angular.forEach(s,function(n){var t=n.substring(n.indexOf(";")+1).trim();u[n]=t});r="";angular.forEach(u,function(n){r.length==0?r=n:r+=","+n});t.dictAttributes.sfwSortExpression=r};n.UpdateGridFields=function(t){if(n.objGridView.Elements=[],t&&t.length>0){var u,f={Name:"Columns",Value:"",dictAttributes:{},Elements:[],Children:[]};f.ParentVM=n.objGridView;angular.forEach(t,function(t){var s=t.istrDataType,h="",e,c,o;s=="Decimal"&&(h="Right");objTemp={Name:"TemplateField",Value:"",prefix:"asp",dictAttributes:{},Elements:[],Children:[]};objTemp.ParentVM=f;objTemp.dictAttributes.Visible=t.istrVisible;objTemp.dictAttributes.HeaderText=t.istrHeader;objTemp.dictAttributes["ItemStyle.HorizontalAlign"]=h;e={Name:"ItemTemplate",Value:"",prefix:"asp",dictAttributes:{},Elements:[],Children:[]};e.ParentVM=objTemp;switch(t.istrControlType){case"HyperLink":u={Name:"sfwLabel",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]};u.ParentVM=e;u.dictAttributes.sfwLinkable="True";u.dictAttributes.sfwRelatedControl="btnOpen";break;case"TextBox":u={Name:"sfwTextBox",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]};u.ParentVM=e;s=="DateTime"&&(u.dictAttributes.sfwDataType=s);break;case"DropDownList":u={Name:"sfwDropDownList",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]};u.ParentVM=e;endsWith(t.istrObjectID,"_value")&&(c=r.getEntityIntellisense(),o=GetCodeID(n.objCreateNewGrid.SelectedEntityField.Entity,t.istrItemPath,c),o.length==0&&(o="0"),o!=undefined&&o!=""&&(u.dictAttributes.sfwLoadType="CodeGroup"));break;case"Checkbox":u={Name:"sfwCheckBox",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]};u.ParentVM=e;break;default:u={Name:"sfwLabel",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]};u.ParentVM=e}u.dictAttributes.sfwEntityField=t.istrItemPath;objTemp.dictAttributes.sfwSortExpression=u.dictAttributes.sfwEntityField;u.dictAttributes.sfwDataFormat=t.istrFormat;u.dictAttributes.sfwRelatedControl=t.istrRelatedControl;u.Name!="sfwLabel"&&u.Name!="sfwButton"&&u.Name!="sfwLinkButton"&&u.Name!="sfwImageButton"&&u.Name!=="sfwButtonGroup"&&(n.objGridView.dictAttributes.AllowEditing="True",n.objGridView.dictAttributes.sfwTwoWayBinding="True",n.objGridView.dictAttributes.sfwCommonFilterBox="False",n.objGridView.dictAttributes.sfwFilterOnKeyPress="False");i.PushItem(u,e.Elements);i.PushItem(e,objTemp.Elements);i.PushItem(objTemp,f.Elements)});i.PushItem(f,n.objGridView.Elements)}};n.onNextForNewGridCreation=function(){n.objFilterGridFieldsDetails.Init()};n.onFinishButtonWizardClick=function(){n.$emit("AddButtonCancel",{})};n.Init();n.setTitle=function(t){n.$parent.title&&(n.$parent.title=t,n.$parent.ButtonWizardDialog.updateTitle(n.$parent.title))};n.validateId=function(t){n.currentFileScope?u.validateID(t,n.currentFileScope.validationErrorList,t.dictAttributes.ID):(n.currentFileScope=n.getFileScope(),u.validateID(t,n.currentFileScope.validationErrorList,t.dictAttributes.ID))};n.validateDuplicateId=function(t){n.currentFileScope?u.checkDuplicateId(t,n.currentFileScope.formTableModel,n.currentFileScope.validationErrorList,!1,f.FORM.NODES):(n.currentFileScope=n.getFileScope(),u.checkDuplicateId(t,n.currentFileScope.formTableModel,n.currentFileScope.validationErrorList,!1,f.FORM.NODES))};n.isAnyErrors=function(){return u.isEmptyObj(n.sfxControl.errors)};n.getFileScope=function(){if(i.currentopenfile&&i.currentopenfile.file){var n=getScopeByFileName(i.currentopenfile.file.FileName);return n?n:undefined}};n.onChangeOfSelectGridOption=function(){n.sfxControl.dictAttributes.sfwRelatedControl="";n.objNewButtonFilterGrid.StrBaseQuery="";n.objNewButtonFilterGrid.lstQryField=[]};n.OnChangeOfGridOption=function(){n.objNewButtonDialogForGrid.SelectGrid=""}}]);app.controller("BrowseForQueryController",["$scope","$rootScope","ngDialog","share","ParameterFactory","$EntityIntellisenseFactory","$filter","$timeout",function(n,t,i,r,u,f,e,o){n.sharedata=r;n.blnShowAllFilesForBrowse=!1;n.Init=function(){function h(t){n.lstEntity.push(t)}function c(t){var i=n.selectedCurrentQuery.Parameters.filter(function(n){return n.ID==t.ID});i.length>0&&(i[0].Value=t.Value?t.Value:"")}var u,i,o,s,r,e;if(n.lstEntity=[],u=f.getEntityIntellisense(),i=getScopeByFileName("createNewObject"),i&&i.objNewItems&&i.objNewItems.SelectedOption==="File"?n.strPath=i.objFileDetails.Path:i&&i.objFormsDetails&&i.objFormsDetails.Path?n.strPath=i.objFormsDetails.Path:i&&i.objFormLinkDetails&&i.objFormLinkDetails.Path?n.strPath=i.objFormLinkDetails.Path:i&&i.objReportDetails&&i.objReportDetails.Path?n.strPath=i.objReportDetails.Path:!i&&t.currentopenfile&&(o=t.currentopenfile.file.FilePath.split("\\"),n.strPath=o[o.length-2]),n.strPath?(s=u.filter(function(t){var i=[],r;if(t.FilePath)return i=t.FilePath.split("\\"),r=i[i.length-2],n.strPath==r}),angular.forEach(s,h)):n.lstEntity=u,n.subQueryType?angular.forEach(u,function(t){t.Queries.length>0&&angular.forEach(t.Queries,function(t){t.IsVisible=!1;t.QueryType==n.subQueryType&&(t.IsVisible=!0)})}):angular.forEach(u,function(n){n.Queries.length>0&&angular.forEach(n.Queries,function(n){n.QueryType!="SubSelectQuery"&&(n.IsVisible=!0)})}),n.strSelectedQuery!=undefined&&n.strSelectedQuery!=""&&(r=n.strSelectedQuery.split("."),r&&r.length==2)){var l=r[0],a=r[1],r=n.lstEntity.filter(function(n){return n.ID==l});r&&r.length>0&&(n.selectedCurrentEntity=r[0],n.ScrollToCurrentEntity(),n.queryCount=n.selectedCurrentEntity.Queries.length,e=n.selectedCurrentEntity.Queries.filter(function(n){return n.ID==a}),e&&e.length>0&&(n.selectedCurrentQuery=e[0],n.queryParameters&&n.queryParameters.length>0&&angular.forEach(n.queryParameters,c),n.ScrollToCurrentQuery()))}};n.ScrollToCurrentEntity=function(){var i,t;n.selectedCurrentEntity&&(i=document.getElementById(n.selectedCurrentEntity.ID),i?i.scrollIntoView():t=setInterval(function(){var i=document.getElementById(n.selectedCurrentEntity.ID);i&&(i.scrollIntoView(),t&&clearInterval(t));setTimeout(function(){t&&clearInterval(t)},5e3)},100))};n.ScrollToCurrentQuery=function(){var i,t;n.selectedCurrentQuery&&(i=document.getElementById(n.selectedCurrentEntity.ID+"_"+n.selectedCurrentQuery.ID),i?i.scrollIntoView():t=setInterval(function(){var i=document.getElementById(n.selectedCurrentEntity.ID+"_"+n.selectedCurrentQuery.ID);i&&(i.scrollIntoView(),t&&clearInterval(t));setTimeout(function(){t&&clearInterval(t)},5e3)},100))};n.ShowAllFilesForBrowseClick=function(i){var r=f.getEntityIntellisense();setTimeout(function(){n.$evalAsync(function(){var u,f,e;i?n.lstEntity=r:(u=getScopeByFileName("createNewObject"),u&&u.objNewItems&&u.objNewItems.SelectedOption==="File"?n.strPath=u.objFileDetails.Path:u&&u.objFormsDetails&&u.objFormsDetails.Path?n.strPath=u.objFormsDetails.Path:u&&u.objReportDetails&&u.objReportDetails.Path?n.strPath=u.objReportDetails.Path:!u&&t.currentopenfile&&(f=t.currentopenfile.file.FilePath.split("\\"),n.strPath=f[f.length-2]),n.strPath&&(n.lstEntity=[],n.selectedCurrentEntity={},n.selectedCurrentQuery={},e=r.filter(function(t){var i=[],r;if(t.FilePath)return i=t.FilePath.split("\\"),r=i[i.length-2],n.strPath==r}),angular.forEach(e,function(t){n.lstEntity.push(t)})))})},5)};n.selectedEntityClick=function(t,i){var r;n.queryCount=0;n.selectedCurrentEntity=t;n.subQueryType?(r=n.selectedCurrentEntity.Queries.filter(function(t){return t.QueryType==n.subQueryType}),r&&r.length>0&&(n.queryCount=r.length)):(r=n.selectedCurrentEntity.Queries.filter(function(n){return n.QueryType!="SubSelectQuery"}),r&&r.length>0&&(n.queryCount=r.length));i&&n.ScrollToCurrentEntity()};n.selectedQueryClick=function(t,i){n.selectedCurrentQuery=t;i&&n.ScrollToCurrentQuery()};n.selectedParameterClick=function(t){n.selectedCurrentParameter=t};var s={UPARROW:38,DOWNARROW:40};n.$on("arrowpress",function(t,i){var r;i.code==s.UPARROW?(r=n.lstEntity.indexOf(n.selectedCurrentEntity),r>0&&n.selectedEntityClick(n.lstEntity[r-1])):i.code==s.DOWNARROW&&(r=n.lstEntity.indexOf(n.selectedCurrentEntity),r<n.lstEntity.length-1&&n.selectedEntityClick(n.lstEntity[r+1]));n.$apply();o(function(){var t;n.isSet(1)?t=$("#divBrowse").find(".selected"):n.isSet(2)&&(t=$("#divTable").find(".selected"));n.isSet(1)&&t.length>0&&$("#divBrowse > .col-xs-12 > .browse-for-query-form > .col-xs-6 > .browse-query-panel > .form-group > #divBrowseEntity").scrollTop($(t[0]).offset().top-$("#divBrowse > .col-xs-12 > .browse-for-query-form > .col-xs-6 > .browse-query-panel > .form-group > #divBrowseEntity").offset().top+$("#divBrowse > .col-xs-12 > .browse-for-query-form > .col-xs-6 > .browse-query-panel > .form-group > #divBrowseEntity").scrollTop()-10)},300)});n.getTableList=function(t){if(n.lstEntityQuery=[],n.selectedTableRow=undefined,n.selectedCurrentQuery=undefined,t){var i=f.getEntityIntellisense();n.lstEntityQuery=e("entitybyTable")(i,t,n.subQueryType)}};n.selectTableClick=function(t){t&&(n.selectedCurrentQuery=t)};n.selectedTableParametersClick=function(t,i){i&&(n.selectedTableParametersRow=t,n.selectedCurrentTableParametersRow=i)};n.closeClick=function(){n.QueryDialog.close()};n.okClick=function(){var t,i;n.tab==1&&n.selectedCurrentEntity&&n.selectedCurrentEntity.ID?t=n.selectedCurrentEntity.ID+"."+n.selectedCurrentQuery.ID:n.selectedCurrentQuery&&n.selectedCurrentQuery.ID&&(t=n.selectedCurrentQuery.ID);n.IsBPM?(i={Id:t,Parameters:n.selectedCurrentQuery.Parameters},n.$emit("onQueryClickBPM",i)):n.IsRetrieval?n.$emit("onRetrievalClick",t):n.IsAutoComplete?n.$emit("onAutoCompleteClick",t):n.IsForm?n.$emit("onFormQueryClick",t):n.IsFilterGridSearch?n.$emit("onFilterGridSerchClick",n.selectedCurrentQuery,t):n.IsBaseQuery?n.$emit("onBaseQueryClick",t):(n.$emit("onQueryClick",t),n.sharedata.selectedCurrentQuery=n.selectedCurrentQuery,n.sharedata.isNewQuerySelected=!0);o(function(){n.validateQuery&&n.validateQuery()});n.QueryDialog.close()};n.ValidateDataAll=function(){return n.ErrorMessageForDisplay="",n.tab==1?n.selectedCurrentQuery==undefined?(n.ErrorMessageForDisplay="Error: A appropriate Query needs to be selected.",!0):n.selectedCurrentQuery.SqlQuery==undefined||n.selectedCurrentQuery.SqlQuery==""?(n.ErrorMessageForDisplay="Error: Selected Query Should Not be blank. ",!0):!1:n.selectedCurrentQuery==undefined?(n.ErrorMessageForDisplay="Error: A appropriate Query needs to be selected.",!0):!1};n.clearTab=function(){n.selectedCurrentQuery=undefined;n.selectedCurrentEntity=undefined;n.EntityName="";n.QueryID="";n.TableName=undefined;n.lstEntityQuery=[];n.selectedTableRow=undefined};n.tab=1;n.setTab=function(t){n.tab=t;n.clearTab()};n.isSet=function(t){return n.tab===t};n.Init()}]);app.factory("ParameterFactory",[function(){var n={selectedCurrentQuery:{},isNewQuerySelected:!1};return{getParameterObject:function(){return n},setParameterObject:function(t,i){n.selectedCurrentQuery=t;n.isNewQuerySelected=i},clearParameterFactory:function(){n.selectedCurrentQuery={};n.isNewQuerySelected={}}}}]);app.directive("keyScroll",[function(){return function(n,t){t.bind("keydown",function(t){(t.keyCode==38||t.keyCode==40)&&n.$emit("arrowpress",{code:t.keyCode})})}}]);app.controller("ValidationRulesController",["$scope","$rootScope","$timeout","$ValidationService",function(n,t,i,r){function f(n){n.IsSelected&&(u+=n.Name+";")}function e(n,t){for(var i=n.ParentVM;i&&i.Name!=t;)i=i.ParentVM;return i}n.HardErrorList=[];n.SoftErrorList=[];n.IsChildOfWizardStep=!1;n.Init=function(){var t="",i=e(n.model,"sfwWizardStep"),r;i&&(n.IsChildOfWizardStep=!0,t=i.dictAttributes.sfwRulesGroup);r=n.model.dictAttributes.sfwValidationRules;n.LoadRules(t,r)};n.LoadRules=function(t,i){var r;n.IsChildOfWizardStep&&n.entityID?hubMain.server.getEntityExtraData(n.entityID).done(function(u){u?n.$evalAsync(function(){r=GetBuisnessRules(u,"","",t,n.IsChildOfWizardStep);angular.forEach(r,function(t){t!=undefined&&t!=""&&n.HardErrorList.push({Name:t,IsSelected:!1})});n.selectExistingRules(i)}):n.HardErrorList=[]}):n.entityID&&hubMain.server.getEntityExtraData(n.entityID).done(function(t){t&&t.lstHardErrorList?n.$evalAsync(function(){var r=t.lstHardErrorList[0];r&&r.Elements.length>0&&(angular.forEach(r.Elements,function(t){t!=undefined&&t.dictAttributes.ID!=""&&n.HardErrorList.push({Name:t.dictAttributes.ID,IsSelected:!1})}),n.selectExistingRules(i))}):n.HardErrorList=[]})};n.selectExistingRules=function(t){var u,i,r;if(t!=undefined&&t!="")for(u=t.split(";"),i=0;i<u.length;i++)r=n.HardErrorList.filter(function(n){return n.Name==u[i]}),r&&r.length>0&&(r[0].IsSelected=!0)};var u="";n.onSaveClick=function(){angular.forEach(n.HardErrorList,f);angular.forEach(n.SoftErrorList,f);u!=undefined&&u!=""&&(u=u.substring(0,u.lastIndexOf(";")));n.model.dictAttributes.sfwValidationRules=u;i(function(){var t=[];n.HardErrorList&&(t=r.getListByPropertyName(n.HardErrorList,"Name"));n.validateValidationRules&&n.validateValidationRules(t)});n.onCancelClick()};n.onCancelClick=function(){n.dialogValidation.close()};n.Init()}]);app.controller("ActiveFormsController",["$scope","$rootScope","$filter","ngDialog","$EntityIntellisenseFactory","$timeout","$GetEntityFieldObjectService",function(n,t,i,r,u,f,e){var s,h,o,c,l,a,v;if(n.lstEntityField=[],n.lstrEntityField="",n.isDropDown=!1,n.IsHtxForm=!1,s=n.formmodel.dictAttributes.sfwType=="Lookup",h=n.formmodel.dictAttributes.sfwType=="FormLinkLookup",n.strParent="",n.model.dictAttributes&&n.model.dictAttributes.sfwEntityField&&(n.lstrEntityField=n.model.dictAttributes.sfwEntityField),n.model.dictAttributes.sfwMethodName=="btnNew_Click"||n.model.dictAttributes.sfwMethodName=="btnNewUpdate_Click"?n.strParent=s||h?"tblCriteria panel fields":"Form fields":n.model.dictAttributes.sfwMethodName=="btnOpen_Click"&&(o=n.model.dictAttributes.sfwRelatedControl,c=FindParent(n.model,"sfwGridView"),c&&c.dictAttributes&&(o=c.dictAttributes.ID),n.strParent=o==""||o==undefined?"Grid fields":o+" fields"),n.InitializeActiveForms=function(t,i,r,u){var s,e,f,o;if(n.lstEntityField=[],ilAvlFlds=r,n.model.dictAttributes.sfwMethodName=="btnNew_Click"||n.model.dictAttributes.sfwMethodName=="btnNewUpdate_Click")GetObjectFields(n.formmodel,n.lstEntityField,n.model);else if(n.model.dictAttributes.sfwMethodName!="btnDelete_Click"&&n.model.dictAttributes.sfwMethodName=="btnOpen_Click"&&(s="(Object Fields are populated from the "+u+".)",n.lstEntityField.push(""),r.length>0))for(e=0;e<r.length;e++)f=r[e],o="",o=f.indexOf("~")>-1?f.substring(0,f.indexOf("~")):f,n.lstEntityField.some(function(n){return n==o})||n.lstEntityField.push(o)},n.alControls=[],PopulateControlsForActiveForm(n.alControls,n.formmodel,n.model,s||h),n.InitializeActiveForms(n.model.dictAttributes.sfwActiveForm,n.lstrEntityField,n.alControls,n.strParent),n.checkAndGetCodeValues=function(){var r="",t,f,p,v,o,y;if(n.isDropDown=!1,n.model.dictAttributes.sfwMethodName=="btnNew_Click")n.model.dictAttributes.sfwRelatedControl!=undefined&&n.model.dictAttributes.sfwRelatedControl!=""&&(t=FindControlByID(n.formmodel,n.model.dictAttributes.sfwRelatedControl),t&&t.dictAttributes&&t.dictAttributes.sfwLoadType=="CodeGroup"&&(t.dictAttributes.sfwLoadSource!=undefined&&t.dictAttributes.sfwLoadSource!=""?(n.isDropDown=!0,n.CurrentCodeID=t.dictAttributes.sfwLoadSource):t.placeHolder&&(n.isDropDown=!0,n.CurrentCodeID=t.placeHolder)));else if(f=u.getEntityIntellisense(),!(n.model.dictAttributes.sfwRelatedControl||n.model.IsChildOfGrid)||s||h)o=i("filter")(f,{ID:n.formmodel.dictAttributes.sfwEntity},!0),o&&o.length>0&&o[0].Attributes.length>0&&n.lstrEntityField&&(y=i("filter")(o[0].Attributes,{ID:n.lstrEntityField},!0),y.length>0&&(r=y[0].Value)),r.lastIndexOf("_value")==r.length-6?(n.isDropDown=!0,n.CurrentCodeID=GetCodeID(n.formmodel.dictAttributes.sfwEntity,n.lstrEntityField,f)):n.isDropDown=!1;else if(p=i("filter")(f,{ID:n.formmodel.dictAttributes.sfwEntity},!0),p){var c=[],w=n.model.dictAttributes.sfwRelatedControl,a=FindParent(n.model,"sfwGridView");if(a&&a.dictAttributes&&(w=a.dictAttributes.ID),GetGridObject("sfwGridView",n.formmodel,w,c),c.length>0&&c[0].dictAttributes.sfwEntityField){var k=c[0].dictAttributes.sfwEntityField,b=e.GetEntityFieldObjectFromEntityField(n.formmodel.dictAttributes.sfwEntity,k),l="";b&&(l=b.Entity);l&&n.lstrEntityField&&(v=e.GetEntityFieldObjectFromEntityField(l,n.lstrEntityField),r="",v&&(r=v.Value),r&&r.lastIndexOf("_value")==r.length-6?(n.isDropDown=!0,n.CurrentCodeID=GetCodeID(l,n.lstrEntityField,f)):n.isDropDown=!1)}}},n.checkAndGetCodeValues(),n.lstActiveForm=[],n.model.dictAttributes.sfwActiveForm&&n.model.dictAttributes.sfwActiveForm.contains("=")&&(l=n.model.dictAttributes.sfwActiveForm.split(";"),l))for(a=0;a<l.length;a++)v=l[a].split("="),n.lstActiveForm.push({FieldValue:v[0],ActiveForm:v[1]});n.AddActiveForm=function(){n.lstActiveForm.push({FieldValue:"",ActiveForm:""});n.checkAndGetCodeValues()};n.DeleteActiveForm=function(){if(n.selectedActiveForm&&n.selectedActiveForm!=""){var t=n.lstActiveForm.indexOf(n.selectedActiveForm);t>-1?n.lstActiveForm.splice(t,1):n.selectedActiveForm=undefined}};n.selectActiveFormRow=function(t){n.selectedActiveForm=t};n.OkClick=function(){var r="",i;if(t.UndRedoBulkOp("Start"),t.EditPropertyValue(n.model.dictAttributes.sfwEntityField,n.model.dictAttributes,"sfwEntityField",n.lstrEntityField),n.lstActiveForm.length>0){for(i=0;i<n.lstActiveForm.length;i++)n.lstActiveForm[i].FieldValue!=""&&n.lstActiveForm[i].ActiveForm!=""&&(r==""?r=n.lstActiveForm[i].FieldValue+"="+n.lstActiveForm[i].ActiveForm:r+=";"+n.lstActiveForm[i].FieldValue+"="+n.lstActiveForm[i].ActiveForm);t.EditPropertyValue(n.model.dictAttributes.sfwActiveForm,n.model.dictAttributes,"sfwActiveForm",r)}else t.EditPropertyValue(n.model.dictAttributes.sfwActiveForm,n.model.dictAttributes,"sfwActiveForm","");t.UndRedoBulkOp("End");f(function(){n.validateActiveForm&&n.validateActiveForm()});n.ActiveFormDialog.close()};n.CancelClick=function(){n.ActiveFormDialog.close()};n.validateActiveForms=function(){var r,t,i;if(n.ErrorMessageForDisplay="",n.lstActiveForm.length==0)return n.ErrorMessageForDisplay="Atleast one active form has to be added.",!0;if(n.lstActiveForm.length>0){for(r=0,t=0;t<n.lstActiveForm.length;t++){if(i=n.lstActiveForm[t],i.FieldValue=="ACTV"&&r++,!i.FieldValue)return n.ErrorMessageForDisplay="Please enter field value of row number "+(t+1),!0;if(!i.ActiveForm)return n.ErrorMessageForDisplay="Please enter active form value of row number "+(t+1),!0}return r>1?(n.ErrorMessageForDisplay="Cannot add multiple active forms with same field value - ACTV",!0):!1}return!1};n.clearActiveFormList=function(){n.lstActiveForm=[]}}]);app.controller("SearchActiveFormController",["$scope","$rootScope","$filter","ngDialog","$timeout",function(n,t,i,r,u){n.ID="";n.Title="";n.Location="";n.IsShowSearch=!1;n.ActiveFormCount=50;$.connection.hubForm.server.getFormList().done(function(t){function i(t){n.AddInList(t)}n.filelist=JSON.parse(t);n.lstActiveForms=[];angular.forEach(n.filelist,i)});n.filterForms=function(n){return n.FileType=="Lookup"||n.FileType=="Maintenance"||n.FileType=="Wizard"};n.lstActiveForms=i("filter")(n.filelist,n.filterForms,!0);n.filterActiveForm=function(t){return t.FileName.contains(n.ID)};n.selectActiveFormRow=function(t){n.selectedForm=t};n.OkClick=function(){n.selectedForm&&n.selectedForm!=""?n.isupdatefromexternalprop?n.$emit("onSearchActiveFormOkClick",n.selectedForm.FileName):n.model&&(n.model.dictAttributes?n.model.dictAttributes.sfwActiveForm=n.selectedForm.FileName:(n.model.ActiveForm=n.selectedForm.FileName,n.model.StrActiveForm=n.selectedForm.FileName)):n.isupdatefromexternalprop||n.model&&(n.model.dictAttributes?n.model.dictAttributes.sfwActiveForm=undefined:(n.model.ActiveForm=undefined,n.model.StrActiveForm=undefined));u(function(){n.validateActiveForm&&n.validateActiveForm()});n.onCancelClick()};n.onCancelClick=function(){n.SearchActiveFormDialog.close()};n.onSearch=function(){n.IsShowSearch||(n.IsShowSearch=!0)};n.AddInList=function(t){var i={FileName:t.FileID,Location:t.Location};n.selectFormType&&n.selectFormType.length>0&&n.selectFormType.indexOf(t.FileType)>-1&&n.lstActiveForms.push(i)};n.OnActiveFormScroll=function(){n.ActiveFormCount<n.lstActiveForms.length&&(n.ActiveFormCount+10<n.lstActiveForms.length?n.$evalAsync(function(){n.ActiveFormCount=n.ActiveFormCount+10}):n.$evalAsync(function(){n.ActiveFormCount=n.lstActiveForms.length}))}}]);app.controller("RetrievalButtonParameterController",["$scope","$rootScope","$filter","ngDialog",function(n,t){var i,u,o,e,f,r,s;if(n.ShowAll={},n.ShowAll.isShowAll=!1,n.$parent.formmodel&&n.$parent.formmodel.dictAttributes&&(n.sourceForm=n.$parent.formmodel.dictAttributes.ID),n.targetFormModel&&n.targetFormModel.dictAttributes.sfwType=="Lookup"?(n.targetForm=n.targetFormModel.dictAttributes.ID,i=GetCriteriaPanel(n.targetFormModel)):n.targetFormModel&&n.targetFormModel.dictAttributes.sfwType=="FormLinkLookup"&&(n.targetForm=n.targetFormModel.dictAttributes.ID,i=n.targetFormModel.Elements.filter(function(n){return n.Name=="items"}),i&&i.length>0&&(i=i[0])),n.lstTargetFields=[],i&&GetRetrievalTargetControls(i,n.lstTargetFields),n.lstSourceFields=[],u=[],u=n.isFormLink&&n.isFormLink==!0?GetVM("items",n.model):n.$parent.formmodel&&n.$parent.formmodel.dictAttributes&&n.$parent.formmodel.dictAttributes.sfwType=="Wizard"?GetVM("sfwWizardStep",n.model):n.$parent.formmodel&&n.$parent.formmodel.dictAttributes&&(n.$parent.formmodel.dictAttributes.sfwType=="Report"||n.$parent.formmodel.dictAttributes.sfwType=="Correspondence"||n.$parent.formmodel.dictAttributes.sfwType=="UserControl")?GetVM("sfwTable",n.model):GetVM("sfwPanel",n.model),u&&GetRetrievalSourceControls(u,n.lstSourceFields),n.ShowAllControls=function(){n.lstSourceFields=[];n.ShowAll.isShowAll?GetRetrievalSourceControls(n.formmodel,n.lstSourceFields):GetRetrievalSourceControls(u,n.lstSourceFields)},n.model.dictAttributes.sfwRetrievalParameters&&n.model.dictAttributes.sfwRetrievalParameters!="")for(o=n.model.dictAttributes.sfwRetrievalParameters.split(";"),e=0;e<o.length;e++)for(f=o[e].split("="),r=0;r<n.lstTargetFields.length;r++)n.lstTargetFields[r].ID==f[0]&&(f[1].contains("#")?(s=f[1].replace("#",""),n.lstTargetFields[r].isConstant=!0,n.lstTargetFields[r].sourceControl=s):n.lstTargetFields[r].sourceControl=f[1]);n.okClick=function(){for(var r="",i=0;i<n.lstTargetFields.length;i++)n.lstTargetFields[i].sourceControl&&n.lstTargetFields[i].sourceControl!=""&&(r==""?r=n.lstTargetFields[i].isConstant?n.lstTargetFields[i].ID+"=#"+n.lstTargetFields[i].sourceControl:n.lstTargetFields[i].ID+"="+n.lstTargetFields[i].sourceControl:r+=n.lstTargetFields[i].isConstant?";"+n.lstTargetFields[i].ID+"=#"+n.lstTargetFields[i].sourceControl:";"+n.lstTargetFields[i].ID+"="+n.lstTargetFields[i].sourceControl);t.EditPropertyValue(n.model.dictAttributes.sfwRetrievalParameters,n.model.dictAttributes,"sfwRetrievalParameters",r);n.RetrievalcloseClick()};n.RetrievalcloseClick=function(){n.RetrievalButtonParaDialog.close()};n.selectControlID=function(t){n.selectedControlID=t};n.ExpandCollapsedControl=function(n){n.IsExpanded=!n.IsExpanded}}]);app.controller("ObjectTreeDragDropController",["$scope","$http","$rootScope","$GetEntityFieldObjectService","$ValidationService","$EntityIntellisenseFactory","$SgMessagesService",function(n,t,i,r,u,f,e){var l,o,c,a,h,s;for(n.lstControls=[],n.lstValidControls=[],l=n.dragdropdata,n.$evalAsync(function(){}),o=0;o<n.model.Elements.length;o++)c=n.model.Elements[o].dictAttributes,s="",s=c.sfwDataField?c.sfwDataField:c.sfwEntityField,a=!1,i.lstWebControls&&i.lstWebControls.length>0&&(h=i.lstWebControls.filter(function(t){return t.ControlName==n.model.Elements[o].Name}),h=JSON.parse(JSON.stringify(h)),h&&h.length>0&&(a=CanAddControlToDropList(h[0],n.formmodel,n.model.Elements[o]))),a&&["Collection","List","Object","CDOCollection"].indexOf(n.dragdropdata.Type)==-1&&n.lstControls.push({Controltype:n.model.Elements[o].Name,ID:c.ID,Name:s,Index:o,IsExistingControl:!0});s="";s=n.currentControl.dictAttributes.sfwDataField?n.currentControl.dictAttributes.sfwDataField:n.currentControl.dictAttributes.sfwEntityField;n.lstControls.push({Controltype:n.currentControl.Name,ID:n.currentControl.dictAttributes.ID,Name:s,Index:"New Control"});n.selectedControl=n.lstControls[n.lstControls.length-1];n.selectRow=function(t){n.selectedControl=t};n.IsChildOfGrid=function(){var i=!1,t=FindParent(n.model,"sfwGridView");return t||(t=FindParent(n.model,"sfwDialogPanel"),t||(t=FindParent(n.model,"sfwListView"))),t&&(i=!0),i};n.showControlbasedOnType=function(t){n.IsGridSeleected=n.IsChildOfGrid();var i=!1;["Collection","List","Object","CDOCollection"].indexOf(t.Type)>-1&&(FindParent(n.model,"sfwListView")||FindParent(n.model,"sfwDialogPanel"))&&(i=!0);n.formmodel&&n.formmodel.dictAttributes&&n.formmodel.dictAttributes.sfwType&&t&&(["Lookup","Tooltip"].indexOf(n.formmodel.dictAttributes.sfwType)===-1&&!n.formmodel.IsLookupCriteriaEnabled&&["Collection","Object","List","CDOCollection"].indexOf(t.Type)===-1&&t.DataType?n.lstValidControls.push("sfwLabel"):n.formmodel.dictAttributes.sfwType!=="Tooltip"||n.formmodel.IsLookupCriteriaEnabled||["Collection","Object","List","CDOCollection"].indexOf(t.Type)!==-1||n.lstValidControls.push("sfwLabel"),n.formmodel.dictAttributes.sfwType!=="Tooltip"&&["Collection","Object","CDOCollection","List",].indexOf(t.Type)===-1&&t.DataType&&n.lstValidControls.push("sfwTextBox","sfwDropDownList","sfwMultiSelectDropDownList","sfwCheckBox","sfwRadioButtonList"),n.formmodel.dictAttributes.sfwType!=="Tooltip"&&!n.IsGridSeleected&&["Collection","Object","CDOCollection","List",].indexOf(t.Type)===-1&&t.DataType&&n.lstValidControls.push("sfwCascadingDropDownList"),["Tooltip","Lookup"].indexOf(n.formmodel.dictAttributes.sfwType)===-1&&["Collection","Object","CDOCollection","List",].indexOf(t.Type)===-1&&t.DataType&&n.lstValidControls.push("sfwRadioButton"),!n.IsGridSeleected&&n.formmodel.dictAttributes.sfwType!=="Tooltip"&&["CDOCollection"].indexOf(t.Type)>-1&&n.lstValidControls.push("sfwCheckBoxList"),!n.IsGridSeleected&&n.formmodel.dictAttributes.sfwType!=="Lookup"&&["Collection","List"].indexOf(t.Type)>-1&&!i&&n.lstValidControls.push("sfwGridView","sfwChart"),!n.IsGridSeleected&&["Lookup","UserControl","Tooltip"].indexOf(n.formmodel.dictAttributes.sfwType)===-1&&["Object"].indexOf(t.Type)>-1&&!i&&n.lstValidControls.push("UserControl"),!n.IsGridSeleected&&["Lookup"].indexOf(n.formmodel.dictAttributes.sfwType)>-1&&t.DataType&&["DateTime","Int","Decimal","Double"].indexOf(t.DataType)>-1&&!i&&n.lstValidControls.push("sfwRange"),["Tooltip"].indexOf(n.formmodel.dictAttributes.sfwType)===-1&&t.DataType&&["DateTime","datetime"].indexOf(t.DataType)>-1&&n.lstValidControls.push("sfwDateTimePicker"),!n.IsGridSeleected&&["Maintenance","Wizard"].indexOf(n.formmodel.dictAttributes.sfwType)>-1&&["Collection","List"].indexOf(t.Type)>-1&&n.lstValidControls.push("sfwCalendar","sfwScheduler"),["Maintenance","Wizard"].indexOf(n.formmodel.dictAttributes.sfwType)>-1&&!n.IsGridSeleected&&["Collection","List"].indexOf(t.Type)>-1&&!i&&n.lstValidControls.push("sfwListView"),["Maintenance","Wizard","UserControl",].indexOf(n.formmodel.dictAttributes.sfwType)>-1&&["String","string"].indexOf(t.DataType)>-1&&n.lstValidControls.push("sfwJSONData"))};l&&(n.showControlbasedOnType(l),n.lstControls&&n.lstControls.length>0&&n.lstValidControls&&n.lstValidControls.length>0&&(n.lstControls[n.lstControls.length-1].Controltype=n.lstValidControls[0],n.lstControls[n.lstControls.length-1].ID=CreateControlID(n.formmodel,n.fieldName,n.lstControls[n.lstControls.length-1].Controltype,!1)));n.setControlIDByControlType=function(){var t=n.selectedControl.Controltype;t==="UserControl"&&(t="udc");n.selectedControl.ID=CreateControlID(n.formmodel,n.fieldName,t,!1)};n.addUserControl=function(){var t,u;n.selectedControl&&(t=n.$new(),n.currentControl.Name="udc",n.currentControl.dictAttributes.ID=n.selectedControl.ID,t.objSetUCProp={StrId:n.currentControl.dictAttributes.ID,StrName:"",StrEntityField:n.selectedControl.Name,StrResource:"",formObject:n.formmodel},t.formodel=n.formmodel,t.onUserControlOkClick=function(){if(n.currentControl.dictAttributes.ID=t.objSetUCProp.StrId,n.currentControl.dictAttributes.Name=t.objSetUCProp.StrName,t.objSetUCProp.StrEntityField&&(n.currentControl.dictAttributes.sfwEntityField=t.objSetUCProp.StrEntityField),n.currentControl.dictAttributes.sfwResource=t.objSetUCProp.StrResource,n.currentControl.dictAttributes.Name!==undefined&&n.currentControl.dictAttributes.Name!=""){var r=[],u={FileName:n.currentControl.dictAttributes.Name,ID:n.currentControl.dictAttributes.ID};r.push(u);$.connection.hubForm.server.getUserControlModel(r,"").done(function(n){t.receiveUcMainTable(n);t.onUserControlCancelClick()})}i.PushItem(n.currentControl,n.model.Elements)},t.onUserControlCancelClick=function(){u&&u.close();n.closeClick()},t.receiveUcMainTable=function(i){var r,u;for(t.tableTemp,r=0;r<n.formmodel.Elements.length;r++)if(n.formmodel.Elements[r].Name=="sfwTable"){t.tableTemp=n.formmodel.Elements[r];break}for(r=0;r<i.length;r++)u=FindControlByID(t.tableTemp,i[r].ID),u&&n.$apply(function(){u.UcChild=i?[i[r].udcModel]:[];setParentControlName(u.UcChild[0])})},t.ValidateUserProp=function(){var i=!1,u,f;return t.ErrorMessageForDisplay="",t.objSetUCProp.StrId==undefined||t.objSetUCProp.StrId==""?(t.ErrorMessageForDisplay="Error: Enter the ID.",i=!0):(u=[],CheckforDuplicateID(n.formmodel,t.objSetUCProp.StrId,u),u.length>0?(t.ErrorMessageForDisplay="Error: Duplicate ID.",i=!0):isValidIdentifier(t.objSetUCProp.StrId,!1,!1)||(t.ErrorMessageForDisplay="Error: Invalid ID.",i=!0)),t.objSetUCProp.StrName&&t.objSetUCProp.StrName!=""?t.objSetUCProp.StrResource&&t.objSetUCProp.StrResource!=""||(t.ErrorMessageForDisplay="Please Enter Resource.",i=!0):(t.ErrorMessageForDisplay="Please Enter Active Form.",i=!0),(t.ErrorMessageForDisplay==undefined||t.ErrorMessageForDisplay=="")&&t.objSetUCProp.StrEntityField!=undefined&&t.objSetUCProp.StrEntityField!=""&&(f=r.GetEntityFieldObjectFromEntityField(n.formmodel.dictAttributes.sfwEntity,t.objSetUCProp.StrEntityField),f&&f.Type=="Object"||(t.ErrorMessageForDisplay="Entity Field should be Object.",i=!0)),i},u=i.showDialog(t,"User Control","Form/views/SetUserControlProperties.html"))};n.addGridControl=function(){var t=n.$new(),r;t.objGridView={Name:"sfwGridView",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]};t.objGridView.LstDisplayedEntities=[];t.objGridView.lstselectedmultiplelevelfield=[];t.objGridView.selectedentityobjecttreefields=[];t.cellVM=n.model;t.selectedEntityField=n.dragdropdata;t.FormModel=n.formmodel;t.ParentEntityName=n.dragdropdata.Entity;n.formmodel.dictAttributes.sfwType=="Tooltip"&&(t.skipSecondStep=!0);t.IsAddToExistingCell=!0;r=n.formmodel.Elements.filter(function(n){return n.Name=="sfwTable"});r&&r.length>0&&(t.SfxMainTable=r[0]);t.title="Create New Grid";t.LstDisplayedEntities=[];n.formmodel.dictAttributes.sfwType=="Tooltip"&&(t.skipSecondStep=!0);t.IsPrototype=t.FormModel&&t.FormModel.dictAttributes.ID.startsWith("wfp")?!0:!1;t.objGridDialog=i.showDialog(t,t.title,"Form/views/CreateGridViewControl.html",{width:1e3,height:700})};n.addChartControl=function(){var u,t,r;n.ParentEntityName=n.dragdropdata.Entity;u=n.model;null!=u&&(t=n.$new(),t.ObjChartModel={Name:"sfwChart",prefix:"swc",Value:"",dictAttributes:{ID:"",sfwEntityField:n.selectedControl.Name,ChartType:"",Width:"",Height:"",ShowLegend:"True"},Elements:[],Children:[]},t.ObjChartModel.lstselectedobjecttreefields=[],t.ObjChartModel.selectedobjecttreefield,t.lstChartType=i.ChartTypes,t.lstToolTipTypes=["None","Chart","Table","Both"],t.DataFormats=["","{0:d}","{0:C}","{0:000-##-####}","{0:(###)###-####}"],t.SeriesModel={Name:"Series",prefix:"",Value:"",dictAttributes:{},Elements:[],Children:[]},t.SeriesModel.ParentVM=t.ObjChartModel,t.ObjChartModel.Elements.push(t.SeriesModel),r={Name:"ChartAreas",prefix:"",Value:"",dictAttributes:{},Elements:[],Children:[]},r.ParentVM=t.ObjChartModel,t.ObjChartModel.Elements.push(r),t.sfwChartAreaModel={Name:"sfwChartArea",prefix:"swc",Value:"",dictAttributes:{ChartAreaName:"",BackColor:""},Elements:[],Children:[]},t.sfwChartAreaModel.ParentVM=r,r.Elements.push(t.sfwChartAreaModel),t.Area3DStyle={Name:"Area3DStyle",prefix:"",Value:"",dictAttributes:{IsEnable3D:"false",Inclination:"",LightStyle:""},Elements:[],Children:[]},t.Area3DStyle.ParentVM=t.sfwChartAreaModel,t.sfwChartAreaModel.Elements.push(t.Area3DStyle),t.onSfxChartFinishClick=function(){t.UpdateNavigationParam();t.ObjChartModel&&t.ObjChartModel.dictAttributes&&(t.ObjChartModel.dictAttributes.ID.match("^chr")||(t.ObjChartModel.dictAttributes.ID="chr"+t.ObjChartModel.dictAttributes.ID));i.PushItem(t.ObjChartModel,n.model.Elements);SetFormSelectedControl(n.formmodel,t.ObjChartModel,event);t.onSfxChartCancelClick();n.closeClick()},t.UpdateNavigationParam=function(){function i(t){var i=t.ParmeterValue,f,r,u;i!=null&&i!=""&&(f=t.ParmeterConstant,f&&(i="#"+i),r=i,u=t.ParmeterField,i.toLowerCase()!=u.toLowerCase()&&(r=u+"="+i),n==""?n=r:n+=";"+r)}function r(t){n="";angular.forEach(t.FormParameters,i);t.dictAttributes.sfwNavigationParameter=n}var n="";angular.forEach(t.SeriesModel.Elements,r)},t.onSfxChartCancelClick=function(){t.CreateChartDialog&&t.CreateChartDialog.close()},t.isChartNextDisable=function(){var n=!1;return t.ObjChartModel.ErrorMessageForDisplay="",t.ObjChartModel.ValidateChartName()?t.ObjChartModel.ValidateEntityCollection()?t.ObjChartModel.ValidateChartType()?t.ObjChartModel.ValidateWidth()?t.ObjChartModel.ValidateHeight()||(n=!0):n=!0:n=!0:n=!0:n=!0,n},t.ObjChartModel.ValidateChartName=function(){var n=!0;return t.ObjChartModel.dictAttributes.ID||(t.ObjChartModel.ErrorMessageForDisplay="Error: Please enter ID.",n=!1),n},t.ObjChartModel.ValidateEntityCollection=function(){var n=!0;return t.ObjChartModel.dictAttributes.sfwEntityField||(t.ObjChartModel.ErrorMessageForDisplay="Error: Please enter a Entity.",n=!1),n},t.ObjChartModel.ValidateChartType=function(){var n=!0;return t.ObjChartModel.dictAttributes.ChartType||(t.ObjChartModel.ErrorMessageForDisplay="Error: Please Select a ChartType.",n=!1),n},t.ObjChartModel.ValidateWidth=function(){var n=!0;return t.ObjChartModel.dictAttributes.Width||(t.ObjChartModel.ErrorMessageForDisplay="Error: Please enter a Width.",n=!1),n},t.ObjChartModel.ValidateHeight=function(){var n=!0;return t.ObjChartModel.dictAttributes.Height||(t.ObjChartModel.ErrorMessageForDisplay="Error: Please enter a Height.",n=!1),n},t.ShowSeriesDetail=function(n){n.ShowDetails=!n.ShowDetails},t.SelectSeries=function(n){t.ObjSeriesModel&&t.ObjSeriesModel!=n&&t.ObjSeriesModel.ShowDetails&&(t.ObjSeriesModel.ShowDetails=!1);t.ObjSeriesModel=n},t.GetSeriesID=function(){for(var i="Series",r=0,n=i,u=t.SeriesModel.Elements.filter(function(t){return t.dictAttributes.Name==n});u.length>0;)r++,n=i+r,u=t.SeriesModel.Elements.filter(function(t){return t.dictAttributes.Name==n});return n},t.OnAddSeriesClick=function(){var r=t.$new(),u;r.ObjSeriesModel={Name:"sfwSeries",prefix:"swc",Value:"",dictAttributes:{Name:"",XValueMember:"",YValueMembers:"",YMemberColor:"",IsValueShownAsLabel:"False",sfwFormatField:"",sfwTooltipType:"",sfwTooltipTableParams:"",sfwActiveForm:""},Elements:[],Children:[]};r.ObjSeriesModel.dictAttributes.Name=t.GetSeriesID();r.ObjSeriesModel.ParentVM=t.SeriesModel;r.ObjSeriesModel.lstselectedobjecttreefields=[];r.ObjSeriesModel.selectedobjecttreefield;r.ObjSeriesModel.ShowDetails=!0;r.ObjSeriesModel.FormParameters=[];r.ShowParameters=!1;n.receiveFormParameters=function(n){n&&r.$evalAsync(function(){r.ObjSeriesModel.FormParameters=n;r.ShowParameters=!0})};r.ClearParamtersForform=function(){r.ObjSeriesModel&&r.ObjSeriesModel.FormParameters&&(r.ObjSeriesModel.FormParameters="");r.ObjSeriesModel&&r.ObjSeriesModel.dictAttributes.sfwActiveForm!=""&&(r.seriesactiveform=!0);r.ShowParameters=!1};r.isChartFinishDisable=function(){var n=!1;return r.ErrorMessageForDisplay="",r.ObjSeriesModel&&(r.ValidateSeriesName()?r.ValidateXValue()?r.ValidateYValue()||(n=!0):n=!0:n=!0),n};r.ValidateSeriesName=function(){var n=!0;return r.ObjSeriesModel.dictAttributes.Name||(r.ErrorMessageForDisplay="Error: Please enter a Series Name.",n=!1),n};r.ValidateXValue=function(){var n=!0;return r.ObjSeriesModel.dictAttributes.XValueMember||(r.ErrorMessageForDisplay="Error: Please enter a Series XValueMember.",n=!1),n};r.ValidateYValue=function(){var n=!0;return r.ObjSeriesModel.dictAttributes.YValueMembers||(r.ErrorMessageForDisplay="Error: Please enter a Series YValueMembers.",n=!1),n};r.ValidateYValue=function(){var n=!0;return r.ObjSeriesModel.dictAttributes.YValueMembers||(r.ErrorMessageForDisplay="Error: Please enter a Series YValueMembers.",n=!1),n};r.OpenTooltipParams=function(){t.OpenTooltipParams(r)};r.onAdditionalChartColumnClick=function(){t.onAdditionalChartColumnClick(r)};r.onCancelClick=function(){u&&u.close()};r.OnOkClick=function(){r.ObjSeriesModel.dictAttributes.ChartType=t.ObjChartModel.dictAttributes.ChartType;t.SeriesModel.Elements.push(r.ObjSeriesModel);u&&u.close()};u=i.showDialog(r,"Add Series","Form/views/AddEditSeries.html",{width:600,height:600})},t.OpenTooltipParams=function(n){var r=n.$new();t.objTooltipParamsVM=i.showDialog(r,"Set Tooltip Parameters","Form/views/SetToolTipParameters.html",{width:500,height:420});r.onSfxChartTooltipTableCancelClick=function(){t.objTooltipParamsVM&&t.objTooltipParamsVM.close()};r.onSfxChartTooltipTableOKClick=function(){function e(n){var i=n.ID;f&&(i=f+"."+i);t=t?t+";"+i:i}var i=[],u,f,t;i=GetSelectedFieldList(n.ObjSeriesModel.lstselectedobjecttreefields,i);u=getDisplayedEntity(n.ObjSeriesModel.LstDisplayedEntities);f="";u&&u.strDisplayName!=""&&(f=u.strDisplayName);i.length>0&&(angular.forEach(i,e),n.ObjSeriesModel.dictAttributes.sfwTooltipTableParams=t);r.onSfxChartTooltipTableCancelClick()}},t.OnRemoveSeriesClick=function(){if(t.ObjSeriesModel){var n=t.SeriesModel.Elements.indexOf(t.ObjSeriesModel);t.SeriesModel.Elements.splice(n,1);n<t.SeriesModel.Elements.length?t.SelectSeries(t.SeriesModel.Elements[n]):t.SeriesModel.Elements.length>0?t.SelectSeries(t.SeriesModel.Elements[n-1]):t.ObjSeriesModel=undefined}},t.OnEditSeries=function(r){var u=t.$new(),f;u.ObjSeriesModel=r;u.ObjSeriesModel.ParentVM=undefined;u.ShowParameters=u.ObjSeriesModel.FormParameters&&u.ObjSeriesModel.FormParameters.length>0?!0:!1;u.seriesactiveform=!0;n.receiveFormParameters=function(n){n&&u.$evalAsync(function(){function i(n){var i=t.filter(function(t){return n.ParmeterField==t.ParmeterField});i&&i.length>0&&(n.ParmeterValue=i[0].ParmeterValue,n.ParmeterConstant=i[0].ParmeterConstant)}var t=u.ObjSeriesModel.FormParameters;u.ObjSeriesModel.FormParameters=[];t&&t.length>0&&angular.forEach(n,i);u.ObjSeriesModel.FormParameters=n;u.ShowParameters=!0})};u.ClearParamtersForform=function(){u.ObjSeriesModel&&u.ObjSeriesModel.FormParameters&&(u.ObjSeriesModel.FormParameters="");u.ObjSeriesModel&&u.ObjSeriesModel.dictAttributes.sfwActiveForm!=""&&(u.seriesactiveform=!0);u.ShowParameters=!1};u.isChartFinishDisable=function(){var n=!1;return u.ErrorMessageForDisplay="",u.ObjSeriesModel&&(u.ValidateSeriesName()?u.ValidateXValue()?u.ValidateYValue()||(n=!0):n=!0:n=!0),n};u.ValidateSeriesName=function(){var n=!0;return u.ObjSeriesModel.dictAttributes.Name||(u.ErrorMessageForDisplay="Error: Please enter a Series Name.",n=!1),n};u.ValidateXValue=function(){var n=!0;return u.ObjSeriesModel.dictAttributes.XValueMember||(u.ErrorMessageForDisplay="Error: Please enter a Series XValueMember.",n=!1),n};u.ValidateYValue=function(){var n=!0;return u.ObjSeriesModel.dictAttributes.YValueMembers||(u.ErrorMessageForDisplay="Error: Please enter a Series YValueMembers.",n=!1),n};t.ValidateActiveForm=function(){var n=!0;return u.ObjSeriesModel.dictAttributes.sfwActiveForm||(u.ErrorMessageForDisplay="Error: Please enter a Series Navigation Form.",n=!1),n};t.ValidateYValue=function(){var n=!0;return u.ObjSeriesModel.dictAttributes.YValueMembers||(u.ErrorMessageForDisplay="Error: Please enter a Series YValueMembers.",n=!1),n};u.OpenTooltipParams=function(){t.OpenTooltipParams(u)};u.onAdditionalChartColumnClick=function(){t.onAdditionalChartColumnClick(u)};u.onCancelClick=function(){f&&f.close()};u.OnOkClick=function(){u.ObjSeriesModel.ParentVM=t.SeriesModel;u.onCancelClick()};f=i.showDialog(u,"Edit Series","Form/views/AddEditSeries.html",{width:600,height:600})},t.onAdditionalChartColumnClick=function(n){var t=n.$new(),u,r,f;if(t.sfwAddtionalChartColumns=[],t.SelectedObject=n.ObjSeriesModel,n.ObjSeriesModel.dictAttributes.swfAddtionalChartColumns)for(u=n.ObjSeriesModel.dictAttributes.swfAddtionalChartColumns.split(","),r=0;r<u.length;r++)t.sfwAddtionalChartColumns.push({Property:u[r]});f=i.showDialog(t,"Multiple Objects Selection","Form/views/AdditionalChartColumnsDialog.html",{width:1e3,height:490});t.onCancelClick=function(){f.close()};t.onOkClick=function(){for(var u="",r=0;r<t.sfwAddtionalChartColumns.length;r++)t.sfwAddtionalChartColumns[r].Property!=""&&(u==""?u=t.sfwAddtionalChartColumns[r].Property:u+=","+t.sfwAddtionalChartColumns[r].Property);i.EditPropertyValue(n.ObjSeriesModel.dictAttributes.swfAddtionalChartColumns,n.ObjSeriesModel.dictAttributes,"swfAddtionalChartColumns",u);f.close()};t.selectRow=function(n){t.selectedRow=n};t.addProperty=function(){t.sfwAddtionalChartColumns.push({Property:""})};t.deleteProperty=function(){var n=-1,i;if(t.selectedRow)for(i=0;i<t.sfwAddtionalChartColumns.length;i++)if(t.selectedRow==t.sfwAddtionalChartColumns[i]){n=i;break}n>-1&&(t.sfwAddtionalChartColumns.splice(n,1),t.selectedRow=t.sfwAddtionalChartColumns.length>0?n>0?t.sfwAddtionalChartColumns[n-1]:t.sfwAddtionalChartColumns[t.sfwAddtionalChartColumns.length-1]:undefined)}},t.title="Create Chart",t.CreateChartDialog=i.showDialog(t,t.title,"Form/views/CreateChart.html",{width:1e3,height:700}))};n.addCalendarControl=function(t){var r=n.$new(),e="sfwCalendar",o,f;r.IsAddScheduler=t;t&&(e="sfwScheduler");r.objCalendar={Name:e,prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]};o=n.model;r.objCalendar.dictAttributes.ID=n.selectedControl.ID;r.objCalendar.dictAttributes.sfwEntityField=n.fieldName;r.FormModel=n.formmodel;r.ParentEntityName=n.dragdropdata.Entity;f=n.formmodel.Elements.filter(function(n){return n.Name=="sfwTable"});f&&f.length>0&&(r.SfxMainTable=f[0]);r.title="Create New Calendar";t&&(r.title="Create New Scheduler",r.lstRelatedDialog=PopulateRelatedDialogList(r.SfxMainTable));r.ValidateCalendar=function(){if(r.ErrorMessageForDisplay="",r.objCalendar.dictAttributes.ID){if(r.objCalendar.dictAttributes.ID&&!isValidIdentifier(r.objCalendar.dictAttributes.ID,!1,!1))return r.ErrorMessageForDisplay="Invalid ID.",!0;var t=[];if(CheckforDuplicateID(n.formmodel,r.objCalendar.dictAttributes.ID,t),t.length>0)return r.ErrorMessageForDisplay="Duplicate ID.",!0}else return r.ErrorMessageForDisplay="Enter ID.",!0;return r.objCalendar.dictAttributes.sfwEventId==undefined||r.objCalendar.dictAttributes.sfwEventId==""?(r.ErrorMessageForDisplay="Enter Event Id.",!0):r.objCalendar.dictAttributes.sfwEventName==undefined||r.objCalendar.dictAttributes.sfwEventName==""?(r.ErrorMessageForDisplay="Enter Event Name.",!0):r.objCalendar.dictAttributes.sfwEventStartDate==undefined||r.objCalendar.dictAttributes.sfwEventStartDate==""?(r.ErrorMessageForDisplay="Enter Event Start Date.",!0):r.objCalendar.dictAttributes.sfwEventEndDate==undefined||r.objCalendar.dictAttributes.sfwEventEndDate==""?(r.ErrorMessageForDisplay="Enter Event End Date.",!0):r.objCalendar.errors&&u.isEmptyObj(r.objCalendar.errors)?!0:!1};r.onOkClick=function(){i.PushItem(r.objCalendar,n.model.Elements);SetFormSelectedControl(n.formmodel,r.objCalendar,event);r.onCancelClick();n.closeClick()};r.onCancelClick=function(){r.objCalendar.errors&&(r.objCalendar.errors={},u.removeObjInToArray(n.validationErrorList,r.objCalendar));r.objCalendarDialog&&r.objCalendarDialog.close()};r.objCalendarDialog=i.showDialog(r,r.title,"Form/views/AddCalendarControl.html",{width:700,height:700});ComponentsPickers.init()};n.addRepeaterControl=function(){var l=CreateControlID(n.formmodel,"RepeaterViewPanel","sfwListView"),u="swc",t={Name:"sfwListView",value:"",prefix:u,dictAttributes:{ID:l},Elements:[],Children:[]},r=getDisplayedEntity(n.LstDisplayedEntities),e=n.dragdropdata.ID,o,s,h,c;r&&r.strDisplayName!=""&&(e=r.strDisplayName+"."+n.dragdropdata.ID);strControlID=CreateControlID(n.formmodel,n.dragdropdata.ID,"sfwListView");t.dictAttributes.ID=strControlID;t.ParentVM=n.model;t.dictAttributes.sfwEntityField=e;o=GetVM("sfwTable",n.model);o&&t&&(t.dictAttributes.sfwSelection="Many",t.dictAttributes.sfwCaption="List View",t.dictAttributes.AllowPaging="True",t.dictAttributes.PageSize="1",s=n.dragdropdata.Entity,h=f.getEntityIntellisense(),t.dictAttributes.sfwDataKeyNames=GetTableKeyFields(s,h),u="swc",c=AddListViewTable(n.formmodel,t),t.Elements.push(c),t.initialvisibilty=!0,t.isLoaded=!0,i.PushItem(t,n.model.Elements),n.selectControl&&n.selectControl(t))};n.okClick=function(){var r,t,u;n.selectedControl?n.selectedControl.Index=="New Control"?n.selectedControl.Controltype=="sfwGridView"?n.addGridControl():n.selectedControl.Controltype=="UserControl"?n.addUserControl():n.selectedControl.Controltype=="sfwChart"?n.addChartControl():n.selectedControl.Controltype=="sfwCalendar"?n.addCalendarControl(!1):n.selectedControl.Controltype=="sfwScheduler"?n.addCalendarControl(!0):n.selectedControl.Controltype=="sfwListView"?(n.addRepeaterControl(),n.closeClick()):n.selectedControl.Controltype=="sfwListView"?(n.addRepeaterControl(),n.closeClick()):(n.currentControl.Name=n.selectedControl.Controltype,n.currentControl.dictAttributes.ID=n.selectedControl.ID,r=n.model,n.model.Name=="TemplateField"&&(r=n.model.Elements.filter(function(n){return n.Name=="ItemTemplate"})[0]),i.PushItem(n.currentControl,r.Elements),SetFormSelectedControl(n.formmodel,n.currentControl),n.closeClick()):(n.currentControl.dictAttributes.sfwDataField?(i.UndRedoBulkOp("Start"),i.EditPropertyValue(n.model.Elements[n.selectedControl.Index].dictAttributes.sfwDataField,n.model.Elements[n.selectedControl.Index].dictAttributes,"sfwDataField",n.currentControl.dictAttributes.sfwDataField),n.$parent.formmodel.IsLookupCriteriaEnabled&&(t=getCurrentFileScope(),t&&t.lookupTreeObject&&(u=t.lookupTreeObject.EntityName,u&&i.EditPropertyValue(n.model.Elements[n.selectedControl.Index].dictAttributes.sfwQueryID,n.model.Elements[n.selectedControl.Index].dictAttributes,"sfwQueryID",u))),i.UndRedoBulkOp("End")):i.EditPropertyValue(n.model.Elements[n.selectedControl.Index].dictAttributes.sfwEntityField,n.model.Elements[n.selectedControl.Index].dictAttributes,"sfwEntityField",n.currentControl.dictAttributes.sfwEntityField),n.closeClick()):e.Message("Message","Select a control from the list.")};n.closeClick=function(){n.objectTreeDragDropDialog.close()}}]);app.controller("CellFormatController",["$scope","$rootScope","$filter","$EntityIntellisenseFactory","$GetEntityFieldObjectService",function(n,t,i,r,u){var f;if(n.lstColumnName=[],n.IsCellOrRow=="CellFormat"?PopulateGridDataField(n.TemplateFieldModel.ParentVM,n.lstColumnName):PopulateGridDataField(n.TemplateFieldModel,n.lstColumnName),n.lstColumnName&&n.lstColumnName.length>0&&n.lstColumnName.splice(0,0,""),n.Itemtemplate={},n.isDropDown=!1,n.checkAndGetCodeValues=function(t){var f="",s=r.getEntityIntellisense(),e,c,y,l,h,p,a,o,v;n.isLookup?(e=i("filter")(s,{ID:n.formEntity},!0),e&&e.length>0&&e[0].Attributes.length>0&&(c=i("filter")(e[0].Attributes,{ID:t},!0),c.length>0&&(f=c[0].Value)),f.lastIndexOf("_value")==f.length-6?(n.isDropDown=!0,n.CurrentCodeID=GetCodeID(n.formEntity,t,s)):n.isDropDown=!1):(y=i("filter")(s,{ID:n.formEntity},!0),y&&(l=GetVM("sfwGridView",n.TemplateFieldModel),l?h=l.dictAttributes.sfwEntityField:(p=GetVM("sfwListView",n.TemplateFieldModel),h=p.dictAttributes.sfwEntityField),h&&n.formEntity&&(a=u.GetEntityFieldObjectFromEntityField(n.formEntity,h),o="",a&&(o=a.Entity),o&&(v=u.GetEntityFieldObjectFromEntityField(o,t),f="",v&&(f=v.Value),f&&f.lastIndexOf("_value")==f.length-6?(n.isDropDown=!0,n.CurrentCodeID=GetCodeID(o,t,s)):n.isDropDown=!1))))},n.IsCellOrRow=="CellFormat"){for(f=0;f<n.TemplateFieldModel.Elements.length;f++)if(n.TemplateFieldModel.Elements[f].Name=="ItemTemplate"){angular.copy(n.TemplateFieldModel.Elements[f],n.Itemtemplate);break}for(f=0;f<n.Itemtemplate.Elements.length;f++)if(n.Itemtemplate.Elements[f].Name=="cellformat"){n.cellFormat=n.Itemtemplate.Elements[f];n.cellFormat.dictAttributes.sfwEntityField&&n.checkAndGetCodeValues(n.cellFormat.dictAttributes.sfwEntityField);break}}else for(f=0;f<n.TemplateFieldModel.Elements.length;f++)if(n.TemplateFieldModel.Elements[f].Name=="rowformat"){n.cellFormat={};angular.copy(n.TemplateFieldModel.Elements[f],n.cellFormat);n.tempRowFormat={};angular.copy(n.TemplateFieldModel.Elements[f],n.tempRowFormat);n.cellFormat.dictAttributes.sfwEntityField&&n.checkAndGetCodeValues(n.cellFormat.dictAttributes.sfwEntityField);break}n.setRowSelection=function(t){n.selectedCssClassCondition=t};n.AddNewCssCondition=function(i){if(n.cellFormat&&n.cellFormat.Elements!=undefined)t.PushItem({dictAttributes:{value:"",cssclass:""},Elements:[],Children:[],Name:"condition",Value:""},n.cellFormat.Elements[0].Elements,null);n.checkAndGetCodeValues(i)};n.onCondtionSaveClick=function(t){var r,u,i;if(t!=undefined&&t!=""&&t.Elements&&t.Elements.length>0){if(t.Elements[0].Elements&&t.Elements[0].Elements.length==0&&(t.dictAttributes.sfwEntityField=""),r=!1,n.IsCellOrRow=="CellFormat"){for(i=0;i<n.Itemtemplate.Elements.length;i++)if(n.Itemtemplate.Elements[i].Name=="cellformat"){n.cellFormat&&n.cellFormat.dictAttributes.sfwEntityField?n.Itemtemplate.Elements[i]=n.cellFormat:n.Itemtemplate.Elements.splice(i,1);r=!0;break}}else for(i=0;i<n.TemplateFieldModel.Elements.length;i++)if(n.TemplateFieldModel.Elements[i].Name=="rowformat"){n.cellFormat&&n.cellFormat.dictAttributes.sfwEntityField?n.TemplateFieldModel.Elements[i]=n.cellFormat:n.TemplateFieldModel.Elements.splice(i,1);r=!0;break}if(n.IsCellOrRow=="CellFormat"){for(r==!1&&n.Itemtemplate.Elements.push(t),i=0;i<n.TemplateFieldModel.Elements.length;i++)if(n.TemplateFieldModel.Elements[i].Name=="ItemTemplate"){n.TemplateFieldModel.Elements.splice(i,1);n.TemplateFieldModel.Elements.splice(i,0,n.Itemtemplate);break}}else r==!1&&n.TemplateFieldModel.Elements.push(n.cellFormat)}else if(n.TemplateFieldModel&&n.TemplateFieldModel.Elements){for(u=-1,i=0;i<n.TemplateFieldModel.Elements.length;i++)n.TemplateFieldModel.Elements[i].Name==n.IsCellOrRow.toLowerCase()&&(u=i);u>-1&&n.TemplateFieldModel.Elements.splice(u,1)}n.CellFormatDialog.close()};n.onCancelClick=function(){if(n.IsCellOrRow!="CellFormat")for(var t=0;t<n.TemplateFieldModel.Elements.length;t++)if(n.TemplateFieldModel.Elements[t].Name=="rowformat"){n.cellFormat&&n.cellFormat.dictAttributes.sfwEntityField&&n.tempRowFormat?n.TemplateFieldModel.Elements[t]=n.tempRowFormat:n.TemplateFieldModel.Elements.splice(t,1);flag=!0;break}n.CellFormatDialog.close()};n.deleteCssCondition=function(){if(n.cellFormat.Elements[0].Elements.length>0){if(n.selectedCssClassCondition!=undefined){var i=n.cellFormat.Elements[0].Elements.indexOf(n.selectedCssClassCondition);i>-1&&t.DeleteItem(n.selectedCssClassCondition,n.cellFormat.Elements[0].Elements)}n.selectedCssClassCondition=undefined}else n.selectedCssClassCondition=undefined};n.clearCellFormat=function(){n.cellFormat!=undefined&&n.cellFormat.Elements&&n.cellFormat.Elements.length>0?n.cellFormat.Elements[0].Elements=[]:n.cellFormat=undefined};n.clearRoworCellFormat=function(){var r={dictAttributes:{sfwEntityField:n.cellFormat.dictAttributes.sfwEntityField},Elements:[{dictAttributes:{},Elements:[],Children:[],Name:"Conditions",Value:""}],Children:[],Name:"rowformat",Value:""},i;if(n.IsCellOrRow=="CellFormat"&&(r.Name="cellformat"),n.cellFormat&&n.cellFormat.Elements){if(n.IsCellOrRow=="CellFormat"){for(i=0;i<n.Itemtemplate.Elements.length;i++)if(n.Itemtemplate.Elements[i].Name=="cellformat"){t.UndRedoBulkOp("Start");t.DeleteItem(n.cellFormat,n.Itemtemplate.Elements);n.cellFormat=r;t.PushItem(n.cellFormat,n.Itemtemplate.Elements,null);t.UndRedoBulkOp("End");break}}else for(i=0;i<n.TemplateFieldModel.Elements.length;i++)if(n.TemplateFieldModel.Elements[i].Name=="rowformat"){t.UndRedoBulkOp("Start");t.DeleteItem(n.cellFormat,n.TemplateFieldModel.Elements);n.cellFormat=r;t.PushItem(n.cellFormat,n.TemplateFieldModel.Elements,null);t.UndRedoBulkOp("End");break}}else n.cellFormat=r,n.IsCellOrRow=="CellFormat"?t.PushItem(n.cellFormat,n.Itemtemplate.Elements,null):t.PushItem(n.cellFormat,n.TemplateFieldModel.Elements,null);n.checkAndGetCodeValues(n.cellFormat.dictAttributes.sfwEntityField)}}]);app.controller("DataKeysController",["$scope","ngDialog","$rootScope",function(n,t,i){var r,e,f,o,u;for(n.lstColumnName=[],n.lstGridColumns=[],n.lstDefualtOrder=["","asc","desc"],n.lstSortExpression=[],n.lstSortExpression.push(""),PopulateGridDataField(n.model,n.lstColumnName),r=0;r<n.lstColumnName.length;r++)n.lstSortExpression.push(r+1);for(r=0;r<n.lstColumnName.length;r++)n.lstGridColumns.push({FieldName:n.lstColumnName[r]});if(n.model.dictAttributes.sfwSortExpression)for(e=n.model.dictAttributes.sfwSortExpression.split(","),r=0;r<e.length;r++)for(f=e[r].split(" "),u=0;u<n.lstGridColumns.length;u++)n.lstGridColumns[u].FieldName==f[0]&&(f.length>1&&(n.lstGridColumns[u].DefaultOrder=f[1]),n.lstGridColumns[u].SortExpression=r+1);if(n.model.dictAttributes.sfwDataKeyNames)for(o=n.model.dictAttributes.sfwDataKeyNames.split(","),r=0;r<o.length;r++)for(u=0;u<n.lstGridColumns.length;u++)n.lstGridColumns[u].FieldName==o[r]&&(n.lstGridColumns[u].DataKey=!0);n.okClick=function(){for(var e,s,o,u,h,c,r="",f="",t=0;t<n.lstGridColumns.length;t++)n.lstGridColumns[t].DataKey&&(f==""?f=n.lstGridColumns[t].FieldName:f+=","+n.lstGridColumns[t].FieldName),n.lstGridColumns[t].SortExpression&&(e=n.lstGridColumns[t].SortExpression,s=e,s>0&&(r+=r?","+e+";"+n.lstGridColumns[t].FieldName:e+";"+n.lstGridColumns[t].FieldName,n.lstGridColumns[t].DefaultOrder&&(r+=" "+n.lstGridColumns[t].DefaultOrder)));for(o=[],u=r.split(","),t=0;t<u.length;t++)h=u[t].substring(0,u[t].indexOf(";")).trim(),c=u[t].substring(u[t].indexOf(";")+1).trim(),o.splice(h-1,0,c);r="";angular.forEach(o,function(n){r.length===0?r=n:r+=","+n});i.UndRedoBulkOp("Start");i.EditPropertyValue(n.model.dictAttributes.sfwSortExpression,n.model.dictAttributes,"sfwSortExpression",r);i.EditPropertyValue(n.model.dictAttributes.sfwDataKeyNames,n.model.dictAttributes,"sfwDataKeyNames",f);i.UndRedoBulkOp("End");n.closeClick()};n.closeClick=function(){n.DataKeyAndSortExpressionDialog.close()};n.ChangeSortExpression=function(n){n&&!n.SortExpression&&(n.DefaultOrder="")}}]);app.controller("ImageConditionController",["$scope","$rootScope","ngDialog","$SgMessagesService",function(n,t,i,r){n.conditions=[];angular.copy(n.oldConditions.Elements,n.conditions);n.onImageCondtionSaveClick=function(t){n.model.Elements=[];t.length>0&&n.model.Elements.push(t[0]);n.onCancelClick()};n.AddNewImageCondtion=function(){var t;n.conditions&&n.conditions.length>0?(t={dictAttributes:{value:"",ImageUrl:""},Elements:[],Children:[],Name:"condition",Value:""},n.conditions[0].Elements.push(t),n.selectedImageCondition=t):(t=[{dictAttributes:{},Elements:[{dictAttributes:{value:"",ImageUrl:""},Elements:[],Children:[],Name:"condition",Value:""}],Children:[],Name:"Conditions",Value:""}],n.conditions=t,n.conditions.length>0&&n.conditions[0].Elements&&n.conditions[0].Elements.length>0&&(n.selectedImageCondition=n.conditions[0].Elements[n.conditions[0].Elements.length-1]))};n.deleteImageCondition=function(){if(n.conditions[0].Elements.length>1){var t=n.conditions[0].Elements.indexOf(n.selectedImageCondition);n.conditions[0].Elements.splice(t,1);t<n.conditions[0].Elements.length?n.selectedImageCondition=n.conditions[0].Elements[t]:n.conditions[0].Elements.length>0&&(n.selectedImageCondition=n.conditions[0].Elements[t-1])}else n.conditions=[],n.selectedImageCondition=undefined};n.setRowSelection=function(t){n.selectedImageCondition=t};n.onCancelClick=function(){n.ImageConditionDialog.close()};n.OpenImageUrl=function(t,i){n.formobject.dictAttributes.WebSite?$.connection.hubForm.server.openImageUrlClick(n.formobject.dictAttributes.WebSite,t).done(function(t){t&&t.length==2&&n.receiveImageFileName(t[0],t[1],i)}):r.Message("Message","Please select the appropriate 'Website' from the form details page.")};n.receiveImageFileName=function(t,i,u){t!=""&&n.$apply(function(){n.conditions[0].Elements[u].dictAttributes.ImageUrl=t});i!=""&&i!=undefined&&r.Message("Message",i)}}]);app.controller("SetFooterController",["$scope","$rootScope","ngDialog",function(n,t){var u,f,i,e,r;for(n.IsMVVM=!1,n.lstOperations=[{isSelect:!1,operation:"Count",caption:""},{isSelect:!1,operation:"Sum",caption:""},{isSelect:!1,operation:"Min",caption:""},{isSelect:!1,operation:"Max",caption:""},{isSelect:!1,operation:"Avg",caption:""},{isSelect:!1,operation:"StaticText",caption:""}],n.Footertemplate={},i=0;i<n.TemplateFieldModel.Elements.length;i++)if(n.TemplateFieldModel.Elements[i].Name=="FooterTemplate"){angular.copy(n.TemplateFieldModel.Elements[i],n.Footertemplate);break}if(n.Footertemplate.Elements&&n.Footertemplate.Elements.length>0&&(n.Footertemplate.Elements[0].dictAttributes.sfwEntityField?n.footerTemplateLabelIsNotMVVM=n.Footertemplate.Elements[0]:n.footerTemplateLabel=n.Footertemplate.Elements[0]),n.Footertemplate.Elements&&n.Footertemplate.Elements.length>0&&!n.Footertemplate.Elements[0].dictAttributes.sfwEntityField&&(n.IsMVVM=!0,u=[],n.footerTemplateLabel.dictAttributes.sfwFooterType&&(u=n.footerTemplateLabel.dictAttributes.sfwFooterType.split(",")),f=[],n.footerTemplateLabel.dictAttributes.sfwText&&(f=n.footerTemplateLabel.dictAttributes.sfwText.split(";")),u.length==f.length))for(i=0;i<u.length;i++)for(e="",f[i].contains(":")&&(e=f[i].split(":")[0]),r=0;r<n.lstOperations.length;r++)if(n.lstOperations[r].operation==u[i]){n.lstOperations[r].isSelect=!0;n.lstOperations[r].caption=e;break}n.FooterDetailsChange=function(){for(var u,i=[],r=[],t=0;t<n.lstOperations.length;t++)n.lstOperations[t].isSelect==!0?i.push(n.lstOperations[t]):(n.lstOperations[t].caption="",r.push(n.lstOperations[t]));for(n.lstOperations=[],i.length>0&&n.footerTemplateLabel==undefined&&(u={dictAttributes:{},Elements:[{dictAttributes:{sfwText:"",sfwFooterType:""},Elements:[],Children:[],Name:"sfwLabel",Value:"",prefix:"swc"}],Children:[],Name:"FooterTemplate",Value:"",prefix:"asp"},n.Footertemplate=u,n.footerTemplateLabel=n.Footertemplate.Elements[0]),n.footerTemplateLabel&&(n.footerTemplateLabel.dictAttributes.sfwFooterType="",n.footerTemplateLabel.dictAttributes.sfwText=""),t=0;t<i.length;t++)n.footerTemplateLabel!=undefined&&(n.footerTemplateLabel.dictAttributes.sfwFooterType+=i[t].operation,n.footerTemplateLabel.dictAttributes.sfwText+=i[t].caption!=""?i[t].caption+":{"+t+"}":"{"+t+"}",t<i.length-1&&(n.footerTemplateLabel.dictAttributes.sfwFooterType+=",",n.footerTemplateLabel.dictAttributes.sfwText+=";")),n.lstOperations.push(i[t]);for(t=0;t<r.length;t++)n.lstOperations.push(r[t])};n.clearFooterText=function(t){!t&&n.footerTemplateLabelIsNotMVVM&&(n.footerTemplateLabelIsNotMVVM.dictAttributes.sfwText="")};n.onSetFooterSaveClick=function(){var r,u,i;if(n.IsMVVM)if(n.footerTemplateLabelIsNotMVVM=undefined,n.footerTemplateLabel!=undefined){for(r=!1,i=0;i<n.TemplateFieldModel.Elements.length;i++)if(n.TemplateFieldModel.Elements[i].Name=="FooterTemplate"){(n.footerTemplateLabel.dictAttributes.sfwFooterType||n.footerTemplateLabel.dictAttributes.sfwText)&&n.TemplateFieldModel.Elements[i].Elements.length>0?(t.UndRedoBulkOp("Start"),t.EditPropertyValue(n.TemplateFieldModel.Elements[i].Elements[0].dictAttributes.sfwEntityField,n.TemplateFieldModel.Elements[i].Elements[0].dictAttributes,"sfwEntityField",""),t.EditPropertyValue(n.TemplateFieldModel.Elements[i].Elements[0].dictAttributes.sfwFooterType,n.TemplateFieldModel.Elements[i].Elements[0].dictAttributes,"sfwFooterType",n.footerTemplateLabel.dictAttributes.sfwFooterType),t.EditPropertyValue(n.TemplateFieldModel.Elements[i].Elements[0].dictAttributes.sfwText,n.TemplateFieldModel.Elements[i].Elements[0].dictAttributes,"sfwText",n.footerTemplateLabel.dictAttributes.sfwText),t.UndRedoBulkOp("End")):t.DeleteItem(n.TemplateFieldModel.Elements[i],n.TemplateFieldModel.Elements);r=!0;break}r==!1&&t.PushItem(n.Footertemplate,n.TemplateFieldModel.Elements)}else for(i=0;i<n.TemplateFieldModel.Elements.length;i++)n.TemplateFieldModel.Elements[i].Name=="FooterTemplate"&&t.DeleteItem(n.TemplateFieldModel.Elements[i],n.TemplateFieldModel.Elements);else if(n.footerTemplateLabel=undefined,n.footerTemplateLabelIsNotMVVM!=undefined){for(r=!1,i=0;i<n.TemplateFieldModel.Elements.length;i++)if(n.TemplateFieldModel.Elements[i].Name=="FooterTemplate"){n.footerTemplateLabelIsNotMVVM.dictAttributes.sfwEntityField&&n.TemplateFieldModel.Elements[i].Elements.length>0?(t.UndRedoBulkOp("Start"),t.EditPropertyValue(n.TemplateFieldModel.Elements[i].Elements[0].dictAttributes.sfwEntityField,n.TemplateFieldModel.Elements[i].Elements[0].dictAttributes,"sfwEntityField",n.footerTemplateLabelIsNotMVVM.dictAttributes.sfwEntityField),t.EditPropertyValue(n.TemplateFieldModel.Elements[i].Elements[0].dictAttributes.sfwText,n.TemplateFieldModel.Elements[i].Elements[0].dictAttributes,"sfwText",n.footerTemplateLabelIsNotMVVM.dictAttributes.sfwText),t.EditPropertyValue(n.TemplateFieldModel.Elements[i].Elements[0].dictAttributes.sfwFooterType,n.TemplateFieldModel.Elements[i].Elements[0].dictAttributes,"sfwFooterType",""),t.UndRedoBulkOp("End")):t.DeleteItem(n.TemplateFieldModel.Elements[i],n.TemplateFieldModel.Elements);r=!0;break}r==!1&&(u={dictAttributes:{},Elements:[{dictAttributes:{sfwText:"",sfwEntityField:""},Elements:[],Children:[],Name:"sfwLabel",Value:"",prefix:"swc"}],Children:[],Name:"FooterTemplate",Value:"",prefix:"asp"},n.Footertemplate=u,n.Footertemplate.Elements[0].dictAttributes=n.footerTemplateLabelIsNotMVVM.dictAttributes,t.PushItem(n.Footertemplate,n.TemplateFieldModel.Elements))}else for(i=0;i<n.TemplateFieldModel.Elements.length;i++)n.TemplateFieldModel.Elements[i].Name=="FooterTemplate"&&t.DeleteItem(n.TemplateFieldModel.Elements[i],n.TemplateFieldModel.Elements);n.onCancelClick()};n.onCancelClick=function(){n.SetFoterDialog.close()};n.setRowSelection=function(t){n.selectedOperation=t};n.isMoveUp=function(){if(n.selectedOperation==undefined)return!0;var t=n.lstOperations.indexOf(n.selectedOperation);return t>0?!1:!0};n.isMoveDown=function(){if(n.selectedOperation==undefined)return!0;var t=n.lstOperations.indexOf(n.selectedOperation);return t!=n.lstOperations.length-1&&t!=-1&&n.lstOperations[t+1].isSelect==!0?!1:!0};n.MoveUp=function(){var t=n.lstOperations.indexOf(n.selectedOperation),i=n.lstOperations[t-1];n.lstOperations[t-1]=n.lstOperations[t];n.lstOperations[t]=i;n.FooterDetailsChange()};n.MoveDown=function(){var t=n.lstOperations.indexOf(n.selectedOperation),i=n.lstOperations[t+1];n.lstOperations[t+1]=n.lstOperations[t];n.lstOperations[t]=i;n.FooterDetailsChange()}}]);app.controller("CreateGridViewController",["$scope","$rootScope","$EntityIntellisenseFactory","$GetEntityFieldObjectService","$timeout","$getModelList",function(n,t,r,u,f,e){function d(t){function f(t){var i,f,r;"sfwEntityField"in t.dictAttributes&&(c&&c.length>0&&c[0].Attributes.length>0?(i="",n.ParentEntityName&&t.dictAttributes.sfwEntityField&&(i=u.GetEntityFieldObjectFromEntityField(n.ParentEntityName,t.dictAttributes.sfwEntityField)),i&&(f={Key:t.dictAttributes.sfwEntityField,Value:i},n.objGridView.lstPreDisabledField.push(f))):n.ObjgridBoundedQuery&&n.ObjgridBoundedQuery.SortedColumns&&(r=n.ObjgridBoundedQuery.SortedColumns.filter(function(n){return n.ID==t.dictAttributes.sfwEntityField}),r&&r.length>0&&(r[0].IsCheckboxDisabled=!0)))}var i,r;t.Name=="TemplateField"&&(i=t.Elements.filter(function(n){return n.Name=="ItemTemplate"}),i&&i.length>0&&(r=i[0],angular.forEach(r.Elements,f)))}var k,c,y,a,p,w,b,l,o,h,g,v,s;n.ObjgridBoundedQuery=undefined;n.FieldCollection=[];n.GridFirstStepTitle="Select the collection fields to be displayed in the grid";n.IsAddColumnSelected||(n.objGridView.isNewSelected=!1,n.objGridView.NewbuttonID="",n.objGridView.NewformID="",n.objGridView.isOpenSelected=!1,n.objGridView.OpenbuttonID="",n.objGridView.OpenformID="",n.objGridView.isOpenLookupSelected=!1,n.objGridView.OpenLookupbuttonID="",n.objGridView.OpenLookupformID="",n.objGridView.isOpenMaintenanceSelected=!1,n.objGridView.OpenMaintenancebuttonID="",n.objGridView.OpenMaintenanceformID="",n.objGridView.isDeleteSelected=!1,n.objGridView.DeletebuttonID="",n.objGridView.isExportToExcelSelected=!1,n.objGridView.ExportbuttonID="");n.ExpandCollapsedCustomAttrField=function(n){n.IsExpanded=!n.IsExpanded};n.SetFieldClass=function(t){if(t==n.SelectedField)return"selected"};n.SelectFieldClick=function(t,i){n.SelectedField=t;i&&i.stopPropagation()};n.objGridView.lstselectedobjecttreefields=[];n.objGridView.preselectedfields=[];n.objGridView.lstPreDisabledField=[];k=r.getEntityIntellisense();c=k.filter(function(t){return t.ID==n.ParentEntityName});n.getModelForBoundedQueryList=function(n){return e.getModelListFromQueryFieldlist(n)};n.selectedEntityField?(c&&c.length>0&&c[0].Attributes.length>0&&(y=c[0].Attributes.filter(function(n){return n.Type=="Column"&&n.KeyNo=="1"}),y.length>0&&n.objGridView.preselectedfields.push(y[0])),a=getDisplayedEntity(n.LstDisplayedEntities),p="",p=a&&a.strDisplayName!=""?a.strDisplayName+"."+n.selectedEntityField.ID:n.selectedEntityField.ID,w=p,n.IsAddGridWithPanel&&(w=n.GridEntityField),n.objGridView.ParentVM=n.cellVM,n.objGridView.dictAttributes.ID="dgrResult",n.objGridView.dictAttributes.AllowPaging="True",n.objGridView.dictAttributes.AllowSorting="True",n.objGridView.dictAttributes.sfwSelection="Many",n.objGridView.dictAttributes.sfwEntityField=w,n.selectedEntityField.ID&&(l=n.selectedEntityField.ID,l=CreateControlID(n.FormModel,n.selectedEntityField.ID,"sfwGridView"),n.objGridView.dictAttributes.ID=l),b=n.FormModel.dictAttributes.sfwType=="Lookup",o=n.objGridView.dictAttributes.ID,startsWith(o,"grv",0)&&(o=o.substring(3)),b?(n.objGridView.NewbuttonID==""&&(n.objGridView.NewbuttonID="btnNew"),n.objGridView.OpenbuttonID==""&&(n.objGridView.OpenbuttonID="btnOpen"),n.objGridView.OpenLookupbuttonID==""&&(n.objGridView.OpenLookupbuttonID="btnOpenLookup"),n.objGridView.OpenMaintenancebuttonID==""&&(n.objGridView.OpenMaintenancebuttonID="btnOpenMaintenance"),n.objGridView.DeletebuttonID==""&&(n.objGridView.DeletebuttonID="btnDelete"),n.objGridView.ExportbuttonID==""&&(n.objGridView.ExportbuttonID="btnExportExcel")):(n.objGridView.NewbuttonID||(n.objGridView.NewbuttonID="btnNew"+o),n.objGridView.OpenbuttonID||(n.objGridView.OpenbuttonID="btnOpen"+o),n.objGridView.OpenLookupbuttonID||(n.objGridView.OpenLookupbuttonID="btnOpen"+o+"Lookup"),n.objGridView.OpenMaintenancebuttonID||(n.objGridView.OpenMaintenancebuttonID="btnOpen"+o+"Maintenance"),n.objGridView.DeletebuttonID||(n.objGridView.DeletebuttonID="btnDelete"+o),n.objGridView.ExportbuttonID||(n.objGridView.ExportbuttonID="btnExportExcel"+o))):!n.IsAddColumnSelected&&(n.IsAddFromToolBox||n.objGridView.dictAttributes.sfwBaseQuery)?(n.objGridView.ParentVM=n.cellVM,n.objGridView.dictAttributes.ID="dgrResult",n.objGridView.dictAttributes.AllowPaging="True",n.objGridView.dictAttributes.AllowSorting="True",n.objGridView.dictAttributes.sfwSelection="Many",n.objGridView.dictAttributes.sfwEntityField?(l=CreateControlID(n.FormModel,n.objGridView.dictAttributes.sfwEntityField,"sfwGridView"),n.objGridView.dictAttributes.ID=l):(l=CreateControlID(n.FormModel,"GridView","sfwGridView"),n.objGridView.dictAttributes.ID=l),o=n.objGridView.dictAttributes.ID,startsWith(o,"grv",0)&&(o=o.substring(3)),b?(n.objGridView.NewbuttonID==""&&(n.objGridView.NewbuttonID="btnNew"),n.objGridView.OpenbuttonID==""&&(n.objGridView.OpenbuttonID="btnOpen"),n.objGridView.OpenLookupbuttonID==""&&(n.objGridView.OpenLookupbuttonID="btnOpenLookup"),n.objGridView.OpenMaintenancebuttonID==""&&(n.objGridView.OpenMaintenancebuttonID="btnOpenMaintenance"),n.objGridView.DeletebuttonID==""&&(n.objGridView.DeletebuttonID="btnDelete"),n.objGridView.ExportbuttonID==""&&(n.objGridView.ExportbuttonID="btnExportExcel")):(n.objGridView.NewbuttonID||(n.objGridView.NewbuttonID="btnNew"+o),n.objGridView.OpenbuttonID||(n.objGridView.OpenbuttonID="btnOpen"+o),n.objGridView.OpenLookupbuttonID||(n.objGridView.OpenLookupbuttonID="btnOpen"+o+"Lookup"),n.objGridView.OpenMaintenancebuttonID||(n.objGridView.OpenMaintenancebuttonID="btnOpen"+o+"Maintenance"),n.objGridView.DeletebuttonID||(n.objGridView.DeletebuttonID="btnDelete"+o),n.objGridView.ExportbuttonID||(n.objGridView.ExportbuttonID="btnExportExcel"+o)),n.objGridView.dictAttributes.sfwBaseQuery&&n.objGridView.dictAttributes.sfwBoundToQuery=="True"&&(n.ObjgridBoundedQuery={},n.GridFirstStepTitle="Select the query fields to be displayed in the grid",v=n.objGridView.dictAttributes.sfwBaseQuery,$.connection.hubForm.server.getEntityQueryColumns(v,"dummy").done(function(t){n.$evalAsync(function(){if(t&&t.length>0){var i=t;sortListBasedOnproperty(i,"","CodeID");n.ObjgridBoundedQuery.lstselectedobjecttreefields=[];n.ObjgridBoundedQuery.SortedColumns=[];n.ObjgridBoundedQuery.lstselectedobjecttreefields=n.getModelForBoundedQueryList(i);n.ObjgridBoundedQuery.SortedColumns=n.ObjgridBoundedQuery.lstselectedobjecttreefields}})}))):n.objGridView&&(h=n.objGridView.Elements.filter(function(n){return n.Name=="Columns"}),(!h||h&&h.length==0)&&(g={Name:"Columns",Value:"",dictAttributes:{},Elements:[]},t.PushItem(g,n.objGridView.Elements),h=n.objGridView.Elements.filter(function(n){return n.Name=="Columns"})),n.objGridView.dictAttributes.sfwBaseQuery&&n.objGridView.dictAttributes.sfwBoundToQuery=="True"?(n.ObjgridBoundedQuery={},n.GridFirstStepTitle="Select the query fields to be displayed in the grid",v=n.objGridView.dictAttributes.sfwBaseQuery,$.connection.hubForm.server.getEntityQueryColumns(v,"dummy").done(function(t){n.$evalAsync(function(){if(t&&t.length>0){var i=t;sortListBasedOnproperty(i,"","CodeID");n.ObjgridBoundedQuery.lstselectedobjecttreefields=[];n.ObjgridBoundedQuery.SortedColumns=[];n.ObjgridBoundedQuery.lstselectedobjecttreefields=n.getModelForBoundedQueryList(i);n.ObjgridBoundedQuery.SortedColumns=n.ObjgridBoundedQuery.lstselectedobjecttreefields;h&&h.length>0&&angular.forEach(h[0].Elements,d)}})})):h&&h.length>0&&angular.forEach(h[0].Elements,d));n.populateParamtersForform=function(t,i){if(t){var r=t;i=="New"?n.ShowNewParameters=!1:i=="Open"?n.ShowOpenParameters=!1:i=="OpenLookup"?n.ShowOpenLookupParameters=!1:i=="OpenMaintenance"&&(n.ShowOpenMaintenanceParameters=!1);$.connection.hubForm.server.getFormParameters(r,i).done(function(t){n.receiveFormParameters(t,i)})}};n.receiveFormParameters=function(t,i){t&&(i=="New"?n.FormNewParameters=t:i=="Open"?n.FormOpenParameters=t:i=="OpenLookup"?n.FormOpenLookupParameters=t:i=="OpenMaintenance"&&(n.FormOpenMaintenanceParameters=t))};n.onSfxGridCancelClick=function(){n.objGridDialog&&n.objGridDialog.close();n.onCancelClick&&n.onCancelClick()};n.isNextDisableForGrid=function(){var t=!0;return n.objGridView.ErrorMessageForDisplay="",n.objGridView.ValidateData()||(t=!1),t};n.objGridView.ValidateData=function(){var t=[],i=!1;return n.ObjgridBoundedQuery?n.ObjgridBoundedQuery.SortedColumns&&(t=n.ObjgridBoundedQuery.SortedColumns.filter(function(n){return n.IsSelected})):t=n.objGridView.lstselectedmultiplelevelfield,t.length==0&&(n.objGridView.ErrorMessageForDisplay="Error: Please select atleast one value from the list.",i=!0),i};n.isNextDisableForGridButton=function(){var t=!1;return n.objGridView.ErrorMessageForGridButton="",n.objGridView.ValidateGridButtonData()&&(t=!0),t};n.objGridView.ValidateGridButtonData=function(){var t=!1;return n.objGridView.isOpenMaintenanceSelected=="True"&&(n.objGridView.OpenMaintenanceformID==undefined||n.objGridView.OpenMaintenanceformID=="")&&(n.objGridView.ErrorMessageForGridButton="Error: Please Select Maintenance Form.",t=!0),n.objGridView.isOpenLookupSelected=="True"&&(n.objGridView.OpenLookupformID==undefined||n.objGridView.OpenLookupformID=="")&&(n.objGridView.ErrorMessageForGridButton="Error: Please Select Lookup Form.",t=!0),n.objGridView.isOpenSelected=="True"&&(n.objGridView.OpenformID==undefined||n.objGridView.OpenformID=="")&&(n.objGridView.ErrorMessageForGridButton="Error: Please Select Maintenance Form.",t=!0),n.objGridView.isNewSelected=="True"&&(n.objGridView.NewformID==undefined||n.objGridView.NewformID=="")&&(n.objGridView.ErrorMessageForGridButton="Error: Please Select Maintenance Form.",t=!0),t};n.onCollectionStepNext=function(){(n.IsAddColumnSelected||n.skipSecondStep)&&(n.LoadControlTypes(),n.LoadDataFormat(),n.LoadDataKey(),n.LoadOrder(),n.LoadControls(),n.LoadSort(),n.LoadRelativeControl())};s=[];n.onAddButtonsNextClick=function(){var i="swc",t;s=[];n.objGridView.isNewSelected&&n.objGridView.isNewSelected=="True"&&(t={Name:"sfwButton",prefix:i,Value:"",dictAttributes:{},Elements:[],Children:[]},t.dictAttributes.ID=n.objGridView.NewbuttonID,t.dictAttributes.sfwMethodName="btnNew_Click",t.dictAttributes.sfwActiveForm=n.objGridView.NewformID,t.dictAttributes.Text="New",t.dictAttributes.sfwNavigationParameter=GetNavigationParameters(n.FormNewParameters),s.push(t));n.objGridView.isOpenSelected&&n.objGridView.isOpenSelected=="True"&&(t={Name:"sfwButton",prefix:i,Value:"",dictAttributes:{},Elements:[],Children:[]},t.dictAttributes.ID=n.objGridView.OpenbuttonID,t.dictAttributes.sfwMethodName="btnOpen_Click",t.dictAttributes.sfwActiveForm=n.objGridView.OpenformID,t.dictAttributes.sfwRelatedControl=n.objGridView.dictAttributes.ID,t.dictAttributes.Text="Open",t.dictAttributes.sfwNavigationParameter=GetNavigationParameters(n.FormOpenParameters),s.push(t));n.objGridView.isOpenLookupSelected&&n.objGridView.isOpenLookupSelected=="True"&&(t={Name:"sfwButton",prefix:i,Value:"",dictAttributes:{},Elements:[],Children:[]},t.dictAttributes.ID=n.objGridView.OpenLookupbuttonID,t.dictAttributes.Visible="False",t.dictAttributes.sfwMethodName="btnOpenLookup_Click",t.dictAttributes.sfwActiveForm=n.objGridView.OpenLookupformID,t.dictAttributes.Text="Open Lookup",t.dictAttributes.sfwNavigationParameter=GetNavigationParameters(n.FormOpenLookupParameters),s.push(t));n.objGridView.isOpenMaintenanceSelected&&n.objGridView.isOpenMaintenanceSelected=="True"&&(t={Name:"sfwButton",prefix:i,Value:"",dictAttributes:{},Elements:[],Children:[]},t.dictAttributes.ID=n.objGridView.OpenMaintenancebuttonID,t.dictAttributes.sfwMethodName="btnOpen_Click",t.dictAttributes.sfwActiveForm=n.objGridView.OpenMaintenanceformID,t.dictAttributes.sfwRelatedControl=n.objGridView.dictAttributes.ID,t.dictAttributes.Text="Open Maintenance",t.dictAttributes.sfwNavigationParameter=GetNavigationParameters(n.FormOpenMaintenanceParameters),s.push(t));n.objGridView.isDeleteSelected&&n.objGridView.isDeleteSelected=="True"&&(t={Name:"sfwButton",prefix:i,Value:"",dictAttributes:{},Elements:[],Children:[]},t.dictAttributes.ID=n.objGridView.DeletebuttonID,t.dictAttributes.sfwMethodName="btnDelete_Click",t.dictAttributes.Text="Delete",s.push(t));n.objGridView.isExportToExcelSelected&&n.objGridView.isExportToExcelSelected=="True"&&(t={Name:"sfwButton",prefix:i,Value:"",dictAttributes:{},Elements:[],Children:[]},t.dictAttributes.ID=n.objGridView.ExportbuttonID,t.dictAttributes.sfwMethodName="btnColumnsToExport_Click",t.dictAttributes.sfwRelatedControl=n.objGridView.dictAttributes.ID,t.dictAttributes.Text="Export To Excel",s.push(t));n.LoadControlTypes();n.LoadDataFormat();n.LoadDataKey();n.LoadOrder();n.LoadControls();n.LoadSort();n.LoadRelativeControl();n.ShowNewParameters=!1;n.ShowOpenParameters=!1;n.ShowOpenLookupParameters=!1;n.ShowOpenMaintenanceParameters=!1};n.ArrControlTypes=[];n.ArrDataFormat=[];n.ArrDataKey=[];n.ArrSort=[];n.ArrOrder=[];n.LoadControlTypes=function(){n.ArrControlTypes=[];n.ArrControlTypes.push("");n.ArrControlTypes.push("Label");n.FormModel.dictAttributes.sfwType=="Lookup"||n.ObjgridBoundedQuery||(n.ArrControlTypes.push("HyperLink"),n.ArrControlTypes.push("Checkbox"),n.ArrControlTypes.push("JSONData"));n.IsPrototype||n.FormModel.dictAttributes.sfwType=="Lookup"||n.ObjgridBoundedQuery||(n.ArrControlTypes.push("TextBox"),n.ArrControlTypes.push("DropDownList"))};n.ChangeSortExpression=function(n){n&&!n.istrSort&&(n.istrOrder="")};n.SelectQueryField=function(t){n.SelectedQueryField=t};n.LoadDataFormat=function(){n.ArrDataFormat=[];n.ArrDataFormat.push("");n.ArrDataFormat.push("{0:d}");n.ArrDataFormat.push("{0:C}");n.ArrDataFormat.push("{0:000-##-####}");n.ArrDataFormat.push("{0:(###)###-####}")};n.LoadDataKey=function(){n.ArrDataKey=[];n.ArrDataKey.push("");n.ArrDataKey.push("1");n.ArrDataKey.push("2");n.ArrDataKey.push("3");n.ArrDataKey.push("4");n.ArrDataKey.push("5")};n.LoadSort=function(){if(n.ArrSort=[],n.ArrSort.push(""),n.FieldCollection&&n.FieldCollection.length>0)for(i=1;i<n.FieldCollection.length+1;i++)n.ArrSort.push(i)};n.LoadOrder=function(){n.ArrOrder=[];n.ArrOrder.push("");n.ArrOrder.push("asc");n.ArrOrder.push("desc")};n.LoadControls=function(){function r(t){var u=[],r,f,e;u=n.ObjgridBoundedQuery?i.filter(function(n){return n.istrFieldName===t.ID}):i.filter(function(n){return n.istrFieldName===t.FieldObject.ID});r={};u&&u.length>0?r=u[0]:(objModel=n.ObjgridBoundedQuery?t:t.FieldObject,objModel&&(r.istrFieldName=objModel.ID,r.istrObjectID=objModel.Value,r.istrDataType=objModel.DataType,f=t.Entity,r.istrEntityName=f,r.istrControlType="Label",e=GetCaptionFromField(objModel),r.istrHeader=e,n.ObjgridBoundedQuery?(r.istrItemPath=t.ID,r.istrPropertyName=t.ID):(r.istrItemPath=t.EntityField,r.istrPropertyName=t.EntityField),r.istrVisible="True"));r&&n.FieldCollection.push(r)}var t=[],i,u,f;n.ObjgridBoundedQuery?n.ObjgridBoundedQuery&&n.ObjgridBoundedQuery.SortedColumns&&(t=n.ObjgridBoundedQuery.SortedColumns.filter(function(n){return n.IsSelected})):t=n.objGridView.lstselectedmultiplelevelfield;i=angular.copy(n.FieldCollection);n.FieldCollection=[];t.length>0&&(u=[],f=0,angular.forEach(t,r))};n.LoadRelativeControl=function(){function r(t){if(t.dictAttributes.sfwRelatedControl==n.objGridView.dictAttributes.ID){var i=t.dictAttributes.ID;i&&n.ArrRelativeControl.push(i)}}var i,t;if(n.IsAddColumnSelected)n.ArrRelativeControl=[],n.ArrRelativeControl.push(""),n.objGridView&&(i=FindParent(n.objGridView,"sfwPanel"),i&&(t=[],FindControlListByName(i,"sfwButton",t),t&&t.length>0&&angular.forEach(t,r)));else{n.ArrRelativeControl=[];n.ArrRelativeControl.push("");function u(t){var i=t.dictAttributes.ID;i&&n.ArrRelativeControl.push(i)}angular.forEach(s,u)}};n.UpdateGridProperties=function(){function s(n){f=n.istrKey;f&&(i.length==0?i=f+";"+n.istrPropertyName:i+=","+f+";"+n.istrPropertyName);r=n.istrSort;r&&(t.length==0?t=n.istrOrder?r+";"+n.istrPropertyName+" "+n.istrOrder:r+";"+n.istrPropertyName:t+=n.istrOrder?","+r+";"+n.istrPropertyName+" "+n.istrOrder:","+r+";"+n.istrPropertyName)}function h(n){var i=n.substring(n.indexOf(";")+1),t={};t.key=n;t.Value=i;u.push(t)}function c(n){i.length==0?i=n.Value:i+=","+n.Value}function l(n){var i=n.substring(n.indexOf(";")+1),t={};t.key=n;t.Value=i;u.push(t)}function a(n){t.length==0?t=n.Value:t+=","+n.Value}var f,i="",r,t="",u,e,o;n.FieldCollection.length>0&&angular.forEach(n.FieldCollection,s);u=[];e=i.split(",");angular.forEach(e,h);i="";angular.forEach(u,c);n.objGridView.dictAttributes.sfwDataKeyNames=i;u=[];o=t.split(",");angular.forEach(o,l);t="";angular.forEach(u,a);n.objGridView.dictAttributes.sfwSortExpression=t};n.UpdateGridFields=function(){if(n.objGridView.Elements=[],n.FieldCollection.length>0){var t={Name:"Columns",Value:"",dictAttributes:{},Elements:[],Children:[]};t.ParentVM=n.objGridView;n.AddGridTemplateColumn(t);n.objGridView.Elements.push(t)}};n.AddGridTemplateColumn=function(i){function e(e){var h=e.istrDataType,l="",s,o,a,c;h=="Decimal"&&(l="Right");s={Name:"TemplateField",prefix:f,Value:"",dictAttributes:{},Elements:[],Children:[]};s.ParentVM=i;s.dictAttributes.Visible=e.istrVisible;s.dictAttributes.HeaderText=e.istrHeader;s.dictAttributes["ItemStyle.HorizontalAlign"]=l;o={Name:"ItemTemplate",prefix:f,Value:"",dictAttributes:{},Elements:[],Children:[]};o.ParentVM=s;switch(e.istrControlType){case"HyperLink":u={Name:"sfwLabel",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]};u.ParentVM=o;u.dictAttributes.sfwLinkable="True";u.dictAttributes.sfwRelatedControl="btnOpen";break;case"TextBox":u={Name:"sfwTextBox",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]};u.ParentVM=o;h=="DateTime"&&(u.dictAttributes.sfwDataType=h);break;case"DropDownList":u={Name:"sfwDropDownList",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]};u.ParentVM=o;a=r.getEntityIntellisense();c=GetCodeID(e.istrEntityName,e.istrFieldName,a);c||(c="0");u.dictAttributes.sfwLoadType="CodeGroup";break;case"Checkbox":u={Name:"sfwCheckBox",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]};u.ParentVM=o;break;case"JSONData":u={Name:"sfwJSONData",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]};u.ParentVM=o;break;default:u={Name:"sfwLabel",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]};u.ParentVM=o}n.FormModel&&n.FormModel.dictAttributes.sfwType!="Lookup"&&u.Name!="sfwLabel"&&u.Name!="sfwButton"&&u.Name!="sfwLinkButton"&&u.Name!="sfwImageButton"&&u.Name!=="sfwButtonGroup"&&(n.objGridView.dictAttributes.AllowEditing="True",n.objGridView.dictAttributes.sfwTwoWayBinding="True",n.objGridView.dictAttributes.sfwCommonFilterBox="False",n.objGridView.dictAttributes.sfwFilterOnKeyPress="False");u.dictAttributes.sfwEntityField=e.istrItemPath;u.dictAttributes.sfwRelatedControl=e.istrRelatedControl;t.PushItem(u,o.Elements);t.PushItem(o,s.Elements);t.PushItem(s,i.Elements)}var f="asp",u;angular.forEach(n.FieldCollection,e)};n.onSfxGridFinishClick=function(){var i,h,u,o,a,e,c,f,r,l;if(n.IsAddGridWithPanel||t.UndRedoBulkOp("Start"),n.IsAddColumnSelected)n.UpdateGridProperties(),n.AddGridColumns();else{if(n.UpdateGridProperties(),n.UpdateGridFields(),i=null,i=n.cellVM.Name=="sfwButtonGroup"?n.cellVM:GetVM("sfwTable",n.cellVM),i&&i.Name!="sfwButtonGroup"){if(h=GetMaxColCount(i.Elements[0],i),s.length>0){for(u={Name:"sfwRow",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]},u.ParentVM=i,ind=0;ind<h;ind++)e={Name:"sfwColumn",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]},e.ParentVM=u,u.Elements.push(e);o=0;n.IsAddToExistingCell&&(a=n.cellVM.ParentVM,o=n.cellVM.ParentVM.Elements.indexOf(n.cellVM));e=u.Elements[o];c=function(n){n.ParentVM=e;e.Elements.push(n)};angular.forEach(s,c);n.IsAddToExistingCell?(o=i.Elements.indexOf(n.cellVM.ParentVM),t.InsertItem(u,i.Elements,o)):t.PushItem(u,i.Elements)}if(n.IsAddToExistingCell)n.cellVM&&t.PushItem(n.objGridView,n.cellVM.Elements);else{for(f={Name:"sfwRow",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]},f.ParentVM=i,r={Name:"sfwColumn",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]},r.ParentVM=f,n.objGridView.ParentVM=r,r.Elements.push(n.objGridView),f.Elements.push(r),ind=1;ind<h;ind++)r={Name:"sfwColumn",prefix:"swc",Value:"",dictAttributes:{},Elements:[],Children:[]},r.ParentVM=f,f.Elements.push(r);t.PushItem(f,i.Elements)}}i.Name=="sfwButtonGroup"&&n.objGridView&&n.objGridView.dictAttributes&&(s.length>0&&(l=function(n){t.PushItem(n,i.Elements)},angular.forEach(s,l)),t.PushItem(n.objGridView,i.Elements));n.selectControl&&n.selectControl(n.objGridView)}n.onAfterOkGridClick&&n.onAfterOkGridClick();n.onSfxGridCancelClick();n.closeClick&&n.closeClick();n.IsAddGridWithPanel||t.UndRedoBulkOp("End")};n.AddGridColumns=function(){var t,i;n.objGridView&&(t=n.objGridView.Elements.filter(function(n){return n.Name=="Columns"}),t&&t.length>0&&(i=t[0],n.AddGridTemplateColumn(i)))};n.ShowNewParameters=!1;n.ShowOpenParameters=!1;n.ShowOpenLookupParameters=!1;n.ShowOpenMaintenanceParameters=!1;n.showParametersForGrid=function(t){t=="New"?(n.ShowOpenParameters=!1,n.ShowOpenLookupParameters=!1,n.ShowOpenMaintenanceParameters=!1,n.ShowNewParameters=n.ShowNewParameters?!1:!0):t=="Open"?(n.ShowNewParameters&&(n.ShowNewParameters=!1),n.ShowOpenLookupParameters=!1,n.ShowOpenMaintenanceParameters=!1,n.ShowOpenParameters=n.ShowOpenParameters?!1:!0):t=="Lookup"?(n.ShowNewParameters&&(n.ShowNewParameters=!1),n.ShowOpenParameters=!1,n.ShowOpenMaintenanceParameters=!1,n.ShowOpenLookupParameters=n.ShowOpenLookupParameters?!1:!0):t=="Maintenance"&&(n.ShowNewParameters&&(n.ShowNewParameters=!1),n.ShowOpenParameters=!1,n.ShowOpenLookupParameters=!1,n.ShowOpenMaintenanceParameters=n.ShowOpenMaintenanceParameters?!1:!0);n.FieldControlCollection=[];PopulateAvailableControl(n.FieldControlCollection,n.SfxMainTable,n.ShowNewParameters,n.IsAddColumnSelected);t!="Lookup"&&$.connection.hubForm.server.getGlobleParameters().done(function(t){n.$apply(function(){n.objGlobleParameters=t;PopulateGlobalParameters(n.objGlobleParameters,n.FieldControlCollection)})})};n.SelectField=function(t){n.SelectedField=t};n.onChangeGridCheckBox=function(t){t=="New"?(n.FormNewParameters=[],n.objGridView.NewformID="",n.ShowNewParameters=!1):t=="Open"?(n.FormOpenParameters=[],n.objGridView.OpenformID="",n.ShowOpenParameters=!1):t=="OpenLookup"?(n.FormOpenLookupParameters=[],n.objGridView.OpenLookupformID="",n.ShowOpenLookupParameters=!1):t=="OpenMaintenance"&&(n.FormOpenMaintenanceParameters=[],n.objGridView.OpenMaintenanceformID="",n.ShowOpenMaintenanceParameters=!1)};n.isMoveUp=function(){if(n.SelectedField==undefined)return!0;var t=n.FieldCollection.indexOf(n.SelectedField);return t>0?!1:!0};n.isMoveDown=function(){if(n.SelectedField==undefined)return!0;var t=n.FieldCollection.indexOf(n.SelectedField);return t!=n.FieldCollection.length-1&&t!=-1?!1:!0};n.MoveUpField=function(){var t=n.FieldCollection.indexOf(n.SelectedField),i=n.FieldCollection[t-1];n.FieldCollection[t-1]=n.FieldCollection[t];n.FieldCollection[t]=i;n.scrollBySelectedField("#create-result-grid",".selected")};n.MoveDownField=function(){var t=n.FieldCollection.indexOf(n.SelectedField),i=n.FieldCollection[t+1];n.FieldCollection[t+1]=n.FieldCollection[t];n.FieldCollection[t]=i;n.scrollBySelectedField("#create-result-grid",".selected")};n.scrollBySelectedField=function(n,t){f(function(){var i=$(n);if(i&&i.hasScrollBar())return i.scrollTo(i.find(t),{offsetTop:300,offsetLeft:0},null),!1})}}]);app.controller("NavigationParameterOpenWordController",["$scope","$rootScope",function(n,t){n.Init=function(){var i,t,r;if(n.model&&n.model.dictAttributes.sfwNavigationParameter)if(n.model.dictAttributes.sfwNavigationParameter.contains(";"))for(i=n.model.dictAttributes.sfwNavigationParameter.split(";"),t=0;t<i.length;t++)i[t].contains("=")&&(r="",r=i[t].substring(0,i[t].indexOf("=")),r=="TemplateName"?n.TemplateName=i[t].substring(i[t].indexOf("=")+1):r=="TrackingID"&&(n.TrackingID=i[t].substring(i[t].indexOf("=")+1)));else n.model.dictAttributes.sfwNavigationParameter.contains("=")&&(r="",r=n.model.dictAttributes.sfwNavigationParameter.substring(0,n.model.dictAttributes.sfwNavigationParameter.indexOf("=")),r=="TemplateName"?n.TemplateName=n.model.dictAttributes.sfwNavigationParameter.substring(n.model.dictAttributes.sfwNavigationParameter.indexOf("=")+1):r=="TrackingID"&&(n.TrackingID=n.model.dictAttributes.sfwNavigationParameter.substring(n.model.dictAttributes.sfwNavigationParameter.indexOf("=")+1)));n.PopulateCorrespondenceTemplate()};n.onOkClick=function(){var r="",u={ParameterField:"TemplateName",ParameterValue:n.TemplateName},f={ParameterField:"TrackingID",ParameterValue:n.TrackingID},i=[];i.push(u);i.push(f);i.length>0&&(r=n.GetSavedString(i));r!=undefined&&t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter",r);n.onCancelClick()};n.onCancelClick=function(){n.NavigationParameterOpenWordDialog.close()};n.GetSavedString=function(n){var t="";return angular.forEach(n,function(n){var r=n.ParameterField,i=n.ParameterValue,f,u;i!=""&&r!=undefined&&i!=undefined&&i!=""&&r!=undefined&&r!=""&&(f=n.Constants,f&&(i="#"+i),u=i,i.toLowerCase()!=r.toLowerCase()&&(u=r+"="+i),t==""?t=u:t+=";"+u)}),t};n.PopulateCorrespondenceTemplate=function(){$.connection.hubCreateNewObject.server.loadCorrespondenceTemplate(!1).done(function(t){n.receiveCorrespondenceTemplateForForm(t)})};n.receiveCorrespondenceTemplateForForm=function(t){n.$apply(function(){n.lstCorrTemplates=t})};n.Init()}]);app.controller("ParameterNavigationOpenReportController",["$scope","$rootScope",function(n,t){n.iobjReportName={istrReportName:"",iblnConstant:!1};n.iobjReportTemplate={istrReportTemplate:"",iblnConstant:!1};n.Init=function(){var r,i,u,t;if(n.model.dictAttributes.sfwNavigationParameter)for(r=n.model.dictAttributes.sfwNavigationParameter.split(";"),i=0,u=r.length;i<u;i++)r[i]&&(t=r[i].split("="),t[0]=="ReportName"?t[1].indexOf("#")>-1?(n.iobjReportName.iblnConstant=!0,n.iobjReportName.istrReportName=t[1].substring(1,t[1].length)):n.iobjReportName.istrReportName=t[1]:t[1].indexOf("#")>-1?(n.iobjReportTemplate.iblnConstant=!0,n.iobjReportTemplate.istrReportTemplate=t[1].substring(1,t[1].length)):n.iobjReportTemplate.istrReportTemplate=t[1]);$.connection.hubCreateNewObject.server.loadReportData().done(function(t){n.$apply(function(){n.lstReportData=t})})};n.onOkClick=function(){var i="";n.iobjReportName.istrReportName&&(i="ReportName="+(n.iobjReportName.iblnConstant?"#"+n.iobjReportName.istrReportName:n.iobjReportName.istrReportName));n.iobjReportTemplate.istrReportTemplate&&(i+=i==""?"ReportTemplate=":";ReportTemplate=",i+=n.iobjReportTemplate.iblnConstant?"#"+n.iobjReportTemplate.istrReportTemplate:n.iobjReportTemplate.istrReportTemplate);n.model.dictAttributes.sfwNavigationParameter!=i&&t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter",i);n.onCancelClick()};n.onCancelClick=function(){n.ParameterNavigationOpenReportDialog.close()};n.Init()}]);app.controller("GroupExpressionController",["$scope","ngDialog","$rootScope",function(n,t,i){n.lstColumnName=[];n.lstGridColumns=[];n.lstDefualtOrder=["","asc","desc"];n.lstGroupExpression=[];n.lstGroupExpression.push("");n.Init=function(){var t,r,u,i;for(PopulateGridDataField(n.model,n.lstColumnName),t=0;t<n.lstColumnName.length;t++)n.lstGroupExpression.push(t+1);for(t=0;t<n.lstColumnName.length;t++)n.lstGridColumns.push({FieldName:n.lstColumnName[t]});if(n.model.dictAttributes.sfwGroupExpression)for(r=n.model.dictAttributes.sfwGroupExpression.split(","),t=0;t<r.length;t++)for(u=r[t].split(" "),i=0;i<n.lstGridColumns.length;i++)n.lstGridColumns[i].FieldName===u[0]&&(n.lstGridColumns[i].GroupExpression=t+1)};n.okClick=function(){for(var f,o,e,u,s,h,r="",t=0;t<n.lstGridColumns.length;t++)n.lstGridColumns[t].GroupExpression&&(f=n.lstGridColumns[t].GroupExpression,o=f,o>0&&(r+=r?","+f+";"+n.lstGridColumns[t].FieldName:f+";"+n.lstGridColumns[t].FieldName));for(e=[],u=r.split(","),t=0;t<u.length;t++)s=u[t].substring(0,u[t].indexOf(";")).trim(),h=u[t].substring(u[t].indexOf(";")+1).trim(),e.splice(s-1,0,h);r="";angular.forEach(e,function(n){r.length===0?r=n:r+=","+n});i.EditPropertyValue(n.model.dictAttributes.sfwGroupExpression,n.model.dictAttributes,"sfwGroupExpression",r);n.closeClick()};n.closeClick=function(){n.GroupExpressionDialog.close()};n.Init()}]);app.controller("CenterLeftController",["$scope","$filter","$rootScope","$ValidationService","$SgMessagesService",function(n,t,i,r,u){n.Init=function(){if(n.CenterLeft)for(var t=0;t<n.CenterLeft.Elements.length;t++)n.CenterLeft.Elements[t].Name=="sfwTreeView"&&(n.objTreeView=n.CenterLeft.Elements[t],n.objTreeView.objNodes=n.CheckAndCreateModel("Nodes",n.objTreeView));n.objTreeView&&(n.objTreeView.IsExpanded=!1);n.objTreeView&&n.objTreeView.objNodes&&n.objTreeView.objNodes.Elements.length>0&&(n.objTreeView.IsExpanded=!0,n.SelectNodeClick(n.objTreeView.objNodes.Elements[0]));n.IsExpanded=!0};var f={};n.menuOptionsForCenterLeft=[["Add Control",[["sfwTreeNode",function(){n.AddControlCommand("TreeNode")},function(){return!0}],["sfwXmlPanelNode",function(){n.AddControlCommand("XmlPanelNode")},function(){return!0}],]],null,["Delete",function(t){t.nodes&&t.nodes.Name==="sfwTreeNode"?u.Message("Delete","Do you want to delete?",!0,function(i){if(i){var r=n.objTreeView.objNodes.Elements.indexOf(t.nodes);r>-1&&(n.objTreeView.objNodes.Elements.splice(r,1),r<n.objTreeView.objNodes.Elements.length?n.SelectNodeClick(n.objTreeView.objNodes.Elements[r],null):n.objTreeView.objNodes.Elements.length>0?n.SelectNodeClick(n.objTreeView.objNodes.Elements[r-1],null):n.SelectNodeClick(n.objTreeView,null))}}):t.itm&&t.itm.Name==="sfwXMLPanel"&&u.Message("Delete","Do you want to delete?",!0,function(i){if(i){var r=n.CenterLeft.Elements.indexOf(t.itm);r>-1&&(n.CenterLeft.Elements.splice(r,1),n.SelectNodeClick(n.CenterLeft.Elements[0],null))}})},function(t){return t.nodes?n.SelectedNode=t.nodes:t.itm&&(n.SelectedNode=t.itm),t.nodes&&t.nodes.Name==="sfwTreeNode"||t.itm&&t.itm.Name==="sfwXMLPanel"?!0:!1}],null,["Copy",function(n){f=angular.copy(n.nodes,f)},function(n){return n.nodes&&n.nodes.Name==="sfwTreeNode"?!0:!1}],null,["Paste",function(){n.objTreeView.objNodes.Elements.push(f);f=null},function(){if(f&&f.dictAttributes)return!0}],null,["Rename",function(t){var u=n.$new(),f;t.itm&&(u.newRuleID=t.itm.dictAttributes.ID,f=i.showDialog(u,"Edit ID","Entity/views/AddRule.html",{width:500,height:180}),u.addNewRule=function(){n.SelectedNode.dictAttributes.ID=u.newRuleID;u.closeNewRule()},u.closeNewRule=function(){f.close()},u.validateNewGroup=function(){if(u.groupErrorMessageForDisplay="",u.newRuleID){var t=r.findDuplicateId(n.CenterLeft,u.newRuleID,["sfwTreeView","sfwXMLPanel"],"",null,"dictAttributes.ID");if(t)return u.groupErrorMessageForDisplay="Error:Duplicate ID present. Please enter another ID.",!0}else return u.groupErrorMessageForDisplay="Error: ID cannot be empty.",!0})},function(n){return n.nodes&&n.nodes.Name==="sfwTreeNode"?!1:n.nodes||n.itm?!0:!1}],null,];n.AddControlCommand=function(t){t&&(t=="TreeNode"?n.AddTreeNode():t=="XmlPanelNode"&&n.AddXmlPanelNode())};n.AddTreeNode=function(){var t;n.CenterLeft&&(n.objTreeView&&n.objTreeView.objNodes?(t={Name:"sfwTreeNode",Value:"",dictAttributes:{},Elements:[]},n.objTreeView.objNodes.Elements.push(t)):(n.objTreeView={Name:"sfwTreeView",Value:"",dictAttributes:{},Elements:[]},n.objTreeView.dictAttributes.ID="trvCenterLeft",n.objTreeView.IsExpanded=!0,n.objTreeView.objNodes={Name:"Nodes",Value:"",dictAttributes:{},Elements:[]},n.objTreeView.Elements.push(n.objTreeView.objNodes),t={Name:"sfwTreeNode",Value:"",dictAttributes:{},Elements:[]},n.objTreeView.objNodes.Elements.push(t),n.CenterLeft.Elements.push(n.objTreeView)),n.SelectNodeClick(t,null))};n.CheckAndCreateModel=function(n,t){var i=undefined,r=t.Elements.filter(function(t){return t.Name===n});return r&&r.length>0?i=r[0]:(i={Name:n,Value:"",dictAttributes:{},Elements:[]},t.Elements.push(i)),i};n.AddXmlPanelNode=function(){var t=null;t={Name:"sfwXMLPanel",Value:"",dictAttributes:{},Elements:[]};t.dictAttributes.ID=GetNewStepName("XmlPanelNode",n.CenterLeft,1);n.CenterLeft.Elements.push(t);n.SelectNodeClick(t,null)};n.togglebuttonForTreeView=function(n){n.IsExpanded=!n.IsExpanded};n.toggleRootNode=function(){n.togglebuttonForTreeView(n)};n.SelectNodeClick=function(t,i){n.SelectedNode=t;i!=null&&i.stopPropagation()};n.onNavigationParamsClick=function(){var t=n.$new();n.SelectedNode&&(t.SelectedObject=n.SelectedNode,t.IsForm=!0,t.IsMultiActiveForm=!1,t.formobject=n.formmodel,t.NavigationParameterDialog=i.showDialog(t,"Navigation Parameters","Form/views/ParameterNavigation.html",{width:1e3,height:520}))};n.Init()}]);app.controller("BindToQueryController",["$scope","$rootScope","ngDialog","$GetEntityFieldObjectService","$Entityintellisenseservice","$getModelList","$EntityIntellisenseFactory",function(n,t,r,u,f,e,o){n.lstQueryLoadType=["Solution","New and Update","New","Update"];n.IsGridChildOfListView=!1;n.entityName=n.formobject.dictAttributes.sfwEntity;n.getParentEntityName=function(t){var e,f,r,i;n.formobject&&t&&(t.dictAttributes.sfwParentGrid?(e=FindControlByID(n.formobject,t.dictAttributes.sfwParentGrid),f=u.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,e.dictAttributes.sfwEntityField),f&&(n.entityName=f.Entity)):t.IsGridChildOfListView&&(n.IsGridChildOfListView=!0,t.Name=="sfwGridView"?(r=FindParent(t,"sfwListView"),r&&(i=u.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,r.dictAttributes.sfwEntityField),i&&(n.entityName=i.Entity))):t.Name=="sfwColumn"?(r=FindParent(t,"sfwListView"),r&&(i=u.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,r.dictAttributes.sfwEntityField),i&&(n.entityName=i.Entity))):t.Name=="sfwListView"&&(i=u.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,t.dictAttributes.sfwEntityField),i&&(n.entityName=i.Entity))))};n.model?(n.blnBoundToQuery=n.model.dictAttributes.sfwBoundToQuery,n.strQueryLoadType=n.model.dictAttributes.sfwQueryLoadType,n.strBaseQuery=n.model.dictAttributes.sfwBaseQuery,n.strEntityField=n.model.dictAttributes.sfwEntityField,n.getParentEntityName(n.model)):n.dropdata&&n.getParentEntityName(n.dropdata);n.lstMappedFields=[];n.objTempGrid={};n.lstQueryFields=[];n.GridEntityName;n.onBindToQuerySaveClick=function(){var o,s,r,e,h,c,f;n.IsAddNewGrid?(o=n.dropdata,o&&(s=GetVM("sfwColumn",o),s&&(r=n.$new(),r.objGridView={Name:"sfwGridView",prefix:"swc",Value:"",dictAttributes:{sfwEntityField:n.strEntityField,sfwBoundToQuery:n.blnBoundToQuery,sfwQueryLoadType:n.strQueryLoadType,sfwBaseQuery:n.strBaseQuery},Elements:[],Children:[]},e=n.formobject.Elements.filter(function(n){return n.Name==="sfwTable"}),r.objGridView.LstDisplayedEntities=[],r.objGridView.lstselectedmultiplelevelfield=[],r.objGridView.selectedentityobjecttreefields=[],r.cellVM=s,r.IsAddToExistingCell=!0,r.IsAddFromToolBox=!0,r.IsAddGridWithPanel=n.IsAddGridWithPanel,r.selectedEntityField=n.SelectedField,r.FormModel=n.formobject,h=u.GetEntityFieldObjectFromEntityField(n.entityName,n.strEntityField),h&&(r.ParentEntityName=h.Entity),e&&e.length>0&&(r.SfxMainTable=e[0]),r.title="Create New Grid",n.formobject.dictAttributes.sfwType=="Tooltip"&&(r.skipSecondStep=!0),r.IsPrototype=r.FormModel&&r.FormModel.dictAttributes.ID.startsWith("wfp")?!0:!1,r.objGridDialog=t.showDialog(r,r.title,"Form/views/CreateGridViewControl.html",{width:1e3,height:700}),r.setTitle=function(n){r.title&&(r.title=n,r.objGridDialog.updateTitle(r.title))}))):(t.UndRedoBulkOp("Start"),t.EditPropertyValue(n.model.dictAttributes.sfwEntityField,n.model.dictAttributes,"sfwEntityField",n.strEntityField),t.EditPropertyValue(n.model.dictAttributes.sfwBoundToQuery,n.model.dictAttributes,"sfwBoundToQuery",n.blnBoundToQuery),t.EditPropertyValue(n.model.dictAttributes.sfwQueryLoadType,n.model.dictAttributes,"sfwQueryLoadType",n.strQueryLoadType),t.EditPropertyValue(n.model.dictAttributes.sfwBaseQuery,n.model.dictAttributes,"sfwBaseQuery",n.strBaseQuery),n.model.dictAttributes.sfwBoundToQuery==="True"&&!n.model.dictAttributes.sfwBaseQuery&&n.objgridboundedquery&&n.$evalAsync(function(){n.objgridboundedquery.IsQuery=!1}),c=n.model.Elements.length>0?n.model.Elements[0].Elements:null,c&&angular.forEach(c,function(r){if(r.Elements.length>0){var u=r.Elements[0];angular.forEach(u.Elements,function(r){if(r.dictAttributes.sfwEntityField)for(i=0;i<n.lstMappedFields.length;i++)if(n.lstMappedFields[i].GridControl==r.dictAttributes.sfwEntityField){t.EditPropertyValue(r.dictAttributes.sfwEntityField,r.dictAttributes,"sfwEntityField",n.lstMappedFields[i].MappedControl);break}})}}),f=getCurrentFileScope(),f&&(f.selectControl&&f.selectControl(n.model,event),f.LoadDetails&&f.LoadDetails(!0)),t.UndRedoBulkOp("End"),n.onCancelClick())};n.onAfterOkGridClick=function(){n.onAfterOkClick&&n.onAfterOkClick()};n.onCancelClick=function(){n.BindToQueryDialog.close()};n.ValidateGridView=function(){var t=!1,i,e,r;if(n.ErrorMessage="",n.blnBoundToQuery&&n.blnBoundToQuery.toLowerCase()=="true")if(n.strBaseQuery)if(n.strBaseQuery.contains(".")){if(i=n.strBaseQuery.split("."),i&&i.length==2){var s=i[0],h=i[1],c=o.getEntityIntellisense(),f=c.filter(function(n){return n.ID==s});f&&f.length>0?(e=f[0],e.Queries.some(function(n){return n.ID==h})||(n.ErrorMessage="Error: Invalid Query",retValue=!0)):(n.ErrorMessage="Error: Invalid Query",retValue=!0)}}else t=!0,n.ErrorMessage="Error: Invalid Query";else t=!0,n.ErrorMessage="Error: Select Base Query For a Grid";else n.formobject&&n.formobject.dictAttributes.sfwType!=="Lookup"&&n.formobject.dictAttributes.sfwType!=="FormLinkLookup"&&(n.strEntityField?(r=u.GetEntityFieldObjectFromEntityField(n.entityName,n.strEntityField),r?r&&r.DataType!=="Collection"&&r.DataType!=="List"&&(n.ErrorMessage="Error: Select valid collection for a grid.",t=!0):(n.ErrorMessage="Error: Select valid collection for a grid.",t=!0)):(t=!0,n.ErrorMessage="Error: Select Collection For a Grid"));return t};n.BoundToQueryChange=function(){n.lstMappedFields=[];n.blnBoundToQuery&&n.blnBoundToQuery.toLowerCase()=="true"?n.strEntityField="":(n.strQueryLoadType="",n.strBaseQuery="")};n.ExecuteQueryClick=function(){var o,t,r;n.lstMappedFields=[];n.objTempGrid=GetBaseModel(n.model);n.strEntityField||!n.blnBoundToQuery&&(n.formobject.dictAttributes.sfwType==="Lookup"||n.formobject.dictAttributes.sfwType==="FormLinkLookup")?(r=u.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,n.strEntityField),r?t=r.Entity:(n.formobject.dictAttributes.sfwType==="Lookup"||n.formobject.dictAttributes.sfwType==="FormLinkLookup")&&(t=n.formobject.dictAttributes.sfwEntity),n.GridEntityName=t,n.objTempGrid.Elements.length>0&&(o=n.objTempGrid.Elements[0].Elements,o&&angular.forEach(o,function(r){if(r.Elements.length>0){var e=r.Elements[0];angular.forEach(e.Elements,function(r){var o,e,s;if(r.dictAttributes.sfwEntityField&&r.Name!=="cellformat"){if(o=!1,n.blnBoundToQuery=="False"){if(e=f.GetIntellisenseData(t,"","",!0,!0,!1,!1,!1,!1),e)for(i=0;i<e.length;i++)if(e[i].Value==r.dictAttributes.sfwEntityField){o=!0;n.lstMappedFields.push({GridControl:r.dictAttributes.sfwEntityField,MappedControl:e[i].ID});break}}else t&&(s=u.GetEntityFieldObjectFromEntityField(t,r.dictAttributes.sfwEntityField)),s&&(o=!0,n.lstMappedFields.push({GridControl:r.dictAttributes.sfwEntityField,MappedControl:r.dictAttributes.sfwEntityField}));o||(n.lstMappedFields.push({GridControl:r.dictAttributes.sfwEntityField,MappedControl:""}),r.dictAttributes.sfwEntityField="")}})}}))):n.strBaseQuery&&n.objTempGrid&&(r=u.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,n.objTempGrid.dictAttributes.sfwEntityField),r&&(t=r.Entity),$.connection.hubForm.server.getEntityQueryColumns(n.strBaseQuery,"dummy").done(function(r){n.$evalAsync(function(){if(r&&n.objTempGrid.Elements.length>0){n.lstQueryFields=e.getModelListFromQueryFieldlist(r);var f=n.objTempGrid.Elements[0].Elements;f&&angular.forEach(f,function(f){if(f.Elements.length>0){var e=f.Elements[0];angular.forEach(e.Elements,function(f){var o,e;if(f.dictAttributes.sfwEntityField&&f.Name!=="cellformat")if(t)if(o=u.GetEntityFieldObjectFromEntityField(t,f.dictAttributes.sfwEntityField),o){for(e=!1,i=0;i<r.length;i++)if(r[i].CodeID==o.Value){e=!0;n.lstMappedFields.push({GridControl:f.dictAttributes.sfwEntityField,MappedControl:r[i].CodeID});break}e||n.lstMappedFields.push({GridControl:f.dictAttributes.sfwEntityField,MappedControl:""})}else n.lstMappedFields.push({GridControl:f.dictAttributes.sfwEntityField,MappedControl:""});else{for(e=!1,i=0;i<r.length;i++)if(r[i].CodeID==f.dictAttributes.sfwEntityField){e=!0;n.lstMappedFields.push({GridControl:f.dictAttributes.sfwEntityField,MappedControl:r[i].CodeID});break}e||n.lstMappedFields.push({GridControl:f.dictAttributes.sfwEntityField,MappedControl:""})}})}})}})}))};n.setRowSelection=function(t){n.selectedfield=t}}]);app.directive("baseControlView",["$compile","CONSTANTS","$rootScope","$EntityIntellisenseFactory","$GetEntityFieldObjectService","$ValidationService","$SgMessagesService",function(n,t,i,r,u,f,e){return{restrict:"E",replace:!0,scope:{model:"=",formodel:"=",objparent:"=",lstloadedentitytrees:"=",lstloadedentitycolumnstree:"=",lstdisplayentities:"=",entitytreename:"=",buttonsCollection:"="},template:"<div context-menu='controlmenuOptions' class='form-control-wrapper' ng-class='{\"form-invisible-control\" : model.dictAttributes.Visible === \"False\"}'>  <span show-errors model='model'><\/span> <\/div>",link:{pre:function(t,i){t.model.Name=="sfwTextBox"||t.model.Name=="sfwLabel"||t.model.Name=="sfwDropDownList"||t.model.Name=="sfwMultiSelectDropDownList"||t.model.Name=="sfwCascadingDropDownList"?i.append("<editable-control-directive model='model' formodel='formodel' lstloadedentitycolumnstree='lstloadedentitycolumnstree' />"):t.model.Name=="sfwGridView"?i.append("<grid-control-directive model='model' formodel='formodel' objparent='objparent' lstloadedentitytrees='lstloadedentitytrees' lstloadedentitycolumnstree='lstloadedentitycolumnstree' lstdisplayentities='lstdisplayentities' entitytreename='entitytreename'  buttons-collection='buttonsCollection'/>"):t.model.Name=="sfwTable"?i.append("<table-control-directive model='model' formodel='formodel' objparent='objparent' lstloadedentitytrees='lstloadedentitytrees' lstloadedentitycolumnstree='lstloadedentitycolumnstree' lstdisplayentities='lstdisplayentities' entitytreename='entitytreename'  buttons-collection='buttonsCollection'/>"):t.model.Name=="sfwTabContainer"?i.append("<tabcontainer-control-directive model='model' formodel='formodel' objparent='objparent' lstloadedentitytrees='lstloadedentitytrees' lstloadedentitycolumnstree='lstloadedentitycolumnstree' lstdisplayentities='lstdisplayentities' entitytreename='entitytreename'  buttons-collection='buttonsCollection'/>"):t.model.Name=="udc"?i.append("<usercontrol-control-directive model='model' formodel='formodel' objparent='objparent' lstloadedentitytrees='lstloadedentitytrees' lstloadedentitycolumnstree='lstloadedentitycolumnstree' lstdisplayentities='lstdisplayentities' entitytreename='entitytreename' buttons-collection='buttonsCollection'/>"):t.model.Name=="sfwPanel"||t.model.Name=="sfwDialogPanel"||t.model.Name=="sfwListView"?i.append("<childpanel-control-directive model='model' formodel='formodel' objparent='objparent' lstloadedentitytrees='lstloadedentitytrees' lstloadedentitycolumnstree='lstloadedentitycolumnstree' lstdisplayentities='lstdisplayentities' entitytreename='entitytreename'  buttons-collection='buttonsCollection'/>"):t.model.Name=="sfwButtonGroup"?i.append("<emptyparent-control-directive><\/emptyparent-control-directive>"):i.append("<common-control-directive model='model' formodel='formodel'/>");n(i.contents())(t)},post:function(n){n.objparent&&(n.model.ParentVM=n.objparent);n.controlmenuOptions=[["Create Compatible Caption",function(){n.model&&n.OnCreateCompatibleLabelClick(n.model,n.formodel,r,i)},function(t,i){return n.model.Name=="sfwTable"?!1:(t.tabs?n.selectControl(t.tabs,i,n.formodel):selectControl(n.model,i,n.formodel),n.model&&n.model.dictAttributes.sfwIsCaption||n.IsDataView?!1:n.model&&(n.model.Name=="sfwGridView"||n.model.Name=="sfwChart"||n.model.Name=="sfwPanel"||n.model.Name=="sfwDialogPanel"||n.model.Name=="sfwButton"||n.model.Name=="sfwLinkButton"||n.model.Name=="sfwImageButton"||n.model.Name=="sfwTabContainer"||n.model.Name=="sfwTabSheet"||n.model.Name=="udc"||n.model.Name=="sfwListViewer"||n.model.Name=="sfwButtonGroup")?!1:FindParent(n.model,"sfwGridView")||FindParent(n.model,"sfwButtonGroup")?!1:hasCaption(n.model)?!1:!0)}],["Cut Control",function(){n.model&&n.OnCutControlClick(n.model)},function(){return n.model.Name=="sfwTable"?!1:n.formodel&&n.formodel.dictAttributes.sfwType=="Lookup"&&n.model&&(n.model.Name=="sfwTabContainer"||n.model.Name=="sfwGridView")||n.IsDataView||n.model.Name=="sfwToolTipButton"?!1:!0},null,"Ctrl+X"],["Copy Control",function(){n.model&&n.OnCopyControlClick(n.model)},function(){return n.model.Name=="sfwTable"?!1:n.formodel&&n.formodel.dictAttributes.sfwType=="Lookup"&&n.model&&(n.model.Name=="sfwTabContainer"||n.model.Name=="sfwGridView")||n.IsDataView||n.model.Name=="sfwToolTipButton"?!1:!0},null,"Ctrl+C"],["Delete Control",function(){n.model&&n.OnDeleteControlClick(n.model)},function(){return n.model.Name=="sfwTable"?!1:n.formodel&&n.formodel.dictAttributes.sfwType=="Lookup"&&n.model.Name=="sfwTabContainer"||n.IsDataView?!1:n.formodel&&n.formodel.dictAttributes.sfwType=="Lookup"&&n.model.Name=="sfwGridView"&&!n.formodel.IsLookupCriteriaEnabled?!1:!0}],["Add Control",function(t){t.model&&n.openChangeControlDialog("addcontrol",t.model)},function(){return n.model.Name=="sfwButtonGroup"?!0:!1}],["Change Control",function(){n.model&&n.openChangeControlDialog("changecontrol",null)},function(){return n.model.Name=="sfwTable"?!1:n.model&&(n.model.Name=="sfwTabContainer"||n.model.Name=="sfwCheckBoxList"||n.model.Name=="sfwChart"||n.model.Name=="sfwGridView"||n.model.Name=="sfwPanel"||n.model.Name=="sfwDialogPanel"||n.model.Name=="sfwListView"||n.model.Name=="sfwScheduler"||n.model.Name=="sfwCalendar"||n.model.Name=="sfwSoftErrors")||n.IsDataView?!1:!0}],["Add Columns",function(){n.model&&n.OnAddGridColumns()},function(){return n.model.Name=="sfwTable"?!1:n.model&&n.model.Name=="sfwGridView"&&!n.IsDataView?!0:!1}],["Paste Control",function(){n.model&&n.OnPasteControl(n.model)},function(){return FindParent(n.model,"sfwGridView")||n.model.Name=="sfwButtonGroup"?!0:!1},null,"Ctrl+V"],["Clear Cell",function(n){for(var t=n.model;t.Name!="sfwColumn";){if(t.ParentVM==null)break;t=t.ParentVM}t.Name=="sfwColumn"&&ClearCell(t,i,!0)},function(t){return n.model.Name=="sfwTable"?!1:n.formodel&&n.formodel.dictAttributes.sfwType=="Lookup"&&n.model.Name=="sfwGridView"&&!n.formodel.IsLookupCriteriaEnabled?!1:n.CanShowContextMenu(t.model,t.formodel)}],["Clear Panel",function(t){if(t.model){var i=FindParent(t.model,"sfwColumn",!0),r=i.ParentVM.ParentVM;n.OnClearGridClick(r)}},function(t){return n.model.Name=="sfwTable"?!1:n.formodel&&n.formodel.dictAttributes.sfwType=="Lookup"&&!n.formodel.IsLookupCriteriaEnabled?!1:n.CanShowContextMenu(t.model,t.formodel)},null,"Shift+Del"],["Delete Row",function(t){var i,r,u;if(t.model){for(i=t.model;i.Name!="sfwColumn";){if(i.ParentVM==null)break;i=i.ParentVM}i.Name=="sfwColumn"&&(r=i.ParentVM.ParentVM,u=i.ParentVM,n.OnDeleteRowClick(u,r))}},function(t){return n.model.Name=="sfwTable"?!1:n.formodel&&n.formodel.dictAttributes.sfwType=="Lookup"&&n.model.Name=="sfwGridView"&&!n.formodel.IsLookupCriteriaEnabled?!1:n.CanShowContextMenu(t.model,t.formodel)},null,null,"Ctrl+Del"],["Delete Column",function(t){var i,r;if(t.model){for(i=t.model;i.Name!="sfwColumn";){if(i.ParentVM==null)break;i=i.ParentVM}i.Name=="sfwColumn"&&(r=i.ParentVM.ParentVM,n.OnDeleteColumnClick(i,r))}},function(t){return n.model.Name=="sfwTable"?!1:n.formodel&&n.formodel.dictAttributes.sfwType=="Lookup"&&n.model.Name=="sfwGridView"&&!n.formodel.IsLookupCriteriaEnabled?!1:n.CanShowContextMenu(t.model,t.formodel)},null,null,"Ctrl+Shift+Del"],["Insert",[["Row Above ",function(t){var i,r;if(t.model){for(i=t.model;i.Name!="sfwColumn";){if(i.ParentVM==null)break;i=i.ParentVM}i.Name=="sfwColumn"&&(r=i.ParentVM.ParentVM,n.OnInsertRowAboveClick(i,r))}},null,null,"Ctrl+Shift+A"],["Row Below",function(t){var i,r;if(t.model){for(i=t.model;i.Name!="sfwColumn";){if(i.ParentVM==null)break;i=i.ParentVM}i.Name=="sfwColumn"&&(r=i.ParentVM.ParentVM,n.OnInsertRowBelowClick(i,r))}},null,null,"Ctrl+Shift+B"],["Column Left",function(t){var i,r;if(t.model){for(i=t.model;i.Name!="sfwColumn";){if(i.ParentVM==null)break;i=i.ParentVM}i.Name=="sfwColumn"&&(r=i.ParentVM.ParentVM,n.OnInsertColumnLeftClick(i,r))}},null,null,"Ctrl+Shift+L"],["Column Right",function(t){var i,r;if(t.model){for(i=t.model;i.Name!="sfwColumn";){if(i.ParentVM==null)break;i=i.ParentVM}i.Name=="sfwColumn"&&(r=i.ParentVM.ParentVM,n.OnInsertColumnRightClick(i,r))}},null,null,"Ctrl+Shift+R"],],function(t){return n.model.Name=="sfwTable"?!1:n.CanShowContextMenu(t.model,t.formodel)}],["Move",[["Row Up",function(t){var i,r;if(t.model){for(i=t.model;i.Name!="sfwColumn";){if(i.ParentVM==null)break;i=i.ParentVM}i.Name=="sfwColumn"&&(r=i.ParentVM.ParentVM,n.OnMoveRowUpClick(i,r))}},null,null,"Ctrl+U"],["Row Down",function(t){var i,r;if(t.model){for(i=t.model;i.Name!="sfwColumn";){if(i.ParentVM==null)break;i=i.ParentVM}i.Name=="sfwColumn"&&(r=i.ParentVM.ParentVM,n.OnMoveRowDownClick(i,r))}},null,null,"Ctrl+D"],["Column Left",function(t){var i,r;if(t.model){for(i=t.model;i.Name!="sfwColumn";){if(i.ParentVM==null)break;i=i.ParentVM}i.Name=="sfwColumn"&&(r=i.ParentVM.ParentVM,n.OnMoveColumnLeftClick(i,r))}},null,null,"Ctrl+L"],["Column Right",function(t){var i,r;if(t.model){for(i=t.model;i.Name!="sfwColumn";){if(i.ParentVM==null)break;i=i.ParentVM}i.Name=="sfwColumn"&&(r=i.ParentVM.ParentVM,n.OnMoveColumnRightClick(i,r))}},null,null,"Ctrl+R"],],function(t){return n.model.Name=="sfwTable"?!1:n.CanShowContextMenu(t.model,t.formodel)}],["Constraint",function(){var t,f,c,s,h,o;n.entitytreename?(t=n.entitytreename,f=u.GetEntityFieldObjectFromEntityField(t,n.model.dictAttributes.sfwEntityField),f&&f.DeclaringEntity&&(t=f.DeclaringEntity),c=i.lstopenedfiles.some(function(n){if(n.file.FileName==t)return!0}),c?e.Message("Close Entity","Entity file is currently open. Please close the entity file and try again."):(s=r.getEntityIntellisense().filter(function(n){return n.ID===t})[0],s?(h=n.model.dictAttributes.sfwEntityField.split("."),o=s.Attributes.filter(function(n){return n.ID===h[h.length-1]})[0],o?["column","property"].indexOf(o.Type.toLowerCase())===-1?e.Message("Invalid Attribute","Constraint can be added only for properties and columns."):addEditAttributeConstraint(n,o.ID,null,t,!0):e.Message("Invalid Attribute","Please set the valid attribute for the control.")):e.Message("Invalid Entity","Please set the valid entity."))):e.Message("Entity Not Set","Please set the entity for form.")},function(){var t=!1;return n.model.dictAttributes.sfwEntityField&&["sfwGridView","sfwChart","sfwCalendar","sfwScheduler","sfwListView","sfwCheckBoxList"].indexOf(n.model.Name)===-1&&(t=!0),t}],];n.OnCreateCompatibleLabelClick=function(t){if(t){var u=t;CreateCompatibleLabel(u,n.formodel,r,i)}};n.OnAddControlToCellClick=function(t,r,e){var h,c,l,s,o;r&&(h=r,h=="sfwButton"?(o=n.$new(!0),o.item=t,o.formodel=n.formodel,o.CreateButtonDialog=i.showDialog(o,"Button Details","Form/views/CreateButtonWizard/CreateButtonControl.html",{width:660,height:550})):h=="sfwListView"?(n.ErrorMessageForDisplay="",c=CreateControlID(n.formodel,"RepeaterViewPanel","sfwListView"),l="swc",n.objRepeaterControl={Name:"sfwListView",value:"",prefix:l,dictAttributes:{ID:c},Elements:[],Children:[]},n.ParentEntityName=formodel.dictAttributes.sfwEntity,n.objRepeaterControl.selectedobjecttreefield,n.objRepeaterControl.lstselectedobjecttreefields=[],s=n.$new(!0),s.objRepeaterControl=n.objRepeaterControl,s.objRepeaterControl.LstDisplayedEntities=[],s.ParentEntityName=n.ParentEntityName,s.RepeaterControldialog=i.showDialog(s,"Repeater Control","Form/views/RepeaterControlTemplate.html",{width:500,height:600})):(o=n.$new(),AddControlToCell(t,h,undefined,e,n.formodel,n.model,i,o,f,u)))};n.openChangeControlDialog=function(r,u,f){var e=n.$new(!0),h=n.model,c,s,a,o,l;u&&(h=u);e.errorMessage="";e.formType=n.formodel.dictAttributes.sfwType;e.controlName="";e.config={formModel:n.formodel,actionType:r};e.lstControls=t.FORM.CONTROL_TYPES;e.lstButtons=angular.copy(n.buttonsCollection);c="Add Control";r=="changecontrol"&&(o=e.lstControls.filter(function(t){if(t&&n.model&&t.method!=n.model.Name)return t}),e.lstControls=o,c="Change Control");(h.IsChildOfGrid||f)&&e.lstControls&&e.lstControls.length>0?(o=e.lstControls.filter(function(n){if(n&&n.allowInParent.indexOf("sfwGrid")>-1)return n}),e.lstControls=o,s=undefined,s=n.model&&n.model.Name=="sfwGridView"?n.model:FindParent(h,"sfwGridView"),(e.formType.toLowerCase()=="lookup"||s&&s.dictAttributes.sfwBoundToQuery&&s.dictAttributes.sfwBoundToQuery.toLowerCase()=="true")&&(a=["sfwCascadingDropDownList","sfwTextBox","sfwSwitchCheckBox","sfwRadioButtonList","sfwRadioButton","sfwMultiSelectDropDownList","sfwDropDownList","sfwCheckBoxList","sfwCheckBox","sfwDateTimePicker"],o=e.lstControls.filter(function(n){if(n&&a.indexOf(n.method)<=-1)return n}),e.lstControls=o)):!h.IsChildOfGrid&&e.lstControls&&e.lstControls.length>0&&(o=e.lstControls.filter(function(n){if(n&&n.allowInParent.indexOf("all")>-1)return n}),e.lstControls=o);n.formodel.IsLookupCriteriaEnabled&&e.lstControls&&e.lstControls.length>0&&(o=e.lstControls.filter(function(n){if(n&&n.method!="sfwLabel"&&n.method!="sfwToolTipButton")return n}),e.lstControls=o);e.selectedControl={};e.selectedControl.control=null;e.controltype="basic";e.customButton={};e.customButton.methodName="";e.disableOkBtn=function(){if(e.errorMessage="",e.selectedControl.control||e.controltype=="customButton")if(e.customButton.methodName||e.controltype!="customButton"){if(!isValidIdentifier(e.customButton.methodName,!1,!1)&&e.controltype=="customButton")return e.errorMessage="Invalid method name",!0}else return e.errorMessage="Enter method name",!0;else return!0;return!1};l=function(){return e.lstButtons=angular.copy(n.buttonsCollection),n.model.Name=="sfwButton"?e.lstButtons.filter(function(t){if(t&&n.model&&n.model.Name=="sfwButton"&&t.Method!=n.model.dictAttributes.sfwMethodName)return t}):e.lstButtons};e.$watch("controltype",function(n,t){if(e.customButton.methodName="",e.selectedControl.control=null,n!=t&&n=="sfwButton"||n=="sfwLinkButton")e.lstButtons=l();else if(n=="sfwImageButton"){e.lstButtons=l();var i=e.lstButtons.filter(function(n){return n.Method=="btnRetrieve_Click"});i&&i.length==0&&e.lstButtons.push({Description:"Retrieve Button",Method:"btnRetrieve_Click"})}});e.selectControlClick=function(n){e.selectedControl.control=n};e.onOkButton=function(t){e.controltype=="basic"?r=="addcontrol"?n.OnAddControlToCellClick(u,t.method,f):r=="changecontrol"&&n.OnChangeControlClick(t.method):e.controltype=="customButton"?r=="addcontrol"?n.OnAddControlToCellClick(u,"sfwButton."+e.customButton.methodName,f):r=="changecontrol"&&n.OnChangeControlClick("sfwButton."+e.customButton.methodName):(e.controltype=="sfwButton"||e.controltype=="sfwLinkButton"||e.controltype=="sfwImageButton")&&(r=="addcontrol"?n.OnAddControlToCellClick(u,e.controltype+"."+t.Method,f):r=="changecontrol"&&n.OnChangeControlClick(e.controltype+"."+t.Method));e.changeControlDialog.close()};e.closeDialog=function(){e.changeControlDialog.close()};e.changeControlDialog=i.showDialog(e,c,"Form/views/change_control.html",{width:500,height:600})};n.OnChangeControlClick=function(t){var l,r,u,o,s,h,e,c,f;if(t){if(l=n.model.dictAttributes.ID,r=CreateControl(n.formodel,n.model,t),persistAttributes(n.model,r),n.formodel&&n.formodel.dictAttributes.sfwType==="Lookup"&&n.model.Name==="sfwLabel"&&n.model.IsChildOfGrid&&n.model.dictAttributes.sfwRelatedControl&&(n.model.dictAttributes.sfwRelatedControl=""),i.lstWebControls&&i.lstWebControls.length>0&&r.Name&&n.model.dictAttributes&&n.model.Name!="sfwButton"&&n.model.Name!="sfwLinkButton"&&n.model.Name!="sfwImageButton"&&r.Name!="sfwButton"&&r.Name!="sfwLinkButton"&&r.Name!="sfwImageButton"&&(u=i.lstWebControls.filter(function(n){return n.ControlName==r.Name}),u=JSON.parse(JSON.stringify(u)),u&&u.length>0&&u[0].lstCustom&&(angular.forEach(n.model.dictAttributes,function(n,t){var i,f;t!="sfwIsSwitch"&&(i=u[0].lstCustom.filter(function(n){return n.PropertyName==t}),i&&i.length>0?r.dictAttributes[t]=n:u[0].lstExtra&&(f=u[0].lstExtra.filter(function(n){return n.PropertyName==t}),f&&f.length>0&&(r.dictAttributes[t]=n)))}),r&&(r.Name=="sfwDropDownList"||r.Name=="sfwCascadingDropDownList"||r.Name=="sfwMultiSelectDropDownList"||r.Name=="sfwListPicker"||r.Name=="sfwListBox"||r.Name=="sfwRadioButtonList"||r.Name=="sfwCheckBoxList"||r.Name=="sfwSourceList")&&n.model.Elements&&n.model.Elements.length>0&&(o=n.model.Elements.filter(function(n){return n.Name&&n.Name=="ListItem"}),o&&o.length>0&&angular.forEach(o,function(n){r.Elements.push(n)})),r&&r.Name=="sfwCascadingDropDownList"?(r.dictAttributes.sfwParameters=n.model.dictAttributes&&n.model.dictAttributes.sfwNavigationParameter?n.model.dictAttributes.sfwNavigationParameter:"",r.dictAttributes.sfwCascadingRetrievalParameters=n.model.dictAttributes&&n.model.dictAttributes.sfwParameters?n.model.dictAttributes.sfwParameters:""):r&&n.model.Name=="sfwCascadingDropDownList"?(n.model.dictAttributes&&(s=u[0].lstCustom.filter(function(n){return n.PropertyName=="sfwNavigationParameter"}),r.dictAttributes.sfwNavigationParameter=s&&s.length>0&&n.model.dictAttributes.sfwParameters?n.model.dictAttributes.sfwParameters:""),n.model.dictAttributes&&(h=u[0].lstCustom.filter(function(n){return n.PropertyName=="sfwParameters"}),r.dictAttributes.sfwParameters=h&&h.length>0&&n.model.dictAttributes.sfwCascadingRetrievalParameters?n.model.dictAttributes.sfwCascadingRetrievalParameters:"")):r&&r.Name=="sfwSoftErrors"?r.dictAttributes.sfwEntityField="InternalErrors":r&&r.Name=="sfwEmployerSoftErrors"&&(r.dictAttributes.sfwEntityField="ExternalErrors"))),!r)return;if(i.UndRedoBulkOp("Start"),i.DeleteItem(n.model,n.model.ParentVM.Elements),n.ChangeControl(r),n.model.ParentVM!=null){for(e=n.model.ParentVM;e.Name!="sfwTable";){if(e.ParentVM==null)break;e=e.ParentVM}e!=null&&e.Name=="sfwTable"&&(c=n.GetControl(e,l),c!=null&&(c.dictAttributes.AssociatedControlID=r.dictAttributes.ID))}f=FindParent(n.model,"sfwGridView");f&&n.formodel&&n.formodel.dictAttributes.sfwType!="Lookup"&&r.Name!="sfwLabel"&&r.Name!="sfwButton"&&r.Name!="sfwLinkButton"&&r.Name!="sfwImageButton"&&r.Name!=="sfwButtonGroup"&&(i.EditPropertyValue(f.dictAttributes.sfwTwoWayBinding,f.dictAttributes,"sfwTwoWayBinding","True"),i.EditPropertyValue(f.dictAttributes.AllowEditing,f.dictAttributes,"AllowEditing","True"),i.EditPropertyValue(f.dictAttributes.sfwCommonFilterBox,f.dictAttributes,"sfwCommonFilterBox","False"),i.EditPropertyValue(f.dictAttributes.sfwFilterOnKeyPress,f.dictAttributes,"sfwFilterOnKeyPress","False"));SetFormSelectedControl(n.formodel,r);i.UndRedoBulkOp("End")}};n.OnCustomBtnChangeControlClick=function(){var t=n.$new(!0);t.button={};t.button.methodName="";t.errorMessage="";t.onBtnOkClick=function(){n.OnChangeControlClick("sfwButton."+t.button.methodName);t.addBtnDialog.close()};t.validateBtnMethod=function(){if(t.errorMessage="",t.button.methodName){if(!isValidIdentifier(t.button.methodName,!1,!1))return t.errorMessage="Invalid method name",!0}else return t.errorMessage="Enter method name",!0;return!1};t.addBtnDialog=i.showDialog(t,"Custom Button","Form/views/AddCustomMethod.html",{width:300,height:250})};n.GetControl=function(t,i){var r=null;return angular.forEach(t.Elements,function(t){angular.forEach(t.Elements,function(t){angular.forEach(t.Elements,function(t){t.Name=="sfwTable"?n.GetControl(t,i):t.Name=="sfwPanel"?angular.forEach(t.Elements,function(t){t.Name=="sfwTable"&&n.GetControl(t,i)}):t.dictAttributes.AssociatedControlID&&i&&t.dictAttributes.AssociatedControlID.toLowerCase()==i.toLowerCase()&&(r=t)})})}),r};n.ChangeControl=function(t){(t.Name=="sfwDialogPanel"||t.Name=="sfwPanel"||t.Name=="sfwListView")&&(t.initialvisibilty=!0,t.isLoaded=!0);i.PushItem(t,n.model.ParentVM.Elements)};n.OnPasteControl=function(n){var t=getCurrentFileScope();t&&t.OnPasteControl&&t.OnPasteControl(n)};n.OnDeleteControlClick=function(n){var t=getCurrentFileScope();t&&t.OnDeleteControlClick&&t.OnDeleteControlClick(n)};n.OnCutControlClick=function(n){var t=getCurrentFileScope();t&&t.OnCutControlClick&&t.OnCutControlClick(n)};n.OnCopyControlClick=function(n){var t=getCurrentFileScope();t&&t.OnCopyControlClick&&t.OnCopyControlClick(n)};n.OnClearGridClick=function(n){OnClearGridClick(n,i)};n.OnInsertRowAboveClick=function(n,t){OnInsertRowAboveClick(n,t,i)};n.OnInsertRowBelowClick=function(n,t){OnInsertRowBelowClick(n,t,i)};n.OnInsertColumnLeftClick=function(n,t){OnInsertColumnLeftClick(n,t)};n.OnInsertColumnRightClick=function(n,t){OnInsertColumnRightClick(n,t)};n.OnMoveRowUpClick=function(n,t){if(null!=t){var i=getCurrentFileScope();i&&i.MoveRowUp&&i.MoveRowUp(n,t)}};n.OnMoveRowDownClick=function(n,t){if(t){var i=getCurrentFileScope();i&&i.MoveRowDown&&i.MoveRowDown(n,t)}};n.OnMoveColumnLeftClick=function(n,t){if(t){var i=getCurrentFileScope();i&&i.MoveColumnLeft&&i.MoveColumnLeft(n,t)}};n.OnMoveColumnRightClick=function(n,t){if(t){var i=getCurrentFileScope();i&&i.MoveColumnRight&&i.MoveColumnRight(n,t)}};n.OnDeleteRowClick=function(n,t){OnDeleteRowClick(n,t,i,e)};n.OnDeleteColumnClick=function(t,r){OnDeleteColumnClick(t,r,i,n.formodel,e)};n.OnAddGridColumns=function(){var t=n.$new();t.objGridView=n.model;t.FormModel=n.formodel;t.IsAddColumnSelected=!0;t.FormModel.dictAttributes.sfwType=="Lookup"?t.ParentEntityName=t.FormModel.dictAttributes.sfwEntity:n.model.dictAttributes.sfwEntityField&&n.entitytreename&&(t.ParentEntityName=n.entitytreename);t.objGridView.LstDisplayedEntities=[];t.objGridView.lstselectedmultiplelevelfield=[];t.objGridView.selectedentityobjecttreefields=[];t.title="Create New Grid";t.LstDisplayedEntities=n.lstdisplayentities;t.IsPrototype=t.FormModel&&t.FormModel.dictAttributes.ID.startsWith("wfp")?!0:!1;t.objGridDialog=i.showDialog(t,t.title,"Form/views/CreateGridViewControl.html",{width:1e3,height:700});t.setTitle=function(n){t.title&&(t.title=n,t.objGridDialog.updateTitle(t.title))}};n.CanShowContextMenu=function(n,t){return CanShowContextMenu(n,t)}}}}}]);app.directive("tableControlDirective",["$compile","$rootScope","$EntityIntellisenseFactory","$ValidationService","$GetEntityFieldObjectService","$SgMessagesService",function(n,t,i,r,u,f){return{restrict:"E",replace:!0,scope:{model:"=",formodel:"=",objparent:"=",lstloadedentitytrees:"=",lstloadedentitycolumnstree:"=",lstdisplayentities:"=",entitytreename:"=",buttonsCollection:"="},template:function(){return getHtmlFromServer("Form/views/Controls/TableControlView.html")},link:function(r){var u,e,o,s;if(r.blnIsTableSelected=!1,r.formodel&&!r.formodel.SelectedControl)for(u=0;u<r.formodel.Elements.length;u++)if(r.formodel.Elements[u].Name=="sfwTable"){for(e=0;e<r.formodel.Elements[u].Elements.length;e++)if(r.formodel.Elements[u].Elements[e].Name=="sfwRow"){r.formodel.Elements[u].Elements[e].Elements.length>0&&selectControl(r.formodel.Elements[u].Elements[e].Elements[0],null,r.formodel);break}break}r.SetParentVM=function(n,t){t.ParentVM=n};r.selectControlOnDoubleClick=function(n,t){selectControlOnDoubleClick(n,t)};r.selectControl=function(n,t){n&&n.Name!="sfwColumn"&&n.Name!="sfwButtonGroup"&&(r.blnIsTableSelected=!r.blnIsTableSelected);selectControl(n,t,r.formodel)};r.AddRowsAndColumns=function(n,t){r.blnIsTableSelected=!0;t.stopPropagation();var i=getCurrentFileScope();i&&i.AddRowsAndColumns&&i.AddRowsAndColumns(n,t)};r.tdMouseEnterEvent=function(t){var i,u;r.startEvent=t;$(".row-col").remove();var o=angular.element(r.startEvent.currentTarget).scope(),s=r.startEvent.currentTarget[0]&&r.startEvent.currentTarget[0].offsetHeight,f="",e=$(r.startEvent.currentTarget).attr("cellposition");e=="top"&&(f=n("<div class='row-col left-top-col-div' ng-mouseover='addColLeft()'><\/div><div class='row-col right-top-col-div' ng-mouseover='addColRight()'><\/div>")(r));e=="left"&&(f=n("<div class='row-col left-top-row-div' ng-mouseover='addRowTop()'><\/div><div class='row-col left-bottom-row-div' ng-mouseover='addRowBottom()'><\/div>")(r));$(r.startEvent.currentTarget).append(f);r.cellObj=null;e=="left"?r.cellObj=r.startEvent.target.nodeName.toLowerCase()!="td"?$(r.startEvent.target).parents("td").first().siblings().first():$(r.startEvent.target).siblings().first():r.startEvent.target.nodeName.toLowerCase()!="td"?(i=$(r.startEvent.target).closest("td"),u=$(i).index(),r.cellObj=$(i).closest("tr").siblings().first().children().eq(u)):(i=$(r.startEvent.target),u=$(i).index(),r.cellObj=$(i).closest("tr").siblings().first().children().eq(u))};r.addRowTop=function(){o("addRowTop")};r.addRowBottom=function(){o("addRowBottom")};r.addColLeft=function(){o("addColumnLeft")};r.addColRight=function(){o("addColumnRight")};o=function(n){var u,e,o,h;if(r.startEvent){clearTimeout(t.userIdleTimeout);$(".sgt-wrapper").length>0&&($("#temprow").remove(),$(".sgt-wrapper").remove());var i=$(r.startEvent.target).closest("tr")[0],c=0,a=0;i&&(i.nodeName=="TR"||i.nodeName=="tr")&&(c=i.cells.length);var l=$(r.startEvent.currentTarget).parent().index(),f=$(r.startEvent.currentTarget).index(),s=$(i).closest("tbody");for(s&&s[0]&&(a=s[0].rows.length),u='<tr id="temprow">',e=0;e<c;e++)u+=e==0?'<td class="sgt-wrapper row-wrap" style="padding:0px;text-align: center;height:20px!important;border:0!important;" title=" Click here to add row "><span style="position:relative;mouse:pointer;height:100%;width:100%" class="sgt-wrapper glyphicon glyphicon-plus-sign"><\/span>  <\/td>':'<td class="sgt-wrapper row-wrap" style="padding:0px;text-align: center;height:20px!important;" title=" Click here to add row "> <\/td>';if(u+="<\/tr>",o="",h="<td class='sgt-wrapper col-wrap'  style='width:20px;border:0!important;padding:0' title=' Click here to add Column '><span style='position:relative;mouse:pointer;height:100%;width:100%;margin-left:2px;padding:0' class='sgt-wrapper glyphicon glyphicon-plus-sign'><\/span>   <\/td>",o+="<td class='sgt-wrapper col-wrap'  style='width:20px;' title=' Click here to add Column '>  <\/td>",n=="addRowTop"){$(i).closest("table > tbody > tr:nth-child("+(l+1)+")").before(u);$(".sgt-wrapper").addClass("td-fade-in");$(".row-wrap").on("click",function(){var t,n,i;$(".sgt-wrapper.row-wrap").parent("tr").remove();$(".sgt-wrapper").remove();r.cellObj&&(t=angular.element(r.cellObj).scope());n=t&&t.col?t.col:null;i=n&&n.ParentVM?n.ParentVM.ParentVM:null;n&&i&&r.OnInsertRowAboveClick(n,i)})}if(n=="addRowBottom"){$(i).closest("table > tbody > tr:nth-child("+(l+1)+")").after(u);$(".sgt-wrapper").addClass("td-fade-in");$(".row-wrap").on("click",function(){var t,n,i;$(".sgt-wrapper.row-wrap").parent("tr").remove();$(".sgt-wrapper").remove();r.cellObj&&(t=angular.element(r.cellObj).scope());n=t&&t.col?t.col:null;i=n&&n.ParentVM?n.ParentVM.ParentVM:null;n&&i&&r.OnInsertRowBelowClick(n,i)})}if(n=="addColumnRight"){$(i).children("td:eq("+f+")").after(h);$(i).siblings("tr").each(function(){$(this).children("td:eq("+f+")").after(o)});$(".sgt-wrapper").addClass("td-fade-in");$(".col-wrap").on("click",function(){var t,n,i;$(".sgt-wrapper.row-wrap").parent("tr").remove();$(".sgt-wrapper").remove();r.cellObj&&(t=angular.element(r.cellObj).scope());n=t&&t.col?t.col:null;i=n&&n.ParentVM?n.ParentVM.ParentVM:null;n&&i&&r.OnInsertColumnRightClick(n,i)})}if(n=="addColumnLeft"){$(i).children("td:eq("+f+")").before(h);$(i).siblings("tr").each(function(){$(this).children("td:eq("+f+")").before(o)});$(".sgt-wrapper").addClass("td-fade-in");$(".col-wrap").on("click",function(){var t,n,i;$(".sgt-wrapper.row-wrap").parent("tr").remove();$(".sgt-wrapper").remove();r.cellObj&&(t=angular.element(r.cellObj).scope());n=t&&t.col?t.col:null;i=n&&n.ParentVM?n.ParentVM.ParentVM:null;n&&i&&r.OnInsertColumnLeftClick(n,i)})}}};r.$on("$destroy",function(){clearTimeout(t.userIdleTimeout)});r.tdKeyDown=function(n,i){if(n&&!i.ctrlKey&&!i.shiftKey&&!i.altKey&&i.which==$.ui.keyCode.DELETE&&r.formodel.SelectedControl&&r.formodel.SelectedControl.Name=="sfwColumn"&&r.formodel.SelectedControl.Elements.length>0){for(t.UndRedoBulkOp("Start"),u=r.formodel.SelectedControl.Elements.length-1;u>-1;u--)t.DeleteItem(r.formodel.SelectedControl.Elements[u],r.formodel.SelectedControl.Elements);t.UndRedoBulkOp("End")}};r.SetColSpan=function(n){return n.dictAttributes.ColumnSpan};r.SetRowSpan=function(n){return n.dictAttributes.RowSpan};r.OnInsertRowAboveClick=function(n,i){OnInsertRowAboveClick(n,i,t)};r.OnInsertRowBelowClick=function(n,i){OnInsertRowBelowClick(n,i,t)};r.OnInsertColumnLeftClick=function(n,t){OnInsertColumnLeftClick(n,t)};r.OnInsertColumnRightClick=function(n,t){OnInsertColumnRightClick(n,t)};r.OnMoveRowUpClick=function(n,t){if(null!=t){var i=getCurrentFileScope();i&&i.MoveRowUp&&i.MoveRowUp(n,t)}};r.OnMoveRowDownClick=function(n,t){if(t){var i=getCurrentFileScope();i&&i.MoveRowDown&&i.MoveRowDown(n,t)}};r.OnMoveColumnLeftClick=function(n,t){if(t){var i=getCurrentFileScope();i&&i.MoveColumnLeft&&i.MoveColumnLeft(n,t)}};r.OnMoveColumnRightClick=function(n,t){if(t){var i=getCurrentFileScope();i&&i.MoveColumnRight&&i.MoveColumnRight(n,t)}};r.OnCutCell=function(n){var t=getCurrentFileScope();t&&t.OnCutCell&&t.OnCutCell(n)};r.OnCopyCell=function(n){var t=getCurrentFileScope();t&&t.OnCopyCell&&t.OnCopyCell(n)};r.OnPasteControl=function(n){var t=getCurrentFileScope();t&&t.OnPasteControl&&t.OnPasteControl(n)};r.OnPasteCell=function(n){var t=getCurrentFileScope();t&&t.OnPasteCell&&t.OnPasteCell(n)};r.objRepeaterControl;r.ErrorMessageForDisplay="";r.onRepeaterControlOkClick=function(){var o,h,s,c,l,a,f,e,v,u,n;r.objRepeaterControl&&(r.objRepeaterControl.dictAttributes.sfwSelection="Many",r.objRepeaterControl.dictAttributes.sfwCaption="List View",r.objRepeaterControl.dictAttributes.AllowPaging="True",r.objRepeaterControl.dictAttributes.PageSize="1",o=r.objRepeaterControl.selectedobjecttreefield,o&&(h=getDisplayedEntity(r.objRepeaterControl.LstDisplayedEntities),s=h.strDisplayName,fieldName=o.ID,s!=""&&(fieldName=s+"."+o.ID),c=fieldName,r.objRepeaterControl.dictAttributes.sfwEntityField=c,l=o.Entity,a=i.getEntityIntellisense(),r.objRepeaterControl.dictAttributes.sfwDataKeyNames=GetTableKeyFields(l,a)),f="swc",e={Name:"sfwTable",value:"",prefix:f,dictAttributes:{},Elements:[],Children:[]},e.ParentVM=r.objRepeaterControl,v=CreateControlID(r.formodel,"NewPage","sfwTable"),e.dictAttributes.ID=v,u={Name:"sfwRow",value:"",prefix:f,dictAttributes:{},Elements:[],Children:[]},u.ParentVM=e,n={Name:"sfwColumn",value:"",prefix:f,dictAttributes:{},Elements:[],Children:[]},n.ParentVM=u,u.Elements.push(n),n={Name:"sfwColumn",value:"",prefix:f,dictAttributes:{},Elements:[],Children:[]},n.ParentVM=u,u.Elements.push(n),n={Name:"sfwColumn",value:"",prefix:f,dictAttributes:{},Elements:[],Children:[]},n.ParentVM=u,u.Elements.push(n),n={Name:"sfwColumn",value:"",prefix:f,dictAttributes:{},Elements:[],Children:[]},n.ParentVM=u,u.Elements.push(n),e.Elements.push(u),r.objRepeaterControl.Elements.push(e),r.objRepeaterControl.initialvisibilty=!0,r.objRepeaterControl.isLoaded=!0,t.PushItem(r.objRepeaterControl,r.dropdata.Elements));r.onRepeaterControlCancelClick()};r.onRepeaterControlCancelClick=function(){s.close()};r.OnDeleteRowClick=function(n,i){OnDeleteRowClick(n,i,t,f)};r.OnDeleteColumnClick=function(n,i){OnDeleteColumnClick(n,i,t,r.formodel,f)};r.OnClearGridClick=function(n){OnClearGridClick(n,t)};r.CanShowContextMenu=function(n,t){return CanShowContextMenu(n,t)};r.menuOptions=[["Insert",[["Row Above",function(n){if(n.col){var t=n.col,i=t.ParentVM.ParentVM;r.OnInsertRowAboveClick(t,i)}},null,null,"Ctrl+Shift+A"],["Row Below",function(n){if(n.col){var t=n.col,i=t.ParentVM.ParentVM;r.OnInsertRowBelowClick(t,i)}},null,null,"Ctrl+Shift+B"],["Column Left",function(n){if(n.col){var t=n.col,i=t.ParentVM.ParentVM;r.OnInsertColumnLeftClick(t,i)}},null,null,"Ctrl+Shift+L"],["Column Right",function(n){if(n.col){var t=n.col,i=t.ParentVM.ParentVM;r.OnInsertColumnRightClick(t,i)}},null,null,"Ctrl+Shift+R"],["Cell Right",function(n){if(n.col){var i=n.col.ParentVM,t=getCurrentFileScope();t&&t.InsertCell&&t.InsertCell(i,n.col,!0)}},null,null,"Ctrl+Alt+R"],["Cell Left",function(n){if(n.col){var i=n.col.ParentVM,t=getCurrentFileScope();t&&t.InsertCell&&t.InsertCell(i,n.col,!1)}},null,null,"Ctrl+Alt+L"],],function(n){return n.col&&n.formodel&&r.selectControl&&r.selectControl(n.col,event,n.formodel),r.CanShowContextMenu(n.col,n.formodel)}],null,["Move",[["Row Up",function(n){if(n.col){var t=n.col,i=t.ParentVM.ParentVM;r.OnMoveRowUpClick(t,i)}},null,null,"Ctrl+U"],["Row Down",function(n){if(n.col){var t=n.col,i=t.ParentVM.ParentVM;r.OnMoveRowDownClick(t,i)}},null,null,"Ctrl+D"],["Column Left",function(n){if(n.col){var t=n.col,i=t.ParentVM.ParentVM;r.OnMoveColumnLeftClick(t,i)}},null,null,"Ctrl+L"],["Column Right",function(n){if(n.col){var t=n.col,i=t.ParentVM.ParentVM;r.OnMoveColumnRightClick(t,i)}},null,null,"Ctrl+R"],],function(n){return r.CanShowContextMenu(n.col,n.formodel)}],null,["Add Control",function(n){if(n.col){var t=n.col;r.$parent.openChangeControlDialog("addcontrol",t)}return r.selectControl(n.col,event,n.formodel),r.CanShowContextMenu(n.col,n.formodel)}],null,["Cut Cell",function(n){if(n.col){var t=n.col;r.OnCutCell(t)}},function(n){return r.CanShowContextMenu(n.col,n.formodel)},null,"Ctrl+X"],null,["Copy Cell",function(n){if(n.col){var t=n.col;r.OnCopyCell(t)}},function(n){return r.CanShowContextMenu(n.col,n.formodel)},null,"Ctrl+C"],null,["Paste Cell",function(n){if(n.col){var t=n.col;r.OnPasteCell(t)}},function(){var n=getCurrentFileScope();if(n&&n.ClipboardData&&n.ClipboardDataOpeType=="Cell")return!0},null,"Ctrl+V"],null,["Delete Cell",function(n){if(n.col){var t=getCurrentFileScope();t&&t.MoveRowUp&&t.deleteCell(n.col)}},function(n){return r.CanShowContextMenu(n.col,n.formodel)},null,null,"Alt+Del"],null,["Paste Control",function(n){if(n.col){var t=n.col;r.OnPasteControl(t)}},function(){var n=getCurrentFileScope();if(n&&n.ClipboardData&&n.ClipboardDataOpeType=="Control")return!0},null,"Ctrl+V"],null,["Clear Cell",function(n){if(n.col){var i=n.col;ClearCell(i,t,!0)}},function(n){return r.CanShowContextMenu(n.col,n.formodel)}],null,["Clear Panel",function(n){if(n.col){var t=n.col,i=t.ParentVM.ParentVM;r.OnClearGridClick(i)}},function(n){return n.formodel&&n.formodel.dictAttributes.sfwType=="Lookup"&&!n.formodel.IsLookupCriteriaEnabled?!1:r.CanShowContextMenu(n.col,n.formodel)},null,"Shift+Del"],null,["Delete Row",function(n){if(n.col){var t=n.col,i=t.ParentVM.ParentVM,u=t.ParentVM;r.OnDeleteRowClick(u,i)}},function(n){return r.CanShowContextMenu(n.col,n.formodel)},null,"Ctrl+Del"],null,["Delete Column",function(n){if(n.col){var t=n.col,i=t.ParentVM.ParentVM;r.OnDeleteColumnClick(t,i)}},function(n){return r.CanShowContextMenu(n.col,n.formodel)},null,"Ctrl+Shift+Del"],null]}}}]);app.directive("tabcontainerControlDirective",["$compile","$rootScope","$SgMessagesService",function(n,t,i){return{restrict:"E",replace:!0,scope:{model:"=",formodel:"=",objparent:"=",lstloadedentitytrees:"=",lstloadedentitycolumnstree:"=",lstdisplayentities:"=",entitytreename:"=",buttonsCollection:"="},template:function(){return getHtmlFromServer("Form/views/Controls/TabcontainerControlView.html")},link:function(n){n.model.Name=="sfwTabContainer"&&n.model.Elements[0]&&n.model.Elements[0].Elements.length>0&&!t.isFromSource&&(n.model.Elements[0].ParentVM=n.model,n.model.Elements[0].SelectedTabSheet||(n.model.Elements[0].SelectedTabSheet=n.model.Elements[0].Elements[0],n.model.Elements[0].SelectedTabSheet.IsSelected=!0,n.model.Elements[0].Elements.every(function(n){n.isLoaded=!1}),n.model.Elements[0].Elements[0].isLoaded=!0));n.SetParentVM=function(n,t){t.ParentVM=n};n.selectControlOnDoubleClick=function(n,t){selectControlOnDoubleClick(n,t)};n.selectControl=function(t,i){selectControl(t,i,n.formodel)};n.AddNewTabClick=function(i){var o,f,e,u,r;i&&(t.UndRedoBulkOp("Start"),o=CreateControlID(n.formodel,"NewPage","sfwTabSheet"),f={Name:"sfwTabSheet",Value:"",prefix:"swc",dictAttributes:{ID:o,HeaderText:"New Page"},Elements:[],Children:[]},f.ParentVM=i,f.isLoaded=!0,e={Name:"sfwTable",Value:"",prefix:"swc",dictAttributes:{ID:""},Elements:[],Children:[]},e.dictAttributes.ID=CreateControlID(n.formodel,"Table","sfwTable",!1),e.ParentVM=f,t.PushItem(e,f.Elements),u={Name:"sfwRow",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]},u.ParentVM=e,r={Name:"sfwColumn",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]},r.ParentVM=u,t.PushItem(r,u.Elements),r={Name:"sfwColumn",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]},r.ParentVM=u,t.PushItem(r,u.Elements),r={Name:"sfwColumn",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]},r.ParentVM=u,t.PushItem(r,u.Elements),r={Name:"sfwColumn",Value:"",prefix:"swc",dictAttributes:{},Elements:[],Children:[]},r.ParentVM=u,t.PushItem(r,u.Elements),t.PushItem(u,e.Elements),t.PushItem(f,i.Elements),t.UndRedoBulkOp("End"),SetFormSelectedControl(n.formodel,f),i.SelectedTabSheet=f,i.SelectedTabSheet.IsSelected=!0)};n.DeleteNewTabClick=function(r,u){u&&r&&i.Message("Delete Tab Sheet","Do you want to Delete Selected Tab Sheet ?",!0,function(i){var f,e;i&&(t.UndRedoBulkOp("Start"),f=r.Elements.indexOf(u),t.DeleteItem(u,r.Elements),r.Elements.length>0?(f--,f<0&&(f=0),SetFormSelectedControl(n.formodel,r.Elements[f]),r.SelectedTabSheet=r.Elements[f],r.SelectedTabSheet.IsSelected=!0):(e=FindParent(n.formodel.SelectedControl,"sfwTabContainer",!0),e&&e.ParentVM&&t.DeleteItem(e,e.ParentVM.Elements)),t.UndRedoBulkOp("End"))})};n.getTabID=function(n,t){return t?"#"+n.dictAttributes.ID:n.dictAttributes.ID};n.tabsheetmenuOptions=[["Move",[["Move Tabsheet Left",function(n){var i,r;n.tabs&&n.tabs.Name=="sfwTabSheet"&&n.tabs.ParentVM.Elements.length>0&&(i=n.tabs.ParentVM.Elements.indexOf(n.tabs),i>0&&(r=n.tabs.ParentVM.Elements[i],r&&(t.UndRedoBulkOp("Start"),t.DeleteItem(n.tabs.ParentVM.Elements[i],n.tabs.ParentVM.Elements),t.InsertItem(r,n.tabs.ParentVM.Elements,i-1),t.UndRedoBulkOp("End"))))},function(){return!0},null],["Move Tabsheet Right",function(n){var u,i,r;n.tabs&&n.tabs.Name=="sfwTabSheet"&&n.tabs.Elements.length>0&&(u=n.tabs.ParentVM.Elements.length,i=n.tabs.ParentVM.Elements.indexOf(n.tabs),i<u-1&&(r=n.tabs.ParentVM.Elements[i],r&&(t.UndRedoBulkOp("Start"),t.DeleteItem(n.tabs.ParentVM.Elements[i],n.tabs.ParentVM.Elements),t.InsertItem(r,n.tabs.ParentVM.Elements,i+1),t.UndRedoBulkOp("End"))))},function(t){return n.selectControl(t.tabs,event,n.formodel),!0},null],],function(){return!0}],]}}}]);app.directive("gridControlDirective",["$compile","$rootScope","$ValidationService","$GetEntityFieldObjectService","$SgMessagesService",function(n,t,i,r,u){return{restrict:"E",replace:!0,scope:{model:"=",formodel:"=",objparent:"=",lstloadedentitytrees:"=",lstloadedentitycolumnstree:"=",lstdisplayentities:"=",entitytreename:"=",buttonsCollection:"="},template:function(){return getHtmlFromServer("Form/views/Controls/GridControlView.html")},link:function(n){n.selectControlOnDoubleClick=function(n,t){selectControlOnDoubleClick(n,t)};n.selectControl=function(t,i){selectControl(t,i,n.formodel)};n.getHeaderColspan=function(n){if(n.Elements.length>0){var t=n.Elements[0];return t.Elements.length}return 1};n.getValue=function(n){return getDisplayValue(n)};var f;n.objRepeaterControl;n.ErrorMessageForDisplay="";n.OnAddControlToCellClick=function(u,f,e){var h,c,l,s,o;f&&(h=f,h=="sfwButton"?(o=n.$new(!0),o.item=u,o.formodel=n.formodel,o.CreateButtonDialog=t.showDialog(o,"Button Details","Form/views/CreateButtonWizard/CreateButtonControl.html",{width:660,height:550})):h=="sfwListView"?(n.ErrorMessageForDisplay="",c=CreateControlID(n.formodel,"RepeaterViewPanel","sfwListView"),l="swc",n.objRepeaterControl={Name:"sfwListView",value:"",prefix:l,dictAttributes:{ID:c},Elements:[],Children:[]},n.ParentEntityName=formodel.dictAttributes.sfwEntity,n.objRepeaterControl.selectedobjecttreefield,n.objRepeaterControl.lstselectedobjecttreefields=[],s=n.$new(!0),s.objRepeaterControl=n.objRepeaterControl,s.objRepeaterControl.LstDisplayedEntities=[],s.ParentEntityName=n.ParentEntityName,s.RepeaterControldialog=t.showDialog(s,"Repeater Control","Form/views/RepeaterControlTemplate.html",{width:500,height:600})):(o=n.$new(),AddControlToCell(u,h,undefined,e,n.formodel,n.model,t,o,i,r)))};n.onRepeaterControlOkClick=function(){var e,s,o,h,c,l,u,f,a,r,i;n.objRepeaterControl&&(n.objRepeaterControl.dictAttributes.sfwSelection="Many",n.objRepeaterControl.dictAttributes.sfwCaption="List View",n.objRepeaterControl.dictAttributes.AllowPaging="True",n.objRepeaterControl.dictAttributes.PageSize="1",e=n.objRepeaterControl.selectedobjecttreefield,e&&(s=getDisplayedEntity(n.objRepeaterControl.LstDisplayedEntities),o=s.strDisplayName,fieldName=e.ID,o!=""&&(fieldName=o+"."+e.ID),h=fieldName,n.objRepeaterControl.dictAttributes.sfwEntityField=h,c=e.Entity,l=$EntityIntellisenseFactory.getEntityIntellisense(),n.objRepeaterControl.dictAttributes.sfwDataKeyNames=GetTableKeyFields(c,l)),u="swc",f={Name:"sfwTable",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},f.ParentVM=n.objRepeaterControl,a=CreateControlID(n.formodel,"NewPage","sfwTable"),f.dictAttributes.ID=a,r={Name:"sfwRow",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},r.ParentVM=f,i={Name:"sfwColumn",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},i.ParentVM=r,r.Elements.push(i),i={Name:"sfwColumn",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},i.ParentVM=r,r.Elements.push(i),i={Name:"sfwColumn",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},i.ParentVM=r,r.Elements.push(i),i={Name:"sfwColumn",value:"",prefix:u,dictAttributes:{},Elements:[],Children:[]},i.ParentVM=r,r.Elements.push(i),f.Elements.push(r),n.objRepeaterControl.Elements.push(f),n.objRepeaterControl.initialvisibilty=!0,n.objRepeaterControl.isLoaded=!0,t.PushItem(n.objRepeaterControl,n.dropdata.Elements));n.onRepeaterControlCancelClick()};n.onRepeaterControlCancelClick=function(){f.close()};n.templatefieldmenuOptions=[["Delete Column",function(i){var r=i.ele,f;r&&(r.ParentVM.Elements.length<=1?u.Message("Message","The column cannot be deleted. Atleast one column should be present in the grid."):(f=r.ParentVM.Elements.indexOf(r),t.DeleteItem(r,r.ParentVM.Elements),f>=r.ParentVM.Elements.length-1&&(f-=1),f>-1&&f<r.ParentVM.Elements.length&&r.ParentVM.Elements[f]&&SetFormSelectedControl(n.formodel,r.ParentVM.Elements[f],null),n.formodel.dictAttributes.ID.startsWith("wfp")&&r&&r.ParentVM.ParentVM&&r.ParentVM.ParentVM.Name=="sfwGridView"&&n.AddShowDataRow(r.ParentVM.ParentVM,!1,"")))},function(t,i){return(n.selectControl(t.ele,i,n.formodel),n.IsDataView)?!1:!0}],null,["Remove Header",function(n){var i=n.ele,r,u;i&&i.Elements.length>0&&(r=i.Elements.filter(function(n){return n.Name=="HeaderTemplate"}),r&&r.length>0&&(u=i.Elements.indexOf(r[0]),u>-1&&(t.UndRedoBulkOp("Start"),t.DeleteItem(r[0],i.Elements),i.HeaderTemplateLabel&&t.EditPropertyValue(i.HeaderTemplateLabel.dictAttributes.sfwEntityField,i.HeaderTemplateLabel.dictAttributes,"sfwEntityField",""),t.UndRedoBulkOp("End"))))},function(t){return t.formodel&&t.formodel.dictAttributes.sfwType=="Lookup"?!1:n.showHeaderTemplate(t.ele)?!0:!1}],null,["Remove Footer",function(n){var i=n.ele,i=n.ele,r,u;i&&i.Elements.length>0&&(r=i.Elements.filter(function(n){return n.Name=="FooterTemplate"}),r&&r.length>0&&(u=i.Elements.indexOf(r[0]),u>-1&&t.DeleteItem(r[0],i.Elements)))},function(t){return t.formodel&&t.formodel.dictAttributes.sfwType=="Lookup"?!1:n.showFooterTemplate(t.ele)?!0:!1}],null,["Move Column Left",function(n){var i=n.ele,r,u;i&&(r=i.ParentVM.Elements.indexOf(i),r>0&&(u=i.ParentVM.Elements[r],u&&(t.UndRedoBulkOp("Start"),t.DeleteItem(i.ParentVM.Elements[r],i.ParentVM.Elements),t.InsertItem(u,i.ParentVM.Elements,r-1),t.UndRedoBulkOp("End"))))},function(){return n.IsDataView?!1:!0},null,"Ctrl+L"],null,["Move Column Right",function(n){var i=n.ele,f,r,u;i&&(f=i.ParentVM.Elements.length,r=i.ParentVM.Elements.indexOf(i),r<f-1&&(u=i.ParentVM.Elements[r],u&&(t.UndRedoBulkOp("Start"),t.DeleteItem(i.ParentVM.Elements[r],i.ParentVM.Elements),t.InsertItem(u,i.ParentVM.Elements,r+1),t.UndRedoBulkOp("End"))))},function(){return n.IsDataView?!1:!0},null,"Ctrl+R"],null,["Add Control",function(t){var i=t.ele.Elements[0];i&&n.$parent.openChangeControlDialog("addcontrol",i,!0)},function(){return n.IsDataView?!1:!0}],null];n.itemtemplatemenuOptions=[["Add Control",function(t){var i=t.ele.Elements[0];i&&n.$parent.openChangeControlDialog("addcontrol",i,!0)},null],["Paste Control",function(t){t.ele.Elements[0]&&n.OnPasteControl(t.ele.Elements[0])},null,"Ctrl+V"]];n.OnPasteControl=function(n){var t=getCurrentFileScope();t&&t.OnPasteControl&&t.OnPasteControl(n)};n.setValueToEntityField=function(t,i){angular.forEach(i.Elements,function(i){i.dictAttributes.sfwEntityField===t.dictAttributes.sfwEntityField?i.dictAttributes.Value=t.dictAttributes.Value:n.setValueToEntityField(t,i)})};n.AddShowDataRow=function(t,i,r){var a,s,v,e,u,o,h,f,c,l;if(t){for(u=0;u<t.Elements.length;u++)t.Elements[u].Name==="Columns"?a=t.Elements[u].Elements:t.Elements[u].Name==="Data"&&(s=t.Elements[u].Elements);if(s&&s.length>0||n.model.prototypemodel&&n.model.prototypemodel.Elements&&n.model.prototypemodel.Elements.length>0){for(e={dictAttributes:{sfwEntityField:"",Value:""},Elements:[],Name:"DataRow",Value:"",prefix:""},u=0;u<a.length;u++){for(o=a[u],h={dictAttributes:{},Elements:[],Name:"DataItem",Value:"",prefix:""},f=0;f<o.Elements[0].Elements.length;f++)o.Elements[0].Elements[f].Name!="cellformat"&&(c={dictAttributes:{sfwEntityField:"",Value:""},Elements:[],Name:"DataColumn",Value:"",prefix:""},o.Elements[0].Elements[f].dictAttributes.sfwEntityField&&(c.dictAttributes.sfwEntityField=o.Elements[0].Elements[f].dictAttributes.sfwEntityField),h.Elements.push(c));e.Elements.push(h)}if(l={dictAttributes:{},Elements:[],Name:"Data",Value:"",prefix:""},i)e.isEditable=!0,n.selectedDataRow=e,n.model.prototypemodel.Elements.push(e);else if(s){for(u=0;u<s.length;u++){for(v={},angular.copy(e,v),f=0;f<s[u].Elements.length;f++)n.setValueToEntityField(s[u].Elements[f],v);l.Elements.push(v)}n.model.prototypemodel=l}}else if(i){for(e={dictAttributes:{sfwEntityField:"",Value:""},Elements:[],Name:"DataRow",Value:"",prefix:""},u=0;u<a.length;u++){for(o=a[u],h={dictAttributes:{},Elements:[],Name:"DataItem",Value:"",prefix:""},f=0;f<o.Elements[0].Elements.length;f++)o.Elements[0].Elements[f].Name!="cellformat"&&(c={dictAttributes:{sfwEntityField:"",Value:""},Elements:[],Name:"DataColumn",Value:"",prefix:""},o.Elements[0].Elements[f].dictAttributes.sfwEntityField&&(c.dictAttributes.sfwEntityField=o.Elements[0].Elements[f].dictAttributes.sfwEntityField),h.Elements.push(c));e.Elements.push(h)}l={dictAttributes:{},Elements:[],Name:"Data",Value:"",prefix:""};l.Elements.push(e);e.isEditable=!0;n.selectedDataRow=e;n.model.prototypemodel=l}}r&&r.stopPropagation()};n.ShowGridDesingView=function(t){var r,u,i;if(n.IsDataView=!1,r=!1,t&&t.prototypemodel){if(u=GetPrototypeDataModel(t.prototypemodel),t.Elements.length>1)for(i=0;i<t.Elements.length;i++)if(t.Elements[i].Name=="Data"){r=!0;t.Elements[i].Elements=u;break}r||t.Elements.push({dictAttributes:{},Elements:u,Name:"Data",Value:"",prefix:""})}};n.DeleteDataRow=function(t){if(t.prototypemodel&&n.selectedDataRow)for(var i=0;i<t.prototypemodel.Elements.length;i++)if(t.prototypemodel.Elements[i]==n.selectedDataRow){t.prototypemodel.Elements.splice(i,1);t.prototypemodel.Elements.length>i?n.selectedDataRow=t.prototypemodel.Elements[i]:t.prototypemodel.Elements.length>0&&(n.selectedDataRow=t.prototypemodel.Elements[t.prototypemodel.Elements.length-1]);break}};n.moveDown=function(){if(n.selectedDataRow&&n.model.prototypemodel&&n.model.prototypemodel.Elements&&n.model.prototypemodel.Elements.length>1){var t=n.model.prototypemodel.Elements.indexOf(n.selectedDataRow);t<n.model.prototypemodel.Elements.length-1&&(n.model.prototypemodel.Elements.splice(t,1),n.model.prototypemodel.Elements.splice(t+1,0,n.selectedDataRow))}};n.moveUp=function(){if(n.selectedDataRow&&n.model.prototypemodel&&n.model.prototypemodel.Elements&&n.model.prototypemodel.Elements.length>1){var t=n.model.prototypemodel.Elements.indexOf(n.selectedDataRow);t>0&&(n.model.prototypemodel.Elements.splice(t,1),n.model.prototypemodel.Elements.splice(t-1,0,n.selectedDataRow))}};n.SetParentVM=function(n,t){t.ParentVM=n};n.showHeaderTemplate=function(n){var i=!1,t;return n&&(t=n.Elements.filter(function(n){return n.Name=="HeaderTemplate"}),t&&t.length>0&&t[0].Elements&&t[0].Elements.some(function(n){if(n.dictAttributes.sfwEntityField)return n.Name=="sfwLabel"})&&(i=!0)),i};n.openHeaderLabelProperty=function(t,i){var r,u;t&&(r=t.Elements.filter(function(n){return n.Name=="HeaderTemplate"}),r&&r.length>0&&r[0].Elements&&(r[0].ParentVM=t,u=r[0].Elements.filter(function(n){return n.Name=="sfwLabel"}),u&&u.length>0&&(u[0].ParentVM=r[0],n.selectControl(u[0],i,n.formodel))))};n.showFooterTemplate=function(n){var i=!1,t;return n&&(t=n.Elements.filter(function(n){return n.Name=="FooterTemplate"}),t&&t.length>0&&t[0].Elements&&t[0].Elements.some(function(n){return n.Name=="sfwLabel"})&&(i=!0)),i};n.openFooterLabelProperty=function(t,i){var r,u;t&&(r=t.Elements.filter(function(n){return n.Name=="FooterTemplate"}),r&&r.length>0&&r[0].Elements&&(r[0].ParentVM=t,u=r[0].Elements.filter(function(n){return n.Name=="sfwLabel"}),u&&u.length>0&&(u[0].ParentVM=r[0],n.selectControl(u[0],i,n.formodel))))};n.selectDataRowInPrototypeGrid=function(t,i){n.selectedDataRow=t;i.stopPropagation()}}}}]);app.directive("usercontrolControlDirective",["$compile","$rootScope",function(){return{restrict:"E",replace:!0,scope:{model:"=",formodel:"=",objparent:"=",lstloadedentitytrees:"=",lstloadedentitycolumnstree:"=",lstdisplayentities:"=",entitytreename:"=",buttonsCollection:"="},template:function(){return getHtmlFromServer("Form/views/Controls/UsercontrolControlView.html")},link:function(n){n.getValue=function(n){return getDisplayValue(n)};n.selectControlOnDoubleClick=function(n,t){selectControlOnDoubleClick(n,t)};n.selectControl=function(t,i){selectControl(t,i,n.formodel)}}}}]);app.directive("commonControlDirective",["$compile","$rootScope",function(n,t){var i=function(n,t){switch(n.Name){case"sfwRadioButton":return t?"images/Form/icon-Radio-Button-Selected.svg":"images/Form/icon-radio.svg";case"sfwCheckBox":return n.dictAttributes.sfwIsSwitch&&n.dictAttributes.sfwIsSwitch=="True"?t?"images/Form/icon-switch-CheckBox-Selected.svg":"images/Form/icon-switch-CheckBox.svg":t?"images/Form/icon-Checkbox-Selected.svg":"images/Form/icon-checkbox.svg";case"sfwImage":return t?"images/Form/icon-Image-Selected.svg":"images/Form/icon-image.svg";case"hr":return t?"images/Form/horizontal_rule - selected.svg":"images/Form/horizontal_rule.svg";case"br":return t?"images/Form/break - selected.svg":"images/Form/break.svg";case"RequiredFieldValidator":return t?"images/Form/icon-Required-Field-Validator-Selected.svg":"images/Form/icon-required-field-validator.svg";case"CompareValidator":return t?"images/Form/icon-Compare-Validator-Selected.svg":"images/Form/icon-compare-validator.svg";case"sfwCRViewer":return t?"images/Form/icon-CR-Viewer-Selected.svg":"images/Form/CR_Viewer.svg";case"sfwSoftErrors":return t?"images/Form/icon-Soft-Errors-Selected.svg":"images/Form/Soft_Errors.svg";case"sfwFileLayout":return t?"images/Form/icon-File-Layout-Selected.svg":"images/Form/File_Layout.svg";case"sfwFileUpload":return t?"images/Form/icon-File-Upload-Selected.svg":"images/Form/File_Upload.svg";case"sfwListPicker":return t?"images/Form/icon-Listpicker-Selected.svg":"images/Form/icon-mant4.svg";case"sfwSourceList":return t?"images/Form/icon-Sourcelist-Selected.svg":"images/Form/icon-mant5.svg";case"sfwMultiCorrespondence":return t?"images/Form/icon-Required-Field-Validator-Selected.svg":"images/Form/icon-required-field-validator.svg";case"sfwTargetList":return t?"images/Form/icon-TargetList-Selected.svg":"images/Form/icon-mant6.svg";case"sfwOpenDetail":return t?"images/Form/icon-Open-Detail-Selected.svg":"images/Form/icon-open-detail.svg";case"sfwRuleViewer":return t?"images/Form/icon-Rule-Viewer-Selected.svg":"images/Form/icon-Rule-Viewer.svg";case"sfwSlider":return t?"images/Form/icon-slider-Selected.svg":"images/Form/icon-slider.svg";case"sfwQuestionnairePanel":return t?"images/Form/icon-QuestionnairePanel-selected.svg":"images/Form/icon-QuestionnairePanel.svg";case"sfwDateTimePicker":return t?"images/Form/icon-DateTimePicker-selected.png":"images/Form/icon-DateTimepicker.png";case"sfwKnob":return t?"images/Form/icon-knob-selected.svg":"images/Form/icon-knob.svg";case"sfwCheckBoxList":return t?"images/Form/icon-checkboxlist.svg":"images/Form/icon-checkboxlist.svg";case"sfwRadioButtonList":return t?"images/Form/icon-radiobuttonlist.svg":"images/Form/icon-radiobuttonlist.svg";case"sfwChart":return t?"images/Form/icon-chart.svg":"images/Form/icon-chart.svg";case"sfwCalendar":return t?"images/Form/icon-calendar-selected.png":"images/Form/icon-calendar.png";case"sfwScheduler":return t?"images/Form/icon-scheduler-selected.svg":"images/Form/icon-scheduler.svg";case"sfwListBox":return t?"images/Form/icon-ListBox-Selected.svg":"images/Form/icon-ListBox.svg";case"sfwJSONData":return t?"images/Form/JSON_Data_selected.svg":"images/Form/JSON_Data.svg";case"sfwCaptcha":return t?"images/Form/captcha_control_blue.svg":"images/Form/captcha_control_normal.svg"}};return{restrict:"E",replace:!0,scope:{model:"=",formodel:"="},template:function(){return getHtmlFromServer("Form/views/Controls/CommonControlView.html")},link:function(n){n.getDisplayClass=function(n){return getDisplayClass(n)};n.strImageSource=i(n.model,!1);n.getValue=function(n){return getDisplayValue(n)};n.getCodeValue=function(i,r){if(selectControl(i,r,n.formodel),(i.Name=="sfwListPicker"||i.Name=="sfwSourceList"||i.Name=="sfwRadioButtonList"||i.Name=="sfwCascadingDropDownList"||i.Name=="sfwDropDownList"||i.Name=="sfwCheckBoxList"||i.Name=="sfwMultiSelectDropDownList"||i.Name=="sfwListBox")&&(!i.dictAttributes.sfwLoadType||i.dictAttributes.sfwLoadType==""||i.dictAttributes.sfwLoadType=="CodeGroup"||i.dictAttributes.sfwLoadType=="Items"&&i.Elements.length==0)&&(i.dictAttributes.sfwLoadSource||i.placeHolder)){t.IsLoading=!0;r&&($(r.target).blur(),window.getSelection().removeAllRanges());var u="";u=i.dictAttributes.sfwLoadSource&&i.dictAttributes.sfwLoadType=="CodeGroup"?i.dictAttributes.sfwLoadSource:i.placeHolder;$.connection.hubMain.server.getCodeValuesForDropDown(u).done(function(i){n.$evalAsync(function(){t.IsLoading=!1;var r=n.$new(!0);r.ErrorMessage="";i&&i.length>0?r.lstCodeValues=i:r.ErrorMessage="No code value exist.";dialog=t.showDialog(r,"Code Values","Form/views/CodeValueListDialog.html");r.closeDialog=function(){dialog.close()}})})}};n.selectControlOnDoubleClick=function(t,r){selectControlOnDoubleClick(t,r);n.strImageSource=i(n.model,!0)};n.selectControl=function(t,r){selectControl(t,r,n.formodel);n.strImageSource=i(n.model,!0)}}}}]);app.directive("childpanelControlDirective",["$compile","$rootScope",function(){return{restrict:"E",replace:!0,scope:{model:"=",formodel:"=",objparent:"=",lstloadedentitytrees:"=",lstloadedentitycolumnstree:"=",lstdisplayentities:"=",entitytreename:"=",buttonsCollection:"="},template:function(){return getHtmlFromServer("Form/views/Controls/ChildPanelControlView.html")},link:function(n){n.initialvisibilty=!0;n.panelId="";n.model.dictAttributes.ID&&(n.panelId="Panel"+n.model.dictAttributes.ID);n.setInitialVisibility=function(){n.initialvisibilty=!n.initialvisibilty};n.setVisibility=function(t){t.ParentControlName=="udc"&&(t.Name=="sfwPanel"||t.Name=="sfwDialogPanel"||t.Name=="sfwListView")&&(n.initialvisibilty=!n.initialvisibilty,n.model.isLoaded=!0)};n.selectControlOnDoubleClick=function(n,t){selectControlOnDoubleClick(n,t)};n.selectControl=function(t,i){selectControl(t,i,n.formodel)};n.panelMenuOption=[["Create Compatible Caption",function(){var t=getCurrentFileScope();n.model&&t&&t.OnCreateCompatibleLabelClickForPanel&&t.OnCreateCompatibleLabelClickForPanel(n.model)}],["Delete Control",function(){var t=getCurrentFileScope();n.model&&t&&t.OnDeleteControlClick&&t.OnDeleteControlClick(n.model)},function(){if(n.model){var t=FindParent(n.model,"sfwPanel");if(!t&&(t=FindParent(n.model,"sfwWizardStep"),!t&&(t=FindParent(n.model,"sfwDialogPanel",!0),!t)))return!1}return!0}],["Cut Control (Ctrl+X)",function(){if(n.model){var t=getCurrentFileScope();t&&t.OnCutControlClick&&t.OnCutControlClick(n.model)}},function(){if(n.model){var t=FindParent(n.model,"sfwPanel");if(!t&&(t=FindParent(n.model,"sfwWizardStep"),!t&&(t=FindParent(n.model,"sfwDialogPanel",!0),!t)))return!1}return!0}],["Copy Control (Ctrl+C)",function(){if(n.model){var t=getCurrentFileScope();t&&t.OnCopyControlClick&&t.OnCopyControlClick(n.model)}},function(){if(n.model){var t=FindParent(n.model,"sfwPanel");if(!t&&(t=FindParent(n.model,"sfwWizardStep"),!t&&(t=FindParent(n.model,"sfwDialogPanel",!0),!t)))return!1}return!0}],]}}}]);app.directive("emptyparentControlDirective",["$compile","$rootScope",function(){return{restrict:"E",replace:!0,template:function(){return getHtmlFromServer("Form/views/Controls/EmptyParentControlView.html")},link:function(){},controller:["$scope",function(n){n.selectControl=function(n,t,i){selectControl(n,t,i)};n.selectControlOnDoubleClick=function(n,t){selectControlOnDoubleClick(n,t)}}]}}]);app.directive("editableControlDirective",["$compile","$rootScope","$EntityIntellisenseFactory","$ValidationService","CONSTANTS",function(n,t,i,r,u){return{restrict:"E",replace:!0,scope:{model:"=",formodel:"=",lstloadedentitycolumnstree:"="},template:function(){return getHtmlFromServer("Form/views/Controls/EditableControlView.html")},link:function(n){n.getCodeValue=function(i,r){if(selectControl(i,r,n.formodel),(i.Name=="sfwListPicker"||i.Name=="sfwSourceList"||i.Name=="sfwRadioButtonList"||i.Name=="sfwCascadingDropDownList"||i.Name=="sfwDropDownList"||i.Name=="sfwCheckBoxList"||i.Name=="sfwMultiSelectDropDownList"||i.Name=="sfwListBox")&&(!i.dictAttributes.sfwLoadType||i.dictAttributes.sfwLoadType==""||i.dictAttributes.sfwLoadType=="CodeGroup"||i.dictAttributes.sfwLoadType=="Items"&&i.Elements.length==0)&&(i.dictAttributes.sfwLoadSource||i.placeHolder)){t.IsLoading=!0;r&&($(r.target).blur(),window.getSelection().removeAllRanges());var u="";u=i.dictAttributes.sfwLoadSource&&i.dictAttributes.sfwLoadType=="CodeGroup"?i.dictAttributes.sfwLoadSource:i.placeHolder;$.connection.hubMain.server.getCodeValuesForDropDown(u).done(function(i){t.IsLoading=!1;n.$evalAsync(function(){var r=n.$new(!0);r.ErrorMessage="";i&&i.length>0?r.lstCodeValues=i:r.ErrorMessage="No code value exist.";dialog=t.showDialog(r,"Code Values","Form/views/CodeValueListDialog.html");r.closeDialog=function(){dialog.close()}})})}};n.getDisplayClass=function(n){return getDisplayClass(n)};n.selectControlOnDoubleClick=function(n,t){selectControlOnDoubleClick(n,t)};n.selectControl=function(t,i){selectControl(t,i,n.formodel)};n.onActionKeyDown=function(n){if(controllerScope=getCurrentFileScope(),controllerScope&&controllerScope.onActionKeyDown)controllerScope.onActionKeyDown(n)};n.checkEntityField=function(t){var f,e,i;n.fileScope.lstLoadedEntityTrees&&(f=n.fileScope.lstLoadedEntityTrees.filter(function(n){return n.IsVisible}),e=f&&f.length>0?f[0].EntityName:n.formodel.dictAttributes.sfwEntity,t.dictAttributes.sfwRelatedGrid&&(e=n.fileScope.FindEntityName(t,n.formodel.dictAttributes.sfwEntity)),t.IsChildOfGrid&&(i=FindParent(t,"sfwGridView"),i&&i.dictAttributes.sfwParentGrid&&i.dictAttributes.sfwEntityField&&(e=n.fileScope.FindEntityName(i,n.formodel.dictAttributes.sfwEntity,!0))),r.checkValidListValueForMultilevel([],t,t.dictAttributes.sfwEntityField,e,"sfwEntityField","sfwEntityField",u.VALIDATION.ENTITY_FIELD_INCORRECT,undefined,!1,""))};n.validateEntityField=function(t){var e,c,h,f,s,o;n.fileScope||(n.fileScope=getCurrentFileScope());t.IsChildOfGrid?(e=FindParent(t,"sfwGridView"),e.Name=="sfwGridView"&&e.dictAttributes.sfwBoundToQuery&&e.dictAttributes.sfwBoundToQuery.toLowerCase()=="true"?(c=e.dictAttributes.sfwBaseQuery,angular.isArray(n.columnList)&&n.columnList.length==0?$.connection.hubForm.server.getEntityQueryColumns(c,"").done(function(i){n.$evalAsync(function(){n.columnList=r.getListByPropertyName(i,"CodeID",!1);r.checkValidListValue(n.columnList,t,t.dictAttributes.sfwEntityField,"sfwEntityField","sfwEntityField",u.VALIDATION.ENTITY_FIELD_INCORRECT,null)})}):r.checkValidListValue(n.columnList,t,t.dictAttributes.sfwEntityField,"sfwEntityField","sfwEntityField",u.VALIDATION.ENTITY_FIELD_INCORRECT,null)):n.checkEntityField(t)):n.checkEntityField(t);n.model&&(n.model.Name=="sfwDropDownList"||n.model.Name=="sfwCascadingDropDownList"||n.model.Name=="sfwMultiSelectDropDownList")&&(h=i.getEntityIntellisense(),f="",n.lstloadedentitytrees&&(s=n.lstloadedentitytrees.filter(function(n){return n.IsVisible})),s&&s.length>0?f=s[0].EntityName:n.formodel&&(f=n.formodel.dictAttributes.sfwEntity),o="",f&&(n.IsSearchCriteriaSelected&&n.model.dictAttributes.sfwDataField?o=GetCodeIDForLookup(f,n.model.dictAttributes.sfwDataField,h):n.model.dictAttributes.sfwEntityField&&(o=GetCodeID(f,n.model.dictAttributes.sfwEntityField,h)),n.model.placeHolder=o?o:""))};n.onDataFieldKeyDown=function(t){var e=$(t.target),u,r,f,o,s,l,a,v,h,c;if(n.dataFieldList=undefined,n.attributeName="ID",n.model.IsShowDataField){if(r=[],FindControlListByName(n.formodel,"sfwButton",r),r&&r.length>0&&(r=r.filter(function(n){return n.dictAttributes.sfwMethodName=="btnGridSearch_Click"}),r&&r.length>0)){for(f=0;f<r.length;f++)if(r[f].dictAttributes.sfwNavigationParameter&&(o=r[f].dictAttributes.sfwNavigationParameter.split(";"),o&&o.length>0&&o.some(function(t){return t==n.model.dictAttributes.ID}))){objFilterGridButton=r[f];break}objFilterGridButton&&objFilterGridButton.dictAttributes.sfwRelatedControl&&(s=FindControlByID(n.formodel,objFilterGridButton.dictAttributes.sfwRelatedControl),s&&s.dictAttributes.sfwBaseQuery&&$.connection.hubForm.server.getEntityQueryColumns(s.dictAttributes.sfwBaseQuery,"ScopeId_"+n.$id).done(function(t){t&&(n.lstColumns=t,n.attributeName="CodeID",setSingleLevelAutoComplete(e,n.lstColumns,n,n.attributeName))}))}}else n.model.dictAttributes.sfwQueryID?u=PopulateQueryColumnFromList(n.model.dictAttributes.sfwQueryID,n.lstloadedentitycolumnstree,n.formodel):(l=i.getEntityIntellisense(),a=GetMainQueryFromFormObject(n.formodel,l),a?u=PopulateQueryColumnFromList(a.dictAttributes.ID,n.lstloadedentitycolumnstree,n.formodel):(n.attributeName="Value",n.formodel&&n.formodel.dictAttributes.sfwEntity&&(u=getEntityAttributeByType(l,n.formodel.dictAttributes.sfwEntity,"Column"))));if(u)if(t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE&&$(e).data("ui-autocomplete"))$(e).autocomplete("search",""),t.preventDefault();else{if(v=[],h=[e[0].innerText],h.length>0){for(c=0;c<h.length;c++)v=u.filter(function(n){if(n.ID)return n.ID.toLowerCase().contains(h[c].toLowerCase())});u=v}n.dataFieldList=u;setSingleLevelAutoComplete(e,u,n,n.attributeName)}};n.checkDataFieldValueAndClearList=function(){n.dataFieldList=undefined};n.onQueryIDKeyDown=function(t){setSingleLevelAutoComplete($(t.target),getQueryBookMarksID(n.formodel))}}}}]);