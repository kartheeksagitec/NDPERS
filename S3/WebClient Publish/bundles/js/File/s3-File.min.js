app.controller("FileController",["$scope","$http","$rootScope","ngDialog","$filter","$EntityIntellisenseFactory","$timeout",function(n,t,i,r,u,f,e){function o(){n.recordQueryChange()}n.dataformats=["","MMddyy","yyyyMMdd","MM/dd/yyyy","ImpliedDecimal","SignedImpliedDecimal"];n.datatypes=["","String","Numeric","Decimal","DateTime"];n.recordType=["","CommaDelimited","FixedLength","Header","Footer","Detail","Trailer","AutoSkip"];i.currentopenfile.file.FileType=="InboundFile"?n.recordType.splice(7,1):i.currentopenfile.file.FileType=="OutboundFile"&&(n.recordType.splice(1,1),n.recordType.splice(1,1));n.outBoundDataFormats=["","{0:0.00}","{0:000.00}","{0:00000.00}","{0:000000.00}","{0:00000000.00}","{0:000000000.00}","{0:00000000000.00}","{0:000-00-0000}","{0:000000}","{0:#.00}","{0:#########.00}","{0:########0.00}","{0:###,###,###.00}","{0:####}","{0:######}","{0:########}","{0:#############}","{0:000-##-####}","{0:$#,###,###.00}","{0:d}","{0:hhmm}","{0:MMddyyyy}","{0:MM/dd/yyyy}","{0:MMyyyy}","{0:MM/yyyy}","{0:MMM yyyy}","{0:yyyyMMdd}"];n.outboundPaddingchars=["","*"];i.IsLoading=!0;n.IsItemsSelected=!0;n.IsOutboundItemsSelected=!0;n.currentfile=i.currentopenfile.file;n.objFile={};n.objFile.SelectedEntityObjectTreeFields=[];n.dummyEntityProperties=[];n.objFile.SelecetdField=undefined;n.objFile.LstDisplayedEntities=[];n.lstEntityNames=[];n.entityNameForEntityTree="";n.selectedDesignSource=!1;n.BusObjectName="";n.objBusinessObject={};n.objBusinessObject.ObjTree=undefined;n.objBusinessObjectTree={};n.objBusinessObjectTree.lstdisplaybusinessobject=[];n.objBusinessObjectTree.lstmultipleselectedfields=[];n.objBusinessObjectTree.lstCurrentBusinessObjectProperties=[];hubMain.server.getModel(n.currentfile.FilePath,n.currentfile.FileType).done(function(t){t?n.receivefilemodel(t):i.closeFile(n.currentfile.FileName)});n.receivefilemodel=function(t){n.$apply(function(){i.IsLoading=!1;n.objFileExtraFields=[];n.objFile=t;n.lstObjectMethod=n.objFile.objExtraData.MethodNames;n.lstFileCollection=n.objFile.objExtraData.FieldNames;n.objFile.IsChildOfInboundFileBase=n.objFile.objExtraData.IsChildOfInboundFileBase;n.objFile.lstObjectMethod=n.objFile.objExtraData.MethodNames;n.objFile.lstFileCollection=n.objFile.objExtraData.FieldNames;!n.objFile.dictAttributes.sfwIsDelimited&&n.objFile.IsChildOfInboundFileBase&&(n.objFile.dictAttributes.sfwIsDelimited="False");n.objFile.lstFileCollection.push("");for(var r=0;r<n.objFile.Elements.length>0;r++)if(n.objFile.Elements[r].Name=="record"){n.SelectedRecordClick(n.objFile.Elements[r]);break}n.objFileExtraFields=u("filter")(n.objFile.Elements,{Name:"ExtraFields"});n.objFileExtraFields.length>0&&(n.objFileExtraFields=n.objFileExtraFields[0]);n.objFileExtraFields.length==0&&(n.objFileExtraFields={Name:"ExtraFields",Value:"",dictAttributes:{},Elements:[]})});n.SetDummyRecordTypeAndHeaderObjectID()};n.ToggleUIDesginAttribute=function(n,t){n.length>0&&n[n.length-1].Name!="ExtraFields"&&(n[n.length-1].isAdvanceSearched=t)};n.traverseMainModel=function(t){var u=[],i,r;if(t.contains("-")||t.contains(","))for(i=n.objFile,r=0;r<t.split(",").length;r++)i=n.FindNodeHierarchy(i,t.split(",")[r].substring(t.split(",")[r].lastIndexOf("-")+1)),i&&u.push(i);return u};n.selectElement=function(t){if(t!=null&&t!="file"&&t!=""){var r=n.traverseMainModel(t),u="";r.length>0&&r[0].Name=="record"&&(n.SelectedRecordClick(r[0]),n.ActiveTabForFile="Items",u="s3-file-record-list");r.length>1&&r[r.length-1]&&r[r.length-1].Name=="sfwField"&&(n.selectedRecordRowClick(r[r.length-1]),u="s3-file-field-list");r.length>0&&setTimeout(function(){if(u){var i=$("#"+n.currentfile.FileName+" #"+u).find(".selected");i&&t!=null&&t!="file"&&t!=""&&i.length>0&&i[0].scrollIntoView()}},500)}i.IsLoading=!1};n.ShowDesign=function(){var t,r,o,e;if(n.selectedDesignSource==!0&&(n.showSource=!1,t=n.editor.getValue(),t!=null&&t!="")){if(i.IsLoading=!0,r=n.editor.selection.getCursor().row,r=r+1,t.length<32e3)hubMain.server.getDesignXmlString(t,n.currentfile,r);else{o=[];o[0]=r>0?r:1;var u="",h=[],f=0;for(e=0;e<t.length;e++)f++,u=u+t[e],f==32e3&&(f=0,h.push(u),u="");f!=0&&h.push(u);s(h,n.currentfile,"Source-Design",o)}n.receivefiledesignxmlobject=function(t,i){n.selectedDesignSource=!1;n.isSourceDirty&&(n.receivefilemodel(t),n.isSourceDirty=!1);n.$evalAsync(n.selectElement(i))}}};n.isSourceDirty;n.sourceChanged=function(){n.isSourceDirty=!0;n.isDirty=!0;n.SearchSource.IsSearchCriteriaChange=!0};var s=function(n,t,i,r){for(var u=0;u<n.length;u++)hubMain.server.receiveDataPackets(n[u],n.length,t,u,i,r)};n.ShowSource=function(){var v,l,a,h,f;if(n.selectedDesignSource==!1&&(n.selectedDesignSource=!0,l=[],n.objFile)){i.IsLoading=!0;var y=GetBaseModel(n.objFile),r=JSON.stringify(y),e=[],o;if(o=n.selectedCurrentRecord&&n.selectedCurrentRecordRow==undefined?n.selectedCurrentRecord:n.selectedCurrentRecordRow,o&&(h=[],v=n.FindDeepNode(n.objFile,o,h),a=n.getPathSource(n.objFile,h,l),angular.copy(a,e)),r.length<32e3)hubMain.server.getSourceXmlObject(r,n.currentfile,e);else{var t="",c=[],u=0;for(f=0;f<r.length;f++)u++,t=t+r[f],u==32e3&&(u=0,c.push(t),t="");u!=0&&c.push(t);s(c,n.currentfile,"Design-Source",e)}n.receivesourcexml=function(t,r){n.$apply(function(){n.xmlSource=t;var u=n.currentfile.FileName;setDataToEditor(n,t,r,u);n.$evalAsync(function(){i.IsLoading=!1;n.selectedCurrentRecordRow=undefined});window.navigator.userAgent.toLowerCase().contains("chrome")&&(i.IsLoading=!1)})}}};n.FindNodeHierarchy=function(n,t){if(n&&n.Elements){var i=n.Elements[t];return i==undefined&&(i=n.Elements[t-1]),i}};n.FindDeepNode=function(t,i,r){return t&&angular.forEach(t.Elements,function(t){var u=n.isValidObject(t,i);return(u&&r.push(t),t==i)?i:t.Elements&&t.Elements.length>0?i=n.FindDeepNode(t,i,r):void 0}),i};n.getPathSource=function(n,t,i){for(var u,r=0;r<t.length;r++)r==0?(u=n.Elements.indexOf(t[r]),i.push(u)):(u=t[r-1].Elements.indexOf(t[r]),i.push(u));return i};n.isValidObject=function(t,i){var u,r;if(t==i)return!0;for(r in t.Elements){if(t.Elements[r]==i)return!0;if(t.Elements[r].Elements&&t.Elements[r].Elements.length>0)for(iele in t.Elements[r].Elements)if(u=n.isValidObject(t.Elements[r].Elements[iele],i),u==!0)return u}return u};n.SetDummyRecordTypeAndHeaderObjectID=function(){if(n.objFile.Elements.length>0){function t(t){t.Name=="record"&&(t.DummyRecordType=t.dictAttributes.sfwRecordType,n.objFile&&n.objFile.dictAttributes.sfwType=="Inbound"&&(t.DummyHeaderEntity=t.dictAttributes.sfwHeaderEntity))}angular.forEach(n.objFile.Elements,t)}};n.onDetailClick=function(){var t=n.$new(),r,u;if(t.objExtraFields=[],t.objDirFunctions={},t.showExtraFieldsTab=!1,t.formName="File",n.objFile.dictAttributes.sfwType=="Inbound")t.objInboundFile=n.objFile,t.objInboundDetails={},t.objInboundDetails.dictAttributes={},t.objInboundDetails.IsChildOfInboundFileBase=t.objInboundFile.IsChildOfInboundFileBase,t.objInboundDetails.dictAttributes.ID=t.objInboundFile.dictAttributes.ID,t.objInboundDetails.dictAttributes.sfwInboundObject=t.objInboundFile.dictAttributes.sfwInboundObject,t.objInboundDetails.dictAttributes.sfwDelimitedBy=t.objInboundFile.dictAttributes.sfwDelimitedBy,t.objInboundDetails.dictAttributes.sfwDegreeOfParallelism=t.objInboundFile.dictAttributes.sfwDegreeOfParallelism,t.objInboundDetails.dictAttributes.sfwThresholdCommit=t.objInboundFile.dictAttributes.sfwThresholdCommit,t.objInboundDetails.dictAttributes.sfwRecieveToFileDetail=t.objInboundFile.dictAttributes.sfwRecieveToFileDetail,t.objInboundDetails.dictAttributes.sfwProcessInParallel=t.objInboundFile.dictAttributes.sfwProcessInParallel,t.objInboundDetails.dictAttributes.sfwCommitSingle=t.objInboundFile.dictAttributes.sfwCommitSingle,t.objInboundDetails.dictAttributes.sfwProcessDetail=t.objInboundFile.dictAttributes.sfwProcessDetail,t.objInboundDetails.dictAttributes.sfwDescription=t.objInboundFile.dictAttributes.sfwDescription,t.objInboundDetails.dictAttributes.sfwTitle=t.objInboundFile.dictAttributes.sfwTitle,t.objInboundDetails.dictAttributes.sfwIsDelimited=t.objInboundFile.dictAttributes.sfwIsDelimited,t.objInboundDetails.dictAttributes.sfwProgressCounter=t.objInboundFile.dictAttributes.sfwProgressCounter,t.objInboundDetails.dictAttributes.sfwActive=t.objInboundFile.dictAttributes.sfwActive,t.objInboundDetails.dictAttributes.sfwUploadInParallel=t.objInboundFile.dictAttributes.sfwUploadInParallel,t.objInboundDetails.dictAttributes.sfwUploadToFileDetail=t.objInboundFile.dictAttributes.sfwUploadToFileDetail,t.objInboundDetails.dictAttributes.sfwGetGroupValueFromHeader=t.objInboundFile.dictAttributes.sfwGetGroupValueFromHeader,t.objInboundDetails.dictAttributes.sfwEncodingType=t.objInboundFile.dictAttributes.sfwEncodingType,t.dialogOptions={height:700,width:700},t.templateName="File/views/InboundFileDetails.html";else{if(t.objOutboundFile=n.objFile,t.objOutBound={},t.objOutBound.dictAttributes={},t.objOutBound.dictAttributes.sfwType=t.objOutboundFile.dictAttributes.sfwType,t.objOutBound.dictAttributes.ID=t.objOutboundFile.dictAttributes.ID,t.objOutBound.dictAttributes.sfwOutboundObject=t.objOutboundFile.dictAttributes.sfwOutboundObject,t.objOutBound.dictAttributes.sfwLoadMethod=t.objOutboundFile.dictAttributes.sfwLoadMethod,t.objOutBound.dictAttributes.sfwFileName=t.objOutboundFile.dictAttributes.sfwFileName,t.objOutBound.dictAttributes.sfwDescription=t.objOutboundFile.dictAttributes.sfwDescription,t.objOutBound.dictAttributes.sfwTitle=t.objOutboundFile.dictAttributes.sfwTitle,t.objOutBound.dictAttributes.sfwQueryID=t.objOutboundFile.dictAttributes.sfwQueryID,t.objOutBound.dictAttributes.sfwProgressCounter=t.objOutboundFile.dictAttributes.sfwProgressCounter,t.objOutBound.lstFileCollection=t.objOutboundFile.lstFileCollection,t.objOutBound.lstObjectMethod=t.objOutboundFile.lstObjectMethod,t.objOutBound.dictAttributes.sfwXMLType=t.objOutboundFile.dictAttributes.sfwXMLType,t.objOutBound.dictAttributes.sfwFileNameMapper=t.objOutboundFile.dictAttributes.sfwFileNameMapper,t.dialogOptions={height:700,width:700},t.objOutboundFile.dictAttributes.sfwCollection)for(r=0;r<t.objOutboundFile.lstFileCollection.length;r++)u=t.objOutboundFile.lstFileCollection[r].split(":"),u[0]==t.objOutboundFile.dictAttributes.sfwCollection&&(t.objOutBound.dictAttributes.sfwCollection=t.objOutboundFile.lstFileCollection[r]);t.templateName="File/views/OutboundFileDetails.html";t.onChangeBusinessObject=function(){n.lstobjecttree=[];n.objBusinessObject.ObjTree=undefined;n.selectedCurrentRecord&&i.EditPropertyValue(n.selectedCurrentRecord.sfwRecordObject,n.selectedCurrentRecord,"sfwRecordObject","");t.objOutboundFile.BusinessObject&&t.objOutboundFile.BusinessObject.length>0?t.objOutboundFile.dictAttributes&&t.objOutboundFile.dictAttributes.sfwOutboundObject&&(lst=t.objOutboundFile.dictAttributes.sfwOutboundObject.split("."),n.selectedCurrentRecord&&n.selectedCurrentRecord.dictAttributes.sfwRecordType=="AutoSkip"&&n.selectedCurrentRecord.dictAttributes.sfwObjectID?i.EditPropertyValue(n.BusObjectName,n,"BusObjectName",n.selectedCurrentRecord.dictAttributes.sfwObjectID):lst.length>0&&i.EditPropertyValue(n.BusObjectName,n,"BusObjectName",lst[lst.length-1])):(i.EditPropertyValue(n.BusObjectName,n,"BusObjectName",""),n.selectedCurrentRecord&&n.selectedCurrentRecord.dictAttributes.sfwRecordType=="AutoSkip"&&n.selectedCurrentRecord.dictAttributes.sfwObjectID&&i.EditPropertyValue(n.BusObjectName,n,"BusObjectName",n.selectedCurrentRecord.dictAttributes.sfwObjectID))}}t.templateName&&t.templateName.trim().length>0&&(t.dialog=i.showDialog(t,"Details",t.templateName,t.dialogOptions));t.validateFileDetails=function(){t.FileDetailsErrorMessage="";t.objDirFunctions.getExtraFieldData&&(t.objExtraFields=t.objDirFunctions.getExtraFieldData());var n=validateExtraFields(t);return t.FileDetailsErrorMessage=t.FormDetailsErrorMessage,n};t.onProcessInParallelChanged=function(){t.objInboundDetails.dictAttributes.sfwProcessInParallel=="True"&&(t.objInboundDetails.dictAttributes.sfwCommitSingle="False")};t.OnInboundObjectIdChange=function(){t.objInboundDetails&&(t.objInboundDetails.IsChildOfInboundFileBase?(t.objInboundDetails.dictAttributes.sfwUploadToFileDetail="True",t.objInboundDetails.dictAttributes.sfwCommitSingle="True",t.objInboundDetails.dictAttributes.sfwProcessDetail="True",t.objInboundDetails.dictAttributes.sfwIsDelimited||(t.objInboundDetails.dictAttributes.sfwIsDelimited="False")):(t.objInboundDetails.dictAttributes.sfwRecieveToFileDetail="False",t.objInboundDetails.dictAttributes.sfwUploadInParallel="False",t.objInboundDetails.dictAttributes.sfwUploadToFileDetail="False",t.objInboundDetails.dictAttributes.sfwGetGroupValueFromHeader="False",t.objInboundDetails.dictAttributes.sfwProcessInParallel="False",t.objInboundDetails.dictAttributes.sfwCommitSingle="False"))};t.okClick=function(){if(alert("Updation of file details will update the XML file only. For DB update, user should do it manually."),n.objFile.dictAttributes.sfwType!="Inbound"){if(n.objFile.dictAttributes.sfwType=t.objOutBound.dictAttributes.sfwType,n.objFile.dictAttributes.ID=t.objOutBound.dictAttributes.ID,i.UndRedoBulkOp("Start"),i.EditPropertyValue(n.objFile.dictAttributes.sfwLoadMethod,n.objFile.dictAttributes,"sfwLoadMethod",t.objOutBound.dictAttributes.sfwLoadMethod),i.EditPropertyValue(n.objFile.dictAttributes.sfwFileName,n.objFile.dictAttributes,"sfwFileName",t.objOutBound.dictAttributes.sfwFileName),i.EditPropertyValue(n.objFile.dictAttributes.sfwDescription,n.objFile.dictAttributes,"sfwDescription",t.objOutBound.dictAttributes.sfwDescription),i.EditPropertyValue(n.objFile.dictAttributes.sfwXMLType,n.objFile.dictAttributes,"sfwXMLType",t.objOutBound.dictAttributes.sfwXMLType),i.EditPropertyValue(n.objFile.dictAttributes.sfwTitle,n.objFile.dictAttributes,"sfwTitle",t.objOutBound.dictAttributes.sfwTitle),i.EditPropertyValue(n.objFile.dictAttributes.sfwQueryID,n.objFile.dictAttributes,"sfwQueryID",t.objOutBound.dictAttributes.sfwQueryID),i.EditPropertyValue(n.objFile.dictAttributes.sfwProgressCounter,n.objFile.dictAttributes,"sfwProgressCounter",t.objOutBound.dictAttributes.sfwProgressCounter),i.EditPropertyValue(n.objFile.dictAttributes.sfwFileNameMapper,n.objFile.dictAttributes,"sfwFileNameMapper",t.objOutBound.dictAttributes.sfwFileNameMapper),i.EditPropertyValue(n.objFile.lstFileCollection,n.objFile,"lstFileCollection",t.objOutBound.lstFileCollection),i.EditPropertyValue(n.objFile.lstObjectMethod,n.objFile,"lstObjectMethod",t.objOutBound.lstObjectMethod),t.objOutboundFile.dictAttributes.sfwOutboundObject!=t.objOutBound.dictAttributes.sfwOutboundObject&&(i.EditPropertyValue(n.objFile.dictAttributes.sfwOutboundObject,n.objFile.dictAttributes,"sfwOutboundObject",t.objOutBound.dictAttributes.sfwOutboundObject),i.EditPropertyValue(n.objFile.BusinessObject,n.objFile,"BusinessObject",t.objOutBound.BusinessObject),t.onChangeBusinessObject()),t.objOutBound.dictAttributes.sfwCollection&&t.objOutBound.dictAttributes.sfwCollection!=null){var r=t.objOutBound.dictAttributes.sfwCollection.split(":");r.length>0?i.EditPropertyValue(n.objFile.dictAttributes.sfwCollection,n.objFile.dictAttributes,"sfwCollection",r[0]):i.EditPropertyValue(n.objFile.dictAttributes.sfwCollection,n.objFile.dictAttributes,"sfwCollection","")}else i.EditPropertyValue(n.objFile.dictAttributes.sfwCollection,n.objFile.dictAttributes,"sfwCollection","");i.UndRedoBulkOp("End")}else n.objFile.dictAttributes.ID=t.objInboundDetails.dictAttributes.ID,i.UndRedoBulkOp("Start"),i.EditPropertyValue(n.objFile.IsChildOfInboundFileBase,n.objFile,"IsChildOfInboundFileBase",t.objInboundDetails.IsChildOfInboundFileBase),i.EditPropertyValue(n.objFile.dictAttributes.sfwInboundObject,n.objFile.dictAttributes,"sfwInboundObject",t.objInboundDetails.dictAttributes.sfwInboundObject),i.EditPropertyValue(n.objFile.dictAttributes.sfwDelimitedBy,n.objFile.dictAttributes,"sfwDelimitedBy",t.objInboundDetails.dictAttributes.sfwDelimitedBy),i.EditPropertyValue(n.objFile.dictAttributes.sfwDegreeOfParallelism,n.objFile.dictAttributes,"sfwDegreeOfParallelism",t.objInboundDetails.dictAttributes.sfwDegreeOfParallelism),i.EditPropertyValue(n.objFile.dictAttributes.sfwThresholdCommit,n.objFile.dictAttributes,"sfwThresholdCommit",t.objInboundDetails.dictAttributes.sfwThresholdCommit),i.EditPropertyValue(n.objFile.dictAttributes.sfwRecieveToFileDetail,n.objFile.dictAttributes,"sfwRecieveToFileDetail",t.objInboundDetails.dictAttributes.sfwRecieveToFileDetail),i.EditPropertyValue(n.objFile.dictAttributes.sfwProcessInParallel,n.objFile.dictAttributes,"sfwProcessInParallel",t.objInboundDetails.dictAttributes.sfwProcessInParallel),i.EditPropertyValue(n.objFile.dictAttributes.sfwCommitSingle,n.objFile.dictAttributes,"sfwCommitSingle",t.objInboundDetails.dictAttributes.sfwCommitSingle),i.EditPropertyValue(n.objFile.dictAttributes.sfwProcessDetail,n.objFile.dictAttributes,"sfwProcessDetail",t.objInboundDetails.dictAttributes.sfwProcessDetail),i.EditPropertyValue(n.objFile.dictAttributes.sfwDescription,n.objFile.dictAttributes,"sfwDescription",t.objInboundDetails.dictAttributes.sfwDescription),i.EditPropertyValue(n.objFile.dictAttributes.sfwTitle,n.objFile.dictAttributes,"sfwTitle",t.objInboundDetails.dictAttributes.sfwTitle),i.EditPropertyValue(n.objFile.dictAttributes.sfwIsDelimited,n.objFile.dictAttributes,"sfwIsDelimited",t.objInboundDetails.dictAttributes.sfwIsDelimited),i.EditPropertyValue(n.objFile.dictAttributes.sfwProgressCounter,n.objFile.dictAttributes,"sfwProgressCounter",t.objInboundDetails.dictAttributes.sfwProgressCounter),i.EditPropertyValue(n.objFile.dictAttributes.sfwActive,n.objFile.dictAttributes,"sfwActive",t.objInboundDetails.dictAttributes.sfwActive),i.EditPropertyValue(n.objFile.dictAttributes.sfwUploadInParallel,n.objFile.dictAttributes,"sfwUploadInParallel",t.objInboundDetails.dictAttributes.sfwUploadInParallel),i.EditPropertyValue(n.objFile.dictAttributes.sfwUploadToFileDetail,n.objFile.dictAttributes,"sfwUploadToFileDetail",t.objInboundDetails.dictAttributes.sfwUploadToFileDetail),i.EditPropertyValue(n.objFile.dictAttributes.sfwGetGroupValueFromHeader,n.objFile.dictAttributes,"sfwGetGroupValueFromHeader",t.objInboundDetails.dictAttributes.sfwGetGroupValueFromHeader),i.EditPropertyValue(n.objFile.dictAttributes.sfwEncodingType,n.objFile.dictAttributes,"sfwEncodingType",t.objInboundDetails.dictAttributes.sfwEncodingType),i.UndRedoBulkOp("End");t.objDirFunctions.prepareExtraFieldData&&t.objDirFunctions.prepareExtraFieldData();t.dialog&&t.dialog.close();n.recordQueryChange()}};n.onChangeBusinessObject=function(){n.lstobjecttree=[];n.objBusinessObject.ObjTree=undefined;n.selectedCurrentRecord&&(n.selectedCurrentRecord.sfwRecordObject="");n.selectedCurrentRecord&&n.selectedCurrentRecord.dictAttributes.sfwObjectID&&n.selectedCurrentRecord.dictAttributes.sfwObjectID!=""?n.BusObjectName=n.selectedCurrentRecord.dictAttributes.sfwObjectID:n.objFile.dictAttributes&&n.objFile.dictAttributes.sfwOutboundObject&&(lst=n.objFile.dictAttributes.sfwOutboundObject.split("."),lst.length>0&&(n.BusObjectName=lst[lst.length-1]))};n.AddonlyObjectIDtoObject=function(t){var r,u,i;n.selectedCurrentRecord&&(t||(n.selectedCurrentRecord.dictAttributes.sfwRecordObject=""),n.selectedCurrentRecord&&t&&t.contains(":")?(r=t.split(":"),n.selectedCurrentRecord.dictAttributes.sfwRecordObject=r[0],u=t.substring(t.lastIndexOf("[")+1,t.lastIndexOf("]")),n.BusObjectName=u):(n.lstobjecttree=[],n.objBusinessObject.ObjTree=undefined,n.objFile.dictAttributes.sfwOutboundObject&&n.objFile.dictAttributes.sfwOutboundObject!=""&&(i=n.objFile.dictAttributes.sfwOutboundObject.split("."),n.BusObjectName=i[i.length-1])))};n.SelectedRecordClick=function(t){var r,i,u,f;if(n.selectedCurrentRecordRow=undefined,n.selectedCurrentRecord=t,n.objFile.SelecetdField=undefined,n.AddEntityIDinList(t,!1),n.entityNameForEntityTree="",t&&t.dictAttributes.sfwHeaderEntity&&t.dictAttributes.sfwHeaderEntity!=""&&(n.entityNameForEntityTree=t.dictAttributes.sfwHeaderEntity),t&&t.dictAttributes.sfwDetailEntity&&t.dictAttributes.sfwDetailEntity!=""&&(n.entityNameForEntityTree=t.dictAttributes.sfwDetailEntity),n.objBusinessObject.ObjTree=undefined,n.lstobjecttree=[],n.objFile.dictAttributes.sfwType!="Inbound"&&n.selectedCurrentRecord)if(n.selectedCurrentRecord.dictAttributes.sfwRecordType&&n.selectedCurrentRecord.dictAttributes.sfwObjectID)n.selectedCurrentRecord.dictAttributes.sfwRecordType=="AutoSkip"&&n.selectedCurrentRecord.dictAttributes.sfwObjectID!=""&&(n.BusObjectName=n.selectedCurrentRecord.dictAttributes.sfwObjectID);else if(n.selectedCurrentRecord.dictAttributes.sfwRecordType&&n.selectedCurrentRecord.dictAttributes.sfwRecordType!="AutoSkip"&&!n.selectedCurrentRecord.dictAttributes.sfwRecordObject)n.objFile.dictAttributes.sfwOutboundObject&&n.objFile.dictAttributes.sfwOutboundObject!=""&&(r=n.objFile.dictAttributes.sfwOutboundObject.split("."),n.BusObjectName=r[r.length-1]);else if(n.selectedCurrentRecord.dictAttributes.sfwRecordObject){for(i=0;i<n.objFile.lstFileCollection.length;i++)if(u=n.objFile.lstFileCollection[i].split(":"),u[0]==n.selectedCurrentRecord.dictAttributes.sfwRecordObject){n.selectedCurrentRecord.sfwRecordObject=n.objFile.lstFileCollection[i];f=n.objFile.lstFileCollection[i].substring(n.objFile.lstFileCollection[i].lastIndexOf("[")+1,n.objFile.lstFileCollection[i].lastIndexOf("]"));n.BusObjectName=f;break}}else n.selectedCurrentRecord&&(n.selectedCurrentRecord.sfwRecordObject="",n.BusObjectName="",n.objFile.dictAttributes.sfwOutboundObject&&(lst=n.objFile.dictAttributes.sfwOutboundObject.split("."),lst.length>0&&(n.BusObjectName=lst[lst.length-1])));n.recordQueryChange()};n.AddEntityIDinList=function(t,i){n.lstEntityNames=[];i&&n.OnInboundHeaderIdChanged(event);t&&(t.errors="",t.dictAttributes.sfwHeaderEntity&&t.dictAttributes.sfwHeaderEntity!=""&&n.lstEntityNames.push(t.dictAttributes.sfwHeaderEntity),t.dictAttributes.sfwDetailEntity&&t.dictAttributes.sfwDetailEntity!=""&&n.lstEntityNames.push(t.dictAttributes.sfwDetailEntity),t.dictAttributes.sfwHeaderEntity&&t.dictAttributes.sfwDetailEntity&&t.dictAttributes.sfwHeaderEntity===t.dictAttributes.sfwDetailEntity&&(t.errors="Header entity and detail entity can not be same"))};n.onItemsClick=function(){n.IsItemsSelected=!0;n.IsEntityTreeSelected=!1};n.onEntityTreeClick=function(){n.IsItemsSelected=!1;n.IsEntityTreeSelected=!0};n.selectedRecordRowClick=function(t){t&&(n.selectedCurrentRecordRow=t)};n.deleteSelectedRow=function(){var t=-1,r;n.selectedCurrentRecordRow&&(t=n.selectedCurrentRecord.Elements.indexOf(n.selectedCurrentRecordRow),t>-1&&(r="",n.selectedCurrentRecordRow.dictAttributes.sfwEntityField?r=n.selectedCurrentRecordRow.dictAttributes.sfwEntityField:n.objFile.dictAttributes.sfwType=="Outbound"&&(r=n.selectedCurrentRecordRow.dictAttributes.sfwObjectField),confirm("FieldID : '"+r+"'   will be deleted, Do you wan.t to continue?")&&(i.DeleteItem(n.selectedCurrentRecord.Elements[t],n.selectedCurrentRecord.Elements),n.selectedCurrentRecordRow=undefined,t<n.selectedCurrentRecord.Elements.length?n.selectedCurrentRecordRow=n.selectedCurrentRecord.Elements[t]:n.selectedCurrentRecord.Elements.length>0&&(n.selectedCurrentRecordRow=n.selectedCurrentRecord.Elements[t-1]),n.isDirty=!0)))};n.canDeleteRow=function(){return n.selectedCurrentRecordRow?!0:!1};n.moveSelectedRowUp=function(){if(n.selectedCurrentRecordRow){var t=n.selectedCurrentRecord.Elements.indexOf(n.selectedCurrentRecordRow),r=n.selectedCurrentRecordRow;i.UndRedoBulkOp("Start");i.DeleteItem(n.selectedCurrentRecordRow,n.selectedCurrentRecord.Elements);i.InsertItem(r,n.selectedCurrentRecord.Elements,t-1);i.UndRedoBulkOp("End");n.scrollBySelection(".field-binding-table",".selected")}};n.canmoveSelectedRowUp=function(){if(n.Flag=!0,n.selectedCurrentRecordRow!=undefined)for(var t=0;t<n.selectedCurrentRecord.Elements.length;t++)n.selectedCurrentRecord.Elements[t]==n.selectedCurrentRecordRow&&t>0&&(n.Flag=!1);return n.Flag};n.moveSelectedRowDown=function(){if(n.selectedCurrentRecordRow&&n.selectedCurrentRecord.Elements.length>0){var t=n.selectedCurrentRecord.Elements.indexOf(n.selectedCurrentRecordRow),r=n.selectedCurrentRecordRow;i.UndRedoBulkOp("Start");i.DeleteItem(n.selectedCurrentRecordRow,n.selectedCurrentRecord.Elements);i.InsertItem(r,n.selectedCurrentRecord.Elements,t+1);i.UndRedoBulkOp("End");n.scrollBySelection(".field-binding-table",".selected")}};n.canmoveSelectedRowDown=function(){if(n.Flag=!0,n.selectedCurrentRecordRow!=undefined&&n.selectedCurrentRecord.Elements.length>0)for(var t=0;t<n.selectedCurrentRecord.Elements.length;t++)n.selectedCurrentRecord.Elements[t]==n.selectedCurrentRecordRow&&t<n.selectedCurrentRecord.Elements.length-1&&(n.Flag=!1);return n.Flag};n.addNewRecord=function(){var t={Name:"record",value:"",dictAttributes:{ID:"New Layout"},Elements:[]};i.PushItem(t,n.objFile.Elements,"SelectedRecordClick");n.SelectedRecordClick(t)};n.deleteRecord=function(){var u,r,t;if(n.selectedCurrentRecord)if(u=n.objFile.Elements.filter(function(n){return n.Name=="record"}),u.length>1){if(r=-1,r=n.objFile.Elements.indexOf(n.selectedCurrentRecord),r>-1&&confirm("RecordID : '"+n.selectedCurrentRecord.dictAttributes.ID+"'   will be deleted, Do you want to continue?")){if(i.DeleteItem(n.objFile.Elements[r],n.objFile.Elements,"SelectedRecordClick"),n.selectedCurrentRecord=undefined,n.selectedCurrentRecordRow=undefined,n.objFile.Elements.length>0)for(t=r;;)if(r==0){if(t<n.objFile.Elements.length){if(n.objFile.Elements[t]&&n.objFile.Elements[t].Name=="record"){n.SelectedRecordClick(n.objFile.Elements[t]);break}}else break;t++}else{if(t>=0){if(n.objFile.Elements[t]){if(n.objFile.Elements[t].Name=="record"){n.SelectedRecordClick(n.objFile.Elements[t]);break}}else if(n.objFile.Elements[t-1].Name=="record"){n.SelectedRecordClick(n.objFile.Elements[t-1]);break}}else break;t--}else n.selectedCurrentRecord=undefined;n.selectedRecord=r}}else alert("Atleast one record should be present.")};n.moveLayoutSelectedRowUp=function(){if(n.selectedCurrentRecord){var t=n.objFile.Elements.indexOf(n.selectedCurrentRecord),r=n.selectedCurrentRecord;i.UndRedoBulkOp("Start");i.DeleteItem(n.selectedCurrentRecord,n.objFile.Elements);i.InsertItem(r,n.objFile.Elements,t-1);i.UndRedoBulkOp("End");n.scrollBySelection(".files-sidebar",".active")}};n.canmoveLayoutSelectedRowUp=function(){if(n.Flag=!0,n.selectedCurrentRecord!=undefined)for(var t=0;t<n.objFile.Elements.length;t++)n.objFile.Elements[t]==n.selectedCurrentRecord&&t>0&&(n.Flag=!1);return n.Flag};n.scrollBySelection=function(n,t){e(function(){var r=$("#"+i.currentopenfile.file.FileName).find(n);if(r&&r.hasScrollBar())return r.scrollTo(r.find(t),{offsetTop:400,offsetLeft:0},null),!1})};n.moveLayoutSelectedRowDown=function(){if(n.selectedCurrentRecord&&n.objFile.Elements.length>0){var t=n.objFile.Elements.indexOf(n.selectedCurrentRecord),r=n.selectedCurrentRecord;i.UndRedoBulkOp("Start");i.DeleteItem(n.selectedCurrentRecord,n.objFile.Elements);i.InsertItem(r,n.objFile.Elements,t+1);i.UndRedoBulkOp("End");n.scrollBySelection(".files-sidebar",".active")}};n.canmoveLayoutSelectedRowDown=function(){if(n.Flag=!0,n.selectedCurrentRecord!=undefined&&n.objFile.Elements.length>0)for(var t=0;t<n.objFile.Elements.length;t++)n.objFile.Elements[t]==n.selectedCurrentRecord&&t<n.objFile.Elements.length-1&&(n.Flag=!1);return n.Flag};n.addNewFiller=function(){var t={};t.Value="";t.Name="sfwField";t.Elements=[];t.dictAttributes=n.objFile.dictAttributes.sfwType=="Inbound"?{sfwDescription:"Filler",sfwEntityField:"Filler",sfwDataFormat:"",sfwBindHeader:"",sfwCodeID:"",sfwRequired:""}:{sfwDescription:"Filler",sfwObjectField:"Filler",sfwDataFormat:"",sfwRemoveDecimal:"",sfwConstant:"",sfwPaddingCharacter:"",sfwEndNode:"",sfwStartNode:""};n.selectedCurrentRecord.dictAttributes.sfwRecordType!="CommaDelimited"&&(t.dictAttributes.sfwLength="0");i.PushItem(t,n.selectedCurrentRecord.Elements,"selectedRecordRowClick");n.selectedRecordRowClick(t)};n.addNewConstant=function(){var t={};t.Value="";t.Name="sfwField";t.Elements=[];t.dictAttributes={sfwDescription:"",sfwLength:"0",sfwObjectField:"",sfwDataFormat:"",sfwRemoveDecimal:"",sfwConstant:"",sfwPaddingCharacter:"",sfwEndNode:"",sfwStartNode:""};i.PushItem(t,n.selectedCurrentRecord.Elements,"selectedRecordRowClick");n.selectedRecordRowClick(t)};n.addNewFields=function(){var t,r,e,s,o,u;if(n.objFile.dictAttributes.sfwType=="Inbound"){if(n.objFile.SelectedEntityObjectTreeFields&&n.objFile.SelectedEntityObjectTreeFields.length>0)if(t=n.objFile.SelectedEntityObjectTreeFields.filter(function(n){return n.IsSelected&&n.IsSelected.toLowerCase()=="true"}),t&&t.length>0)for(r=0;r<t.length;r++){if(t[r].IsMainEntity)alert(String.format("'{0}' field cannot be added as it is entity.",t[r].ID));else if(t[r].Type&&t[r].Type!="Object"&&t[r].Type!="Collection"&&t[r].Type!="List"&&t[r].Type!="CDOCollection"){e=getDisplayedEntity(n.objFile.LstDisplayedEntities);s=t[r].ID;e&&e.strDisplayName!=""&&(s=e.strDisplayName+"."+t[r].ID);var l=s,u={},h=t[r].Value,a="";if(n.entityNameForEntityTree&&n.selectedCurrentRecord&&n.selectedCurrentRecord.dictAttributes.sfwHeaderEntity&&n.entityNameForEntityTree==n.selectedCurrentRecord.dictAttributes.sfwHeaderEntity&&(a="True"),h=n.CapitalizeFirstLetterInWord(h),u.Value="",u.Name="sfwField",u.Elements=[],u.dictAttributes={sfwDescription:h,sfwEntityField:l,sfwDataFormat:"",sfwBindHeader:a,sfwCodeID:"",sfwRequired:""},n.selectedCurrentRecord.dictAttributes.sfwRecordType!="CommaDelimited"&&(u.dictAttributes.sfwLength="0"),endsWith(t[r].Value,"_value")){var v=e.strID,y=f.getEntityIntellisense(),c=GetCodeID(v,t[r].ID,y);c||(c="0");u.dictAttributes.sfwCodeID=c}n.selectedCurrentRecord.Elements.some(function(n){return n.dictAttributes&&n.dictAttributes.sfwEntityField==l})||(i.PushItem(u,n.selectedCurrentRecord.Elements,"selectedRecordRowClick"),n.selectedRecordRowClick(u))}else alert(String.format("'{0}' field cannot be added as it is object/collection.",t[r].ID));t[r].IsSelected="False";t[r].IsRecordSelected=!1}else alert("Please select atleast one field from entity tree.")}else{if(n.selectedCurrentRecord)if(n.objFile.SelecetdField)n.AddSingleOrMultipleSelectedFields(n.objFile.SelecetdField),n.objFile.SelecetdField=undefined;else if(n.objBusinessObjectTree.lstmultipleselectedfields.length>0){for(o=0;o<n.objBusinessObjectTree.lstmultipleselectedfields.length;o++)n.AddSingleOrMultipleSelectedFields(n.objBusinessObjectTree.lstmultipleselectedfields[o]);n.objBusinessObjectTree.lstmultipleselectedfields=[]}else n.selectedCurrentRecord.dictAttributes&&n.selectedCurrentRecord.dictAttributes.sfwQueryID?(u={Name:"sfwField",dictAttributes:{sfwDescription:"",sfwLength:"0",sfwObjectField:"",sfwDataFormat:"",sfwRemoveDecimal:"",sfwConstant:"",sfwPaddingCharacter:"",sfwEndNode:"",sfwStartNode:""},Elements:[]},i.PushItem(u,n.selectedCurrentRecord.Elements,"selectedRecordRowClick"),n.selectedRecordRowClick(u)):alert("Please select a field from object tree.");n.ClearSelectedFieldList(n.objBusinessObjectTree.lstCurrentBusinessObjectProperties)}};n.AddSingleOrMultipleSelectedFields=function(t){var r;if(t.DataType&&t.DataType=="ValueType"){r={};r.Value="";r.Name="sfwField";r.Elements=[];var u="",e=getDisplayedEntity(n.objBusinessObjectTree.lstdisplaybusinessobject),f=e.strDisplayName;u=f?f+"."+t.ShortName:t.ShortName;r.dictAttributes={sfwDescription:t.ShortName,sfwLength:"0",sfwObjectField:u,sfwDataFormat:"",sfwRemoveDecimal:"",sfwConstant:"",sfwPaddingCharacter:"",sfwEndNode:"",sfwStartNode:""};n.selectedCurrentRecord.Elements.some(function(n){return n.dictAttributes&&n.dictAttributes.sfwObjectField&&n.dictAttributes.sfwObjectField==u})||(i.PushItem(r,n.selectedCurrentRecord.Elements,"selectedRecordRowClick"),n.selectedRecordRowClick(r))}else alert("Object/Collection Cannot be added")};n.ClearSelectedFieldList=function(n){angular.forEach(n,function(n){n.IsSelected&&n.IsSelected.toLowerCase()=="true"&&(n.IsSelected="false",n.IsRecordSelected=!1)})};n.CapitalizeFirstLetterInWord=function(n){for(var i=n.split("_"),r="",t=0;t<i.length;t++)t!=0&&(r+=" "),r+=i[t].charAt(0).toUpperCase()+i[t].slice(1);return r};n.openCodeIDDialog=function(){if(n.selectedCurrentRecordRow){var t=n.$new();t.selectedCurrentRecordRow=n.selectedCurrentRecordRow;t.selectedCurrentRecordRow.selectedCheckListIDValue=n.selectedCurrentRecordRow.selectedCheckListIDValue;t.SetCheckListValue=function(){t.selectedCurrentRecordRow.selectedCheckListIDValue!=undefined&&(n.selectedCurrentRecordRow.dictAttributes.sfwCodeID=t.selectedCurrentRecordRow.selectedCheckListIDValue.CodeID,r.close(t.openDialog.id))};t.CloseCheckList=function(){r.close(t.openDialog.id)};t.openDialog=r.open({template:"SearchCheckListValue",scope:t,closeByDocument:!1,className:"ngdialog-theme-default ngdialog-theme-custom"})}};n.openRequireMessageDialog=function(t){var r=n.$new();r.selectedCurrentRecordRow=JSON.parse(JSON.stringify(t));r.displayMessage={message:"m",severity:"s"};r.dialogOptions={height:500,width:900};r.templateName="File/views/InboundFileAttributes.html";r.selectedFieldValueMapper=null;r.templateName&&r.templateName.trim().length>0&&(r.dialog=i.showDialog(r,"Inbound Attributes",r.templateName,r.dialogOptions));r.addFieldValueMapper=function(){r.selectedCurrentRecordRow.Elements.push({Name:"sfwFieldValueMapper",dictAttributes:{},Elements:[]})};r.deleteFieldValueMapper=function(){if(r.selectedFieldValueMapper){var n=r.selectedCurrentRecordRow.Elements.indexOf(r.selectedFieldValueMapper);n>-1&&(r.selectedCurrentRecordRow.Elements.splice(n,1),r.selectedFieldValueMapper=null,n===r.selectedCurrentRecordRow.Elements.length&&n--,n>-1&&(r.selectedFieldValueMapper=r.selectedCurrentRecordRow.Elements[n]))}};r.canDeleteFieldValueMapper=function(){return r.selectedFieldValueMapper};r.selectFieldValueMapper=function(n){r.selectedFieldValueMapper=n};r.validate=function(){};r.okClick=function(){i.EditPropertyValue(t.dictAttributes,t,"dictAttributes",r.selectedCurrentRecordRow.dictAttributes);i.EditPropertyValue(t.Elements,t,"Elements",r.selectedCurrentRecordRow.Elements);r.closeDialog()};r.closeDialog=function(){r.dialog&&r.dialog.close()}};n.onChangeEntityTree=function(t){n.objFileSelecetdField=undefined;n.entityNameForEntityTree=t==null?"...":t};n.receiveObjectTree=function(t,i){n.$evalAsync(function(){var u=JSON.parse(t),r;i!=undefined&&i!=""?(r=getBusObjectByPath(i,n.objBusinessObject.ObjTree),r&&r.ItemType.Name==u.ObjName&&(r.ChildProperties=u.ChildProperties,r.lstMethods=u.lstMethods,r.HasLoadedProp=!0),SetParentForObjTreeChild(r)):(n.objBusinessObject.ObjTree=u,n.lstobjecttree=[],n.lstobjecttree.push(n.objBusinessObject.ObjTree),n.objBusinessObject.ObjTree.IsMainBusObject=!0,n.objBusinessObject.ObjTree.IsVisible=!0,SetParentForObjTreeChild(n.objBusinessObject.ObjTree))})};n.onRecordTypeChanged=function(){var r,t;n.selectedCurrentRecord&&(n.selectedCurrentRecord.dictAttributes.sfwRecordType=="CommaDelimited"?angular.forEach(n.selectedCurrentRecord.Elements,function(n){n.Name=="sfwField"&&(n.PrevLength=n.dictAttributes.sfwLength,n.dictAttributes.sfwLength="")}):(angular.forEach(n.selectedCurrentRecord.Elements,function(n){n.PrevLength!=undefined&&n.PrevLength!=""&&(n.dictAttributes.sfwLength=n.PrevLength)}),n.objFile.dictAttributes.sfwType=="Inbound"&&n.objFile.IsChildOfInboundFileBase&&n.selectedCurrentRecord.dictAttributes.sfwRecordType=="Header"&&(n.objFile.dictAttributes.sfwProcessDetail!=undefined&&n.objFile.dictAttributes.sfwProcessDetail!=""&&n.objFile.dictAttributes.sfwProcessDetail.toLowerCase()=="true"&&(r=confirm("Do you want to set record type as Header then Process Detail should be false"),r?n.objFile.dictAttributes.sfwProcessDetail="False":n.selectedCurrentRecord.dictAttributes.sfwRecordType=n.selectedCurrentRecord.DummyRecordType?n.selectedCurrentRecord.DummyRecordType:""),(n.objFile.dictAttributes.sfwUploadToFileDetail==undefined||n.objFile.dictAttributes.sfwUploadToFileDetail==""||n.objFile.dictAttributes.sfwUploadToFileDetail!=undefined&&n.objFile.dictAttributes.sfwUploadToFileDetail!=""&&n.objFile.dictAttributes.sfwUploadToFileDetail.toLowerCase()=="false")&&n.objFile.dictAttributes.sfwProcessInParallel!=undefined&&n.objFile.dictAttributes.sfwProcessInParallel!=""&&n.objFile.dictAttributes.sfwProcessInParallel.toLowerCase()=="true"&&(r=confirm("Do you want to set record type as Header then Process in Parallel should be false","Confirmation"),r?n.objFile.dictAttributes.sfwProcessInParallel="False":n.selectedCurrentRecord.dictAttributes.sfwRecordType=n.selectedCurrentRecord.DummyRecordType?n.selectedCurrentRecord.DummyRecordType:"")),n.selectedCurrentRecord.dictAttributes.sfwRecordType=="AutoSkip"?(i.UndRedoBulkOp("Start"),i.EditPropertyValue(n.selectedCurrentRecord.sfwRecordObject,n.selectedCurrentRecord,"sfwRecordObject",""),n.lstobjecttree=[],n.objBusinessObject.ObjTree=undefined,i.EditPropertyValue(n.selectedCurrentRecord.dictAttributes.sfwRecordObject,n.selectedCurrentRecord.dictAttributes,"sfwRecordObject",""),n.objFile.dictAttributes.sfwOutboundObject&&n.objFile.dictAttributes.sfwOutboundObject!=""&&(t=n.objFile.dictAttributes.sfwOutboundObject.split("."),n.BusObjectName=t[t.length-1]),i.UndRedoBulkOp("End")):(n.selectedCurrentRecord.DummyRecordType=="AutoSkip"||n.selectedCurrentRecord.DummyRecordType==undefined)&&n.selectedCurrentRecord.dictAttributes.sfwRecordType!="AutoSkip"&&(i.UndRedoBulkOp("Start"),i.EditPropertyValue(n.selectedCurrentRecord.dictAttributes.sfwObjectID,n.selectedCurrentRecord.dictAttributes,"sfwObjectID",""),n.lstobjecttree=[],n.objBusinessObject.ObjTree=undefined,n.objFile.dictAttributes.sfwOutboundObject&&n.objFile.dictAttributes.sfwOutboundObject!=""&&(t=n.objFile.dictAttributes.sfwOutboundObject.split("."),n.BusObjectName=t[t.length-1]),i.UndRedoBulkOp("End")),n.selectedCurrentRecord.DummyRecordType=n.selectedCurrentRecord.dictAttributes.sfwRecordType))};n.OnInboundHeaderIdChanged=function(t){if(n.selectedCurrentRecord){if(i.UndRedoBulkOp("Start"),n.selectedCurrentRecord.dictAttributes.sfwHeaderEntity!=undefined&&n.selectedCurrentRecord.dictAttributes.sfwHeaderEntity!=""&&(n.objFile.dictAttributes.sfwUploadToFileDetail==undefined||n.objFile.dictAttributes.sfwUploadToFileDetail==""||n.objFile.dictAttributes.sfwUploadToFileDetail!=undefined&&n.objFile.dictAttributes.sfwUploadToFileDetail!=""&&n.objFile.dictAttributes.sfwUploadToFileDetail.toLowerCase()=="false")&&n.objFile.dictAttributes.sfwProcessInParallel!=undefined&&n.objFile.dictAttributes.sfwProcessInParallel!=""&&n.objFile.dictAttributes.sfwProcessInParallel.toLowerCase()=="true"){var r=confirm("Do you want to set Header Object ID then Process in Parallel should be false");r?i.EditPropertyValue(n.objFile.dictAttributes.sfwProcessInParallel,n.objFile.dictAttributes,"sfwProcessInParallel","False"):(i.EditPropertyValue(n.selectedCurrentRecord.dictAttributes.sfwHeaderEntity,n.selectedCurrentRecord.dictAttributes,"sfwHeaderEntity",""),n.selectedCurrentRecord.dictAttributes.sfwHeaderEntity="",t&&t.preventDefault())}i.UndRedoBulkOp("End")}};n.NavigateToEntity=function(n){n&&n!=""&&hubMain.server.navigateToFile(n,"").done(function(n){i.openFile(n,undefined)})};n.addExtraFieldsDataInToMainModel=function(){if(n.objFileExtraFields){var t=n.objFile.Elements.indexOf(n.objFileExtraFields);t==-1&&n.objFile.Elements.push(n.objFileExtraFields)}};n.BeforeSaveToFile=function(){n.addExtraFieldsDataInToMainModel()};n.recordQueryChange=function(){if(n.ActiveTabForFile="Items",n.iblnShowQueryIntellisense=!1,n.strQueryID="",n.selectedCurrentRecord){(n.selectedCurrentRecord.dictAttributes.sfwQueryID||!n.objFile.dictAttributes.sfwOutboundObject&&n.objFile.dictAttributes.sfwQueryID)&&(n.iblnShowQueryIntellisense=!0);var t=n.selectedCurrentRecord.dictAttributes.sfwQueryID;t||n.objFile.dictAttributes.sfwOutboundObject||!n.objFile.dictAttributes.sfwQueryID||(t=n.objFile.dictAttributes.sfwQueryID);n.strQueryID!=t&&(n.strQueryID=t)}};n.$watch("objFile.dictAttributes.sfwOutboundObject",o);n.$watch("objFile.dictAttributes.sfwQueryID",o);n.$watch("selectedCurrentRecord.dictAttributes.sfwQueryID",o);n.setQueryParamter=function(t,r){var u=n.$new(!0),s,h,e,c,l,o;if(u.lstQuerySchema=[],u.setBusObjectName=function(n){u.BusObjectName=n;u.objBusinessObjectTree={lstdisplaybusinessobject:[],lstmultipleselectedfields:[],lstCurrentBusinessObjectProperties:[]};u.SelecetdField=undefined;u.ObjTree=undefined},n.objFile.dictAttributes&&n.objFile.dictAttributes.sfwOutboundObject?(s=n.objFile.dictAttributes.sfwOutboundObject.split("."),s.length>0&&u.setBusObjectName(s[s.length-1])):(h=n.objFile.dictAttributes.sfwQueryID,h&&h.contains(".")&&$.connection.hubForm.server.getEntityQueryColumns(h,"").done(function(n){if(n)for(var t=0;t<n.length;t++)u.lstQuerySchema.push(n[t].CodeID)})),u.lstParameter=[],u.lobjQuery=getQueryFromEntityIntellisense(t,f.getEntityIntellisense()),u.lobjQuery!==null&&(u.lstParameter=[],angular.forEach(u.lobjQuery.Parameters,function(n){var i="",t=n.ID,r;i=t.contains("@")?t.substring(t.indexOf("@")+1,t.length):t;r={DisplayField:i,ParameterField:t,ParameterValue:""};u.lstParameter.push(r)})),e=r.Elements.filter(function(n){return n.Name==="parameters"}),e.length>0)for(c=0;c<e[0].Elements.length;c++)for(l=e[0].Elements[c],o=0;o<u.lstParameter.length;o++)u.lstParameter[o].ParameterField==l.dictAttributes.ID&&(u.lstParameter[o].ParameterValue=l.dictAttributes.sfwQueryBindField);u.objNewDialog=i.showDialog(u,"Set Query Parameters","File/views/SetRecordLevelQueryParameter.html",{width:700,height:500});u.setParameter=function(){for(var s,t,h,o={Name:"parameters",Elements:[]},n=0,f=u.lstParameter.length;n<f;n++)s={Name:"parameter",dictAttributes:{ID:u.lstParameter[n].ParameterField,sfwQueryBindField:u.lstParameter[n].ParameterValue}},o.Elements.push(s);if(i.UndRedoBulkOp("Start"),e.length>0){for(t=-1,n=0,f=r.Elements.length;n<f;n++)if(h=r.Elements[n],h.Name==="parameters"){t=n;break}t>-1&&i.DeleteItem(r.Elements[t],r.Elements)}i.InsertItem(o,r.Elements,0);i.UndRedoBulkOp("End");u.closeSetParameterDialog()};u.closeSetParameterDialog=function(){u.objNewDialog.close()}}}]);