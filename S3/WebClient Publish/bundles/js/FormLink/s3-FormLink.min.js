app.controller("FormLinkController",["$scope","$http","$rootScope","share","$EntityIntellisenseFactory","$sce","hubcontext","$filter","$NavigateToFileService","ConfigurationFactory","$getQueryparam","$timeout","$ValidationService","CONSTANTS",function(n,t,r,u,f,e,o,s,h,c,l,a,v,y){function tt(t,i,r,u,f){var a,o,e,v,c,s,h,l;if(t)a=FindControlByID(n.FormLinkModel,t),a&&a.Name!=""&&(n.selectedHtxControl=a);else if(o=FindControlByID(n.FormLinkModel,i),o)if(r.toUpperCase()=="TH")o&&o.Name=="sfwGridView"&&(e=o.Elements.filter(function(n){return n.Name.toLowerCase()=="columns"}),e&&(n.selectedHtxControl=e[0].Elements[f]));else if(u.toUpperCase()=="TD"&&o.Name=="sfwGridView"&&(e=o.Elements.filter(function(n){return n.Name.toLowerCase()=="columns"}),e&&e.length>0&&e[0].Elements))for(v=-1,c=e[0].Elements,s=0;s<c.length;s++){if(c[s].Elements&&c[s].Elements.length>0&&(h=c[s].Elements.filter(function(n){return n.Name&&n.Name.toLowerCase()=="itemtemplate"}),h&&h.length>0))for(l=0;l<h[0].Elements.length;l++)if(h[0].Elements[l].Name!="cellformat"&&(v++,v==f)){n.selectedHtxControl=h[0].Elements[l];break}if(v==f)break}}function k(){n.IsSwitchCheckBox=!1;n.selectedHtxControl&&n.selectedHtxControl.dictAttributes&&n.selectedHtxControl.dictAttributes.sfwIsSwitch&&n.selectedHtxControl.dictAttributes.sfwIsSwitch.toLowerCase()=="true"?n.IsSwitchCheckBox=!0:(n.IsSwitchCheckBox=!1,n.FormLinkModel.SelectedControl=n.selectedHtxControl);n.$evalAsync(function(){n.FormLinkModel.SelectedControl=n.selectedHtxControl})}function g(n,t){function i(n){var i=nt(n,t);i&&i.length>0&&i[0].Name&&i[0].Name!="ListItem"&&(i&&rt(n,i[0]),n.Name!="sfwGridView"&&n.Name!="cellformat"&&g(n,t))}n.length>0?n.Elements?angular.forEach(n.Elements,i):angular.forEach(n[0].Elements,i):n.Elements&&angular.forEach(n.Elements,i)}function nt(n,t){var f=[],e,r,u,o,i;return n.Name=="TemplateField"?(i=[],t&&(i=t.length>0?getDescendents(t[0]):getDescendents(t),f=i.filter(function(t){return t.Name==n.Name&&t.dictAttributes.HeaderText==n.dictAttributes.HeaderText&&it(n,t)}))):n.ParentVM.Name=="ItemTemplate"?(e=w(n,"TemplateField"),e&&(r=nt(e,t),r&&r.length>0&&r[0].Elements&&(u=r[0].Elements.filter(function(n){return n.Name=="ItemTemplate"}),u&&(o=[],o=u.length>0?getDescendents(u[0]):getDescendents(u),f=o.filter(function(t){return t.dictAttributes.ID?t.Name==n.Name&&t.dictAttributes.ID==n.dictAttributes.ID:t.Name==n.Name}))))):(i=[],t&&(i=t.length>0?getDescendents(t[0]):getDescendents(t),f=i.filter(function(t){return t.Name==n.Name&&t.dictAttributes.ID==n.dictAttributes.ID}))),f}function w(n,t){for(var r={prefix:"",Name:"",Value:"",dictAttributes:[],Elements:[],Children:[]},i=n;null!=i;){if(i.Name=="form")break;else if(i.Name==t){r=i;break}i=i.ParentVM}return r}function it(n,t){var i=!1,r=w(n,"sfwGridView"),u=w(t,"sfwGridView");return null!=r&&null!=u&&(i=r.dictAttributes.ID==u.dictAttributes.ID),i}function rt(n,t){var e=n.dictAttributes.ID,i,r,u,f;t&&(n.dictAttributes=t.dictAttributes);n.dictAttributes.ID=e;(n.Name=="sfwChart"||n.Name=="sfwListView"||n.Name=="sfwImage"||n.Name=="sfwDropDownList"||n.Name=="sfwCascadingDropDownList"||n.Name=="sfwMultiSelectDropDownList"||n.Name=="sfwListPicker"||n.Name=="sfwListBox"||n.Name=="sfwRadioButtonList"||n.Name=="sfwCheckBoxList"||n.Name=="sfwSourceList")&&t&&angular.forEach(t.Elements,function(t){n.Elements.push(t)});n.Name=="sfwGridView"&&t&&t.Elements!=null&&(i=n.Elements.filter(function(n){return n.Name=="Columns"}),r=t.Elements.filter(function(n){return n.Name=="Columns"}),i&&i.length>0&&r&&r.length>0&&angular.forEach(r[0].Elements,function(n){n.Name!="TemplateField"&&i[0].Elements.push(n);angular.forEach(n.Elements,function(r){var f=i[0].Elements.filter(function(t){return t.dictAttributes&&t.dictAttributes.HeaderText==n.dictAttributes.HeaderText}),e,u;f&&f.length>0&&(e=f[0],r.Name!="ItemTemplate"?e.Elements.push(r):(u=e.Elements.filter(function(n){return n.Name=="ItemTemplate"}),u&&u.length>0&&(angular.forEach(r.Elements,function(n){n.Name=="cellformat"&&u[0].Elements.push(n)}),g(u[0],t))))})}),u=t.Elements.filter(function(n){return n.Name=="Parameters"}),u&&u.length&&n.Elements.push(u[0]),f=t.Elements.filter(function(n){return n.Name=="rowformat"}),f&&f.length&&n.Elements.push(f[0]))}var d,p,b;n.sharedata=u;n.isDirty=!1;n.isFormLink=!0;r.IsLoading=!0;n.LstDisplayedEntities=[];n.showPortalOptions=!1;n.currentfile=r.currentopenfile.file;n.lstPortals=[{PortalName:""}];n.validationErrorList=[];hubMain.server.getModel(n.currentfile.FilePath,n.currentfile.FileType).done(function(t){t?n.receiveformlinkmodel(t):r.closeFile(n.currentfile.FileName)});n.receiveformlinkmodel=function(t,i){n.$evalAsync(function(){var u,f;t?(n.lstLoadedEntityTrees=[],n.lstLoadedEntityColumnsTree=[],n.FormLinkModel=t,n.templateFile=n.FormLinkModel.dictAttributes.sfwTemplate,u=n.FormLinkModel.Elements.filter(function(n){return n.Name=="initialload"}),u&&u.length>0&&(n.InitialLoad=u[0]),n.InitialLoad||(n.InitialLoad={Name:"initialload",Value:"",dictAttributes:{},Elements:[],Children:[]},n.FormLinkModel.Elements.splice(0,0,n.InitialLoad)),n.itemsModel=n.FormLinkModel.Elements.filter(function(n){return n.Name=="items"}),n.itemsModel[0]&&n.itemsModel[0].Elements&&n.itemsModel[0].Elements[0]&&(n.selectedHtxControl=n.itemsModel[0].Elements[0],n.selectedControlId=n.selectedHtxControl.dictAttributes.ID?n.selectedHtxControl.dictAttributes.ID:null,i&&n.selectElement()),n.FormLinkModel.dictAttributes.sfwType=="FormLinkLookup"&&n.PopulateQueryId(!0),f={EntityName:n.FormLinkModel.dictAttributes.sfwEntity,IsVisible:!1,selectedobjecttreefield:undefined,lstselectedobjecttreefields:[],IsQuery:!1},n.lstLoadedEntityTrees.push(f),n.FormLinkModel.IsCommonPropertiesOpen=!0,n.FormLinkModel.dictAttributes.sfwRemoteObject&&n.FormLinkModel.dictAttributes.sfwRemoteObject!=""&&(n.FormLinkModel.isSrvMethodChecked="true"),$.connection.hubForm.server.getRemoteObjectList().done(function(t){n.$evalAsync(function(){n.FormLinkModel.RemoteObjectCollection=t;n.FormLinkModel.RemoteObjectCollection&&n.FormLinkModel.RemoteObjectCollection.length>0&&n.FormLinkModel.RemoteObjectCollection.splice(0,0,{dictAttributes:{ID:""}})})}),k(),n.sharedata.FormLinkModel=n.FormLinkModel,n.setParentVM(n.FormLinkModel),n.getTemplateUrl(i),n.objFormHtmlExtraFields=[],n.objFormHtmlExtraFields=s("filter")(n.FormLinkModel.Elements,{Name:"ExtraFields"}),n.objFormHtmlExtraFields.length>0&&(n.objFormHtmlExtraFields=n.objFormHtmlExtraFields[0]),n.objFormHtmlExtraFields.length==0&&(n.objFormHtmlExtraFields={Name:"ExtraFields",Value:"",dictAttributes:{},Elements:[]}),n.InitialLoadSection(),n.ValidateNew=s("filter")(n.FormLinkModel.Elements,{Name:"validatenew"})[0]):r.closeFile(n.currentfile.FileName)})};n.PopulateQueryId=function(t){n.lstQueryID=[];var r=n.FormLinkModel.Elements.filter(function(n){return n.Name=="initialload"});if(r.length>0)for(i=0;i<r[0].Elements.length;i++)n.lstQueryID.push(r[0].Elements[i]);n.lstQueryID.length>0&&(n.SelectedQuery=n.lstQueryID[0],n.populateQueryFields(n.SelectedQuery,t))};n.populateQueryFields=function(t,i){var u,r;if(t){for(r=0;r<n.lstLoadedEntityColumnsTree.length;r++)n.lstLoadedEntityColumnsTree[r].EntityName==t.dictAttributes.ID&&n.lstLoadedEntityColumnsTree[r].IsQuery==!0?(n.lstLoadedEntityColumnsTree[r].IsVisible=!0,n.lstLoadedEntityColumnsTree[r].lstselectedobjecttreefields=[],n.lookupTreeObject=n.lstLoadedEntityColumnsTree[r],u=n.lstLoadedEntityColumnsTree[r]):n.lstLoadedEntityColumnsTree[r].IsVisible=!1;u||(u={EntityName:t.dictAttributes.ID,IsVisible:i,selectedobjecttreefield:undefined,lstselectedobjecttreefields:[],IsQuery:!0,QueryRef:t.dictAttributes.sfwQueryRef,SortedColumns:[]},n.lstLoadedEntityColumnsTree.push(u),n.lookupTreeObject=u);u.SortedColumns=u.lstselectedobjecttreefields;n.ColumnsLimitCount=50;t.dictAttributes.sfwQueryRef!=undefined&&t.dictAttributes.sfwQueryRef!=""&&$.connection.hubForm.server.getEntityQueryColumns(t.dictAttributes.sfwQueryRef,"LoadQueryFieldsForLookup").done(function(i){n.receiveQueryFields(i,t.dictAttributes.sfwQueryRef)})}};n.receiveQueryFields=function(t,i){n.$evalAsync(function(){function e(n){var t="",i;n.Data1&&n.Data1!=null?t=n.Data1.toLowerCase():n.DataType&&(t=n.DataType.toLowerCase());i={ID:n.CodeID,DisplayName:n.CodeID,Value:n.CodeID,DataType:t,Entity:"",Direction:"",IsPrivate:"",Type:"",KeyNo:"",CodeID:""};f.lstselectedobjecttreefields.push(i)}var u=n.lstQueryID.filter(function(n){return n.dictAttributes.sfwQueryRef==i}),r,f;u&&u.length>0&&(r=n.lstLoadedEntityColumnsTree.filter(function(n){return n.EntityName==u[0].dictAttributes.ID}),r&&r.length>0&&(f=r[0],n.lookupTreeObject=f,t&&(sortListBasedOnproperty(t,"","CodeID"),angular.forEach(t,e))))})};n.receiveRemoteObjectCollection=function(t){n.$evalAsync(function(){var i,r;n.FormLinkModel.RemoteObjectCollection=t;n.FormLinkModel.RemoteObjectCollection.splice(0,0,{dictAttributes:{ID:""}});n.onRemoteObjectChange();(n.FormLinkModel.dictAttributes.sfwType=="FormLinkWizard"||n.FormLinkModel.dictAttributes.sfwType=="FormLinkMaintenance")&&(n.InitialLoad.Elements.length>0&&n.InitialLoad.Elements[0]&&(i=n.InitialLoad.Elements[0].dictAttributes.sfwMethodName,n.populateSrvParamtersForNew(i)),n.InitialLoad.Elements.length>1&&n.InitialLoad.Elements[1]&&(r=n.InitialLoad.Elements[1].dictAttributes.sfwMethodName,n.populateSrvParamtersForUpdate(r)))})};n.setParentVM=function(t){t&&angular.forEach(t.Elements,function(i){i.ParentVM=[];i.ParentVM=t;n.setParentVM(i)})};n.getTemplateUrl=function(t){r.IsLoading=!0;$.connection.hubFormLink.server.getHtmlTemplateFilePath().done(function(i){var u=$("#"+n.currentfile.FileName).find("#iframe"+n.FormLinkModel.dictAttributes.ID),f=u[0].contentDocument||u[0].contentWindow.document;f.documentElement.innerHTML="";n.$evalAsync(function(){var f,s,e,l;if(n.HtmlTemplatePath=i,n.HtmlTemplatePath){if(f=c.getLastProjectDetails(),f&&f.ProjectType===2&&f.BaseDirectory&&f.XmlFileLocation){var h=combineAsPath(f.BaseDirectory,f.XmlFileLocation),o=c.getProjectTypeProvider(),a=combineAsPath(h,o.BaseApp.BasePath),v=combineAsPath(h,o.AppBasedOnBaseApp.BasePath);n.currentfile.IsBaseAppFile&&n.currentfile.FilePath.indexOf(a)===0&&(s=o.AppBasedOnBaseApp.BasePath,s&&(n.HtmlTemplatePath=n.HtmlTemplatePath.substring(0,n.HtmlTemplatePath.lastIndexOf(s)),n.HtmlTemplatePath=combineAsPath(n.HtmlTemplatePath,o.BaseApp.BasePath)))}e=n.HtmlTemplatePath+"\\"+n.templateFile;l=e;e=e.replace(/\\/g,"//");n.htmlfilePath="file:///"+e;$.connection.hubFormLink.server.getHtmlfileContents(l).done(function(i){if(i=="file not found"){alert("Html File Path is incorrect.");n.$evalAsync(function(){r.IsLoading=!1});return}n.$evalAsync(function(){var f,e,o,s,h;u.contents().find("body").html("");f=u.contents().find("head");f.find("style").remove();f.find("link").remove();f.find("script").remove();e=c.getLastProjectDetails();f.append($("<link/>",{rel:"stylesheet",href:"css/htx_form.css",type:"text/css"}));o=document.createElement("script");o.type="text/javascript";o.src="scripts/jquery.smartWizard.js";f.append(o);s=document.createElement("script");s.type="text/javascript";s.src="scripts/kendo.ui.core.min.js";f.append(s);h=document.createElement("script");h.type="text/javascript";h.src="scripts/initializeStudio.js";f.append(h);u.ready(function(){n.selectedPortalDetails&&n.selectedPortalDetails.PortalName&&angular.isArray(e.htxPortals)&&e.htxPortals.length>0&&t==!0?n.LoadNewStyle(i):!t&&angular.isArray(e.htxPortals)&&e.htxPortals.length>0?(n.showPortalOptions=!0,n.lstPortals.length==1&&(n.lstPortals=n.lstPortals.concat(e.htxPortals)),n.lstPortals&&(n.selectedPortalDetails=n.lstPortals.filter(function(n){if(n&&n.IsDefault&&n.IsDefault.toLowerCase()=="true")return n})[0],n.LoadNewStyle(i)),n.selectedPortalDetails||(n.selectedPortalDetails=n.lstPortals[0])):n.bindIframeEvents(i)});r.IsLoading=!1;n.selectElement()})})}})})};n.bindIframeEvents=function(t){function h(n){n&&n.shiftKey&&n.keyCode==$.ui.keyCode.TAB&&$(window.parent.document).trigger(n)}function y(){$(this).on("click",c)}function c(n){return o.handleClick(n),n.stopPropagation(),!1}function l(n){o.handleClick(n);n.preventDefault()}function a(){o.handledblClick(event)}var v=$("#iframe"+n.FormLinkModel.dictAttributes.ID),o=angular.element(document.getElementById("htmlDiv"+n.FormLinkModel.dictAttributes.ID)).scope(),i=v.contents().find("body"),u=document.createElement("div"),f,e,s;if(u.innerHTML=t,f=u.querySelectorAll("script"),f.length>0)for(e=0;e<f.length;e++)u.removeChild(f[e]);i.append(u.innerHTML);i.find("[onclick]").removeAttr("onclick");i.unbind("click",l);i.unbind("dblclick",a);i.unbind("keydown",h);i.find("input").each(function(){$(this).unbind("click",c)});i.find("input").each(y);i.on("click",l);i.on("dblclick",a);n.controlList=[""];s=[];i.find("[id]").each(function(){$(this).attr("id")&&!$(this).attr("id").startsWith("ListViewItem_")&&s.push($(this).attr("id"));$.each(s,function(t,i){$.inArray(i,n.controlList)==-1&&n.controlList.push(i)})});i.on("keydown",h);i.find(":hidden").not("option").show();r.IsLoading=!1};n.findElementId=function(t){var i,r,s,u,f,e,h,l,c,v,o,a;if(t&&t.target){i="";r=null;n.selectedHtxControl=n.selectedControlId=null;s=$("iframe").filter(":visible").contents().find("body");s.find(".s3-table-selector-parent").remove();u=$(t.target);f=u.prop("tagName")=="TH"?u:u.closest("td");i=u.attr("id");i?n.selectControlByID(i):f&&f.length?(e=f.closest("table"),l=f.index(),e&&e.length&&(h=e.attr("id")),h?($("<div class='s3-table-selector-parent'><span class='s3-table-selector' title='Select Grid'><\/span><\/div>").insertBefore(e),n.selectedControlId=i,tt(i,h,f.prop("tagName"),f.prop("tagName"),l)):(r=u.closest("[id]"),r&&r.length&&(i=r.attr("id"),n.selectControlByID(i,r)))):(c=u.parent("li"),v=null,c.length>0?(o=$(c[0]),o[0].id&&o[0].id.trim().endsWith("_Header")&&(a=o[0].id.trim().split("_Header"),i=a[0])):u.attr("id")?i=u.attr("id"):(r=u.closest("[id]"),r&&r.length&&(i=r.attr("id"))),n.selectControlByID(i,r));s.find(".s3-table-selector-parent").on("click",function(){n.selectedControlId=$(this).next().attr("id");n.selectedHtxControl=FindControlByID(n.FormLinkModel,n.selectedControlId);n.handleClick(null)})}};n.selectControlByID=function(t,i){if(t){var r=FindControlByID(n.FormLinkModel,t);r&&r.Name!=""&&(r.Name=="sfwPanel"&&i&&i.length?$("<div class='s3-table-selector-parent'><span class='s3-table-selector' title='Select Panel'><\/span><\/div>").insertBefore(i):(n.selectedHtxControl=r,n.selectedControlId=t))}};n.handleClick=function(t){var i=$("#iframe"+n.FormLinkModel.dictAttributes.ID).contents().find("body");if(i.find("*").removeClass("selected-button selected-item selected-label selected-grid selected-checkbox s3-selected-tabsheet"),t){if($(t.target).hasClass("s3-table-selector")||$(t.target).hasClass("s3-table-selector-parent"))return;n.findElementId(t)}a(function(){if(n.openCommonPropertiesClick(),n.selectedHtxControl&&n.selectedHtxControl.Name&&n.selectedControlId){if(n.selectedHtxControl.Name=="sfwLabel"||n.selectedHtxControl.Name=="sfwLinkButton"||n.selectedHtxControl.Name=="sfwChart"||n.selectedHtxControl.Name=="sfwCalendar")i.find("#"+n.selectedControlId.replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g,"\\$1")).addClass("selected-label");else if(n.selectedHtxControl.Name=="sfwButton")i.find("#"+n.selectedControlId.replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g,"\\$1")).addClass("selected-button");else if(n.selectedHtxControl.Name=="sfwCheckBox")i.find("#"+n.selectedControlId.replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g,"\\$1")).addClass("selected-checkbox");else if(n.selectedHtxControl.Name=="sfwGridView")i.find("#"+n.selectedControlId.replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g,"\\$1")).addClass("selected-item");else if(n.selectedHtxControl.Name!="sfwTabSheet")i.find("#"+n.selectedControlId.replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g,"\\$1")).addClass("selected-item");else if(n.selectedHtxControl.Name=="sfwTabSheet"){var t=i.find("#"+n.selectedControlId+"_Header");t&&t.length&&t.addClass("s3-selected-tabsheet")}}else n.selectedControlId&&i.find("#"+n.selectedControlId.replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g,"\\$1")).addClass("selected-item")})};n.handledblClick=function(t){var i,u;n.selectedHtxControl&&n.selectedHtxControl.Name&&(i=n.selectedHtxControl,(i.Name=="sfwListPicker"||i.Name=="sfwSourceList"||i.Name=="sfwRadioButtonList"||i.Name=="sfwCascadingDropDownList"||i.Name=="sfwDropDownList"||i.Name=="sfwCheckBoxList"||i.Name=="sfwMultiSelectDropDownList"||i.Name=="sfwListBox")&&(!i.dictAttributes.sfwLoadType||i.dictAttributes.sfwLoadType==""||i.dictAttributes.sfwLoadType=="CodeGroup"||i.dictAttributes.sfwLoadType=="Items"&&i.Elements.length==0)&&(i.dictAttributes.sfwLoadSource||i.placeHolder)&&(r.IsLoading=!0,t&&($(t.target).blur(),window.getSelection().removeAllRanges()),u="",u=i.dictAttributes.sfwLoadSource&&i.dictAttributes.sfwLoadType=="CodeGroup"?i.dictAttributes.sfwLoadSource:i.placeHolder,$.connection.hubMain.server.getCodeValuesForDropDown(u).done(function(t){r.IsLoading=!1;n.$evalAsync(function(){var i=n.$new();i.ErrorMessage="";t&&t.length>0?i.lstCodeValues=t:i.ErrorMessage="No code value exist.";dialog=r.showDialog(i,"Code Values","Form/views/CodeValueListDialog.html");i.closeDialog=function(){dialog.close()}})})))};n.InitialLoadSection=function(){function t(t){if(t.Name=="session")n.SessionFields=t,n.SessionFields.lstselectedobjecttreefields=[],n.SessionFields.LstDisplayedEntities=[];else if(t.Name=="callmethods")t.dictAttributes.sfwMode||(n.SelectedNewMethod=t,n.SelectedUpdateMethod="",n.FormLinkModel.IsSameAsNew=!0),t.dictAttributes.sfwMode=="New"||t.dictAttributes.sfwMode=="All"?n.SelectedNewMethod=t:(t.dictAttributes.sfwMode=="Update"||t.dictAttributes.sfwMode=="All")&&(n.SelectedUpdateMethod=t);else if(t.Name=="query"){var i=t.dictAttributes.sfwQueryRef;n.IsSubQuery(i)?(n.SubQueryCollection.push(t),n.SelectedSubQuery=t):n.MainQuery?t&&n.SubQueryCollection.push(t):(n.MainQuery=t,n.StrMainQuery=t.dictAttributes.ID+" - "+i)}}n.SubQueryCollection=[];n.MainQuery=undefined;angular.forEach(n.InitialLoad.Elements,t);n.FormLinkModel.dictAttributes.sfwType=="FormLinkMaintenance"&&n.InitialLoad&&n.SessionFields==undefined&&(n.SessionFields={Name:"session",Value:"",dictAttributes:{},Elements:[],Children:[]},n.SessionFields.lstselectedobjecttreefields=[],n.SessionFields.LstDisplayedEntities=[])};n.IsSubQuery=function(n){function u(n){i||n.ID==r&&n.QueryType.toLowerCase()=="subselectquery"&&(i=!0)}var i=!1,r;if(n!=""&&n!=undefined){var e=n.substring(0,n.indexOf(".")),o=f.getEntityIntellisense(),t=o.filter(function(n){return n.DisplayName==e});t&&t.length>0&&t[0].Queries&&(r=n.substring(n.indexOf(".")+1),angular.forEach(t[0].Queries,u))}return i};n.openCommonPropertiesClick=function(){n.FormLinkModel.IsCommonPropertiesOpen=!0;k()};n.selectedDesignSource=!1;n.ShowDesign=function(){var t,f;if(n.selectedDesignSource==!0&&(t=n.editor.getValue(),t!=null&&t!="")){if(r.IsLoading=!0,t.length<32e3)hubMain.server.getXmlString(t,n.currentfile);else{var i="",e=[],u=0;for(f=0;f<t.length;f++)u++,i=i+t[f],u==32e3&&(u=0,e.push(i),i="");u!=0&&e.push(i);d(e,n.currentfile,"SourceToDesignCommon")}n.receivexmlobject=function(t){n.selectedDesignSource=!1;n.isSourceDirty&&(n.receiveformlinkmodel(t),n.isSourceDirty=!1);n.$evalAsync(function(){r.IsLoading=!1})}}};d=function(n,t,i){for(var r=0;r<n.length;r++)hubMain.server.receiveDataPackets(n[r],n.length,t,r,i,null)};n.ShowSource=function(){var o,i,s,t;if(n.selectedDesignSource==!1&&(n.selectedDesignSource=!0,n.FormLinkModel&&(r.IsLoading=!0,n.FormLinkModel.dictAttributes.sfwType!="FormLinkLookup"&&(n.dummyLstLoadDetails=LoadDetails(n.FormLinkModel,n.objLoadDetails,!1,r,!0)),o=GetBaseModel(n.FormLinkModel),o!=""))){if(i=JSON.stringify(o),i.length<32e3)n.selectedHtxControl&&n.selectedHtxControl.dictAttributes&&n.selectedHtxControl.dictAttributes.ID?hubMain.server.getFormLinkXml(i,n.currentfile,n.selectedHtxControl.dictAttributes.ID):hubMain.server.getFormLinkXml(i,n.currentfile,null);else{var u="",f=[],e=0;for(t=0;t<i.length;t++)e++,u=u+i[t],e==32e3&&(e=0,f.push(u),u="");for(e!=0&&f.push(u),s=[],n.selectedHtxControl&&n.selectedHtxControl.dictAttributes&&n.selectedHtxControl.dictAttributes.ID&&s.push(n.selectedHtxControl.dictAttributes.ID),t=0;t<f.length;t++)hubMain.server.receiveDataPackets(f[t],f.length,n.currentfile,t,"DesignToSourceFormLink",s)}n.receiveFormLinkXml=function(t,i){n.$evalAsync(function(){var u=n.currentfile.FileName;setDataToEditor(n,t,i,u);n.$evalAsync(function(){r.IsLoading=!1});window.navigator.userAgent.toLowerCase().contains("chrome")&&n.$evalAsync(function(){r.IsLoading=!1})})}}};n.OnRefreshClick=function(){n.dummyLstLoadDetails=LoadDetails(n.FormLinkModel,n.objLoadDetails,!1,r,!0);n.refreshedModel=GetBaseModel(n.FormLinkModel);n.SaveModelWithPackets(n.refreshedModel,undefined,!1)};n.SaveModelWithPackets=function(n,t,i){var f=JSON.stringify(n),o;if(r.IsLoading=!0,f.length<32e3&&!i)$.connection.hubFormLink.server.onRefreshFormLinkModel(f,!0);else{var u="",s=[],e=0;for(o=0;o<f.length;o++)e++,u=u+f[o],e==32e3&&(e=0,s.push(u),u="");e!=0&&s.push(u);p(s,t,i,!1)}};p=function(n,t,i,r){for(var u=0;u<n.length;u++)$.connection.hubFormLink.server.receiveDataPackets(n[u],n.length,u,t,i,r)};n.receiveMapUnmapControls=function(t,i,u,f){function o(t){var u={ControlID:t.ControlID,HtmlControlType:t.HtmlControlType,ControlType:t.ControlType,IsValid:t.IsValid},r=getDescendents(f),i;r&&r.length>0&&(i=r.filter(function(n){return n.dictAttributes.ID==t.ControlID}),i&&i.length>0&&i[0].Name=="sfwCheckBox"&&i[0].dictAttributes&&i[0].dictAttributes.sfwIsSwitch&&i[0].dictAttributes.sfwIsSwitch.toLowerCase()=="true"&&(u.sfwIsSwitch="True"));n.MapControlList.push(u)}function s(t){var i={ControlID:t.ControlID,HtmlControlType:t.HtmlControlType,ControlType:t.ControlType,IsValid:t.IsValid};n.MappedControlList.push(i)}function h(t){var i={ControlID:t.ControlID,HtmlControlType:t.HtmlControlType,ControlType:t.ControlType,IsValid:t.IsValid};n.RemovedControlList.push(i)}function c(t){var i={ControlID:t.ControlID,HtmlControlType:t.HtmlControlType,ControlType:t.ControlType,IsValid:t.IsValid};n.IgnoredControlList.push(i)}function l(t){var i={ControlID:t.ControlID,HtmlControlType:t.HtmlControlType,ControlType:t.ControlType,IsValid:t.IsValid};n.InvalidControlList.push(i)}var e;n.$evalAsync(function(){r.IsLoading=!1});e=JSON.parse(t);n.OldModel=f;n.MapControlList=[];n.MappedControlList=[];n.IgnoredControlList=[];n.RemovedControlList=[];n.InvalidControlList=[];e.Map||e.Mapped||e.Removed||e.Ignored||e.Invalid?(e.Map&&e.Map.length>0&&angular.forEach(e.Map,o),e.Mapped&&e.Mapped.length>0&&angular.forEach(e.Mapped,s),e.Removed&&e.Removed.length>0&&angular.forEach(e.Removed,h),e.Ignored&&e.Ignored.length>0&&angular.forEach(e.Ignored,c),e.Invalid&&e.Invalid.length>0&&angular.forEach(e.Invalid,l),e=JSON.parse(i),n.$evalAsync(function(){var t=n.$new(),i;n.activeTab="MAP";t.isMappedControlClick=!1;t.OldModel=f;t.NewModel=u;t.MapControls=n.MapControlList;t.MappedControls=n.MappedControlList;t.RemovedControls=n.RemovedControlList;t.IgnoredControls=n.IgnoredControlList;t.InvalidControls=n.InvalidControlList;t.ControlTypes=e;n.FormLinkModel.dictAttributes.sfwType=="FormLinkLookup"&&(i=t.ControlTypes.indexOf("sfwHyperLink"),t.ControlTypes.splice(i,1),i=t.ControlTypes.indexOf("sfwJSONData"),i>=0&&t.ControlTypes.splice(i,1),i=t.ControlTypes.indexOf("sfwCalendar"),i>=0&&t.ControlTypes.splice(i,1),i=t.ControlTypes.indexOf("sfwScheduler"),i>=0&&t.ControlTypes.splice(i,1));(n.FormLinkModel.dictAttributes.sfwType=="FormLinkMaintenance"||n.FormLinkModel.dictAttributes.sfwType=="FormLinkWizard")&&t.ControlTypes.push("sfwListView");t.MapControls.some(function(n){if(n.sfwIsSwitch&&n.sfwIsSwitch.toLowerCase()=="true")return n.ControlType="sfwSwitchCheckBox",!0});t.onOKClick=function(){t.isOkClick=!0;var n=t.MapControls.concat(t.MappedControls);t.updateDataFields(t.isOkClick,n,t.RemovedControls);t.closeDialog()};t.closeDialog=function(){t.dialog&&(t.isOkClick=!1,r.IsLoading=!1,t.dialog.close())};t.setActiveTab=function(n){t.activeTab=n;n=="MAPPED"&&(t.isMappedControlClick=!0)};t.updateDataFields=function(i,r){i?n.SaveModelWithPackets(t.NewModel,r,!0):n.SaveModelWithPackets(t.NewModel,null,!0);n.OldModel=t.OldModel};t.dialog=r.showDialog(t,"Control Mapping","CreateNewObject/views/FormLink/FormLinkMapUnmapControls.html",{width:600,height:400})})):alert("HTML Controls not exist.")};n.receiveRefreshedModel=function(t){var e,u,s,h,f,c;for(n.refreshedModel=JSON.parse(t),n.setParentVM(n.refreshedModel),n.setParentVM(n.OldModel),e=n.refreshedModel.Elements.filter(function(n){return n.Name=="items"}),u=0;u<n.OldModel.Elements.length;u++)n.OldModel.Elements[u].Name=="items"&&(n.OldModel.Elements[u]=e[0]);var l=n.OldModel.Elements.filter(function(n){return n.Name=="items"}),i={Name:n.refreshedModel.Name,prefix:n.refreshedModel.prefix,Value:n.refreshedModel.Value,dictAttributes:n.refreshedModel.dictAttributes,Elements:[],Children:[]},o=n.OldModel.Elements.filter(function(n){return n.Name=="initialload"});o&&o.length>0&&(s=GetBaseModel(o[0]),i.Elements.push(s));h=GetBaseModel(e[0]);i.Elements.push(h);i.objExtraData=n.refreshedModel.objExtraData;f=n.OldModel.Elements.filter(function(n){return n.Name=="loaddetails"});f&&f.length>0&&(c=GetBaseModel(f[0]),i.Elements.push(c));r.SaveModelWithPackets(i,r.currentopenfile.file,r.currentopenfile.file.FileType,!1);n.FormLinkModel=i;n.receiveformlinkmodel(i,!0);r.IsLoading=!1};n.receiveRemovedControls=function(t,i){n.OldModel=i;n.$evalAsync(function(){var i=n.$new(),u;i.RemovedControls=t;u=JSON.stringify(n.refreshedModel);i.onOKClick=function(){i.isOkClick=!0;$.connection.hubFormLink.server.onRefreshFormLinkModel(u,!1);i.closeDialog()};i.closeDialog=function(){i.dialog&&(i.isOkClick=!1,i.dialog.close())};r.IsLoading=!1;i.dialog=r.showDialog(i,"Removed Controls","FormLink/views/RemovedControls.html",{width:500,height:500})})};n.OnDisplayUnmapColumnclick=function(){var o=GetBaseModel(n.FormLinkModel),i=JSON.stringify(o),f;if(r.IsLoading=!0,i.length<32e3)$.connection.hubFormLink.server.displayControlMapping(i);else{var t="",e=[],u=0;for(f=0;f<i.length;f++)u++,t=t+i[f],u==32e3&&(u=0,e.push(t),t="");u!=0&&(e.push(t),p(e,null,!1,!0))}};n.receiveControlMappingForDisplay=function(t){if(n.$evalAsync(function(){r.IsLoading=!1}),t){var i=n.$new();t.length==3&&(i.lstHtmlMapControl=t[0],i.lstHtmlIgnoreControl=t[1],i.lstHtmlInvalidControl=t[2]);i.SelectedTab="UnMapControl";i.selectControlMappingTab=function(n){i.SelectedTab=n};i.dialog=r.showDialog(i,"Display Control Mapping","FormLink/views/DisplayControlMapping.html",{width:550,height:550})}else alert("HTML file not exist.")};n.onDetailClick=function(){var t,i,u,o,e,s;r.IsLoading=!0;t=n.$new();t.MainQuery=undefined;t.objExtraFields=[];t.objDirFunctions={};t.showExtraFieldsTab=!1;t.formName="HTML";t.FormLinkModel={};t.SelectedNewMethod=null;t.SelectedUpdateMethod=null;n.InitialLoad?(t.InitialLoad={},n.InitialLoad.ParentVM=null,angular.copy(n.InitialLoad,t.InitialLoad)):t.InitialLoad={Name:"initialload",Value:"",dictAttributes:{},Elements:[],Children:[]};t.InitialLoadSectionForDetail=function(){t.$evalAsync(function(){t.SubQueryCollection={Elements:[]};t.InitialLoad&&angular.forEach(t.InitialLoad.Elements,function(i){if(i.Name=="callmethods")i.dictAttributes.sfwMode||(t.SelectedNewMethod=i,t.SelectedUpdateMethod="",t.FormLinkModel.IsSameAsNew=!0),(i.dictAttributes.sfwMode=="New"||i.dictAttributes.sfwMode=="All")&&(t.SelectedNewMethod=i),(i.dictAttributes.sfwMode=="Update"||i.dictAttributes.sfwMode=="All")&&(t.SelectedUpdateMethod=i);else if(i.Name=="query"){var r=i.dictAttributes.sfwQueryRef;n.IsSubQuery(r)?(t.SubQueryCollection.Elements.push(i),t.SelectedSubQuery=i):t.MainQuery?t.SubQueryCollection.Elements.push(i):t.MainQuery=i}else i.Name=="session"&&(t.SessionFields=i,t.SessionFields.lstselectedobjecttreefields=[],t.SessionFields.LstDisplayedEntities=[])});n.FormLinkModel.dictAttributes.sfwType=="FormLinkMaintenance"&&t.InitialLoad&&t.SessionFields==undefined&&(t.SessionFields={Name:"session",Value:"",dictAttributes:{},Elements:[],Children:[]},t.SessionFields.lstselectedobjecttreefields=[],t.SessionFields.LstDisplayedEntities=[])})};t.FormLinkModel={dictAttributes:{}};angular.forEach(n.FormLinkModel.dictAttributes,function(n,i){t.FormLinkModel.dictAttributes[i]=n});t.FormLinkModel.RemoteObjectCollection=[];n.FormLinkModel.RemoteObjectCollection&&angular.copy(n.FormLinkModel.RemoteObjectCollection,t.FormLinkModel.RemoteObjectCollection);t.$evalAsync(function(){t.IsPrototypeDetails=!1});n.FormLinkModel.dictAttributes.ID.startsWith("wfp")&&t.$evalAsync(function(){t.IsPrototypeDetails=!0});i=n.FormLinkModel.dictAttributes.sfwEntity;$.connection.hubMain.server.getFormExtraData(i).done(function(n){t.$evalAsync(function(){t.FormLinkModel.objExtraData=n;t.populateXmlMethods(t.FormLinkModel.isSrvMethodChecked);t.Init()})});t.populateXmlMethods=function(n){var r,u,f,i;if(t.XmlNewMethodsCollection=[],t.XmlUpdateMethodsCollection=[],n=="false"&&(t.paramtersForNewMethod=[],t.paramtersForUpdateMethod=[]),t.FormLinkModel.objExtraData&&(u={Name:"",Value:"",dictAttributes:{ID:""},Elements:[],Children:[]},t.FormLinkModel.objExtraData.lstMethodsList&&(r=t.FormLinkModel.objExtraData.lstMethodsList.filter(function(n){return n.Name.toLowerCase()=="methods"}),t.XmlUpdateMethodsCollection.push(u),t.XmlNewMethodsCollection.push(u),u={Name:"",Value:"",dictAttributes:{ID:"NewObject"},Elements:[],Children:[]},t.XmlNewMethodsCollection.push(u),r&&r.length>0)))for(f=0;f<r.length;f++)for(j=0;j<r[f].Elements.length;j++)i=r[f].Elements[j],i.Name=="method"&&((i.dictAttributes.sfwMode=="New"||i.dictAttributes.sfwMode=="All")&&t.XmlNewMethodsCollection.push(i),(i.dictAttributes.sfwMode=="Update"||i.dictAttributes.sfwMode=="All")&&t.XmlUpdateMethodsCollection.push(i))};n.FormLinkModel.dictAttributes.sfwType!="FormLinkLookup"&&t.populateXmlMethods();t.RemoteObjectCollection=[];t.IsEntityTabSelected=!1;t.IsGroupTabSelected=!1;t.IsSessionTabSelected=!1;t.SrvMethodCollection=[];t.lstWebsite=[];u=undefined;o=c.getLastProjectDetails();o&&o!=null&&(e=c.getLastProjectDetails().Website,e&&e!=null&&e.contains(";")?t.lstWebsite=c.getLastProjectDetails().Website.split(";"):t.lstWebsite.push(c.getLastProjectDetails().Website),t.lstWebsite.splice(0,0,""));t.Init=function(){t.IsSameAsNewDisabled=!0;t.FormLinkModel.isSrvMethodChecked="false";t.FormLinkModel.dictAttributes.sfwRemoteObject!=undefined&&t.FormLinkModel.dictAttributes.sfwRemoteObject!=""?(t.FormLinkModel.isSrvMethodChecked="true",$.connection.hubForm.server.getRemoteObjectList().done(function(n){t.$evalAsync(function(){n&&(t.FormLinkModel.RemoteObjectCollection=n,t.FormLinkModel.RemoteObjectCollection&&t.FormLinkModel.RemoteObjectCollection.length>0&&t.FormLinkModel.RemoteObjectCollection.splice(0,0,{dictAttributes:{ID:""}}),t.PopulateRemoteObject())})})):(t.SelectedNewMethod?t.populateParamtersForNew(t.SelectedNewMethod):t.SelectedNewMethod={Name:"callmethods",Value:"",dictAttributes:{sfwMode:"New"},Elements:[]},t.SelectedUpdateMethod?t.populateParamtersForUpdate(t.SelectedUpdateMethod):t.SelectedUpdateMethod={Name:"callmethods",Value:"",dictAttributes:{sfwMode:"Update"},Elements:[]});t.FormLinkModel.objExtraData&&t.FormLinkModel.objExtraData.lstRulesList&&(t.lstLogRules=t.FormLinkModel.objExtraData.lstRulesList,t.lstLogRules.splice(0,0,{dictAttributes:{ID:""}}));t.lstButtons=[];lstTable=n.FormLinkModel.Elements.filter(function(n){return n.Name=="items"});lstTable&&lstTable.length>0&&FindControlListByName(lstTable[0],"sfwButton",t.lstButtons);n.FormLinkModel.dictAttributes.sfwType=="FormLinkLookup"&&(t.MainQuery||(t.MainQuery={Name:"query",Value:"",dictAttributes:{},Elements:[]},t.InitialLoad.Elements.push(t.MainQuery)));r.IsLoading=!1;u=r.showDialog(t,"Form Details","FormLink/views/FormLinkDetails.html",{width:700,height:700})};t.PopulateRemoteObject=function(){t.RemoteObjectCollection=t.FormLinkModel.RemoteObjectCollection;t.RemoteObjectCollection&&t.RemoteObjectCollection.length>0&&(t.RemoteObjectCollection[0].dictAttributes.ID!=""&&t.RemoteObjectCollection.splice(0,0,{dictAttributes:{ID:""}}),t.onRemoteObjectChange());t.SelectedNewMethod?t.populateSrvParamtersForNew(t.SelectedNewMethod):t.SelectedNewMethod={Name:"callmethods",Value:"",dictAttributes:{sfwMode:"New"},Elements:[]};t.SelectedUpdateMethod?t.populateSrvParamtersForUpdate(t.SelectedUpdateMethod):t.SelectedUpdateMethod={Name:"callmethods",Value:"",dictAttributes:{sfwMode:"Update"},Elements:[]}};t.onRemoteObjectChange=function(){if(t.isReset=!0,t.FormLinkModel.dictAttributes.sfwRemoteObject!=undefined&&t.FormLinkModel.dictAttributes.sfwRemoteObject!=""){function i(n){return n.dictAttributes.ID==t.FormLinkModel.dictAttributes.sfwRemoteObject}var n=t.RemoteObjectCollection.filter(i);n&&n.length>0&&(t.SrvMethodCollection=n[0].Elements,t.SrvNewMethodCollection=n[0].Elements.filter(function(n){return n.dictAttributes.sfwMode=="New"||n.dictAttributes.sfwMode=="All"}),t.SrvUpdateMethodCollection=n[0].Elements.filter(function(n){return n.dictAttributes.sfwMode=="Update"||n.dictAttributes.sfwMode=="All"}),t.SrvMethodCollection.splice(0,0,{dictAttributes:{ID:""}}))}else t.SrvNewMethodCollection=[],t.SrvUpdateMethodCollection=[],t.SrvMethodCollection=[]};t.onMethodTypeChange=function(){t.PopulateRemoteObject();t.MainQuery&&t.MainQuery.dictAttributes&&(t.MainQuery.dictAttributes.sfwMethodName="");t.SelectedNewMethod&&(t.SelectedNewMethod.dictAttributes.sfwMethodName="");t.SelectedUpdateMethod&&(t.SelectedUpdateMethod.dictAttributes.sfwMethodName="");t.FormLinkModel.dictAttributes.sfwRemoteObject="";t.FormLinkModel.dictAttributes.sfwGridCollection="";t.paramtersForNewMethod=[];t.paramtersForUpdateMethod=[];t.SrvMethodCollection=[];t.SrvNewMethodCollection=[];t.SrvUpdateMethodCollection=[]};t.selectXmlMethodClick=function(n){n&&n!=""&&n!="NewObject"&&(t.OkClick(),h.NavigateToFile(t.FormLinkModel.dictAttributes.sfwEntity,"methods",n))};t.openMainQueryDialog=function(){var i=t.$new();i.strSelectedQuery=t.MainQuery.dictAttributes.sfwQueryRef;i.QueryDialog=r.showDialog(i,"Browse For Query","Form/views/BrowseForQuery.html",{width:1e3,height:700});i.$on("onQueryClick",function(i,r){n.IsSubQuery(r)||(r.contains(".")&&(t.MainQuery.dictAttributes.ID=r.split(".")[0]),t.MainQuery.dictAttributes.sfwQueryRef=r);i&&i.stopPropagation()})};t.onMainQueryChange=function(i){t.updateMainQueryChange();n.IsSubQuery(i)||(t.MainQuery||(t.MainQuery={Name:"query",Value:"",dictAttributes:{},Elements:[]},t.InitialLoad.Elements.push(t.MainQuery)),i&&i.contains(".")?t.MainQuery.dictAttributes.ID||(t.MainQuery.dictAttributes.ID=i.split(".")[0],t.MainQueryIDChange(t.MainQuery)):i||(t.MainQuery.dictAttributes.ID="",t.MainQueryIDChange(t.MainQuery)))};t.MainQueryIDChange=function(n){if(t.InitialLoad&&t.InitialLoad.Elements)for(var i=0;i<t.InitialLoad.Elements.length;i++)t.InitialLoad.Elements[i].dictAttributes&&t.InitialLoad.Elements[i].dictAttributes.sfwQueryRef==n.dictAttributes.sfwQueryRef&&(t.InitialLoad.Elements[i].dictAttributes.ID=n.dictAttributes.ID)};t.updateMainQueryChange=function(){if(t.InitialLoad&&t.InitialLoad.Elements)for(var n=0;n<t.InitialLoad.Elements.length;n++)t.InitialLoad.Elements[n].dictAttributes&&t.InitialLoad.Elements[n].dictAttributes.ID==t.MainQuery.dictAttributes.ID&&(t.InitialLoad.Elements[n].dictAttributes.sfwQueryRef=t.MainQuery.dictAttributes.sfwQueryRef)};t.onSubQueryClick=function(n){n&&(t.SelectedSubQuery=n)};t.getGroupList=function(n){var i=$(n.target),r=[],u;r=s();r.length>0&&r[0].Elements.length>0?(u=r[0].Elements,n.ctrlKey&&n.keyCode==$.ui.keyCode.SPACE?($(i).data("ui-autocomplete")&&$(i).autocomplete("search",$(i).val()),n.preventDefault()):setSingleLevelAutoComplete(i,u,t,"ID")):n.ctrlKey&&n.keyCode==$.ui.keyCode.SPACE&&n.preventDefault()};t.showGroupList=function(n){var i=$(n.target).prevAll("input[type='text']"),r=[],u;r=s();r.length>0&&r[0].Elements.length>0?(u=r[0].Elements,i.focus(),setSingleLevelAutoComplete(i,u,t,"ID"),$(i).data("ui-autocomplete")&&$(i).autocomplete("search",$(i).val())):setSingleLevelAutoComplete(i,[],t,"ID");n&&n.stopPropagation()};s=function(){if(t.FormLinkModel.objExtraData){var n=t.FormLinkModel.objExtraData.lstGroupsList;return n&&n.length>0?n:[]}};t.selectGroupClick=function(n,i){t.FormLinkModel.errors&&!t.FormLinkModel.errors[i]&&n&&n!=" "&&(u.close(),h.NavigateToFile(t.FormLinkModel.dictAttributes.sfwEntity,"groupslist",n))};t.populateXmlMethodsForEntityChange=function(n){var r,u,i;t.isReset=!0;r=n;t.XmlNewMethodsCollection=[];t.XmlUpdateMethodsCollection=[];t.lstLogRules=[];t.FormLinkModel.objExtraData={};t.FormLinkModel.isSrvMethodChecked=="false"&&(t.SelectedNewMethod&&t.SelectedNewMethod.dictAttributes.sfwMethodName&&(t.SelectedNewMethod.dictAttributes.sfwMethodName=""),t.SelectedUpdateMethod&&t.SelectedUpdateMethod.dictAttributes.sfwMethodName&&(t.SelectedUpdateMethod.dictAttributes.sfwMethodName=""),t.paramtersForUpdateMethod=[],t.paramtersForNewMethod=[]);u=f.getEntityIntellisense();i=u.filter(function(t){return t.ID==n});i&&i.length>0&&$.connection.hubMain.server.getFormExtraData(r).done(function(n){t.FormLinkModel.objExtraData=n;t.populateXmlMethods(t.FormLinkModel.isSrvMethodChecked);t.lstLogRules=t.FormLinkModel.objExtraData.lstRulesList;t.lstLogRules.splice(0,0,{dictAttributes:{ID:""}})})};t.populateParamtersForNew=function(n){var i;t.paramtersForNewMethod=[];t.SelectedNewMethod||(t.SelectedNewMethod={Name:"callmethods",Value:"",Elements:[],dictAttributes:{sfwMethodName:n.dictAttributes.sfwMethodName}});t.InitialLoad.Elements.indexOf(t.SelectedNewMethod)<=-1&&t.InitialLoad.Elements.push(t.SelectedNewMethod);n.dictAttributes.sfwMethodName&&t.XmlNewMethodsCollection&&(i=t.XmlNewMethodsCollection.filter(function(t){return t.dictAttributes.ID==n.dictAttributes.sfwMethodName&&t.dictAttributes.sfwMode!="Update"}),i&&i.length>0&&angular.forEach(i[0].Elements,function(n){n.Name=="parameter"&&t.paramtersForNewMethod.push(n)}));t.XmlUpdateMethodsCollection&&(i=t.XmlUpdateMethodsCollection.filter(function(t){return n.dictAttributes.sfwMethodName&&t.dictAttributes.ID==n.dictAttributes.sfwMethodName&&t.dictAttributes.sfwMode!="New"}),i&&i.length>0?t.IsSameAsNewDisabled=!1:(t.IsSameAsNewDisabled=!0,t.FormLinkModel.IsSameAsNew=!1));!t.FormLinkModel.IsSameAsNew&&t.SelectedNewMethod&&(t.SelectedNewMethod.dictAttributes.sfwMode="New")};t.populateSrvParamtersForNew=function(n){var i;t.SelectedNewMethod||(t.SelectedNewMethod={Name:"callmethods",Value:"",Elements:[],dictAttributes:{sfwMethodName:n.dictAttributes.sfwMethodName}});t.InitialLoad.Elements.indexOf(t.SelectedNewMethod)<=-1&&t.InitialLoad.Elements.push(t.SelectedNewMethod);t.paramtersForNewMethod=[];n.dictAttributes.sfwMethodName&&t.SrvNewMethodCollection&&(i=t.SrvNewMethodCollection.filter(function(t){return t.dictAttributes.ID==n.dictAttributes.sfwMethodName&&t.dictAttributes.sfwMode!="Update"}),i&&i.length>0&&angular.forEach(i[0].Elements,function(n){n.Name=="parameter"&&t.paramtersForNewMethod.push(n)}));t.SrvUpdateMethodCollection&&(i=t.SrvUpdateMethodCollection.filter(function(t){return t.dictAttributes.ID==n.dictAttributes.sfwMethodName&&t.dictAttributes.sfwMode!="New"}),i&&i.length>0?t.IsSameAsNewDisabled=!1:(t.IsSameAsNewDisabled=!0,t.FormLinkModel.IsSameAsNew=!1));!t.FormLinkModel.IsSameAsNew&&t.SelectedNewMethod&&(t.SelectedNewMethod.dictAttributes.sfwMode="New")};t.populateParamtersForUpdate=function(n){if(t.paramtersForUpdateMethod=[],t.SelectedUpdateMethod||(t.SelectedUpdateMethod={Name:"callmethods",Value:"",Elements:[],dictAttributes:{sfwMethodName:n.dictAttributes.sfwMethodName,sfwMode:"Update"}}),t.InitialLoad.Elements.indexOf(t.SelectedUpdateMethod)<=-1&&t.InitialLoad.Elements.push(t.SelectedUpdateMethod),n.dictAttributes.sfwMode="Update",t.paramtersForUpdateMethod=[],n.dictAttributes.sfwMethodName&&t.XmlUpdateMethodsCollection){var i=t.XmlUpdateMethodsCollection.filter(function(t){return t.dictAttributes.ID==n.dictAttributes.sfwMethodName&&t.dictAttributes.sfwMode!="New"});i&&i.length>0&&angular.forEach(i[0].Elements,function(n){n.Name=="parameter"&&t.paramtersForUpdateMethod.push(n)})}};t.populateSrvParamtersForUpdate=function(n){if(t.SelectedUpdateMethod||(t.SelectedUpdateMethod={Name:"callmethods",Value:"",Elements:[],dictAttributes:{sfwMethodName:n.dictAttributes.sfwMethodName,sfwMode:"Update"}}),t.InitialLoad.Elements.indexOf(t.SelectedUpdateMethod)<=-1&&t.InitialLoad.Elements.push(t.SelectedUpdateMethod),n.dictAttributes.sfwMode="Update",t.paramtersForUpdateMethod=[],n.dictAttributes.sfwMethodName&&t.SrvUpdateMethodCollection){var i=t.SrvUpdateMethodCollection.filter(function(t){return t.dictAttributes.ID==n.dictAttributes.sfwMethodName&&t.dictAttributes.sfwMode!="New"});i&&i.length>0&&angular.forEach(i[0].Elements,function(n){n.Name=="parameter"&&t.paramtersForUpdateMethod.push(n)})}};t.openSubQueryDialog=function(){var i=n.$new();i.subQueryType="SubSelectQuery";i.QueryDialog=r.showDialog(i,"Browse For Query","Form/views/BrowseForQuery.html",{width:1e3,height:700});i.$on("onQueryClick",function(n,i){var r={Name:"query",Value:"",dictAttributes:{},Elements:[],Children:[]},u;i.contains(".")&&(u=t.InitialLoad.Elements.filter(function(n){return n.dictAttributes.ID&&n.dictAttributes.ID.contains(i.split(".")[0])}),r.dictAttributes.ID=u&&u.length>0?GetInitialLoadQueryID(i.split(".")[0],t.InitialLoad.Elements,1):GetInitialLoadQueryID(i.split(".")[0],t.SubQueryCollection.Elements,1));r.dictAttributes.sfwQueryRef=i;t.InitialLoad&&(t.InitialLoad.Elements.push(r),t.SubQueryCollection.Elements.push(r),t.SelectedSubQuery=r);n&&n.stopPropagation()})};t.onChangeSubQuery=function(n){if(t.SelectedSubQuery&&n&&n.contains(".")){var i=t.GetQueryId(n.split(".")[0]);t.SelectedSubQuery.dictAttributes.ID=i}};t.GetQueryId=function(n){var u=0,f=n,i=f,r;if(t.InitialLoad)for(r=t.InitialLoad.Elements.filter(function(n){return n.dictAttributes.ID==i});r&&r.length>0;)u++,i=f+u,r=t.InitialLoad.Elements.filter(function(n){return n.dictAttributes.ID==i});return i};t.openEditQueryDialog=function(){var n=t.$new();t.SelectedSubQuery&&(n.strSelectedQuery=t.SelectedSubQuery.dictAttributes.sfwQueryRef,n.subQueryType="SubSelectQuery",n.QueryDialog=r.showDialog(n,"Browse For Query","Form/views/BrowseForQuery.html",{width:1e3,height:700}),n.$on("onQueryClick",function(n,i){i.contains(".")&&(t.SelectedSubQuery.dictAttributes.ID=i.split(".")[0]);t.SelectedSubQuery.dictAttributes.sfwQueryRef=i}),event&&event.stopPropagation())};t.deleteSelectedSubQuery=function(){var n,i;t.SelectedSubQuery&&(n=-1,n=t.SubQueryCollection.Elements.indexOf(t.SelectedSubQuery),n>-1&&t.SubQueryCollection.Elements.splice(n,1),i=-1,t.SelectedSubQuery&&(i=t.InitialLoad.Elements.indexOf(t.SelectedSubQuery)),i>-1&&t.InitialLoad.Elements.splice(i,1),t.SelectedSubQuery=undefined,a(function(){n<t.SubQueryCollection.Elements.length?t.SelectedSubQuery=t.SubQueryCollection.Elements[n]:t.SubQueryCollection.Elements.length>0&&(t.SelectedSubQuery=t.SubQueryCollection.Elements[n-1])}))};t.canDelete=function(){return t.SelectedSubQuery&&t.SubQueryCollection.Elements.length>0?!0:!1};t.moveUpClick=function(){if(t.SelectedSubQuery){var i=t.SubQueryCollection.Elements.indexOf(t.SelectedSubQuery),r=t.SubQueryCollection.Elements[i-1];t.SubQueryCollection.Elements[i-1]=t.SelectedSubQuery;t.SubQueryCollection.Elements[i]=r;n.scrollBySelectedField(".manage-subquery-scroll",".selected",{offsetTop:460,offsetLeft:0})}};t.canmoveUp=function(){if(t.Flag=!0,t.SelectedSubQuery!=undefined)for(var n=0;n<t.SubQueryCollection.Elements.length;n++)t.SubQueryCollection.Elements[n]==t.SelectedSubQuery&&n>0&&(t.Flag=!1);return t.Flag};t.moveDownClick=function(){if(t.SelectedSubQuery){var i=t.SubQueryCollection.Elements.indexOf(t.SelectedSubQuery),r=t.SubQueryCollection.Elements[i+1];t.SubQueryCollection.Elements[i+1]=t.SelectedSubQuery;t.SubQueryCollection.Elements[i]=r;n.scrollBySelectedField(".manage-subquery-scroll",".selected",{offsetTop:450,offsetLeft:0})}};t.canMoveDown=function(){if(t.Flag=!0,t.SelectedSubQuery!=undefined)for(var n=0;n<t.SubQueryCollection.Elements.length;n++)t.SubQueryCollection.Elements[n]==t.SelectedSubQuery&&n<t.SubQueryCollection.Elements.length-1&&(t.Flag=!1);return t.Flag};t.getButtonList=function(n){t.lstButtons&&t.lstButtons.length>0&&(t.inputElement||(t.inputElement=$(n.target)),n.ctrlKey&&n.keyCode==$.ui.keyCode.SPACE&&(setSingleLevelAutoComplete($(t.inputElement),t.lstButtons,t,"ID"),$(t.inputElement).data("ui-autocomplete")&&$(t.inputElement).autocomplete("search",$(t.inputElement).val()),n.preventDefault()),setSingleLevelAutoComplete($(t.inputElement),t.lstButtons,t,"ID"))};t.showButtonList=function(n){t.inputElement||(t.inputElement=$(n.target).prevAll("input[type='text']"));t.inputElement.focus();t.inputElement&&(setSingleLevelAutoComplete(t.inputElement,t.lstButtons,t,"ID"),$(t.inputElement).data("ui-autocomplete")&&$(t.inputElement).autocomplete("search",$(t.inputElement).val()));n&&n.stopPropagation()};t.validateButtonName=function(){var i=[];t.lstButtons&&angular.forEach(t.lstButtons,function(n){n.dictAttributes&&n.dictAttributes.ID&&i.push(n.dictAttributes.ID)});v.checkValidListValue(i,t.FormLinkModel,$(t.inputElement).val(),"sfwDefaultButtonID","sfwDefaultButtonID",y.VALIDATION.BUTTON_NOT_EXISTS,n.validationErrorList)};t.CheckAndAddSessionFields=function(){t.InitialLoad&&(t.InitialLoad.Elements.some(function(n){return n.Name=="session"})||t.InitialLoad.Elements.push(t.SessionFields))};t.addSessionFields=function(){t.CheckAndAddSessionFields();var n=[];n=GetSelectedFieldList(t.SessionFields.lstselectedobjecttreefields,n);n&&n.length>0&&angular.forEach(n,function(n){var i=getDisplayedEntity(t.SessionFields.LstDisplayedEntities),r=n.ID,u,f;i&&i.strDisplayName!=""&&(r=i.strDisplayName+"."+n.ID);n.IsSelected.toLowerCase()=="true"&&(t.SessionFields.Elements.some(function(t){return t.dictAttributes.ID==n.ID})||(u=r,f={Name:"field",Value:"",dictAttributes:{ID:n.ID,sfwEntityField:u},Elements:[]},t.SessionFields.Elements.push(f)),n.IsRecordSelected=!1)});t.SessionFields.lstselectedobjecttreefields&&t.SessionFields.lstselectedobjecttreefields.length>0&&ClearSelectedFieldList(t.SessionFields.lstselectedobjecttreefields)};t.selectedSessionFieldClick=function(n){n&&(t.selectedCurrentSessionRow=n)};t.deleteSelectedRow=function(){var n=-1;t.selectedCurrentSessionRow&&(n=t.SessionFields.Elements.indexOf(t.selectedCurrentSessionRow));t.SessionFields.Elements.splice(n,1);t.selectedCurrentSessionRow=undefined;n<t.SessionFields.Elements.length?t.selectedCurrentSessionRow=t.SessionFields.Elements[n]:t.SessionFields.Elements.length>0&&(t.selectedCurrentSessionRow=t.SessionFields.Elements[n-1])};t.canDeleteRow=function(){return t.selectedCurrentSessionRow?!0:!1};t.moveSelectedRowUp=function(){if(t.selectedCurrentSessionRow){var i=t.SessionFields.Elements.indexOf(t.selectedCurrentSessionRow),i=t.SessionFields.Elements.indexOf(t.selectedCurrentSessionRow),r=t.SessionFields.Elements[i-1];t.SessionFields.Elements[i-1]=t.selectedCurrentSessionRow;t.SessionFields.Elements[i]=r;n.scrollBySelectedField(".details-session-panel-body",".selected",{offsetTop:300,offsetLeft:0})}};t.canmoveSelectedRowUp=function(){var i=!0,n;if(t.selectedCurrentSessionRow!=undefined)for(n=0;n<t.SessionFields.Elements.length;n++)t.SessionFields.Elements[n]==t.selectedCurrentSessionRow&&n>0&&(i=!1);return i};t.moveSelectedRowDown=function(){if(t.selectedCurrentSessionRow){var i=t.SessionFields.Elements.indexOf(t.selectedCurrentSessionRow),i=t.SessionFields.Elements.indexOf(t.selectedCurrentSessionRow),r=t.SessionFields.Elements[i+1];t.SessionFields.Elements[i+1]=t.selectedCurrentSessionRow;t.SessionFields.Elements[i]=r;n.scrollBySelectedField(".details-session-panel-body",".selected",{offsetTop:300,offsetLeft:0})}};t.canmoveSelectedRowDown=function(){var i=!0,n;if(t.selectedCurrentSessionRow!=undefined)for(n=0;n<t.SessionFields.Elements.length;n++)t.SessionFields.Elements[n]==t.selectedCurrentSessionRow&&n<t.SessionFields.Elements.length-1&&(i=!1);return i};t.InitialLoadSectionForDetail();t.OnSelectDetailTab=function(n){t.selectedDetailTab=n;n=="Entity"&&(t.IsEntityTabSelected||(t.IsEntityTabSelected=!0));n=="Group"&&(t.IsGroupTabSelected||(t.IsGroupTabSelected=!0));n=="Session"&&(t.IsSessionTabSelected||(t.IsSessionTabSelected=!0));n=="ExtraFields"&&(t.IsExtraFieldTabSelected||(t.IsExtraFieldTabSelected=!0))};t.OkClick=function(){var e,o,s,f,h;if(u.close(),i&&i!=t.FormLinkModel.dictAttributes.sfwEntity)for(n.entityTreeName=t.FormLinkModel.dictAttributes.sfwEntity,f=0;f<n.lstLoadedEntityTrees.length;f++)if(n.lstLoadedEntityTrees[f].EntityName==i){n.lstLoadedEntityTrees[f].EntityName=t.FormLinkModel.dictAttributes.sfwEntity;break}if(r.UndRedoBulkOp("Start"),t.objDirFunctions.prepareExtraFieldData&&t.objDirFunctions.prepareExtraFieldData(),angular.forEach(t.FormLinkModel.dictAttributes,function(t,i){r.EditPropertyValue(n.FormLinkModel.dictAttributes[i],n.FormLinkModel.dictAttributes,i,t)}),t.MainQuery&&n.MainQuery&&t.MainQuery.dictAttributes.ID!=n.MainQuery.dictAttributes.ID&&(e=GetCriteriaPanel(n.FormLinkModel),n.setNewQueryIdForLookupControl(e,n.MainQuery.dictAttributes.ID,t.MainQuery.dictAttributes.ID,!0)),n.FormLinkModel.dictAttributes.sfwType=="FormLinkLookup"){if(t.MainQuery&&!t.MainQuery.dictAttributes.sfwQueryRef&&(t.MainQuery=undefined,t.InitialLoad=undefined,r.EditPropertyValue(n.MainQuery,n,"MainQuery",undefined),r.EditPropertyValue(n.SelectedQuery,n,"SelectedQuery",undefined)),t.MainQuery&&t.SubQueryCollection.Elements&&n.SubQueryCollection&&n.MainQuery?(e=GetCriteriaPanel(n.FormLinkModel),angular.forEach(n.SubQueryCollection,function(i){var r=!1,u=!0,f="";t.SubQueryCollection&&t.SubQueryCollection.Elements.length>0?angular.forEach(t.SubQueryCollection.Elements,function(n){i.dictAttributes.ID!=n.dictAttributes.ID&&i.dictAttributes.sfwQueryRef==n.dictAttributes.sfwQueryRef&&(r=!0,f=n.dictAttributes.ID,u=!1);i.dictAttributes.ID==n.dictAttributes.ID&&(u=!1)}):r=!0;r&&n.setNewQueryIdForLookupControl(e,i.dictAttributes.ID,f);u&&n.setNewQueryIdForLookupControl(e,i.dictAttributes.ID,"")})):n.SubQueryCollection?(e=GetCriteriaPanel(n.FormLinkModel),angular.forEach(n.SubQueryCollection,function(t){t.dictAttributes&&t.dictAttributes.ID&&n.setNewQueryIdForLookupControl(e,t.dictAttributes.ID,"")})):!t.MainQuery&&n.MainQuery&&n.MainQuery.dictAttributes&&n.MainQuery.dictAttributes.ID&&(e=GetCriteriaPanel(n.FormLinkModel),n.setNewQueryIdForLookupControl(e,n.MainQuery.dictAttributes.ID,t.MainQuery.dictAttributes.ID,!0)),t.MainQuery&&t.InitialLoad){for(f=0;f<t.InitialLoad.Elements.length;f++)if(t.InitialLoad.Elements[f].dictAttributes.sfwQueryRef==t.MainQuery.dictAttributes.sfwQueryRef){t.InitialLoad.Elements[f]=t.MainQuery;break}if(n.FormLinkModel.Elements.some(function(n){return n.Name=="initialload"})){for(f=0;f<n.FormLinkModel.Elements.length;f++)if(n.FormLinkModel.Elements[f].Name=="initialload"){r.DeleteItem(n.FormLinkModel.Elements[f],n.FormLinkModel.Elements);r.InsertItem(t.InitialLoad,n.FormLinkModel.Elements,f);n.FormLinkModel.Elements[f]=t.InitialLoad;break}}else t.InitialLoad&&!n.FormLinkModel.Elements.some(function(n){return n.Name=="initialload"})&&r.InsertItem(t.InitialLoad,n.FormLinkModel.Elements,0)}else for(f=0;f<n.FormLinkModel.Elements.length;f++)if(n.FormLinkModel.Elements[f].Name=="initialload"){r.DeleteItem(n.FormLinkModel.Elements[f],n.FormLinkModel.Elements);break}}else if(n.FormLinkModel&&(n.FormLinkModel.dictAttributes.sfwType=="FormLinkMaintenance"||n.FormLinkModel.dictAttributes.sfwType=="FormLinkWizard")){if(t.SelectedNewMethod&&(t.SelectedNewMethod.dictAttributes.sfwMethodName==undefined||t.SelectedNewMethod.dictAttributes.sfwMethodName=="")&&(o=t.InitialLoad.Elements.indexOf(t.SelectedNewMethod),o>-1&&(t.InitialLoad.Elements.splice(o,1),t.SelectedNewMethod=undefined)),t.SelectedUpdateMethod&&(t.SelectedUpdateMethod.dictAttributes.sfwMethodName==undefined||t.SelectedUpdateMethod.dictAttributes.sfwMethodName=="")&&(s=t.InitialLoad.Elements.indexOf(t.SelectedUpdateMethod),s>-1&&(t.InitialLoad.Elements.splice(s,1),t.SelectedUpdateMethod=undefined)),t.InitialLoad.Elements.some(function(n){return n.Name=="session"})){for(f=0;f<t.InitialLoad.Elements.length;f++)if(t.InitialLoad.Elements[f].Name=="session"){t.SessionFields&&t.SessionFields.Elements.length>0?t.InitialLoad.Elements[f]=t.SessionFields:t.InitialLoad.Elements.splice(f,1);break}}else t.SessionFields&&t.SessionFields.Elements.length>0&&t.InitialLoad.Elements.push(t.SessionFields);if(t.SelectedNewMethod||t.SelectedUpdateMethod||t.SessionFields&&(!t.SessionFields||t.SessionFields.Elements.length!=0)||(t.InitialLoad=undefined),t.InitialLoad&&!n.FormLinkModel.Elements.some(function(n){return n.Name=="initialload"}))r.InsertItem(t.InitialLoad,n.FormLinkModel.Elements,0);else if(t.InitialLoad&&n.FormLinkModel.Elements.some(function(n){return n.Name=="initialload"})){for(f=0;f<n.FormLinkModel.Elements.length;f++)if(n.FormLinkModel.Elements[f].Name=="initialload"){r.DeleteItem(n.FormLinkModel.Elements[f],n.FormLinkModel.Elements);r.InsertItem(t.InitialLoad,n.FormLinkModel.Elements,f);break}}else if(!t.InitialLoad)for(f=0;f<n.FormLinkModel.Elements.length;f++)if(n.FormLinkModel.Elements[f].Name=="initialload"){r.DeleteItem(n.FormLinkModel.Elements[f],n.FormLinkModel.Elements);break}}r.EditPropertyValue(n.InitialLoad,n,"InitialLoad",t.InitialLoad);n.InitialLoadSection();r.UndRedoBulkOp("End");n.FormLinkModel.dictAttributes.sfwType=="FormLinkLookup"&&(h=!1,n.FormLinkModel.IsLookupCriteriaEnabled&&(h=!0),n.PopulateQueryId(h))};n.setNewQueryIdForLookupControl=function(t,i,u,f){t&&angular.forEach(t.Elements,function(t){t.dictAttributes&&t.dictAttributes.sfwQueryID&&t.dictAttributes.sfwQueryID==i&&(u&&u!=""?(r.EditPropertyValue(t.dictAttributes.sfwQueryID,t.dictAttributes,"sfwQueryID",""),t.dictAttributes.sfwQueryID=u):(r.EditPropertyValue(t.dictAttributes.sfwQueryID,t.dictAttributes,"sfwQueryID",""),t.dictAttributes.sfwQueryID="",f||(r.EditPropertyValue(t.dictAttributes.sfwDataField,t.dictAttributes,"sfwDataField",""),t.dictAttributes.sfwDataField="")));t.Elements&&n.setNewQueryIdForLookupControl(t,i,u,f)})};t.validateFormDetails=function(){if(!t.IsPrototypeDetails){t.FormDetailsErrorMessage="";t.objDirFunctions.getExtraFieldData&&(t.objExtraFields=t.objDirFunctions.getExtraFieldData());return validateExtraFields(t)}};t.NavigateToEntityQuery=function(n){if(n&&n!=""&&n.contains(".")){t.OkClick();var i=n.split(".");h.NavigateToFile(i[0],"queries",i[1])}};t.openEntityClick=function(n){n&&n!=""&&(t.OkClick(),h.NavigateToFile(n,"",""))};t.openQueryEditClick=function(n,i){var u=t.$new();u.Title=i;u.newID="";n&&n.dictAttributes.ID&&(u.newID=n.dictAttributes.ID);u.QueryEditDialog=r.showDialog(u,u.Title,"Form/views/SetQueryName.html",{width:500,height:150});u.setQueryName=function(){n.dictAttributes.ID=u.newID;u.closeQueryDialog()};u.closeQueryDialog=function(){u.QueryEditDialog.close()}};t.IsSameAsNewChecked=function(){var r,u,i;t.SelectedUpdateMethod={Name:"callmethods",Value:"",Elements:[],dictAttributes:{sfwMethodName:"",sfwMode:"Update"}};t.FormLinkModel.IsSameAsNew?(t.paramtersForUpdateMethod=[],r=-1,angular.forEach(t.InitialLoad.Elements,function(n){n.Name=="callmethods"&&(n.dictAttributes.sfwMode=="New"&&(n.dictAttributes.sfwMode=""),n.dictAttributes.sfwMode=="Update"&&(r=t.InitialLoad.Elements.indexOf(n)))}),r>-1&&t.InitialLoad.Elements.splice(r,1)):(u=!1,angular.forEach(t.InitialLoad.Elements,function(n){n.Name=="callmethods"&&(n.dictAttributes.sfwMode=="Update"&&(u=!0),n.dictAttributes.sfwMode||(n.dictAttributes.sfwMode="New"))}),u||(i={Name:"callmethods",value:"",prefix:"",dictAttributes:{},Elements:[],Children:[]},i.ParentVM=n.InitialLoad,i.dictAttributes.sfwMode="Update",t.InitialLoad.Elements.push(i),t.SelectedUpdateMethod=i))};t.closeDetailDialog=function(){u.close()}};n.addExtraFieldsDataInToMainModel=function(){if(n.objFormHtmlExtraFields){var t=n.FormLinkModel.Elements.indexOf(n.objFormHtmlExtraFields);t==-1&&n.FormLinkModel.Elements.push(n.objFormHtmlExtraFields)}};n.BeforeSaveToFile=function(){n.addExtraFieldsDataInToMainModel()};n.AfterSaveToFile=function(){n.FormLinkModel&&n.FormLinkModel.dictAttributes&&n.FormLinkModel.dictAttributes.sfwType!="FormLinkLookup"&&(n.dummyLstLoadDetails=LoadDetails(n.FormLinkModel,n.objLoadDetails,!1,r,!0))};n.OpenLoadDetailsDialog=function(){var t=n.$new();n.dummyLstLoadDetails=LoadDetails(n.FormLinkModel,n.objLoadDetails,!0,r,!0);dialog=r.showDialog(t,"Load Details","Form/views/LoadDetails.html",{width:500,height:400});t.onOkClick=function(){dialog.close()}};n.OpenValidateNewDialog=function(){var t=n.$new(),i;if(t.objValidateNew={},t.lstButton=[],t.lstButton=PopulateButtonID(n.FormLinkModel,t.lstButton),n.ValidateNew){if(angular.copy(n.ValidateNew,t.objValidateNew),t.objValidateNew.Elements.length>0)for(i=0;i<t.objValidateNew.Elements.length;i++)t.objValidateNew.Elements[i].IsFieldVisibility=!1}else t.objValidateNew={dictAttributes:{},Children:[],Elements:[],Name:"validatenew",Value:""};dialog=r.showDialog(t,"Set New Validation","Form/views/ValidateNewDialog.html",{width:1280,height:450});t.onOkClick=function(){if(n.ValidateNew){if(r.UndRedoBulkOp("Start"),r.EditPropertyValue(n.ValidateNew.Elements,n.ValidateNew,"Elements",[]),t.objValidateNew&&t.objValidateNew.Elements)for(var i=0;i<t.objValidateNew.Elements.length>0;i++)r.PushItem(t.objValidateNew.Elements[i],n.ValidateNew.Elements);r.UndRedoBulkOp("End")}else r.UndRedoBulkOp("Start"),r.PushItem(t.objValidateNew,n.FormLinkModel.Elements),r.EditPropertyValue(n.ValidateNew,n,"ValidateNew",t.objValidateNew),r.UndRedoBulkOp("End");dialog.close()};t.onCancelClick=function(){dialog.close()};t.GetButtonIntellisense=function(n){var i;n.type=="click"?(i=$(n.target).prevAll("input"),i&&($(i).focus(),setSingleLevelAutoComplete(i,t.lstButton,t,"ID"),$(i).data("ui-autocomplete")&&$(i).autocomplete("search",$(i).val())),n.preventDefault()):(i=$(n.target),n.ctrlKey&&n.keyCode==$.ui.keyCode.SPACE&&$(i).data("ui-autocomplete")?($(i).autocomplete("search",$(i).val()),n.preventDefault()):setSingleLevelAutoComplete(i,t.lstButton,t,"ID"))};t.validateButtonID=function(){var n=[];t.lstButton&&t.lstButton.length>0&&angular.forEach(t.lstButton,function(t){t.dictAttributes&&t.dictAttributes.ID&&n.push(t.dictAttributes.ID)})};t.AddNewValidationRule=function(){t.objValidateNew.Elements.push({dictAttributes:{},Elements:[],Children:[],Name:"button",Value:""});t.objSelectedRule=t.objValidateNew.Elements[t.objValidateNew.Elements.length-1]};t.selectedValidateRule=function(n){t.selectedItem=null;t.objSelectedRule=n};t.canDeleteRule=function(){return t.objSelectedRule?!0:!1};t.DeleteValidationRule=function(){var n=t.objValidateNew.Elements.indexOf(t.objSelectedRule);n>-1&&(t.objValidateNew.Elements.splice(n,1),t.objValidateNew.Elements.length==0?t.objSelectedRule=undefined:t.objValidateNew.Elements.length>n?t.objSelectedRule=t.objValidateNew.Elements[n]:t.objValidateNew.Elements.length>0&&(t.objSelectedRule=t.objValidateNew.Elements[n-1]))};t.ExpandRule=function(n){if(!n.IsFieldVisibility&&t.objValidateNew.Elements.length>0)for(var i=0;i<t.objValidateNew.Elements.length;i++)t.objValidateNew.Elements[i].IsFieldVisibility=!1;n.IsFieldVisibility=!n.IsFieldVisibility};t.selectItem=function(n,i){t.selectedValidateRule(i);t.selectedItem=n};t.canMoveItemsDown=function(){if(t.selectedItem){var n=t.objSelectedRule.Elements.indexOf(t.selectedItem);return n<t.objSelectedRule.Elements.length-1?!0:!1}return!1};t.canMoveItemsUp=function(){if(t.selectedItem){var n=t.objSelectedRule.Elements.indexOf(t.selectedItem);return n<=t.objSelectedRule.Elements.length&&n>0?!0:!1}return!1};t.canDeleteItems=function(){if(t.selectedItem){if(t.objSelectedRule&&t.objSelectedRule.Elements.indexOf(t.selectedItem)>-1)return!0}else return!1};t.moveItemsDown=function(){var n=t.objSelectedRule.Elements.indexOf(t.selectedItem),i;n>-1&&(i=t.objSelectedRule.Elements[n],t.objSelectedRule.Elements[n]=t.objSelectedRule.Elements[n+1],t.objSelectedRule.Elements[n+1]=i)};t.moveItemsUp=function(){var n=t.objSelectedRule.Elements.indexOf(t.selectedItem),i;n>-1&&(i=t.objSelectedRule.Elements[n],t.objSelectedRule.Elements[n]=t.objSelectedRule.Elements[n-1],t.objSelectedRule.Elements[n-1]=i)};t.deleteItems=function(){var n=t.objSelectedRule.Elements.indexOf(t.selectedItem);n>-1&&(t.objSelectedRule.Elements.splice(n,1),t.objSelectedRule.Elements.length==0?t.selectedItem=undefined:t.objSelectedRule.Elements.length>n?t.selectedItem=t.objSelectedRule.Elements[n]:t.objSelectedRule.Elements.length>0&&(t.selectedItem=t.objSelectedRule.Elements[n-1]))};t.EditItems=function(n,i){t.selectedItem=i;t.addItems(i,"Update")};t.addItems=function(i,u){var f=n.$new(),e,o,s,h;if(f.lstControlID=[],f.lstControlID=PopulateControlID(n.FormLinkModel,f.lstControlID),f.lstMethodParam=[],t.lstButton.length>0&&t.objSelectedRule.dictAttributes.ButtonID)for(e=0;e<t.lstButton.length;e++)if(t.lstButton[e].dictAttributes.ID==t.objSelectedRule.dictAttributes.ButtonID&&t.lstButton[e].dictAttributes.sfwNavigationParameter!=""&&t.lstButton[e].dictAttributes.sfwNavigationParameter!=undefined)for(o=t.lstButton[e].dictAttributes.sfwNavigationParameter.split(";"),s=0;s<o.length;s++)o[e]!=""&&(h=o[s].split("="),f.lstMethodParam.push(h[0]));f.objItem=u=="Add"?{dictAttributes:{sfwValidationType:"Required",sfwRequired:"True"},Name:"item",Value:"",Children:[],Elements:[]}:i;f.lstoperator=["","=","!=","<",">","<=",">="];dialogItem=r.showDialog(f,"Add New Items","Form/views/AddNewItemsInValidationRule.html",{width:690,height:420});f.onOkClick=function(n){u=="Add"&&r.PushItem(n,t.objSelectedRule.Elements);dialogItem.close()};f.getControlIDIntellisense=function(n){var t;n&&(n.type=="click"?(t=$(n.target).prevAll("input"),t&&(setSingleLevelAutoComplete(t,f.lstControlID),$(t).data("ui-autocomplete")&&$(t).autocomplete("search",$(t).val())),n.preventDefault()):(t=$(n.target),n.ctrlKey&&n.keyCode==$.ui.keyCode.SPACE&&$(t).data("ui-autocomplete")?($(t).autocomplete("search",$(t).val()),n.preventDefault()):setSingleLevelAutoComplete(t,f.lstControlID)))};f.validateNewItem=function(n){if(n)var t=f.lstControlID&&f.lstControlID.length>0?f.lstControlID:[]};f.QueryChange=function(){f.objItem.dictAttributes.sfwParameters=""};f.objItem&&!f.objItem.TempQueryParameters&&f.objItem.dictAttributes.sfwQueryID!=undefined&&f.objItem.dictAttributes.sfwQueryID!=""&&(f.objItem.TempQueryParameters=l.get(f.objItem.dictAttributes.sfwQueryID));f.openQueryParameterDialog=function(){var n=f.$new(),o,u,i,t,s,e;if(n.objParameter=[],n.lstParameters=f.lstMethodParam,f.objItem.dictAttributes.sfwParameters)for(o=f.objItem.dictAttributes.sfwParameters.split(";"),t=0;t<o.length;t++)u=o[t].split("="),u[0]!=""&&n.objParameter.push({ParameterField:u[0],ParameterValue:u[1]});if(f.objItem.TempQueryParameters)for(i=f.objItem.TempQueryParameters.split(";"),t=0;t<i.length;t++){for(s=!0,e=0;e<n.objParameter.length;e++)if(n.objParameter[e].ParameterField==i[t].replace("=","")){s=!1;break}s&&i[t]!=""&&n.objParameter.push({ParameterField:i[t].replace("=",""),ParameterValue:""})}dialogParam=r.showDialog(n,"Set Query Parameters","Form/views/SetQueryParameter.html",{width:550,height:300});n.paraOkClick=function(){for(var i="",t=0;t<n.objParameter.length;t++)n.objParameter[t].ParameterValue&&n.objParameter[t].ParameterValue!=""&&(i+=n.objParameter[t].ParameterField+"="+n.objParameter[t].ParameterValue+";");f.objItem.dictAttributes.sfwParameters=i;dialogParam.close()};n.paraCancelClick=function(){dialogParam.close()}}}};n.scrollBySelectedField=function(n,t,i){var r=$(n);if(r&&r.hasScrollBar())return r.scrollTo(r.find(t),i,null),!1};n.selectElement=function(t){if(t&&(n.selectedControlId=t),n.selectedControlId){var i=$("#iframe"+n.FormLinkModel.dictAttributes.ID).contents().find("#"+n.selectedControlId);n.$evalAsync(function(){$(i).length&&$(i).trigger("click");a(function(){var r=$("#iframe"+n.FormLinkModel.dictAttributes.ID).filter(":visible").contents().find("body"),t=r.find(".selected-button");t.length<=0&&(t=r.find(".selected-item"));t.length<=0&&(t=r.find(".selected-label"),t=t&&t.length>0?t.parent():t);t.length<=0&&(t=r.find(".selected-grid"));t.length>0&&n.FormLinkModel.dictAttributes.sfwType=="FormLinkWizard"&&n.findParentWizardStep(t,i);t.length<=0&&(t=r.find(".s3-selected-tabsheet"),t=t&&t.length>0?t.parent():t);t&&t.length>0&&$("#iframe"+n.FormLinkModel.dictAttributes.ID).contents().find("html, body").animate({scrollTop:$(t).offset().top-200},"slow")})})}};n.selectElementById=function(t){t&&t.dictAttributes.ID&&(n.selectedControlId=t.dictAttributes.ID,n.selectElement())};n.findParentWizardStep=function(t,i){var u=$("#iframe"+n.FormLinkModel.dictAttributes.ID).contents().find("body"),f=$(t).parents(),r=null;$(f).each(function(){if($(this).attr("sfwcontroltype")&&$(this).attr("sfwcontroltype")=="stepDiv"){var f="#"+$(this).attr("id"),n=u.find("a[href="+f+"]");n&&n.length&&(n[0].click(),$(i).length&&$(i).trigger("click"),r=$(this),a(function(){r.animate({scrollTop:$(t).offset().top},"slow")}))}})};n.LoadNewStyle=function(t){var i=$("#iframe"+n.FormLinkModel.dictAttributes.ID),u=i.contents().find("head"),f=i.contents().find("body"),e;n.selectedPortalDetails&&n.selectedPortalDetails.PortalPath?(n.$evalAsync(function(){r.IsLoading=!0}),b(!0,u,f),e=c.getLastProjectDetails(),$.connection.hubFormLink.server.createStyleForHtx(e.BaseDirectory,n.selectedPortalDetails).done(function(f){n.$evalAsync(function(){var e,o;f?(e=i[0].contentWindow.document.createElement("style"),e.type="text/css",e.styleSheet?e.styleSheet.cssText=f[0]:e.appendChild(i[0].contentWindow.document.createTextNode(f[0])),u[0].appendChild(e),o=i[0].contentWindow.document.createElement("script"),o.type="text/javascript",o.id="portalScript",o.innerHTML=f[1],u[0].appendChild(o),n.bindIframeEvents(t)):r.IsLoading=!1})})):(n.bindIframeEvents(t),b(!1,u,f))};b=function(n,t){t.find("style").remove();t.find("script#portalScript").remove()};n.openProjectSettings=function(){var n=angular.element($('body[ng-controller="MainController"]')).scope();n&&n.openConfigureSettings&&(r.openFromHtx=!0,n.openConfigureSettings(!0))}}]);app.directive("commonformlinkpropertiesdirective",["$compile","$rootScope","ngDialog","$filter","share","$EntityIntellisenseFactory","$NavigateToFileService","hubcontext","$GetEntityFieldObjectService","$Entityintellisenseservice","$getModelList","CONSTANTS",function(n,t,i,r,u,f,e,o,s,h,c,l){return{restrict:"E",replace:!0,scope:{model:"=",parent:"=",formobject:"=",currentPanel:"=",sharedata:"=",lstloadedentitytrees:"=",lstloadedentitycolumnstree:"="},link:function(n,i){function d(n){var t=[];return t.push(""),n!=null&&n!=undefined&&u(n.Elements,t),t}function u(n,t){n&&(n.Name=="items"&&(n=n.Elements),angular.forEach(n,function(n){var i,f,r;n&&(n.Name=="sfwDialogPanel"?(i=n.dictAttributes.ID,i.length>0&&t.push(i)):n.Name=="sfwPanel"?n.Elements.length>0&&n.Elements[0]&&u(n.Elements[0].Elements,t):n.Name=="sfwTabContainer"?n.Elements.length>0&&(f=n.Elements[0],angular.forEach(f.Elements,function(n){u(n,t)})):n.Name=="sfwWizard"&&n.Elements.length>0&&n.Elements[0].Name=="items"&&(r=n.Elements[0],r.Elements.length>0&&angular.forEach(r.Elements,function(n){n.Elements.length>0&&n.Elements[0]!=null&&u(n.Elements[0],t)})))}))}function g(t){t&&(b&&(n.Init(),b=!1),n.InitByControl())}var k=n.$watch("formobject.dictAttributes.sfwEntity",function(){n.formobject&&n.setEntityName()}),w,b,a,v,y,p;n.Init=function(){n.IsLookup=n.formobject.dictAttributes.sfwType=="FormLinkLookup"?!0:!1;n.LoadModes();n.LoadDataFormats();n.LoadTextMode();n.LoadDefaultTypes();n.LoadOperators();n.LoadValidatorOperators();n.LoadSelectionMode();n.LoadRepeatDirection();n.LoadAlignment();n.LoadGridSelection();n.getGroupList();n.LoadDataType();n.LoadType();n.LoadAxisFormatsForChart();n.lstMethodType=[];n.lstMethodType.push("ObjectMethod");n.lstMethodType.push("XmlMethod");n.lstMethodType.push("Rule")};n.setEntityNameBasedonControl=function(){var f="",e,h,i,c,l,o,y,t,r,u,a,v;n.entityName="";i=FindParent(n.model,"sfwGridView");n.model&&(n.model.Name=="sfwGridView"?(n.entityName="",n.model.dictAttributes.sfwParentGrid?(e=FindControlByID(n.formobject,n.model.dictAttributes.sfwParentGrid),e&&e.dictAttributes.sfwEntityField&&(h=s.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,e.dictAttributes.sfwEntityField),h&&(n.entityName=h.Entity))):n.entityName=n.formobject.dictAttributes.sfwEntity):i&&n.model.Name!="TemplateField"?n.formobject&&n.formobject.dictAttributes.sfwType=="FormLinkLookup"?n.entityName=n.formobject.dictAttributes.sfwEntity:f=getEntityBasedOnControl(i):n.model.Name=="TemplateField"?(n.entityName="",i=FindParent(n.model,"sfwGridView"),i&&i.dictAttributes.sfwParentGrid?(r=FindControlByID(n.formobject,i.dictAttributes.sfwParentGrid),r&&r.dictAttributes.sfwEntityField&&(u=s.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,r.dictAttributes.sfwEntityField),u&&(n.entityName=u.Entity))):i&&(n.entityName=n.formobject.dictAttributes.sfwEntity)):(c=FindParent(n.model,"sfwDialogPanel"),l=FindParent(n.model,"sfwListView"),c?f=getEntityBasedOnControl(c):l?f=getEntityBasedOnControl(l):n.entityName=n.formobject.dictAttributes.sfwEntity),f?(y=f,t=FindParent(n.model,"sfwGridView"),t&&t.dictAttributes.sfwParentGrid&&t.dictAttributes.sfwEntityField?(r=FindControlByID(n.formobject,t.dictAttributes.sfwParentGrid),r&&r.dictAttributes.sfwEntityField&&(u=s.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,r.dictAttributes.sfwEntityField),u&&(entityfieldname=u.Entity,FindParent(n.model,"ItemTemplate")&&(a=s.GetEntityFieldObjectFromEntityField(entityfieldname,t.dictAttributes.sfwEntityField),a&&(n.entityName=a.Entity))))):t&&t.dictAttributes.sfwEntityField?n.model.Name!="TemplateField"&&(v=s.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,t.dictAttributes.sfwEntityField),v&&(n.entityName=v.Entity)):(o=s.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,y),o&&o.Entity&&n.$evalAsync(function(){n.entityName=o.Entity}))):n.model&&FindParent(n.model,"ItemTemplate")&&n.formobject.dictAttributes.sfwType!="FormLinkLookup"&&(n.entityName=""))};n.ObjgridBoundedQuery={};n.setQueryFieldsIfGridisBoundedToQuery=function(t){if(t&&t.dictAttributes.sfwBoundToQuery&&t.dictAttributes.sfwBoundToQuery.toLowerCase()=="true"){var i=t.dictAttributes.sfwBaseQuery;$.connection.hubForm.server.getEntityQueryColumns(i,"").done(function(t){n.$evalAsync(function(){if(t&&t.length>0){var i=t;sortListBasedOnproperty(i,"","CodeID");n.ObjgridBoundedQuery.lstselectedobjecttreefields=[];n.ObjgridBoundedQuery.SortedColumns=[];n.ObjgridBoundedQuery.lstselectedobjecttreefields=c.getModelListFromQueryFieldlist(i);n.ObjgridBoundedQuery.SortedColumns=n.ObjgridBoundedQuery.lstselectedobjecttreefields}})});n.IsGridSeleected=!0}else n.ObjgridBoundedQuery.IsQuery=!1};n.InitByControl=function(){function a(t){n.lstButtonMethod.push(t)}var c,e,s,p,w,v,y,b,k,u,g,o,h,r;if(n.RelatedControls=[],n.RelatedControls.push(""),n.lstRelatedGrid=[],n.lstRelatedGrid.push(""),n.lstRelatedDialog=[],n.lstServerMethod=[],n.lstBooleanValues=[],n.lstExecuteAfterSuccessButton=[],n.lstCascadingDropDwonParent=[],n.lstCascadingDropDwonParent.push(""),n.SelectedTab="General",$(i).find("[header-properties-row][category!='Behaviour'] td").addClass("prop-close"),n.MainTable=undefined,lstTable=n.formobject.Elements.filter(function(n){return n.Name=="items"}),lstTable&&lstTable.length>0&&(n.MainTable=lstTable[0]),n.model.Name=="sfwGridView"&&n.model.dictAttributes.sfwBoundToQuery&&n.model.dictAttributes.sfwBoundToQuery.toLowerCase()=="true"?(n.setQueryFieldsIfGridisBoundedToQuery(n.model),n.ObjgridBoundedQuery.IsQuery=!0):(n.setEntityName(),n.ObjgridBoundedQuery.IsQuery=!1),n.model&&n.model.Name=="udc"&&(n.model.dictAttributes.Visible||(n.model.dictAttributes.Visible="True")),n.IsSearchCriteriaSelected=!1,n.IsLookup?n.IsSearchCriteriaSelected=IsCriteriaField(n.model):(n.isFilterCriteria=!1,c=FindParent(n.model,"sfwPanel"),c&&(e=[],FindControlListByName(c,"sfwButton",e),s=e.filter(function(n){return n.dictAttributes.sfwMethodName==="btnGridSearch_Click"}),s.some(function(t){return!t.dictAttributes.sfwNavigationParameter||t.dictAttributes.sfwNavigationParameter&&t.dictAttributes.sfwNavigationParameter.contains(n.model.dictAttributes.ID)})?n.isFilterCriteria=!0:(e=getDescendents(n.formobject,"sfwButton"),s=e.filter(function(n){return n.sfwMethodName==="btnGridSearch_Click"}),s.some(function(t){return t.dictAttributes.sfwNavigationParameter&&t.dictAttributes.sfwNavigationParameter.contains(n.model.dictAttributes.ID)})&&(n.isFilterCriteria=!0)))),n.model.IsChildOfGrid=!1,u=FindParent(n.model,"sfwGridView"),u&&(n.objGridView=u,u.dictAttributes.sfwBoundToQuery&&u.dictAttributes.sfwBoundToQuery.toLowerCase()=="true"?(n.setQueryFieldsIfGridisBoundedToQuery(u),n.ObjgridBoundedQuery.IsQuery=!0):(n.setEntityName(),n.ObjgridBoundedQuery.IsQuery=!1),n.model.IsChildOfGrid=!0),(n.model.Name=="sfwButton"||n.model.Name=="sfwImageButton"||n.model.Name=="sfwLinkButton")&&(n.lstButtonMethod=[],n.model.dictAttributes.sfwMethodName=="btnNew_Click"&&n.PoulateRelatedControlForNew(),n.IsLookup?angular.forEach(t.LstButtonMethodLookup,a):n.formobject.dictAttributes.sfwType=="FormLinkMaintenance"?angular.forEach(t.LstButtonMethodMaintenance,a):n.formobject.dictAttributes.sfwType=="FormLinkWizard"&&angular.forEach(t.LstButtonMethodWizard,a),n.model.Name=="sfwImageButton"&&(p={Code:"btnRetrieve_Click",Description:"Retrieve"},n.lstButtonMethod.push(p)),n.lstEntityFields=[],n.model.dictAttributes.sfwMethodName=="btnOpen_Click"&&n.PopulateEntityFieldsForOpenButton()),n.LoadControlToValidate(),n.LoadControlToCompare(),n.LoadWebControlProperties(),n.findCascadingParentControl(),n.CurrentTable=FindParent(n.model,"sfwTable"),n.LoadRelatedControlTextbox(),n.model)if(n.RelatedControls=n.model.Name=="sfwImageButton"?PopulateAssociatedControlsForRetriveButton(n.model):PopulateAssociatedControls(n.model),n.model.IsChildOfGrid){if(w=FindParent(n.model,"items"),FindControlListByName(w,"sfwButton",n.lstRelatedGrid),n.lstRelatedGrid.length>0){for(v=[],r=0;r<n.lstRelatedGrid.length;r++)v.push(n.lstRelatedGrid[r]);n.lstRelatedGrid=[];v.filter(function(t){t.dictAttributes&&t.dictAttributes.ID&&n.lstRelatedGrid.push(t.dictAttributes.ID)})}}else n.model.dictAttributes.sfwMethodName&&n.model.dictAttributes.sfwMethodName=="btnResetFilterGrid_Click"?PopulateRelatedGrid(n.formobject,n.lstRelatedGrid,!0):PopulateRelatedGrid(n.formobject,n.lstRelatedGrid,!1);if(n.InitOnDblClick(),n.model&&n.model.Name=="sfwWizardStep"&&n.PopulateRelatedButton(),n.model&&(n.model.Name=="sfwMultiSelectDropDownList"||n.model.Name=="sfwChart")&&n.PopulateBooleanValues(),n.model&&(n.model.Name=="sfwButton"||n.model.Name=="sfwLinkButton"||n.model.Name=="sfwImageButton")&&(n.MessageIDText="Message ID:",n.LoadButtonMethodDescription(),n.PopulateOnClientClick(),n.PopulateSecurityLevel(),n.PopulateSelection(),n.PopulateExecuteAfterSuccessButton(),(n.model.dictAttributes.sfwMethodName=="btnOpenPopupDialog_Click"||n.model.dictAttributes.sfwMethodName=="btnNewPopupDialog_Click"||n.model.dictAttributes.sfwMethodName=="btnFinishPopupDialog_Click"||n.model.dictAttributes.sfwMethodName=="btnClosePopupDialog_Click")&&(n.lstRelatedDialog=d(n.MainTable)),y="srvCommon",n.formobject&&n.formobject.dictAttributes.sfwRemoteObject&&(y=n.formobject.dictAttributes.sfwRemoteObject),b=GetServerMethodObject(y,n.formobject.RemoteObjectCollection),k=GetObjectMethods(f.getEntityIntellisense(),n.formobject.dictAttributes.sfwEntity),n.lstServerMethod=PopulateServerMethod(k,n.model,b),n.model.ObjectMethodText="Server Method :",(n.model.dictAttributes.sfwMethodName=="btnCopyRecord_Click"||n.model.dictAttributes.sfwMethodName=="btnExecuteBusinessMethodSelectRows_Click"||n.model.dictAttributes.sfwMethodName=="btnValidateExecuteBusinessMethod_Click"||n.model.dictAttributes.sfwMethodName=="btnExecuteBusinessMethod_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardFindAndNext_Click"||n.model.dictAttributes.sfwMethodName=="btnBack_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardCancel_Click"||n.model.dictAttributes.sfwMethodName=="btnCompleteWorkflowActivities_Click")&&(n.model.ObjectMethodText="Object Method :"),n.PopulateBooleanValues(),n.model.dictAttributes.sfwMethodName=="btnPdfCorrespondence_Click"&&n.InitPDFCorrespondenceNavigationParam(),n.model.dictAttributes.sfwMethodName=="btnExportToPDF_Click"&&(n.lstPageType=l.FORM.LIST_OF_PAGETYPE),n.PopulateWizardSteps()),n.model&&n.model.Name=="sfwImageButton"&&(n.PopulateTextRelatedControl(),n.MessageIDText="Lookup Messages :",n.OnActiveFormValueChange(),n.PopulateImageAlign()),n.model.Name=="TemplateField"){for(n.lstSortExpressions=[],n.lstSortExpressions.push(""),u=FindParent(n.model,"sfwGridView"),u&&PopulateSortExpressions(u,n.lstSortExpressions),n.HeaderTemplateLabel=undefined,r=0;r<n.model.Elements.length;r++)n.model.Elements[r].Name=="HeaderTemplate"&&(n.HeaderTemplateLabel=n.model.Elements[r].Elements[0]);n.HeaderTemplateLabel==undefined&&(g={dictAttributes:{},Elements:[{dictAttributes:{sfwEntityField:""},Elements:[],Children:[],Name:"sfwLabel",Value:"",prefix:"swc"}],Children:[],Name:"HeaderTemplate",Value:"",prefix:"asp"},n.HeaderTemplateLabel=g.Elements[0])}if(n.addHeaderTemplate=function(){var i,t,r;n.model&&n.model.Elements.length>0&&(i=n.model.Elements.filter(function(n){return n.Name=="HeaderTemplate"}),t=n.model.Elements.indexOf(i[0]),t>-1&&n.model.Elements.splice(t,1));n.HeaderTemplateLabel&&n.HeaderTemplateLabel.dictAttributes.sfwEntityField&&(r={dictAttributes:{},Elements:[n.HeaderTemplateLabel],Name:"HeaderTemplate",Value:"",prefix:"asp"},n.model.Elements.push(r))},n.model.SelectActiveFormType="Single",n.IsMultiActiveForm=!1,n.model.dictAttributes.sfwActiveForm&&n.model.dictAttributes.sfwActiveForm.contains("=")&&(n.model.SelectActiveFormType="Multiple",n.IsMultiActiveForm=!0),n.model.strMethodName="",n.model.dictAttributes.sfwMethodName&&(n.model.strMethodName=n.model.dictAttributes.sfwMethodName),n.ActiveFormType="Lookup,Maintenance,Wizard,FormLinkLookup,FormLinkMaintenance,FormLinkWizard",n.model.dictAttributes.sfwMethodName=="btnCorrespondenceRows_Click"?n.ActiveFormType="Maintenance,FormLinkMaintenance":n.model.dictAttributes.sfwMethodName=="btnOpenLookup_Click"?n.ActiveFormType="Lookup,FormLinkLookup,Maintenance,FormLinkMaintenance":(n.model.dictAttributes.sfwMethodName=="btnNew_Click"||n.model.dictAttributes.sfwMethodName=="btnOpen_Click")&&(n.ActiveFormType="Wizard,Maintenance,FormLinkMaintenance,FormLinkWizard"),(n.model.dictAttributes.sfwMethodName=="btnNewUpdate_Click"||n.model.dictAttributes.sfwMethodName=="btnPrototypeSearch_Click")&&(n.ActiveFormType="Maintenance,FormLinkMaintenance"),n.model.dictAttributes.sfwMethodName==="btnRetrieve_Click"&&(n.ActiveFormType="Lookup,FormLinkLookup"),(n.model.Name=="sfwOpenDetail"||n.model.Name=="sfwMultiCorrespondence")&&(n.ActiveFormType="Maintenance,FormLinkMaintenance"),n.model.Name=="sfwSeries"&&(n.ActiveFormType="Maintenance,FormLinkMaintenance"),(n.model.Name=="sfwOpenDetail"||n.model.Name=="sfwMultiCorrespondence"||n.model.dictAttributes.sfwMethodName=="btnWizardAddNewChild_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardFinish_Click"||n.model.dictAttributes.sfwMethodName=="btnRetrieve_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardCancel_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardDeleteChild_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardUpdateChild_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardFindAndNext_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardNext_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardPrevious_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardSaveAndNext_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardSaveAndPrevious_Click")&&(n.IsMultiActiveForm=!1),n.model.Name=="sfwGridView"&&(n.lstParentGrid=[],n.lstParentGrid.push(""),PopulateGridID(n.formobject,n.model.dictAttributes.ID,n.lstParentGrid)),n.IsActiveFormRadioDisabled=function(){return n.model.Name=="sfwOpenDetail"||n.model.Name=="sfwMultiCorrespondence"||n.model.dictAttributes.sfwMethodName=="btnWizardFinish_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardCancel_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardFindAndNext_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardNext_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardPrevious_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardSaveAndNext_Click"||n.model.dictAttributes.sfwMethodName=="btnWizardSaveAndPrevious_Click"?!0:!1},n.ShowPropertyBasedOnCondition(),n.model.Name=="sfwChart"){for(r=0;r<n.model.Elements.length;r++)n.model.Elements[r].Name=="ChartAreas"?(o=n.model.Elements[r],n.chartArea=n.model.Elements[r].Elements[0],n.chartArea&&n.chartArea.Elements.length>0&&(n.Area3D=n.chartArea.Elements[0])):n.model.Elements[r].Name=="Series"&&(h=n.model.Elements[r]);o||(o={Name:"ChartAreas",Value:"",Elements:[],Children:[],dictAttributes:{}},n.model.Elements.push(o));n.chartArea||(n.chartArea={Name:"sfwChartArea",prefix:"swc",Value:"",Elements:[],Children:[],dictAttributes:{}},o.Elements.push(n.chartArea));n.Area3D||(n.Area3D={Name:"Area3DStyle",Value:"",Elements:[],Children:[],dictAttributes:{}},n.chartArea.Elements.push(n.Area3D));h||(h={Name:"Series",Value:"",Elements:[],Children:[],dictAttributes:{}},n.model.Elements.push(h))}(n.model&&n.model.Name=="sfwCheckBoxList"||n.model.Name=="sfwCalender"||n.model.Name=="sfwScheduler")&&n.LoadCollectionFieldEntity();n.model&&(n.model.retrievalType="Query","sfwRetrievalMethod"in n.model.dictAttributes&&n.model.dictAttributes.sfwRetrievalMethod!=undefined&&n.model.dictAttributes.sfwRetrievalMethod!=""&&(n.model.retrievalType="Method"));n.model&&(n.model.autocompleteType="Query",n.model.dictAttributes.sfwAutoMethod&&(n.model.autocompleteType="Method"));n.PopulateKnobStyle=function(){n.lstKnobStyle=["butt","round"];n.model.dictAttributes.sfwKnobLineStyle||(n.model.dictAttributes.sfwKnobLineStyle="butt")};n.PopulateKnobRotation=function(){n.lstKnobRotation=["clockwise","anticlockwise"];n.model.dictAttributes.sfwKnobRotation||(n.model.dictAttributes.sfwKnobRotation="clockwise")};n.PopulateKnobThickness=function(){n.lstKnobThickness=["0.1","0.2","0.3","0.4","0.5"];n.model.dictAttributes.sfwThickness||(n.model.dictAttributes.sfwThickness="0.1")};n.model&&n.model.Name=="sfwKnob"&&(n.PopulateKnobStyle(),n.PopulateKnobRotation(),n.PopulateKnobThickness());n.model.Name=="sfwRuleViewer"&&n.PopulateRulesBasedOnEntity(n.model.dictAttributes.sfwEntityName);n.model&&n.model.Name=="sfwDateTimePicker"&&n.LoadDataFormatsForDateTimePicker();n.CheckForFilterGridControl();n.LoadClientVisibilitySource();n.model&&n.model.dictAttributes.sfwRetrievalQuery&&n.RetrievalQueryInputChange(!0);n.$evalAsync(function(){n.setDefaultCodeGroup()});n.model&&n.model.Name==="sfwLabel"&&n.model.ParentVM&&(n.model.ParentVM.Name==="HeaderTemplate"||n.model.ParentVM.Name==="FooterTemplate")&&(n.model.IsHeaderOrFooterField=!0)};n.ShowPropertyBasedOnCondition=function(){n.IsShowModePropertyVisible();n.IsShowVisibleRulePropertyVisible();n.IsShowResourcePropertyVisible();n.IsShowCssClassPropertyVisible();n.IsShowCustomAttributePropertyVisible()};n.renderTypes=["None","RichText","Rating","NumSpinner"];n.PoulateRelatedControlForFinishScheduler=function(){n.lstSchedulerControl=[];FindControlListByName(n.MainTable,"sfwScheduler",n.lstSchedulerControl);n.lstSchedulerControl.splice(0,0,{dictAttributes:{ID:""}})};n.LoadControlToValidate=function(){if(n.lstControlToValidate=[],n.lstControlToValidate.push(""),n.model.ParentVM!=undefined&&n.model.ParentVM.Elements.length>0)for(var t=0;t<n.model.ParentVM.Elements.length;t++)(n.model.ParentVM.Elements[t].Name=="sfwDropDownList"||n.model.ParentVM.Elements[t].Name=="sfwTextBox")&&n.lstControlToValidate.push(n.model.ParentVM.Elements[t].dictAttributes.ID)};n.LoadControlToCompare=function(){n.lstControlToCompare=[];n.lstControlToCompare.push({dictAttributes:{ID:""}});n.MainTable&&(FindControlListByName(n.MainTable,"sfwDropDownList",n.lstControlToCompare),FindControlListByName(n.MainTable,"sfwTextBox",n.lstControlToCompare))};n.LoadType=function(){n.lstType=[];n.lstType.push("String");n.lstType.push("Integer");n.lstType.push("Double");n.lstType.push("Date");n.lstType.push("Currency")};n.LoadDataType=function(){n.lstDataType=[];n.lstDataType.push("String");n.lstDataType.push("Numeric");n.lstDataType.push("Decimal");n.lstDataType.push("DateTime");n.lstDataType.push("Long")};n.LoadModes=function(){n.lstModes=[];n.lstModes.push("All");n.lstModes.push("New");n.lstModes.push("Update")};n.LoadDataFormats=function(){n.lstDataFormats=[];n.lstDataFormats.push("");n.lstDataFormats.push("{0:d}");n.lstDataFormats.push("{0:C}");n.lstDataFormats.push("{0:G}");n.lstDataFormats.push("{0:#0.00'%}");n.lstDataFormats.push("{0:#0.000'%}");n.lstDataFormats.push("{0:#0.0000'%}");n.lstDataFormats.push("{0:#0.00000'%}");n.lstDataFormats.push("{0:000-##-####}");n.lstDataFormats.push("{0:(###)###-####}")};n.LoadDataFormatsForDateTimePicker=function(){n.lstDataFormatsForDateTime=[];n.lstDataFormatsForDateTime.push("");n.lstDataFormatsForDateTime.push("{0:d}");n.lstDataFormatsForDateTime.push("{0:G}")};n.LoadTextMode=function(){n.lstTextModes=[];n.lstTextModes.push("");n.lstTextModes.push("SingleLine");n.lstTextModes.push("MultiLine");n.lstTextModes.push("Password")};n.LoadDefaultTypes=function(){n.lstDefaultType=[];n.lstDefaultType.push("None");n.lstDefaultType.push("TextValue");n.lstDefaultType.push("TodaysDate");n.lstDefaultType.push("TodaysDateTime");n.lstDefaultType.push("MethodOnServer");n.lstDefaultType.push("MethodOnClient");n.lstDefaultType.push("SystemConstant");n.lstDefaultType.push("ScalarQuery")};n.LoadOperators=function(){n.lstOperators=[];n.lstOperators.push("=");n.lstOperators.push("!=");n.lstOperators.push("<");n.lstOperators.push("<=");n.lstOperators.push(">");n.lstOperators.push(">=");n.lstOperators.push("in");n.lstOperators.push("not in");n.lstOperators.push("like");n.lstOperators.push("exists");n.lstOperators.push("between");n.lstOperators.push("is null");n.lstOperators.push("is not null")};n.LoadValidatorOperators=function(){n.lstValidatorOperators=[];n.lstValidatorOperators.push("Equal");n.lstValidatorOperators.push("NotEqual");n.lstValidatorOperators.push("GreaterThan");n.lstValidatorOperators.push("GreaterThanEqual");n.lstValidatorOperators.push("LessThan");n.lstValidatorOperators.push("LessThanEqual");n.lstValidatorOperators.push("DataTypeCheck")};n.LoadSelectionMode=function(){n.lstSelectionMode=[];n.lstSelectionMode.push("");n.lstSelectionMode.push("Single");n.lstSelectionMode.push("Multiple")};n.LoadRepeatDirection=function(){n.lstRepeatDirection=[];n.lstRepeatDirection.push("Horizontal");n.lstRepeatDirection.push("Vertical")};n.LoadAlignment=function(){n.lstAlignment=[];n.lstAlignment.push("Left");n.lstAlignment.push("Center");n.lstAlignment.push("Right");n.lstAlignment.push("Justify");n.lstAlignment.push("NotSet")};n.LoadGridSelection=function(){n.lstGridSelection=[];n.lstGridSelection.push("None");n.lstGridSelection.push("One");n.lstGridSelection.push("Many")};n.LoadAxisFormatsForChart=function(){n.lstAxisFormat=[];n.lstAxisFormat.push("");n.lstAxisFormat.push("{0:C}");n.lstAxisFormat.push("{0:c}");n.lstAxisFormat.push("{0:d}");n.lstAxisFormat.push("{0:%}");n.lstAxisFormat.push("{0:#0.00'%}");n.lstAxisFormat.push("{0:#0.000'%}");n.lstAxisFormat.push("{0:#0.0000'%}");n.lstAxisFormat.push("{0:#0.00000'%}")};n.setClientVisibilityClick=function(){var i=n.$new();i.model=n.model;i.formobject=n.formobject;i.strAttributeName="sfwClientVisibility";i.Title="Set Client Visibility";i.IsForm=!1;i.objNewDialog=t.showDialog(i,"Set Client Visibility","Form/views/ClientVisibility.html",{width:900,height:650})};n.setClientEnableClick=function(){var i=n.$new();i.strAttributeName="sfwClientEnable";i.Title="Set Client Enability";i.IsForm=!1;i.objNewDialog=t.showDialog(i,"Set Client Enability","Form/views/ClientVisibility.html",{width:900,height:650})};n.onCustomAttributeClick=function(){var i=n.$new();i.propertyName="sfwCustomAttributes";i.model=n.model;i.formobject=n.formobject;i.isFormLink=!0;i.UserLogParaDialog=t.showDialog(i,"Set Custom Attributes","Form/views/CustomAttributes.html",{width:900,height:650})};n.onSetParameterClick=function(){n.model.CommonProp=="CodeGroup"?n.onCodeGroupParameterClick():n.onQueryParameterClick()};n.onCodeGroupParameterClick=function(){var i=n.$new(!0);i.SelectedObject=n.model;i.formobject=n.formobject;i.IsFormCodeGroup=!0;i.NavigationParameterDialog=t.showDialog(i,"Set Parameters","Form/views/ParameterNavigation.html",{width:1e3,height:520})};n.onQueryParameterClick=function(){var i=n.$new(!0);i.SelectedObject=n.model;i.selectedCurrentQuery=n.selectedCurrentQuery;i.formobject=n.formobject;i.isFormLink=!0;i.NavigationParameterDialog=t.showDialog(i,"Navigation Parameters","Form/views/ParameterNavigation.html",{width:1e3,height:520})};n.openImageConditionClick=function(i){var r=n.$new(!0);r.oldConditions=i;r.formobject=n.formobject;r.model=n.model;r.ImageConditionDialog=t.showDialog(r,"Image Condition","Form/views/ImageCondition.html",{width:600,height:505})};n.openBindtoQueryClick=function(i){var r=n.$new(!0);r.gridmodel=i;r.formobject=n.formobject;r.model=n.model;r.BindToQueryDialog=t.showDialog(r,"Bind to Query","Form/views/BindToQuery.html",{width:600,height:500})};n.openCellFormatClick=function(i,r){var u=n.$new(!0);u.TemplateFieldModel=i;u.formEntity=n.formobject.dictAttributes.sfwEntity;u.isLookup=n.IsLookup;u.IsCellOrRow=r;u.CellFormatDialog=t.showDialog(u," Cell Format","Form/views/CellFormate.html",{width:600,height:565})};n.openSetFooterClick=function(i){var r=n.$new(!0),f=FindParent(i,"sfwGridView"),u,o,e;i&&f&&f.dictAttributes.sfwParentGrid?(u=FindControlByID(n.formobject,f.dictAttributes.sfwParentGrid),u&&u.dictAttributes.sfwEntityField&&(o=null,e=s.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,u.dictAttributes.sfwEntityField),e&&(r.formEntity=e.Entity))):r.formEntity=n.formobject.dictAttributes.sfwEntity;r.TemplateFieldModel=i;r.SetFoterDialog=t.showDialog(r,"Footer Details","Form/views/SetFooter.html",{width:600})};n.openDataKeyAndSortExxpressionClick=function(i){var r=n.$new(!0);r.model=i;r.DataKeyAndSortExpressionDialog=t.showDialog(r,"DataKey And Sort Expression","Form/views/DataKeysAndSortExpression.html",{width:800})};n.openGroupExpression=function(){var i=n.$new(!0);i.model=n.model;i.GroupExpressionDialog=t.showDialog(i,"Group Expression","Form/views/ControlProperties/GroupExpression.html",{width:800})};n.onValidationRulesClick=function(i){var r=n.$new(!0);r.model=n.model;r.formobject=n.formobject;r.entityID=i;r.dialogValidation=t.showDialog(r,"Hard Errors","Form/views/SetValidationRules.html",{width:700,height:460})};n.OpenImageUrl=function(t){n.formobject.dictAttributes.WebSite?$.connection.hubForm.server.openImageUrlClick(n.formobject.dictAttributes.WebSite,t).done(function(t){t&&t.length==2&&n.receiveImageFileName(t[0],t[1])}):alert("Please select the appropriate 'Website' from the form details page.")};n.receiveImageFileName=function(t,i){t!=""&&n.$apply(function(){n.model.dictAttributes.ImageUrl=t});i!=""&&i!=undefined&&alert(i)};n.openRetrievalTemplateProp=function(t){n.template="Form/views/Retrieval.html";n.model=t;n.formobject=n.formobject};n.openAutoCompleteTemplateProp=function(t){n.template="Form/views/AutoComplete.html";n.model=t;n.formobject=n.formobject};n.getQuery_dialog=function(){var i=n.$new(!0);n.model.dictAttributes.sfwQueryID!=undefined&&(i.strSelectedQuery=n.model.dictAttributes.sfwQueryID);i.IsForm=!0;i.QueryDialog=t.showDialog(i,"Browse For Query","Form/views/BrowseForQuery.html",{width:1e3,height:700})};n.$on("onFormQueryClick",function(t,i){n.model.dictAttributes.sfwQueryID=i});n.onAddItem=function(){n.model.Elements.push({dictAttributes:{Text:"",Value:""},Elements:[],Children:[],Name:"ListItem",Value:"",prefix:"asp"})};n.SelectItem=function(t){n.selectedItem=t};n.onDeleteItem=function(){if(n.selectedItem!=undefined){var t=n.model.Elements.indexOf(n.selectedItem);t>-1?n.model.Elements.splice(t,1):n.selectedItem==undefined}};n.commonTemplateSelectionChange=function(){n.model.Elements=[];t.UndRedoBulkOp("Start");t.EditPropertyValue(n.model.Elements,n.model,"Elements",[]);t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter","");n.model.Name=="sfwCascadingDropDownList"&&t.EditPropertyValue(n.model.dictAttributes.sfwParameters,n.model.dictAttributes,"sfwParameters","");t.EditPropertyValue(n.model.dictAttributes.DataTextField,n.model.dictAttributes,"DataTextField","");t.EditPropertyValue(n.model.dictAttributes.DataValueField,n.model.dictAttributes,"DataValueField","");t.EditPropertyValue(n.model.dictAttributes.sfwLoadSource,n.model.dictAttributes,"sfwLoadSource","");n.model&&n.model.Name=="sfwCheckBoxList"&&t.EditPropertyValue(n.model.dictAttributes.sfwDefaultValue,n.model.dictAttributes,"sfwDefaultValue","");n.model&&(n.model.Name=="sfwDropDownList"||n.model.Name=="sfwCascadingDropDownList")&&t.EditPropertyValue(n.model.dictAttributes.sfwImageField,n.model.dictAttributes,"sfwImageField","");t.UndRedoBulkOp("End");n.InitializeDropDownItems()};n.onEntityFieldTextChange=function(){n.model.CollectionFieldEntity="";n.model.Name=="sfwCheckBoxList"?t.EditPropertyValue(n.model.dictAttributes.sfwCheckBoxField,n.model.dictAttributes,"sfwCheckBoxField",""):(n.model.Name=="sfwCalendar"||n.model.Name=="sfwScheduler")&&(t.UndRedoBulkOp("Start"),t.EditPropertyValue(n.model.dictAttributes.sfwEventId,n.model.dictAttributes,"sfwEventId",""),t.EditPropertyValue(n.model.dictAttributes.sfwEventName,n.model.dictAttributes,"sfwEventName",""),t.EditPropertyValue(n.model.dictAttributes.sfwEventStartDate,n.model.dictAttributes,"sfwEventStartDate",""),t.EditPropertyValue(n.model.dictAttributes.sfwEventEndDate,n.model.dictAttributes,"sfwEventEndDate",""),n.model.Name=="sfwScheduler"&&t.EditPropertyValue(n.model.dictAttributes.sfwEventCategory,n.model.dictAttributes,"sfwEventCategory",""),t.UndRedoBulkOp("Start"))};n.LoadCheckBoxFieldEntity=function(){if(n.model.dictAttributes.sfwEntityField&&n.formobject.dictAttributes.sfwEntity){var t=n.formobject.dictAttributes.sfwEntity;n.entityName&&(t=n.entityName);objAttribute=s.GetEntityFieldObjectFromEntityField(t,n.model.dictAttributes.sfwEntityField);objAttribute&&objAttribute.Entity&&n.$evalAsync(function(){n.model.CheckBoxFieldEntity=objAttribute.Entity})}};n.LoadCollectionFieldEntity=function(){var t,i;n.model.dictAttributes.sfwEntityField!=undefined&&n.model.dictAttributes.sfwEntityField!=""&&(t=n.formobject.dictAttributes.sfwEntity,n.entityName&&(t=n.entityName),i=s.GetEntityFieldObjectFromEntityField(t,n.model.dictAttributes.sfwEntityField),i&&n.$evalAsync(function(){n.model.CollectionFieldEntity=i.Entity}))};n.getEntityObject=function(n){function u(t){return t.ID==n}var i,r=f.getEntityIntellisense(),t=r.filter(u);return t&&t.length>0&&(i=t[0]),i};n.findCascadingParentControl=function(){var t=[],i;n.model.Name=="sfwCascadingDropDownList"&&(i=FindParent(n.model,"sfwGridView"),i&&i.Elements.length>0?FindControlListByName(i,n.model.Name,t):FindControlListByName(n.MainTable,n.model.Name,t),t&&t.filter(function(t){t.dictAttributes.ID!=n.model.dictAttributes.ID&&n.lstCascadingDropDwonParent.push(t.dictAttributes.ID)}))};n.LoadRelatedControlTextbox=function(){n.lstRelatedControlTextbox=[];n.lstRelatedControlTextbox.push({dictAttributes:{ID:""}});n.MainTable&&FindControlListByNameForTextBox(n.MainTable,"sfwTextBox",n.lstRelatedControlTextbox,n.formobject)};n.showQueryIDIntellisenseList=function(n){var t;t=$(n.target).prevAll("input[type='text']");t.focus();t&&(w(t),$(t).data("ui-autocomplete")&&$(t).autocomplete("search",$(t).val()));n&&n.stopPropagation()};n.onQueryIDChange=function(n){if(n.key!="Down"&&n.key!="Up"&&n.key!="Left"&&n.key!="Right"){var t=$(n.target);n&&n.ctrlKey&&n.keyCode==$.ui.keyCode.SPACE&&$(t).data("ui-autocomplete")?($(t).autocomplete("search",$(t).val()),n.preventDefault()):w(t)}};w=function(t){var r=getCurrentFileScope(),i;if(n.queryIdList=[],r&&r.lstQueryID){i=[];function u(n){n.Name=="query"&&n.dictAttributes.ID&&i.push(n.dictAttributes.ID)}angular.forEach(r.lstQueryID,u);n.queryIdList=i;setSingleLevelAutoComplete(t,i,n)}};n.PopulateRulesBasedOnEntity=function(t){function r(n){return n.ID==t}n.Rules=[];var i=f.getEntityIntellisense().filter(r);i&&i.length>0&&i[0].Rules.length>0&&(n.Rules=i[0].Rules)};n.CheckForFilterGridControl=function(){var t=[],r,i,u,f;if(n.lstBaseQueryColumns=[],n.model&&n.MainTable&&(FindControlListByNames(n.MainTable,["sfwButton","sfwLinkButton","sfwImageButton"],t),t&&t.length>0&&(t=t.filter(function(n){return n.dictAttributes.sfwMethodName=="btnGridSearch_Click"}),t&&t.length>0))){for(i=0;i<t.length;i++)if(t[i].dictAttributes.sfwNavigationParameter&&(u=t[i].dictAttributes.sfwNavigationParameter.split(";"),u&&u.length>0&&u.some(function(t){return t==n.model.dictAttributes.ID}))){n.model.IsShowDataField=!0;r=t[i];break}r&&r.dictAttributes.sfwRelatedControl&&(f=FindControlByID(n.MainTable,r.dictAttributes.sfwRelatedControl),f&&f.dictAttributes.sfwBaseQuery&&$.connection.hubForm.server.getEntityQueryColumns(f.dictAttributes.sfwBaseQuery,"ScopeId_"+n.$id).done(function(t){if(t)for(var i=0;i<t.length;i++)n.lstBaseQueryColumns.push(t[i].CodeID)}))}};n.InitOnDblClick=function(){(n.model.Name=="sfwListPicker"||n.model.Name=="sfwSourceList"||n.model.Name=="sfwRadioButtonList"||n.model.Name=="sfwCascadingDropDownList"||n.model.Name=="sfwDropDownList"||n.model.Name=="sfwCheckBoxList"||n.model.Name=="sfwMultiSelectDropDownList"||n.model.Name=="sfwListBox")&&(n.PopulateLoadTyeps(),n.InitializeDropDownItems())};n.PopulateLoadTyeps=function(){if(n.lstLoadTypes=[],n.lstLoadTypes.push("CodeGroup"),n.lstLoadTypes.push("Query"),!n.IsLookup||n.model&&n.model.Name!="sfwDropDownList"&&n.model.Name!="sfwMultiSelectDropDownList"){n.lstLoadTypes.push("Method");var t=FindParent(n.model,"sfwListView");n.model&&(n.model.IsChildOfGrid||t)&&n.lstLoadTypes.push("ChildMethod")}n.lstLoadTypes.push("ServerMethod");n.lstLoadTypes.push("Items")};n.InitializeDropDownItems=function(){if(n.model)if(n.model.CommonProp=n.model.dictAttributes.sfwLoadType,n.lstCodeValues=[],n.lstQryField=[],n.GetCodeValueFields(),n.model.CommonProp==undefined||n.model.CommonProp=="")n.model.CommonProp="CodeGroup",n.model.dictAttributes.sfwLoadType="CodeGroup";else if(n.model.CommonProp=="Query")n.LoadQueryColumns(n.model.dictAttributes.sfwLoadSource);else if(n.model.CommonProp=="ServerMethod")n.onRemoteObjectChanged(!0)};n.GetCodeValueFields=function(){function u(t){var r=t.ID,u=t.KeyNo,i=t.Value;i||(i="");u!="0"||IsAuditField(r)||n.lstCodeValues.push({CodeID:i,Description:r})}var r=f.getEntityIntellisense(),t=r.filter(function(n){return n.ID=="entCodeValue"}),i;t&&t.length>0&&(i=t[0],angular.forEach(i.Attributes,u))};n.onQuerySearchClick=function(i){n.attributeName="sfwLoadSource";i=="DefaultValue"&&(n.attributeName="sfwDefaultValue");n.strSelectedQuery=n.model.dictAttributes[n.attributeName];var r=n.$new(!0);r.attributeName="sfwLoadSource";i=="DefaultValue"&&(r.attributeName="sfwDefaultValue");r.strSelectedQuery=n.model.dictAttributes[n.attributeName];r.QueryDialog=t.showDialog(r,"Browse For Query","Form/views/BrowseForQuery.html",{width:1e3,height:700})};n.$on("onQueryClick",function(i,r){t.EditPropertyValue(n.model.dictAttributes[n.attributeName],n.model.dictAttributes,n.attributeName,r);n.LoadQueryColumns(n.model.dictAttributes[n.attributeName])});n.LoadQueryColumnsOnChange=function(i){t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter","");n.LoadQueryColumns(i)};n.LoadQueryColumns=function(t){var i,e,r,o;if(t&&(i=t.split("."),i&&i.length==2)){var s=i[0],h=i[1],c=f.getEntityIntellisense(),u=c.filter(function(n){return n.ID==s});u&&u.length>0&&(e=u[0],r=e.Queries.filter(function(n){return n.ID==h}),r&&r.length>0?(o=r[0],n.selectedCurrentQuery=o,$.connection.hubForm.server.getEntityQueryColumns(t,"MainParentPanelCommonProp"+n.formobject.dictAttributes.ID).done(function(t){n.$evalAsync(function(){n.lstQryField=[];n.lstQryField=t})})):n.lstQryField=[])}};n.onBaseQuerySearchClick=function(){var i=n.$new(!0);i.strSelectedQuery=n.model.dictAttributes.sfwBaseQuery;i.IsBaseQuery=!0;i.QueryDialog=t.showDialog(i,"Browse For Query","Form/views/BrowseForQuery.html",{width:1e3,height:700})};n.$on("onBaseQueryClick",function(i,r){t.EditPropertyValue(n.model.dictAttributes.sfwBaseQuery,n.model.dictAttributes,"sfwBaseQuery",r);n.onBaseQueryChange(r)});n.onBaseQueryChange=function(i,r){function b(n){var i={Name:"parameter",Value:"",dictAttributes:{ID:n.ID},Elements:[],Children:[]},f=l.filter(function(n){return n.dictAttributes.ID==i.dictAttributes.ID});f&&f.length>0&&(i.dictAttributes.sfwEntityField=f[0].dictAttributes.sfwEntityField);r?u.Elements.push(i):t.PushItem(i,u.Elements)}var l,o,v,y,s,p,h,w,c,a,e,u;if(n.model.dictAttributes.sfwBaseQuery=i,l=[],n.model.dictAttributes.sfwBaseQuery&&n.model.dictAttributes.sfwBaseQuery!=""){if(o=n.model.dictAttributes.sfwBaseQuery.split("."),o&&o.length==2){if(v=o[0],y=o[1],r||t.UndRedoBulkOp("Start"),e=n.model.Elements.filter(function(n){return n.Name=="Parameters"}),!e||e&&e.length==0?(u={Name:"Parameters",Value:"",dictAttributes:{},Elements:[],Children:[]},r?n.model.Elements.push(u):t.PushItem(u,n.model.Elements)):u=e[0],u){if(u.Elements.length>0)for(s=0;s<u.Elements.length;s++)l.push(u.Elements[s]);u.Elements=[];p=f.getEntityIntellisense();h=p.filter(function(n){return n.ID==v});h&&h.length>0&&(w=h[0],c=w.Queries.filter(function(n){return n.ID==y}),c&&c.length>0&&(a=c[0],a.Parameters.length>0&&angular.forEach(a.Parameters,b)))}r||t.UndRedoBulkOp("Start")}}else e=n.model.Elements.filter(function(n){return n.Name=="Parameters"}),e&&e.length>0&&(u=e[0],u&&(u.Elements=[]))};n.openBaseQueryParamClick=function(){var i,r,u,f;n.onBaseQueryChange(n.model.dictAttributes.sfwBaseQuery,!0);if(i=n.$new(),i.Elements=[],r=n.model.Elements.filter(function(n){return n.Name=="Parameters"}),r&&r.length>0&&r[0]&&r[0].Elements&&r[0].Elements.length>0)for(u=0;u<r[0].Elements.length;u++)f={},angular.copy(r[0].Elements[u],f),i.Elements.push(f);i.entityTreeBinding={selectedobject:null,lstselectedobjects:[],lstentities:[]};i.FormEntity=n.formobject.dictAttributes.sfwEntity;i.onOkClick=function(){if(i.Elements&&i.Elements.length>0){if(t.UndRedoBulkOp("Start"),r&&r.length>0){t.EditPropertyValue(r[0].Elements,r[0],"Elements",[]);for(var n=0;n<i.Elements.length;n++)t.PushItem(i.Elements[n],r[0].Elements)}t.UndRedoBulkOp("End")}i.dialog.close()};i.onParameterSelected=function(n){i.SelectedParameter=n};i.dialog=t.showDialog(i,"Base Query Parameters","Form/views/ControlProperties/GridBaseQueryParameter.html",{width:800,height:525})};n.onEditablePropertyChange=function(){t.UndRedoBulkOp("Start");n.model&&(n.model.dictAttributes.AllowEditing=="True"?(t.EditPropertyValue(n.model.dictAttributes.sfwTwoWayBinding,n.model.dictAttributes,"sfwTwoWayBinding","True"),t.EditPropertyValue(n.model.dictAttributes.sfwCommonFilterBox,n.model.dictAttributes,"sfwCommonFilterBox","False"),t.EditPropertyValue(n.model.dictAttributes.sfwFilterOnKeyPress,n.model.dictAttributes,"sfwFilterOnKeyPress","False")):t.EditPropertyValue(n.model.dictAttributes.sfwTwoWayBinding,n.model.dictAttributes,"sfwTwoWayBinding","False"));t.UndRedoBulkOp("End")};n.canDisabledParameters=function(){var t=!1;return n.model&&(n.model.dictAttributes.sfwLoadType=="CodeGroup"?n.model.placeHolder||n.model.dictAttributes.sfwLoadSource||(t=!0):n.model.dictAttributes.sfwLoadSource||(t=!0)),t};n.onMethodQueryParamClick=function(){var i=n.$new(!0);i.selectedCurrentQuery=n.selectedCurrentQuery;i.SelectedObject=n.model;i.formobject=n.formobject;i.isFormLink=!0;i.NavigationParameterDialog=t.showDialog(i,"Navigation Parameters","Form/views/ParameterNavigation.html",{width:1e3,height:520})};n.IsShowModePropertyVisible=function(){n.IsShowModeProperty=n.model&&n.model.Name!="sfwLiteral"&&n.model.Name!="RequiredFieldValidator"&&n.model.Name!="CompareValidator"&&n.model.Name!="sfwSoftErrors"&&n.model.Name!="TemplateField"&&n.model.Name!="sfwColumn"&&n.model.Name!="sfwPanel"&&n.model.Name!="sfwRuleViewer"?n.model.Name=="sfwTable"||!n.IsLookup&&n.model&&(n.model.Name=="sfwLabel"||n.model.Name=="sfwDropDownList"||n.model.Name=="sfwCascadingDropDownList"||n.model.Name=="sfwMultiSelectDropDownList"||n.model.Name=="sfwCheckBox"||n.model.Name=="sfwRadioButton"||n.model.Name=="sfwTextBox"||n.model.Name=="sfwTargetList"||n.model.Name=="sfwListPicker"||n.model.Name=="sfwSourceList"||n.model.Name=="sfwMultiCorrespondence"||n.model.Name=="sfwOpenDetail"||n.model.Name=="sfwDateTimePicker")||n.model.Name=="RangeValidator"||n.model.Name=="ValidationSummary"||n.model.Name=="RegularExpressionValidator"||n.model.Name=="sfwCheckBoxList"||n.model.Name=="sfwRadioButtonList"||n.model.Name=="sfwButton"||n.model.Name=="sfwLinkButton"||n.model.Name=="sfwCommandButton"||n.model.Name=="sfwSlider"||n.model.Name=="sfwKnob"||n.model.Name=="sfwJSONData"||n.model.Name=="sfwButtonGroup"?!0:!1:!1};n.IsShowVisibleRulePropertyVisible=function(){n.IsShowVisibleRuleProperty=n.IsLookup?n.model.IsChildOfGrid&&n.objGridView?!0:!1:n.model&&n.model.Name!="sfwLiteral"&&n.model.Name!="RequiredFieldValidator"&&n.model.Name!="CompareValidator"&&n.model.Name!="sfwSoftErrors"&&n.model.Name!="TemplateField"&&n.model.Name!="sfwWizard"&&n.model.Name!="udc"&&n.model.Name!="sfwRuleViewer"&&n.model.Name!="TemplateField"?n.model.Name=="sfwTable"||!n.IsLookup&&n.model&&n.model.Name!="sfwColumn"&&n.model.Name!="hr"&&n.model.Name!="br"&&n.model.Name!="sfwCRViewer"&&n.model.Name!="sfwFileLayout"&&n.model.Name!="sfwFileUpload"&&n.model.Name!="sfwTabContainer"&&n.model.Name!="sfwWizardProgress"||n.model.Name=="RangeValidator"||n.model.Name=="ValidationSummary"||n.model.Name=="RegularExpressionValidator"||n.model.Name=="sfwTabSheet"||n.model.Name=="sfwCheckBoxList"||n.model.Name=="sfwRadioButtonList"||n.model.Name=="sfwHyperLink"||n.model.Name=="sfwTable"||n.model.Name=="sfwGridView"?n.model.IsChildOfGrid&&n.objGridView?!0:!0:!1:!1};n.IsShowResourcePropertyVisible=function(){n.IsShowResourceProperty=!1;n.IsLookup||n.model&&!n.model.IsChildOfGrid&&n.model&&n.model.Name!="sfwLiteral"&&n.model.Name!="RequiredFieldValidator"&&n.model.Name!="CompareValidator"&&n.model.Name!="sfwSoftErrors"&&n.model.Name!="TemplateField"&&n.model.Name!="sfwWizard"&&n.model.Name!="sfwColumn"&&n.model.Name!="sfwRuleViewer"&&(n.model.Name=="sfwTable"||n.model&&n.model.Name!="hr"&&n.model.Name!="br"&&n.model.Name!="sfwCRViewer"&&n.model.Name!="sfwFileLayout"&&n.model.Name!="sfwFileUpload"&&n.model.Name!="sfwTabContainer"&&n.model.Name!="sfwWizardProgress"||n.model.Name=="RangeValidator"||n.model.Name=="ValidationSummary"||n.model.Name=="RegularExpressionValidator"||n.model.Name=="sfwTabSheet"||n.model.Name=="sfwCheckBoxList"||n.model.Name=="sfwRadioButtonList"||n.model.Name=="sfwHyperLink"||n.model.Name=="sfwPanel"||n.model.Name=="sfwTable"||n.model.Name=="sfwGridView"||!n.IsLookup&&n.model.Name=="sfwDateTimePicker")&&(n.IsShowResourceProperty=!0)};n.IsShowCssClassPropertyVisible=function(){n.IsShowCssClassProperty=n.model&&n.model.Name!="hr"&&n.model.Name!="br"&&n.model.Name!="TemplateField"&&n.model.Name!="sfwTable"&&n.model.Name!="sfwGridView"&&n.model.Name!="udc"&&n.model.Name!="sfwRuleViewer"&&n.model.Name!="sfwJSONData"?!0:!1};n.IsShowCustomAttributePropertyVisible=function(){};n.LoadWebControlProperties=function(){var i,r;n.model&&t.lstWebControls&&t.lstWebControls.length>0&&(i=t.lstWebControls.filter(function(t){return t.ControlName==n.model.Name}),i=JSON.parse(JSON.stringify(i)),i&&i.length>0&&(n.IsAdvancedOpen&&(n.objAdvanceProperties={},n.objAdvanceProperties.isAccessibilityPropertiesExist=n.GetIncludePropertyList(i[0].lstAccessibility).length>0?!0:!1,n.objAdvanceProperties.isAppearancePropertiesExist=n.GetIncludePropertyList(i[0].lstAppearance).length>0?!0:!1,n.objAdvanceProperties.isBehaviorPropertiesExist=n.GetIncludePropertyList(i[0].lstBehavior).length>0?!0:!1,n.objAdvanceProperties.isCustomPropertiesExist=n.GetIncludePropertyList(i[0].lstCustom).length>0?!0:!1,n.objAdvanceProperties.isLayoutPropertiesExist=n.GetIncludePropertyList(i[0].lstLayout).length>0?!0:!1,n.objAdvanceProperties.isNavigationPropertiesExist=n.GetIncludePropertyList(i[0].lstNavigation).length>0?!0:!1,n.objAdvanceProperties.isExtraPropertiesExist=n.GetIncludePropertyList(i[0].lstExtra).length>0?!0:!1,n.objAdvanceProperties.isMiscPropertiesExist=n.GetIncludePropertyList(i[0].lstMisc).length>0?!0:!1,n.objAdvanceProperties.isBehaviorPropertiesExist?n.objAdvanceProperties.lstBehavior=n.GetIncludePropertyList(i[0].lstBehavior):n.objAdvanceProperties.isAccessibilityPropertiesExist?n.objAdvanceProperties.lstAccessibility=n.GetIncludePropertyList(i[0].lstAccessibility):n.objAdvanceProperties.isAppearancePropertiesExist?n.objAdvanceProperties.lstAppearance=n.GetIncludePropertyList(i[0].lstAppearance):n.objAdvanceProperties.isCustomPropertiesExist&&(n.objAdvanceProperties.lstCustom=n.GetIncludePropertyList(i[0].lstCustom))),n.SetDefaultValueToModel(i[0]),n.model.Name=="sfwLabel"&&"sfwIsCaption"in n.model.dictAttributes&&n.model.dictAttributes.sfwIsCaption&&(r=n.GetPropertyListByName(i[0],"sfwIsCaption"),r&&r.length>0&&(r[0].IsVisible=!1))));n.SetDataToWebControl()};n.SetDataToWebControl=function(){if(n.model){var i=t.lstWebControls.filter(function(t){return t.ControlName==n.model.Name});i=JSON.parse(JSON.stringify(i));n.ClearWebControlPropertyValue(i[0]);function r(t,i){var r=n.GetPropertyListByName(n.objAdvanceProperties,i);r&&r.length>0&&(r[0].PropertyValue=t)}n.model&&angular.forEach(n.model.dictAttributes,r)}};n.ClearWebControlPropertyValue=function(n){function t(n){n.PropertyValue!=n.DefaultValue&&(n.PropertyValue="")}n&&(n.lstAccessibility&&angular.forEach(n.lstAccessibility,t),n.lstAppearance&&angular.forEach(n.lstAppearance,t),n.lstBehavior&&angular.forEach(n.lstBehavior,t),n.lstCustom&&angular.forEach(n.lstCustom,t),n.lstLayout&&angular.forEach(n.lstLayout,t),n.lstNavigation&&angular.forEach(n.lstNavigation,t),n.lstExtra&&angular.forEach(n.lstExtra,t),n.lstAutoComplete&&angular.forEach(n.lstAutoComplete,t),n.lstRetrieval&&angular.forEach(n.lstRetrieval,t),n.lstMisc&&angular.forEach(n.lstMisc,t))};n.GetPropertyListByName=function(n,t){function i(n){return n.PropertyName==t}function r(n){u.push(n)}var u=[],f,e,o,s,h,c,l,a,v,y;return n&&(n.lstAccessibility&&(f=n.lstAccessibility.filter(i),angular.forEach(f,r)),n.lstAppearance&&(e=n.lstAppearance.filter(i),angular.forEach(e,r)),n.lstBehavior&&(o=n.lstBehavior.filter(i),angular.forEach(o,r)),n.lstCustom&&(s=n.lstCustom.filter(i),angular.forEach(s,r)),n.lstLayout&&(h=n.lstLayout.filter(i),angular.forEach(h,r)),n.lstNavigation&&(c=n.lstNavigation.filter(i),angular.forEach(c,r)),n.lstExtra&&(l=n.lstExtra.filter(i),angular.forEach(l,r)),n.lstAutoComplete&&(a=n.lstAutoComplete.filter(i),angular.forEach(a,r)),n.lstRetrieval&&(v=n.lstRetrieval.filter(i),angular.forEach(v,r)),n.lstMisc&&(y=n.lstMisc.filter(i),angular.forEach(y,r))),u};n.SetDefaultValueToModel=function(t){if(n.model){var i=n.GetPropertyList(t,"Common");function r(t){t.DefaultValue!=undefined&&t.DefaultValue!=""&&(n.model.dictAttributes[t.PropertyName]==undefined||n.model.dictAttributes[t.PropertyName]=="")&&(n.model.dictAttributes[t.PropertyName]=t.DefaultValue)}i&&i.length>0&&angular.forEach(i,r)}};n.GetPropertyList=function(n,t){function i(n){r.push(n)}var r=[];return n&&(n.lstAccessibility&&angular.forEach(n.lstAccessibility,i),n.lstAppearance&&angular.forEach(n.lstAppearance,i),n.lstBehavior&&angular.forEach(n.lstBehavior,i),n.lstCustom&&angular.forEach(n.lstCustom,i),n.lstLayout&&angular.forEach(n.lstLayout,i),n.lstNavigation&&angular.forEach(n.lstNavigation,i),n.lstExtra&&angular.forEach(n.lstExtra,i),n.lstAutoComplete&&angular.forEach(n.lstAutoComplete,i),n.lstRetrieval&&angular.forEach(n.lstRetrieval,i)),r};n.onWebControlPropdbClick=function(i){if(i.lstValues&&i.lstValues.length>0){var r=i.lstValues.indexOf(i.PropertyValue);r==i.lstValues.length-1&&(r=-1);t.UndRedoBulkOp("Start");t.EditPropertyValue(i.PropertyValue,i,"PropertyValue",i.lstValues[r+1]);n.onWebControlPropValueChange(i);t.UndRedoBulkOp("End")}event&&event.stopPropagation()};n.onWebControlPropValueChange=function(i){i&&(i.DefaultValue&&(n.model.dictAttributes[i.PropertyName]=i.DefaultValue),t.EditPropertyValue(n.model.dictAttributes[i.PropertyName],n.model.dictAttributes,i.PropertyName,i.PropertyValue))};n.onWebControlValueChange=function(i){i&&t.EditPropertyValue(n.model.dictAttributes[i.key],n.model.dictAttributes,i.key,i.val)};n.DeletePropertyFromModel=function(i){var f,r,u;n.model&&i&&(t.UndRedoBulkOp("Start"),f="",r=t.lstWebControls.filter(function(t){return t.ControlName==n.model.Name}),r=JSON.parse(JSON.stringify(r)),r&&r.length>0&&(u=n.GetPropertyListByName(r[0],i.PropertyName),u&&u.length>0&&(f=u[0].DefaultValue)),t.EditPropertyValue(n.model.dictAttributes[i.PropertyName],n.model.dictAttributes,i.PropertyName,f),t.DeleteItem(i,n.dictAttributesArray),t.UndRedoBulkOp("End"))};n.visibleRuleTextChanged=function(t){var i=[],u=$(t.target),r;n.formobject&&n.formobject.objExtraData&&(r=n.formobject.dictAttributes.sfwType=="Wizard"?!0:!1,i=PopulateEntityRules(n.formobject.objExtraData,r,n.formobject.dictAttributes.sfwInitialLoadGroup),setSingleLevelAutoComplete(u,i))};n.PopulateEntityFieldsForOpenButton=function(i){var u=[],f,r,e;if(PopulateControlsForActiveForm(u,n.formobject,n.model,n.IsLookup),i&&t.EditPropertyValue(n.model.dictAttributes.sfwEntityField,n.model.dictAttributes,"sfwEntityField",""),n.model.IsEntityFieldReset=!0,n.lstEntityFields=[],(n.model.dictAttributes.sfwRelatedControl||n.model.IsChildOfGrid)&&u.length>0)for(f=0;f<u.length;f++)r=u[f],e="",e=r.indexOf("~")>-1?r.substring(0,r.indexOf("~")):r,n.lstEntityFields.some(function(n){return n===e})||n.lstEntityFields.push(e)};n.PopulateBooleanValues=function(){n.lstBooleanValues.push("True");n.lstBooleanValues.push("False")};n.PopulateRelatedButton=function(){function i(t){t.dictAttributes.ID!==n.model.dictAttributes.ID&&n.lstExecuteAfterSuccessButton.push(t.dictAttributes.ID)}n.lstExecuteAfterSuccessButton=[];n.lstExecuteAfterSuccessButton.push("");var t=[];FindControlListByNames(n.model,["sfwButton","sfwLinkButton","sfwImageButton"],t);angular.forEach(t,i)};n.PopulateExecuteAfterSuccessButton=function(){function t(t){t.dictAttributes.ID!==n.model.dictAttributes.ID&&n.lstExecuteAfterSuccessButton.push(t.dictAttributes.ID)}n.lstExecuteAfterSuccessButton=[];n.lstExecuteAfterSuccessButton.push("");var i=[],r=[],u=[];FindControlListByName(n.MainTable,"sfwButton",i);FindControlListByName(n.MainTable,"sfwLinkButton",r);FindControlListByName(n.MainTable,"sfwImageButton",u);angular.forEach(i,t);angular.forEach(r,t);angular.forEach(u,t)};n.LoadButtonMethodDescription=function(){if(n.model.MethodDescription="",n.model.dictAttributes.sfwMethodName!=undefined&&n.model.dictAttributes.sfwMethodName!=""){var i=t.LstButtonMethodLookup.filter(function(t){return t.Code==n.model.dictAttributes.sfwMethodName});i&&i.length>0?n.model.MethodDescription=i[0].Description:(i=t.LstButtonMethodMaintenance.filter(function(t){return t.Code==n.model.dictAttributes.sfwMethodName}),i&&i.length>0?n.model.MethodDescription=i[0].Description:(i=t.LstButtonMethodWizard.filter(function(t){return t.Code==n.model.dictAttributes.sfwMethodName}),i&&i.length>0&&(n.model.MethodDescription=i[0].Description)))}};n.PopulateOnClientClick=function(){n.lstOnClientClick=[];n.lstOnClientClick.push("");n.lstOnClientClick.push("return confirm('Type your message here.')")};n.PopulateSecurityLevel=function(){n.lstSecurityLevel=[];n.lstSecurityLevel.push({Code:"0",Description:" None"});n.lstSecurityLevel.push({Code:"1",Description:" Read"});n.lstSecurityLevel.push({Code:"2",Description:" Modify"});n.lstSecurityLevel.push({Code:"3",Description:" New"});n.lstSecurityLevel.push({Code:"4",Description:" Delete"});n.lstSecurityLevel.push({Code:"5",Description:" Execute"})};n.PopulateSelection=function(){n.lstSelection=[];n.lstSelection.push("None");n.lstSelection.push("One");n.lstSelection.push("Many")};n.PoulateRelatedControlForNew=function(){n.RelatedControlsForNew=[];n.IsLookup?GetAllControls(n.formobject,"sfwLabel,sfwTextBox,sfwDropDownList,sfwCheckBox,sfwRadioButtonList,sfwLinkButton","","",!0,n.RelatedControlsForNew,!1):GetAllControls(n.formobject,"sfwLabel,sfwTextBox,sfwDropDownList,sfwCheckBox,sfwRadioButtonList,sfwLinkButton,sfwScheduler","","",!0,n.RelatedControlsForNew,!0)};n.onRelatedControlandEntityFieldChange=function(){var i=n.model.dictAttributes.sfwActiveForm,u,s,e,r,o;if(i!=undefined&&i!=""){if(u=i.split(";"),u.length>0)for(i=u[0],s="",e=0;e<u.length;e++)r=u[e],r.contains("=")&&(r=r.substring(r.indexOf("=")+1)),s+=s==""?r:";"+r;i.contains("=")&&(i=i.substring(i.indexOf("=")+1));o=[];$.connection.hubMain.server.getSingleFileDetail(i).done(function(i){var s=f.getEntityIntellisense(),r,u,e;GetNavParamCollection(i,n.model,o,s,n.formobject);PopulateParamValues(o,n.model.dictAttributes.sfwNavigationParameter);r=GetNavigationParameterValue(o);n.model.dictAttributes.sfwMethodName=="btnNew_Click"?(u=n.model.dictAttributes.sfwActiveForm.contains("=")?n.model.dictAttributes.sfwRelatedControl:"",n.$evalAsync(function(){r==""?t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter",u):u!=undefined&&u!=""?t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter",r+";"+u):t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter",r)})):n.model.dictAttributes.sfwMethodName=="btnOpen_Click"&&(e=n.model.dictAttributes.sfwActiveForm.contains("=")?n.model.dictAttributes.sfwEntityField:"",n.$evalAsync(function(){n.model.dictAttributes.sfwActiveForm.contains("=")?r==""?t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter",e):e!=undefined&&e!=""?t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter",r+";"+e):t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter",r):t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter",r)}))})}};n.PopulateMessageDescription=function(){n.model.MessageDescription="";n.model.dictAttributes.sfwMessageID!=undefined&&n.model.dictAttributes.sfwMessageID!=""&&hubMain.server.populateMessageList().done(function(t){t&&t.length>0&&n.$evalAsync(function(){var i=t.filter(function(t){return t.MessageID==n.model.dictAttributes.sfwMessageID});i&&i.length>0&&(n.model.MessageDescription=i[0].DisplayMessage)})})};n.PopulateWizardSteps=function(){function r(t){var i=t.dictAttributes.Title;(t.dictAttributes.Title==undefined||t.dictAttributes.Title=="")&&(i=t.dictAttributes.ID);n.WizardStepNames.push({Code:t.dictAttributes.ID,Description:i})}var t,i;n.WizardStepNames=[];t=[];FindControlListByName(n.MainTable,"sfwWizardStep",t);t.length>0&&(i=t,i&&angular.forEach(i,r))};n.onRemoteObjectChanged=function(t){var i="srvCommon",r,u;n.formobject&&n.formobject.dictAttributes.sfwRemoteObject&&(i=n.formobject.dictAttributes.sfwRemoteObject);r=GetServerMethodObject(i,n.formobject.RemoteObjectCollection);u=GetObjectMethods(f.getEntityIntellisense(),n.formobject.dictAttributes.sfwEntity);n.lstServerMethod=PopulateServerMethod(u,n.model,r,t)};n.InitPDFCorrespondenceNavigationParam=function(){var t='"True"';n.model.dictAttributes.sfwNavigationParameter!=undefined&&n.model.dictAttributes.sfwNavigationParameter!=""&&(n.model.IsShowDownloadDialog=n.model.dictAttributes.sfwNavigationParameter.contains("sfwShowDownloadDialog="+t)?!0:!1,n.model.IsLaunchNewWindow=n.model.dictAttributes.sfwNavigationParameter.contains("sfwLaunchNewWindow="+t)?!0:!1)};n.onUserLogParametersClick=function(){var i=n.$new(!0);i.model=n.model;i.formobject=n.formobject;i.propertyName="sfwUserLogParameters";i.isFormLink=!0;i.UserLogParaDialog=t.showDialog(i,"Set User Log Parameters","Form/views/CustomAttributes.html",{width:800,height:525})};n.onSearchActiveFormClick=function(){};n.onAddMultipleActiveFormClick=function(){};n.onNavigationParamsClick=function(){var i;n.model.dictAttributes.sfwMethodName=="btnOpenDoc_Click"?(i=n.$new(!0),i.formobject=n.formobject,i.model=n.model,i.NavigationParameterOpenWordDialog=t.showDialog(i,"Navigation Parameter","Form/views/ParameterNavigationOpenWord.html",{width:800,height:500})):n.model.dictAttributes.sfwMethodName=="btnGridSearch_Click"?(i=n.$new(!0),i.selectedCurrentQuery=n.selectedCurrentQuery,i.SelectedObject=n.model,i.currentTable=n.CurrentTable,i.IsForm=!0,i.IsMultiActiveForm=!1,i.formobject=n.formobject,i.isFormLink=n.isformlink,i.dialog=t.showDialog(i,"Navigation Parameters","Form/views/NavParamGridSearch.html",{width:1e3,height:520})):(i=n.$new(!0),i.selectedCurrentQuery=n.selectedCurrentQuery,i.SelectedObject=n.model,i.IsForm=!0,i.IsMultiActiveForm=!1,i.formobject=n.formobject,i.isFormLink=n.isformlink,i.NavigationParameterDialog=t.showDialog(i,"Navigation Parameters","Form/views/ParameterNavigation.html",{width:1e3,height:520}))};n.onMessageIdClick=function(){};n.onWorkflowActivitesClick=function(){};n.onCheckedChanged=function(){if(n.model.dictAttributes.sfwMethodName=="btnPdfCorrespondence_Click"){var r='"True"',i="";n.model.IsLaunchNewWindow&&n.model.IsShowDownloadDialog?i="sfwLaunchNewWindow="+r+";sfwShowDownloadDialog="+r:n.model.IsLaunchNewWindow&&!n.model.IsShowDownloadDialog?i="sfwLaunchNewWindow="+r:!n.model.IsLaunchNewWindow&&n.model.IsShowDownloadDialog?i="sfwShowDownloadDialog="+r:n.model.IsLaunchNewWindow||n.model.IsShowDownloadDialog||(i="");t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter",i)}};n.onMethodTypeChange=function(){var r,i;t.UndRedoBulkOp("Start");r=n.model.dictAttributes.sfwMethodName;t.EditPropertyValue(r,n.model.dictAttributes,"sfwMethodName",n.model.strMethodName);t.EditPropertyValue(r,n.model,"strMethodName",n.model.strMethodName);n.InitByControl();for(i in n.model.dictAttributes)i!="ID"&&i!="Visible"&&i!="sfwResource"&&i!="sfwVisibleRule"&&i!="sfwEnableRule"&&i!="CssClass"&&i!="sfwCustomAttributes"&&i!="sfwMode"&&i!="sfwMethodName"&&t.EditPropertyValue(n.model.dictAttributes[i],n.model.dictAttributes,i,"");t.UndRedoBulkOp("End")};n.onActiveFormTypeChange=function(i){t.UndRedoBulkOp("Start");t.EditPropertyValue(n.IsMultiActiveForm,n,"IsMultiActiveForm",i);n.model.dictAttributes.sfwMethodName!="btnOpen_Click"||i||t.EditPropertyValue(n.model.dictAttributes.sfwEntityField,n.model.dictAttributes,"sfwEntityField","");t.EditPropertyValue(n.model.dictAttributes.sfwActiveForm,n.model.dictAttributes,"sfwActiveForm","");t.EditPropertyValue(n.model.dictAttributes.sfwNavigationParameter,n.model.dictAttributes,"sfwNavigationParameter","");n.model&&n.model.Name=="sfwLinkButton"&&n.model.dictAttributes.sfwMethodName=="btnOpen_Click"&&!i&&t.EditPropertyValue(n.model.dictAttributes.sfwActiveFormField,n.model.dictAttributes,"sfwActiveFormField","");t.UndRedoBulkOp("End")};n.onTooltipNavigationParamsClick=function(){if(n.model.dictAttributes&&n.model.dictAttributes.sfwActiveForm){var i=n.$new(!0);i.formobject=n.formobject;i.SelectedObject=n.model;i.NavigationParameterDialog=t.showDialog(i,"Navigation Parameter","Form/views/ParameterNavigationForTooltipForm.html",{width:800,height:520})}else alert("Please select active tooltip form")};n.PopulateImageAlign=function(){n.lstImageAlign=[];n.lstImageAlign.push("NotSet");n.lstImageAlign.push("Left");n.lstImageAlign.push("Right");n.lstImageAlign.push("Baseline");n.lstImageAlign.push("Top");n.lstImageAlign.push("Middle");n.lstImageAlign.push("Bottom");n.lstImageAlign.push("AbsBottom");n.lstImageAlign.push("AbsMiddle");n.lstImageAlign.push("TextTop")};n.OnActiveFormValueChange=function(){n.model.Name=="sfwImageButton"&&n.model.dictAttributes.sfwActiveForm!=undefined&&n.model.dictAttributes.sfwActiveForm!=""&&(n.lstSelectedIndex=[],n.lstSelectedIndex.push(""),$.connection.hubForm.server.getNewFormModel(n.model.dictAttributes.sfwActiveForm).done(function(t){n.receivenewformmodel(t)}))};n.receivenewformmodel=function(t){n.$apply(function(){var i;n.objActiveFormModel=t;n.objActiveFormModel&&(n.objActiveFormModel.dictAttributes.sfwType==="Lookup"?(i=n.objActiveFormModel.Elements.filter(function(n){return n.Name=="sfwTable"}),i&&i.length>0&&GetControlNames(i[0],n.lstSelectedIndex)):(i=n.objActiveFormModel.Elements.filter(function(n){return n.Name=="items"}),i&&i.length>0&&GetControlNames(i[0],n.lstSelectedIndex)))})};n.PopulateTextRelatedControl=function(){n.TextRelatedControls=[];PopulateTextRelatedControls(n.formobject,n.TextRelatedControls)};n.onRetrievalParametersClick=function(i){if(i.dictAttributes.sfwActiveForm){var r=n.$new(!0);r.model=i;r.formmodel=n.formobject;r.targetFormModel=n.objActiveFormModel;r.isFormLink=!0;r.RetrievalButtonParaDialog=t.showDialog(r,"Retrieval Parameters","Form/views/RetrievalButtonParameters.html",{width:800,height:600})}else alert("Target Form not present.")};n.getGroupList=function(){n.lstGroupList=[];n.formobject.objExtraData&&n.formobject.objExtraData.lstGroupsList[0]&&(n.lstGroupList=n.formobject.objExtraData.lstGroupsList[0].Elements);n.lstGroupList.splice(0,0,{dictAttributes:{ID:""}})};b=!0;n.setEntityName=function(){var t,i;n.model&&n.model.dictAttributes.sfwRelatedGrid?(t=FindControlByID(n.formobject,n.model.dictAttributes.sfwRelatedGrid),t&&t.dictAttributes.sfwEntityField?(i=s.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,t.dictAttributes.sfwEntityField),i&&(n.entityName=i.Entity)):n.entityName=""):n.setEntityNameBasedonControl()};n.LoadClientVisibilitySource=function(){if(n.model&&n.model.retrievalType&&n.model.retrievalType=="Method"){n.lstColumns=[];n.lstColumns.push({CodeID:"",Description:""});function i(t){if(t.indexOf("=")>0){var i=t.substring(t.indexOf("=")+1);n.lstColumns.push({CodeID:i,Description:i})}}if(n.model&&n.model.dictAttributes&&n.model.dictAttributes.sfwRetrievalControls){var t=n.model.dictAttributes.sfwRetrievalControls.split(";");t&&t.length>0&&angular.forEach(t,i)}}};n.RetrievalQueryInputChange=function(i){var u,s,e,a;if(n.lstColumns=[],n.model.dictAttributes.sfwRetrievalQuery&&(u=n.model.dictAttributes.sfwRetrievalQuery.split("."),u&&u.length==2)){var h=u[0],c=u[1],l=f.getEntityIntellisense(),o=r("filter")(l,{ID:h},!0);o&&o.length>0&&(s=o[0],e=s.Queries.filter(function(n){return n.ID==c}),e&&e.length>0&&(a=e[0],$.connection.hubForm.server.getEntityQueryColumns(n.model.dictAttributes.sfwRetrievalQuery,"ScopeId_"+n.$id).done(function(t){n.$evalAsync(function(){t.splice(0,0,{CodeID:"",Description:""});n.lstColumns=t})})))}i||(t.UndRedoBulkOp("Start"),n.model&&n.model.Name=="sfwCascadingDropDownList"?t.EditPropertyValue(n.model.dictAttributes.sfwCascadingRetrievalParameters,n.model.dictAttributes,"sfwCascadingRetrievalParameters",""):t.EditPropertyValue(n.model.dictAttributes.sfwParameters,n.model.dictAttributes,"sfwParameters",""),t.EditPropertyValue(n.model.dictAttributes.sfwRetrievalControls,n.model.dictAttributes,"sfwRetrievalControls",""),t.EditPropertyValue(n.model.dictAttributes.sfwClientVisibilitySource,n.model.dictAttributes,"sfwClientVisibilitySource",""),t.UndRedoBulkOp("End"))};n.RetrievalMethodInputChange=function(){n.lstColumns=[];t.UndRedoBulkOp("Start");n.model&&n.model.Name=="sfwCascadingDropDownList"?t.EditPropertyValue(n.model.dictAttributes.sfwCascadingRetrievalParameters,n.model.dictAttributes,"sfwCascadingRetrievalParameters",""):t.EditPropertyValue(n.model.dictAttributes.sfwParameters,n.model.dictAttributes,"sfwParameters","");t.EditPropertyValue(n.model.dictAttributes.sfwRetrievalControls,n.model.dictAttributes,"sfwRetrievalControls","");t.EditPropertyValue(n.model.dictAttributes.sfwClientVisibilitySource,n.model.dictAttributes,"sfwClientVisibilitySource","");t.UndRedoBulkOp("End")};n.RetrievalMethodChange=function(i){if(n.lstMethods=[],n.lstColumns=[],t.UndRedoBulkOp("Start"),n.model.retrievalType=="Method"){t.EditPropertyValue(n.model.dictAttributes.sfwRetrievalQuery,n.model.dictAttributes,"sfwRetrievalQuery","");i==!0&&(n.model&&n.model.Name=="sfwCascadingDropDownList"?t.EditPropertyValue(n.model.dictAttributes.sfwCascadingRetrievalParameters,n.model.dictAttributes,"sfwCascadingRetrievalParameters",""):t.EditPropertyValue(n.model.dictAttributes.sfwParameters,n.model.dictAttributes,"sfwParameters",""),t.EditPropertyValue(n.model.dictAttributes.sfwRetrievalControls,n.model.dictAttributes,"sfwRetrievalControls",""),t.EditPropertyValue(n.model.dictAttributes.sfwClientVisibilitySource,n.model.dictAttributes,"sfwClientVisibilitySource",""));var e=f.getEntityIntellisense(),u=r("filter")(e,{ID:n.formobject.dictAttributes.sfwEntity},!0);u&&u.length>0&&u[0].ObjectMethods&&(n.lstMethods=u[0].ObjectMethods);t.UndRedoBulkOp("End")}};n.model&&n.model.dictAttributes.sfwRetrievalMethod?(n.model.retrievalType="Method",n.RetrievalMethodChange(!1)):n.model&&(n.model.retrievalType="Query");n.getParameterRet_dialog=function(){var i=n.$new(!0),r,c,o,l,u,p,e;if(i.model={},angular.copy(n.model,i.model),i.formobject={},angular.copy(n.formobject,i.formobject),n.model.Name=="sfwCascadingDropDownList"?n.model.dictAttributes.sfwCascadingRetrievalParameters!=undefined&&(i.strSelectedParameters=n.model.dictAttributes.sfwCascadingRetrievalParameters):n.model.dictAttributes.sfwParameters!=undefined&&(i.strSelectedParameters=n.model.dictAttributes.sfwParameters),n.model.retrievalType=="Query"&&n.model.dictAttributes.sfwRetrievalQuery&&(r=n.model.dictAttributes.sfwRetrievalQuery.split("."),r&&r.length==2)){var a=r[0],v=r[1],y=f.getEntityIntellisense(),s=y.filter(function(n){return n.ID==a});s&&s.length>0&&(c=s[0],o=c.Queries.filter(function(n){return n.ID==v}),o&&o.length>0&&(l=o[0],i.selectedCurrentQuery=l))}if(n.model.retrievalType=="Method"&&(n.lstMethods=[],u=h.GetIntellisenseData(n.formobject.dictAttributes.sfwEntity,"","",!0,!1,!0,!1,!1,!1),p=[],u&&n.model.dictAttributes.sfwRetrievalMethod))for(e=0;e<u.length;e++)u[e].ID==n.model.dictAttributes.sfwRetrievalMethod&&(i.selectedCurrentQuery=u[e]);i.objNewDialog=t.showDialog(i,"Retrieval Parameters","Form/views/RetrievalParameters.html",{width:700,height:500});i.$on("onRetrievalParameterClick",function(i,r){n.model.Name=="sfwCascadingDropDownList"?t.EditPropertyValue(n.model.dictAttributes.sfwCascadingRetrievalParameters,n.model.dictAttributes,"sfwCascadingRetrievalParameters",r):t.EditPropertyValue(n.model.dictAttributes.sfwParameters,n.model.dictAttributes,"sfwParameters",r);i.stopPropagation()})};n.$on("onRetrievalParameterClick",function(t,i){n.model.Name=="sfwCascadingDropDownList"?n.model.dictAttributes.sfwCascadingRetrievalParameters=i:n.model.dictAttributes.sfwParameters=i;t.stopPropagation()});a=function(){return{setnewScope:function(){dialogScope=n.$new(!0)},loadDialog:function(){var i=n.$new(!0);n.model.dictAttributes.sfwRetrievalControls!=undefined&&(i.strSelectedRetrievalControls=n.model.dictAttributes.sfwRetrievalControls);i.model={};angular.copy(n.model,i.model);i.formobject={};angular.copy(n.formobject,i.formobject);i.IsRetrievalQuery=!0;i.OnOkClick=function(){n.LoadClientVisibilitySource()};i.RetrievalControlsDialog=t.showDialog(i,"Retrieval Controls","Form/views/RetrievalControls.html",{width:700,height:500})},afterDialog:function(i){t.EditPropertyValue(n.model.dictAttributes.sfwRetrievalControls,n.model.dictAttributes,"sfwRetrievalControls",i);dialogScope.$destroy()}}}();n.getRetrievalControl_dialog=function(){a.setnewScope();a.loadDialog()};n.$on("onRetrievalControlClick",function(n,t){a.afterDialog(t)});n.RetrievalQueryChange=function(){n.model.retrievalType=="Query"&&(n.lstColumns=[],t.UndRedoBulkOp("Start"),t.EditPropertyValue(n.model.dictAttributes.sfwRetrievalMethod,n.model.dictAttributes,"sfwRetrievalMethod",""),n.model&&n.model.Name=="sfwCascadingDropDownList"?t.EditPropertyValue(n.model.dictAttributes.sfwCascadingRetrievalParameters,n.model.dictAttributes,"sfwCascadingRetrievalParameters",""):t.EditPropertyValue(n.model.dictAttributes.sfwParameters,n.model.dictAttributes,"sfwParameters",""),t.EditPropertyValue(n.model.dictAttributes.sfwRetrievalControls,n.model.dictAttributes,"sfwRetrievalControls",""),t.EditPropertyValue(n.model.dictAttributes.sfwClientVisibilitySource,n.model.dictAttributes,"sfwClientVisibilitySource",""),t.UndRedoBulkOp("End"))};n.model&&n.model.Name=="sfwTextBox"&&(n.model.dictAttributes.sfwAutoMinLength==undefined||n.model.dictAttributes.sfwAutoMinLength=="")&&(n.model.dictAttributes.sfwAutoMinLength="3");n.model&&n.model.Name=="sfwTextBox"&&(n.model.dictAttributes.sfwDelay==undefined||n.model.dictAttributes.sfwDelay=="")&&(n.model.dictAttributes.sfwDelay="1000");v=function(){return{setnewScope:function(){dialogScope=n.$new(!0)},loadDialog:function(){n.model.dictAttributes.sfwAutoQuery!=undefined&&(dialogScope.strSelectedQuery=n.model.dictAttributes.sfwAutoQuery);dialogScope.IsAutoComplete=!0;dialogScope.QueryDialog=t.showDialog(dialogScope,"Browse For Query","Form/views/BrowseForQuery.html",{width:1e3,height:700})},afterDialog:function(i){t.EditPropertyValue(n.model.dictAttributes.sfwAutoQuery,n.model.dictAttributes,"sfwAutoQuery",i);dialogScope.$destroy()}}}();n.AutoCompleteQueryChange=function(){t.UndRedoBulkOp("Start");t.EditPropertyValue(n.model.dictAttributes.sfwAutoParameters,n.model.dictAttributes,"sfwAutoParameters","");t.EditPropertyValue(n.model.dictAttributes.sfwAutoColumns,n.model.dictAttributes,"sfwAutoColumns","");t.EditPropertyValue(n.model.dictAttributes.sfwAutoFillMapping,n.model.dictAttributes,"sfwAutoFillMapping","");t.UndRedoBulkOp("End")};n.getQueryParameter_dialog=function(){v.setnewScope();v.loadDialog()};n.$on("onAutoCompleteClick",function(n,t){v.afterDialog(t)});n.getParameter_dialog=function(){var i=n.$new(!0),r;i.model={};angular.copy(n.model,i.model);i.formobject={};angular.copy(n.formobject,i.formobject);i.IsAutoComplete=!0;i.FormType=n.formobject.dictAttributes.sfwType;n.model&&n.model.dictAttributes.sfwAutoParameters!=undefined&&(i.strSelectedParameters=n.model.dictAttributes.sfwAutoParameters);n.model.autocompleteType==="Query"&&n.model.dictAttributes.sfwAutoQuery?i.selectedCurrentQuery=f.getQueryByQueryName(n.model.dictAttributes.sfwAutoQuery):n.model.autocompleteType==="Method"&&n.model.dictAttributes.sfwAutoMethod&&(r=h.GetIntellisenseData(n.entityName,null,null,!0,!1,!0,!1,!1,!1),r=r.filter(function(t){return t.ID.toLowerCase()===n.model.dictAttributes.sfwAutoMethod.toLowerCase()}),r&&r.length&&(i.selectedMethod=r[0]));i.objNewDialog=t.showDialog(i,"AutoComplete Parameter","Form/views/AutoCompleteParameter.html",{width:800,height:500})};n.$on("onAutoCompleteParameterClick",function(i,r){t.EditPropertyValue(n.model.dictAttributes.sfwAutoParameters,n.model.dictAttributes,"sfwAutoParameters",r)});y=function(){return{setnewScope:function(){dialogScope=n.$new(!0)},loadDialog:function(){var i=n.$new(!0);n.model.dictAttributes.sfwAutoFillMapping!=undefined&&(i.strSelectedRetrievalControls=n.model.dictAttributes.sfwAutoFillMapping);i.model={};angular.copy(n.model,i.model);i.formobject={};angular.copy(n.formobject,i.formobject);i.IsAutoComplete=!0;i.RetrievalControlsDialog=t.showDialog(i,"Auto Complete Control Mapping","Form/views/RetrievalControls.html",{width:700,height:500})},afterDialog:function(i){t.EditPropertyValue(n.model.dictAttributes.sfwAutoFillMapping,n.model.dictAttributes,"sfwAutoFillMapping",i);dialogScope.$destroy()}}}();n.getRetrievalControlMethod_dialog=function(){y.setnewScope();y.loadDialog()};n.$on("onAutoCompletelControlClick",function(n,t){y.afterDialog(t)});p=function(){return{setnewScope:function(){dialogScope=n.$new(!0)},loadDialog:function(){var i=n.$new(!0);n.model&&n.model.dictAttributes.sfwAutoColumns!=undefined&&(i.strSelectedAutoColumns=n.model.dictAttributes.sfwAutoColumns);i.model={};angular.copy(n.model,i.model);i.formobject={};angular.copy(n.formobject,i.formobject);i.IsAutoComplete=!0;i.entityName=n.entityName;i.AutoCompleteColumnDialog=t.showDialog(i,"AutoComplete Columns","Form/views/AutoCompleteColumns.html",{width:1e3,height:500})},afterDialog:function(i){t.EditPropertyValue(n.model.dictAttributes.sfwAutoColumns,n.model.dictAttributes,"sfwAutoColumns",i);dialogScope.$destroy()}}}();n.getColumns_dialog=function(){p.setnewScope();p.loadDialog()};n.$on("onAutoCompletelColumnsClick",function(n,t){p.afterDialog(t)});n.okClick=function(){n.model&&n.model.dictAttributes.sfwAutoMinLength=="3"&&(n.model.dictAttributes.sfwAutoMinLength="");n.model&&n.model.dictAttributes.sfwDelay=="1000"&&(n.model.dictAttributes.sfwDelay="");n.onCancelClick()};n.autocompleteMethodInputChange=function(){n.lstColumns=[];t.UndRedoBulkOp("Start");t.EditPropertyValue(n.model.dictAttributes.sfwAutoParameters,n.model.dictAttributes,"sfwAutoParameters","");t.EditPropertyValue(n.model.dictAttributes.sfwAutoColumns,n.model.dictAttributes,"sfwAutoColumns","");t.EditPropertyValue(n.model.dictAttributes.sfwAutoFillMapping,n.model.dictAttributes,"sfwAutoFillMapping","");t.UndRedoBulkOp("End")};n.onAutocompleteMethodChange=function(t){if(n.lstColumns=[],n.model.autocompleteType=="Method"){if(t)n.onAutocompleteChange(n.model.autocompleteType);n.model.dictAttributes.sfwAutoQuery=""}};n.onAutocompleteQueryChange=function(t){if(n.lstColumns=[],n.model.autocompleteType=="Query"){if(t)n.onAutocompleteChange(n.model.autocompleteType);n.model.dictAttributes.sfwAutoMethod=""}};n.onAutocompleteChange=function(i,r){r===undefined&&(r=!0);r?(t.UndRedoBulkOp("Start"),i==="Query"?t.EditPropertyValue(n.model.dictAttributes.sfwRetrievalMethod,n.model.dictAttributes,"sfwAutoMethod",""):i==="Method"&&t.EditPropertyValue(n.model.dictAttributes.sfwRetrievalQuery,n.model.dictAttributes,"sfwAutoQuery",""),t.EditPropertyValue(n.model.dictAttributes.sfwAutoParameters,n.model.dictAttributes,"sfwAutoParameters",""),t.EditPropertyValue(n.model.dictAttributes.sfwAutoColumns,n.model.dictAttributes,"sfwAutoColumns",""),t.EditPropertyValue(n.model.dictAttributes.sfwAutoFillMapping,n.model.dictAttributes,"sfwAutoFillMapping",""),t.UndRedoBulkOp("End")):(i==="Query"?n.model.dictAttributes.sfwRetrievalMethod="":i==="Method"&&(n.model.dictAttributes.sfwRetrievalQuery=""),n.model.dictAttributes.sfwAutoParameters="",n.model.dictAttributes.sfwAutoColumns="",n.model.dictAttributes.sfwAutoFillMapping="")};n.lstChartType=t.ChartTypes;n.Enable3DChnage=function(t){!n.Area3D&&(t||t=="True")&&(n.Area3D={dictAttributes:{IsEnable3D:"True",LightStyle:"",Inclination:""},Elements:[],Children:[],Name:"Area3DStyle",Value:""});t&&t!="False"||(n.Area3D.dictAttributes.LightStyle="",n.Area3D.dictAttributes.Inclination="")};n.removeSeriescolumnValues=function(i){var u,r,f;if(n.model.dictAttributes.sfwIsDynamicSeries=="False")for(u=0;u<i.Elements.length;u++)if(i.Elements[u].Name=="Series"){if(r=i.Elements[u],r&&r.Elements.length>0){for(t.UndRedoBulkOp("Start"),f=0;f<r.Elements.length;f++)t.EditPropertyValue(r.Elements[f].dictAttributes.sfwSeriesColumnName,r.Elements[f].dictAttributes,"sfwSeriesColumnName","");t.UndRedoBulkOp("End")}break}};n.onChartTypeChanged=function(){n.model.dictAttributes.ChartType&&(n.model.dictAttributes.ChartType=="Donut"||n.model.dictAttributes.ChartType=="Pie")&&(n.model.dictAttributes.sfwIsDynamicSeries="False",n.removeSeriescolumnValues(n.model))};n.setSeriesClick=function(){var i=n.$new(),u,r,f,e;for(n.model.dictAttributes.sfwEntityField&&n.formobject.dictAttributes.sfwEntity&&(u=s.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,n.model.dictAttributes.sfwEntityField),u&&(i.ParentEntityName=u.Entity)),i.ChartModel=n.model,i.lstToolTipTypes=["None","Chart","Table","Both"],i.DataFormats=["","{0:d}","{0:C}","{0:000-##-####}","{0:(###)###-####}"],r=0;r<n.model.Elements.length;r++)n.model.Elements[r].Name=="Series"&&(i.chartSeries=n.model.Elements[r],i.chartSeries.Elements.length>0&&(i.ObjSeriesModel=i.chartSeries.Elements[0],i.ObjSeriesModel.dictAttributes.ChartType=n.model.dictAttributes.ChartType));f=t.showDialog(i,"Series Properties","Form/views/SeriesProperties.html",{width:1e3,height:720});i.onOkClick=function(){f.close()};i.selectSeries=function(t){i.ObjSeriesModel=t;i.ObjSeriesModel.dictAttributes.ChartType=n.model.dictAttributes.ChartType};i.addSeries=function(){i.chartSeries||(i.chartSeries={dictAttributes:{},Elements:[],Children:[],Name:"Series",Value:""});var u=GetNewSeriesName("Series",i.chartSeries,1),r={dictAttributes:{Name:u,ChartType:n.model.dictAttributes.ChartType},Elements:[],Children:[],Name:"sfwSeries",Value:"",prefix:"swc"};t.PushItem(r,i.chartSeries.Elements);i.selectSeries(r)};e=0;i.deleteSeries=function(){var n=-1,r;if(i.ObjSeriesModel)for(r=0;r<i.chartSeries.Elements.length;r++)if(i.chartSeries.Elements[r]==i.ObjSeriesModel){n=r;break}n>-1&&(t.DeleteItem(i.chartSeries.Elements[n],i.chartSeries.Elements),i.ObjSeriesModel=i.chartSeries.Elements.length>0?n>0?i.chartSeries.Elements[n-1]:i.chartSeries.Elements[i.chartSeries.Elements.length-1]:undefined)};i.onNavigationParamsClick=function(){var r=i.$new();r.SelectedObject=i.ObjSeriesModel;r.IsForm=!0;r.IsMultiActiveForm=!1;r.formobject=n.formobject;r.NavigationParameterDialog=t.showDialog(r,"Navigation Parameters","Form/views/ParameterNavigation.html",{width:1e3,height:520})};i.onAdditionalChartColumnClick=function(){var r=i.$new(),u,e,f,o;if(r.sfwAddtionalChartColumns=[],r.SelectedObject=i.ObjSeriesModel,u="",n.model.dictAttributes.sfwEntityField&&n.formobject.dictAttributes.sfwEntity&&(u=s.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,n.model.dictAttributes.sfwEntityField)),u&&(r.ParentEntityName=u.Entity),i.ObjSeriesModel.dictAttributes.swfAddtionalChartColumns)for(e=i.ObjSeriesModel.dictAttributes.swfAddtionalChartColumns.split(","),f=0;f<e.length;f++)r.sfwAddtionalChartColumns.push({Property:e[f]});o=t.showDialog(r,"Multiple Objects Selection","Form/views/AdditionalChartColumnsDialog.html",{width:1e3,height:490});r.onCancelClick=function(){o.close()};r.onOkClick=function(){for(var u="",n=0;n<r.sfwAddtionalChartColumns.length;n++)r.sfwAddtionalChartColumns[n].Property!=""&&(u==""?u=r.sfwAddtionalChartColumns[n].Property:u+=","+r.sfwAddtionalChartColumns[n].Property);t.EditPropertyValue(i.ObjSeriesModel.dictAttributes.swfAddtionalChartColumns,i.ObjSeriesModel.dictAttributes,"swfAddtionalChartColumns",u);o.close()};r.selectRow=function(n){r.selectedRow=n};r.addProperty=function(){r.sfwAddtionalChartColumns.push({Property:""})};r.deleteProperty=function(){var n=-1,t;if(r.selectedRow)for(t=0;t<r.sfwAddtionalChartColumns.length;t++)if(r.selectedRow==r.sfwAddtionalChartColumns[t]){n=t;break}n>-1&&(r.sfwAddtionalChartColumns.splice(n,1),r.selectedRow=r.sfwAddtionalChartColumns.length>0?n>0?r.sfwAddtionalChartColumns[n-1]:r.sfwAddtionalChartColumns[r.sfwAddtionalChartColumns.length-1]:undefined)}};i.ClearParameter=function(){i.ObjSeriesModel&&i.ObjSeriesModel.dictAttributes&&(i.ObjSeriesModel.dictAttributes.sfwNavigationParameter="")};i.NavigateToActiveForm=function(n){n&&n!=""&&(i.onOkClick(),o.hubMain.server.navigateToFile(n,"").done(function(n){t.openFile(n,undefined)}))};i.OpenTooltipParams=function(){var n=i.$new();i.objTooltipParamsVM=t.showDialog(n,"Set Tooltip Parameters","Form/views/SetToolTipParameters.html",{width:500,height:420});n.onSfxChartTooltipTableCancelClick=function(){i.objTooltipParamsVM&&i.objTooltipParamsVM.close()};n.onSfxChartTooltipTableOKClick=function(){function o(n){var t=n.ID;e&&(t=e+"."+t);r=r?r+";"+t:t}var u=[],f,e,r;u=GetSelectedFieldList(i.ObjSeriesModel.lstselectedobjecttreefields,u);f=getDisplayedEntity(i.ObjSeriesModel.LstDisplayedEntities);e="";f&&f.strDisplayName!=""&&(e=f.strDisplayName);u.length>0&&(angular.forEach(u,o),t.EditPropertyValue(i.ObjSeriesModel.dictAttributes.sfwTooltipTableParams,i.ObjSeriesModel.dictAttributes,"sfwTooltipTableParams",r));n.onSfxChartTooltipTableCancelClick()}}};n.ClickCommonPropsPanels=function(t){n.SelectedTab=t;t=="General"?(n.IsGeneralOpen||(n.IsGeneralOpen=!0),n.setEntityName&&n.setEntityName()):t=="Advanced"?n.IsAdvancedOpen?n.SetDataToWebControl():(n.IsAdvancedOpen=!0,n.LoadWebControlProperties()):t=="Configured"&&(n.dictAttributesArray=[],n.ConvertTodictAttributesArray(),n.IsConfiguredOpen||(n.IsConfiguredOpen=!0))};n.ConvertTodictAttributesArray=function(){var r=[],i;n.model&&(i=t.lstWebControls.filter(function(t){return t.ControlName==n.model.Name}),i=JSON.parse(JSON.stringify(i)),angular.forEach(n.model.dictAttributes,function(t,u){var f,e;t&&(f=[],i&&i.length>0&&(f=n.GetPropertyListByName(i[0],u)),(!f||f&&f.length==0||f&&f.length>0&&f[0].DefaultValue!=t)&&(e={PropertyName:u,PropertyValue:t},f&&f.length>0&&(e.lstValues=f[0].lstValues),e.PropertyName!="runat"&&r.push(e)))}),n.dictAttributesArray=r)};k=n.$watch("model",g);n.NavigateToEntityQuery=function(n){if(n&&n.contains(".")){var t=n.split(".");e.NavigateToFile(t[0],"queries",t[1])}};n.NavigateToEntityQueryFromDetailQueryID=function(t){var r,i,u;t&&n.IsLookup&&n.IsSearchCriteriaSelected&&n.formobject&&n.formobject.Elements&&(r=n.formobject.Elements.filter(function(n){return n.Name&&n.Name=="initialload"}),r&&r.length>0&&r[0].Elements&&(i=r[0].Elements.filter(function(n){return n.dictAttributes&&n.dictAttributes.ID==t}),i&&i.length>0&&i[0].dictAttributes.sfwQueryRef&&i[0].dictAttributes.sfwQueryRef.contains(".")&&(u=i[0].dictAttributes.sfwQueryRef.split("."),e.NavigateToFile(u[0],"queries",u[1]))))};n.NavigateToEntityMethod=function(t){t&&t!=""&&e.NavigateToFile(n.formobject.dictAttributes.sfwEntity,"objectmethods",t)};n.NavigateToEntityExpression=function(t){t&&t!=""&&e.NavigateToFile(n.formobject.dictAttributes.sfwEntity,"attributes",t)};n.NavigateToEntityGroup=function(t){t&&t!=""&&e.NavigateToFile(n.formobject.dictAttributes.sfwEntity,"groupslist",t)};n.NavigateToActiveForm=function(n){if(n&&n!=""){if(n.contains("=")){var r=n.split(";"),i=r[0].split("=");i&&i.length>1&&(n=i[1])}o.hubMain.server.navigateToFile(n,"").done(function(n){t.openFile(n,undefined)})}};n.NavigateToRuleClick=function(n){n&&n!=""&&o.hubMain.server.navigateToFile(n,"").done(function(n){t.openFile(n,!1)})};n.ClickCommonAdvPropsPanels=function(r){var f=t.lstWebControls.filter(function(t){return t.ControlName==n.model.Name}),u;f=JSON.parse(JSON.stringify(f));f&&f.length>0&&(u=$(i).find("[advance-property-table]"),r=="Accessibility"?($(u).find("[header-properties-row][category='Accessibility'] td").toggleClass("prop-close"),$(u).find("tr[category='Accessibility ']:not([header-properties-row])").toggle()):r=="Appearance"?($(u).find("[header-properties-row][category='Appearance'] td").toggleClass("prop-close"),$(u).find("tr[category='Appearance ']:not([header-properties-row])").toggle(),n.objAdvanceProperties.lstAppearance==undefined&&(n.objAdvanceProperties.lstAppearance=n.GetIncludePropertyList(f[0].lstAppearance))):r=="Behaviour"?($(u).find("[header-properties-row][category='Behaviour'] td").toggleClass("prop-close"),$(u).find("tr[category='Behaviour ']:not([header-properties-row])").toggle(),n.objAdvanceProperties.lstBehavior==undefined&&(n.objAdvanceProperties.lstBehavior=n.GetIncludePropertyList(f[0].lstBehavior))):r=="Custom"?($(u).find("[header-properties-row][category='Custom'] td").toggleClass("prop-close"),$(u).find("tr[category='Custom ']:not([header-properties-row])").toggle(),n.objAdvanceProperties.lstCustom==undefined&&(n.objAdvanceProperties.lstCustom=f[0].lstCustom)):r=="Layout"?($(u).find("[header-properties-row][category='Layout'] td").toggleClass("prop-close"),$(u).find("tr[category='Layout ']:not([header-properties-row])").toggle(),n.objAdvanceProperties.lstLayout==undefined&&(n.objAdvanceProperties.lstLayout=n.GetIncludePropertyList(f[0].lstLayout))):r=="Navigation"?($(u).find("[header-properties-row][category='Navigation'] td").toggleClass("prop-close"),$(u).find("tr[category='Navigation ']:not([header-properties-row])").toggle(),n.objAdvanceProperties.lstExtra==undefined&&(n.objAdvanceProperties.lstExtra=n.GetIncludePropertyList(f[0].lstExtra))):r=="Extra"?($(u).find("[header-properties-row][category='Extra'] td").toggleClass("prop-close"),$(u).find("tr[category='Extra ']:not([header-properties-row])").toggle(),n.objAdvanceProperties.lstNavigation==undefined&&(n.objAdvanceProperties.lstNavigation=n.GetIncludePropertyList(f[0].lstNavigation))):r=="Misc"&&($(u).find("[header-properties-row][category='Misc'] td").toggleClass("prop-close"),$(u).find("tr[category='Misc ']:not([header-properties-row])").toggle(),n.objAdvanceProperties.lstMisc==undefined&&(n.objAdvanceProperties.lstMisc=n.GetIncludePropertyList(f[0].lstMisc))),n.SetDataToWebControl())};n.NavigateToEntityField=function(i,r,u){var w,nt,ut,g,h,v,d,ft,tt,et,b,y,k,a,it,rt,l,c;if(i&&n.model){var o=i.split("."),p=[],st=f.getEntityIntellisense(),ot=st,h="",y=null;if(n.model.Name=="TemplateField"&&(y=FindParent(n.model,"sfwGridView")),n.model.Name=="sfwGridView"||n.model.Name=="sfwListView"||n.model.Name=="sfwChart"||y&&y.Name=="sfwGridView")k=FindParent(n.model,"sfwListView"),a=y?y:n.model,k?(l=s.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,k.dictAttributes.sfwEntityField),l&&(it=s.GetEntityFieldObjectFromEntityField(l.Entity,a.dictAttributes.sfwEntityField),it&&(h=l.Entity))):a.dictAttributes.sfwParentGrid&&n.model.Name=="TemplateField"?h=n.entityName:a.dictAttributes.sfwParentGrid&&a.dictAttributes.sfwEntityField?(rt=FindControlByID(n.formobject,a.dictAttributes.sfwParentGrid),l=s.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,rt.dictAttributes.sfwEntityField),l&&(h=l.Entity)):h=n.formobject.dictAttributes.sfwEntity;else if(r)h=r;else if((n.model.Name=="sfwButton"||n.model.Name=="sfwLinkButton")&&n.model.dictAttributes.sfwMethodName&&n.model.dictAttributes.sfwMethodName=="btnOpen_Click"&&n.model.dictAttributes.sfwRelatedControl)if(w=GetFieldFromFormObject(n.formobject,"sfwGridView","ID",n.model.dictAttributes.sfwRelatedControl),w&&w.length>0&&w[0].dictAttributes.sfwEntityField&&n.formobject.dictAttributes.sfwEntity){for(nt=n.formobject.dictAttributes.sfwEntity,ut=[];nt;)v=ot.filter(function(n){return n.ID==nt}),v.length>0?(d=v[0].Attributes,ut=ut.concat(d),nt=v[0].ParentId):nt="";w[0].dictAttributes.sfwEntityField&&(w[0].dictAttributes.sfwEntityField=="InternalErrors"||w[0].dictAttributes.sfwEntityField=="ExternalErrors")?(h="entError",r=h):(c=ut.filter(function(n){return n.ID==w[0].dictAttributes.sfwEntityField}),c&&c.length>0&&c[0].Entity&&(h=c[0].Entity,r=h))}else n.formobject.dictAttributes.sfwEntity&&(h=n.formobject.dictAttributes.sfwEntity);else h=n.entityName;while(h)v=ot.filter(function(n){return n.ID==h}),v.length>0?(d=v[0].Attributes,ft=getFilteredAttribute(n.model.Name,d,o.length>1,u),p=p.concat(ft),h=v[0].ParentId):h="";if(o.length>1)for(g=0;g<o.length-1;g++)if(c=p.filter(function(n){return n.ID==o[g]}),c.length>0&&typeof c[0].DataType!="undefined"&&(c[0].DataType=="Object"||c[0].DataType=="Collection"||c[0].DataType=="CDOCollection"||c[0].DataType=="List")&&typeof c[0].Entity!="undefined")for(h=c[0].Entity,g<o.length-2&&(p=[]);h;)v=ot.filter(function(n){return n.ID==h}),v.length>0?(d=v[0].Attributes,ft=getFilteredAttribute(n.model.Name,d,g<o.length-2,u),p=p.concat(ft),h=v[0].ParentId):h="";p&&p.length>0&&(tt=p.filter(function(n){return n.ID==o[o.length-1]}),tt&&tt.length>0&&(et=o[o.length-1],tt[0].Type&&tt[0].Type=="Description"&&o[o.length-1]&&o[o.length-1].toLowerCase().endsWith("description")&&(et=o[o.length-1].substr(0,o[o.length-1].length-11)+"Value"),o.length==1?(b="",y=null,n.model.Name=="TemplateField"&&(y=FindParent(n.model,"sfwGridView")),n.model.Name=="sfwGridView"||n.model.Name=="sfwListView"||n.model.Name=="sfwChart"||y&&y.Name=="sfwGridView"?(k=FindParent(n.model,"sfwListView"),a=y?y:n.model,k?(l=s.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,k.dictAttributes.sfwEntityField),l&&(it=s.GetEntityFieldObjectFromEntityField(l.Entity,a.dictAttributes.sfwEntityField),it&&(b=l.Entity))):a.dictAttributes.sfwParentGrid&&n.model.Name=="TemplateField"?b=n.entityName:a.dictAttributes.sfwParentGrid&&a.dictAttributes.sfwEntityField?(rt=FindControlByID(n.formobject,a.dictAttributes.sfwParentGrid),l=s.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,rt.dictAttributes.sfwEntityField),l&&(b=l.Entity)):b=n.formobject.dictAttributes.sfwEntity):b=r?r:n.entityName,t.IsLoading=!0,b&&e.NavigateToFile(b,"attributes",et)):o.length>1&&(c=p.filter(function(n){return n.ID==o[o.length-2]}),c&&c!=""&&c[0].Entity&&(t.IsLoading=!0,e.NavigateToFile(c[0].Entity,"attributes",et)))))}};n.setDefaultCodeGroup=function(){var r,i,t;n.model&&n.entityName&&(n.model.Name=="sfwDropDownList"||n.model.Name=="sfwCascadingDropDownList"||n.model.Name=="sfwMultiSelectDropDownList"||n.model.Name=="sfwListPicker"||n.model.Name=="sfwListBox"||n.model.Name=="sfwRadioButtonList")?(i=f.getEntityIntellisense(),t="",(n.IsSearchCriteriaSelected||n.isFilterCriteria)&&n.model.dictAttributes.sfwDataField?t=GetCodeIDForLookup(n.entityName,n.model.dictAttributes.sfwDataField,i):n.model.dictAttributes.sfwEntityField&&(t=GetCodeID(n.entityName,n.model.dictAttributes.sfwEntityField,i)),n.model.placeHolder=t?t:"",r="",(n.IsSearchCriteriaSelected||n.isFilterCriteria)&&n.model.dictAttributes.sfwDataField?r="sfwDataField":n.model.dictAttributes.sfwEntityField&&(r="sfwEntityField")):n.model&&n.model.Name=="sfwCheckBoxList"&&n.model.CheckBoxFieldEntity&&(i=f.getEntityIntellisense(),t="",n.model.dictAttributes.sfwCheckBoxField&&(t=GetCodeID(n.model.CheckBoxFieldEntity,n.model.dictAttributes.sfwCheckBoxField,i)),n.model.placeHolder=t?t:"")};n.setDefaultValueForCheckBoxList=function(){var i=n.$new(),r;i.selectAll=!1;i.lstValues=[];i.checkBoxListDefaultValueSelectAllChange=function(n){i.lstValues.length>0&&angular.forEach(i.lstValues,function(t){t.selected=n})};i.selectDefaultValueCheckBox=function(){if(n.model.dictAttributes.sfwDefaultValue&&n.model.dictAttributes.sfwDefaultValue=="FW_CHECKALL")i.selectAll=!0,i.checkBoxListDefaultValueSelectAllChange(!0);else if(n.model.dictAttributes.sfwDefaultValue&&i.lstValues&&i.lstValues.length>0){var t=n.model.dictAttributes.sfwDefaultValue.split(";");angular.forEach(t,function(n){for(var t=0;t<i.lstValues.length;t++)i.lstValues[t].CodeValue===n&&(i.lstValues[t].selected=!0)})}};n.model.dictAttributes.sfwLoadType=="CodeGroup"?(r="",n.model.dictAttributes.sfwLoadSource&&n.model.dictAttributes.sfwLoadType=="CodeGroup"?r=n.model.dictAttributes.sfwLoadSource:n.model.placeHolder&&(r=n.model.placeHolder),r&&(t.IsLoading=!0,$.connection.hubMain.server.getCodeValuesForDropDown(r).done(function(r){n.$evalAsync(function(){t.IsLoading=!1;r&&r.length>0&&(i.lstValues=r,i.selectDefaultValueCheckBox())})}))):n.model.dictAttributes.sfwLoadType=="Items"&&n.model.Elements.length>0&&(angular.forEach(n.model.Elements,function(n){var t={CodeValue:"",Description:""};n.dictAttributes.Value&&(t.CodeValue=n.dictAttributes.Value);n.dictAttributes.Text&&(t.Description=n.dictAttributes.Text);i.lstValues.push(t)}),i.selectDefaultValueCheckBox());dialog=t.showDialog(i,"CheckBoxList Default Values","Form/views/SetDefaultValueForCheckBoxList.html");i.checkBoxListDefaultValueOkClick=function(){t.UndRedoBulkOp("Start");var r="";n.model.dictAttributes.sfwDefaultValue="";i.selectAll?r="FW_CHECKALL":i.lstValues&&i.lstValues.length>0&&angular.forEach(i.lstValues,function(n){n.selected&&n.CodeValue&&(r?r+=";"+n.CodeValue:r=n.CodeValue)});t.EditPropertyValue(n.model.dictAttributes.sfwDefaultValue,n.model.dictAttributes,"sfwDefaultValue",r);t.UndRedoBulkOp("End");i.closeDialog()};i.closeDialog=function(){dialog.close()}};n.GetIncludePropertyList=function(t){var u=[],i,r;if(n.model)for(i=0;i<t.length>0;i++)r=GetVisiblePropertyForHtmlControls(n.model.Name),(t[i].PropertyName=="Visible"||t[i].PropertyName=="CssClass"||t[i].PropertyName.startsWith("sfw")||r&&r.some(function(n){return n==t[i].PropertyName}))&&u.push(t[i]);return u};n.ClearSelectColVisibleRule=function(){n.model.dictAttributes.sfwSelectColVisibleRule&&n.model.dictAttributes.sfwSelection!="Many"&&n.model.dictAttributes.sfwSelection!="One"&&t.EditPropertyValue(n.model.dictAttributes.sfwSelectColVisibleRule,n.model.dictAttributes,"sfwSelectColVisibleRule","")};n.onChangeOfParentGrid=function(){n.setEntityNameBasedonControl()};n.onChangeOfMethodType=function(i){t.UndRedoBulkOp("Start");n.showRules=!1;n.showObjectMethod=!1;n.showXmlMethod=!1;i=="ObjectMethod"?(n.showObjectMethod=!0,n.Title="Object Method :"):i=="XmlMethod"?(n.showXmlMethod=!0,n.Title="Xml Method :"):i=="Rule"&&(n.showRules=!0,n.Title="Rule :");n.model.dictAttributes.sfwObjectMethod="";n.model.dictAttributes.sfwNavigationParameter="";t.UndRedoBulkOp("End")};n.setQueryParametersForOpenDetail=function(){var i=n.$new(),r,u,f,e,o;if(i.Elements=[],r=n.model.Elements.filter(function(n){return n.Name=="Parameters"}),r&&r.length>0&&r[0]&&r[0].Elements&&r[0].Elements.length>0)for(u=0;u<r[0].Elements.length;u++)f={},angular.copy(r[0].Elements[u],f),i.Elements.push(f);i.entityTreeBinding={selectedobject:null,lstselectedobjects:[],lstentities:[]};n.model.dictAttributes.sfwRelatedControl&&(e=FindControlByID(n.formobject,n.model.dictAttributes.sfwRelatedControl),e&&(o=s.GetEntityFieldObjectFromEntityField(n.formobject.dictAttributes.sfwEntity,e.dictAttributes.sfwEntityField),o&&(i.FormEntity=o.Entity)));i.FormEntity||(i.FormEntity=n.formobject.dictAttributes.sfwEntity);i.onOkClick=function(){if(i.Elements&&i.Elements.length>0){if(t.UndRedoBulkOp("Start"),r&&r.length>0){t.EditPropertyValue(r[0].Elements,r[0],"Elements",[]);for(var n=0;n<i.Elements.length;n++)t.PushItem(i.Elements[n],r[0].Elements)}t.UndRedoBulkOp("End")}i.dialog.close()};i.onParameterSelected=function(n){i.SelectedParameter=n};i.dialog=t.showDialog(i,"Base Query Parameters","Form/views/ControlProperties/GridBaseQueryParameter.html",{width:800,height:525})};n.updateOpenDetailQueryParameters=function(){var i,r,u,o,e,s,h;if(t.UndRedoBulkOp("Start"),i=n.model.Elements.filter(function(n){return n.Name==="Parameters"})[0],n.model.dictAttributes.sfwQueryID){if(i||(i={Name:"Parameters",dictAttributes:{},Elements:[]},t.PushItem(i,n.model.Elements)),t.EditPropertyValue(i.Elements,i,"Elements",[]),r=f.getQueryByQueryName(n.model.dictAttributes.sfwQueryID),r)for(u=0,o=r.Parameters.length;u<o;u++)e=r.Parameters[u],s={Name:"Parameter",dictAttributes:{ID:e.ID,sfwDataType:e.DataType},Elements:[]},t.PushItem(s,i.Elements)}else i&&(h=n.model.Elements.indexOf(i),h>-1&&t.DeleteItem(i,n.model.Elements));t.UndRedoBulkOp("End")};n.onTextModeChanged=function(){if(n.model.dictAttributes.TextMode==="MultiLine"){var i=["None","RichText"];i.indexOf(n.model.dictAttributes.sfwRenderType)===-1&&t.EditPropertyValue(n.model.dictAttributes.sfwRenderType,n.model.dictAttributes,"sfwRenderType","None");t.EditPropertyValue(n.renderTypes,n,"renderTypes",i)}else n.model.dictAttributes.TextMode==="SingleLine"?t.EditPropertyValue(n.renderTypes,n,"renderTypes",["None","RichText","Rating","NumSpinner"]):n.model.dictAttributes.sfwRenderType!=="None"&&t.EditPropertyValue(n.model.dictAttributes.sfwRenderType,n.model.dictAttributes,"sfwRenderType","None")};n.onRenderTypeChange=function(i){t.UndRedoBulkOp("Start");switch(i){case"None":case"RichText":t.EditPropertyValue(n.model.dictAttributes.RatingFullStar,n.model.dictAttributes,"RatingFullStar","True");t.EditPropertyValue(n.model.dictAttributes.RatingNormalFill,n.model.dictAttributes,"RatingNormalFill","");t.EditPropertyValue(n.model.dictAttributes.RatingRatedFill,n.model.dictAttributes,"RatingRatedFill","");t.EditPropertyValue(n.model.dictAttributes.RatingStarWidth,n.model.dictAttributes,"RatingStarWidth","");t.EditPropertyValue(n.model.dictAttributes.sfwMinValue,n.model.dictAttributes,"sfwMinValue","");t.EditPropertyValue(n.model.dictAttributes.sfwMaxValue,n.model.dictAttributes,"sfwMaxValue","");break;case"Rating":t.EditPropertyValue(n.model.dictAttributes.sfwMinValue,n.model.dictAttributes,"sfwMinValue","");t.EditPropertyValue(n.model.dictAttributes.sfwMaxValue,n.model.dictAttributes,"sfwMaxValue","");break;case"NumSpinner":t.EditPropertyValue(n.model.dictAttributes.RatingFullStar,n.model.dictAttributes,"RatingFullStar","True");t.EditPropertyValue(n.model.dictAttributes.RatingNormalFill,n.model.dictAttributes,"RatingNormalFill","");t.EditPropertyValue(n.model.dictAttributes.RatingRatedFill,n.model.dictAttributes,"RatingRatedFill","");t.EditPropertyValue(n.model.dictAttributes.RatingStarWidth,n.model.dictAttributes,"RatingStarWidth","")}t.UndRedoBulkOp("End")}},templateUrl:"FormLink/views/ControlProperties/HtmlControlCommonProperties.html"}}]);