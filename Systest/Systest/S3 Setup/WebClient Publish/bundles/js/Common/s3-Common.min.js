function initializeHubreceivemethods(){hubMain.client.receiveProjectafterLoad=function(n,t,i,r){var u=getScopeByFileName("MainPage");u!=undefined&&u.receiveProjectafterLoad&&u.receiveProjectafterLoad(n,t,i,r)};hubMain.client.receiveFilePath=function(n,t){var i;t=="NewExcelMatrix"?(i=getScopeByFileName("MainPage"),i!=undefined&&i.receiveFilePath&&i.receiveFilePath(n)):t=="ProjectSettings"?(i=getScopeByFileName("SettingsPage"),i!=undefined&&i.receiveProjectSettingsFilePath&&i.receiveProjectSettingsFilePath(n)):t=="CreateNewObject"&&(i=getScopeByFileName("createNewObject"),i!=undefined&&i.receiveNewHtmlFilePath&&i.receiveNewHtmlFilePath(n))};hubMain.client.receiveSavedModel=function(n,t){var i=getScopeByFileName("PageLayout");i!=undefined&&i.receiveSavedModel&&i.receiveSavedModel(n,t)};hubMain.client.receivePendingSaveModel=function(n){var t=getScopeByFileName("PageLayout");t!=undefined&&t.receivePendingSaveModel&&t.receivePendingSaveModel(n)};hubMain.client.receiveUpdatedEntityModelandIntelleenselist=function(n,t,i){var r=getScopeByFileName(i);r!=undefined&&r.receiveUpdatedEntityModelandIntelleenselist&&r.receiveUpdatedEntityModelandIntelleenselist(n,t)};hubMain.client.receieveMovedRuleFile=function(n,t){var i=getScopeByFileName(t);i!=undefined&&i.receieveMovedRuleFile&&i.receieveMovedRuleFile(n)};hubMain.client.recieveRefreshNodeIds=function(n){var t=getCurrentFileScope();t!=undefined&&t.recieveRefreshNodeIds&&t.recieveRefreshNodeIds(n)};hubMain.client.receiveExceptionDetails=function(n){var t=getScopeByFileName("MainPage");t&&t.$root&&t.$root.showExceptionDetails&&t.$root.showExceptionDetails(n)};hubMain.client.receiveErrorMessage=function(n){var t=getScopeByFileName("MainPage");t!=undefined&&t.receiveErrorMessage&&t.receiveErrorMessage(n)};hubMain.client.receiveProjectLoadError=function(n){var t=getScopeByFileName("MainPage");t!=undefined&&t.receiveProjectLoadError&&t.receiveProjectLoadError(n)};hubMain.client.recieveItemListMappedWithEntity=function(n,t){var i=getCurrentFileScope();i&&i.recieveItemListMappedWithEntity&&i.recieveItemListMappedWithEntity(n,t)};$.connection.hubForm.client.receiveEntityTreeObject=function(n,t){var r=getScopeByFileName("MainPage"),u,i,n;r!=undefined&&(u=r.$root.currentopenfile.file.FileName,i=getScopeByFileName(u),i&&i.receiveEntityTreeObject&&(n=JSON.parse(n),i.receiveEntityTreeObject(n,t)))};$.connection.hubForm.client.receiveFormParameters=function(n,t){var r=getScopeByFileName("MainPage"),u,i,n;r!=undefined&&(u=r.$root.currentopenfile.file.FileName,i=getScopeByFileName(u),i!=undefined&&i.receiveFormParameters&&(n=JSON.parse(n),i.receiveFormParameters(n,t)))};$.connection.hubForm.client.receiveFormEntityModel=function(n){var i=getScopeByFileName("MainPage"),r,t,n;i!=undefined&&(r=i.$root.currentopenfile.file.FileName,t=getScopeByFileName(r),t!=undefined&&t.receiveFormEntityModel&&(n=JSON.parse(n),t.receiveFormEntityModel(n)))};$.connection.hubForm.client.receiveGridBaseQueryColumns=function(n){var t=getScopeByFileName("NewButtonWizard"),n;t!=undefined&&t.receiveGridBaseQueryColumns&&(n=JSON.parse(n),t.receiveGridBaseQueryColumns(n))};$.connection.hubForm.client.receivenewformmodel=function(n,t,i){var r,n;t?(r=getScopeByFileName("NewButtonWizard"),r!=undefined&&r.receivenewformmodel&&(n=JSON.parse(n),r.receivenewformmodel(n))):(r=angular.element(document.getElementById(i)).scope(),r&&r.receivenewformmodel?(n=JSON.parse(n),r.receivenewformmodel(n)):(r=getCurrentFileScope(),r&&r.receivenewformmodel&&(n=JSON.parse(n),r.receivenewformmodel(n))))};$.connection.hubForm.client.receiveRetrievalControlsColumns=function(n,t){var r=$("div[id="+t+"]"),i,n;r!=undefined&&(i=angular.element(r).scope(),i!=undefined&&i.receiveQueryColumns?(n=JSON.parse(n),i.receiveQueryColumns(n)):(i=getScopeByFileName(t),i!=undefined&&i.receiveQueryColumns&&(n=JSON.parse(n),i.receiveQueryColumns(n))))};$.connection.hubForm.client.receiveQueryColumns=function(n,t){var i=angular.element(document.getElementById(t)).scope(),n;i&&i.receiveQueryColumns?(n=JSON.parse(n),i.receiveQueryColumns(n)):(i=getScopeByFileName(t),i!=undefined&&i.receiveQueryColumns&&(n=JSON.parse(n),i.receiveQueryColumns(n)))};$.connection.hubRuleModel.client.receiveEntityBusinessObject=function(n){var t=getCurrentFileScope();t!=undefined&&t.receiveEntityBusinessObject&&t.receiveEntityBusinessObject(n)};$.connection.hubRuleModel.client.receiveRuleExpression=function(n,t,i,r){var u=getScopeByFileName(r);u!=undefined&&u.receiveRuleExpression&&u.receiveRuleExpression(n,t,i)};$.connection.hubBPMN&&($.connection.hubBPMN.client.receiveAssociatedFormData=function(n){var t=getCurrentFileScope();t&&t.receiveAssociatedFormData&&t.receiveAssociatedFormData(n)},$.connection.hubBPMN.client.receiveFormModel=function(n,t){var i=getCurrentFileScope();i&&i.receiveFormModel&&i.receiveFormModel(n,t)});$.connection.hubEntityModel.client.recievegetcodevalues=function(n){var t=getCurrentFileScope();t!=undefined&&t.recieveGetCodeValues&&t.recieveGetCodeValues(n)};$.connection.hubEntityModel.client.receiveQueryObjectTree=function(n){var t=getCurrentFileScope();t!=undefined&&t.receiveQueryObjectTree&&t.receiveQueryObjectTree(n)};$.connection.hubEntityModel.client.receiveObjectTree=function(n,t){var i=getCurrentFileScope();i!=undefined&&i.receiveObjectTree&&i.receiveObjectTree(n,t)};$.connection.hubEntityModel.client.receiveObjectTreeIntellisenseChildData=function(n,t){var i=getCurrentFileScope();i!=undefined&&i.receiveObjectTreeIntellisenseChildData&&i.receiveObjectTreeIntellisenseChildData(n,t)};$.connection.hubEntityModel.client.receivePartialFileData=function(n,t,i){var u=JSON.parse(n),f=JSON.parse(t),r=getCurrentFileScope();r&&r.receivePartialFileData&&r.receivePartialFileData(u,f,i)};$.connection.hubEntityModel.client.receiveValidateExpressionMsg=function(n,t){var i,r;t?(r=$("div[id="+t+"]"),i=angular.element(r).scope()):i=getCurrentFileScope();i&&i.receiveValidateExpressionMsg&&i.receiveValidateExpressionMsg(n)};$.connection.hubMain.client.receiveAllRuleFiles=function(n,t){var i=angular.element(document.getElementById(t)).scope(),n;i&&i.receiveAllRuleFiles&&(n=JSON.parse(n),i.receiveAllRuleFiles(n))};hubMain.client.receiveList=function(n,t){var i,n;i=t&&t.trim().length>0?angular.element(document.getElementById(t)).scope():getCurrentFileScope();i&&i.receiveList&&(n=JSON.parse(n),i.receiveList(n))};hubMain.client.setFileListTypewise=function(n,t){var i=getScopeByFileName("MainPage");i!=undefined&&i.setFileTypeWise&&i.setFileTypeWise(n,t)};hubMain.client.receieveExecuteQuery=function(n,t){var i,r;t!=""&&t!=undefined?(r=$("div[id=ScopeId_"+t+"]"),i=angular.element(r).scope()):i=getCurrentFileScope();i!=undefined&&i.receieveExecuteQuery&&i.receieveExecuteQuery(n)};hubMain.client.receiveErrorMessageQuery=function(n,t){var i,r;t!=""&&t!=undefined?(r=$("div[id=ScopeId_"+t+"]"),i=angular.element(r).scope()):i=getCurrentFileScope();i!=undefined&&i.receiveErrorMessageQuery&&i.receiveErrorMessageQuery(n)};$.connection.hubConstants.client.receieveConstantsAfterRefresh=function(n,t){var i=getCurrentFileScope();i&&i.receieveConstantsAfterRefresh&&i.receieveConstantsAfterRefresh(n,t)};$.connection.hubScenarioModel.client.receiveObjectTree=function(n,t){var i=angular.element(document.getElementById(t)).scope();i!=undefined&&i.receiveObjectTree&&i.receiveObjectTree(n)};$.connection.hubCreateNewObject.client.receiveFolderPathForFile=function(n,t){var i=getScopeByFileName("createNewObject");i!=undefined&&i.receiveFolderPathForFile&&i.receiveFolderPathForFile(n,t)};$.connection.hubCreateNewObject.client.receiveQueryColumnsForLookup=function(n){var t=getScopeByFileName("createNewObject");t!=undefined&&t.receiveQueryColumnsForLookup&&t.receiveQueryColumnsForLookup(n)};$.connection.hubCreateNewObject.client.receiveModelForForms=function(n,t){var i=getScopeByFileName("createNewObject");i!=undefined&&i.receiveModelForForms&&i.receiveModelForForms(n,t)};$.connection.hubCreateNewObject.client.receiveMapUnmapControls=function(n,t,i,r,u){var f=getCurrentFileScope();f&&f.receiveMapUnmapControls&&f.receiveMapUnmapControls(n,t,r,u)};$.connection.hubFormLink.client.receiveRefreshedModel=function(n){var t=getCurrentFileScope();t&&t.receiveRefreshedModel&&t.receiveRefreshedModel(n)};$.connection.hubFormLink.client.receiveRemovedControls=function(n,t){var i=getCurrentFileScope();i&&i.receiveRemovedControls&&i.receiveRemovedControls(n,t)};$.connection.hubFormLink.client.receiveControlMappingForDisplay=function(n){var t=getCurrentFileScope(),n;t&&t.receiveControlMappingForDisplay&&(n=JSON.parse(n),t.receiveControlMappingForDisplay(n))};$.connection.hubCorrespondence.client.receieveSyncronizeBookMarkData=function(n){var t=getCurrentFileScope();t&&t.receieveSyncronizeBookMarkData&&t.receieveSyncronizeBookMarkData(n)};$.connection.hubCorrespondence.client.receieveDummyCall=function(){var n=getCurrentFileScope();n&&n.receieveDummyCall&&n.receieveDummyCall()};hubMain.client.receiveentityxmlobject=function(n,t,i){var r=getScopeByFileName(i);r!=undefined&&r.receiveentityxmlobject&&r.receiveentityxmlobject(n,t)};hubMain.client.receiverulexml=function(n,t){var i=getCurrentFileScope();i!=undefined&&i.receiverulexml&&i.receiverulexml(n,t)};hubMain.client.receiverulexmlobject=function(n,t,i){var r=getCurrentFileScope();r!=undefined&&r.receiverulexmlobject&&r.receiverulexmlobject(n,t,i)};hubMain.client.receivesourcexml=function(n,t){var i=getCurrentFileScope();i!=undefined&&i.receivesourcexml&&i.receivesourcexml(n,t)};hubMain.client.receivedesignxmlobject=function(n,t){var i=getCurrentFileScope();i!=undefined&&i.receivedesignxmlobject&&i.receivedesignxmlobject(n,t)};hubMain.client.receiveformcorrdesignxmlobject=function(n,t,i){var r=getCurrentFileScope();r!=undefined&&r.receiveformcorrdesignxmlobject&&r.receiveformcorrdesignxmlobject(n,t,i)};hubMain.client.receivefiledesignxmlobject=function(n,t,i,r,u){var f=getCurrentFileScope();f!=undefined&&f.receivefiledesignxmlobject&&f.receivefiledesignxmlobject(n,t,i,r,u)};hubMain.client.receivescenariodesignxmlobject=function(n,t,i,r,u){var f=getCurrentFileScope();f!=undefined&&f.receivescenariodesignxmlobject&&f.receivescenariodesignxmlobject(n,t,i,r,u)};hubMain.client.receivexml=function(n,t){var i=getScopeByFileName(t);i!=undefined&&i.receivexml&&i.receivexml(n)};hubMain.client.receivexmlobject=function(n,t){var i=getScopeByFileName(t);i!=undefined&&i.receivexmlobject&&i.receivexmlobject(n)};hubMain.client.setFileFindAdvance=function(n,t){var i=getScopeByFileName("FindAdvanceFile");i!=undefined&&i.setFileFindAdvance&&i.setFileFindAdvance(n,t)};hubMain.client.receiveFormLinkXml=function(n,t,i){var r=getScopeByFileName(t);r!=undefined&&r.receiveFormLinkXml&&r.receiveFormLinkXml(n,i)};hubMain.client.receivebpmsourcexml=function(n,t){var i=getCurrentFileScope();i!=undefined&&i.receivebpmsourcexml&&i.receivebpmsourcexml(n,t)};hubMain.client.receivebpmdesignxmlstring=function(n,t){var i=getCurrentFileScope();i!=undefined&&i.receivebpmdesignxmlstring&&i.receivebpmdesignxmlstring(n,t)};hubMain.client.saveResourceException=function(n,t){var i,r;t!=""&&t!=undefined&&(r=$("div[id="+t+"]"),i=angular.element(r).scope());i&&i.receiveSaveResourceException&&i.receiveSaveResourceException(n)};hubMain.client.receieveHTMLFromModel=function(n){var t=getCurrentFileScope();t!=undefined&&t.receieveHTMLFromModel&&t.receieveHTMLFromModel(n)};hubMain.client.receiveFileStatus=function(n){var t=getScopeByFileName("ConvertToHtx");t!=undefined&&t.receiveFileStatus&&t.receiveFileStatus(n)};hubMain.client.logoutCurrentClient=function(){window.location.href="error_page.html?ERROR_CODE=102"};hubMain.client.verifyCurInstanceOperation=function(n){confirm("One instance of s3 is already running. Unsaved changed will be lost. Do you want to continue ?")?hubMain.server.reloadCurrentInstance(n).done(function(){}):window.location.href="error_page.html?ERROR_CODE=102"};hubMain.client.receiveAfterUpdateAllProjectLoadDetails=function(n){var t=getCurrentFileScope();t!=undefined&&t.receiveAfterUpdateAllProjectLoadDetails&&t.receiveAfterUpdateAllProjectLoadDetails(n)};hubMain.client.receiveExportvalidationReport=function(n){var t=getScopeByFileName("ValidationUtilityControl");t!=undefined&&t.receiveExportvalidationReport&&t.receiveExportvalidationReport(n)}}function extendExceptionHandler(){return function(n,t){var i=angular.element(document.body).injector().get("$rootScope");i&&(i.IsLoading=!1,i.IsProjectLoaded=!1);$(".page-header-fixed").css("pointer-events","auto");console.log(String.format("Exception:{0}\nCause:{1}\nStacktrace:{2}",n,t,n.stack))}}function getCurrentFileScope(){if(element=$('body[ng-controller="MainController"]'),element){if(rootScope=angular.element(element).scope().$root,rootScope.isConfigureSettingsVisible)return getScopeByFileName("SettingsPage");if(rootScope&&rootScope.currentopenfile&&rootScope.currentopenfile.file)return getScopeByFileName(rootScope.currentopenfile.file.FileName)}}function getScopeByFileName(n){var t,i;return t=n=="MainPage"?$('body[ng-controller="MainController"]'):n=="StartPage"?$('div[ng-controller="StartController"]'):n=="SettingsPage"?$('div[ng-controller="configureSettingsController"]'):n=="PageLayout"?$('div[ng-controller="PageLayoutController"]'):n=="ParameterNavigation"?$('div[ng-controller="NavigationParameterController"]'):n=="ImageCondition"?$('div[ng-controller="ImageConditionController"]'):n=="createNewObject"?$('div[ng-controller="createNewObjectController"]'):n=="NewButtonWizard"?$('div[ng-controller="NewButtonWizardController"]'):n=="ExecuteQuery"?$('div[ng-controller="executequerycontroller"]'):n=="CustomSettings"?$('div[ng-controller="customSettingsController"]'):n=="Form"?$('div[ng-controller="FormController"]'):n=="SearchFiles"?$('div[ng-controller="SearchFilesController"]'):n=="AutoCompleteColumnsController"?$('div[ng-controller="AutoCompleteColumnsController"]'):n=="NavigationParameterController"?$('div[ng-controller="NavigationParameterController"]'):n=="RetrievalControlsController"?$('div[ng-controller="RetrievalControlsController"]'):n=="EntityValidationRulesController"?$('div[ng-controller="EntityValidationRulesController"]'):n=="ConvertToHtx"?$('div[ng-controller="ConvertToHtxController"]'):n=="ValidationUtilityControl"?$('div[ng-controller="ValidationUtilityControl"]'):$("div[id='"+n+"']").find("div[ng-controller]"),t&&(i=angular.element(t).scope()),i}function GetVM(n,t){for(var i=t;i;){if(i.Name==n)return i;i=i.ParentVM}}function startsWith(n,t,i){return n.indexOf(t,i)===i}function endsWith(n,t){if(n)return n.indexOf(t,n.length-t.length)!==-1}function setSingleLevelAutoComplete(n,t,i,r,u,f){window.event&&(window.event.keyCode===38||window.event.keyCode===40)||t&&(t=t.sort(function(n,t){var i,f;if(n&&t&&(typeof u!="undefined"&&n.hasOwnProperty(u)&&n[u]?i=n[u].toLowerCase():typeof r!="undefined"&&n.hasOwnProperty(r)&&n[r]?i=n[r].toLowerCase():typeof r!="undefined"&&n.dictAttributes&&n.dictAttributes.hasOwnProperty(r)&&n.dictAttributes[r]?i=n.dictAttributes[r].toLowerCase():n.hasOwnProperty("ID")&&n.ID?i=n.ID.toLowerCase():n&&n.toLowerCase&&(i=n.toLowerCase()),typeof u!="undefined"&&t.hasOwnProperty(u)&&t[u]?f=t[u].toLowerCase():typeof r!="undefined"&&t.hasOwnProperty(r)&&t[r]?f=t[r].toLowerCase():typeof r!="undefined"&&t.dictAttributes&&t.dictAttributes.hasOwnProperty(r)&&t.dictAttributes[r]?f=t.dictAttributes[r].toLowerCase():t.hasOwnProperty("ID")&&t.ID?f=t.ID.toLowerCase():t&&t.toLowerCase&&(f=t.toLowerCase()),i&&f)){if(i<f)return-1;if(i>f)return 1}return 0}),n.autocomplete({minLength:0,appendTo:"#dvIntellisense",open:function(t){var e,u,i,o,s,h,f,r;n[0].localName=="span"?(e=n[0].ownerDocument||n[0].document,u=e.defaultView||e.parentWindow,u&&typeof u.getSelection!="undefined"&&(o=u.getSelection(),o.rangeCount>0&&(s=u.getSelection().getRangeAt(0),i=s.getBoundingClientRect())),r=i&&(i.left!=0||i.top!=0)?{left:i.left+"px",top:i.top+i.height+"px",width:"auto",height:"auto",overflow:"auto",maxWidth:"300px",maxHeight:"300px","z-index":"999999999"}:{width:"auto",height:"auto",overflow:"auto",maxWidth:"300px",maxHeight:"300px","z-index":"999999999"},$("#dvIntellisense > ul").css(r),setIntellisensePosition(t)):(n[0].localName=="textarea"||n[0].localName=="input"&&n.attr("type")=="text")&&(r={width:"auto",height:"auto",overflow:"auto",maxWidth:"300px",maxHeight:"300px","z-index":"999999999"},(n[0].localName=="textarea"||n[0].localName=="input"&&n.attr("type"))&&(h=n.textareaHelper("caretPosAbs"),r.left=h.left+"px"),$("#dvIntellisense > ul").css(r));$(n).data("ui-autocomplete")&&($(n).data("ui-autocomplete")&&(f=$(n).autocomplete("widget"),windowWidth=$(window).width(),height=f.height(),inputHeight=$(n).height(),windowsHeight=$(window).height(),windowsHeight<f.position().top+height+inputHeight&&(newTop=f.position().top-height-inputHeight-10,f.css("top",newTop+"px"))),r={width:"auto",height:"auto",overflow:"auto",maxWidth:"300px",maxHeight:"300px","z-index":"999999999"},$("#dvIntellisense > ul").css(r),$(".page-header-fixed").css("pointer-events","none"),$("#dvIntellisense").css("pointer-events","auto"))},focus:function(n,t){return $(".ui-autocomplete > li").attr("title",t.item.label),!1},source:function(n,i){var f=$.ui.autocomplete.filter($.map(t,function(n){var t="",t="";if(n)return(n.Type&&n.Type=="Method"?t="<img style='margin-right:6px' src='images/Home/small_filetype/method.png'/>":n.Type&&n.Type=="Rule"?n.RuleType&&n.RuleType=="LogicalRule"?t="<img style='margin-right:6px' src='images/Home/small_filetype/logical_rule.png'/>":n.RuleType&&n.RuleType=="DecisionTable"?t="<img style='margin-right:6px' src='images/Home/small_filetype/decision_table..png'/>":n.RuleType&&n.RuleType=="ExcelMatrix"&&(t="<img style='margin-right:6px' src='images/Home/small_filetype/Excel_matrix.png'/>"):n.Type&&n.Type=="Property"?n.DataType&&n.DataType.toLowerCase()=="int"?t="<img style='margin-right:6px' src='images/Form/icon-integer.png'/>":n.DataType&&n.DataType.toLowerCase()=="bool"?t="<img style='margin-right:6px' src='images/Form/icon-boolean.png'/>":n.DataType&&(n.DataType.toLowerCase()=="collection"||n.DataType.toLowerCase()=="cdocollection"||n.DataType.toLowerCase()=="list")?t="<img style='margin-right:6px' src='images/Form/icon-collection.png'/>":n.DataType&&n.DataType.toLowerCase()=="datetime"?t="<img style='margin-right:6px' src='images/Form/icon-datetime.png'/>":n.DataType&&n.DataType.toLowerCase()=="decimal"?t="<img style='margin-right:6px' src='images/Form/icon-decimal.png'/>":n.DataType&&n.DataType.toLowerCase()=="double"?t="<img style='margin-right:6px' src='images/Form/icon-double.png'/>":n.DataType&&n.DataType.toLowerCase()=="float"?t="<img style='margin-right:6px' src='images/Form/icon-float.png'/>":n.DataType&&n.DataType.toLowerCase()=="string"?t="<img style='margin-right:6px' src='images/Form/icon-string.png'/>":n.DataType&&n.DataType.toLowerCase()=="object"&&(t="<img style='margin-right:6px' src='images/Form/icon-object.png'/>"):n.Type&&n.Type=="Column"?n.DataType&&n.DataType.toLowerCase()=="int"?t="<img style='margin-right:6px' src='images/Form/icon-integer.png'/>":n.DataType&&n.DataType.toLowerCase()=="bool"?t="<img style='margin-right:6px' src='images/Form/icon-boolean.png'/>":n.DataType&&(n.DataType.toLowerCase()=="collection"||n.DataType.toLowerCase()=="cdocollection"||n.DataType.toLowerCase()=="list")?t="<img style='margin-right:6px' src='images/Form/icon-collection.png'/>":n.DataType&&n.DataType.toLowerCase()=="datetime"?t="<img style='margin-right:6px' src='images/Form/icon-datetime.png'/>":n.DataType&&n.DataType.toLowerCase()=="decimal"?t="<img style='margin-right:6px' src='images/Form/icon-decimal.png'/>":n.DataType&&n.DataType.toLowerCase()=="double"?t="<img style='margin-right:6px' src='images/Form/icon-double.png'/>":n.DataType&&n.DataType.toLowerCase()=="float"?t="<img style='margin-right:6px' src='images/Form/icon-float.png'/>":n.DataType&&n.DataType.toLowerCase()=="string"?t="<img style='margin-right:6px' src='images/Form/icon-string.png'/>":n.DataType&&n.DataType.toLowerCase()=="object"&&(t="<img style='margin-right:6px' src='images/Form/icon-object.png'/>"):n.Type&&n.Type=="Collection"?t="<img style='margin-right:6px' src='images/Form/icon-collection.png'/>":n.Type&&n.Type=="Object"&&(t="<img style='margin-right:6px' src='images/Form/icon-object.png'/>"),typeof u!="undefined"&&n.hasOwnProperty(u))?{label:n[u],value:n,logo:t}:typeof r!="undefined"&&n.hasOwnProperty(r)?{label:n[r],value:n,logo:t}:typeof r!="undefined"&&n.dictAttributes&&n.dictAttributes.hasOwnProperty(r)?{label:n.dictAttributes[r],value:n,logo:t}:n&&typeof n.ID=="undefined"?{label:n,value:n,logo:t}:n?{label:n.ID,value:n.ID,logo:t}:void 0}),n.term);i(f.slice(0,50))},select:function(t,i){var o=this,u="",e;return t.target.localName=="span"?(u=typeof r!="undefined"&&i.item.value[r]?i.item.value[r]:typeof r!="undefined"&&i.item.value.dictAttributes&&i.item.value.dictAttributes.hasOwnProperty(r)?i.item.value.dictAttributes[r]:i.item.value.ID?i.item.value.ID:i.item.value,this.innerText=u,e=angular.element($(this)).scope(),e&&e.$broadcast("UpdateOnClick",n[0])):(u=typeof r!="undefined"&&i.item.value.hasOwnProperty(r)?i.item.value[r]:typeof r!="undefined"&&i.item.value.dictAttributes&&i.item.value.dictAttributes.hasOwnProperty(r)?i.item.value.dictAttributes[r]:i.item.value.ID?i.item.value.ID:i.item.value,o.value=u),$(this).trigger("change"),f&&typeof f=="function"&&f({obj:i.item.value}),!1},close:function(){$(".page-header-fixed").css("pointer-events","auto")}}))}function setSingleLevelAutoCompleteForCodeValues(n,t,i,r,u,f,e){t&&t.length>0&&(t=t.sort(function(n,t){var i,f;if(typeof u!="undefined"&&n.hasOwnProperty(u)?i=n[u].toLowerCase():typeof r!="undefined"&&n.hasOwnProperty(r)?i=n[r].toLowerCase():typeof r!="undefined"&&n.dictAttributes&&n.dictAttributes.hasOwnProperty(r)?i=n.dictAttributes[r].toLowerCase():n.hasOwnProperty("ID")?i=n.ID.toLowerCase():n.toLowerCase&&(i=n.toLowerCase()),typeof u!="undefined"&&t.hasOwnProperty(u)?f=t[u].toLowerCase():typeof r!="undefined"&&t.hasOwnProperty(r)?f=t[r].toLowerCase():typeof r!="undefined"&&t.dictAttributes&&t.dictAttributes.hasOwnProperty(r)?f=t.dictAttributes[r].toLowerCase():t.hasOwnProperty("ID")?f=t.ID.toLowerCase():t.toLowerCase&&(f=t.toLowerCase()),i&&f){if(i<f)return-1;if(i>f)return 1}return 0}),n.autocomplete({minLength:0,appendTo:"#dvIntellisense",open:function(t){var i,r;(n[0].localName=="textarea"||n[0].localName=="input"&&n.attr("type")=="text")&&(i={width:"auto",height:"auto",overflow:"auto",maxWidth:"300px",maxHeight:"300px","z-index":"999999999"},(n[0].localName=="textarea"||n[0].localName=="input"&&n.attr("type"))&&(r=n.textareaHelper("caretPosAbs"),i.left=r.left+"px",i.top=r.top+"px"),$("#dvIntellisense > ul").css(i));setIntellisensePosition(t)},source:function(n,i){i($.ui.autocomplete.filter($.map(t,function(n){return typeof u!="undefined"&&n.hasOwnProperty(u)?{label:n[u],value:n}:typeof r!="undefined"&&n.hasOwnProperty(r)?{label:n[r],value:n}:typeof r!="undefined"&&n.dictAttributes&&n.dictAttributes.hasOwnProperty(r)?{label:n.dictAttributes[r],value:n}:typeof n.ID=="undefined"?{label:n,value:n}:{label:n.ID,value:n.ID}}),extractLast(n.term,this.element[0].selectionStart)))},focus:function(n,t){return $(".ui-autocomplete > li").attr("title",t.item.label),!1},select:function(n,t){var i=this;return typeof r!="undefined"&&t.item.value[r]?(this.value=t.item.value[r],e=="role"?f.dictAttributes.role=t.item.value.CodeID:e=="skill"?f.dictAttributes.skill=t.item.value.CodeID:e=="location"?f.dictAttributes.location=t.item.value.CodeID:e=="position"?f.dictAttributes.position=t.item.value.CodeID:e=="authoritylevel"?f.dictAttributes.authorityLevel=t.item.value.CodeID:e=="user"&&(f.dictAttributes.user=t.item.value.CodeID)):typeof r!="undefined"&&t.item.value.dictAttributes&&t.item.value.dictAttributes.hasOwnProperty(r)?this.value=t.item.value.dictAttributes[r]:i.value=t.item.value.ID?t.item.value.ID:t.item.value,$(this).trigger("change"),!1}}))}function containsMathOpe(n){return n.contains("+")||n.contains("-")||n.contains("*")||n.contains("/")||n.contains(" ")||n.contains(">")||n.contains("<")||n.contains("%")||n.contains("==")||n.contains("!")||n.contains("=")||n.contains("(")?!0:!1}function isMathope(n){return n=="+"||n=="-"||n=="*"||n=="/"||n==" "||n=="\n"||n==">"||n=="<"||n=="%"||n=="="||n=='"'||n=="("||n==")"||n==","||n=="?"||n==":"?!0:!1}function getSplitArray(n,t){for(var f=[],r=n.split(""),u=[],i=t-1;i>=0;i--){if(r[i]!='"'&&isMathope(r[i]))break;u.push(r[i])}return u.length>0&&(n=u.reverse().join(""),f=n.split(".")),f}function split(n){return n.split(".")}function extractLast(n,t){var i=getSplitArray(n,t);return i.length>0?i.pop():""}function caretPosition(n){var e=0,i=n.ownerDocument||n.document,o=i.defaultView||i.parentWindow,t,r,u,s,f;return typeof o.getSelection!="undefined"?(t=o.getSelection(),t.rangeCount>0&&(r=o.getSelection().getRangeAt(0),u=r.cloneRange(),u.selectNodeContents(n),u.setEnd(r.endContainer,r.endOffset),e=u.toString().length)):(t=i.selection)&&t.type!="Control"&&(s=t.createRange(),f=i.body.createTextRange(),f.moveToElementText(n),f.setEndPoint("EndToEnd",s),e=f.text.length),e}function setMultilevelAutoCompleteForObjectTreeIntellisense(n,t,i,r,u){window.event&&(window.event.keyCode===38||window.event.keyCode===40)||(t&&t.length>0?(t=t.sort(function(n,t){var r,u;if(n.hasOwnProperty(i)?r=n[i]&&n[i].toLowerCase?n[i].toLowerCase():n[i]:n.hasOwnProperty("ID")?r=n.ID&&n.ID.toLowerCase?n.ID.toLowerCase():n.ID:n&&n.toLowerCase&&(r=n.toLowerCase()),t.hasOwnProperty(i)?u=t[i]&&t[i].toLowerCase?t[i].toLowerCase():t[i]:t.hasOwnProperty("ID")?u=t.ID&&t.ID.toLowerCase?t.ID.toLowerCase():t.ID:t&&t.toLowerCase&&(u=t.toLowerCase()),r&&u){if(r<u)return-1;if(r>u)return 1}return 0}),n.autocomplete({minLength:0,appendTo:"#dvIntellisense",open:function(t){var i,r,u,f;(n[0].localName=="textarea"||n[0].localName=="input"&&n.attr("type")=="text")&&(i={width:"200px",height:"auto",overflow:"auto",maxHeight:"300px","z-index":"999999999"},n[0].localName=="textarea"?(r=n.textareaHelper("caretPosAbs"),u=$(window).width(),r.left+220>u?(f=r.left+220-u,i.left=r.left-f+"px"):i.left=r.left+"px",i.top=r.top+"px",$("#dvIntellisense > ul").css(i)):($("#dvIntellisense > ul").css(i),setIntellisensePosition(t)));$(n).data("ui-autocomplete")&&($(".page-header-fixed").css("pointer-events","none"),$("#dvIntellisense").css("pointer-events","auto"))},source:function(n,r){t&&t.length>0&&r($.ui.autocomplete.filter($.map(t,function(n){var t="";return n.Type&&n.Type=="Method"?t="<img style='margin-right:6px' src='images/Home/small_filetype/method.png'/>":n.Type&&n.Type=="Rule"?n.RuleType&&n.RuleType=="LogicalRule"?t="<img style='margin-right:6px' src='images/Home/small_filetype/logical_rule.png'/>":n.RuleType&&n.RuleType=="DecisionTable"?t="<img style='margin-right:6px' src='images/Home/small_filetype/decision_table..png'/>":n.RuleType&&n.RuleType=="ExcelMatrix"&&(t="<img style='margin-right:6px' src='images/Home/small_filetype/Excel_matrix.png'/>"):n.Type&&n.Type=="Property"?n.DataType&&n.DataType.toLowerCase()=="int"?t="<img style='margin-right:6px' src='images/Form/icon-integer.png'/>":n.DataType&&n.DataType.toLowerCase()=="bool"?t="<img style='margin-right:6px' src='images/Form/icon-boolean.png'/>":n.DataType&&(n.DataType.toLowerCase()=="collection"||n.DataType.toLowerCase()=="cdocollection"||n.DataType.toLowerCase()=="list")?t="<img style='margin-right:6px' src='images/Form/icon-collection.png'/>":n.DataType&&n.DataType.toLowerCase()=="datetime"?t="<img style='margin-right:6px' src='images/Form/icon-datetime.png'/>":n.DataType&&n.DataType.toLowerCase()=="decimal"?t="<img style='margin-right:6px' src='images/Form/icon-decimal.png'/>":n.DataType&&n.DataType.toLowerCase()=="double"?t="<img style='margin-right:6px' src='images/Form/icon-double.png'/>":n.DataType&&n.DataType.toLowerCase()=="float"?t="<img style='margin-right:6px' src='images/Form/icon-float.png'/>":n.DataType&&n.DataType.toLowerCase()=="string"?t="<img style='margin-right:6px' src='images/Form/icon-string.png'/>":n.DataType&&n.DataType.toLowerCase()=="object"&&(t="<img style='margin-right:6px' src='images/Form/icon-object.png'/>"):n.Type&&n.Type=="Column"?n.DataType&&n.DataType.toLowerCase()=="int"?t="<img style='margin-right:6px' src='images/Form/icon-integer.png'/>":n.DataType&&n.DataType.toLowerCase()=="bool"?t="<img style='margin-right:6px' src='images/Form/icon-boolean.png'/>":n.DataType&&(n.DataType.toLowerCase()=="collection"||n.DataType.toLowerCase()=="cdocollection"||n.DataType.toLowerCase()=="list")?t="<img style='margin-right:6px' src='images/Form/icon-collection.png'/>":n.DataType&&n.DataType.toLowerCase()=="datetime"?t="<img style='margin-right:6px' src='images/Form/icon-datetime.png'/>":n.DataType&&n.DataType.toLowerCase()=="decimal"?t="<img style='margin-right:6px' src='images/Form/icon-decimal.png'/>":n.DataType&&n.DataType.toLowerCase()=="double"?t="<img style='margin-right:6px' src='images/Form/icon-double.png'/>":n.DataType&&n.DataType.toLowerCase()=="float"?t="<img style='margin-right:6px' src='images/Form/icon-float.png'/>":n.DataType&&n.DataType.toLowerCase()=="string"?t="<img style='margin-right:6px' src='images/Form/icon-string.png'/>":n.DataType&&n.DataType.toLowerCase()=="object"&&(t="<img style='margin-right:6px' src='images/Form/icon-object.png'/>"):n.Type&&n.Type=="Collection"?t="<img style='margin-right:6px' src='images/Form/icon-collection.png'/>":n.Type&&n.Type=="Object"&&(t="<img style='margin-right:6px' src='images/Form/icon-object.png'/>"),n.hasOwnProperty(i)&&n[i]?{label:n[i],value:n,logo:t}:n.hasOwnProperty("ID")&&n.ID?{label:n.ID,value:n,logo:t}:{label:n,value:n,logo:t}}),extractLast(n.term,this.element[0].selectionStart)))},focus:function(n,t){var i,r;if(t.item&&t.item.value&&"Description"in t.item.value&&t.item.value.Description)$(".ui-autocomplete > li").attr("title",t.item.value.Description);else if(t.item&&t.item.value&&"Tooltip"in t.item.value&&t.item.value.Tooltip)$(".ui-autocomplete > li").attr("title",t.item.value.Tooltip);else{if(i=t.item.label,t.item.value&&t.item.value.Parameters&&t.item.value.Parameters.length>0){for(i+="(",r=0;r<t.item.value.Parameters.length;r++)i+=t.item.value.Parameters[r].ID,t.item.value.Parameters.length>1&&(i+=",");i.lastIndexOf(",")>-1&&(i=i.replace(/,\s*$/,""));i+=")"}$(".ui-autocomplete > li").attr("title",i)}return!1},select:function(n,t){var o=getSplitArray(this.value,this.selectionStart),f=this.selectionStart,h=0,e,r,s;return o.length>0&&(h=o[o.length-1].length),this.value==""&&(f=0),e=0,t.item.value[i]?(this.value=f==0?t.item.value[i]:[this.value.slice(0,f-h),t.item.value[i],this.value.slice(f)].join(""),e=t.item.value[i].length):t.item.value.ID?(this.value=f==0?t.item.value.ID:[this.value.slice(0,f-h),t.item.value.ID,this.value.slice(f)].join(""),e=t.item.value.ID.length):(this.value=this.value+t.item.value,e=t.item.value.length),this.value=this.value.trim(),r=t.item.value,(r.DataType=="TableObjectType"||r.DataType=="CollctionType"||r.DataType=="BusObjectType"||r.DataType=="OtherReferenceType")&&(r.HasLoadedProp&&r.HasLoadedProp!=undefined||(s=o.join("."),s.indexOf("this.")==0&&(s=s.substring(5)),$.connection.hubEntityModel.server.loadObjectTree(r.ItemType.Name,r.FullPath,!0).done(function(n){u.receiveObjectTree(n,r.FullPath)}))),u&&u.selectedobject!=undefined&&(u.selectedobject=r),$(this).trigger("change"),this.selectionEnd&&(this.selectionEnd=f+e),!1},close:function(){n[0].focus();$(".page-header-fixed").css("pointer-events","auto")}})):$(n).data("ui-autocomplete")&&($(n).autocomplete("destroy"),$(".page-header-fixed").css("pointer-events","auto")))}function generateUUID(){var n;return $.ajax({url:"api/Login/GetGUID",type:"GET",async:!1,dataType:"json",data:{},success:function(t){n=t},error:function(n){var t=JSON.parse(n.responseText),i;t&&t.Message?(i=t.Message,t.ExceptionMessage&&(i=i+"\n"+t.ExceptionMessage),MessageBox("Message",i)):MessageBox("Message","An error occured while creating a new GUID.")}}),n}function onBodyClick(){}function GetFormattedTableName(n){var t,i;return(n.length>4&&n.toLowerCase().match("^sg")&&n.substring(4,3)=="_"&&(n=n.substring(4)),t="",n==undefined||n=="")?n:(i=n.split("_"),angular.forEach(i,function(n){n==undefined||n==""?t+=n:(t+=n.substring(0,1).toUpperCase(),t+=n.substring(1,n.length).toLowerCase())}),t)}function onDragOverCommon(n){n.preventDefault&&n.preventDefault();n.dataTransfer.dropEffect="move"}function isValidIdentifier(n,t,i,r){var f,e,u;return n?n.trim()==""?!1:!i&&globalKeywords&&globalKeywords.length>0&&globalKeywords.indexOf(n.toLowerCase())>-1?!1:(f=t?new RegExp("^[_a-zA-Z][_a-zA-Z]*$"):r?new RegExp("^[-_a-zA-Z][-_a-zA-Z0-9]+$"):new RegExp("^[_a-zA-Z][_a-zA-Z0-9]*$"),e=t?new RegExp("^[a-zA-Z]*$"):r?new RegExp("^[-a-zA-Z0-9]*$"):new RegExp("^[a-zA-Z0-9]*$"),f.test(n)?(u=n.replace(/_/g,""),u.trim()!=""&&e.test(u)?!0:!1):!1):!1}function isValidFileID(n,t){if(!n||n.trim()=="")return!1;var i=new RegExp("^[a-zA-Z][a-zA-Z0-9-]*$");return t&&(i=new RegExp("^[a-zA-Z][a-zA-Z]*$")),i.test(n)?!0:!1}function getWebApplicationName(){var n=window.location.pathname.substring(1),t=n.indexOf("/");return t>-1&&(n=n.substring(0,t)),n}function getDescendents(n,t){var f=[],i,u,r;if(n.Children!=undefined&&n.Children.length>0)for(i=0;i<n.Children.length;i++)for(t&&n.Children[i].Name!==t||f.push(n.Children[i]),u=getDescendents(n.Children[i]),r=0;r<u.length;r++)t&&u[r].Name!==t||f.push(u[r]);if(n.Elements!=undefined&&n.Elements.length>0)for(i=0;i<n.Elements.length;i++)for(t&&n.Elements[i].Name!==t||f.push(n.Elements[i]),u=getDescendents(n.Elements[i]),r=0;r<u.length;r++)t&&u[r].Name!==t||f.push(u[r]);return f}function GetNewStepName(n,t,i){for(var r=String.format("{0}{1}",n,"("+i.toString()+")");CheckForDuplicateID(r,t);)i++,r=String.format("{0}{1}",n,"("+i.toString()+")");return r}function CheckForDuplicateID(n,t){var i=!1;return t&&(i=t.dictAttributes.ID==n,i||angular.forEach(t.Elements,function(t){!i&&(i=CheckForDuplicateID(n,t),i)})),i}function GetNewQueryName(n,t,i){for(var r=String.format("{0}{1}",n,i.toString());CheckForDuplicateID(r,t);)i++,r=String.format("{0}{1}",n,i.toString());return r}function CheckInitialLoadQueryDuplicateID(n,t){var i=!1;return t&&(t.dictAttributes&&t.dictAttributes.ID&&(i=t.dictAttributes.ID==n),!i&&t&&t.length>0&&angular.forEach(t,function(t){!i&&(i=CheckInitialLoadQueryDuplicateID(n,t),i)})),i}function GetInitialLoadQueryID(n,t,i){for(var r=String.format("{0}{1}",n,i.toString());CheckInitialLoadQueryDuplicateID(r,t);)i++,r=String.format("{0}{1}",n,i.toString());return r}function getHtmlFromServer(n){var t,i=[window.location.protocol,"//",window.location.host,"/",getWebApplicationName(),"/",n].join(""),r=function(n){t=n},u=function(){console.log(String.format("Invalid Url: {0}",i))};return $.ajax({url:i,type:"GET",async:!1,success:r,error:u}),t}function ValidateDate(n){var t=new RegExp(/\b\d{1,2}[\/-]\d{1,2}[\/-]\d{4}\b/);return t.test(n)}function getEntityObject(n,t,i){var u,r=n.filter(function(n){return n.ID==t});return r&&r.length>0&&(u={ID:r[0].ID,TableName:r[0].TableName,BusinessObjectName:r[0].BusinessObjectName,Attributes:[],IsExpanded:i,XmlMethods:[]},r[0].Attributes&&r[0].Attributes.length>0&&i&&createEntityAttributeList(r[0].Attributes,u)),u}function createEntityAttributeList(n,t){n.sort(sort_by("ID",!1,function(n){return n.toUpperCase()}));angular.forEach(n,function(i){function f(n){var t=i.Value.replace("_id","_value");n.Value==t&&(u=!0)}var u,r;endsWith(i.Value,"_id")?(u=!1,angular.forEach(n,f),u||(r={ID:i.ID,Value:i.Value,DataType:i.DataType,Entity:i.Entity,Type:i.Type,Attributes:[],XmlMethods:[],objParent:t},t.Attributes.push(r))):(r={ID:i.ID,Value:i.Value,DataType:i.DataType,Entity:i.Entity,Type:i.Type,Attributes:[],XmlMethods:[],objParent:t},t.Attributes.push(r))})}function sort_by(n,t,i){var r=i?function(t){return i(t[n])}:function(t){return t[n]};return t=t?-1:1,function(n,i){return n=r(n),i=r(i),t*((n>i)-(i>n))}}function createEntityXmlMethodItemList(n,t){angular.forEach(n,function(n){var i={ID:n.ID,ItemType:n.ItemType,LoadType:n.LoadType,LoadSource:n.LoadSource,SfwParameters:n.SfwParameters,objParent:t};t.Items.push(i)})}function getIntellisenseRecord(n,t,i){var u,r;if(t){if(data=t,data=data.sort(),u=[],i!="ActiveForm"&&i!="VisibleRule"&&i!="FileIntellisense")for(r=0;r<data.length;r++)data[r][i].toLowerCase().indexOf(n.toLowerCase())>-1&&u.push(data[r]);else u=data;if(lstTop100Msgs=[],u.length>100)for(r=0;r<=99;r++)lstTop100Msgs.push(u[r]);else lstTop100Msgs=u}return lstTop100Msgs}function SetParentForObjTreeChild(n){function t(t){t.objParent=n;t.FullPath=GetFullItemPathFromBusObjectTree(t);t.ChildProperties&&t.ChildProperties.length>0&&SetParentForObjTreeChild(t)}n&&(angular.forEach(n.ChildProperties,t),angular.forEach(n.lstMethods,t))}function stopPropogation(n){n.stopPropagation()}function GetBaseModel(n){var t,i;if(n){t={prefix:n.prefix,Name:n.Name,Value:n.Value,dictAttributes:{},Elements:[],Children:[],IsValueInCDATAFormat:n.IsValueInCDATAFormat};for(i in n.dictAttributes)n.dictAttributes.hasOwnProperty(i)&&(t.dictAttributes[i]=n.dictAttributes[i]);angular.forEach(n.Elements,function(n){var i,u,r,f,e;if(n.Name&&n.Name==="sfwGridView"&&n.prototypemodel){if(i=GetPrototypeDataModel(n.prototypemodel),u=!1,n.Elements.length>1)for(r=0;r<n.Elements.length;r++)if(n.Elements[r].Name=="Data"){u=!0;n.Elements[r].Elements=i;break}!u&&i&&i.length>0&&(f={dictAttributes:{},Elements:[],Name:"Data",Value:"",prefix:""},f.Elements=i,n.Elements.push(f))}e=GetBaseModel(n);t.Elements.push(e)});angular.forEach(n.Children,function(n){var i=GetBaseModel(n);t.Children.push(i)})}return t}function GetPrototypeDataModel(n){if(n){var t=[];return angular.forEach(n.Elements,function(n){if(n.Elements){var i={dictAttributes:{},Elements:[],Name:"DataRow",Value:"",prefix:""};angular.forEach(n.Elements,function(n){n.Elements&&angular.forEach(n.Elements,function(n){i.Elements.push(n)})});t.push(i)}}),t}}function getPropertyValue(n,t){if(t){if(t.contains("."))while(t.contains(".")){var i=t.substring(0,t.indexOf("."));t=t.substring(t.indexOf(".")+1);n&&n.hasOwnProperty(i)&&(n=n[i])}if(n&&n.hasOwnProperty(t))return n[t]}return""}function setPropertyValue(n,t,i){if(t&&n){if(t.contains("."))while(t.contains(".")){var r=t.substring(0,t.indexOf("."));t=t.substring(t.indexOf(".")+1);n.hasOwnProperty(r)&&n[r]!==null&&typeof n[r]=="object"&&(n=n[r])}n[t]=i}}function selectBuildResultErrors(){$("#main-wrapper").addClass("splitter_panel");$("#main-wrapper").addClass("spliter");var n=$(".spliter").width("100%").height("calc(100% - 80px)").split({orientation:"horizontal",limit:20});$('div[id="divbottompanel"]').show();n&&n.refresh&&n.refresh();$('div[class="footer-slide-up"][id="dvBuildResults"] #errorList').show();$('div[class="footer-slide-up"][id="dvBuildResults"] #warningList').hide();$('div[class="footer-slide-up"][id="dvBuildResults"] #messageList').hide();$('div[class="footer-slide-up"][id="dvBuildResults"]').find("#btnError").addClass("selected");$('div[class="footer-slide-up"][id="dvBuildResults"]').find("#btnWarning").removeClass("selected");$('div[class="footer-slide-up"][id="dvBuildResults"]').find("#btnMessage").removeClass("selected")}function selectBuildResultWarnings(){$('div[id="divbottompanel"]').show();$("#main-wrapper").addClass("splitter_panel");$("#main-wrapper").addClass("spliter");$(".spliter").width("100%").height("calc(100% - 80px)").split({orientation:"horizontal",limit:20});$('div[class="footer-slide-up"][id="dvBuildResults"] #errorList').hide();$('div[class="footer-slide-up"][id="dvBuildResults"] #warningList').show();$('div[class="footer-slide-up"][id="dvBuildResults"] #messageList').hide();$('div[class="footer-slide-up"][id="dvBuildResults"]').find("#btnError").removeClass("selected");$('div[class="footer-slide-up"][id="dvBuildResults"]').find("#btnWarning").addClass("selected");$('div[class="footer-slide-up"][id="dvBuildResults"]').find("#btnMessage").removeClass("selected");showFooter()}function selectBuildResultMessages(){$('div[id="divbottompanel"]').show();$("#main-wrapper").addClass("splitter_panel");$("#main-wrapper").addClass("spliter");$(".spliter").width("100%").height("calc(100% - 80px)").split({orientation:"horizontal",limit:20});$('div[class="footer-slide-up"][id="dvBuildResults"] #errorList').hide();$('div[class="footer-slide-up"][id="dvBuildResults"] #warningList').hide();$('div[class="footer-slide-up"][id="dvBuildResults"] #messageList').show();$('div[class="footer-slide-up"][id="dvBuildResults"]').find("#btnError").removeClass("selected");$('div[class="footer-slide-up"][id="dvBuildResults"]').find("#btnWarning").removeClass("selected");$('div[class="footer-slide-up"][id="dvBuildResults"]').find("#btnMessage").addClass("selected")}function onClickBuildResultsDiv(){showBuildResults();toggleBuildResults(null,!0)}function showBuildResults(){showFooter();$("div[class='footer-main-links'] #liBuildResults").show();selectBuildResultErrors();$('div[id="divBuildResultsbutton"]').hide()}function CloseBuildResultsButton(n){$('div[id="divBuildResultsbutton"]').hide();n&&n.stopPropagation()}function showFooter(){$(".footer").show()}function toggleBuildResults(n,t){onBodyClick();$('div[class="footer-slide-up"][id="dvBuildResults"]').is(":visible")?t||($(".footer-main-links #liBuildResults a").removeClass("selected"),$('div[class="footer-slide-up"][id="dvBuildResults"]').hide("slide",{direction:"down"})):($(".footer-main-links #liBuildResults a").addClass("selected"),$('div[class="footer-slide-up"][id="dvBuildResults"]').show("slide",{direction:"down"}),hideOtherFooters("BuildResults"));n&&n.stopPropagation()}function hideBuildResults(){closeBuildResults();$("div[class='footer-main-links'] #liBuildResults").hide();$("div[class='footer-main-links'] ul").find("li:visible").length==0&&hideFooter();$('div[id="divBuildResultsbutton"]').show()}function closeBuildResults(){$('div[class="footer-slide-up"][id="dvBuildResults"]').is(":visible")&&($(".footer-main-links #liBuildResults a").removeClass("selected"),$('div[class="footer-slide-up"][id="dvBuildResults"]').hide("slide",{direction:"down"}));$("#main-wrapper").removeClass("splitter_panel");$("#main-wrapper").removeClass("spliter");$('div[id="divbottompanel"]').hide();$("#main-wrapper .a").height("100%")}function hideFooter(){$(".footer").hide()}function hideOtherFooters(n){n!="BuildResults"&&closeBuildResults();n!="FindResults"&&closeFindResults()}function closeFindResults(){$('div[class="footer-slide-up"][id="dvFindResults"]').is(":visible")&&($(".footer-main-links #liFindResults a").removeClass("selected"),$('div[class="footer-slide-up"][id="dvFindResults"]').hide("slide",{direction:"down"}))}function getArgumentDataTypePrefix(n){var t="";if(n&&n.trim()!="")switch(n){case"bool":case"boolean":case"Boolean":t="abln";break;case"datetime":case"DateTime":t="adt";break;case"decimal":case"Decimal":t="adcml";break;case"double":case"Double":t="adbl";break;case"float":case"Float":t="aflt";break;case"int":case"Int32":case"long":case"Int64":case"short":case"Int16":t="aint";break;case"string":case"String":t="astr";break;case"Collection":t="aclb";break;case"CDOCollection":t="aclb";break;case"Object":t="aobj";break;case"List":t="alst"}return t}function makeStringToCamelCase(n){for(var t="",r=!0,i=0;i<n.length;i++)"~`!@#$%^&*_-+=[{()}]|:;<,.>?/.".contains(""+n[i])?r=!0:(t+=r?n.toUpperCase()[i]:n[i],r=""+n[i]==" "?!0:!1);return(t.toLowerCase().match("^iclb")||t.toLowerCase().match("^icol")||t.toLowerCase().match("^ibus"))&&(t=t.substring(4)),t}function codevaluesIDTextChanged(n){var i=$(n.target),t=angular.element(n.target).scope(),u;if(t.codeid||(t.codevalueslist=[]),t.codevalueslist||$.connection.hubMain.server.getCodeValues("ScopeId_"+t.$id,t.codeid),t.codevalueslist&&t.codevalueslist.length>0){var f=[],e=i.val(),r=t.codevalueslist.sort();if(n.ctrlKey&&n.keyCode==$.ui.keyCode.SPACE&&$(i).data("ui-autocomplete"))$(i).autocomplete("search",$(i).val()),n.preventDefault();else{if(r&&r.length>100)for(u=0;u<r.length;u++)if(f.length<100)r[u].CodeValueDescription.toLowerCase().indexOf(e.toLowerCase())>-1&&f.push(r[u]);else break;else f=r;setSingleLevelAutoComplete(i,f,t,"CodeValue","CodeValueDescription")}}else setSingleLevelAutoComplete(i,[],t,"CodeValue","CodeValueDescription")}function getLineNumber(n){var i,r,t,u=1;if(i=n.val().substr(0,n[0].selectionStart).split("\n").length,r=n.val().split("\n"),t=r[i-1],t&&(t.trim().contains("<")&&!t.trim().startsWith("<")&&!t.trim().contains("<\/")||t.trim().contains("<\/")&&t.trim().endsWith(">")||t.trim().contains("><\/")&&t.trim().contains("<")&&t[t.trim().indexOf("<")+1]!="/"))u=i;else if(t&&(!t.trim().startsWith("<")||t.trim().startsWith("<\/")||!t.trim().startsWith("/")||!t.trim().contains("<")))while(t!=undefined)if(t=r[i-1],i--,t&&t.trim().startsWith("<")){i++;u=i;break}return u}function scrollTextArea(n,t,i){var r=n[0].value.split("\n"),f=n[0].scrollHeight/r.length,e,u;n[0].scrollTop=(t-1)*f;t&&i&&(e=n[0].scrollWidth/3,u=r[t-1].indexOf(i),n[0].scrollLeft=u*4.4+i.length)}function selectTextareaLine(n,t){var i,f;t--;var r=n[0].value.split("\n"),u=0,f=n[0].value.length;for(i=0;i<r.length;i++){if(i==t)break;u+=r[i].length+1}f=r[t].length+u;typeof n[0].selectionStart!=undefined&&(n[0].selectionStart=u,n.focus(),n[0].selectionEnd=f)}function setEntityQueryIntellisense(n,t,i,r){window.event&&(window.event.keyCode===38||window.event.keyCode===40)||(r==""&&(r=undefined),t&&t.length>0?(t=typeof t[0].ID=="undefined"?t.sort():typeof r!="undefined"?t.sort(function(n,t){var i=n[r].toLowerCase(),u=t[r].toLowerCase();return i<u?-1:i>u?1:0}):t.sort(function(n,t){if(n.ID&&t.ID){var i=n.ID.toLowerCase(),r=t.ID.toLowerCase();if(i<r)return-1;if(i>r)return 1}return 0}),n.autocomplete({minLength:0,appendTo:"#dvIntellisense",open:function(t){var f,r,u;if(n[0].localName=="textarea"||n[0].localName=="input"&&n.attr("type")=="text")f=n.textareaHelper("caretPosAbs"),$("#dvIntellisense > ul").css({left:f.left+"px",width:"auto",height:"auto",overflow:"auto",maxWidth:"300px",maxHeight:"300px","z-index":"999999999"}),setIntellisensePosition(t);else if(n[0].localName=="span"){var i=this.getBoundingClientRect().top,e=this.getBoundingClientRect().left,h=this.getBoundingClientRect().width,s=this.getBoundingClientRect().height,o=$(window).height();for(i+300>o?i-=300:i+=s,$("#dvIntellisense > ul").css({left:e+"px",top:i+"px",width:"auto",height:"auto",overflow:"auto",maxWidth:"300px",maxHeight:"300px"}),r=0;r<$("#dvIntellisense > ul").length;r++)$("#dvIntellisense > ul")[r].offsetHeight!=0&&(u=$("#dvIntellisense > ul")[r].offsetHeight);u<300&&i<this.getBoundingClientRect().top&&(i=this.getBoundingClientRect().top+this.getBoundingClientRect().height+u>o?this.getBoundingClientRect().top-u:this.getBoundingClientRect().top+this.getBoundingClientRect().height,$("#dvIntellisense > ul").css({left:e+"px",top:i+"px",width:"auto",height:"auto",overflow:"auto",maxWidth:"300px",maxHeight:"300px"}))}$(n).data("ui-autocomplete")&&($(".page-header-fixed").css("pointer-events","none"),$("#dvIntellisense").css("pointer-events","auto"))},source:function(n,i){var u=$.ui.autocomplete.filter($.map(t,function(n){return typeof n.ID=="undefined"?{label:n,value:n}:typeof r!="undefined"&&n.hasOwnProperty(r)?{label:n[r],value:n}:{label:n.ID,value:n}}),extractLast(n.term,this.element[0].selectionStart));i(u.slice(0,100))},focus:function(n,t){return t.item.value&&t.item.value.hasOwnProperty("Tooltip")&&t.item.value.Tooltip?$(".ui-autocomplete > li").attr("title",t.item.value.Tooltip):$(".ui-autocomplete > li").attr("title",t.item.label),!1},select:function(t,u){var e,s=0,o=0,y=0,k,d,p,a,h,f,c,w;if(t.target.localName=="input"?(e=getSplitArray(this.value,this.selectionStart),o=this.selectionStart):t.target.localName=="span"&&(s=caretPosition(this),e=getSplitArray(this.innerText,s),o=s),e.length>0)if(t.target.localName=="input")y=e[e.length-1].length;else if(t.target.localName=="span")for(f=s-e[e.length-1].length,e[e.length-1].length>0&&(s=f),k=e[e.length-1].split(""),d=f+k.length,p=f;p<d;p++)this.innerText=this.innerText.slice(0,f)+this.innerText.slice(f+1,this.innerText.length);if(this.value||(o=0),typeof r!="undefined"&&u.item.value[r])this.value=o==0?u.item.value[r]:[this.value.slice(0,o-y),u.item.value[r],this.value.slice(o)].join("");else if(u.item.value.ID){if(t.target.localName=="input"?this.value=o==0?u.item.value.ID:[this.value.slice(0,o-y),u.item.value.ID,this.value.slice(o)].join(""):t.target.localName=="span"&&(this.innerText=[this.innerText.slice(0,s),u.item.value.ID,this.innerText.slice(s)].join("")),i&&i.items&&i.items.Name&&(i.items.Name=="calllogicalrule"||i.items.Name=="calldecisiontable"||i.items.Name=="callexcelmatrix"||i.items.Name=="method"||i.items.Name=="query"))if(a=i.items.Elements.filter(function(n){return n.Name=="parameters"}),u.item.value.RuleType||u.item.value.QueryType||u.item.value.ReturnType){if(u.item.value.Parameters){h=null;h=a.length>0?a[0]:{Name:"parameters",Value:"",dictAttributes:{},Elements:[],Children:[]};i.$root.UndRedoBulkOp("Start");h.Elements.length>0&&i.$apply(function(){h.Elements=h.Elements.filter(function(n){return u.item.value.Parameters.some(function(t){return t.ID==n.dictAttributes.ID})})});for(f in u.item.value.Parameters)c=h.Elements.filter(function(n){return n.dictAttributes.ID==u.item.value.Parameters[f].ID}),c.length>0?i.$apply(function(){i.$root.EditPropertyValue(c[0].dictAttributes.sfwDataType,c[0].dictAttributes,"sfwDataType",u.item.value.Parameters[f].DataType);i.$root.EditPropertyValue(c[0].dictAttributes.sfwDirection,c[0].dictAttributes,"sfwDirection",u.item.value.Parameters[f].Direction);i.$root.EditPropertyValue(c[0].dictAttributes.sfwEntity,c[0].dictAttributes,"sfwEntity",u.item.value.Parameters[f].Entity)}):i.$apply(function(){var n={Name:"parameter",Value:"",dictAttributes:{ID:u.item.value.Parameters[f].ID,sfwDataType:u.item.value.Parameters[f].DataType,sfwDirection:u.item.value.Parameters[f].Direction,sfwEntity:u.item.value.Parameters[f].Entity,sfwNodeID:generateUUID()},Elements:[],Children:[]};i.$root.PushItem(n,h.Elements)});a.length==0&&i.$apply(function(){i.$root.PushItem(h,i.items.Elements)});i.$root.UndRedoBulkOp("End")}}else a.length>0&&i.$apply(function(){i.$root.DeleteItem(i.items.Elements[i.items.Elements.indexOf(a[0])],i.items.Elements)})}else this.value=this.value+u.item.value;if(w=angular.element($(this)).scope(),w&&w.$broadcast("UpdateOnClick",n[0]),this.childNodes[0]!=undefined){var b=this.ownerDocument||this.document,g=b.defaultView||b.parentWindow,l,nt=s+u.item.value.ID.length,v=document.createRange();v.setStart(this.childNodes[0],nt);v.collapse(!0);typeof g.getSelection!="undefined"?(l=g.getSelection(),l.removeAllRanges(),l.addRange(v)):(l=b.selection)&&l.type!="Control"&&(l.removeAllRanges(),l.addRange(v))}else $(this).trigger("change");return!1},close:function(){$(".page-header-fixed").css("pointer-events","auto")}})):$(n).data("ui-autocomplete")&&$(n).autocomplete("destroy"))}function preventDefaultSaveUndoRedo(n){n.ctrlKey&&(n.keyCode==90||n.keyCode==89||n.keyCode==83)&&n.preventDefault()}function getDataType(n,t){var i="";return n=="CollctionType"?i="Collection":n=="List"?i="List":n=="BusObjectType"||n=="OtherReferenceType"||n=="TableObjectType"?i="Object":t!=undefined&&t!=""&&t!=null&&(i=t.toLowerCase()=="int32"?"int":t.toLowerCase()=="int16"?"short":t.toLowerCase()=="int64"?"long":t.toLowerCase()=="single"?"float":t.toLowerCase()=="boolean"?"bool":t.toLowerCase()),i}function setIntellisensePosition(n){var i=$(n.target),t,r,u;i.data("ui-autocomplete")?(t=i.autocomplete("widget"),left=t.position().left,windowWidth=$(window).width(),height=t.height(),inputHeight=i.height(),windowsHeight=$(window).height(),windowsHeight<t.position().top+height+inputHeight&&(newTop=t.position().top-height-inputHeight-10,t.css("top",newTop+"px")),r=t.width(),left+r>windowWidth&&(u=left+r-windowWidth,newleft=left-(u+15),t.css("left",newleft+"px"))):n.stopPropagation()}function sortNumbersBasedOnproperty(n,t,i){n=n.sort(function(n,t){var r,u;if(n&&t&&(typeof i!="undefined"&&n.hasOwnProperty(i)?r=n[i]:typeof propertyName!="undefined"&&n.hasOwnProperty(propertyName)?r=n[propertyName]:typeof propertyName!="undefined"&&n.dictAttributes&&n.dictAttributes.hasOwnProperty(propertyName)?r=n.dictAttributes[propertyName]:n.hasOwnProperty("ID")?r=n.ID:n&&(r=n),typeof i!="undefined"&&t.hasOwnProperty(i)?u=t[i]:typeof propertyName!="undefined"&&t.hasOwnProperty(propertyName)?u=t[propertyName]:typeof propertyName!="undefined"&&t.dictAttributes&&t.dictAttributes.hasOwnProperty(propertyName)?u=t.dictAttributes[propertyName]:t.hasOwnProperty("ID")?u=t.ID:t&&(u=t),r&&u)){if(r<u)return-1;if(r>u)return 1}return 0})}function sortListBasedOnproperty(n,t,i){n=n.sort(function(n,t){var r,u;if(n&&t&&(typeof i!="undefined"&&n.hasOwnProperty(i)?r=n[i].toLowerCase():typeof propertyName!="undefined"&&n.hasOwnProperty(propertyName)?r=n[propertyName].toLowerCase():typeof propertyName!="undefined"&&n.dictAttributes&&n.dictAttributes.hasOwnProperty(propertyName)?r=n.dictAttributes[propertyName].toLowerCase():n.hasOwnProperty("ID")?r=n.ID.toLowerCase():n.toLowerCase&&(r=n.toLowerCase()),typeof i!="undefined"&&t.hasOwnProperty(i)?u=t[i].toLowerCase():typeof propertyName!="undefined"&&t.hasOwnProperty(propertyName)?u=t[propertyName].toLowerCase():typeof propertyName!="undefined"&&t.dictAttributes&&t.dictAttributes.hasOwnProperty(propertyName)?u=t.dictAttributes[propertyName].toLowerCase():t.hasOwnProperty("ID")?u=t.ID.toLowerCase():t.toLowerCase&&(u=t.toLowerCase()),r&&u)){if(r<u)return-1;if(r>u)return 1}return 0})}function getRemovedStringStartingSpace(n){for(var r="",i=n.split(" "),t=0;t<i.length;t++)if(i[t].trim()=="")i.splice(t,1),t--;else break;return i.join("")}function onEntityTreeDragStart(n){var h;dragDropData=null;dragDropDataObject=null;var r=$(n.currentTarget).attr("drag-id"),u=$(n.currentTarget).attr("drag-display-name"),f=$(n.currentTarget).attr("drag-datatype"),t=$(n.currentTarget).attr("drag-object"),e=$(n.currentTarget).attr("drag-fieldtype");t=JSON.parse(t);var o=$(n.currentTarget).attr("drag-boolparenttype"),s=$(n.currentTarget).attr("drag-fieldquery"),i=[r,u,f,t,o,e,s];lstEntityTreeFieldData=i;h=JSON.stringify(i);n.dataTransfer.setData("Text","")}function onEntityFieldDragOver(n){if(n){var t=angular.element($(n.target)).scope();if(n.preventDefault&&n.preventDefault(),n.stopPropagation&&n.stopPropagation(),t&&t.candrop!=undefined&&t.candrop==!1)return!1}}function SetCodeIDDescriptionToList(n){if(n&&n.length>0)for(var t=0;t<n.length;t++)n[t].CodeIDDescription=n[t].CodeID+" - "+n[t].Description}function onEntityFieldDropInDirective(n){var o=n.dataTransfer.getData("Text"),r;if(n.stopPropagation&&n.stopPropagation(),n.preventDefault(),o==""&&lstEntityTreeFieldData!=null){var u=lstEntityTreeFieldData,f=u[0],e=u[1],i=u[2],t=angular.element($(n.target)).scope();t&&(t.candrop==undefined||t.candrop)&&(r="",r=e!=""?e+"."+f:f,u[3]&&u[3].Type=="Description"&&(i="Description"),i&&i!="Object"&&i!="Collection"&&i!="List"&&i!="CDOCollection"&&t.model&&t.model.Name!="sfwTableBookMark"&&t.model.Name!="sfwChildTemplateBookmark"?t.model&&t.$evalAsync(function(){t.model.dictAttributes?(i!="Description"&&(t.setcolumndatatype?t.$root.EditPropertyValue(t.model.dictAttributes.sfwColumnDataType,t.model.dictAttributes,"sfwColumnDataType",i):t.$root.EditPropertyValue(t.model.dictAttributes.sfwDataType,t.model.dictAttributes,"sfwDataType",i)),t.$root.EditPropertyValue(t.model.dictAttributes.sfwEntityField,t.model.dictAttributes,"sfwEntityField",r)):t.$root.EditPropertyValue(t.model.TrackingID,t.model,"TrackingID",r)}):t.model&&t.model.Name=="sfwChildTemplateBookmark"?t.model.dictAttributes&&t.model.dictAttributes.sfwChildTemplateType=="Collection"?i=="Collection"||i=="CDOCollection"||i=="List"?t.$evalAsync(function(){t.model.dictAttributes&&(t.$root.EditPropertyValue(t.model.dictAttributes.sfwEntityField,t.model.dictAttributes,"sfwEntityField",r),t.onBlur())}):MessageBox("Message","Field Type has to be 'Collection' or 'List' "):t.model.dictAttributes&&t.model.dictAttributes.sfwChildTemplateType=="Entity"?i=="Object"?t.$evalAsync(function(){t.model.dictAttributes&&(t.$root.EditPropertyValue(t.model.dictAttributes.sfwEntityField,t.model.dictAttributes,"sfwEntityField",r),t.onBlur())}):MessageBox("Message","Field Type has to be 'Object'"):MessageBox("Message","Select Object Type for template."):t.model&&t.model.Name=="sfwTableBookMark"?i=="Collection"?t.$evalAsync(function(){t.model.dictAttributes&&(t.$root.EditPropertyValue(t.model.dictAttributes.sfwEntityField,t.model.dictAttributes,"sfwEntityField",r),t.onBlur())}):MessageBox("Message","Object/Field Cannot be added"):MessageBox("Message","Object/Collection Cannot be added"),t.validateEntityField&&t.validate&&t.$evalAsync(function(){t.inputElement=undefined;t.validateEntityField()}));n.dataTransfer.clearData();lstEntityTreeFieldData=null}else lstEntityTreeFieldData=null,n&&n.preventDefault&&n.preventDefault()}function validateExtraFields(n){var r=!1,t,u,i;for(n.FormDetailsErrorMessage="",t=0;t<n.objExtraFields.length;t++)if(n.objExtraFields[t].IsRequired!=undefined&&(n.objExtraFields[t].IsRequired=="True"||n.objExtraFields[t].IsRequired==!0)&&!n.objExtraFields[t].Value){if(n.FormDetailsErrorMessage="Error: Enter the Extra Field Value for the Field "+n.objExtraFields[t].ID,r=!1,n.objExtraFields[t].ControlType=="ComboBox"){for(i=0;i<n.objExtraFields[t].Children.length;i++)n.objExtraFields[t].Children[i].Value&&(r=!0,n.FormDetailsErrorMessage=undefined);if(r==!1)return n.FormDetailsErrorMessage="Error: Enter the Extra Field Value for the Field "+n.objExtraFields[t].ID,!0}if(n.objExtraFields[t].ControlType=="CheckBoxList"){for(u=!1,i=0;i<n.objExtraFields[t].Children.length;i++)n.objExtraFields[t].Children[i].Value&&(u=!0,r=!0,n.FormDetailsErrorMessage=undefined);if(u==!1)return n.FormDetailsErrorMessage="Error: Enter the Extra Field Value for the Field "+n.objExtraFields[t].ID,!0}if(r==!1)return!0}return!1}function escapeRegExp(n){return n.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function toggleDuplicateIdErrList(n){var t=$(".duplicate-id-tooltip");t.length>0&&$(n.target).parent().siblings().find(".duplicate-id-tooltip").toggle()}function validateEmail(n){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(n)}function parsePathIntellisenseResult(n){return $.map(JSON.parse(n),function(n){return{label:n,value:n}})}function keyUpAction(n,t){var i,r=t.Elements.indexOf(n);return r>0&&(i=t.Elements[r-1]),i}function getNewBaseModel(n,t,i){n===undefined&&(n="");var r={Name:n,Value:"",dictAttributes:{},Elements:[],Children:[]};return t&&(r.dictAttributes=t),i&&(r.dictAttributes.sfwNodeID=generateUUID()),r}function detectIE(){var n=window.navigator.userAgent,i=n.indexOf("MSIE "),u,r,t;return i>0?parseInt(n.substring(i+5,n.indexOf(".",i)),10):(u=n.indexOf("Trident/"),u>0)?(r=n.indexOf("rv:"),parseInt(n.substring(r+3,n.indexOf(".",r)),10)):(t=n.indexOf("Edge/"),t>0)?parseInt(n.substring(t+5,n.indexOf(".",t)),10):!1}function stopEventPropagationConditional(n){n&&n.stopPropagation()}function addTextAtCaret(n,t){var u,r=document.getElementById(n),i=r.selectionStart;return i=i,u=addTextAtCursorPosition(r,i,t),updateCursorPosition(i,t,r),u}function addTextAtCursorPosition(n,t,i){var r=n.value.substring(0,t),u=n.value.substring(t,n.value.length);return n.value=r+i+u,n.value}function updateCursorPosition(n,t,i){t==undefined&&(t.length=0);n=n+t.length;i.focus()}function ShowOnlyExecutedPath(n,t){var u,f,i,r;if(n){for(i=0;i<t.Rows.length;i++)if(r=t.Rows[i],r.IsVisiblefterExecution=!1,r.Cells.length>0&&r.Cells[0].Item&&r.Cells[0].Item.IsStepSelected==!0&&(r.IsVisiblefterExecution=!0,u=r.Cells[0].Rowspan,u>1)){for(f=i+1;f<i+u;f++)t.Rows[f].IsVisiblefterExecution=!0;i=i+u-1}}else for(i=0;i<t.Rows.length;i++)r=t.Rows[i],r.IsVisiblefterExecution=!0}function setDataToEditor(n,t,i,r){if(i||(i=1),t||(t=""),n&&!n.editor){var u="editor_"+r;n.editor=ace.edit(u);n.editor.getSession().setMode("ace/mode/xml");n.editor.resize(!0)}n&&n.editor&&n.$evalAsync(function(){n.editor.getSession().setValue(t);n.isSourceDirty=!1;n.editor.setFontSize(14);n.editor.getSession().on("change",function(){n.editor.curOp&&n.editor.curOp.command.name&&n.$evalAsync(function(){n.isSourceDirty=!0;n.isDirty=!0})});n.editor.gotoLine(i);n.editor.renderer.scrollCursorIntoView({row:i,column:1},.5)})}function preventDefaultBrowserHelp(){$(function(){var n=!1;"onhelp"in window&&(window.onhelp=function(){return!1});$(document).keydown(function(t){if(t.keyCode===112)return window.event&&(window.event.keyCode=0),n=!0,!1});$(document).keypress(function(){if(n)return n=!1,!1})})}function getKnowtionHelpUrl(n){var t;return $.ajax({url:"api/Login/GetKnowtionUrl?astrKnowtionID="+n,type:"POST",async:!1,success:function(n){t=n},error:function(n){var t=JSON.parse(n.responseText),i;t&&t.Message?(i=t.Message,t.ExceptionMessage&&(i=i+"\n"+t.ExceptionMessage),MessageBox("Message",i)):MessageBox("Message","An error occured while getting knowtion help url.")}}),t}function closest(n,t){return t(n)?n:n&&n.parentNode instanceof Element&&closest(n.parentNode,t)}function onlyAllowedNumbers(n){!n||n.charCode>=48&&n.charCode<=57||n.preventDefault()}function validatePathForSpecialChar(n){return/^(\\|\s)|([\/:*?"<>|])|(\\\s*\\)|(\\$)/.test(n)}function getlstQueryTypes(n){for(var t,r,u=n.split(";"),f=[],i=0;i<u.length;i++)t={},r=u[i].split(":"),t.ID=r[0],t.Attribute=r[1],f.push(t);return f}function getQuery(n,t){for(var r=undefined,i=0;i<n.length;i++)if(n[i]&&n[i].Attribute&&t.dictAttributes[n[i].Attribute]){r=t.dictAttributes[n[i].Attribute];break}return r}function MessageBox(n,t,i,r,u){var f=angular.element(document.body).injector().get("$SgMessagesService");f&&f.Message&&f.Message(n,t,i,r,u)}function getQueryFromEntityIntellisense(n,t){var f=null,i=n!=undefined&&n!=null?n.split("."):[],e,r,o;if(i&&i.length==2){var s=i[0],h=i[1],u=t.filter(function(n){return n.ID==s});u&&u.length>0&&(e=u[0],r=e.Queries.filter(function(n){return n.ID==h}),r&&r.length>0&&(o=r[0],f=o))}return f}var count_getcurrentfile=0,bootstrap=function(n){n.provider("hubcontext",[function(){this.$get=function(){return $.connection}}]).config(["$provide","$httpProvider",function(n,t){n.decorator("$exceptionHandler",[extendExceptionHandler]);t.interceptors.push("noCacheInterceptor")}]).run(["hubcontext","$rootScope",function(n,t){if(n.hubMain){n.hub.start().done(i).fail(r);$.connection.hub.disconnected(u);function i(){t.$evalAsync(function(){t.IsAppLoaded=!0;t.IsHubWorking=!0})}function r(){}function u(){$.connection.hub.start().done(i).fail(r)}}else t.IsHubWorking=!1,t.IsAppLoaded=!0}]);var t=$("[s3-app]");angular.bootstrap(t,["myApp"])},app=angular.module("myApp",["ngDialog","ngSanitize","mgo-angular-wizard","ngCookies","smart-table"]),hubMain=null,s3Config=null,lstEntityTreeFieldData,populateMessageByMessageID;URL_HTTP=URL_HUB="http://localhost:8080";URL_HTTPS="https://localhost:8083";location.protocol=="https:"&&(URL_HUB=URL_HTTPS);$.ajax({async:!1,url:URL_HUB+"/signalr/hubs",type:"GET",success:function(){$.connection.hub.url=URL_HUB+"/signalr";hubMain=$.connection.hubMain;initializeHubreceivemethods();$.getJSON("package.json?"+Date.now(),function(n){s3Config=n});angular.element(document.body).ready(function(){bootstrap(app)})},error:function(){window.location.href="error_page.html?ERROR_CODE=101"}});app.factory("noCacheInterceptor",[function(){return{request:function(n){if(s3Config&&n.method=="GET"&&n.url.indexOf(".html")>0&&n.url!="wizard.html"&&n.url!="step.html"){var t=n.url.indexOf("?")===-1?"?":"&";n.url=n.url+t+"rev="+s3Config.versionClient}return n}}}]);app.filter("trustAsResourceUrl",["$sce",function(n){return function(t){return n.trustAsResourceUrl(t)}}]);String.prototype.contains=function(n,t){return t?this.toLowerCase().indexOf(n.toLowerCase())>-1:this.indexOf(n)>-1};String.prototype.startsWith=function(n,t){return t?this.toLowerCase().indexOf(n.toLowerCase())==0:this.indexOf(n)==0};String.prototype.endsWith=function(n,t){return t?this.toLowerCase().indexOf(n.toLowerCase())>-1?this.toLowerCase().lastIndexOf(n.toLowerCase())==this.length-n.length:!1:this.indexOf(n)>-1?this.lastIndexOf(n)==this.length-n.length:!1};String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)};String.format=function(){for(var i,t=arguments[0],n=0;n<arguments.length-1;n++)i=new RegExp("\\{"+n+"\\}","gm"),t=t.replace(i,arguments[n+1]);return t};String.prototype.trimEnd=function(n){n=n?n:" ";for(var t=this.length-1;t>=0&&this.charAt(t)==n;t--);return this.substring(0,t+1)};Array.prototype.unique=function(){var n=this;return n.filter(function(t,i){return n.indexOf(t)==i})};Array.prototype.difference=function(n,t){return t?this.filter(function(i){return n.map(function(n){if(n)return n[t]}).indexOf(i[t])<0}):this.filter(function(t){return n.indexOf(t)<0})};$.ui.autocomplete.prototype._renderItem=function(n,t){var i="";return i=t.logo&&t.logo!=""?t.logo+t.label:t.label,$("<li><\/li>").data("item.autocomplete",t).append("<a>"+i+"<\/a>").appendTo(n)},function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery"],n):typeof module=="object"&&module.exports?module.exports=n(require("jquery")):n(jQuery)}(function(n){"use strict";var i="textarea-helper-caret",t="textarea-helper",u=["box-sizing","height","width","padding-bottom","padding-left","padding-right","padding-top","font-family","font-size","font-style","font-variant","font-weight","word-spacing","letter-spacing","line-height","text-decoration","text-indent","text-transform","direction"],r=function(t){(t.nodeName.toLowerCase()==="textarea"||t.nodeName.toLowerCase()==="input")&&(this.$text=n(t),this.$mirror=n("<div/>").css({position:"absolute",overflow:"auto","white-space":"pre-wrap","word-wrap":"break-word",top:0,left:-9999}).insertAfter(this.$text))};(function(){this.update=function(){for(var r={},f=0,t;t=u[f];f++)r[t]=this.$text.css(t);this.$mirror.css(r).empty();var e=this.getOriginalCaretPos(),o=this.$text.val(),s=document.createTextNode(o.substring(0,e)),h=document.createTextNode(o.substring(e)),c=n("<span/>").addClass(i).css("position","absolute").html("&nbsp;");this.$mirror.append(s,c,h).scrollTop(this.$text.scrollTop())};this.destroy=function(){return this.$mirror.remove(),this.$text.removeData(t),null};this.caretPos=function(){this.update();var t=this.$mirror.find("."+i),n=t.position();return this.$text.css("direction")==="rtl"&&(n.right=this.$mirror.innerWidth()-n.left-t.width(),n.left="auto"),n};this.caretPosAbs=function(){var n=this.$text[0].getBoundingClientRect(),t=this.$text.css("border-left-width"),i=this.$text.css("border-top-width"),r=this.$text.css("padding-left"),u=this.$text.css("padding-top"),f=this.caretPos();return n?(n.left||(n.left=0),n.top||(n.top=0)):n={left:0,top:0},t||(t=0),i||(i=0),r||(r=0),u||(u=0),{left:parseFloat(n.left)+parseFloat(t)+parseFloat(r)+parseFloat(f.left),top:parseFloat(n.top)+parseFloat(i)+parseFloat(u)+parseFloat(f.top)+15}};this.height=function(){return this.update(),this.$mirror.css("height",""),this.$mirror.height()};this.getOriginalCaretPos=function(){var n=this.$text[0],i,t,r;return n.selectionStart?n.selectionStart:document.selection?(n.focus(),i=document.selection.createRange(),i==null)?0:(t=n.createTextRange(),r=t.duplicate(),t.moveToBookmark(i.getBookmark()),r.setEndPoint("EndToStart",t),r.text.length):0}}).call(r.prototype);n.fn.textareaHelper=function(i){if(this.each(function(){var u=n(this),i=u.data(t);i||(i=new r(this),u.data(t,i))}),i){var u=this.first().data(t);return u[i]()}return this}});$.fn.scrollTo=function(n,t,i){typeof t=="function"&&arguments.length==2&&(i=t,t=n);var r=$.extend({scrollTarget:n,offsetTop:100,offsetLeft:100,duration:300,easing:"swing"},t);return this.each(function(){var n=$(this),t=typeof r.scrollTarget=="number"?r.scrollTarget:$(r.scrollTarget),f=0,u;f=typeof t=="number"?t:t.offset()?t.offset().top+n.scrollTop()-parseInt(r.offsetTop):n.scrollTop()-parseInt(r.offsetTop);f<n[0].scrollHeight&&(f-=150);n.animate({scrollTop:f},parseInt(r.duration),r.easing,function(){typeof i=="function"&&i.call(this)});u=0;r.offsetLeft>0&&(u=typeof t=="number"?t:t.offset()?t.offset().left+n.scrollLeft()-parseInt(r.offsetLeft):n.scrollLeft()-parseInt(r.offsetLeft));u<n[0].scrollWidth&&(u-=150);n.animate({scrollLeft:u},parseInt(r.duration),r.easing,function(){typeof i=="function"&&i.call(this)})})};var FindDeepNode=function(n,t){return n&&angular.forEach(n.Elements,function(i){return(i.ParentVM=n,i==t)?t:i.Elements&&i.Elements.length>0?t=FindDeepNode(i,t):i.Children&&i.Children.length>0&&(selectedChildItem=FindDeepNodeChildren(i,t),selectedChildItem==t)?t:void 0}),t},FindDeepNodeChildren=function(n,t){angular.forEach(n.Children,function(i){return i.ParentVM=n,i==t?i:void 0})},getPathSource=function(n,t){while(n.ParentVM)n.ParentVM.Elements.length>0?t.push(n.ParentVM.Elements.indexOf(n)):n.ParentVM.Children.length>0&&t.push(n.ParentVM.Children.indexOf(n)),n=n.ParentVM;return t},FindNodeHierarchy=function(n,t){if(n&&n.Elements){var i=n.Elements[t];return i==undefined&&(i=n.Elements[t-1]),i&&(i.ParentVM=n),i}},FindChidrenHierarchy=function(n,t){return n.Children[t]},sourceChanged=function(){var n=getCurrentFileScope();n&&n.sourceChanged&&n.sourceChanged()};lstEntityTreeFieldData=null;window.onerror=function(n,t,i){var r=angular.element(document.body).injector().get("$rootScope");return r&&(r.IsLoading=!1,r.IsProjectLoaded=!1),console.log(["Error message: ",n,"\nURL: ",t,"\nLine Number: ",i].join("")),alert(["Error message: ",n,"\nURL: ",t,"\nLine Number: ",i].join("")),!0};String.prototype.includes||(String.prototype.includes=function(){"use strict";return String.prototype.indexOf.apply(this,arguments)!==-1});populateMessageByMessageID=function(n,t,i){var u=!1,r;n&&n.trim().length>0&&(r=t.filter(function(t){return t.MessageID==n}),r&&r.length>0&&(i.displayMessage=r[0].DisplayMessage,r[0].SeverityValue=="I"?i.severityValue="Information":r[0].SeverityValue=="E"?i.severityValue="Error":r[0].SeverityValue=="W"&&(i.severityValue="Warnings"),u=!0));u||(i.displayMessage="",i.severityValue="")},function(n){n.fn.hasScrollBar=function(){if(this.get(0)&&this.get(0).scrollHeight)return this.get(0).scrollHeight>this.height()}}(jQuery);app.directive("openfiledirective",["$compile","$rootScope",function(){return{restrict:"E",scope:{curobj:"="},replace:!0,link:function(n){n.setclassforopenfile=function(n){if(n!=undefined)return n.isvisible!=undefined?n.isvisible==!0?"file-wrapper":"displaynone":"file-wrapper"};n.curobj.file!=undefined&&n.curobj.file.FileType!=undefined&&(n.curobj.file.FileType=="LogicalRule"||n.curobj.file.FileType=="DecisionTable"||n.curobj.file.FileType=="ExcelMatrix"?n.contentUrl="Rule/views/RuleCommon.html":n.curobj.file.FileType=="ParameterScenario"||n.curobj.file.FileType=="ObjectScenario"||n.curobj.file.FileType=="ExcelScenario"?n.contentUrl="Scenario/views/Scenario.html":n.curobj.file.FileType=="Entity"?n.contentUrl="Entity/views/Entity.html":n.curobj.file.FileType=="CustomSettings"?n.contentUrl="Tools/views/CustomSettings.html":n.curobj.file.FileType=="ExecuteQuery"?n.contentUrl="Tools/views/ExecuteQuery.html":n.curobj.file.FileType=="RuleConstants"?n.contentUrl="Constants/Views/Constants.html":n.curobj.file.FileType=="ProjectConfiguration"?n.contentUrl="Tools/views/ProjectConfiguration.html":n.curobj.file.FileName=="RunResults"?n.contentUrl="Views/Tools/RunResults.html":n.curobj.file.FileType=="AuditLog"?n.contentUrl="Tools/views/AuditLog.html":n.curobj.file.FileType=="NeoRuleSettings"?n.contentUrl="Views/Tools/ConfigureSettings.html":n.curobj.file.FileType=="InboundFile"||n.curobj.file.FileType=="OutboundFile"?n.contentUrl="File/views/File.html":n.curobj.file.FileType=="Maintenance"||n.curobj.file.FileType=="Lookup"||n.curobj.file.FileType=="Wizard"||n.curobj.file.FileType=="UserControl"||n.curobj.file.FileType=="Tooltip"?n.contentUrl="Form/views/Form.html":n.curobj.file.FileType=="FormLinkMaintenance"||n.curobj.file.FileType=="FormLinkLookup"||n.curobj.file.FileType=="FormLinkWizard"?n.contentUrl="FormLink/views/FormLink.html":n.curobj.file.FileType=="Correspondence"||n.curobj.file.FileType=="PdfCorrespondence"?n.contentUrl="Correspondence/views/Correspondence.html":n.curobj.file.FileType=="BPMN"||n.curobj.file.FileType=="BPMTemplate"?n.contentUrl="BPM/views/BPMN.html":n.curobj.file.FileType=="Report"?n.contentUrl="Report/views/Report.html":n.curobj.file.FileType=="SearchFiles"?n.contentUrl="StartUp/views/SearchFiles.html":n.curobj.file.FileType=="WorkflowMap"?n.contentUrl="WorkFlow/views/WorkFlowMap.html":n.curobj.file.FileType=="VersionBPM"?n.contentUrl="BPM/views/BPMVersion.html":n.curobj.file.FileType=="ERDiagram"&&(n.contentUrl="Tools/views/NewERDiagram.html"))},template:'<div id="{{curobj.file.FileName}}" ng-include="contentUrl" ng-class="setclassforopenfile(curobj)" ><\/div>'}}]);app.directive("contextMenu",["$parse","$q",function(n,t){var i=[],r=function(n){while(i.length&&(!n||i.length>n))i.pop().remove();i.length==0&&u&&u.remove()},u=null,f=function(n,e,o,s,h){var c,a,l,b,v;h||(h=0);c||(c=angular.element);c(e.currentTarget).addClass("context");a=c("<div>");u?a=u:u=a;a.addClass("dropdown clearfix");l=c('<ul class="contex-menu">');l.addClass("dropdown-menu");l.attr({role:"menu"});l.css({display:"block",position:"absolute",left:e.pageX+"px",top:e.pageY+"px","z-index":1e4});var y=[],p=0,w=0;angular.forEach(o,function(u){var o=c("<li>"),a,v,b,nt,d,k,g;if(u===null)o.addClass("divider"),p++;else if(a=angular.isArray(u[1])?u[1]:angular.isArray(u[2])?u[2]:angular.isArray(u[3])?u[3]:null,v=c("<a>"),v.attr({tabindex:"-1",href:"#"}),b=typeof u[0]=="string"?u[0]:u[0].call(n,n,e,s),$promise=t.when(b),y.push($promise),$promise.then(function(n){v.text(n);a&&(v.css("cursor","default"),v.append(c('<strong style="font-family:monospace;font-weight:bold;float:right; position:absolute; margin-left:5px;">&gt;<\/strong>')));u[4]&&typeof u[4]=="string"&&($span=c("<span>"),$span.css("float","right"),$span.css("margin-left","10px"),$span.text(u[4]),v.append($span))}),o.append(v),nt=angular.isFunction(u[2])?u[2].call(n,n,e,s,b):!0,nt){w++;d=function(){r(h+1);var u=c(l[0]).outerWidth(),t=l[0].offsetLeft,i={pageX:t,pageY:l[0].offsetTop+o[0].offsetTop-3,currentMenuWidth:l[0].offsetWidth};f(n,i,a,s,h+1)};o.on("click",function(t){t.preventDefault();n.$apply(function(){a?d(t):(c(e.currentTarget).removeClass("context"),r(),u[1].call(n,n,e,s,b))})});k="";o.on("mouseover",function(t){n.$evalAsync(function(){if(a&&k!=a)k=a,d(t);else if(!a)while(i.length-1>h)i.pop().remove()})});o.on("mouseleave",function(){k=""})}else{o.on("click",function(n){n.preventDefault()});o.addClass("disabled");o.css({display:"none"});g=c(l[0].children);p>0&&(g[g.length-1].className="")}l.append(o)});w>0&&a.append(l);b=c("#main-wrapper").height();a.css({width:"100%",height:b+"px",position:"absolute",top:0,left:0,zIndex:99999999});c(document).find("body").append(a);v=0;t.all(y).then(function(){var o,f,s;if(h===0){var n=e.pageY,i=angular.element(l[0]).prop("offsetHeight"),t=c("#main-wrapper").height();n>i&&t-n<i&&(n=e.pageY-i);var r=e.pageX,u=angular.element(l[0]).prop("offsetWidth"),a=e.view.innerWidth;(r>u&&a-r<u||r+u>=c(window).width())&&(r=e.pageX-u-20,r+u>c(window).width()-50&&(r-=20));o=150;t-n-10>150&&(o=t-n-10);l.css({display:"block",position:"absolute",left:r+"px",top:n+"px","max-height":o+"px",overflow:"auto"})}else if(v=angular.element(l[0]).prop("offsetWidth"),f="0px",h>0){e.pageX+e.currentMenuWidth+v>c(window).width()?(l.css({display:"block",position:"absolute",left:e.pageX-v+"px"}),f=e.pageX-v):(l.css({display:"block",position:"absolute",left:e.pageX+e.currentMenuWidth+"px"}),f=e.pageX+e.currentMenuWidth);var n=e.pageY,i=angular.element(l[0]).prop("offsetHeight"),t=c("#main-wrapper").height();(i>t||n+i>t)&&(s=t-n,s>i?l.css({"max-height":s+"px",overflow:"auto"}):i+50>t?l.css({top:"130px",left:f+"px","max-height":t-140+"px",overflow:"auto"}):(n=e.pageY-i,n<150&&(n=150),l.css({top:n+"px","max-height":t-140+"px",overflow:"auto"})))}});a.on("mousedown",function(n){c(n.target).hasClass("dropdown")&&(c(e.currentTarget).removeClass("context"),r())}).on("contextmenu",function(n){c(n.currentTarget).removeClass("context");n.preventDefault();r(h)});n.$on("$destroy",function(){r()});i.push(l)};return function(n,t,i){t.on("contextmenu",function(t){t.stopPropagation();n.$apply(function(){t.preventDefault();var r=n.$eval(i.contextMenu),u=n.$eval(i.model);if(r instanceof Array){if(r.length===0)return;f(n,t,r,u)}else throw'"'+i.contextMenu+'" not an array';})})}}]);app.directive("newentityobjecttreetemplate",["$compile","$rootScope","$EntityIntellisenseFactory",function(n,t,i){return{restrict:"E",replace:!0,scope:{entityname:"=",selectedfield:"=",lstentity:"=",ischeckboxvisible:"=",selectedentityobjecttreefields:"=",iscollectionnextlevelload:"=",lstdisplayentity:"=",showonlycollection:"=",lstselectedmultiplelevelfield:"=",showonlyobject:"=",lstpreselectedfields:"=",lstpredisabledfields:"=",formid:"=",showonlycolumns:"=",showcolumndescription:"=",showvalueofcolumn:"=",ismainentity:"=",isallownavigation:"="},link:function(n){var r=n.$watch("entityname",function(){n.Init()}),u=n.$watch("lstpreselectedfields",function(t){t&&t.length>0&&n.lstpreselectedfields&&angular.forEach(n.lstpreselectedfields,function(t){var i,r,u;n.selectedentityobjecttreefields&&n.selectedentityobjecttreefields.length&&(i=n.selectedentityobjecttreefields.filter(function(n){return n.ID==t.ID}),i&&i.length>0&&(i[0].IsSelected="True",i[0].IsRecordSelected=!0,i[0].IsReadOnly=!0,n.lstselectedmultiplelevelfield&&(r={EntityField:i[0].ID,FieldObject:i[0],Entity:i[0].EntityName},u=n.isFieldFoundInSelectedList(n.lstselectedmultiplelevelfield,i[0].ID),u||n.lstselectedmultiplelevelfield.push(r))))})});n.isFieldFoundInSelectedList=function(n,t){for(var r=!1,i=0;i<n.length;i++)if(n[i].EntityField==t){r=!0;break}return r};n.CheckForPreDisableAttr=function(t,i){n.lstpredisabledfields&&angular.forEach(n.lstpredisabledfields,function(n){var r=t.SortedAttributes.filter(function(t){return t.ID==n.Value.ID});r&&r.length>0&&(i==""||i==undefined?r[0].ID==n.Key&&(r[0].IsDisabled=!0):i+"."+r[0].ID==n.Key&&(r[0].IsDisabled=!0))})};n.AddClsEntity=function(t,r,u,f){var s,l,o,v,c,p,y,w,b;if((f=="Collection"||f=="List")&&(n.isParentFieldCollection=!0),s={},l=n.checkEntityIsPresent(t),l==""){for(var h=i.getEntityIntellisense(),a=t,e=[];a;)h&&h.length&&(o=h.filter(function(n){return n.ID==a}),o&&o.length>0?(n.showonlycollection!=undefined&&!n.showonlycollection&&o[0].Attributes?(v=[],v=o[0].Attributes.filter(function(n){return n.DataType&&n.DataType!="Collection"&&n.DataType!="List"||!n.DataType}),e=e.concat(v)):e=e.concat(o[0].Attributes),a=o[0].ParentId):a="");c=[];p=JSON.stringify(e);e=JSON.parse(p);sortListBasedOnproperty(e,"","ID");c=e;s={IsVisible:!0,strEntityId:t,Attributes:c,SortedAttributes:c};n.lstEntities.push(s);n.selectedentityobjecttreefields&&n.selectedentityobjecttreefields.length>0&&ClearSelectedFieldList(n.selectedentityobjecttreefields);n.selectedentityobjecttreefields=c;n.ismainentity&&t&&h&&(y=h.filter(function(n){return n.ID==t}),y.length>0&&y[0].ErrorTableName&&(w={ID:"InternalErrors",DisplayName:"InternalErrors",Tooltip:"InternalErrors",IsPrivate:"False",Entity:"entError",Value:"ibusSoftErrors.iclbError",Type:"Collection",DataType:"Collection"},b={ID:"ExternalErrors",DisplayName:"ExternalErrors",Tooltip:"InternalErrors",IsPrivate:"False",Entity:"entError",Value:"ibusSoftErrors.iclbEmployerError",DataType:"Collection",Type:"Collection"},n.selectedentityobjecttreefields.push(w),n.selectedentityobjecttreefields.push(b)))}else s=l,n.selectedentityobjecttreefields&&n.selectedentityobjecttreefields.length>0&&ClearSelectedFieldList(n.selectedentityobjecttreefields),n.selectedentityobjecttreefields=l.Attributes;n.setVisibilityForEntitiesOrDisplayEntities(n.lstEntities,t,"Entity");n.AddClsDisplayEntity(s,r,u,f);n.CheckForPreDisableAttr(s,n.lstdisplayentity[n.lstdisplayentity.length-1].strDisplayName)};n.AddClsDisplayEntity=function(t,i,r,u){var f={IsVisible:!0,strDisplayName:i,strID:t.strEntityId,entity:t,strParentID:r,DataType:u,isParentFieldCollection:n.isParentFieldCollection};n.lstDisplayEntity.push(f);n.lstdisplayentity=n.lstDisplayEntity;n.setVisibilityForEntitiesOrDisplayEntities(n.lstDisplayEntity,i,"DisplayEntity")};n.setVisibilityForEntitiesOrDisplayEntities=function(t,i,r){var f,u;for(n.objEntityFilter.EntityTreeFilter="",u=0;u<t.length;u++)r=="Entity"?t[u].strEntityId==i?(t[u].IsVisible=!0,n.currentEntity=t[u],t[u].SortedAttributes=t[u].Attributes,n.selectedentityobjecttreefields&&n.selectedentityobjecttreefields.length>0&&ClearSelectedFieldList(n.selectedentityobjecttreefields),n.selectedentityobjecttreefields=t[u].SortedAttributes):t[u].IsVisible=!1:t[u].strDisplayName==i?(t[u].IsVisible=!0,n.objEntityFilter.DisplayPath=t[u].strDisplayName):t[u].IsVisible=!1;if(n.objEntityFilter.LimitCount=n.showonlycollection||n.showonlyobject||n.showonlycolumns||n.showcolumndescription?n.selectedentityobjecttreefields.length:50,n.lstselectedmultiplelevelfield&&r=="DisplayEntity"&&(f=getDisplayedEntity(n.lstdisplayentity),f))for(u=0;u<n.selectedentityobjecttreefields.length;u++)n.setValueToSelectedField(n.selectedentityobjecttreefields[u],f)};n.setValueToSelectedField=function(t,i){var u=i.strDisplayName,r;if(fieldName=t.ID,u!=""&&(fieldName=u+"."+t.ID),t.DataType!="Object"&&t.DataType!="Collection"&&t.DataType!="List"&&t.DataType!="CDOCollection")for(r=0;r<n.lstselectedmultiplelevelfield.length;r++)if(n.lstselectedmultiplelevelfield[r].EntityField==fieldName){t.IsSelected="True";break}};n.checkEntityIsPresent=function(t){for(var r="",i=0;i<n.lstEntities.length;i++)if(n.lstEntities[i].strEntityId==t){r=n.lstEntities[i];break}return r};n.getParentEntity=function(){for(var i="",t=0;t<n.lstEntities.length;t++)if(n.lstEntities[t].IsVisible){i=n.lstEntities[t].strEntityId;break}return i};n.getPathFromDisplayedEntities=function(){for(var i="",t=0;t<n.lstDisplayEntity.length;t++)if(n.lstDisplayEntity[t].IsVisible){i=n.lstDisplayEntity[t].strDisplayName;break}return i};n.Init=function(){n.lstEntities=[];n.lstDisplayEntity=[];n.objEntityFilter={};n.objEntityFilter.EntityTreeFilter="";n.objEntityFilter.LimitCount=50;n.objEntityFilter.DisplayPath="";n.currentEntity="";n.otherSelectedField=[];n.selectedentityobjecttreefields=[];n.isParentFieldCollection=!1;n.AddClsEntity(n.entityname,"",null,"")};n.entityname&&n.Init();n.LoadNextLevelEntityField=function(t){var u;if((t.DataType=="Collection"||t.DataType=="List"||t.DataType=="Object")&&(t.DataType!="Collection"&&t.DataType!="List"||n.iscollectionnextlevelload)){var i=n.getPathFromDisplayedEntities(),f=t.Entity,e=t.DataType,r="";r=i!=""?i+"."+t.DisplayName:t.DisplayName;u=n.getParentEntity();n.AddClsEntity(f,r,u,e)}};n.Navigatetoprevlist=function(){n.lstDisplayEntity.length>1&&(n.lstDisplayEntity.splice(n.lstDisplayEntity.length-1,1),n.lstDisplayEntity[n.lstDisplayEntity.length-1].IsVisible=!0,n.setVisibilityForEntitiesOrDisplayEntities(n.lstEntities,n.lstDisplayEntity[n.lstDisplayEntity.length-1].strID,"Entity"),n.setVisibilityForEntitiesOrDisplayEntities(n.lstdisplayentity,n.lstDisplayEntity[n.lstDisplayEntity.length-1].strDisplayName,"DisplayEntity"),n.CheckForPreDisableAttr(n.lstDisplayEntity[n.lstDisplayEntity.length-1].entity,n.lstdisplayentity[n.lstdisplayentity.length-1].DisplayName))};n.onRefreshAttributes=function(){var f,e,u,c,h,y,l,p,w,a,o,b;if(n.lstEntities&&n.lstEntities.length>0){for(f=i.getEntityIntellisense(),e=0;e<n.lstEntities.length;e++){for(var v=n.lstEntities[e].strEntityId,s=v,r=[];s;)f&&f.length&&(u=f.filter(function(n){return n.ID==s}),u&&u.length>0?(n.showonlycollection!=undefined&&!n.showonlycollection&&u[0].Attributes?(c=[],c=u[0].Attributes.filter(function(n){return n.DataType&&n.DataType!="Collection"&&n.DataType!="List"}),r=r.concat(c)):r=r.concat(u[0].Attributes),s=u[0].ParentId):s="");h=[];y=JSON.stringify(r);r=JSON.parse(y);n.ismainentity&&n.entityname&&f&&(l=f.filter(function(t){return t.ID==n.entityname}),l.length>0&&l[0].ErrorTableName&&(p={ID:"InternalErrors",DisplayName:"InternalErrors",Tooltip:"InternalErrors",IsPrivate:"False",Entity:"entError",Value:"ibusSoftErrors.iclbError",Type:"Collection",DataType:"Collection"},w={ID:"ExternalErrors",DisplayName:"ExternalErrors",Tooltip:"InternalErrors",IsPrivate:"False",Entity:"entError",Value:"ibusSoftErrors.iclbEmployerError",DataType:"Collection",Type:"Collection"},r.push(p),r.push(w)));sortListBasedOnproperty(r,"","ID");h=r;n.lstEntities[e].Attributes=r;n.lstEntities[e].SortedAttributes=h;a=getDisplayedEntity(n.lstdisplayentity);a&&a.strID==v&&(n.selectedentityobjecttreefields=h)}o=n.$new();o.strMessage="Refresh Completed.";n.objEntityFilter&&n.objEntityFilter.EntityTreeFilter&&(n.objEntityFilter.EntityTreeFilter="");o.isError=!0;b=t.showDialog(o,"","StartUp/views/TFSMessageDialog.html");o.OkClick=function(){b.close();n.selectedfield=undefined}}};n.selectField=function(t,i){var u,r;if(n.selectedfield&&!i.ctrlKey?(n.selectedfield.IsRecordSelected=!1,n.ischeckboxvisible||(n.selectedfield.IsSelected="False")):n.selectedfield&&(u=n.RemoveOrIsFieldPresentFromOtherSelectedField(n.selectedfield,"bool"),u||n.otherSelectedField.push(n.selectedfield),n.selectedfield=undefined),i.ctrlKey||(n.selectedfield=t,n.selectedfield.IsRecordSelected=!0),i&&(i.stopPropagation(),i.stopImmediatePropagation()),!n.ischeckboxvisible)if(i.ctrlKey)t.IsRecordSelected?(t.IsRecordSelected=!1,t.IsSelected="False",n.RemoveOrIsFieldPresentFromOtherSelectedField(t,"Delete")):(t.IsRecordSelected=!0,t.IsSelected="True",n.otherSelectedField.push(t));else{for(r=0;r<n.otherSelectedField.length;r++)n.otherSelectedField[r].IsRecordSelected=!1,n.otherSelectedField[r].IsSelected="False";n.otherSelectedField=[];t.IsRecordSelected=!0;t.IsSelected="True"}};n.RemoveOrIsFieldPresentFromOtherSelectedField=function(t,i){for(var u=!1,r=0;r<n.otherSelectedField.length;r++)if(n.otherSelectedField[r].ID==t.ID){i=="Delete"?n.otherSelectedField.splice(r,1):i=="bool"&&(u=!0);break}return u};n.sortList=function(t,i){var r,l;if(i!=""){var f=[],e=[],o=[],s=[],h=[],c=[],u="ID";for(n.showvalueofcolumn&&(u="Value"),r=0;r<t.Attributes.length;r++)t.Attributes[r][u]==i?f.push(t.Attributes[r]):t.Attributes[r][u]&&i&&t.Attributes[r][u].toLowerCase()==i.toLowerCase()?e.push(t.Attributes[r]):t.Attributes[r][u]&&t.Attributes[r][u].indexOf(i)==0?o.push(t.Attributes[r]):t.Attributes[r][u]&&i&&t.Attributes[r][u].toLowerCase().indexOf(i.toLowerCase())==0?s.push(t.Attributes[r]):t.Attributes[r][u]&&t.Attributes[r][u].contains(i)?h.push(t.Attributes[r]):t.Attributes[r][u]&&i&&t.Attributes[r][u].toLowerCase().contains(i.toLowerCase())&&c.push(t.Attributes[r]);l=f.concat(e).concat(o).concat(s).concat(h).concat(c);t.SortedAttributes=l;n.objEntityFilter.LimitCount=n.showonlycollection||n.showonlyobject||n.showonlycolumns||n.showcolumndescription?t.Attributes.length:50}else t.SortedAttributes=t.Attributes,n.objEntityFilter.LimitCount=n.showonlycollection||n.showonlyobject||n.showonlycolumns||n.showcolumndescription?t.Attributes.length:50};n.AddIntoSelectedList=function(t){var r,u,f,i;if(n.ischeckboxvisible&&(r=getDisplayedEntity(n.lstdisplayentity),u=r.strDisplayName,fieldName=t.ID,u!=""&&(fieldName=u+"."+t.ID),n.lstselectedmultiplelevelfield))if(t.IsSelected=="True")f={EntityField:fieldName,FieldObject:t,Entity:r.strID},n.lstselectedmultiplelevelfield.push(f);else for(i=0;i<n.lstselectedmultiplelevelfield.length;i++)if(n.lstselectedmultiplelevelfield[i].EntityField==fieldName){n.lstselectedmultiplelevelfield.splice(i,1);break}};n.NavigateToEntity=function(i){i&&(n.isallownavigation===undefined||n.isallownavigation===!0)&&hubMain.server.navigateToFile(i,"").done(function(n){t.openFile(n,undefined)})}},templateUrl:"Common/views/EntityTreeListTemplate.html"}}]);app.directive("checkboxdirective",[function(){return{restrict:"A",scope:{attributefield:"=",lstdisplayentity:"=",lstselectedmultiplelevelfield:"="},link:function(n,t){var i=t[0];n.InitSelectedField=function(t,i){var f,u,r;if(n.lstselectedmultiplelevelfield)if(f=getDisplayedEntity(n.lstdisplayentity),u=f.strDisplayName,fieldName=t.ID,u!=""&&(fieldName=u+"."+t.ID),t.DataType!="Object"&&t.DataType!="Collection"&&t.DataType!="CDOCollection"&&t.DataType!="List"){for(r=0;r<n.lstselectedmultiplelevelfield.length;r++)if(n.lstselectedmultiplelevelfield[r].EntityField==fieldName){t.IsSelected="True";break}}else t.DataType=="Object"&&n.setValueToLoadedField(fieldName,i)};n.setValueToLoadedField=function(t,i){for(var r=0;r<n.lstselectedmultiplelevelfield.length;r++)if(n.lstselectedmultiplelevelfield[r].EntityField.contains(t)){i.indeterminate=!0;break}};n.lstselectedmultiplelevelfield&&n.InitSelectedField(n.attributefield,i)}}}]);app.directive("entitytreescroll",[function(){return{restrict:"A",link:function(n,t){var i=t[0];t.bind("scroll",function(){var t=i.scrollTop+i.offsetHeight-i.scrollHeight;(i.scrollTop+i.offsetHeight==i.scrollHeight||t>-5&&t<5)&&(i.scrollHeight=i.scrollTop+i.scrollHeight,n.$apply(function(){n.FormModel&&n.FormModel.IsLookupCriteriaEnabled?n.ColumnsLimitCount+=10:n.objEntityFilter?n.objEntityFilter.LimitCount+=10:n.objBusinessObjectFilter&&(n.objBusinessObjectFilter.LimitCount+=10)}))})}}}]);app.directive("entityobjectchildtreetemplate",["$compile",function(){return{restrict:"A",replace:!0,scope:!1,templateUrl:"Common/views/EntityTreeTemplate.html"}}]);app.directive("entitytreefielddraggable",[function(){return{restrict:"A",scope:{dragdata:"=",dragobject:"="},link:function(n,t){function r(t){dragDropData=null;dragDropDataObject=null;t.dataTransfer.effectAllowed="move";t.dataTransfer.setData("Text","");n.dragdata&&(dragDropData=n.dragdata,dragDropDataObject=n.dragobject)}var i=t[0];i.draggable=!0;i.addEventListener("dragstart",r,!1)}}}]);app.directive("entitytreefielddroppable",["$rootScope",function(){return{restrict:"A",scope:{dropdata:"=",fieldname:"="},link:function(n,t){function r(n){n.preventDefault&&n.preventDefault();n.dataTransfer.dropEffect="move";n.dataTransfer.setData("Text","");n.preventDefault()}function u(t){var o=t.dataTransfer.getData("Text"),i,r;if(t.stopPropagation&&t.stopPropagation(),o==""&&lstEntityTreeFieldData!=null){t.preventDefault();var f=lstEntityTreeFieldData,u=f[0],e=f[1];e!=""&&(u=e+"."+u);dragDropData=u;i=dragDropData;i!=undefined&&i!=null&&i!=""&&n.dropdata&&n.$apply(function(){n.dropdata[n.fieldname]=i});lstEntityTreeFieldData=null;dragDropData=null}else dragDropData&&(r=dragDropData,r!=undefined&&r!=null&&r!=""&&n.dropdata&&n.$apply(function(){n.dropdata[n.fieldname]=r}),dragDropData=null),lstEntityTreeFieldData=null,t&&t.preventDefault&&t.preventDefault()}function f(){}var i=t[0];i.addEventListener("dragover",r,!1);i.addEventListener("drop",u,!1);i.addEventListener("dragleave",f,!1)}}}]);app.directive("contentEditable",["$parse","$compile","$rootScope",function(n,t,i){return{restrict:"A",scope:{model:"=",propertyname:"="},require:"ngModel",link:function(t,r,u,f){function v(){f.$setViewValue(r.text())}var e=u.ngModel,l=u.model,o,s=t.propertyname,h,c,a;e&&l&&e.match("^"+l)&&(s=e.substring(l.length+1,e.length));a=t.$watch("model",function(n){n&&(o=getPropertyValue(t.model,s),i.currentopenfile&&i.currentopenfile.file&&i.currentopenfile.file.FileName&&(c=i.currentopenfile.file.FileName,h=getScopeByFileName(c)),a())});f.$render=function(){r.text(f.$viewValue||"")};t.$watch(u.ngModel,function(){f.$viewValue&&(f.$viewValue=f.$viewValue.trim())});t.$on("UpdateOnClick",function(n,i){angular.equals(i,r[0])&&t.valueChange(r.text())});t.valueChange=function(n){f.$setViewValue(n)};r.bind("keyup",function(){var l,a,y,p,w,b,e,f,r;t.$parent.$apply(v);u.descriptionKeydown&&t.$parent.$apply(u.descriptionKeydown);u.loopCollectionKeydown&&(l=n(u.loopCollectionKeydown),l(t.$parent,{$event:event}),t.$parent.$apply());u.actionKeydown&&(a=n(u.actionKeydown),a(t.$parent,{$event:event}),t.$parent.$apply());u.queryidKeydown&&(y=n(u.queryidKeydown),y(t.$parent,{$event:event}),t.$parent.$apply());u.methodnameKeydown&&(p=n(u.methodnameKeydown),p(t.$parent,{$event:event}),t.$parent.$apply());u.ruleidKeydown&&(w=n(u.ruleidKeydown),w(t.$parent,{$event:event}),t.$parent.$apply());u.spanClick&&(b=n(u.spanClick),b(t.$parent,{$event:event}),t.$parent.$apply());u.loopCollectionKeydown&&t.$apply(u.loopCollectionKeydown);e=getPropertyValue(t.model,s);o!=e&&c!=undefined&&(f=i.GetSessionStorageObject(c),f&&(f.RedoList=[],r={},r.operation="Edit",r.value=o,r.model=t.model,r.propname=s,f.UndoList.push(r),o=e,h&&(h.isDirty||(h.isDirty=!0))))});r.bind("keydown",function(n){n.keyCode==$.ui.keyCode.ENTER&&n.preventDefault()})}}}]);app.directive("commonTreeDirective",[function(){return{restrict:"E",replace:!0,scope:{collection:"=",childCollectionProperty:"=",textProperty:"=",expandedProperty:"=",onitemdblclickCallback:"=",onitemclickCallback:"="},link:function(n){n.getPropertyValue=getPropertyValue;n.onItemDoubleClick=function(t,i){if(n.onitemdblclickCallback)n.onitemdblclickCallback(t,i)};n.onItemClick=function(t,i){if(n.selectedItem=i,n.onitemclickCallback)n.onitemclickCallback(i,t)};n.toggleExpandCollapse=function(t,i){setPropertyValue(i,n.expandedProperty,!n.getPropertyValue(i,n.expandedProperty))};n.getPropertyValue=getPropertyValue},templateUrl:"Common/views/CommonTreeTemplate.html"}}]);app.directive("commonTreeChildDirective",[function(){return{restrict:"A",replace:!0,scope:!1,templateUrl:"Common/views/CommonTreeItemsTemplate.html"}}]);app.directive("ruleitemcommontemplate",["$compile","$http","$rootScope",function(){return{restrict:"E",replace:!0,scope:{model:"=",iscontroldisable:"="},link:function(){},templateUrl:function(n,t){return t.templateUrl||"Form/views/RuleItemCommonTemplate.html"}}}]);app.directive("undoredodirective",["$parse","$compile","$rootScope",function(n,t,i){return{restrict:"A",scope:{model:"=",propertyname:"=",undorelatedfunction:"="},link:function(n,t,r){var u="",f="",o,e,s=n.$watch("model",function(t){if(t){var h=r.ngModel,c=r.model;u=n.propertyname;!u&&h&&c&&h.match("^"+c)&&(u=h.substring(c.length+1,h.length));n.model&&(f=getPropertyValue(n.model,u));i.isConfigureSettingsVisible?o="SettingsPage":i.currentopenfile&&i.currentopenfile.file&&(o=i.currentopenfile.file.FileName);e=getCurrentFileScope();s()}});t.bind("focus",function(){n.model&&(f=getPropertyValue(n.model,u))});r.type=="checkbox"||r.type=="radio"?t.bind("click",function(){var s=getPropertyValue(n.model,u),r,t;f!=s&&(r=i.GetSessionStorageObject(o),r&&(r.RedoList=[],t={},t.operation="Edit",t.value=f,t.model=n.model,t.propname=u,i.$evalAsync(function(){r.UndoList.push(t)}),f=s,e&&(e.isDirty||(e.isDirty=!0))))}):t.bind("change",function(){var s=getPropertyValue(n.model,u),r,t;f!=s&&(r=i.GetSessionStorageObject(o),r&&(r.RedoList=[],t={},t.operation="Edit",t.value=f,t.model=n.model,t.propname=u,t.undorelatedfunction=n.undorelatedfunction,i.$evalAsync(function(){r.UndoList.push(t)}),f=s,e&&(e.isDirty||(e.isDirty=!0))))})}}}]);app.directive("datepicker",[function(){return{restrict:"A",link:function(n,t){t.datepicker({dateFormat:"m/d/yy",onClose:function(){$("#tbDescription").focus()},autoclose:!0})}}}]);app.directive("editableRow",["$compile",function(n){return{restrict:"A",link:function(t,i,r){var e,o,f,s,u;r&&r.editTemplateUrl&&r.readOnlyTemplateUrl?(t.isEditable=!1,e=getHtmlFromServer(r.readOnlyTemplateUrl),e?(o=getHtmlFromServer(r.editTemplateUrl),o?($(i).keyup(function(n){n.keyCode!=27||!t.isEditable||r.alwaysReadOnly===!0||r.alwaysReadOnly==="true"||t.setRowContentReadOnly()}),$(i).dblclick(function(){t.isEditable||r.alwaysReadOnly===!0||r.alwaysReadOnly==="true"||t.setRowContentEditable()}),$(i).click(function(){t.resetAllButThis()}),t.addActionButton=function(n){var u,f;r.alwaysReadOnly===!0||r.alwaysReadOnly==="true"||(u=$("<i style='cursor:pointer'><\/i>"),n=="edit"?(u.addClass("fa fa-edit"),u.click(function(){t.setRowContentEditable()})):(u.addClass("fa fa-close"),u.click(function(){t.setRowContentReadOnly()})));f=$("<td><\/td>");r.alwaysReadOnly===!0||r.alwaysReadOnly==="true"||f.append(u);$(i).append(f)},t.resetAllButThis=function(){for(var n,r=$(i).siblings(),t=0;t<r.length;t++)n=angular.element($(r[t])).scope(),n&&(n.isEditable===!0||n.isEditable==="true")&&n.setRowContentReadOnly&&n.setRowContentReadOnly()},t.setRowContentEditable=function(n){t.isEditable=!0;t.setRowContent(o);r&&(r.showEditButton===!0||r.showEditButton==="true")&&t.addActionButton("cancel",!n);t.compileContent()},t.setRowContentReadOnly=function(n){t.isEditable=!1;t.setRowContent(e);r&&(r.showEditButton===!0||r.showEditButton==="true")&&t.addActionButton("edit",!n);t.compileContent()},t.setRowContent=function(n){$(i).html(n)},t.compileContent=function(){n($(i).contents())(t)},r&&(r.isNew===!0||r.isNew==="true")?t.setRowContentEditable(!0):t.setRowContentReadOnly(!0),r&&(r.showEditButton===!0||r.showEditButton==="true")&&($(i).closest("table").find("thead tr").length>1?(u=$(i).closest("table").find("thead tr[role='columnheader']"),u.find("th").length<$(i).find("td").length&&(f=$(i).closest("table").find("thead tr[role!='columnheader'] th:last-child"),f&&f.length>0&&(s=parseInt(f.attr("colspan"))+1,f.attr("colspan",s.toString())),u.append("<th style='width:35px'>"))):(u=$(i).closest("table").find("thead tr"),u.find("th").length<$(i).find("td").length&&u.append("<th style='width:35px'>")))):console.log("invalid edit template url for the directive.")):console.log("invalid read-only template url for the directive.")):console.log("Please set edit/read-only template url for the directive.")}}}]);app.directive("editablelabletotext",["$compile",function(n){return{restrict:"A",link:function(t,i){var r;t.onChangeHandler=function(){var n=r.val();growtextbox(r,!0,n)};$(i).dblclick(function(){r=$("<input type='text' ng-model='model.dictAttributes.sfwEntityField' ng-change='onChangeHandler()' ng-keydown='onActionKeyDown($event)' class='temptext' undoredodirective model='model' />");i.after(r);n(r)(t);t.model&&t.model.dictAttributes&&t.model.dictAttributes.sfwEntityField&&growtextbox(r,!0,t.model.dictAttributes.sfwEntityField);i.hide();r.blur(function(){i.show();$(this).remove()});r.focus()})}}}]);app.directive("wizardTitleUpdate",["WizardHandler",function(n){return{restrict:"A",link:function(t){t.wizardHandler=n;t.onNext||(t.onNext=function(){var n,i,r;t.setTitle&&(n=t.wizardHandler.wizard().getEnabledSteps(),i=n.indexOf(t.wizardHandler.wizard().currentStep())+1,i>-1&&i<n.length&&(r=n[i].wzTitle,t.setTitle(r)))});t.onPrevious||(t.onPrevious=function(){var n,i,r;t.setTitle&&(n=t.wizardHandler.wizard().getEnabledSteps(),i=n.indexOf(t.wizardHandler.wizard().currentStep())-1,i>-1&&i<n.length&&(r=n[i].wzTitle,t.setTitle(r)))});var i=t.$watchCollection(function(){return t.wizardHandler.wizard().getEnabledSteps()},function(n){if(n&&n.length>0){if(t.setTitle){var r=t.wizardHandler.wizard().currentStep().wzTitle;t.setTitle(r)}i()}})}}}]);app.directive("loadingBox",[function(){return{restrict:"E",scope:{lazymodel:"=",size:"@"},link:function(n,t){var i=n.$watch("lazymodel",function(r){var u='<div class="cs-loader-inner"><div><label>\t●<\/label><label>\t●<\/label><label>\t●<\/label><label>\t●<\/label><label>\t●<\/label><label>\t●<\/label><\/div><\/div>';n.size&&n.size=="xs"&&(u='<div class="cs-loader-inner cs-loader-xs"><div><label>\t●<\/label><label>\t●<\/label><label>\t●<\/label><label>\t●<\/label><label>\t●<\/label><label>\t●<\/label><\/div><\/div>');r==undefined?t.append(u):(t.find(".cs-loader-inner").remove(),i())})}}}]);app.directive("searchSource",["$rootScope","$SearchSource",function(n,t){return{restrict:"E",scope:{SearchSource:"=searchSource"},templateUrl:"Common/views/SearchSourceWrapper.html",link:function(i){i.onsearchtextchange=function(){i.searchtext==""&&(i.SearchSource.searchFindarray=[],i.SearchSource.searchSourceText="")};i.SearchCriteriaChange=function(n){n=n?n:"";i.searchfocus=!0;switch(n.toLowerCase()){case"case":i.SearchSource.IsCaseSensitive=!i.SearchSource.IsCaseSensitive;break;case"word":i.SearchSource.IsWholeMatchWord=!i.SearchSource.IsWholeMatchWord;break;case"regex":i.SearchSource.IsSearchRegex=!i.SearchSource.IsSearchRegex}n&&(i.SearchSource.IsSearchCriteriaChange=!0,i.SearchSourceFind())};i.SearchSourceFind=function(){i.searchfocus=!1;i.searchtext&&(i.SearchSource.searchSourceText!=i.searchtext||i.SearchSource.IsSearchCriteriaChange?(i.SearchSource.IsSearchCriteriaChange=!1,i.SearchSource.searchSourceText=i.searchtext,i.SearchSource.searchFindarray=t.getIndicesOfSearchStr(i.searchtext,i.SearchSource.txtarea[0].value,i.SearchSource.IsCaseSensitive,i.SearchSource.IsWholeMatchWord,i.SearchSource.IsSearchRegex),i.SearchSource.searchFindarray.length>0&&i.SearchSourceMatch(!0)):i.SearchSource.searchFindarray.length-i.SearchSource.searchfindindex>0&&i.SearchSourceMatch(!1,!0))};i.SearchSourceMatch=function(n,r,u){var f=0;n?i.SearchSource.searchfindindex=1:!n&&r?i.SearchSource.searchfindindex+=1:!n&&u&&(i.SearchSource.searchfindindex-=1);f=i.SearchSource.searchfindindex-1;f>=0&&(i.SearchSource.sourceSearchlineno=i.SearchSource.txtarea[0].value.substr(0,i.SearchSource.IsSearchRegex?i.SearchSource.searchFindarray[f].startPos:i.SearchSource.searchFindarray[f]).split("\n").length,t.selectword(i.SearchSource.txtarea,i.SearchSource.IsSearchRegex?i.SearchSource.searchFindarray[f].startPos:i.SearchSource.searchFindarray[f],i.SearchSource.IsSearchRegex?i.SearchSource.txtarea[0].value.substring(i.SearchSource.searchFindarray[f].startPos,i.SearchSource.searchFindarray[f].endPos):i.SearchSource.searchSourceText,i.SearchSource.sourceSearchlineno),scrollTextArea(i.SearchSource.txtarea,i.SearchSource.sourceSearchlineno,i.SearchSource.searchSourceText))};i.CloseSearchSource=function(){i.SearchSource.IsCaseSensitive=!1;i.SearchSource.IsWholeMatchWord=!1;i.SearchSource.IsSearchRegex=!1;i.SearchSource.searchFindarray=[];i.SearchSource.searchSourceText="";i.SearchSource.IsEnable=!1;i.SearchSource.txtarea.focus()};i.SearchSource.txtarea[0].onkeydown=function(n){n.ctrlKey&&n.keyCode==70&&(i.$evalAsync(function(){i.SearchSource.IsEnable=!0}),i.SearchSourceFindBySelection(),n.preventDefault());n.shiftKey&&n.keyCode==114?(i.SearchSource.searchfindindex-1>0&&i.SearchSourceMatch(!1,!1,!0),n.preventDefault()):n.keyCode==114&&(i.SearchSource.searchFindarray.length-i.SearchSource.searchfindindex>0&&i.SearchSourceMatch(!1,!0),n.preventDefault())};i.inputKeydownCallback=function(n){var t=n.which?n.which:n.keyCode;t==13&&(i.SearchSourceFind(),n.preventDefault())};i.inputpasteCallback=function(n){setTimeout(function(){i.searchtext=n.target?n.target.value:"";i.searchtext&&i.SearchSourceFind()},0)};i.SearchSourceFindBySelection=function(){typeof i.SearchSource.txtarea[0].selectionStart=="number"&&typeof i.SearchSource.txtarea[0].selectionEnd=="number"&&i.SearchSource.txtarea[0].selectionStart<i.SearchSource.txtarea[0].selectionEnd&&(i.searchtext=i.SearchSource.txtarea[0].value.substring(i.SearchSource.txtarea[0].selectionStart,i.SearchSource.txtarea[0].selectionEnd),i.SearchSourceFind())};i.init=function(){i.inputelement=$("#"+n.currentopenfile.file.FileName+" .searchSource").find("input[type='text']").focus();i.inputelement.focus();i.SearchSourceFindBySelection()};i.init()}}}]);app.directive("extraFieldDirective",["$rootScope","$filter",function(n,t){return{restrict:"E",scope:{extraFieldModel:"=",showExtraFieldsTab:"=isTab",objFn:"=",formName:"=",isCretaeNewObjectSteps:"=isSteps",closeWizardFn:"=",validateFn:"="},templateUrl:"Common/views/ExtraFieldsOnDetails.html",link:function(i){var f,r,u;i.objExtraFields=[];i.ID=undefined;i.onFormChange=function(){i.extraFields=[];i.objExtraFields=[];hubMain.server.getExtraSettingsModel().done(function(n){i.$apply(function(){if(n){var r=n;r&&r.Elements&&(i.extraFields=t("filter")(r.Elements,{Name:i.formName})[0],i.extraFields&&i.extraFields.Elements&&i.extraFields.Elements.length>0?(i.showExtraFieldsTab=!0,i.objFn&&i.objFn.showExtraFields&&i.objFn.showExtraFields(!0),i.init()):(i.showExtraFieldsTab=!1,i.objFn&&i.objFn.showExtraFields&&i.objFn.showExtraFields(!1)))}})})};i.init=function(){i.createExtraFieldList()};i.createExtraFieldList=function(n){var r,t,e,o,u,h,s;if(n&&(i.extraFieldModel=n),i.extraFields!=undefined&&i.extraFields.Elements){for(i.objExtraFields=[],r=0;r<i.extraFields.Elements.length;r++)if(i.extraFields.Elements[r].dictAttributes.value){if(t={ID:i.extraFields.Elements[r].dictAttributes.value,Description:i.extraFields.Elements[r].dictAttributes.Description,ControlType:i.extraFields.Elements[r].dictAttributes.ControlType,Children:[],IsRequired:i.extraFields.Elements[r].dictAttributes.IsRequired},t.Value=f(t.ID),t.ControlType=="HyperLink"&&(t.URL=undefined,i.extraFieldModel))for(e=0;e<i.extraFieldModel.Elements.length;e++)if(i.extraFieldModel.Elements[e].dictAttributes.ID==t.ID){t.URL=i.extraFieldModel.Elements[e].dictAttributes.URL;break}if(i.extraFields.Elements[r].Elements.length>0)for(o=0;o<i.extraFields.Elements[r].Elements.length;o++){if(u={ID:i.extraFields.Elements[r].Elements[o].dictAttributes.Text,Description:i.extraFields.Elements[r].Elements[o].dictAttributes.Description},t.ControlType=="CheckBoxList"){if(t.Value!=undefined)for(h=t.Value.split(","),s=0;s<h.length;s++)u.ID==h[s]&&(u.Value="True")}else u.ID==t.Value?(u.Value=!0,i.ID=t.Value):u.Value=!1;t.Children.push(u)}i.objExtraFields.push(t)}i.objExtraFields&&i.objExtraFields.length<=0&&(i.showExtraFieldsTab=!1)}};f=function(n){if(i.extraFieldModel)for(var t=0;t<i.extraFieldModel.Elements.length;t++)if(i.extraFieldModel.Elements[t].dictAttributes.ID==n)return i.extraFieldModel.Elements[t].dictAttributes.Value};i.selectExtraFieldRow=function(n){i.SelectExtraFieldRow=n};i.AddHyperLinkUrl=function(t){var r=i.$new(),u;r.oldData={};r.currentobjHyperLink=t;u=JSON.stringify(t);r.objHyperLink=JSON.parse(u);r.oldData.url=r.objHyperLink.URL;r.oldData.value=r.objHyperLink.Value;r.validateHyperLink=function(){if(r.EntityDetailsHyperlinkErrorMessage=undefined,r.objHyperLink.Value==undefined||r.objHyperLink.Value=="")return r.EntityDetailsHyperlinkErrorMessage="Error: Enter the Description.",!0;if(r.objHyperLink.URL==undefined)return r.EntityDetailsHyperlinkErrorMessage="Error: Invalid Hyperlink URL.",(r.currentobjHyperLink.IsRequired=="True"||r.currentobjHyperLink.IsRequired==!0)&&(r.EntityDetailsHyperlinkErrorMessage="Error: Invalid Hyperlink URL."),!0;var n=r.objHyperLink.URL.match(new RegExp(/^http(s)?:\/\/(www\.)?[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?/));if(n==null)return r.EntityDetailsHyperlinkErrorMessage="Error: Invalid Hyperlink URL.",(r.currentobjHyperLink.IsRequired=="True"||r.currentobjHyperLink.IsRequired==!0)&&(r.EntityDetailsHyperlinkErrorMessage="Error: Invalid Hyperlink URL."),!0};r.closeEntityDetailsHyperlink=function(){for(var n=0;n<i.objExtraFields.length;n++)i.objExtraFields[n].ID==r.currentobjHyperLink.ID&&(r.currentobjHyperLink.URL=r.objHyperLink.URL,r.currentobjHyperLink.Value=r.objHyperLink.Value);r.dialog.close()};r.cancelHyperlinkDialog=function(){r.objHyperLink.URL=r.oldData.url;r.objHyperLink.Value=r.oldData.value;r.dialog.close()};r.dialog=n.showDialog(r,"Add Hyperlink Url","Entity/views/AddHyperLinkUrl.html",{width:400,height:500})};i.objFn&&(i.objFn.getExtraFieldData=function(){return i.objExtraFields},i.objFn.prepareExtraFieldData=function(){for(var t,r,n=0;n<i.objExtraFields.length;n++)(i.objExtraFields[n].ControlType=="TextBox"||i.objExtraFields[n].ControlType=="CheckBox"||i.objExtraFields[n].ControlType=="ComboBox")&&i.updateExtraFieldValue(i.objExtraFields[n]),i.objExtraFields[n].ControlType=="CheckBoxList"&&i.updateExtraFieldValue(i.objExtraFields[n]),i.objExtraFields[n].ControlType=="HyperLink"&&i.updateExtraFieldHyperLinkValue(i.objExtraFields[n]);if(i.extraFieldModel&&i.extraFieldModel.Elements&&i.extraFieldModel.Elements.length>0){for(r=[],n=0;n<i.extraFieldModel.Elements.length;n++)t={},t.ID=i.extraFieldModel.Elements[n].dictAttributes.ID,t.Value=i.extraFieldModel.Elements[n].dictAttributes.Value,t.URL=i.extraFieldModel.Elements[n].dictAttributes.URL,r.push(t);i.newExtraFieldModel=r}},i.objFn.getNewExtraFieldData=function(){return i.newExtraFieldModel},i.objFn.validateExtraFieldsData=function(){var r,n,u,t;for(i.extraFieldsErrorMessage=undefined,r=!1,n=0;n<i.objExtraFields.length;n++)if(i.objExtraFields[n].IsRequired!=undefined&&(i.objExtraFields[n].IsRequired=="True"||i.objExtraFields[n].IsRequired==!0)&&!i.objExtraFields[n].Value){if(i.extraFieldsErrorMessage="Error: Enter the Extra Field Value for the Field "+i.objExtraFields[n].ID,r=!1,i.objExtraFields[n].ControlType=="ComboBox"){for(t=0;t<i.objExtraFields[n].Children.length;t++)i.objExtraFields[n].Children[t].Value!=undefined&&i.objExtraFields[n].Children[t].Value!=""&&(r=!0,i.extraFieldsErrorMessage=undefined);if(r==!1)return i.extraFieldsErrorMessage="Error: Enter the Extra Field Value for the Field "+i.objExtraFields[n].ID,!0}if(i.objExtraFields[n].ControlType=="CheckBoxList"){for(u=!1,t=0;t<i.objExtraFields[n].Children.length;t++)i.objExtraFields[n].Children[t].Value!=undefined&&i.objExtraFields[n].Children[t].Value!=""&&(u=!0,r=!0,i.extraFieldsErrorMessage=undefined);if(u==!1)return i.extraFieldsErrorMessage="Error: Enter the Extra Field Value for the Field "+i.objExtraFields[n].ID,!0}if(r==!1)return!0}},i.objFn.checkVisibility=function(){return i.showExtraFieldsTab},i.objFn.resetExtraField=function(n){i.createExtraFieldList(n)});i.updateExtraFieldValue=function(t){var o=!1,f,s,e;if(i.extraFieldModel&&i.extraFieldModel.Elements&&i.extraFieldModel.Elements.length>0)for(f=0;f<i.extraFieldModel.Elements.length;f++)i.extraFieldModel.Elements[f]&&i.extraFieldModel.Elements[f].dictAttributes.ID==t.ID&&(s=t.ControlType=="CheckBoxList"?u(t):r(t),n.EditPropertyValue(i.extraFieldModel.Elements[f].dictAttributes.Value,i.extraFieldModel.Elements[f].dictAttributes,"Value",s.dictAttributes.Value),o=!0);o==!1&&(t.ControlType=="CheckBoxList"?(e=u(t),n.PushItem(e,i.extraFieldModel.Elements)):t.Value!=undefined&&(e=r(t),n.PushItem(e,i.extraFieldModel.Elements)))};i.updateExtraFieldHyperLinkValue=function(t){var f=!1,u,r;if(i.extraFieldModel&&i.extraFieldModel.Elements)for(u=0;u<i.extraFieldModel.Elements.length;u++)i.extraFieldModel.Elements[u].dictAttributes.ID==t.ID&&(r={Name:"ExtraField",dictAttributes:{},Elements:[]},r.dictAttributes.ID=t.ID,t.Value!=undefined&&(r.dictAttributes.Value=t.Value),t.URL!=undefined&&(r.dictAttributes.URL=t.URL),n.EditPropertyValue(i.extraFieldModel.Elements[u].dictAttributes.Value,i.extraFieldModel.Elements[u].dictAttributes,"Value",r.dictAttributes.Value),n.EditPropertyValue(i.extraFieldModel.Elements[u].dictAttributes.URL,i.extraFieldModel.Elements[u].dictAttributes,"URL",r.dictAttributes.URL),f=!0);f==!1&&(r={Name:"ExtraField",dictAttributes:{},Elements:[]},r.dictAttributes.ID=t.ID,t.Value!=undefined&&(r.dictAttributes.Value=t.Value),t.URL!=undefined&&(r.dictAttributes.URL=t.URL),n.PushItem(r,i.extraFieldModel.Elements))};r=function(n){var t={Name:"ExtraField",dictAttributes:{},Elements:[]};return t.dictAttributes.ID=n.ID,n.Value&&(t.dictAttributes.Value=n.Value),t};u=function(n){for(var i,r="",u=0,t=0;t<n.Children.length;t++)n.Children[t].Value=="True"&&(r+=u==0?n.Children[t].ID:","+n.Children[t].ID,u++);return i={Name:"ExtraField",dictAttributes:{},Elements:[]},i.dictAttributes.ID=n.ID,r!=""&&(i.dictAttributes.Value=r),i};i.CloseWizard=function(){i.closeWizardFn()};i.$watch("formName",function(n){n&&i.onFormChange()})}}}]);app.directive("searchDesign",["hubcontext","$timeout","$searchQuerybuilder","$rootScope","$searchFindReferences","$interval",function(n,t,i,r,u,f){return{restrict:"E",scope:{toggleDesign:"&",traverseModel:"&",currentfile:"=currentFile",selectElementCallback:"&selectElement",mainModel:"="},templateUrl:"Common/views/SearchDesignWrapper.html",link:function(e,o){e.deHighlightDesign=function(n){n&&n.length>0&&n.forEach(function(n){n.Objhighlight&&n.Objhighlight.length>0&&e.toggleDesign({items:n.Objhighlight,IsAction:!1})})};e.highlightDesign=function(n){var t=[];return n.FileInfo.SelectNodePath!=null&&n.FileInfo.SelectNodePath.length>1&&(t=e.currentfile.FileType=="DecisionTable"?e.traverseModel({path:n.FileInfo.SelectNodePath,strPath:n.ParentPath}):e.traverseModel({path:n.FileInfo.SelectNodePath}),t.length>0&&e.toggleDesign({items:t,IsAction:!0})),t};e.SearchInDesign=function(){r.IsLoading=!0;n.hubSearch.server.getFindAdvanceDesign(e.DesignSearch.SearchObj,e.currentfile).done(function(n){e.deHighlightDesign(e.DesignSearch.HighLightList);e.$evalAsync(function(){r.IsLoading=!1;e.DesignSearch.findSearchList=n;e.queryBuilder.getGlobalQueryBuilder.isAdvanceSearch&&angular.forEach(e.DesignSearch.findSearchList,function(n){var t=new e.HighLightObj;t.path=n.FileInfo.SelectNodePath;t.Objhighlight=e.highlightDesign(n);e.DesignSearch.HighLightList.push(t)});n.length>0&&e.selectElement(n[0]);e.queryBuilder.setQueryBuilderIsAdvanceOption(!0)})})};e.selectElement=function(n){e.DesignSearch.SelectNodePath=n.FileInfo.SelectNodePath;e.currentfile.FileType=="DecisionTable"?e.selectElementCallback({path:n.ParentPath,strPath:n.FileInfo.SelectNodePath}):e.selectElementCallback({path:n.FileInfo.SelectNodePath})};e.ClearSearchDesign=function(){e.deHighlightDesign(e.DesignSearch.HighLightList);e.init()};e.HighLightObj=function(){return{path:"",Objhighlight:{}}};e.initAdvance=function(){e.queryBuilder.getGlobalQueryBuilder.lstFilter.length>0&&(e.DesignSearch||(e.DesignSearch={},e.DesignSearch.HighLightList=[],e.DesignSearch.SearchObj=[]),r.IsLoading=!0,e.DesignSearch.IsOpen=e.queryBuilder.getGlobalQueryBuilder.isAdvanceSearch?!0:!1,angular.copy(e.queryBuilder.getGlobalQueryBuilder.lstFilter,e.DesignSearch.SearchObj),e.queryBuilder.setGlobalQueryBuilderFilters([]),e.SearchInDesign())};e.init=function(){var n,r;e.queryBuilder=i;e.searchFindReferences=u.getData;e.queryBuilder.getGlobalQueryBuilder.lstFilter.length<=0&&(r=e.DesignSearch&&e.DesignSearch.IsOpen&&e.queryBuilder.getGlobalQueryBuilder.isAdvanceSearch?!0:!1,e.DesignSearch={},e.DesignSearch.IsOpen=r?!0:!1,e.DesignSearch.SearchObj=[],e.DesignSearch.HighLightList=[],t(e.queryBuilder.AddsearchQuerybuilderObj(e.DesignSearch.SearchObj),1e3));n=e.$watch(function(){return e.searchFindReferences.activeReference},function(n){if(n&&(!u.getData.activeReference||u.getData.activeReference.FileInfo.FileName==e.currentfile.FileName)){var t;if(u.getData.lstReferences.length>0&&u.getData.activeReference&&u.getData.activeReference.FileInfo.FileName==e.currentfile.FileName){function n(){if(e.mainModel){f.cancel(t);var n=angular.copy(u.getData.activeReference);u.setData(null,null,null);e.selectElement(n)}}t=f(n,1e3)}}},!0);o.on("$destroy",function(){n()})};e.init()}}}]);app.directive("displayErrors",["$compile","$ValidationService","$timeout",function(n,t,i){return{restrict:"A",scope:{currObj:"="},link:function(r){r.showErrors=function(t){$(".duplicate-id-tooltip").remove();var u='<div ng-if="currObj.errors" class="duplicate-id-tooltip"> <ul class="list-unstyled" margin-bottom: 0px!important;> <li ng-repeat="(property, value) in currObj.errors"> <span error="{{value}}"><\/span> <\/li> <\/ul> <\/div>';$("body").append(n(u)(r));i(function(){var n=$(".duplicate-id-tooltip");n.length>0&&n.show();var r=t.pageX,u=t.pageY,f=$(window).width(),e=$(window).height(),i=n[0].getBoundingClientRect();r+i.width>=f&&(r-=i.width);u+i.height>=e&&(u-=i.height);n.css({display:"block",left:r+"px",top:u+"px","z-index":1e4})})};r.isEmpty=function(n){return t.isEmptyObj(n)}},template:function(){return['<span class="info-tooltip error-mark" ng-click="showErrors($event)" ng-if="isEmpty(currObj.errors)" style="color:red !important"><i class="fa fa-exclamation-circle" aria-hidden="true"><\/i><\/span>']}}}]);app.directive("showErrors",["$ValidationService",function(n){return{restrict:"A",scope:{model:"="},link:function(t){t.getErrorMessages=function(n){var r="",u,i;for(u in n)i=n[u],i&&angular.isObject(i)&&(i=t.getErrorMessages(i)),r+=i+"\n";return r};t.isEmpty=function(t){return n.isEmptyObj(t)}},template:function(){return["<span class='error-mark' ng-if='isEmpty(model.errors)' ng-attr-title='{{ getErrorMessages(model.errors) }}' style='color:red!important'><i class='fa fa-exclamation-circle' aria-hidden='true'><\/i> <\/span>"]}}}]);app.directive("showErrorMessage",["$ValidationService",function(){return{restrict:"A",scope:{model:"=",prefix:"="},link:function(n){n.getErrorMessages=function(t){var u="",r,i;for(r in t)i=t[r],i&&angular.isObject(i)&&(i=n.getErrorMessages(i)),r&&r.startsWith(n.prefix)&&(u+=i+"\n");return u};n.isEmpty=function(t){var i=!1;for(var r in t)r&&r.startsWith(n.prefix)&&(i=!0);return i}},template:function(){return["<span class='info-tooltip' ng-if='isEmpty(model.errors)' ng-attr-title='{{ getErrorMessages(model.errors) }}' style='color:red!important'><i class='fa fa-exclamation-circle' aria-hidden='true'><\/i> <\/span>"]}}}]);app.directive("numbersOnly",function(){return{link:function(n,t,i){var r=["em","ex","%","px","cm","mm","in","pt","pc","ch","rem","vh","vw","vmin","vmax"];t.on("keydown keyup",function(n){var r=$(n.target),t,u;if(t=r.val(),u=n.keyCode?n.keyCode:n.which,u==$.ui.keyCode.SPACE)return!1;i.postfix&&t==i.postfix&&(t="",r.val(t));t});t.on("blur",function(u){var e=$(u.target),s=e.val(),f,o;i.postfix&&(f=n.filterInput(e),o=r.some(function(n){if(f.unit&&f.unit.toLowerCase()==n.toLowerCase())return!0}),!o&&e[0].value&&f.number&&!isNaN(f.number)?e[0].value=f.number+"px":f.number||(e[0].value=""),t.trigger("change"))});t.on("paste",function(n){n.preventDefault()});n.filterInput=function(n){var r={number:"",unit:""},i,t,u;if(n&&n[0].value&&(i=n[0].value,i=i.split(""),t=0,u=!0,angular.isArray(i))){while(t<i.length){if(u&&i[t]=="."){u=!1;t++;continue}if(isNaN(i[t]))break;t++}r.number=n[0].value.substring(0,t);r.unit=n[0].value.substring(t,n[0].value.length)}return r}}}});app.directive("findReferencebox",[function(){return{restrict:"E",templateUrl:"Common/views/FindReferenceBox.html"}}]);app.directive("keyUpDownWithElement",[function(){return{scope:{callbackfn:"=",objproperty:"=",property:"=",propvalue:"=",parentelem:"=",isscroll:"=",requireEvent:"="},link:function(n,t){t.on("keydown",function(i){var u,r;(n.currentEvent=i,n.nextElement=null,u=!1,$(".ui-autocomplete").each(function(){var n=$(this).css("display");n=="block"&&(u=!0)}),u)||(r=t,n.parentelem&&(r=$(r).parents(n.parentelem).first()),i.keyCode==$.ui.keyCode.UP?(n.findNextItem(r,"UP"),i.preventDefault()):i.keyCode==$.ui.keyCode.DOWN&&(n.findNextItem(r,"DOWN"),i.preventDefault()))});n.findNextItem=function(t,i){var r=null,u=null,e=t,o,f;($(e).find("input:focus").blur(),i=="UP"?(r=$(e).prevAll(":visible:first"),r.length<=0&&(r=$(e).prev())):i=="DOWN"&&(r=$(e).nextAll(":visible:first"),r.length<=0&&(r=$(e).next())),r.length<=0)||(n.parentelem?(o=r.find("[key-up-down-with-element]"),o.focus()):r.focus(),u=angular.element(r).scope(),r.is("[ng-if]")&&u&&(u=u.$parent),u&&u.hasOwnProperty(n.objproperty)&&(f=u[n.objproperty],f&&f.dictAttributes&&f.dictAttributes.hasOwnProperty(n.property)&&f.dictAttributes[n.property]==n.propvalue?n.findNextItem(r,i):(n.nextElement=f!=undefined?f:null,n.nextElement!=null&&angular.isFunction(n.callbackfn)&&n.$evalAsync(function(){n.requireEvent?n.callbackfn(n.nextElement,n.currentEvent):n.callbackfn(n.nextElement);var t=r.parents();n.isscroll||$.each(t,function(){if($(this).hasScrollBar())return $(this).scrollTo(r,{offsetTop:170,offsetLeft:0},null),!1})}))))}}}}]);app.directive("basemodelPropertiesrow",[function(){return{restrict:"A",replace:!0,scope:{prop:"=",clickCallback:"&",changeCallback:"&",category:"@",dbclickCallback:"&",showDeleteButton:"=",deletePropCallback:"&"},templateUrl:"Form/views/ControlProperties/advancePropertiesCatergory.html",link:function(n,t,i){n.disabledProplist=i.disabledProplist?n.$eval(i.disabledProplist):[];n.prop.PropertyName=="sfwIsCaption"&&n.prop.PropertyValue=="True"&&n.disabledProplist.push("sfwIsCaption");$(t).find("td:first-child").resizable({handles:"e",minWidth:15,resize:function(n,t){var i=$(t.element).closest("tbody").find("td:not(.advanced-prop-head):first-child");$(i).css("width",t.size.width);$(i).find("div[advance-prop-caption-wrapper]").css("width",t.size.width)}})}}}]);app.directive("workflowDrop",["$rootScope",function(n){return{restrict:"A",scope:{dropData:"=",allowdrop:"="},link:function(t,i){function u(i){if(i.stopPropagation&&i.stopPropagation(),t.allowdrop){$(i.currentTarget).trigger("click");var r=dragDropDataObject,u=dragDropData;t.$apply(function(){var i,f;r&&(r.DataType=="ValueType"||r.DataType=="BusObjectType")&&t.dropData&&(n.EditPropertyValue(t.dropData.dictAttributes.sfwObjectField,t.dropData.dictAttributes,"sfwObjectField",u),r.ItemPath&&(i=r.ItemPath.substr(0,r.ItemPath.indexOf(".")),n.EditPropertyValue(t.dropData.dictAttributes.sfwObjectID,t.dropData.dictAttributes,"sfwObjectID",i)),f=getDataType(r.DataType,r.DataTypeName),n.EditPropertyValue(t.dropData.dictAttributes.sfwDataType,t.dropData.dictAttributes,"sfwDataType",f))});dragDropData=null;dragDropDataObject=null}else return!1}var r=i[0];r.addEventListener("drop",u,!1);r.addEventListener("dragover",function(n){n.preventDefault()})}}}]);app.directive("multiValueinput",["$compile","$rootScope","CONSTANTS",function(n,t){return{retrict:"E",replace:!0,scope:{model:"=",propertyvalue:"=",propertyname:"=",separator:"@"},templateUrl:"Common/views/Directives/multivalueinput.html",link:function(n){function i(){n.separator=n.separator?n.separator:","}n.onAddMultipleValueClick=function(){var i=n.$new(!0),r,u;i.lstPropertyValues=[];r=n.propertyvalue?n.propertyvalue.split(n.separator):[];r.length>0&&(i.lstPropertyValues=$.map(r,function(n){return{value:n}}));u=t.showDialog(i,"Set Value(s)","Common/views/AddMultipleInputValue.html",{width:400,height:300});i.AddValue=function(){i.lstPropertyValues.push({value:""})};i.deletevalue=function(n){n>=0&&i.lstPropertyValues.splice(n,1)};i.setValueClick=function(){if(i.lstPropertyValues.length>0){var t=$.map(i.lstPropertyValues,function(n){if(n.value)return n.value});n.propertyvalue=t.join(n.separator)}u.close()};i.cancelClick=function(){u.close()}};i()}}}]);app.directive("xmlTree",function(){return{scope:{data:"=",selectfunction:"="},template:'<span ng-repeat="node in data.Elements"><span xml-node-tree-directive data="node" selectfunction="selectfunction"><\/span><\/span>',link:function(){}}});app.directive("xmlNodeTreeDirective",["$timeout","$rootScope",function(n,t){return{scope:{data:"=",selectfunction:"="},template:'<ul class="formtree"><li ng-repeat="item in getColumns(data)" style="cursor: pointer;" data-ng-click="selectElement(item,$event)"><span mainspan><i ng-show="item.Elements.length>0 && item.Elements[0].Name != \'ListItem\' && item.Elements[0].Name != \'Columns\'" ng-class="item.isExpand?\'fa fa-caret-down\':\'fa fa-caret-right\'" ng-click="toggle(item,$event)" aria-hidden="true"><\/i><span ng-bind="item.Name"><\/span> <span> - <\/span> <span>{{ item.Name == "sfwPanel" && item.dictAttributes.sfwCaption?item.dictAttributes.sfwCaption: item.dictAttributes.ID }}<\/span><\/span><span ng-show="item.isExpand" ng-if="item.Elements.length > 0" xml-tree data="item" selectfunction="selectfunction"><\/span><\/li><\/ul>',link:function(i){i.toggle=function(n){n.isExpand=!n.isExpand};i.toggleExpander=function(t){var i=$(t).parents("li").first().find("ul").first();n(function(){$(t).hasClass("fa fa-caret-down")?$(i).slideDown("normal"):$(i).slideUp("normal")})};i.selectElement=function(t,r,u){var f=null;r?(f=$(r.currentTarget),r.stopPropagation()):u&&(f=u);$(".selected-tree-item").removeClass("selected-tree-item");$(f).find("[mainspan]:first").addClass("selected-tree-item");t&&(i.selectedItem=t,n(function(){i.selectfunction(i.selectedItem)}))};i.getColumns=function(n){var r=[],u,t;if(n.Elements.length>0)for(u=0;u<n.Elements.length;u++){if(t=n.Elements[u],t.Name=="sfwTabSheet")r=r.concat(t);else if(t.Name=="sfwColumn"){r=r.concat(t.Elements);continue}t&&t.Name!="sfwColumn"&&t.Name!="sfwTabSheet"&&t.Name!="ListItem"&&t.Name!="Columns"&&(r=r.concat(i.getColumns(t)))}return r};t.$$listenerCount.searchById||t.$on("searchById",function(n,t){console.log("called function");i.searchById(t.model,t.input)});i.searchById=function(t,r){var u=!1,f=function(t,r){angular.forEach(t.Elements,function(t){t&&t.dictAttributes.ID&&r&&t.dictAttributes.ID.toLowerCase()==r.toLowerCase()&&(u=!0,i.$evalAsync(function(){var r=o(t);i.selectElement(t,null,r);n(function(){e(t)})}));t&&angular.isArray(t.Elements)&&t.Elements.length>0&&!u&&f(t,r)})},e=function(n){for(var t=n;t;)t.isExpand=!0,t=t.ParentVM?t.ParentVM:null},o=function(n){var t;return $(".formtree li").each(function(){var i=angular.element(this).scope();if(i&&i.item==n)return t=$(this),!1}),t};f(t,r)}}}}]);app.directive("keyUpDownForTree",["$timeout",function(n){return{scope:{callbackfn:"=",objproperty:"=",property:"=",propvalue:"=",parentelem:"=",objparent:"=",isscroll:"="},link:function(t,i){i.on("keydown",function(n){var u,r;(t.nextElement=null,u=!1,$(".ui-autocomplete").each(function(){var n=$(this).css("display");n=="block"&&(u=!0)}),u)||(r=i,t.parentelem&&(r=$(r).parents(t.parentelem).first()),n.keyCode==$.ui.keyCode.UP?(t.findNextItem(r,"UP"),n.preventDefault(),n.stopPropagation()):n.keyCode==$.ui.keyCode.DOWN?(t.findNextItem(r,"DOWN"),n.preventDefault(),n.stopPropagation()):n.keyCode==$.ui.keyCode.RIGHT?(t.findNextItem(r,"RIGHT"),n.preventDefault(),n.stopPropagation()):n.keyCode==$.ui.keyCode.LEFT&&(t.findNextItem(r,"LEFT"),n.preventDefault(),n.stopPropagation()))});t.findNextItem=function(i,r){var u=null,f=i,o,s,h,c,l,e;if($(f).find("input:focus").blur(),r=="UP")u=$(f).prevAll(":visible:first"),u&&u.length>0&&(o=$(u).find("li:visible:last"),o&&o.length>0&&(u=o)),u&&u.length<=0&&(u=$(f).parents("li:visible:first")),u.length<=0&&(u=$(f).prev()),t.goToNextElement(u,f,r);else if(r=="DOWN"){if(u=$(f).find("li:visible:first"),u&&u.length<=0&&(u=$(f).nextAll(":visible:first")),u.length<=0&&(u=$(f).next()),u&&u.length<=0){for(u=$(f).parents("li:visible:first").next(),s=$(f).parents("li:visible"),h=0;s&&s.length>h;){if(c=s[h],c&&(l=$(c).next().siblings("li"),l.length)){u=$(c).next();break}h++}$(f).parents("li:visible").next().siblings("li")}t.goToNextElement(u,f,r)}else r=="RIGHT"?(e=angular.element(f).scope(),e&&e.hasOwnProperty(t.objproperty)&&(e=e[t.objproperty],e&&e.Elements.length>0&&(e.IsExpanded=!0),n(function(){t.goToNextElement(f,f,r)}))):r=="LEFT"&&(e=angular.element(f).scope(),e&&e.hasOwnProperty(t.objproperty)&&(e=e[t.objproperty],e&&e.Elements.length>0&&(e.IsExpanded=!1),n(function(){t.goToNextElement(f,f,r)})))};t.goToNextElement=function(n,i,r){var u=n,e,f;u&&u.length<=0&&(r=="UP"?u=$(i).parents("li:visible:first"):r=="DOWN"&&(u=$(i).find("ul").find("li:first")));t.parentelem?(e=u.find("[key-up-down-with-element]"),e.focus()):u.focus();elemScope=angular.element(u).scope();u.is("[ng-if]")&&elemScope&&(elemScope=elemScope.$parent);elemScope&&elemScope.hasOwnProperty(t.objproperty)&&(f=elemScope[t.objproperty],t.nextElement=f!=undefined?f:null,t.nextElement!=null&&angular.isFunction(t.callbackfn)&&t.$evalAsync(function(){var n=null,i;t.objparent&&(n=t.objparent);t.callbackfn(t.nextElement,n);i=u.parents();t.isscroll||$.each(i,function(){if($(this).hasScrollBar())return $(this).scrollTo(u,{offsetTop:170,offsetLeft:0},null),!1})}))}}}}]);app.directive("activeformintellisensetemplate",["$compile","$rootScope","$ValidationService","CONSTANTS",function(n,t,i,r){return{retrict:"E",replace:!0,scope:{model:"=",activeformname:"=",propertyname:"=",formtype:"=",multiactiveformflag:"=",formmodel:"=",islookup:"=",onactiveformchange:"&",canhidesearchactiveformwindow:"=",isupdatefromexternalprop:"=",isdisabledinput:"="},template:"<div><span class='info-tooltip dtc-span' ng-if='model.errors.invalid_active_form' ng-attr-title='{{model.errors.invalid_active_form}}' style='color:red !important'><i class='fa fa-exclamation-circle' aria-hidden='true'><\/i> <\/span><div class='input-group'><input type='text' class='form-control input-sm' ng-disabled='isdisabledinput' id='ScopeId_{{$id}}' title='{{activeformname?activeformname:model.placeHolder}}' ng-model='activeformname' ng-keydown='onkeydown($event)' ng-change='onactiveformchange();validateActiveForm()' ng-blur='onactiveformchange();validateActiveForm()' undoredodirective  model='model' propertyname='propertyname' undorelatedfunction ='validateActiveForm' placeholder='{{model.placeHolder}}'/><span class='input-group-addon button-intellisense' ng-disabled='isdisabledinput' ng-click='showActivefromIntellisenseList($event)' ng-hide='multiactiveformflag'><\/span><span class='input-group-addon btn-search-popup'  ng-click='onSearchActiveFormClick($event)' ng-hide='canhidesearchactiveformwindow||multiactiveformflag'><\/span><span class='input-group-addon btn-search-multiple-popup' ng-click='onAddMultipleActiveFormClick($event)' ng-show='multiactiveformflag'><\/span><\/div><\/div>",link:function(n){n.$watch("formtype",function(t){t&&(n.model&&n.model.dictAttributes&&n.model.dictAttributes.sfwMethodName&&n.model.dictAttributes.sfwMethodName=="btnOpenReport_Click"?(n.filelist=[],n.filelist.push("wfmReportClientMVVM"),n.filelist.push("wfmReportClient")):$.connection.hubMain.server.getFilesByType(n.formtype,"ScopeId_"+n.$id,null))});n.receiveList=function(t){n.filelist=t;n.showplaceHolder()};n.showplaceHolder=function(){var i,t;if(n.model&&n.model.dictAttributes&&n.model.dictAttributes.sfwMethodName&&(n.model.dictAttributes.sfwMethodName=="btnOpen_Click"||n.model.dictAttributes.sfwMethodName=="btnNew_Click")&&n.formmodel&&(n.formmodel.dictAttributes.sfwType=="Lookup"||n.formmodel.dictAttributes.sfwType=="FormLinkLookup")&&n.filelist)for(i=n.formmodel.dictAttributes.ID.replace("Lookup","Maintenance"),t=0;t<n.filelist.length;t++)if(n.filelist[t]==i){n.$evalAsync(function(){n.model.placeHolder=i;n.model.isPlaceHolder=!0});break}};n.onkeydown=function(t){var i=$(t.target);n.inputElement=i;n.multiactiveformflag?$(i).data("ui-autocomplete")!=undefined&&$(i).autocomplete("disable"):(setSingleLevelAutoComplete(i,n.filelist),$(i).data("ui-autocomplete")!=undefined&&$(i).autocomplete("enable"),t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE&&n.filelist&&($(i).data("ui-autocomplete")&&$(i).autocomplete("search",$(i).val()),t.preventDefault()))};n.onSearchActiveFormClick=function(){function u(i,r){n.propertyname?t.EditPropertyValue(n.activeformname,n,"activeformname",r):n.activeformname=r}var i=n.$new(!0),r;i.model=n.model;i.filelist=n.filelist;r=n.formtype;i.validateActiveForm=n.validateActiveForm;i.isupdatefromexternalprop=n.isupdatefromexternalprop;i.selectFormType=r.split(",");i.SearchActiveFormDialog=t.showDialog(i,"Search Active Form","Form/views/SearchActiveForms.html",{width:800,height:530});n.$on("onSearchActiveFormOkClick",u)};n.onAddMultipleActiveFormClick=function(){var i=n.$new(!0);i.model=n.model;i.formmodel=n.formmodel;i.lstEntityField=n.lstEntityField;i.islookup=n.islookup;i.ActiveFormType=n.formtype;i.IsMultiActiveForm=!1;i.validateActiveForm=n.validateActiveForm;i.ActiveFormDialog=t.showDialog(i,"Active Forms","Form/views/ActiveForms.html",{width:800,height:500})};n.showActivefromIntellisenseList=function(t){n.inputElement||(n.inputElement=$(t.target).prevAll("input[type='text']"));n.inputElement.focus();n.inputElement&&n.filelist&&n.filelist.length>0&&(setSingleLevelAutoComplete(n.inputElement,n.filelist,n),$(n.inputElement).autocomplete("search",$(n.inputElement).val()));t&&t.stopPropagation()};n.validateActiveForm=function(){if(n.propertyname){var u=n.propertyname.split("."),f=u[u.length-1],t;n.inputElement?t=$(n.inputElement).val():n.model&&n.model.dictAttributes&&(t=n.model.dictAttributes[f]);i.checkActiveForm(n.filelist?n.filelist:[],n.model,t,f,"invalid_active_form",r.VALIDATION.INVALID_ACTIVE_FORM,undefined)}}}}}]);app.directive("fileintellisensetemplate",["$rootScope","$ValidationService","CONSTANTS",function(n,t,i){return{retrict:"E",replace:!0,scope:{model:"=",filename:"=",propertyname:"=",filetype:"=",onfilechange:"&",isdisabled:"=",onfileblur:"&",insidegrid:"=",errorprop:"=",isvalidate:"=",showentbase:"=",isinsidedialog:"=",tablename:"=",isreset:"="},template:"<div><div class='input-group' ng-show='!isinsidedialog'><span class='info-tooltip dtc-span' ng-if='errorprop' ng-attr-title='{{errorprop}}' style='color:red !important'><i class='fa fa-exclamation-circle' aria-hidden='true'><\/i><\/span><input  ng-class=\"insidegrid?'form-control full-width form-filter input-sm':'form-control input-sm full-width'\" type='text' ng-disabled='isdisabled' id='ScopeId_{{$id}}' title='{{filename}}' ng-model='filename' ng-keydown='onkeydown($event)' ng-keyup='validateFileTemplate();validateEntity();' ng-change='onchangecallback()' ng-blur='onblur();' undoredodirective  model='model' propertyname='propertyname' undorelatedfunction ='validateFileTemplate'/><span class='input-group-addon button-intellisense' ng-click='showIntellisenseList($event)' ng-class=\"isdisabled?'disabledlink':''\"><\/span><\/div><div class='input-group' ng-show='isinsidedialog'><span class='info-tooltip dtc-span' ng-if='errorprop' ng-attr-title='{{errorprop}}' style='color:red !important'><i class='fa fa-exclamation-circle' aria-hidden='true'><\/i><\/span><input  ng-class=\"insidegrid?'form-control full-width form-filter input-sm':'form-control input-sm full-width'\" type='text' ng-disabled='isdisabled' id='ScopeId_{{$id}}' title='{{filename}}' ng-model='filename' ng-keydown='onkeydown($event)' ng-keyup='validateFileTemplate();validateEntity();' ng-change='onchangecallback()' ng-blur='onblur();'/><span class='input-group-addon button-intellisense' ng-click='showIntellisenseList($event)' ng-class=\"isdisabled?'disabledlink':''\"><\/span><\/div><\/div>",link:function(n){n.prevvalue=n.filename;n.onchangecallback=function(){var i,u,t,o;if(n.propertyname&&!n.tempModel)for(n.tempModel="model",i=n.propertyname.split("."),t=0,u=i.length;t<u-1;t++)n.tempModel=n.tempModel.concat("."+i[t]);if(n.model||(n.model={dictAttributes:{}}),n.tempModel){var i=n.propertyname.split("."),f,e=n.tempModel.split("."),r=n;for(t=0,o=e.length;t<o;t++)r=r[e[t]];r!==null&&(f=r);f[i[i.length-1]]=n.filename}n.onfilechange();n.validateFileTemplate();n.validateEntity()};n.receiveList=function(t){var r,i,u;if(n.propertyname)for(n.tempModel="model",r=n.propertyname.split("."),i=0,u=r.length;i<u-1;i++)n.tempModel=n.tempModel.concat("."+r[i]);n.filelist=t;n.filetype&&n.filetype.toLowerCase()=="entity"&&n.showentbase&&n.filelist.indexOf("entBase")==-1&&n.filelist.splice(0,0,"entBase");n.inputElement.focus();setSingleLevelAutoComplete(n.inputElement,n.filelist);n.inputElement&&$(n.inputElement).data("ui-autocomplete")&&$(n.inputElement).autocomplete("search",$(n.inputElement).val().trim());n.$evalAsync(function(){n.validateFileTemplate()})};n.showIntellisenseList=function(t){n.filelist||n.inputElement?n.inputElement&&$(n.inputElement).data("ui-autocomplete")&&(n.inputElement.focus(),setSingleLevelAutoComplete(n.inputElement,n.filelist,n),$(n.inputElement).autocomplete("search",$(n.inputElement).val().trim())):(n.inputElement=$(t.target).prevAll("input[type='text']"),$.connection.hubMain.server.getFilesByType(n.filetype,"ScopeId_"+n.$id,n.tablename));t&&t.stopPropagation()};n.onkeydown=function(t){n.filelist||(n.inputElement=$(t.target),$.connection.hubMain.server.getFilesByType(n.filetype,"ScopeId_"+n.$id,n.tablename));t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE&&n.isreset&&n.filelist&&($.connection.hubMain.server.getFilesByType(n.filetype,"ScopeId_"+n.$id,n.tablename),t.preventDefault());t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE&&n.filelist?($(n.inputElement).data("ui-autocomplete")&&$(n.inputElement).autocomplete("search",$(n.inputElement).val()),t.preventDefault()):!n.filelist&&t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE&&t.preventDefault()};n.validateFileTemplate=function(){if(n.propertyname&&n.isvalidate){var r,u,e=n.propertyname.split("."),f=e[e.length-1],o;o=n.inputElement?$(n.inputElement).val():n.model.dictAttributes[f];(n.filetype=="UserControl"||n.filetype=="Tooltip")&&(u="invalid_active_form",r=i.VALIDATION.INVALID_ACTIVE_FORM,n.onfilechange());n.filetype=="Entity"&&(r=i.VALIDATION.INVALID_ENTITY_NAME);t.checkValidListValue(n.filelist,n.model,$(n.inputElement).val(),f,u?u:f,r,undefined)}};n.validateEntity=function(){n.model&&n.model.dictAttributes&&n.model.dictAttributes.hasOwnProperty("sfwEntity")&&t.validateEntity(n.model,undefined)};n.onblur=function(){n.prevvalue!=n.filename&&(n.onfileblur(),n.prevvalue=n.filename)}}}}]);app.directive("entityfieldelementintellisense",["$rootScope","$filter","$ValidationService","CONSTANTS","$EntityIntellisenseFactory",function(n,t,i,r,u){return{retrict:"E",replace:!0,scope:{model:"=",modebinding:"=",entityid:"=",propertyname:"=",onchangecallback:"&",ontextchangecallback:"&",isshowonetoone:"=",isshowonetomany:"=",isshowcolumns:"=",isshowcdocollection:"=",isshowproperty:"=",isshowglobalparams:"=",disabled:"=isDisabled",isObject:"=",onblurcallback:"&",candrop:"=",validate:"=",isshowexpression:"=",errorprop:"=",isempty:"=",setcolumndatatype:"=",isaddthis:"="},template:"<div><div class='input-group full-width'><span class='info-tooltip dtc-span' ng-if='errorprop' ng-attr-title='{{errorprop}}' style='color:red !important'><i class='fa fa-exclamation-circle' aria-hidden='true'><\/i><\/span><input ng-disabled='disabled' type='text' ng-change='onchange()' ondrop='onEntityFieldDropInDirective(event)' ng-blur='onBlur()' ondragover='onEntityFieldDragOver(event)' class='form-control input-sm' title='{{modebinding}}' ng-model='modebinding' undoredodirective model='model' propertyname='propertyname' undorelatedfunction ='validateEntityField' ng-keyup='onkeyup($event);validateEntityField()' ng-keydown='onkeydown($event)' ng-change='validateEntityField()'/><span ng-show='!disabled' class='input-group-addon button-intellisense' ng-click='showIntellisenseList($event)'><\/span><\/div><\/div>",link:function(f){f.setAutocomplete=function(i){var h,r,a,v,c,s,e,o;if(f.isMultilevelActive=!1,f.entityid&&f.entityid.trim().length>0){h=getSplitArray(i.val(),i[0].selectionStart);r=[];f.isaddthis&&r.push({ID:"this",DisplayName:"this"});var y=u.getEntityIntellisense(),l=y,e=f.entityid;for(f.model&&f.model.Name=="sfwGridView"&&(o=l.filter(function(n){return n.ID==f.entityid}),o.length>0&&o[0].ErrorTableName&&(a={ID:"InternalErrors",DisplayName:"InternalErrors",Tooltip:"InternalErrors",IsPrivate:"False",Entity:"entError",Value:"ibusSoftErrors.iclbError",Type:"Collection",DataType:"Collection"},v={ID:"ExternalErrors",DisplayName:"ExternalErrors",Tooltip:"InternalErrors",IsPrivate:"False",Entity:"entError",Value:"ibusSoftErrors.iclbEmployerError",DataType:"Collection",Type:"Collection"},r.push(a),r.push(v)));e;)r=r.concat(n.getEntityAttributeIntellisense(e,!0,f.isshowonetoone,f.isshowonetomany,f.isshowcolumns,f.isshowcdocollection,f.isshowexpression,f.isshowproperty)),o=l.filter(function(n){return n.ID==e}),e=o.length>0?o[0].ParentId:"";if(h.length>1)for(f.isMultilevelActive=!0,c=0;c<h.length;c++)if(s=r.filter(function(n){return n.ID==h[c]}),s.length>0)if(typeof s[0].DataType!="undefined"&&(s[0].DataType=="Object"||s[0].DataType=="Collection"||s[0].DataType=="CDOCollection"||s[0].DataType=="List")&&typeof s[0].Entity!="undefined")for(e=s[0].Entity,r=[];e;)r=r.concat(n.getEntityAttributeIntellisense(e,!0,f.isshowonetoone,f.isshowonetomany,f.isshowcolumns,f.isshowcdocollection,f.isshowexpression,f.isshowproperty)),o=l.filter(function(n){return n.ID==e}),e=o.length>0?o[0].ParentId:"";else r=[];f.isObject&&r&&r.length>0&&(r=t("filter")(r,{DataType:"Object"}));f.isshowglobalparams?$.connection.hubForm.server.getGlobleParameters().done(function(n){f.$apply(function(){function u(n){if(n.dictAttributes&&n.dictAttributes.ID){var i={ID:"~"+n.dictAttributes.ID};t.push(i)}}var t=[];f.objGlobleParameters=n;f.objGlobleParameters&&f.objGlobleParameters.Elements.length>0&&angular.forEach(f.objGlobleParameters.Elements,u);r=r.concat(t);setMultilevelAutoCompleteForObjectTreeIntellisense(i,r,"",f.onchangecallback)})}):setMultilevelAutoCompleteForObjectTreeIntellisense(i,r,"",f.onchangecallback)}else setMultilevelAutoCompleteForObjectTreeIntellisense(i,[],"",f.onchangecallback)};f.onkeyup=function(n){if(f.inputElement||(f.inputElement=$(n.target)),f.entityid&&f.entityid.trim().length>0&&f.inputElement){var t=getSplitArray(f.inputElement.val(),f.inputElement[0].selectionStart);(t.length>1||t.length==0)&&f.setAutocomplete(f.inputElement,n)}f.ontextchangecallback()};f.prevEntityID=undefined;f.onkeydown=function(n){if(f.entityid&&f.entityid.trim().length>0){f.inputElement&&f.prevEntityID==f.entityid||(f.inputElement=$(n.target),f.setAutocomplete(f.inputElement,n));f.prevEntityID=f.entityid;n.ctrlKey&&n.keyCode==$.ui.keyCode.SPACE&&($(f.inputElement).data("ui-autocomplete")&&$(f.inputElement).autocomplete("search",$(f.inputElement).val()),n.preventDefault());var t=getSplitArray(f.inputElement.val(),f.inputElement[0].selectionStart);t.length==1&&f.isMultilevelActive&&f.setAutocomplete(f.inputElement,n)}else setMultilevelAutoCompleteForObjectTreeIntellisense($(n.target),[],"",f.onchangecallback)};f.showIntellisenseList=function(n){if(f.inputElement||(f.inputElement=$(n.target).prevAll("input[type='text']")),f.entityid&&f.entityid.trim().length>0){f.prevEntityID!=f.entityid&&f.setAutocomplete(f.inputElement,n);f.inputElement.focus();f.prevEntityID=f.entityid;var t=getSplitArray(f.inputElement.val(),f.inputElement[0].selectionStart);t.length>1?f.setAutocomplete(f.inputElement,n):t.length==1&&f.isMultilevelActive&&f.setAutocomplete(f.inputElement,n);$(f.inputElement).data("ui-autocomplete")&&$(f.inputElement).autocomplete("search",$(f.inputElement).val())}else setMultilevelAutoCompleteForObjectTreeIntellisense(f.inputElement,[],"",f.onchangecallback)};f.validateEntityField=function(){var t,u,o,n;if(f.propertyname&&f.validate){var e,s=f.isshowonetoone?"Object,":"",h=f.isshowonetomany?"Collection,List,":"",c=f.isshowcolumns?"Column,":"",l=f.isshowcdocollection?"CDOCollection,":"",a=f.isshowexpression?"Expression,":"";e=s+h+c+l+a;t=f.propertyname.split(".");property=t[t.length-1];u=r.VALIDATION.ENTITY_FIELD_INCORRECT;property!="sfwEntityField"&&(u=r.VALIDATION.INVALID_FIELD);o=[];i.checkValidListValueForMultilevel(o,f.model,$(f.inputElement).val(),f.entityid,property,property,u,undefined,f.isempty,e);n=$(f.inputElement).val();property!="sfwRelatedField"||n==""||f.model.dictAttributes.sfwOperator||(f.model.errors||angular.isObject(f.model.errors)||(f.model.errors={}),f.model.errors.sfwOperator||(f.model.errors.sfwOperator=r.VALIDATION.EMPTY_FIELD));property!="sfwRelatedField"||n!=""||f.model.dictAttributes.sfwOperator?property=="sfwRelatedField"&&n==""&&f.model.dictAttributes.sfwOperator&&(f.model.dictAttributes.sfwOperator=""):(f.model.errors||angular.isObject(f.model.errors)||(f.model.errors={}),f.model.errors.sfwOperator&&delete f.model.errors.sfwOperator)}};f.onBlur=function(){if(f.onblurcallback)f.onblurcallback({model:f.model});f.ontextchangecallback&&f.ontextchangecallback()};f.onchange=function(){f.onchangecallback&&f.onchangecallback();f.$evalAsync(function(){f.validateEntityField()})}}}}]);app.directive("resourceintellisensetemplate",["$compile","$rootScope","$timeout","$ValidationService","CONSTANTS","$filter",function(n,t,i,r,u){var f=function(n){var t="";return n?(t+="<div> <label class='control-label' id='ScopeId_{{$id}}' ng-show='showresourcetext'>{{resourcetext}}<\/label>",t+="<div class='input-group' ng-show='!isinsidedialog'>",t+="<span class='info-tooltip dtc-span' ng-if='model.errors.invalid_resource' ng-attr-title='{{model.errors.invalid_resource}}' style='color:red !important'><i class='fa fa-exclamation-circle' aria-hidden='true'><\/i><\/span>",t+="<input  type='text' title='{{resourceid}}' ng-model='resourceid' class='form-control input-sm'  ng-change='onchangeresourcecallback();validateResource()' ng-keyup='validateResource()' ng-blur='onchangeresourcecallback();' ng-keydown='resourceIDTextChanged($event)' undoredodirective model='model' propertyname='propertyname' undorelatedfunction ='validateResource'/>",t+="<span class='input-group-addon button-intellisense' ng-click='showResourceIDIntellisenseList($event)'><\/span><\/div>",t+="<div class='input-group' ng-show='isinsidedialog'>",t+="<span class='info-tooltip dtc-span' ng-if='model.errors.invalid_resource' ng-attr-title='{{model.errors.invalid_resource}}' style='color:red !important'><i class='fa fa-exclamation-circle' aria-hidden='true'><\/i><\/span>",t+="<input type='text' title='{{resourceid}}' ng-model='resourceid' class='form-control input-sm'  ng-change='onchangeresourcecallback();validateResource()' ng-keyup='validateResource()' ng-blur='onchangeresourcecallback();' ng-keydown='resourceIDTextChanged($event)'/>",t+="<span class='input-group-addon button-intellisense' ng-click='showResourceIDIntellisenseList($event)'><\/span><\/div>",t+="<\/div>"):(t=[" <label class='{{resourcelabelclass}}' id='ScopeId_{{$id}}' ng-show='showresourcetext'>{{resourcetext}}<\/label>","<div class='{{resourcetextboxclass}}'>","<div class='input-group'>","<span class='info-tooltip dtc-span' ng-if='model.errors.invalid_resource' ng-attr-title='{{model.errors.invalid_resource}}' style='color:red !important'><i class='fa fa-exclamation-circle' aria-hidden='true'><\/i><\/span>","<input type='text' class='form-control input-sm' title='{{resourceid}}' ng-model='resourceid' ng-change='onchangeresourcecallback();validateResource();' ng-keyup='validateResource()' ng-blur='onchangeresourcecallback();' ng-keydown='resourceIDTextChanged($event)' ng-focus='focusIn()' undoredodirective model='model' propertyname='propertyname' undorelatedfunction ='validateResource' class='form-control input-sm'/> ","<span class='input-group-addon button-intellisense' ng-click='showResourceIDIntellisenseList($event)'><\/span>","<span class='input-group-addon btn-search-popup' ng-click='onResouceSearchClick($event)'><\/span>","<\/div>","<\/div>"],t=t.join(" ")),t};return{restrict:"E",replace:!0,scope:{model:"=",resourceid:"=",propertyname:"=",showresourcetext:"=",resourcetext:"=",resourcelabelclass:"@",resourcetextboxclass:"@",onchangeresourcecallback:"&",showvertical:"=",isinsidedialog:"="},link:function(e,o){e.showvertical?e.resourcelabelclass="control-label":((e.resourcelabelclass==undefined||e.resourcelabelclass=="")&&(e.resourcelabelclass="col-xs-4 control-label"),(e.resourcetextboxclass==undefined||e.resourcetextboxclass=="")&&(e.resourcetextboxclass="col-xs-8"));var s,h=$(o).parent();h.html(f());e.showvertical?h.html(f(e.showvertical)):h.html(f(!1));n(h.contents())(e);e.receiveList=function(n){if(e.resourcelist=n,s&&(s.resourcelist=e.resourcelist),e.resourcelist&&e.inputElement){var t=[];e.inputElement&&(t=e.resourcelist.sort(),setSingleLevelAutoComplete(e.inputElement,t,e,"ResourceID","ResourceIDDescription"),$(e.inputElement).data("ui-autocomplete")&&$(e.inputElement).autocomplete("search",$(e.inputElement).val().trim()))}};e.resourceIDTextChanged=function(n){var i,t;n&&n.keyCode==$.ui.keyCode.ESCAPE||(e.inputElement||(e.inputElement=$(n.target)),i=e.inputElement.val(),e.resourcelist||$.connection.hubMain.server.getResources("ScopeId_"+e.$id).done(function(n){e.receiveList(n)}),e.resourcelist&&e.resourcelist.length>0&&(t=e.resourcelist.sort(),n.ctrlKey&&n.keyCode==$.ui.keyCode.SPACE&&$(e.inputElement).data("ui-autocomplete")?($(e.inputElement).autocomplete("search",$(e.inputElement).val().trim()),n.preventDefault()):setSingleLevelAutoComplete(e.inputElement,t,e,"ResourceID","ResourceIDDescription")))};e.showResourceIDIntellisenseList=function(n){if(e.inputElement||(e.inputElement=$(n.target).prevAll("input[type='text']")),e.inputElement.focus(),e.resourcelist||$.connection.hubMain.server.getResources("ScopeId_"+e.$id).done(function(n){e.receiveList(n)}),e.inputElement&&e.resourcelist){var t=e.resourcelist.sort();setSingleLevelAutoComplete(e.inputElement,t,e,"ResourceID","ResourceIDDescription");$(e.inputElement).data("ui-autocomplete")&&$(e.inputElement).autocomplete("search",$(e.inputElement).val().trim())}n&&n.stopPropagation()};e.onResouceSearchClick=function(n){e.strCode="Resources";s=e.$new();s.strCode="Resources";s.validateResource=e.validateResource;e.resourcelist?s.resourcelist=e.resourcelist:($.connection.hubMain.server.getResources("ScopeId_"+e.$id).done(function(n){e.receiveList(n)}),i(function(){s.resourcelist=e.resourcelist}));s.SearchIDDescrDialog=t.showDialog(s,"Search ID Description","Common/views/SearchIDDescription.html",{width:530,height:540});s.$on("onOKClick",function(n,i){if(s.propertyname)if(s.propertyname.indexOf(".")>-1){var r=s.propertyname.split(".")[1];t.EditPropertyValue(e.model.dictAttributes[r],e.model.dictAttributes,r,i?i.ID:"")}else e.model[s.propertyname]=i?i.ID:"";n&&n.stopPropagation()});n&&n.stopImmediatePropagation()};e.focusIn=function(){e.resourcelist||$.connection.hubMain.server.getResources("ScopeId_"+e.$id).done(function(n){e.receiveList(n)})};e.validateResource=function(){if(e.propertyname&&e.model){var t=e.propertyname.split(".")[1],n=["0"];e.resourcelist&&e.resourcelist.length>0&&(n=r.getListByPropertyName(e.resourcelist,"ResourceID",!0),n.push("0"));r.checkValidListValue(n,e.model,$(e.inputElement).val(),t,"invalid_resource",u.VALIDATION.RESOURCE_NOT_EXISTS,undefined)}}}}}]);app.directive("visibleruleintellisensetemplate",["$compile","$rootScope","$NavigateToFileService","$ValidationService","CONSTANTS","$GetEntityFieldObjectService",function(n,t,i,r,u,f){var e=function(){var n="";return n+=" <label class='{{resourcelabelclass}}'><u ng-if='!sfwvisiblerule.trim() || !isnavigationlink'>{{visibleruletext}}<\/u><a ng-if='sfwvisiblerule.trim() && isnavigationlink' ng-click='selectVisibleRuleClick()'>{{visibleruletext}}<\/a><\/label>",n+="<div class='{{resourcetextboxclass}}'>",n+='<span class="info-tooltip dtc-span" ng-if="propertyname==\'dictAttributes.sfwVisibleRule\' && model.errors.invalid_visible_rule" ng-attr-title="{{model.errors.invalid_visible_rule}}" style="color:red !important"><i class="fa fa-exclamation-circle" aria-hidden="true"><\/i><\/span>',n+='<span class="info-tooltip dtc-span" ng-if="propertyname==\'dictAttributes.sfwEnableRule\' && model.errors.invalid_enable_rule" ng-attr-title="{{model.errors.invalid_enable_rule}}" style="color:red !important"><i class="fa fa-exclamation-circle" aria-hidden="true"><\/i><\/span>',n+='<span class="info-tooltip dtc-span" ng-if="propertyname==\'dictAttributes.sfwReadOnlyRule\' && model.errors.invalid_readonly_rule" ng-attr-title="{{model.errors.invalid_readonly_rule}}" style="color:red !important"><i class="fa fa-exclamation-circle" aria-hidden="true"><\/i><\/span>',n+='<span class="info-tooltip dtc-span" ng-if="propertyname==\'dictAttributes.sfwSelectColVisibleRule\' && model.errors.sfwSelectColVisibleRule" ng-attr-title="{{model.errors.sfwSelectColVisibleRule}}" style="color:red !important"><i class="fa fa-exclamation-circle" aria-hidden="true"><\/i><\/span>',n+="<div class='input-group'>",n+="<input type='text' title='{{sfwvisiblerule}}' ng-model='sfwvisiblerule' ng-keydown='visibleRuleTextChanged($event)' ng-keyup='validateRule()' ng-change='validateRule()' undoredodirective model='model' propertyname='propertyname' undorelatedfunction ='validateRule' class='form-control input-sm'/>",n+="<span class='input-group-addon button-intellisense' ng-click='showVisibleRuleIntellisense($event)'><\/span>",n+="<\/div><\/div>",n};return{restrict:"E",replace:!0,scope:{model:"=",sfwvisiblerule:"=",propertyname:"=",formmodel:"=",visibleruletext:"=",resourcelabelclass:"@",resourcetextboxclass:"@",isnavigationlink:"=",entityid:"="},link:function(t,o){var h=$(o).parent(),c,s;h.html(e());n(h.contents())(t);t.PrevEntity=t.entityid;t.PrevInitGroup=t.formmodel.dictAttributes.sfwInitialLoadGroup;t.visibleRuleTextChanged=function(n){if(t.inputElement||(t.inputElement=$(n.target)),n.ctrlKey&&n.keyCode==83){n.preventDefault();return}n.ctrlKey&&n.keyCode==$.ui.keyCode.SPACE&&$(t.inputElement).data("ui-autocomplete")?($(t.inputElement).autocomplete("search",$(t.inputElement).val().trim()),n.preventDefault()):$(t.inputElement).val()||n.keyCode==38||n.keyCode==40||s(t.inputElement,"change")};t.validateRule=function(){if(t.propertyname){var n=t.propertyname.split(".")[1],i=t.data?t.data:[];n=="sfwVisibleRule"?r.checkValidListValue(i,t.model,$(t.inputElement).val(),n,"invalid_visible_rule",u.VALIDATION.VISIBLE_RULE_NOT_EXISTS,undefined):n=="sfwEnableRule"?r.checkValidListValue(i,t.model,$(t.inputElement).val(),n,"invalid_enable_rule",u.VALIDATION.ENABLE_RULE_NOT_EXISTS,undefined):n=="sfwReadOnlyRule"?r.checkValidListValue(i,t.model,$(t.inputElement).val(),n,"invalid_readonly_rule",u.VALIDATION.READONLY_RULE_NOT_EXISTS,undefined):r.checkValidListValue(i,t.model,$(t.inputElement).val(),n,n,u.VALIDATION.READONLY_RULE_NOT_EXISTS,undefined)}};t.showVisibleRuleIntellisense=function(n){t.inputElement||(t.inputElement=$(n.target).prevAll("input[type='text']"));t.inputElement.focus();t.inputElement&&s(t.inputElement,"change");n&&n.stopPropagation()};t.selectVisibleRuleClick=function(){s(undefined,"navigate")};c=function(){var u,e,r,h,n,o,s;t.validateRule();t.propertyname&&(u=t.propertyname.split(".")[1]);e="";e=u=="sfwVisibleRule"?"invalid_visible_rule":u=="sfwEnableRule"?"invalid_enable_rule":"invalid_readonly_rule";r=!1;t.model.errors?t.model.errors&&!t.model.errors[e]&&(r=!0):r=!0;t.sfwvisiblerule&&t.sfwvisiblerule.trim()!=""&&r&&(h="initialload",n="",t.formmodel&&t.formmodel.SelectedControl&&t.formmodel.SelectedControl.IsGridChildOfListView?n=t.entityid:t.model&&(t.model.Name=="sfwGridView"||t.model.Name=="sfwChart"||t.model.Name=="sfwListView")?t.model.dictAttributes.sfwParentGrid&&t.model.Name!="TemplateField"?(o=FindControlByID(t.formmodel,t.model.dictAttributes.sfwParentGrid),o?(s=f.GetEntityFieldObjectFromEntityField(t.formmodel.dictAttributes.sfwEntity,o.dictAttributes.sfwEntityField),s&&(n=s.Entity)):n=t.formmodel.dictAttributes.sfwEntity):n=t.model.dictAttributes.sfwParentGrid&&t.model.Name=="TemplateField"?t.entityid:t.formmodel.dictAttributes.sfwEntity:t.entityid?n=t.entityid:t.formmodel&&t.formmodel.dictAttributes&&(n=t.formmodel.dictAttributes.sfwEntity),i.NavigateToFile(n,h,t.sfwvisiblerule))};s=function(n,i){var r="",s=t.formmodel.dictAttributes.sfwType=="Wizard"||t.formmodel.dictAttributes.sfwType=="FormLinkWizard"?!0:!1,o,u,e;t.model&&(t.model.Name=="sfwGridView"||t.model.Name=="sfwChart"||t.model.Name=="sfwListView")?t.formmodel&&t.formmodel.SelectedControl&&t.formmodel.SelectedControl.IsGridChildOfListView?r=t.entityid:t.model.dictAttributes.sfwParentGrid?(o=FindControlByID(t.formmodel,t.model.dictAttributes.sfwParentGrid),o&&(e=f.GetEntityFieldObjectFromEntityField(t.formmodel.dictAttributes.sfwEntity,o.dictAttributes.sfwEntityField),e&&(r=e.Entity))):r=t.formmodel.dictAttributes.sfwEntity:t.entityid?r=t.entityid:(u=FindParent(t.model,"sfwGridView"),u&&(u.dictAttributes.sfwBoundToQuery&&u.dictAttributes.sfwBoundToQuery.toLowerCase()=="true"?t.formmodel&&t.formmodel.dictAttributes&&(r=t.formmodel.dictAttributes.sfwEntity):u&&u.dictAttributes.sfwParentGrid&&u.dictAttributes.sfwEntityField&&(e=f.GetEntityFieldObjectFromEntityField(t.formmodel.dictAttributes.sfwEntity,u.dictAttributes.sfwEntityField),e&&(r=e.Entity))));r?hubMain.server.getEntityExtraData(r).done(function(u){t.$evalAsync(function(){var f;t.model&&t.model.ParentVM&&t.model.ParentVM.Name!="ItemTemplate"&&r==t.formmodel.dictAttributes.sfwEntity&&t.formmodel.dictAttributes.sfwInitialLoadGroup&&(f=t.formmodel.dictAttributes.sfwInitialLoadGroup);t.data=PopulateEntityRules(u,s,f,t.model.dictAttributes.sfwRulesGroup);i=="change"?(n&&setSingleLevelAutoComplete(n,t.data),$(t.inputElement).data("ui-autocomplete")&&$(t.inputElement).autocomplete("search",$(t.inputElement).val().trim())):i=="navigate"&&c()})}):t.inputElement&&setSingleLevelAutoComplete(t.inputElement,[])}}}}]);app.directive("autoCompleteConfigurationSetting",["$timeout","hubcontext",function(n,t){return{restrict:"A",scope:{basepath:"=",searchtext:"="},link:function(n,i,r){i.keyup(function(){n.basepath&&n.basepath!=""&&n.searchtext.length>2&&t.hubMain.server.getFolderPathIntellisense(r.id,n.searchtext,n.basepath)})}}}]);app.directive("messageintellisensetemplate",["$compile","$rootScope","ngDialog","$ValidationService","CONSTANTS",function(n,t,i,r,u){var f=function(n){var t="";return n?(t+="<div>",t+="<div class='col-xs-12' ng-show='!isinsidedialog'>",t+=" <label class='control-label col-xs-12 no-left-padding' id='ScopeId_{{$id}}' ng-show='showmessagetext'>{{messagetext}}<\/label>",t+="<div class='input-group col-xs-3 fleft'><span class='info-tooltip dtc-span' ng-if='errorprop' ng-attr-title='{{errorprop}}' style='color:red !important'><i class='fa fa-exclamation-circle' aria-hidden='true'><\/i><\/span>",t+="<input ng-disabled='isdisabled' type='text' title='{{messageid + newDisplayMessage}}' ng-model='messageid' class='form-control input-sm' ng-keydown='messageIDTextChanged($event)' ng-keyup='validateMessageID()' ng-change='populateMessageForMessage(messageid);validateMessageID()' undoredodirective model='model' propertyname='propertyname' undorelatedfunction ='validateMessageID'/>",t+="<span ng-class='isdisabled?\"disabledlink\" : \"\"' class='input-group-addon button-intellisense' ng-click='showMessageIntellisenseList($event)'><\/span>",t+="<\/div>",t+="<div class='col-xs-9'><span ng-if='messageid' class=\"file-detail-msg msgfont-11\" ng-bind='newDisplayMessage' ng-attr-title='{{newDisplayMessage}}' ><\/span>",t+="<span ng-if='!messageid' class=\"file-empty-mesage\">No Message<\/span><\/div><\/div>",t+="<div class='col-xs-12' ng-show='isinsidedialog'>",t+=" <label class='control-label col-xs-12 no-left-padding' id='ScopeId_{{$id}}' ng-show='showmessagetext'>{{messagetext}}<\/label>",t+="<div class='input-group col-xs-3 fleft'><span class='info-tooltip dtc-span' ng-if='errorprop' ng-attr-title='{{errorprop}}' style='color:red !important'><i class='fa fa-exclamation-circle' aria-hidden='true'><\/i><\/span>",t+="<input ng-disabled='isdisabled' type='text' title='{{messageid + newDisplayMessage}}' ng-model='messageid' class='form-control input-sm' ng-keydown='messageIDTextChanged($event)' ng-keyup='validateMessageID()' ng-change='populateMessageForMessage(messageid);validateMessageID()' />",t+="<span ng-class='isdisabled?\"disabledlink\" : \"\"' class='input-group-addon button-intellisense' ng-click='showMessageIntellisenseList($event)'><\/span>",t+="<\/div>",t+="<div class='col-xs-9' ng-if='!hideMessageText'><span ng-if='messageid' class=\"file-detail-msg msgfont-11\" ng-bind='newDisplayMessage' ng-attr-title='{{newDisplayMessage}}' ><\/span>",t+="<span ng-if='!messageid' class=\"file-empty-mesage\">No Message<\/span><\/div><\/div>",t+="<\/div>"):(t+=" <label class='{{messagelabelclass}}' id='ScopeId_{{$id}}' ng-show='showmessagetext'>{{messagetext}}<\/label>",t+="<div class='{{messagetextboxclass}}'>",t+="<div ng-show='!isinsidedialog'>",t+="<div class='input-group'><span class='info-tooltip dtc-span' ng-if='errorprop' ng-attr-title='{{errorprop}}' style='color:red !important'><i class='fa fa-exclamation-circle' aria-hidden='true'><\/i><\/span>",t+="<input ng-disabled='isdisabled' type='text' title='{{messageid + newDisplayMessage}}' ng-model='messageid' class='form-control input-sm' ng-keydown='messageIDTextChanged($event)' ng-keyup='validateMessageID()' ng-change='populateMessageForMessage(messageid);validateMessageID()' ng-blur='onblurcallback()' undoredodirective model='model' propertyname='propertyname' undorelatedfunction ='validateMessageID'/>",t+="<span ng-class='isdisabled?\"disabledlink\" : \"\"' class='input-group-addon button-intellisense' ng-click='showMessageIntellisenseList($event)'><\/span>",t+="<\/div>",t+="<\/div>",t+="<div  ng-show='isinsidedialog'>",t+="<div class='input-group'><span class='info-tooltip dtc-span' ng-if='errorprop' ng-attr-title='{{errorprop}}' style='color:red !important'><i class='fa fa-exclamation-circle' aria-hidden='true'><\/i><\/span>",t+="<input ng-disabled='isdisabled' type='text' title='{{messageid + newDisplayMessage}}' ng-model='messageid' class='form-control input-sm' ng-keydown='messageIDTextChanged($event)' ng-keyup='validateMessageID()' ng-change='populateMessageForMessage(messageid);validateMessageID()' ng-blur='onblurcallback()' />",t+="<span class='input-group-addon button-intellisense' ng-class='isdisabled?\"disabledlink\" : \"\"' ng-click='showMessageIntellisenseList($event)'><\/span>",t+="<\/div>",t+="<\/div><span ng-if='newDisplayMessage && !hideMessageText'  class=\"help-block msgfont-11\" ng-attr-title='{{newDisplayMessage}}' ng-bind='newDisplayMessage'><\/span><\/div>",t+="<\/div>"),t};return{restrict:"E",replace:!0,scope:{model:"=",messageid:"=",propertyname:"=",showmessagetext:"=",messagetext:"=",newDisplayMessage:"@",newSeverityValue:"@",messagelabelclass:"@",messagetextboxclass:"@",showvertical:"=",errorprop:"=",isvalidate:"=",onchangecallback:"&",onblurcallback:"&",isinsidedialog:"=",isempty:"=",isdisabled:"=",hideMessageText:"=",showTooltipIcons:"="},link:function(t,i){(t.messagelabelclass==undefined||t.messagelabelclass=="")&&(t.messagelabelclass="col-xs-4 control-label");(t.messagetextboxclass==undefined||t.messagetextboxclass=="")&&(t.messagetextboxclass="col-xs-8");var e=$(i).parent();t.showvertical?e.html(f(t.showvertical)):e.html(f(!1));n(e.contents())(t);hubMain.server.populateMessageList().done(function(n){t.$evalAsync(function(){t.messagelist=n;t.messageid&&t.populateMessageForMessage(t.messageid)})});t.$watch("messageid",function(){t.populateMessageForMessage(t.messageid)});t.messageIDTextChanged=function(n){var i=$(n.target),u,r;t.inputElement=i;u=i.val();r=[];t.messagelist&&(r=t.messagelist.sort());setSingleLevelAutoComplete(i,r,t,"MessageID","DisplayMessageID");n.ctrlKey&&n.keyCode==$.ui.keyCode.SPACE&&$(i).data("ui-autocomplete")&&($(i).autocomplete("search",$(i).val()),n.preventDefault())};t.showMessageIntellisenseList=function(n){t.inputElement||(t.inputElement=$(n.target).prevAll("input[type='text']"),setSingleLevelAutoComplete(t.inputElement,t.messagelist,t,"MessageID","DisplayMessageID"));t.inputElement.focus();t.inputElement&&$(t.inputElement).data("ui-autocomplete")&&$(t.inputElement).autocomplete("search",$(t.inputElement).val());n&&n.stopPropagation()};t.populateMessageForMessage=function(n){var r=!1,i;return n&&n.trim().length>0&&t.messagelist&&t.messagelist.length>0&&(i=t.messagelist.filter(function(t){return t.MessageID==n}),i&&i.length>0&&(t.newDisplayMessage=i[0].DisplayMessage,i[0].SeverityValue=="I"?t.newSeverityValue="Information":i[0].SeverityValue=="E"?t.newSeverityValue="Error":i[0].SeverityValue=="W"&&(t.newSeverityValue="Warnings"),t.newDisplayMessage=String.format("{0}{1}{2}{3}"," ",t.newSeverityValue,t.newDisplayMessage&&t.newDisplayMessage.trim().length>0?" : ":"",t.newDisplayMessage),r=!0)),r||(t.newDisplayMessage="",t.newSeverityValue=""),t.newDisplayMessage};t.validateMessageID=function(){var n,i;t.propertyname&&t.isvalidate&&(n=t.propertyname.split("."),n=n[n.length-1],i=r.getListByPropertyName(t.messagelist,"MessageID"),i.unshift("0"),r.checkValidListValue(i,t.model,$(t.inputElement).val(),n,n,u.VALIDATION.INVALID_MESSAGE_ID,undefined,t.isempty));t.onchangecallback&&(t.model&&(t.model.messageId=t.messageid),t.onchangecallback())}}}}]);app.directive("tablenameintellisense",["$compile","$rootScope",function(){return{restrict:"E",replace:!0,scope:{selecteditem:"=",onchangecallback:"&"},template:'<div class="input-group"><input type= "text" id="ScopeId_{{$id}}" class="form-control input-sm" title="{{selecteditem}}" ng-model="selecteditem" ng-blur="onchangecallback($event)" ng-keydown="onTableNameKeyDown($event)" /><span class="input-group-addon button-intellisense" ng-click="showTableNameList($event)"><\/span><\/div>',link:function(n){n.tablelist=[];hubMain.server.getUnusedTableList().done(function(t){n.tablelist=t});n.onTableNameKeyDown=function(t){t.key!="Down"&&t.key!="Up"&&t.key!="Left"&&t.key!="Right"&&(n.inputElement||(n.inputElement=$(t.target)),t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE&&$(n.inputElement).data("ui-autocomplete")?($(n.inputElement).autocomplete("search",$(n.inputElement).val()),t.preventDefault()):n.tablelist&&setSingleLevelAutoComplete($(n.inputElement),n.tablelist,n))};n.showTableNameList=function(t){n.inputElement||(n.inputElement=$(t.target).prevAll("input[type='text']"));n.inputElement.focus();n.inputElement&&(setSingleLevelAutoComplete(n.inputElement,n.tablelist,n),$(n.inputElement).data("ui-autocomplete")&&$(n.inputElement).autocomplete("search",$(n.inputElement).val().trim()));t&&t.stopPropagation()}}}}]);app.directive("locationintellisensetemplate",["$compile","$rootScope","ConfigurationFactory","$ValidationService",function(n,t,i,r){return{restrict:"E",replace:!0,scope:{locationname:"=",locationchanged:"&",islocationdisabled:"=",model:"=",validate:"=",validateLocationCallback:"=",errorprop:"=",hideCreateButton:"="},template:"<div class='input-group'><span class='info-tooltip dtc-span' ng-if='errorprop' ng-attr-title='{{errorprop}}' style='color:red !important'><i class='fa fa-exclamation-circle' aria-hidden='true'><\/i><\/span><input type='text' id='ScopeId_{{$id}}' title='{{locationname}}' ng-model='locationname' ng-disabled='islocationdisabled' ng-keydown='locationNameTextChanged($event)' ng-keyup='triggerChange($event)' ng-change='locationCallback()' ng-blur='locationCallback();' class='form-control input-sm'/><span class='input-group-addon button-intellisense' ng-disabled='islocationdisabled' ng-click='showlocationNameList($event)'><\/span><span class='input-group-btn' style='left: 6px;'><img ng-hide='hideCreateButton' ng-disabled='disableCreateNewFolderBtn' src='images/Common/new-folder.svg' style='height: 22px;width: 22px;' ng-click='createNewDirectory()' alt='New Folder' title='New Folder' /><\/span><\/div>",link:function(n){n.folderlist=[];n.disableCreateNewFolderBtn=!0;n.receiveList=function(t){n.$evalAsync(function(){n.folderlist=t;setSingleLevelAutoComplete(n.inputElement,n.folderlist);n.checkValidation?(n.checkValidation=!1,n.checkAndValidatePath()):(n.inputElement.focus(),n.inputElement&&$(n.inputElement).data("ui-autocomplete")&&$(n.inputElement).autocomplete("search",$(n.inputElement).val().trim()))})};n.validateLocationCallback&&(n.validateLocationCallback=function(){n.folderlist=[];n.locationCallback()});n.locationCallback=function(t){t!="newFolder"&&(n.inputElement&&n.folderlist.length!==0?n.checkAndValidatePath():(n.inputElement=$(document.getElementById("ScopeId_"+n.$id)),n.getFolderPath(),n.checkValidation=!0));n.locationchanged({locationname:n.locationname})};n.checkAndValidatePath=function(){n.validatePath();n.checkValidPath()};n.getFolderPath=function(){var r=i.getLastProjectDetails().BaseDirectory,t="";n.inputElement&&(t+=$(n.inputElement).val());hubMain.server.getFolderList(t).done(function(t){n.$evalAsync(function(){t?n.receiveList(t):n.receiveList([])})})};n.locationNameTextChanged=function(t){t&&(t.keyCode===38||t.keyCode===40)||(n.inputElement||(n.inputElement=$(t.target),n.getFolderPath()),t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE?(n.getFolderPath(),t.preventDefault()):t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE&&!n.folderlist&&t.preventDefault())};n.triggerChange=function(t){n.inputElement&&$(n.inputElement).val()&&t.keyCode!==$.ui.keyCode.SPACE&&t.keyCode!==17&&t.keyCode!==38&&t.keyCode!==40&&n.getFolderPath();n.locationchanged({locationname:n.locationname})};n.showlocationNameList=function(t){n.inputElement?n.inputElement&&$(n.inputElement).data("ui-autocomplete")&&n.folderlist&&n.folderlist.length>0&&(n.inputElement.focus(),$(n.inputElement).autocomplete("search",$(n.inputElement).val())):(n.inputElement=$(t.target).prevAll("input[type='text']"),n.getFolderPath());t&&t.stopPropagation()};n.createNewDirectory=function(){var t=n.inputElement&&$(n.inputElement).val();$.connection.hubCreateNewObject.server.getNonExistsDirectories(t).done(function(i){if(i){var r=confirm("Do you want to create \n"+i+"\n folders");r&&$.connection.hubCreateNewObject.server.createNewDirectory(null,t).done(function(t){n.$evalAsync(function(){alert("Created "+t.newFolders.toString()+" folders");n.model&&n.model.errors&&delete n.model.errors.invalid_path;n.locationCallback("newFolder");n.disableCreateNewFolderBtn=!0})})}})};n.checkValidPath=function(){n.disableCreateNewFolderBtn=n.validate&&n.model&&n.model.errors&&n.model.errors.invalid_path=="Folder Not Exist"&&n.locationname[n.locationname.length-1]!="\\"?!1:!0};n.validatePath=function(){n.validate&&n.model&&(r.checkValidListValue(n.folderlist,n.model,$(n.inputElement).val(),null,"invalid_path","Folder Not Exist",undefined,!1,!0,!0,!0),validatePathForSpecialChar(n.locationname)&&(n.model.errors.invalid_path='Invalid Folder Path. It cannot contain any of the following special characters < > / : | * " : and also cannot start or end with \\ '))}}}}]);app.directive("businessobjectintellisensetemplate",["$compile","$rootScope",function(){return{restrict:"E",replace:!0,scope:{busobjectname:"=",busobjectchange:"&",isentitycreation:"=",isonlybusobject:"=",isbusobjectreadonly:"=",onvalidselection:"&",model:"=",propertyname:"=",onblurcallback:"&",undorelatedfunction:"="},template:"<div class='input-group'><input ng-change='onChange($event)' type='text' id='ScopeId_{{$id}}' ng-blur='onblurcallback($event)' ng-disabled='isbusobjectreadonly' title='{{busobjectname}}' ng-model='busobjectname' ng-keyup='triggerChange($event)' ng-keydown='busObjectNameTextChanged($event)' class='form-control input-sm' undoredodirective model='model' propertyname='propertyname' undorelatedfunction='undorelatedfunction'/><span ng-disabled='isbusobjectreadonly' class='input-group-addon button-intellisense' ng-click='setbusobjectclick($event)'><\/span><\/div>",link:function(n){hubMain.server.getLstBusinessObject().done(function(t){n.busobjectlist=t});n.triggerChange=function(t){n.busObjectNameTextChanged(t)};n.setbusobjectclick=function(t){n.inputElement||(n.inputElement=$(t.target).prevAll("input[type='text']"));n.inputElement.focus();n.busobjectlist||hubMain.server.getLstBusinessObject().done(function(t){n.busobjectlist=t});n.inputElement&&n.busobjectlist&&n.busobjectlist.length>0&&(setSingleLevelAutoComplete(n.inputElement,n.busobjectlist,n),$(n.inputElement).data("ui-autocomplete")&&$(n.inputElement).autocomplete("search",$(n.inputElement).val().trim()));t&&t.stopPropagation()};n.busObjectNameTextChanged=function(t){var f,r,i,u;if(t.key!="Down"&&t.key!="Up"&&t.key!="Left"&&t.key!="Right"&&(n.inputElement||(n.inputElement=$(t.target)),f=n.inputElement.val(),r=[],n.busobjectlist||hubMain.server.getLstBusinessObject().done(function(t){n.busobjectlist=t}),n.busobjectlist&&n.busobjectlist.length>0))if(i=n.busobjectlist.sort(),t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE&&$(n.inputElement).data("ui-autocomplete"))$(n.inputElement).autocomplete("search",f),t.preventDefault();else{if(i&&i.length>100)for(u=0;u<i.length;u++)if(r.length<100)i[u].ID.toLowerCase().indexOf(f.toLowerCase())>-1&&r.push(i[u]);else break;else r=i;setSingleLevelAutoComplete(n.inputElement,r,n)}};n.onChange=function(){if(n.busobjectlist&&n.busobjectlist.length>0&&n.onvalidselection){var i=function(t){return t.ID==n.busobjectname},t=n.busobjectlist.filter(i);if(t&&t.length>0){n.model&&n.propertyname&&getPropertyValue(n.model,n.propertyname)!=n.busobjectname&&setPropertyValue(n.model,n.propertyname,n.busobjectname);n.onvalidselection({objEntityBusinessObject:n.busobjectname})}}}}}}]);app.directive("entityqueryintellisense",["$compile","$rootScope","$getQueryparam","$EntityIntellisenseFactory","$ValidationService","CONSTANTS",function(n,t,i,r,u,f){return{restrict:"E",replace:!0,scope:{selecteditem:"=",propertyname:"=",querytype:"=",onchangecallback:"&",model:"=",disableflag:"=",parametermodel:"=",showsearchbutton:"=",isbpm:"=",parameterallowedvalues:"=",isnavigatetoentity:"=",isscalarquery:"=",errorprop:"=",validate:"=",shownonparameterisedquery:"=",isinsidedialog:"@",blnWithoutParameter:"=",isempty:"="},template:"<div style='position:relative'><span class='info-tooltip dtc-span' ng-if='errorprop' ng-attr-title='{{errorprop}}' style='color:red !important'><i class='fa fa-exclamation-circle' aria-hidden='true'><\/i><\/span><div class='input-group full-width' ng-show='!isinsidedialog'><input  type='text' title='{{selecteditem}}' ng-model='selecteditem' ng-change='onchange($event)' ng-disabled='disableflag' ng-keyup='onkeyUp($event);validateQuery()' ng-keydown='onKeyDown($event)' class='form-control input-sm' undoredodirective  model='model' propertyname='propertyname' undorelatedfunction ='validateQuery' ng-change='clearParamters()'/><span ng-hide='disableflag' class='input-group-addon button-intellisense' ng-click='showIntellisenseList($event)'><\/span><span ng-show='showsearchbutton && !disableflag && !isbpm' class='input-group-addon btn-search-popup' ng-click='onBrowseForQuery()'><\/span> <span class='input-group-addon' ng-if='!disableflag && isbpm'  title='set Parameters' ng-click='setQueryParameters()'><i class='fa fa-chevron-right'><\/i><\/span><button class='input-group-addon' ng-if='model.dictAttributes.sfwLoadType == \"Query\" && isnavigatetoentity'  title={{model.dictAttributes.sfwLoadSource}} ng-click='NavigateToQueryFromBusMethod(model.dictAttributes.sfwLoadSource)' ng-disabled='isDisableNavigateQuery(model.dictAttributes.sfwLoadSource)'><i class='fa fa-chevron-right'><\/i><\/button><\/div><div class='input-group full-width' ng-show='isinsidedialog'><input  type='text' title='{{selecteditem}}' ng-model='selecteditem' ng-change='onchange($event);validateQuery()' ng-disabled='disableflag' ng-keyup='onkeyUp($event);validateQuery()' ng-keydown='onKeyDown($event)' class='form-control input-sm'/><span ng-hide='disableflag' class='input-group-addon button-intellisense' ng-click='showIntellisenseList($event)'><\/span><span ng-show='showsearchbutton && !disableflag && !isbpm' class='input-group-addon btn-search-popup' ng-click='onBrowseForQuery()'><\/span> <span class='input-group-addon' ng-if='!disableflag && isbpm'  title='set Parameters' ng-click='setQueryParameters()'><i class='fa fa-chevron-right'><\/i><\/span><button class='input-group-addon' ng-if='model.dictAttributes.sfwLoadType == \"Query\" && isnavigatetoentity'  title={{model.dictAttributes.sfwLoadSource}} ng-click='NavigateToQueryFromBusMethod(model.dictAttributes.sfwLoadSource)' ng-disabled='isDisableNavigateQuery(model.dictAttributes.sfwLoadSource)'><i class='fa fa-chevron-right'><\/i><\/button><\/div><\/div>",link:function(n,e,o){if(n.propertyname){var s=n.propertyname.split(".");n.property=s[s.length-1]}n.querytextboxclass==undefined&&(n.querytextboxclass="col-xs-8");n.setAutocomplete=function(t,i){var e,r,f,u;if(n.isMultilevelActive=!1,e="ID",r=getSplitArray(t.val().trim(),t[0].selectionStart),r[r.length-1]==""&&r.pop(),r.length>0)for(f=0;f<r.length;f++)u=i.filter(function(n){return n.ID==r[f]}),u.length>0?u[0].Queries?(n.isMultilevelActive=!0,e="",i=n.querytype=="SubSelectQuery"?u[0].Queries.filter(function(n){return n.QueryType=="SubSelectQuery"}):n.querytype=="ScalarQuery"?u[0].Queries.filter(function(n){return n.QueryType=="ScalarQuery"}):u[0].Queries.filter(function(n){return n.QueryType!="SubSelectQuery"}),n.shownonparameterisedquery&&(i=i.filter(function(n){return!n.Parameters||n.Parameters&&n.Parameters.length==0}))):$(t).data("ui-autocomplete")!=undefined&&$(t).autocomplete("disable"):$(t).data("ui-autocomplete")!=undefined&&$(t).autocomplete("disable");setEntityQueryIntellisense(t,i,n,e)};n.onkeyUp=function(t){if(n.inputElement){var i=getSplitArray(n.inputElement.val(),n.inputElement[0].selectionStart);i.length>1&&!n.isMultilevelActive||i.length==0?n.setAutocomplete(n.inputElement,r.getEntityIntellisense(),t):i.length>2&&$(n.inputElement).data("ui-autocomplete")&&$(n.inputElement).autocomplete("disable")}};n.onKeyDown=function(t){var u,i,f,e;n.inputElement||(n.inputElement=$(t.target),u=r.getEntityIntellisense(),n.setAutocomplete(n.inputElement,u,t));i=n.inputElement.data("ui-autocomplete")!=undefined;f=i?$(n.inputElement).autocomplete("option","disabled"):!1;t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE&&$(n.inputElement).data("ui-autocomplete")?($(n.inputElement).autocomplete("search",$(n.inputElement).val()),t.preventDefault()):i&&f&&!t.ctrlKey&&$(n.inputElement).autocomplete("enable");e=getSplitArray(n.inputElement.val(),n.inputElement[0].selectionStart);e.length==1&&n.isMultilevelActive&&n.setAutocomplete(n.inputElement,r.getEntityIntellisense(),t)};n.showIntellisenseList=function(t){n.inputElement||(n.inputElement=$(t.target).prevAll("input[type='text']"),n.setAutocomplete(n.inputElement,r.getEntityIntellisense(),t));n.inputElement.focus();var i=getSplitArray(n.inputElement.val(),n.inputElement[0].selectionStart);i.length>1?n.setAutocomplete(n.inputElement,r.getEntityIntellisense(),t):i.length==1&&n.isMultilevelActive&&n.setAutocomplete(n.inputElement,r.getEntityIntellisense(),t);$(n.inputElement).data("ui-autocomplete")&&$(n.inputElement).autocomplete("search",$(n.inputElement).val())};n.onchange=function(){var e=i.get(n.selecteditem),u,s,r,l;if(n.selecteditem!=undefined&&o.parametermodel&&e&&(n.isinsidedialog?n.parametermodel=e:t.EditPropertyValue(n.parametermodel,n,"parametermodel",e)),n.validateQuery(),n.onchangecallback&&n.selecteditem!=undefined)if(n.model){if(n.propertyname&&!n.tempModel)for(n.tempModel="model",u=n.propertyname.split("."),r=0,s=u.length;r<s-1;r++)n.tempModel=n.tempModel.concat("."+u[r]);if(n.tempModel){var u=n.propertyname.split("."),h,c=n.tempModel.split("."),f=n;for(r=0,l=c.length;r<l;r++)f=f[c[r]];f!==null&&(h=f);h[u[u.length-1]]=n.selecteditem}n.onchangecallback({QueryID:n.selecteditem})}else n.onchangecallback({QueryID:n.selecteditem})};n.onBrowseForQuery=function(){var r=n.$new();r.$on("onQueryClickBPM",function(i,u){function e(n){o.push(n);this.push(n.ID+"="+(n.Value?n.Value:""))}if(r.mapObj&&r.mapObj.dictAttributes?n.isinsidedialog?r.mapObj.dictAttributes.sfwQueryID=u.Id:t.EditPropertyValue(r.mapObj.dictAttributes.sfwQueryID,r.mapObj.dictAttributes,"sfwQueryID",u.Id):r.mapObj&&(n.isinsidedialog?r.mapObj.sfwQueryID=u.Id:t.EditPropertyValue(r.mapObj.sfwQueryID,r.mapObj,"sfwQueryID",u.Id)),u.Parameters.length>0){var f=[],o=[];angular.forEach(u.Parameters,e,f);r.mapObj&&r.mapObj.dictAttributes?n.isinsidedialog?r.mapObj.dictAttributes.sfwQueryParameters=f.join(";")+";":t.EditPropertyValue(r.mapObj.dictAttributes.sfwQueryParameters,r.mapObj.dictAttributes,"sfwQueryParameters",f.join(";")+";"):r.mapObj&&(n.isinsidedialog?r.mapObj.sfwQueryParameters=f.join(";")+";":t.EditPropertyValue(r.mapObj.sfwQueryParameters,r.mapObj,"sfwQueryParameters",f.join(";")+";"))}});r.$on("onQueryClick",function(i,r){n.isinsidedialog?n.selecteditem=r:t.EditPropertyValue(n.selecteditem,n,"selecteditem",r);n.onchange(i);i&&i.stopPropagation()});r.mapObj=n.model;r.strSelectedQuery=n.selecteditem;r.IsBPM=n.isbpm;r.subQueryType=n.querytype;n.isbpm&&(r.mapObj&&r.mapObj.dictAttributes?r.queryParameters=i.getQueryparamfromString(r.mapObj.dictAttributes,"sfwQueryParameters",";"):r.mapObj&&(r.queryParameters=i.getQueryparamfromString(r.mapObj,"sfwQueryParameters",";")));r.queryValues=n.parameterallowedvalues;r.validateQuery=n.validateQuery;r.QueryDialog=t.showDialog(r,"Browse Queries","Form/views/BrowseForQuery.html",{width:1e3,height:700})};n.setQueryParameters=function(){if(n.isbpm){var r=n.$new();r.mapObj=n.model;r.queryValues=n.parameterallowedvalues;r.mapObj&&r.mapObj.dictAttributes?r.queryParameters=i.getQueryparamfromString(r.mapObj.dictAttributes,"sfwQueryParameters",";"):r.mapObj&&(r.queryParameters=i.getQueryparamfromString(r.mapObj,"sfwQueryParameters",";"));r.onOKClickQueryParameters=function(){function f(n){u.push(n);this.push(n.ID+"="+(n.Value?n.Value:""))}var i=[],u=[];angular.forEach(r.queryParameters,f,i);r.mapObj&&r.mapObj.dictAttributes?n.isinsidedialog?r.mapObj.dictAttributes.sfwQueryParameters=i.join(";")+";":t.EditPropertyValue(r.mapObj.dictAttributes.sfwQueryParameters,r.mapObj.dictAttributes,"sfwQueryParameters",i.join(";")+";"):r.mapObj&&(n.isinsidedialog?r.mapObj.sfwQueryParameters=i.join(";")+";":t.EditPropertyValue(r.mapObj.sfwQueryParameters,r.mapObj,"sfwQueryParameters",i.join(";")+";"));r.parametersdialog.close()};r.parametersdialog=t.showDialog(r,"Set Parameters","BPM/views/SetQueryParameters.html",{width:500,height:500})}};n.NavigateToQueryFromBusMethod=function(n){var e=n.indexOf("."),s,f,i;if(e>-1){var u=n.substring(0,e),h=null,o=r.getEntityIntellisense();for(i=0;i<o.length;i++)if(o[i].ID==u){h=i;break}for(s=n.substring(e+1,n.length),t.queryID=s,i=0;i<t.lstopenedfiles.length;i++)if(t.lstopenedfiles[i].file.FileName==u&&(f=getScopeByFileName(u),f!=undefined)){$.connection.hubMain.server.navigateToFile(u,"").done(function(n){t.openFile(n,!1)});f.openQueryFromLogicalRule();break}f==undefined&&$.connection.hubMain.server.navigateToFile(u,"").done(function(n){t.openFile(n,!1)})}};n.isDisableNavigateQuery=function(t){var e,s,o,i;if(n.isscalarquery=!1,t==undefined||t=="")return!0;if(t!=undefined){if(n.isscalarquery=!0,e=t.indexOf("."),s=!0,e>-1){var h=t.substring(0,e),u=null,f=r.getEntityIntellisense();for(i=0;i<f.length;i++)if(f[i].ID==h){u=i;break}if(o=t.substring(e+1,t.length),o!=undefined&&o!=""&&u)for(i=0;i<f[u].Queries.length;i++)if(f[u].Queries[i].ID==o){f[u].Queries[i].QueryType=="ScalarQuery"&&(n.isscalarquery=!1);s=!1;break}}return s}return!1};n.validateQuery=function(){var i,e,t;n.property&&n.validate&&(n.inputElement?i=$(n.inputElement).val():n.model&&n.model.dictAttributes&&(i=n.model.dictAttributes[n.property]),e=["sfwQueryID","sfwLoadSource","sfwRetrievalQuery","sfwAutoQuery","sfwBaseQuery","sfwQueryRef","StrBaseQuery","loadSource"],t="",e.indexOf(n.property)>-1?t=f.VALIDATION.INVALID_QUERY:n.property=="sfwCodeTable"&&(t=f.VALIDATION.INVALID_CODE_TABLE),u.checkValidQuery(r.getEntityIntellisense(),n.model,i,n.querytype,n.property,n.property,t,undefined,n.blnWithoutParameter,n.isempty))}}}}]);app.directive("codegroupintellisensetemplate",["$compile","$rootScope","$ValidationService","CONSTANTS",function(n,t,i,r){var u=function(){var n="";return n=[" <label class='{{codegrouplabelclass}}' id='ScopeId_{{$id}}' ng-show='showcodegrouptext'>{{codegrouptext}}<\/label>","<div style='position: relative;' class='{{codegrouptextboxclass}}'>",'<span class="info-tooltip dtc-span" ng-if="model.errors.invalid_code_group" ng-attr-title="{{model.errors.invalid_code_group}}" style="color:red !important"><i class="fa fa-exclamation-circle" aria-hidden="true"><\/i><\/span>',"<div class='input-group'>","<input type='text' ng-class=\"insidegrid?'form-control input-sm form-filter input-sm':'form-control input-sm'\" title='{{codegroupid?codegroupid:model.placeHolder}}' ng-model='codegroupid' ng-keydown='codegroupIDTextChanged($event)' ng-keyup='validateCodeGroup($event)' ng-init='validateCodeGroup()' ng-change='validateCodeGroup()' ng-blur='onblurcallback()' ondrop='return false'  undoredodirective model='model' propertyname='propertyname' undorelatedfunction ='validateCodeGroup' class='form-control input-sm' placeholder='{{model.placeHolder}}'/> ","<span class='input-group-addon button-intellisense' ng-click='showCodeGroupIDList($event)'><\/span>","<\/div>","<\/div>"],n.join(" ")};return{restrict:"E",replace:!0,scope:{model:"=",codegroupid:"=",propertyname:"=",insidegrid:"=",showcodegrouptext:"=",codegrouptext:"=",codegrouplabelclass:"@",codegrouptextboxclass:"@",onblurcallback:"&",isDialog:"="},link:function(t,f){(t.codegrouplabelclass==undefined||t.codegrouplabelclass=="")&&(t.codegrouplabelclass="col-xs-4 control-label");(t.codegrouptextboxclass==undefined||t.codegrouptextboxclass=="")&&(t.codegrouptextboxclass="col-xs-8");var e=$(f).parent();e.html(u());n(e.contents())(t);t.codegrouplist=[];t.receiveList=function(n,i){n&&n.length>0&&(t.codegrouplist=n,setSingleLevelAutoComplete(i,t.codegrouplist,t,"CodeID","CodeIDDescription"),i&&$(i).autocomplete("search",$(i).val()))};t.getCodeGroups=function(n){var i=n;$.connection.hubMain.server.getCodeGroups().done(function(n){t.$evalAsync(function(){t.receiveList(n,i)})})};t.codegroupIDTextChanged=function(n){var i,r;n&&n.keyCode==$.ui.keyCode.TAB||(i=$(n.target),t.inputElement=i,r=i.val(),t.codegrouplist.length==0?t.getCodeGroups(i):n.ctrlKey&&n.keyCode==$.ui.keyCode.SPACE&&$(i).data("ui-autocomplete")&&($(i).autocomplete("search",$(i).val()),n.preventDefault()))};t.showCodeGroupIDList=function(n){t.inputElement||(t.inputElement=$(n.target).prevAll("input[type='text']"));t.codegrouplist.length==0?(t.getCodeGroups(t.inputElement),t.inputElement.focus()):(t.inputElement.focus(),t.inputElement&&t.codegrouplist&&$(t.inputElement).data("ui-autocomplete")&&$(t.inputElement).autocomplete("search",$(t.inputElement).val()));n&&n.stopPropagation()};t.validateCodeGroup=function(){var f,e,o,n,u;event&&event.keyCode==$.ui.keyCode.TAB||t.propertyname&&t.codegrouplist&&t.codegrouplist.length>0&&(f=t.propertyname.split(".")[1],e=r.VALIDATION.CODE_GROUP_NOT_EXISTS,f=="sfwChecklistId"&&(e=r.VALIDATION.CHECKLIST_NOT_EXISTS),o=i.getListByPropertyName(t.codegrouplist,"CodeID"),o.push("0"),n=!1,["sfwDropDownList","sfwCascadingDropDownList","sfwMultiSelectDropDownList","sfwListPicker","sfwListBox","sfwRadioButtonList","sfwCheckBoxList","entity"].indexOf(t.model.Name)>-1&&(u="sfwEntityField",t.model.Name=="sfwCheckBoxList"&&(u="sfwCheckBoxField"),t.model.dictAttributes[u]&&t.model.errors&&!t.model.errors[u]&&(t.model.dictAttributes.sfwLoadType!="CodeGroup"||t.model.placeHolder||$(t.inputElement).val()||(n=!0))),n?i.checkValidListValue([],t.model,$(t.inputElement).val(),"sfwLoadSource","invalid_code_group",r.VALIDATION.CODE_GROUP_NOT_EXISTS,undefined,n):i.checkValidListValue(o,t.model,$(t.inputElement).val(),f,"invalid_code_group",e,undefined,n,t.isDialog))}}}}]);app.directive("codevaluesintellisensetemplate",["$compile","$rootScope","ngDialog",function(n){var t=function(){var n="";return n=["<label class='{{codevalueslabelclass}}' id='ScopeId_{{$id}}' ng-show='showcodevaluestext'>{{codevaluestext}}<\/label>","<div class='{{codevaluestextboxclass}}'>","<div class='input-group'>","<input type='text' class='form-control input-sm text-autocomplete' title='{{codevaluesid}}' ng-model='codevaluesid' onkeydown='codevaluesIDTextChanged(event)' ng-blur='codevaluesidchange($event)' ng-change='codevaluesidchange($event)' undoredodirective model='model' propertyname='propertyname' class='form-control input-sm'/>","<span class='button-intellisense input-group-addon' value=''  ng-click='showCheckListIDList($event)'><\/span>","<\/div>","<\/div>"],n.join(" ")};return{restrict:"E",replace:!0,scope:{model:"=",codevaluesid:"=",propertyname:"=",showcodevaluestext:"=",codevaluestext:"=",codevalueslabelclass:"@",codevaluestextboxclass:"@",codedescription:"=",codeid:"="},link:function(i,r){var u,f;(i.codevalueslabelclass==undefined||i.codevalueslabelclass=="")&&(i.codevalueslabelclass="col-xs-4 control-label");(i.codevaluestextboxclass==undefined||i.codevaluestextboxclass=="")&&(i.codevaluestextboxclass="col-xs-8");u=$(r).parent();u.html(t());n(u.contents())(i);i.$watch("codeid",function(n){i.codevalueslist=[];n&&$.connection.hubMain.server.getCodeValues("ScopeId_"+i.$id,i.codeid)});i.codevaluesidchange=function(){function n(n){n.CodeValue==i.codevaluesid&&(i.codedescription=n.Description)}i.codedescription="";i.codeid||(i.codevalueslist=[]);i.codevalueslist&&i.codevalueslist.length>0&&angular.forEach(i.codevalueslist,n)};i.receiveList=function(n){i.codevalueslist=n;f&&(f.codevalueslist=i.codevalueslist);i.codevaluesid&&i.codevalueslist&&i.codevalueslist.length>0&&i.codevaluesidchange()};i.showCheckListIDList=function(n){i.inputElement||(i.inputElement=$(n.target).prevAll("input[type='text']"));i.codevalueslist||$.connection.hubMain.server.getCodeValues("ScopeId_"+i.$id,i.codeid);i.inputElement.focus();i.inputElement&&i.codevalueslist&&(setSingleLevelAutoComplete(i.inputElement,i.codevalueslist,i,"CodeValue","CodeValueDescription"),$(i.inputElement).data("ui-autocomplete")&&$(i.inputElement).autocomplete("search",$(i.inputElement).val()));n&&n.stopPropagation()};i.$watch("codevaluesid",function(){i.codevaluesidchange()})}}}]);app.directive("busobjectintellisensetemplate",["$compile",function(){return{retrict:"E",replace:!0,scope:{model:"=",filename:"=",propertyname:"=",filetype:"=",onfilechange:"&",isdisabled:"=",onfileblur:"&"},template:"<div class='input-group'><input class='form-control input-sm' type='text' ng-blur='onblur()' ng-disabled='isdisabled' id='ScopeId_{{$id}}' title='{{filename}}' ng-model='filename' ng-keydown='onkeydown($event)' ng-change='onchangeCallback()' undoredodirective  model='model' propertyname='propertyname'/><span class='input-group-addon button-intellisense' ng-click='showBusObjectIntellisenseList($event)'><\/span><\/div>",link:function(n){n.receiveList=function(t){n.busobjectlist=t;n.busobjectlist&&(setSingleLevelAutoComplete(n.inputElement,n.busobjectlist,n,"Description","Description"),$(n.inputElement).data("ui-autocomplete")&&$(n.inputElement).autocomplete("search",$(n.inputElement).val().trim()))};n.onchangeCallback=function(){var t;n.busobjectlist&&(t=n.busobjectlist.filter(function(t){return t.Description==n.filename}));t&&t.length>0?(n.model.IsChildOfInboundFileBase=t[0].IsChildOfInboundFileBase,n.model.lstObjectMethod=t[0].LstObjectMethods,n.model.lstFileCollection=t[0].LstFieldNames,n.model.BusinessObject=t):(n.model.IsChildOfInboundFileBase=!1,n.model.lstObjectMethod=[],n.model.lstFileCollection=[],n.model.BusinessObject=[]);n.onfilechange&&n.onfilechange()};n.onblur=function(){n.onfileblur&&n.onfileblur()};n.showBusObjectIntellisenseList=function(){n.busobjectlist?(n.inputElement.focus(),$(n.inputElement).data("ui-autocomplete")&&$(n.inputElement).autocomplete("search",$(n.inputElement).val().trim())):(n.inputElement||(n.inputElement=$(event.target).prevAll("input[type='text']")),$.connection.hubMain.server.getBusObjectsByType(n.filetype).done(function(t){var t=JSON.parse(t);n.receiveList(t)}))};n.onkeydown=function(t){n.inputElement||(n.inputElement=$(t.target));n.busobjectlist?t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE&&$(n.inputElement).data("ui-autocomplete")&&($(n.inputElement).autocomplete("search",$(n.inputElement).val().trim()),t.preventDefault()):($.connection.hubMain.server.getBusObjectsByType(n.filetype).done(function(i){var i=JSON.parse(i);t&&t.keyCode!=$.ui.keyCode.ESCAPE&&n.receiveList(i)}),t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE&&t.preventDefault())}}}}]);app.directive("entitycolumnintellisense",["$rootScope","$EntityIntellisenseFactory","$ValidationService","CONSTANTS",function(n,t){return{retrict:"E",replace:!0,scope:{model:"=",formodel:"=",modebinding:"=",entityid:"=",propertyname:"=",queryid:"=",lstloadedentitytrees:"=",lstloadedentitycolumnstree:"=",isshowcolumnvalues:"="},template:"<div><span class='info-tooltip dtc-span' ng-if='model.errors.invalid_data_field' ng-attr-title='{{model.errors.invalid_data_field}}' style='color:red !important'><i class='fa fa-exclamation-circle' aria-hidden='true'><\/i><\/span><div class='input-group'><input type='text' id='ScopeId_{{$id}}' class='form-control input-sm' title='{{modebinding}}' ng-model='modebinding' undoredodirective model='model' propertyname='propertyname' ng-keydown='filterIntelliseneList($event)' ng-keyup='validateDataField()' ng-change='validateDataField()'/><span class='input-group-addon button-intellisense' ng-click='showEntityColumnIntellisenseList($event)'><\/span><\/div><\/div>",link:function(n){n.$watch("entityid",function(i){if(i){n.lstEntityColumnList=[];var r=t.getEntityIntellisense();n.lstEntityColumnList=getEntityAttributeByType(r,n.entityid,"Column")}});n.$watch("queryid",function(t){n.PopulateColumnList(t)});n.PopulateColumnList=function(i){var u=t.getEntityIntellisense(),r=PopulateColumnList(i,n.formodel,u,n.lstloadedentitycolumnstree);r&&(n.lstColumnList=r.list,n.attributeName=r.attribute)};n.PopulateQueryColumnFromList=function(t){var u=!1,f,i,r;n.lstloadedentitycolumnstree&&(i=n.lstloadedentitycolumnstree.filter(function(n){return n.EntityName==t}),i&&i.length>0&&(n.lstColumnList=JSON.parse(JSON.stringify(i[0].lstselectedobjecttreefields)),u=!0));u||(f=GetQueryListFromObject(n.formodel),f&&(i=f.filter(function(n){return n.dictAttributes.ID==t}),i&&i.length>0&&(r={EntityName:i[0].dictAttributes.ID,IsVisible:!0,selectedobjecttreefield:undefined,lstselectedobjecttreefields:[],IsQuery:!0},n.lstloadedentitycolumnstree&&(n.lstloadedentitycolumnstree.push(r),i[0].dictAttributes.sfwQueryRef&&$.connection.hubForm.server.getEntityQueryColumns(i[0].dictAttributes.sfwQueryRef,"LoadQueryFieldsForLookup").done(function(n){var t=GetFormFileScope(t.formodel);t&&t.receiveQueryFields&&t.receiveQueryFields(n,i[0].dictAttributes.sfwQueryRef)}),u=!0),r.lstselectedobjecttreefields||(r.lstselectedobjecttreefields=[]),n.lstColumnList=r.lstselectedobjecttreefields)))};n.filterIntelliseneList=function(t){t.key!="Down"&&t.key!="Up"&&t.key!="Left"&&t.key!="Right"&&(n.inputElement||(n.inputElement=$(t.target)),t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE?$(n.inputElement).data("ui-autocomplete")&&(n.lstEntityColumnList||n.lstColumnList)&&($(n.inputElement).autocomplete("search",$(n.inputElement).val()),t.preventDefault()):i(n.inputElement))};n.showEntityColumnIntellisenseList=function(t){var r=$(t.target).prevAll("input[type='text']");n.inputElement=r;i(r);r.focus();$(r).data("ui-autocomplete")&&$(r).autocomplete("search",$(r).val());t&&t.stopPropagation()};var i=function(t){n.entityid!=undefined&&n.entityid!=""?(n.attributeName="ID",n.isshowcolumnvalues&&(n.attributeName="Value"),setSingleLevelAutoComplete(t,n.lstEntityColumnList,n,n.attributeName,n.attributeName)):n.lstColumnList&&(n.PopulateColumnList(n.queryid),setSingleLevelAutoComplete(t,n.lstColumnList,n,n.attributeName,n.attributeName))};n.validateDataField=function(){}}}}]);app.directive("entityexpressionintellisense",["$EntityIntellisenseFactory","$ValidationService","CONSTANTS",function(n,t,i){return{retrict:"E",replace:!0,scope:{model:"=",modelvalue:"=",entityid:"=",propertyname:"="},template:"<div><span class='info-tooltip dtc-span' ng-if='model.errors.invalid_expression' ng-attr-title='{{model.errors.invalid_expression}}' style='color:red !important'><i class='fa fa-exclamation-circle' aria-hidden='true'><\/i><\/span><div class='input-group'><input type='text' id='ScopeId_{{$id}}' class='form-control input-sm' title='{{modelvalue}}' ng-model='modelvalue' undoredodirective model='model' propertyname='propertyname' undorelatedfunction ='validateExpression' ng-keydown='getEntityExpressionList($event)' ng-keyup='validateExpression()' ng-change='validateExpression()'/>\t<span class='input-group-addon button-intellisense' ng-click='showExpressionIntellisenseList($event)'><\/span><\/div><\/div>",link:function(r){r.createExpressionList=function(){r.lstEntityExpressionList=[];var t=n.getEntityIntellisense();r.lstEntityExpressionList=getEntityAttributeByType(t,r.entityid,"Expression")};r.getEntityExpressionList=function(n){var t=$(n.target);r.inputElement=t;r.createExpressionList();n.ctrlKey&&n.keyCode==$.ui.keyCode.SPACE&&$(t).data("ui-autocomplete")?($(t).autocomplete("search",$(t).val()),n.preventDefault()):r.entityid&&setSingleLevelAutoComplete(t,r.lstEntityExpressionList,r)};r.showExpressionIntellisenseList=function(n){r.inputElement||(r.inputElement=$(n.target).prevAll("input[type='text']"));r.inputElement.focus();r.createExpressionList();r.inputElement&&(setSingleLevelAutoComplete(r.inputElement,r.lstEntityExpressionList,r),$(r.inputElement).data("ui-autocomplete")&&$(r.inputElement).autocomplete("search",$(r.inputElement).val()));n&&n.stopPropagation()};r.validateExpression=function(){if(r.propertyname){var n=r.propertyname.split(".")[1],u=t.getListByPropertyName(r.lstEntityExpressionList,"ID",!1);t.checkValidListValue(u,r.model,$(r.inputElement).val(),n,"invalid_expression",i.VALIDATION.INVALID_EXPRESSION,undefined)}}}}}]);app.directive("entitymethodsintellisense",["$rootScope","$filter","$ValidationService","CONSTANTS","$NavigateToFileService","$Entityintellisenseservice",function(n,t,i,r,u,f){return{retrict:"E",replace:!0,scope:{model:"=",entityid:"=",modelvalue:"=",propertyname:"=",showonlycollection:"=",showonlyobject:"=",showonlyobjectmethods:"=",showrules:"=",showxmlmethods:"=",errorprop:"=",validate:"=",methodtext:"=",onchangecallback:"&"},template:"<div><label class='control-label col-xs-5' ng-if='methodtext && (!modelvalue || !modelvalue.trim())'>{{methodtext}}<\/label><label class='control-label col-xs-5' ng-if='methodtext && modelvalue && modelvalue.trim()'><a ng-click='navigateToMethodClick(modelvalue)'>{{methodtext}}<\/a><\/label><div ng-class='methodtext?\"col-xs-7\":\"col-xs-12\" '><div class='input-group'><span class='info-tooltip dtc-span' ng-if='errorprop' ng-attr-title='{{errorprop}}' style='color:red !important'><i class='fa fa-exclamation-circle' aria-hidden='true'><\/i><\/span><input type='text' id='ScopeId_{{$id}}' class='form-control input-sm' title='{{modelvalue}}' ondrop='return false' ng-model='modelvalue' undoredodirective model='model' propertyname='propertyname' undorelatedfunction ='validateMethod' ng-keydown='getEntityMethodsList($event)' ng-keyup='validateMethod()' ng-change='validateMethod();onChange()'/>\t<span class='input-group-addon button-intellisense' ng-click='showEntityMethodsIntellisenseList($event)'><\/span><\/div><\/div><\/div>",link:function(n){n.createMethodsList=function(){var i=null,r;n.lstMethods=[];n.model&&n.model.dictAttributes.sfwExecuteMethodType&&(n.showrules=!1,n.showonlyobjectmethods=!1,n.showxmlmethods=!1,n.model.dictAttributes.sfwExecuteMethodType=="Rule"?n.showrules=!0:n.model.dictAttributes.sfwExecuteMethodType=="ObjectMethod"?n.showonlyobjectmethods=!0:n.model.dictAttributes.sfwExecuteMethodType=="XmlMethod"&&(n.showxmlmethods=!0));n.showrules?(r=f.GetIntellisenseData(n.entityid,"","",!0,!1,!1,!0,!1,!1),r&&r.length>0&&(i=r.filter(function(n){return!n.IsPrivate&&!n.IsStatic&&n.Status=="Active"}))):i=n.showonlyobjectmethods?f.GetIntellisenseData(n.entityid,"","",!0,!1,!0,!1,!1,!1):n.showxmlmethods?f.GetIntellisenseData(n.entityid,"","",!0,!1,!1,!1,!1,!0):f.GetIntellisenseData(n.entityid,"","",!0,!1,!0,!1,!1,!1);i&&i.length>0&&(n.showonlycollection?(i=t("filter")(i,{ReturnType:"Collection"}),i&&i.length>0&&(n.lstMethods=i)):n.showonlyobject?(i=t("filter")(i,{ReturnType:"Object"}),i&&i.length>0&&(n.lstMethods=i)):angular.forEach(i,function(t){t&&t.ID&&n.lstMethods.push(t)}))};n.getEntityMethodsList=function(t){var i=$(t.target);n.inputElement=i;n.createMethodsList();t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE?(n.entityid&&$(i).data("ui-autocomplete")&&$(i).autocomplete("search",$(i).val()),t.preventDefault()):n.entityid&&setSingleLevelAutoComplete(i,n.lstMethods,n)};n.showEntityMethodsIntellisenseList=function(t){n.inputElement||(n.inputElement=$(t.target).prevAll("input[type='text']"));n.inputElement.focus();n.createMethodsList();n.inputElement&&n.entityid&&(setSingleLevelAutoComplete(n.inputElement,n.lstMethods,n),$(n.inputElement).data("ui-autocomplete")&&$(n.inputElement).autocomplete("search",$(n.inputElement).val()));t&&t.stopPropagation()};n.onChange=function(){n.onchangecallback&&(n.model&&n.propertyname&&setPropertyValue(n.model,n.propertyname,n.modelvalue),n.onchangecallback())};n.validateMethod=function(){var f,t,e,o,u;n.propertyname&&n.validate&&(f=n.propertyname.split("."),t=f[f.length-1],e=n.inputElement?$(n.inputElement).val():n.model.dictAttributes[t],o=i.getListByPropertyName(n.lstMethods,"ID",!1),u="",t&&(t=="sfwXmlMethod"||t=="sfwLoadSource"||t=="sfwObjectMethod")?u="invalid_method":t=="sfwRetrievalMethod"&&(u="invalid_retrieval_method"),e?i.checkValidListValue(o,n.model,e,t,u,r.VALIDATION.INVALID_METHOD,undefined):i.checkValidListValue(["null"],n.model,"null",t,u,r.VALIDATION.INVALID_METHOD,undefined))};n.navigateToMethodClick=function(t){var r,e,i,f;n.lstMethods||n.createMethodsList();n.validateMethod();r="";n.propertyname&&(e=n.propertyname.split("."),i=e[e.length-1],i&&(i=="sfwXmlMethod"||i=="sfwLoadSource")?r="invalid_method":i=="sfwRetrievalMethod"&&(r="invalid_retrieval_method"));f=!1;n.model.errors?n.model.errors&&!n.model.errors[r]&&(f=!0):f=!0;t&&n.entityid&&f&&n.lstMethods&&n.lstMethods.length>0&&(n.model.dictAttributes&&n.model.dictAttributes.sfwExecuteMethodType?n.model.dictAttributes.sfwExecuteMethodType=="Rule"?u.NavigateToRule(t):n.model.dictAttributes.sfwExecuteMethodType=="ObjectMethod"?u.NavigateToFile(n.entityid,"objectmethods",t):n.model.dictAttributes.sfwExecuteMethodType=="XmlMethod"&&u.NavigateToFile(n.entityid,"methods",t):u.NavigateToFile(n.entityid,"objectmethods",t))}}}}]);app.directive("objectfieldintellisense",[function(){return{retrict:"E",replace:!0,scope:{model:"=",modelvalue:"=",parameterlist:"=",propertyname:"="},template:"<div class='input-group'><input type='text' id='ScopeId_{{$id}}' class='form-control input-sm' title='{{modelvalue}}' ng-model='modelvalue' undoredodirective model='model' propertyname='propertyname' ng-keydown='getObjectFieldList($event)'/>\t<span class='input-group-addon button-intellisense' ng-click='showObjectFieldIntellisenseList($event)'><\/span><\/div>",link:function(n){var t=function(){n.parameterlist&&n.parameterlist.length>0&&(n.paramNameList=[],angular.forEach(n.parameterlist,function(t){"ParamName"in t&&n.paramNameList.push(t.ParamName)}))};n.getObjectFieldList=function(t){t.key!="Down"&&t.key!="Up"&&t.key!="Left"&&t.key!="Right"&&(n.inputElement||(n.inputElement=$(t.target)),t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE?n.paramNameList&&n.paramNameList.length>0&&$(n.inputElement).data("ui-autocomplete")&&($(n.inputElement).autocomplete("search",$(n.inputElement).val()),t.preventDefault()):n.paramNameList&&n.paramNameList.length>0&&setSingleLevelAutoComplete(n.inputElement,n.paramNameList,n),t.ctrlKey&&(t.keyCode===83||t.keyCode===90||t.keyCode===89)||!t.stopPropagation||t.stopPropagation())};n.showObjectFieldIntellisenseList=function(t){n.inputElement||(n.inputElement=$(t.target).prevAll("input[type='text']"));n.inputElement.focus();n.inputElement&&n.paramNameList&&n.paramNameList.length>0&&(setSingleLevelAutoComplete(n.inputElement,n.paramNameList,n),$(n.inputElement).data("ui-autocomplete")&&$(n.inputElement).autocomplete("search",$(n.inputElement).val()));t&&t.stopPropagation()};t()}}}]);app.directive("commonIntellisense",["$compile","$rootScope","$ValidationService","CONSTANTS",function(n,t,i,r){return{restrict:"E",replace:!0,scope:{collection:"=",selectedItem:"=",displayPropertyName:"=",selectedPropertyName:"=",changeCallback:"&",updateDataCallback:"&",onblurcallback:"&",model:"=",propertyname:"=",isDisable:"=",isReset:"=",errorprop:"=",validate:"="},link:function(n){n.onKeyDown=function(t){(!n.inputElement||n.isReset)&&(n.updateDataCallback&&n.updateDataCallback(),n.initializeIntellisense());t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE&&(n.showIntellisenseList(),t.preventDefault())};n.onIntellisenseButtonClick=function(t){(!n.inputElement||n.isReset)&&n.initializeIntellisense();n.inputElement.focus();n.showIntellisenseList();t&&t.stopPropagation()};n.showIntellisenseList=function(){n.inputElement&&$(n.inputElement).data("ui-autocomplete")&&$(n.inputElement).autocomplete("search",$(n.inputElement).val().trim())};n.initializeIntellisense=function(){n.collection||(n.collection=[]);n.inputElement=$("#ScopeId_"+n.$id);$(n.inputElement).focus();setSingleLevelAutoComplete($(n.inputElement),n.collection,n,n.selectedPropertyName,n.displayPropertyName)};n.onChange=function(){n.changeCallback&&(n.model&&n.propertyname&&setPropertyValue(n.model,n.propertyname,n.selectedItem),n.changeCallback());n.validateInput()};n.validateInput=function(){var u;if(n.propertyname&&n.validate){var f=n.propertyname.split("."),t=f[f.length-1],e=r.VALIDATION.INVALID_FIELD;t=="sfwEntityField"&&(e=r.VALIDATION.ENTITY_FIELD_INCORRECT);u=n.collection;n.selectedPropertyName&&(u=i.getListByPropertyName(n.collection,n.selectedPropertyName));i.checkValidListValue(u,n.model,$(n.inputElement).val(),t,t,e,undefined)}}},template:'<div class="input-group full-width"><span class="info-tooltip dtc-span" ng-if="errorprop" ng-attr-title="{{errorprop}}" style="color:red !important"><i class="fa fa-exclamation-circle" aria-hidden="true"><\/i><\/span><input ng-disabled="isDisable" type= "text" id="ScopeId_{{$id}}" class="form-control input-sm" title="{{selectedItem}}" ng-model="selectedItem" ng-keyup="validateInput()" ng-change="onChange()" ng-keydown="onKeyDown($event)" ng-blur="onblurcallback()" undoredodirective model="model" propertyname="propertyname" undorelatedfunction ="validateInput"/><span ng-show="!isDisable" class="input-group-addon button-intellisense" ng-click="onIntellisenseButtonClick($event)"><\/span><\/div>'}}]);app.directive("ruleIntellisense",["$compile","$rootScope","$ValidationService","CONSTANTS","$EntityIntellisenseFactory",function(n,t,i,r,u){return{restrict:"E",replace:!0,scope:{entityId:"=",nonStatic:"=",returnTypes:"=",ruleTypes:"=",selectedRule:"=",changeCallback:"&",onblurcallback:"&",model:"=",propertyname:"=",isDisable:"=",vErrorprop:"=",vValidate:"=",vAllowEmpty:"=",vFieldName:"="},link:function(n){n.onKeyDown=function(t){var h=t.target,e=getSplitArray(h.value,h.selectionStart),w=[],y,c,f,o,v,r,i;n.nonStatic||(y=u.getEntityIntellisense(),c=y,w=c.filter(function(t){return t.Rules.some(function(i){return i.IsStatic&&(n.entityId&&t.ID==n.entityId||!i.IsPrivate)})}));var l=[],a=[],p=[];if(n.entityId)for(var y=u.getEntityIntellisense(),c=y,s=n.entityId;s!="";)o=c.filter(function(n){return n.ID==s}),o&&o.length>0?(l=o[0].Rules.filter(function(t){return!t.IsStatic&&(s==n.entityId||!t.IsPrivate)}),a=o[0].Attributes.filter(function(n){return n.DataType=="Object"}),n.entityId!=s&&(l=l.concat(a)),s=o[0].ParentId,p=p.concat(l)):s="";if(f=w.concat(p),e.length>0)for(i=0;i<e.length;i++)if(r=f.filter(function(n){return n.ID==e[i]}),r.length>0&&typeof r[0].Rules!="undefined"&&i<e.length)r[0].ID==e[i]&&(f=r[0].Rules.filter(function(t){return t.IsStatic&&(n.entityId&&r[0].ID==n.entityId||!t.IsPrivate)}));else if(r.length>0&&r[0].DataType!=undefined&&i<e.length){if(r[0].DataType=="Object"&&r[0].ID==e[i])for(s=r[0].Entity,f=[];s!="";)o=c.filter(function(n){return n.ID==s}),o&&o.length>0?(f=f.concat(o[0].Rules.filter(function(n){return!n.IsStatic&&!n.IsPrivate})),a=o[0].Attributes.filter(function(n){return n.DataType=="Object"}),f=f.concat(a),s=o[0].ParentId):s=""}else r.length>0&&r[0].RuleType!=undefined&&i<e.length?(r[0].RuleType=="LogicalRule"||r[0].RuleType=="DecisionTable"||r[0].RuleType=="ExcelMatrix")&&(f=[]):i!=e.length-1&&(f=[]);if(n.ruleTypes)for(i=0,v=n.ruleTypes.length;i<v;i++)n.ruleTypes[i]=n.ruleTypes[i].toLowerCase();if(n.returnTypes)for(i=0,v=n.returnTypes.length;i<v;i++)n.returnTypes[i]=n.returnTypes[i].toLowerCase();if(r=[],e.length>0){for(i=0;i<e.length;i++)r=f.filter(function(t){return t.ID.toLowerCase().contains(e[i].toLowerCase())&&(!t.Status||t.Status.toLowerCase()==="active")&&(!t.RuleType||!n.ruleTypes||!n.ruleTypes.length||n.ruleTypes.indexOf(t.RuleType.toLowerCase())>-1)&&(!t.ReturnType||!n.returnTypes||!n.returnTypes.length||n.returnTypes.indexOf(t.ReturnType.toLowerCase())>-1)});f=r}setRuleIntellisense($(h),f,n);t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE&&$(h).data("ui-autocomplete")&&($(h).autocomplete("search",$(h).val()),t.preventDefault())};n.onIntellisenseButtonClick=function(t){(!n.inputElement||n.isReset)&&n.initializeIntellisense();n.inputElement.focus();n.showIntellisenseList();t&&t.stopPropagation()};n.showIntellisenseList=function(){n.inputElement&&$(n.inputElement).data("ui-autocomplete")&&$(n.inputElement).autocomplete("search",$(n.inputElement).val().trim())};n.initializeIntellisense=function(){n.collection||(n.collection=[]);n.inputElement=$("#ScopeId_"+n.$id);$(n.inputElement).focus();setSingleLevelAutoComplete($(n.inputElement),n.collection,n,n.selectedPropertyName,n.displayPropertyName)};n.onChange=function(){n.validate();n.changeCallback&&(n.model&&n.propertyname&&setPropertyValue(n.model,n.propertyname,n.selectedRule),n.changeCallback())};n.validate=function(){if(n.propertyname&&n.validate){var t=n.propertyname.split("."),r=t[t.length-1];i.validateRule(n.model,n.selectedRule,n.entityId,n.nonStatic,n.returnTypes,n.ruleTypes,n.propertyname,n.vAllowEmpty,n.vFieldName)}}},template:'<div class="input-group full-width"><span class="info-tooltip dtc-span" ng-if="vErrorprop" ng-attr-title="{{vErrorprop}}" style="color:red !important"><i class="fa fa-exclamation-circle" aria-hidden="true"><\/i><\/span><input ng-disabled="isDisable" type= "text" id="ScopeId_{{$id}}" class="form-control input-sm" title="{{selectedRule}}" ng-model="selectedRule" ng-keyup="onKeyDown($event)" ng-change="onChange()" ng-blur="onblurcallback()" undoredodirective model="model" propertyname="propertyname" undorelatedfunction ="validateInput"/><span ng-show="!isDisable" class="input-group-addon button-intellisense" ng-click="onIntellisenseButtonClick($event)"><\/span><\/div>'}}]);app.directive("commonIntellisenseWithoutUndoRedo",["$compile","$rootScope","$ValidationService","CONSTANTS",function(n,t,i,r){return{restrict:"E",replace:!0,scope:{collection:"=",selectedItem:"=",displayPropertyName:"=",selectedPropertyName:"=",changeCallback:"&",model:"=",propertyname:"=",isDisable:"=",isReset:"=",errorprop:"=",validate:"=",isinsidedialog:"="},link:function(n){n.onKeyDown=function(t){(!n.inputElement||n.isReset)&&n.initializeIntellisense();t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE&&(n.showIntellisenseList(),t.preventDefault())};n.onIntellisenseButtonClick=function(t){(!n.inputElement||n.isReset)&&n.initializeIntellisense();n.inputElement.focus();n.showIntellisenseList();t&&t.stopPropagation()};n.showIntellisenseList=function(){n.inputElement&&$(n.inputElement).data("ui-autocomplete")&&$(n.inputElement).autocomplete("search",$(n.inputElement).val().trim())};n.initializeIntellisense=function(){n.collection||(n.collection=[]);n.inputElement=$("#ScopeId_"+n.$id);$(n.inputElement).focus();setSingleLevelAutoComplete($(n.inputElement),n.collection,n,n.selectedPropertyName,n.displayPropertyName)};n.onChange=function(){n.validateInput();n.changeCallback&&(n.model&&n.propertyname&&setPropertyValue(n.model,n.propertyname,n.selectedItem),n.changeCallback())};n.validateInput=function(){var u;if(n.propertyname&&n.validate){var f=n.propertyname.split("."),t=f[f.length-1],e=r.VALIDATION.INVALID_FIELD;t=="sfwEntityField"&&(e=r.VALIDATION.ENTITY_FIELD_INCORRECT);u=n.collection;n.selectedPropertyName&&(u=i.getListByPropertyName(n.collection,n.selectedPropertyName));i.checkValidListValue(u,n.model,$(n.inputElement).val(),t,t,e,undefined,!1,n.isinsidedialog)}}},template:'<div style="position:relative"><span class="info-tooltip dtc-span" ng-show="errorprop" ng-attr-title="{{errorprop}}" style="color:red !important"><i class="fa fa-exclamation-circle" aria-hidden="true"><\/i><\/span><div class="input-group"><input ng-disabled="isDisable" type= "text" id="ScopeId_{{$id}}" class="form-control input-sm" title="{{selectedItem}}" ng-model="selectedItem" ng-keyup="validateInput()" ng-change="onChange()" ng-keydown="onKeyDown($event)"/><span ng-show="!isDisable" class="input-group-addon button-intellisense" ng-click="onIntellisenseButtonClick($event)"><\/span><\/div><\/div>'}}]);app.directive("templateNameIntellisense",["$ValidationService","CONSTANTS",function(n,t){return{restrict:"E",replace:!0,scope:{collection:"=",modelname:"=",onchangecallback:"&",model:"=",propertyname:"=",validate:"=",errorprop:"="},link:function(i){i.onTemplateNameChange=function(n){if(n.key!="Down"&&n.key!="Up"&&n.key!="Left"&&n.key!="Right"){var t=n.target;i.inputElement=t;n.ctrlKey&&n.keyCode==$.ui.keyCode.SPACE&&$(t).data("ui-autocomplete")?($(t).autocomplete("search",$(t).val().trim()),n.preventDefault()):r(t)}};i.showTemplateNameList=function(n){var t=$(n.target).prevAll("input[type='text']");t.focus();i.inputElement=t;r(t);$(t).data("ui-autocomplete")&&$(t).autocomplete("search",$(t).val().trim());n&&n.stopPropagation()};var r=function(n){i.collection&&i.collection.length>0&&setSingleLevelAutoComplete($(n),i.collection)};i.$watch("modelname",function(){i.onchangecallback&&i.onchangecallback()},!0);i.validateTemplateName=function(){if(i.validate){var r=i.propertyname.split("."),u=r[r.length-1];n.checkValidListValue(i.collection,i.model,$(i.inputElement).val(),u,u,t.VALIDATION.INVALID_TEMPLATE,undefined)}}},template:'<div><div class="input-group"><span class="info-tooltip dtc-span" ng-if="errorprop" ng-attr-title="{{errorprop}}" style="color:red !important"><i class="fa fa-exclamation-circle" aria-hidden="true"><\/i><\/span><input type="text" class="form-control input-sm" title="{{modelname}}" ng-model="modelname" ng-keydown="onTemplateNameChange($event)" ng-keyup="validateTemplateName()" ng-change="validateTemplateName()" undoredodirective model="model" propertyname="propertyname" undorelatedfunction ="validateTemplateName"><span class="input-group-addon button-intellisense" ng-click="showTemplateNameList($event);"><\/span><\/div><\/div>'}}]);app.directive("constantintellisene",["$compile","$rootScope","$resourceFactory",function(n,t,i){return{restrict:"E",replace:!0,scope:{constantbinding:"=",model:"=",propertyname:"="},link:function(n){n.onKeyDown=function(t){t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE?(n.showIntellisenseList(),t.preventDefault()):n.initializeIntellisense()};n.onKeyUp=function(){n.initializeIntellisense()};n.onIntellisenseButtonClick=function(t){n.inputElement||n.initializeIntellisense();n.inputElement.focus();n.showIntellisenseList();t&&t.stopPropagation()};n.showIntellisenseList=function(){n.inputElement&&$(n.inputElement).data("ui-autocomplete")&&n.collection&&$(n.inputElement).autocomplete("search",$(n.inputElement).val().trim())};n.initializeIntellisense=function(){var t,u,r;if(n.inputElement=$("#ScopeId_"+n.$id),$(n.inputElement).focus(),n.collection||(n.collection=[]),n.collection=i.getConstantsList(),n.inputElement&&n.inputElement.length>0&&(t=getSplitArray($(n.inputElement).val(),n.inputElement[0].selectionStart),t.length>0))for(u=0;u<t.length;u++)if(r=n.collection.filter(function(n){return n.ID==t[u]}),r.length>0&&r[0].Type&&r[0].ID==t[u]&&r[0].Type=="Constant"&&r[0].Type=="Constant"){n.collection=i.getConstantsList(t.join("."));break}n.inputElement&&setRuleIntellisense($(n.inputElement),n.collection)}},template:'<div class="input-group"><input type= "text" id="ScopeId_{{$id}}" class="form-control input-sm" title="{{constantbinding}}" ng-model="constantbinding" ng-keydown="onKeyDown($event)" ng-keyup="onKeyUp($event)" undoredodirective model="model" propertyname="propertyname"/><span class="input-group-addon button-intellisense" ng-click="onIntellisenseButtonClick($event)"><\/span><\/div>'}}]);app.directive("entityquerycolumnsintellisense",["$rootScope","$EntityIntellisenseFactory","$ValidationService","CONSTANTS",function(){return{retrict:"E",replace:!0,scope:{model:"=",formodel:"=",modebinding:"=",propertyname:"=",queryid:"="},template:"<div><span class='info-tooltip dtc-span' ng-if='model.errors.invalid_data_field' ng-attr-title='{{model.errors.invalid_data_field}}' style='color:red !important'><i class='fa fa-exclamation-circle' aria-hidden='true'><\/i><\/span><div class='input-group'><input type='text' id='ScopeId_{{$id}}' class='form-control input-sm' title='{{modebinding}}' ng-model='modebinding' undoredodirective model='model' propertyname='propertyname' ng-keydown='filterIntelliseneList($event)'/><span class='input-group-addon button-intellisense' ng-click='showEntityQueryColumnIntellisenseList($event)'><\/span><\/div><\/div>",link:function(n){var t=function(t,i){n.queryid!=undefined&&n.queryid!=""&&(setSingleLevelAutoComplete(t,n.lstQueryColumnList,n,"CodeID","CodeID"),i&&$(t).data("ui-autocomplete")&&$(t).autocomplete("search",$(t).val()))};n.$watch("queryid",function(t,i){t!=i&&(n.iblnresetData=!0,n.lstQueryColumnList=[])});n.loadQueryColumns=function(i){$.connection.hubForm.server.getEntityQueryColumns(n.queryid,"").done(function(r){n.$evalAsync(function(){n.lstQueryColumnList=r;n.inputElement&&t(n.inputElement,i)})})};n.filterIntelliseneList=function(i){(!n.lstQueryColumnList||n.iblnresetData)&&(n.iblnresetData=!1,n.loadQueryColumns(!1));i.key!="Down"&&i.key!="Up"&&i.key!="Left"&&i.key!="Right"&&(n.inputElement||(n.inputElement=$(i.target)),i.ctrlKey&&i.keyCode==$.ui.keyCode.SPACE?$(n.inputElement).data("ui-autocomplete")&&n.lstQueryColumnList&&($(n.inputElement).autocomplete("search",$(n.inputElement).val()),i.preventDefault()):t(n.inputElement),i.stopPropagation&&i.stopPropagation())};n.showEntityQueryColumnIntellisenseList=function(t){var i=$(t.target).prevAll("input[type='text']");n.inputElement=i;(!n.lstQueryColumnList||n.iblnresetData)&&n.loadQueryColumns(!0);i.focus();$(i).data("ui-autocomplete")&&$(i).autocomplete("search",$(i).val());t&&t.stopPropagation()}}}}]);app.directive("rulegroupintellisense",["$EntityIntellisenseFactory","$ValidationService","CONSTANTS","$NavigateToFileService",function(n,t,i,r){return{restrict:"E",replace:!0,scope:{model:"=",modelvalue:"=",propertyname:"=",entityid:"=",labelText:"@",labelClass:"@",errorprop:"=",validate:"=",callback:"&"},template:"<div><label class={{labelClass}} ng-if='!modelvalue || errorprop'>{{labelText}} <\/label><label class={{labelClass}} ng-if='modelvalue && !errorprop'><a ng-click='selectGroupClick(modelvalue)'>{{labelText}}<\/a><\/label><div class='col-xs-7'><span class='info-tooltip dtc-span' ng-if='errorprop' ng-attr-title='{{errorprop}}' style='color:red !important'><i class='fa fa-exclamation-circle' aria-hidden='true'><\/i><\/span><div class='input-group'><input type='text' id='ScopeId_{{$id}}' class='form-control input-sm' title='{{modelvalue}}' ng-model='modelvalue' undoredodirective model='model' propertyname='propertyname' undorelatedfunction ='validateRuleGroup' ng-change='validateRuleGroup()' ng-keyup='LoadRuleList($event)' ng-keydown='filterIntelliseneList($event)'/><span class='input-group-addon button-intellisense' ng-click='showRuleGroupIntellisenseList($event)'><\/span><\/div><\/div><\/div>",link:function(n){var u=function(t){setSingleLevelAutoComplete(t,n.lstRuleGroupList,n)};n.LoadRuleGroupList=function(t){n.entityid&&hubMain.server.getGroupList(n.entityid).done(function(i){n.$evalAsync(function(){i&&(n.lstRuleGroupList=n.getFormatedData(i),n.inputElement||(n.inputElement=$("#ScopeId_"+n.$id)),n.inputElement&&($(n.inputElement).focus(),u(n.inputElement),t&&$(n.inputElement).data("ui-autocomplete")&&$(n.inputElement).autocomplete("search",$(n.inputElement).val())))})})};n.getFormatedData=function(n){for(var i=[],t=0;t<n.length;t++)n[t].dictAttributes&&n[t].dictAttributes.ID&&i.push({ID:n[t].dictAttributes.ID});return i};n.filterIntelliseneList=function(t){n.inputElement||(n.inputElement=$(t.target));t.key!="Down"&&t.key!="Up"&&t.key!="Left"&&t.key!="Right"&&t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE&&(n.modelvalue&&n.modelvalue!=""&&n.lstRuleGroupList?$(n.inputElement).data("ui-autocomplete")&&n.lstRuleGroupList&&($(n.inputElement).autocomplete("search",$(n.inputElement).val()),t.preventDefault()):(n.LoadRuleGroupList(!0),t.preventDefault()))};n.showRuleGroupIntellisenseList=function(t){var i=$(t.target).prevAll("input[type='text']");n.inputElement=i;n.LoadRuleList();u(i);i.focus();t&&t.stopPropagation()};n.LoadRuleList=function(t){n.inputElement||(n.inputElement=$(t.target));n.modelvalue&&n.lstRuleGroupList||n.LoadRuleGroupList(!0);n.validateRuleGroup()};n.selectGroupClick=function(t){n.validateRuleGroup();var i=n.propertyname.split(".")[1];n.validate&&t&&t!=""&&n.model.errors&&!n.model.errors[i]&&(n.callback&&n.callback(),r.NavigateToFile(n.entityid,"groupslist",t));!n.validate&&t&&t!=""&&(n.callback&&n.callback(),r.NavigateToFile(n.entityid,"groupslist",t))};n.validateRuleGroup=function(){if(n.propertyname&&n.validate){var r=n.propertyname.split(".")[1],u=t.getListByPropertyName(n.lstRuleGroupList,"ID");t.checkValidListValue(u,n.model,$(n.inputElement).val(),r,r,i.VALIDATION.INVALID_GROUP,undefined)}};n.LoadRuleGroupList(!1)}}}]);app.directive("rulegroupintellisensewithoutundoredo",["$EntityIntellisenseFactory","$ValidationService","CONSTANTS","$NavigateToFileService",function(n,t,i,r){return{restrict:"E",replace:!0,scope:{model:"=",modelvalue:"=",propertyname:"=",entityid:"=",labelText:"@",labelClass:"@",errorprop:"=",validate:"=",callback:"&"},template:"<div><label class={{labelClass}} ng-if='!modelvalue || errorprop'>{{labelText}} <\/label><label class={{labelClass}} ng-if='modelvalue && !errorprop'><a ng-click='selectGroupClick(modelvalue)'>{{labelText}}<\/a><\/label><div class='col-xs-7' ><span class='info-tooltip dtc-span' ng-if='errorprop' ng-attr-title='{{errorprop}}' style='color:red !important'><i class='fa fa-exclamation-circle' aria-hidden='true'><\/i><\/span><div class='input-group'><input  type='text' id='ScopeId_{{$id}}' class='form-control input-sm' title='{{modelvalue}}' ng-model='modelvalue'  ng-change='validateRuleGroup()' ng-keyup='LoadRuleList($event)' ng-keydown='filterIntelliseneList($event)'/><span class='input-group-addon button-intellisense' ng-click='showRuleGroupIntellisenseList($event)'><\/span><\/div><\/div><\/div>",link:function(n){var u=function(t){setSingleLevelAutoComplete(t,n.lstRuleGroupList,n)};n.LoadRuleGroupList=function(t){n.entityid&&hubMain.server.getGroupList(n.entityid).done(function(i){n.$evalAsync(function(){i&&(n.lstRuleGroupList=n.getFormatedData(i),n.inputElement||(n.inputElement=$("#ScopeId_"+n.$id)),n.inputElement&&($(n.inputElement).focus(),u(n.inputElement),t&&$(n.inputElement).data("ui-autocomplete")&&$(n.inputElement).autocomplete("search",$(n.inputElement).val())))})})};n.getFormatedData=function(n){for(var i=[],t=0;t<n.length;t++)n[t].dictAttributes&&n[t].dictAttributes.ID&&i.push({ID:n[t].dictAttributes.ID});return i};n.filterIntelliseneList=function(t){n.inputElement||(n.inputElement=$(t.target));t.key!="Down"&&t.key!="Up"&&t.key!="Left"&&t.key!="Right"&&t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE&&(n.modelvalue&&n.modelvalue!=""&&n.lstRuleGroupList?$(n.inputElement).data("ui-autocomplete")&&n.lstRuleGroupList&&($(n.inputElement).autocomplete("search",$(n.inputElement).val()),t.preventDefault()):(n.LoadRuleGroupList(!0),t.preventDefault()))};n.showRuleGroupIntellisenseList=function(t){var i=$(t.target).prevAll("input[type='text']");n.inputElement=i;n.LoadRuleList();u(i);i.focus();$(i).data("ui-autocomplete")&&$(i).autocomplete("search",$(i).val());t&&t.stopPropagation()};n.LoadRuleList=function(t){n.inputElement||(n.inputElement=$(t.target));n.modelvalue!=""&&n.lstRuleGroupList||n.LoadRuleGroupList(!0);n.validateRuleGroup()};n.selectGroupClick=function(t){n.validateRuleGroup();var i=n.propertyname.split(".")[1];n.validate&&t&&t!=""&&n.model.errors&&!n.model.errors[i]&&(n.callback&&n.callback(),r.NavigateToFile(n.entityid,"groupslist",t));!n.validate&&t&&t!=""&&(n.callback&&n.callback(),r.NavigateToFile(n.entityid,"groupslist",t))};n.validateRuleGroup=function(){if(n.propertyname&&n.validate){var r=n.propertyname.split(".")[1],u=t.getListByPropertyName(n.lstRuleGroupList,"ID");t.checkValidListValue(u,n.model,$(n.inputElement).val(),r,r,i.VALIDATION.INVALID_GROUP,undefined)}};n.LoadRuleGroupList()}}}]);app.directive("filterList",["$rootScope","$filter",function(){return{restrict:"E",replace:!0,scope:{collection:"=",isChild:"=",changeCallback:"&",propertyname:"=",alternateProperty:"=",cssClass:"@",slideLeft:"=",skipProp:"=",skipValue:"="},link:function(n,t,i){var u,f,r;n.model="";n.inlineStyle=i.Style;u=n.propertyname.split(".");n.alternateProperty&&(f=n.alternateProperty.split("."));n.$watch("slideLeft",function(){n.slideLeft||(n.model="")});n.textBoxClass=n.cssClass?n.cssClass:"col-xs-9";n.onKeyDown=function(t){n.initializeIntellisense();t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE&&(n.showIntellisenseList(),n.model&&n.onChange(),t.preventDefault())};n.showIntellisenseList=function(){n.inputElement&&$(n.inputElement).data("ui-autocomplete")&&$(n.inputElement).autocomplete("search",$(n.inputElement).val().trim())};n.initializeIntellisense=function(){n.collection||(n.collection=[]);var t=n.collection;n.collection&&n.collection.length>0&&n.skipProp&&n.skipValue!=undefined&&(t=n.collection.filter(function(t){return u.length>1?t[u[0]][n.skipProp]!=n.skipValue:t[n.skipProp]!=n.skipValue}));n.inputElement=$("#ScopeId_"+n.$id);$(n.inputElement).focus();r=[];n.maketList(t,u,f);setSingleLevelAutoComplete($(n.inputElement),r,n)};n.onChange=function(){n.propertyname&&(n.isMatched=!1,n.filterByProperty(n.collection,u,f),n.selectedItem&&n.model&&n.isMatched&&n.changeCallback({obj:n.selectedItem}))};r=[];n.maketList=function(t,i,u){for(var f,e=0,o=t.length;e<o;e++)f=t[e],i.length>1?u&&u.length>1&&f[u[0]][u[1]]?r.push(f[u[0]][u[1]]):f[i[0]][i[1]]&&r.push(f[i[0]][i[1]]):f[i[0]]&&r.push(f[i[0]]),n.isChild&&f.hasOwnProperty("Children")&&f.Children.length>0&&n.maketList(f.Children,i,u),n.isChild&&f.hasOwnProperty("Elements")&&f.Elements.length>0&&n.maketList(f.Elements,i,u)};n.filterByProperty=function(t,i,r,u){for(var f,e=0,o=t.length;e<o;e++){if(f=t[e],r&&r.length>0&&f[r[0]][r[1]]==n.model){u&&(u.IsExpanded=!0);n.selectedItem=f;n.isMatched=!0;break}if(i.length>1){if(f[i[0]][i[1]]==n.model){u&&(u.IsExpanded=!0);n.selectedItem=f;n.isMatched=!0;break}}else if(f[i[0]]==n.model){u&&(u.IsExpanded=!0);n.selectedItem=f;n.isMatched=!0;break}n.isChild&&f.hasOwnProperty("Children")&&f.Children.length>0&&n.filterByProperty(f.Children,i,r,f);n.isChild&&f.hasOwnProperty("Elements")&&f.Elements.length>0&&n.filterByProperty(f.Elements,i,r,f)}}},template:"<div style='{{inlineStyle}}' class='{{textBoxClass}}' ng-show='slideLeft'><input type='text' style='float:right;width:0;border-radius:5px!important' ng-class='slideLeft? \"form-control input-sm search-text-visible\" : \"full-width\" ' id='ScopeId_{{$id}}' placeholder=' Search '  title='{{model}}' ng-model='model' ng-change='onChange()' ng-keydown='onKeyDown($event)' /><\/div>"}}]);app.directive("filterTextList",[function(){return{restrict:"E",replace:!0,scope:{collection:"=",model:"=",changeCallback:"&",cssClass:"@",slideLeft:"="},link:function(n){n.textBoxClass=n.cssClass?n.cssClass:"col-xs-9";n.onKeyDown=function(t){n.initializeIntellisense(t);t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE&&(n.showIntellisenseList(),n.model&&n.onChange(),t.preventDefault());t&&t.type=="click"&&n.showIntellisenseList()};n.showIntellisenseList=function(){n.inputElement&&$(n.inputElement).data("ui-autocomplete")&&$(n.inputElement).autocomplete("search",$(n.inputElement).val().trim())};n.initializeIntellisense=function(){n.collection||(n.collection=[]);n.inputElement=$("#ScopeId_"+n.$id);$(n.inputElement).focus();setSingleLevelAutoComplete($(n.inputElement),n.collection)};n.onChange=function(){n.isMatched=!1;n.filterText(n.collection);n.selectedItem&&n.model&&n.isMatched&&n.changeCallback({obj:n.selectedItem})};n.filterText=function(t){for(var r,i=0,u=t.length;i<u;i++)if(r=t[i],r==n.model){n.selectedItem=r;n.isMatched=!0;break}}},template:"<div style='top:-6px' class='{{textBoxClass}}' ng-show='slideLeft'><div class='input-group'><input type='text'  ng-class='slideLeft? \"form-control input-sm search-text-visible\" : \"full-width\" ' id='ScopeId_{{$id}}' placeholder=' Search or (ctrl + space) display suggestion' title='{{model}}' ng-model='model' ng-change='onChange()' ng-keydown='onKeyDown($event)' /><span class='input-group-addon button-intellisense' ng-click='onKeyDown($event)'><\/span><\/div><\/div>"}}]);app.directive("servermethoddirective",["$compile","$rootScope","$ValidationService","CONSTANTS",function(n,t,i,r){return{restrict:"E",replace:!0,scope:{servermethod:"=",displayPropertyName:"=",selectedPropertyName:"=",changeCallback:"&",model:"=",propertyname:"=",isDisable:"=",errorprop:"=",validate:"=",formobject:"=",isloadremoteobject:"="},link:function(n){n.onKeyDown=function(t){n.initializeIntellisense();t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE&&(n.showIntellisenseList(),t.preventDefault())};n.onIntellisenseButtonClick=function(t){n.initializeIntellisense();n.inputElement.focus();n.showIntellisenseList();t&&t.stopPropagation()};n.showIntellisenseList=function(){n.inputElement&&$(n.inputElement).data("ui-autocomplete")&&$(n.inputElement).autocomplete("search",$(n.inputElement).val().trim())};n.getServerMethod=function(){var t,i;n.collection=[];t="srvCommon";n.formobject&&n.formobject.dictAttributes.sfwType!="Correspondence"&&n.formobject.dictAttributes.sfwType!="Report"&&n.formobject.dictAttributes.sfwRemoteObject&&(t=n.formobject.dictAttributes.sfwRemoteObject);n.inputElement&&!$(n.inputElement).val()?(n.formobject.RemoteObjectCollection=[],$.connection.hubForm.server.getRemoteObjectList().done(function(i){n.$evalAsync(function(){if(i){n.formobject.RemoteObjectCollection=i;var r=GetServerMethodObject(t,n.formobject.RemoteObjectCollection);n.collection=PopulateServerMethod([],n.model,r,n.isloadremoteobject);n.collection&&n.collection.length>0&&setSingleLevelAutoComplete($(n.inputElement),n.collection,n,n.selectedPropertyName,n.displayPropertyName)}})})):(i=GetServerMethodObject(t,n.formobject.RemoteObjectCollection),n.collection=PopulateServerMethod([],n.model,i,n.isloadremoteobject),n.collection&&n.collection.length>0&&setSingleLevelAutoComplete($(n.inputElement),n.collection,n,n.selectedPropertyName,n.displayPropertyName))};n.initializeIntellisense=function(){n.getServerMethod();n.inputElement=$("#ScopeId_"+n.$id);$(n.inputElement).focus();n.collection&&n.collection.length>0&&setSingleLevelAutoComplete($(n.inputElement),n.collection,n,n.selectedPropertyName,n.displayPropertyName)};n.onChange=function(){n.changeCallback&&(n.model&&n.propertyname&&setPropertyValue(n.model,n.propertyname,n.servermethod),n.changeCallback());n.validateInput()};n.validateInput=function(){if(n.propertyname&&n.validate){var t=n.propertyname.split("."),u=t[t.length-1],f=n.collection;n.selectedPropertyName&&(f=i.getListByPropertyName(n.collection,n.selectedPropertyName));i.checkValidListValue(f,n.model,$(n.inputElement).val(),u,u,r.VALIDATION.INVALID_METHOD,undefined)}}},template:'<div class="input-group full-width"><span class="info-tooltip dtc-span" ng-if="errorprop" ng-attr-title="{{errorprop}}" style="color:red !important"><i class="fa fa-exclamation-circle" aria-hidden="true"><\/i><\/span><input ng-disabled="isDisable" type= "text" id="ScopeId_{{$id}}" class="form-control input-sm" title="{{servermethod}}" ng-model="servermethod" ng-keyup="validateInput()" ng-change="onChange()" ng-keydown="onKeyDown($event)" undoredodirective model="model" propertyname="propertyname"/><span ng-show="!isDisable" class="input-group-addon button-intellisense" ng-click="onIntellisenseButtonClick($event)"><\/span><\/div>'}}]);app.directive("internalfunctionsintellisense",["$compile","$rootScope",function(){return{restrict:"E",replace:!0,scope:{selecteditem:"=",onchangecallback:"&"},template:'<div class="input-group"><input type= "text" id="ScopeId_{{$id}}" class="form-control input-sm" title="{{selecteditem}}" ng-model="selecteditem" ng-change="onChange()"  ng-keydown="onInternalFunctionKeyDown($event)" /><span class="input-group-addon button-intellisense" ng-click="showInternalFunctionList($event)"><\/span><\/div>',link:function(n){n.lstInternalFunctions=[];$.connection.hubInternalFunctions.server.getRuleFunctions().done(function(t){n.$evalAsync(function(){n.lstInternalFunctions=t})});n.onInternalFunctionKeyDown=function(t){t.key!="Down"&&t.key!="Up"&&t.key!="Left"&&t.key!="Right"&&(n.inputElement||(n.inputElement=$(t.target)),t.ctrlKey&&t.keyCode==$.ui.keyCode.SPACE&&$(n.inputElement).data("ui-autocomplete")?($(n.inputElement).autocomplete("search",$(n.inputElement).val()),t.preventDefault()):n.lstInternalFunctions&&n.lstInternalFunctions.length>0&&setSingleLevelAutoComplete($(n.inputElement),n.lstInternalFunctions,n,"Method","Method",n.onchangecallback))};n.showInternalFunctionList=function(t){n.inputElement||(n.inputElement=$(t.target).prevAll("input[type='text']"));n.inputElement.focus();n.inputElement&&(setSingleLevelAutoComplete(n.inputElement,n.lstInternalFunctions,n,"Method","Method",n.onchangecallback),$(n.inputElement).data("ui-autocomplete")&&$(n.inputElement).autocomplete("search",$(n.inputElement).val().trim()));t&&t.stopPropagation()};n.onChange=function(){if(n.onchangecallback){var i,t=n.lstInternalFunctions.filter(function(t){return t.Method==n.selecteditem});t&&t.length>0&&(i=t[0]);n.onchangecallback({obj:i})}}}}}]);app.directive("ngScrolldown",[function(){return{scope:{callback:"&",ngpausescroll:"=",ngscrollheight:"=?"},link:function(n,t){var i=$(t);n.ngscrollheight==undefined&&(n.ngscrollheight=0);$(t).scroll(function(){n.ngpausescroll||i.outerHeight()+n.ngscrollheight>=i.get(0).scrollHeight-i.scrollTop()&&n.callback({data:1})})}}}]);app.filter("cut",function(){return function(n,t,i,r){if(!n)return"";if((i=parseInt(i,10),!i)||n.length<=i)return n;if(n=n.substr(0,i),t){var u=n.lastIndexOf(" ");u!=-1&&((n.charAt(u-1)=="."||n.charAt(u-1)==",")&&(u=u-1),n=n.substr(0,u))}return n+(r||" …")}});app.filter("entitybyTable",function(){return function(n,t,i){var r=[];return!t||!n.length?n:(n.forEach(function(n){n.Queries.forEach(function(u){var f,e;if(u.SqlQuery)if(i&&u.QueryType&&u.QueryType=="SubSelectQuery"){if(f=u.SqlQuery.toLowerCase().split(/[()\r\n\s,]+/),e=f.indexOf(t.toLowerCase()),e>=0)return r.push({ID:n.EntityName+"."+u.ID,SqlQuery:u.SqlQuery,Parameters:u.Parameters?u.Parameters:undefined}),!1}else if(!i&&(f=u.SqlQuery.toLowerCase().split(/[()\r\n\s,]+/),e=f.indexOf(t.toLowerCase()),e>=0))return r.push({ID:n.EntityName+"."+u.ID,SqlQuery:u.SqlQuery,Parameters:u.Parameters?u.Parameters:undefined}),!1})}),r)}});app.filter("filesize",function(){var n=["bytes","KB","MB","GB","TB","PB"];return function(t,i){if(isNaN(parseFloat(t))||!isFinite(t))return"?";for(var r=0;t>=1024;)t/=1024,r++;return t.toFixed(+i)+" "+n[r]}});app.filter("range",function(){return function(n,t,i){t=parseInt(t);i=parseInt(i);for(var r=t;r<=i;r++)n.push(r.toString());return n}});app.filter("controlbyFormtype",function(){return function(n,t,i,r){function e(n){var t=!0;switch(n.Name){case"Label":u==="Lookup"&&(r.IsLookupCriteriaEnabled==!0||r.IsPrototypeLookupCriteriaEnabled)&&(t=!1)}return t}var f=n,u=r?r.hasOwnProperty("dictAttributes")?r.dictAttributes.sfwType:"":"";return i&&u&&t&&n.length&&(f=n.filter(function(n){if(n&&n.hasOwnProperty("type")&&angular.isArray(n.excludeFormTypes)&&angular.isArray(n.optionEnabled)&&n.type===i&&n.excludeFormTypes.indexOf(u)<0&&n.optionEnabled.indexOf(t)>=0&&e(n,r))return n})),f}});app.service("$getMultiIndexofArray",function(){return function(n,t){for(var r=[],i=n.length-1;i>=0;i--)n[i]===t&&r.unshift(i);return r}});app.service("$cssFunc",["$getMultiIndexofArray",function(n){this.addEachcssClass=function(n,t){function i(n){var i=n.getAttribute("class"),r;i?(r=i.split(" "),r.indexOf(t)==-1&&n.setAttribute("class",i+" "+t)):n.setAttribute("class",t)}n.length?n.length>1?angular.forEach(n,i):i(n[0]):i(n)};this.removeEachcssClass=function(t,i){function r(t){var f=t.getAttribute("class"),r,u,e;f&&(r=f.split(" "),u=n(r,i),u.length>0&&(e=$.grep(r,function(n,t){return $.inArray(t,u)==-1}),t.setAttribute("class",e.join(" "))))}t.length?t.length>1?angular.forEach(t,r):r(t[0]):r(t)};this.TogglecssClass=function(t,i,r){function u(t){var e=t.getAttribute("class");if(e){var f=e.split(" "),u="",o=n(f,i),s=n(f,r);o.length>0&&(u=$.grep(f,function(n,t){return $.inArray(t,o)==-1}),u=u.join(" "));s.length==0&&t.setAttribute("class",u+" "+r)}else t.setAttribute("class"," "+r)}typeof t.length=="undefined"?u(t):t.length>1?angular.forEach(t,u):t.length==1&&u(t[0])}}]);app.factory("$resourceFactory",["hubcontext",function(n){var t={resourceConstants:{},resourceRfunctions:{},resourceFileType:[],resourcelstTfsStatus:[]};return t.resourceFileType.push({name:"Entity",value:"Entity"}),t.resourceFileType.push({name:"Logical Rule",value:"LogicalRule"}),t.resourceFileType.push({name:"Decision Table",value:"DecisionTable"}),t.resourceFileType.push({name:"Excel Matrix",value:"ExcelMatrix"}),t.resourceFileType.push({name:"Entity Based Scenario",value:"ParameterScenario"}),t.resourceFileType.push({name:"Object Based Scenario",value:"ObjectScenario"}),t.resourceFileType.push({name:"Excel Based Scenario",value:"ExcelScenario"}),t.resourceFileType.push({name:"Lookup",value:"Lookup"}),t.resourceFileType.push({name:"Maintenance",value:"Maintenance"}),t.resourceFileType.push({name:"Wizard",value:"Wizard"}),t.resourceFileType.push({name:"User Control",value:"UserControl"}),t.resourceFileType.push({name:"Tooltip",value:"Tooltip"}),t.resourceFileType.push({name:"HTML Lookup",value:"FormLinkLookup"}),t.resourceFileType.push({name:"HTML Maintenance",value:"FormLinkMaintenance"}),t.resourceFileType.push({name:"HTML Wizard",value:"FormLinkWizard"}),t.resourceFileType.push({name:"Reports",value:"Report"}),t.resourceFileType.push({name:"Inbound File",value:"InboundFile"}),t.resourceFileType.push({name:"Outbound File",value:"OutboundFile"}),t.resourceFileType.push({name:"BPMN",value:"BPMN"}),t.resourceFileType.push({name:"BPM Template",value:"BPMTemplate"}),t.resourceFileType.push({name:"Correspondence",value:"Correspondence"}),t.resourceFileType.push({name:"Prototype",value:"Prototype"}),t.resourceFileType.push({name:"Workflow Map",value:"WorkflowMap"}),t.resourceFileType.push({name:"Rule Constants",value:"RuleConstants"}),t.resourcelstTfsStatus.push({name:"only local",value:"OnlyLocal"}),t.resourcelstTfsStatus.push({name:"Added",value:"InAdd"}),t.resourcelstTfsStatus.push({name:"Edited",value:"InEdit"}),t.resourcelstTfsStatus.push({name:"No Change",value:"LocalWithoutChange"}),n.hubMain&&(n.hubMain.client.setConstantsListData=function(n){n&&(t.resourceConstants=JSON.parse(n))},n.hubMain.client.setRfunctionsListData=function(n){n&&(t.resourceRfunctions=JSON.parse(n))}),{getConstantsListData:function(){n.hubMain.server.loadConstants()},getRfunctionsListData:function(){n.hubMain.server.getRFuncMethods()},getConstantModelData:function(){return t.resourceConstants},getConstantsList:function(n){var e=[],u,r,f,i;if(n&&t.resourceConstants)if(u=n.split("."),u.length>0){if(u[0]==t.resourceConstants.dictAttributes.ID)for(r=t.resourceConstants.Elements,i=1;i<u.length;i++)f=r.filter(function(n){if(n.dictAttributes&&n.dictAttributes.ID)return n.dictAttributes.ID==u[i]}),f&&f.length>0&&(r=f[0].Name!="constant"?f[0].Elements:[]);if(r&&r.length>0)for(i=0;i<r.length;i++)r[i].dictAttributes&&r[i].dictAttributes.ID&&e.push({ID:r[i].dictAttributes.ID,DisplayName:r[i].dictAttributes.ID,Value:r[i].dictAttributes.ID,Tooltip:r[i].dictAttributes.ID,Type:"Constant"})}else e.push({ID:t.resourceConstants.dictAttributes.ID,DisplayName:t.resourceConstants.dictAttributes.ID,Value:t.resourceConstants.dictAttributes.ID,Tooltip:t.resourceConstants.dictAttributes.ID,Type:"Constant"});else e.push({ID:t.resourceConstants.dictAttributes.ID,DisplayName:t.resourceConstants.dictAttributes.ID,Value:t.resourceConstants.dictAttributes.ID,Tooltip:t.resourceConstants.dictAttributes.ID,Type:"Constant"});return e},getRfunctionsList:function(){return t.resourceRfunctions},setConstantsList:function(n){t.resourceConstants=n},setRfunctionsList:function(n){t.resourceRfunctions=n},getFileTypeList:function(){return t.resourceFileType},getTfsStatusList:function(){return t.resourcelstTfsStatus},clearResourceFactory:function(){t.resourceConstants={};t.resourceRfunctions={}}}}]);app.factory("$EntityIntellisenseFactory",["hubcontext","$http","$rootScope",function(n){function r(){var n=t.intellisenseData;i.entNameList=[];n&&n.length>0&&n.forEach(function(n){i.entNameList.push(n.ID)});i.entNameList.sort()}var t={intellisenseData:{}},i={entNameList:[]};return n.hubMain&&(n.hubMain.client.setEntityListData=function(n){n&&(t.intellisenseData=JSON.parse(n),r())}),{setEntityIntellisense:function(n){t.intellisenseData=n;r()},getEntityIntellisense:function(){return t.intellisenseData},getChildEntitiesIncludingThis:function(n){if(n)return t.intellisenseData.filter(function(t){return t.ParentId==n||t.ID==n})},getChildEntitiesButThis:function(n){if(n)return t.intellisenseData.filter(function(t){return t.ParentId==n})},getDescendentEntitiesIncludingThis:function(n){if(n){var r=[],i=t.intellisenseData.filter(function(t){return t.ID==n});return i&&i.length>0&&(r=r.concat(i)),i=this.getDescendentEntitiesButThis(n),i&&i.length>0&&(r=r.concat(i)),r}},getDescendentEntitiesButThis:function(n){var t,i,u,r;if(n){if(t=[],i=this.getChildEntitiesButThis(n),i&&i.length>0)for(t=t.concat(i),u=0;u<i.length;u++)r=this.getDescendentEntitiesButThis(i[0].ID),r&&r.length>0&&(t=t.concat(r));return t}},getEntityNameList:function(){return i.entNameList},clearEntityIntellisenseFactory:function(){t.intellisenseData={};i.entNameList={}},getXmlMethods:function(n,i){for(var f=[],r,u,e;n;)if(r=t.intellisenseData.filter(function(t){return t.ID==n}),r&&r.length){for(u=0,e=r[0].XmlMethods.length;u<e;u++)f.push(r[0].XmlMethods[u]);n=i?r[0].ParentId:null}else n=null;return f},getXmlMethodParameters:function(n,t,i){var u=[],r=this.getXmlMethods(n,i);return r&&r.length>0&&(xmlMethod=r.filter(function(n){return n.ID===t}),xmlMethod&&xmlMethod.length&&(u=xmlMethod[0].Parameters)),u},getQueryByQueryName:function(n){var i,f,r;if(objQuery=null,i=n.split("."),i&&i.length==2){var e=i[0],o=i[1],u=t.intellisenseData.filter(function(n){return n.ID==e});u&&u.length>0&&(f=u[0],r=f.Queries.filter(function(n){return n.ID==o}),r&&r.length>0&&(objQuery=r[0]))}return objQuery},getAttributes:function(n,i,r,u){for(var o=[],f,e,s;n;){if(f=t.intellisenseData.filter(function(t){return t.ID==n}),f&&f.length)for(e=0,s=f[0].Attributes.length;e<s;e++)(!i||!i.length||i.indexOf(f[0].Attributes[e].Type.toLowerCase())>-1)&&(!r||!r.length||r.indexOf(f[0].Attributes[e].DataType.toLowerCase())>-1)&&o.push(f[0].Attributes[e]);n=u?f[0].ParentId:null}return o},getRules:function(n,i,r,u,f){for(var s=[],e,o,h;n;){if(e=t.intellisenseData.filter(function(t){return t.ID==n}),e&&e.length)for(o=0,h=e[0].Rules.length;o<h;o++)(!u||!u.length||attributeTypes.indexOf(e[0].Rules[o].RuleType.toLowerCase())>-1)&&(!r||!r.length||r.indexOf(e[0].Rules[o].ReturnType.toLowerCase())>-1)&&s.push(e[0].Rules[o]);n=f?e[0].ParentId:null}return s}}}]);app.service("$SearchSource",[function(){this.getIndicesOfSearchStr=function(n,t,i,r,u){var e,o,f,s,c,h,l,a;if(n){if(e=n.length,e==0)return[];if(o=0,s=[],i||(t=t.toLowerCase(),n=n.toLowerCase()),u)for(c=new RegExp(n,"g");(match=c.exec(t))!=null;)s.push({startPos:match.index,endPos:c.lastIndex});else while((f=t.indexOf(n,o))>-1){if(r&&(h="\\b",h+=escapeRegExp(n),h+="\\b",l=t.substring(f-1,f+e+1),a=new RegExp(h,"g").test(l),!a)){o=f+e;continue}s.push(f);o=f+e}return s}};this.selectword=function(n,t,i,r){r--;var u=t,f=t+i.length;typeof n[0].selectionStart!=undefined&&(n[0].selectionStart=u,n.focus(),n[0].selectionEnd=f)}}]);app.service("$NavigateToFileService",["$rootScope","hubcontext",function(n,t){this.NavigateToFile=function(i,r,u){t.hubMain.server.navigateToFile(i,r+";"+u).done(function(t){var r,i;t&&(r=n.lstopenedfiles.filter(function(n){return n.file.FileName==t.FileName}),n.openFile(t),t.SelectNodePath&&t.SelectNodePath!=""&&r!=""&&(i=getScopeByFileName(t.FileName),i&&i.selectElement(t.SelectNodePath)))})};this.NavigateToRule=function(i){t.hubMain.server.getFileInfoByID(i).done(function(t){t&&n.openFile(t)})}}]);app.factory("FormDetailsFactory",function(){var n;return{getFormDetails:function(){return n},setFormDetails:function(t){n=t}}});app.value("$Errors",{validationListObj:[]});app.constant("CONSTANTS",{VALIDATION:{ID_EMPTY:"ID can not be empty",NOT_VALID_ID:"Invalid ID",DUPLICATE_ID:"Duplicate ID present",DATA_TYPE_EMPTY:"Data type can not be empty",INVALID_ENTITY:"Invalid Entity type",FIELD_NAME_EMPTY:"Field Name can not be empty",VISIBLE_RULE_NOT_EXISTS:"The visible rule does not exist. Please change the rule.",ENABLE_RULE_NOT_EXISTS:"The enable rule does not exist. Please change the rule.",READONLY_RULE_NOT_EXISTS:"The item read only rule does not exist. Please change the rule.",CONDITIONAL_RULE_NOT_EXISTS:"The conditional rule does not exist. Please change the rule.",RESOURCE_NOT_EXISTS:"The resource does not exist. Please change the resource id.",ENTITY_FIELD_INCORRECT:"The entity field is incorrect. Please change the entity field.",VALIDATION_RULE_NOT_EXISTS:"The validation rule does not exist. Please change the validation rule.",CODE_GROUP_NOT_EXISTS:"The code group does not exist. Please change the code id.",INVALID_QUERY:"Invalid query.",INVALID_METHOD:"The method does not exist. Please change the method.",INVALID_ACTIVE_FORM:"The form does not exist. Please change the form name.",INVALID_QUERY_ID:"The query ID does not exist. Please change the query id.",INVALID_DATA_FIELD:"Invalid data field",INVALID_EXPRESSION:"The expression does not exist. Please change the expression.",INVALID_MESSAGE_ID:"The message id does not exist. Please change the message id.",MESSAGE_ID_EMPTY:"Message ID can not be empty.",INVALID_ENTITY_NAME:"The entity does not exist. Please change the entity.",INVALID_CODE_TABLE:"The code table name does not exist. Please change the code table name.",BUTTON_NOT_EXISTS:"The button not exist.Please change button name.",INVALID_GROUP:"The group does not exist.Please change group name.",INVALID_FIELD:"The field is incorrect. Please change the field name.",INVALID_TEMPLATE:"The template name does not exist.Please change the template name.",CHECKLIST_NOT_EXISTS:"The checklist does not exist. Please change the checklist id.",EMPTY_FIELD:"The field can not be empty.",INVALID_RULE:"Rule not present add or change rule",ONLY_OBJECT_OR_COLLECTION:"Only Object or Collection type field not allowed",INVALID_NAME:"Invalid method name",DUPLICATE_ID_IN_PARENT_ENTITY:"Duplicate id present in parent entity.",DUPLICATE_FIELD:"Duplicate field present",DUPLICATE_EFFECTIVE_DATE:"Effective date already used.",EMPTY_DATATYPE:"Datatype cannot be empty.",INVALID_DATATYPE:"Invalid value for the selected datatype",EMPTY_VALUE:"Value cannot be empty for selected datatype",QUERY_WITH_PARAMETER:"Parameterized query not allowed",OBJECT_FIELD_EMPTY:"Object Field can not be empty",EMPTY_ERROR_TABLE:"Error table can not be empty.",INVALID_ERROR_TABLE:"Invalid error table.",EMPTY_CHECKLIST_TABLE:"Checklist table can not be empty.",INVALID_CHECKLIST_TABLE:"Invalid checklist table.",EMPTY_MESSAGE_AND_ID:"Empty MessageID and Description.Enter value for atleast one field.",EMPTY_MESSAGE_DESC:"Message Description can not be empty.",EMPTY_GENERIC:"{0} cannot be empty.",INVALID_GENERIC:"Invalid {0}. Please select a valid {0}."},ENTITY:{NODES:["queries","query","rules","rule","item","grouplist","group","attributes","attribute"],METHOD_NODES:["objectmethods","methods","method"]},FORM:{NODES:["sfwTable","sfwRow","sfwColumn","sfwPanel","DialogPanel","sfwDialogPanel","sfwListView","TabContainer","Tabs","sfwTabSheet","sfwTabContainer","sfwWizard","WizardSteps","sfwWizardStep"],IGNORE_NODES:["sfwRow","sfwColumn","TemplateField","ItemTemplate","DataColumn","DataRow","Data","Columns","Tabs","Parameters","Columns","HeaderTemplate","WizardSteps","SideBarTemplate"],COLLECTION_TYPE_NODES:["sfwGridView","sfwListView","sfwChart","sfwCheckBoxList"],CONTROL_TYPES:[{Name:"Caption",method:"Caption",type:"basic",icon:"images/Form/icon-label.svg",excludeFormTypes:[],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"]},{Name:"Compare Validator",method:"CompareValidator",type:"advanced",icon:"images/Form/icon-compare-validator.svg",excludeFormTypes:["Correspondence","Tooltip"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"]},{Name:"Dialog Panel",method:"DialogPanel",type:"advanced",icon:"images/Form/icon-dialog-panel.svg",excludeFormTypes:["Report","Correspondence","Tooltip","Lookup"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"]},{Name:"Hyper Link",method:"sfwHyperLink",type:"basic",icon:"images/Form/icon-hyperlink.svg",excludeFormTypes:["Report","Correspondence","Tooltip"],allowInParent:["all","sfwGrid"],optionEnabled:["toolbox","changecontrol","addcontrol"],attributetype:"value"},{Name:"List Box",method:"sfwListBox",type:"advanced",icon:"images/Form/icon-ListBox.svg",excludeFormTypes:["Report","Correspondence","Tooltip","Lookup"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol"],attributetype:"value"},{Name:"List Picker",method:"sfwListPicker",type:"advanced",icon:"images/Form/icon-mant4.svg",excludeFormTypes:["Report","Correspondence","Tooltip","Lookup"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"],attributetype:"value"},{Name:"Open Detail",method:"sfwOpenDetail",type:"advanced",icon:"images/Form/icon-open-detail.svg",excludeFormTypes:["Report","Correspondence","Lookup","Tooltip"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"],attributetype:"value"},{Name:"CR Viewer",method:"sfwCRViewer",type:"advanced",icon:"images/Form/CR_Viewer.svg",excludeFormTypes:["Report","Correspondence","Tooltip","Lookup"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"]},{Name:"Employer Soft Errors",method:"sfwEmployerSoftErrors",type:"advanced",icon:"images/Form/Employee-soft_error.svg",excludeFormTypes:["Report","Correspondence","Tooltip","Lookup"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"]},{Name:"File Layout",method:"sfwFileLayout",type:"advanced",icon:"images/Form/File_Layout.svg",excludeFormTypes:["Report","Correspondence","Tooltip","Lookup"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"]},{Name:"File Upload",method:"sfwFileUpload",type:"advanced",icon:"images/Form/File_Upload.svg",excludeFormTypes:["Report","Correspondence","Tooltip","Lookup"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"]},{Name:"Soft Errors",method:"sfwSoftErrors",type:"advanced",icon:"images/Form/Soft_Errors.svg",excludeFormTypes:["Report","Correspondence","Tooltip","Lookup"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"]},{Name:"Questionnaire Panel",method:"sfwQuestionnairePanel",type:"advanced",icon:"images/Form/icon-QuestionnairePanel.svg",excludeFormTypes:["Report","Correspondence","Tooltip","Lookup"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"],attributetype:"value"},{Name:"Button",method:"sfwButton",type:"basic",icon:"images/Form/icon-button.svg",excludeFormTypes:["Tooltip","Report","Correspondence",],allowInParent:["all","sfwGrid"],optionEnabled:["toolbox","addcontrol","addcontrol"]},{Name:"Link Button",method:"sfwLinkButton",type:"basic",excludeFormTypes:["Report","Correspondence"],icon:"images/Form/icon-button.svg",allowInParent:["all"],optionEnabled:[]},{Name:"Image Button",method:"sfwImageButton",type:"basic",excludeFormTypes:["Report","Correspondence"],icon:"images/Form/icon-button.svg",allowInParent:["all"],optionEnabled:[]},{Name:"Custom Button",method:"basic",type:"",excludeFormTypes:["Report","Correspondence"],icon:"images/Form/icon-button.svg",allowInParent:["all"],optionEnabled:[]},{Name:"Panel",method:"Panel",type:"basic",icon:"images/Form/icon-mant2.svg",excludeFormTypes:["Report","Lookup"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"]},{Name:"Range Validator",method:"RangeValidator",type:"advanced",icon:"images/Form/icon-RangeValidator.svg",excludeFormTypes:["Report","Correspondence","Tooltip"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"]},{Name:"Regular Expression Validator",method:"RegularExpressionValidator",type:"advanced",icon:"images/Form/regular_expression_validator.svg",excludeFormTypes:["Report","Correspondence","Tooltip"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"]},{Name:"Required Field Validator",method:"RequiredFieldValidator",type:"advanced",icon:"images/Form/icon-required-field-validator.svg",excludeFormTypes:["Correspondence","Tooltip"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"]},{Name:"Cascading DropDown",method:"sfwCascadingDropDownList",type:"basic",icon:"images/Form/icon-cascading-dropdown.svg",excludeFormTypes:["Correspondence","Tooltip"],allowInParent:["all","sfwGrid"],optionEnabled:["toolbox","changecontrol","addcontrol"],attributetype:"value"},{Name:"CheckBox",method:"sfwCheckBox",type:"basic",icon:"images/Form/icon-checkbox.svg",excludeFormTypes:["Tooltip"],allowInParent:["all","sfwGrid"],optionEnabled:["toolbox","changecontrol","addcontrol"],attributetype:"value"},{Name:"CheckBox List",method:"sfwCheckBoxList",type:"advanced",icon:"images/Form/icon-checkboxlist.svg",excludeFormTypes:["Tooltip"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"],attributetype:"collection"},{Name:"DropDown",method:"sfwDropDownList",type:"basic",icon:"images/Form/icon-form-dropdown.svg",excludeFormTypes:["Tooltip"],allowInParent:["all","sfwGrid"],optionEnabled:["toolbox","changecontrol","addcontrol"],attributetype:"value"},{Name:"MultiSelect DropDown",method:"sfwMultiSelectDropDownList",type:"basic",icon:"images/Form/icon-dropdown.svg",excludeFormTypes:["Tooltip","Report"],allowInParent:["all","sfwGrid"],optionEnabled:["toolbox","changecontrol","addcontrol"],attributetype:"value"},{Name:"Image",method:"sfwImage",type:"advanced",icon:"images/Form/icon-image.svg",excludeFormTypes:["Report","Correspondence","Tooltip","Lookup"],allowInParent:["all","sfwGrid"],optionEnabled:["toolbox","changecontrol","addcontrol"],attributetype:"value"},{Name:"Label",method:"sfwLabel",type:"basic",icon:"images/Form/icon-label.svg",excludeFormTypes:["Correspondence"],allowInParent:["all","sfwGrid"],optionEnabled:["toolbox","changecontrol","addcontrol"],attributetype:"value"},{Name:"Literal",method:"sfwLiteral",type:"basic",icon:"images/Form/icon-literal.svg",excludeFormTypes:["Correspondence","Tooltip"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"],attributetype:"value"},{Name:"Multi Correspondence",method:"sfwMultiCorrespondence",type:"advanced",icon:"images/Form/icon-repeater-control.svg",excludeFormTypes:["Report","Correspondence","Tooltip","Lookup"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"]},{Name:"Radio Button",method:"sfwRadioButton",type:"basic",icon:"images/Form/icon-radio.svg",excludeFormTypes:["Tooltip"],allowInParent:["all","sfwGrid"],optionEnabled:["toolbox","changecontrol","addcontrol"],attributetype:"value"},{Name:"Radio Button List",method:"sfwRadioButtonList",type:"advanced",icon:"images/Form/icon-radiobuttonlist.svg",excludeFormTypes:["Tooltip"],allowInParent:["all","sfwGrid"],optionEnabled:["changecontrol","toolbox","addcontrol"],attributetype:"value"},{Name:"Rule Viewer",method:"sfwRuleViewer",type:"advanced",icon:"images/Form/icon-Rule-Viewer.svg",excludeFormTypes:["Report","Correspondence","Tooltip","Lookup"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"],attributetype:"value"},{Name:"Slider",method:"sfwSlider",type:"advanced",icon:"images/Form/icon-slider.svg",excludeFormTypes:["Report","Correspondence","Tooltip"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"],attributetype:"value"},{Name:"Knob",method:"sfwKnob",type:"advanced",icon:"images/Form/icon-knob.svg",excludeFormTypes:["Report","Correspondence","Tooltip"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"],attributetype:"value"},{Name:"Switch CheckBox",method:"sfwSwitchCheckBox",type:"advanced",icon:"images/Form/icon-switch-CheckBox.svg",excludeFormTypes:["Report","Correspondence","Tooltip"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"],attributetype:"value"},{Name:"TextBox",method:"sfwTextBox",type:"basic",icon:"images/Form/icon-textbox.svg",excludeFormTypes:["Tooltip"],allowInParent:["all","sfwGrid"],optionEnabled:["toolbox","changecontrol","addcontrol"],attributetype:"value"},{Name:"DateTime Picker",method:"sfwDateTimePicker",type:"advanced",icon:"images/Form/icon-DateTimepicker.svg",excludeFormTypes:["Tooltip","Correspondence","Report"],allowInParent:["all","sfwGrid"],optionEnabled:["toolbox","changecontrol","addcontrol"],attributetype:"value"},{Name:"Source List",method:"sfwSourceList",type:"advanced",icon:"images/Form/icon-mant5.svg",excludeFormTypes:["Report","Correspondence","Tooltip","Lookup"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"],attributetype:"value"},{Name:"Target List",method:"sfwTargetList",type:"advanced",icon:"images/Form/icon-mant6.svg",excludeFormTypes:["Report","Correspondence","Tooltip","Lookup"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"],attributetype:"value"},{Name:"Retrieve Button",method:"sfwImageButton",type:"advanced",icon:"images/Form/icon-retrieve-button.svg",excludeFormTypes:["Maintenance","Lookup","Tooltip"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"]},{Name:"Tooltip Button",method:"sfwToolTipButton",type:"basic",icon:"images/Form/icon-tooltip.svg",excludeFormTypes:["Correspondence","Report","Tooltip"],allowInParent:["sfwGrid"],optionEnabled:["changecontrol","addcontrol"]},{Name:"JSON Data",method:"sfwJSONData",type:"advanced",icon:"images/Form/JSON_Data.svg",excludeFormTypes:["Report","Correspondence","Lookup","Tooltip"],allowInParent:["all","sfwGrid"],optionEnabled:["toolbox","changecontrol","addcontrol"]},{Name:"User Defaults",method:"sfwUserDefaults",type:"advanced",icon:"images/Form/icon-repeater-control.svg",excludeFormTypes:["Report","Correspondence","Maintenance","Wizard","UserControl","Tooltip"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"]},{Name:"User Control",method:"UserControl",type:"advanced",icon:"images/Form/new-user-main.svg",excludeFormTypes:["Report","Correspondence","Lookup","UserControl","Tooltip"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"],attributetype:"object"},{Name:"Command Button",method:"sfwCommandButton",type:"advanced",icon:"images/Form/CommandButton.svg",excludeFormTypes:["Report","Correspondence","Maintenance","Lookup","UserControl","Tooltip"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"]},{Name:"Tab Container",method:"TabContainer",type:"advanced",icon:"images/Form/icon-tabContainer.svg",excludeFormTypes:["Report","Correspondence","Lookup","Tooltip"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"]},{Name:"Wizard Progress",method:"sfwWizardProgress",type:"advanced",icon:"images/Form/WizardProgress.svg",excludeFormTypes:["Report","Correspondence","Maintenance","Lookup","UserControl","Tooltip"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"]},{Name:"Break",method:"br",type:"html",icon:"images/Form/break.svg",excludeFormTypes:["Report","Correspondence"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"]},{Name:"Horizontal Rule",method:"hr",type:"html",icon:"images/Form/horizontal_rule.svg",excludeFormTypes:["Report","Correspondence"],allowInParent:["all"],optionEnabled:["toolbox","changecontrol","addcontrol"]},{Name:"Grid View",method:"sfwGridView",type:"advanced",icon:"images/Form/icon-gridview.png",excludeFormTypes:["Lookup","Report","Correspondence"],allowInParent:["all"],optionEnabled:["toolbox"],attributetype:"collection"},{Name:"Button Group",method:"sfwButtonGroup",type:"advanced",icon:"images/Form/group.svg",excludeFormTypes:[],allowInParent:["all","sfwGrid"],optionEnabled:["toolbox","changecontrol","addcontrol"]},{Name:"Captcha",method:"sfwCaptcha",type:"advanced",icon:"images/Form/captcha_control_normal.svg",excludeFormTypes:["Lookup","Report","Correspondence","Tooltip"],allowInParent:["all","sfwGrid"],optionEnabled:["toolbox","changecontrol","addcontrol"]}],LIST_OF_PAGETYPE:[{value:"",text:""},{value:"letter",text:"Letter"},{value:"a0",text:"A0"},{value:"a1",text:"A1"},{value:"a2",text:"A2"},{value:"a3",text:"A3"},{value:"a4",text:"A4"},{value:"a5",text:"A5"},{value:"a6",text:"A6"},{value:"a7",text:"A7"},{value:"a8",text:"A8"},{value:"a9",text:"A9"},{value:"a10",text:"A10"},{value:"b0",text:"B0"},{value:"b1",text:"B1"},{value:"b2",text:"B2"},{value:"b3",text:"B3"},{value:"b4",text:"B4"},{value:"b5",text:"B5"},{value:"b6",text:"B6"},{value:"b7",text:"B7"},{value:"b8",text:"B8"},{value:"b9",text:"B9"},{value:"b10",text:"B10"},{value:"c0",text:"C0"},{value:"c1",text:"C1"},{value:"c2",text:"C2"},{value:"c3",text:"C3"},{value:"c4",text:"C4"},{value:"c5",text:"C5"},{value:"c6",text:"C6"},{value:"c7",text:"C7"},{value:"c8",text:"C8"},{value:"c9",text:"C9"},{value:"c10",text:"C10"},{value:"d0",text:"D0"},{value:"government-letter",text:"Government Letter"},{value:"legal",text:"Legal"},{value:"junior-legal",text:"Junior Legal"},{value:"ledger",text:"Ledger"},{value:"tabloid",text:"Tabloid"},{value:"credit-card",text:"Credit Card"}]},CORRESPONDENCEDATATYPES:[{CodeID:"",CodeValue:""},{CodeID:"Int",CodeValue:"Int"},{CodeID:"String",CodeValue:"String"},{CodeID:"Decimal",CodeValue:"Decimal"},{CodeID:"Boolean",CodeValue:"Boolean"},{CodeID:"DateTime",CodeValue:"DateTime"},{CodeID:"sfwHtmlText",CodeValue:"Html Text"},{CodeID:"sfwImageFile",CodeValue:"Image File"},{CodeID:"sfwImageByte",CodeValue:"Image Byte"}],VALIDATIONERROR:[{ERROR_KEY:"empty_id",ERROR_VALUE:"ID_EMPTY"},{ERROR_KEY:"inValid_id",ERROR_VALUE:"NOT_VALID_ID"},{ERROR_KEY:"duplicate_id",ERROR_VALUE:"DUPLICATE_ID"},{ERROR_KEY:"data_type",ERROR_VALUE:"DATA_TYPE_EMPTY"},{ERROR_KEY:"invalid_entity",ERROR_VALUE:"INVALID_ENTITY"},{ERROR_KEY:"empty_ObjField",ERROR_VALUE:"objField_EMPTY"},{ERROR_KEY:"emptyMessageIdAndDescription",ERROR_VALUE:"EMPTY_MESSAGE_AND_ID"},{ERROR_KEY:"emptyMessageDescription",ERROR_VALUE:"EMPTY_MESSAGE_DESC"},{ERROR_KEY:"sfwFieldName",ERROR_VALUE:"EMPTY_FIELD"}]});app.factory("$ValidationService",["CONSTANTS","$timeout","$rootScope","$EntityIntellisenseFactory","$Entityintellisenseservice",function(n,t,i,r,u){var f={},h=[],e,o,c,s;return f.IsValidDate=function(n){var t=!0;return Object.prototype.toString.call(n)==="[object Date]"?isNaN(n.getTime())&&(t=!1):t=!1,t},e=function(n,t,i){var r,u;return t&&n&&n.length>0?(r=-1,i&&typeof t=="string"?(u=n.map(function(n){return n.toLowerCase()}),r=u.indexOf(t.toLowerCase())):r=n.indexOf(t),r>-1?!0:!1):!1},f.isEmptyObj=function(n){var i=!1,r,t;for(r in n)t=n[r],(t!=""||t!=undefined)&&(i=!0);return i},o=function(n){if(n)return h;if(i.currentopenfile&&i.currentopenfile.file){var t=getScopeByFileName(i.currentopenfile.file.FileName);return t&&t.validationErrorList?t.validationErrorList:undefined}},c=function(n){var r={},t;return i.currentopenfile&&i.currentopenfile.file&&(t=getScopeByFileName(i.currentopenfile.file.FileName),t&&t.warningList&&(r.lstwarning=t.warningList),t&&t[n]&&(r.lstmodel=t[n])),r},f.getEntityAttributes=function(n,t,u,f,e,o){for(var h=[],s=n,c=r.getEntityIntellisense(),n;s;)h=h.concat(i.getEntityAttributeIntellisense(s,!0,t,u,f,e,o)),c&&(n=c.filter(function(n){return n.ID==s}),s=n.length>0?n[0].ParentId:"");return h},f.removeObjInToArray=function(n,t){if(n&&n.length>0&&t){var i=n.indexOf(t);i>-1&&n.splice(i,1)}},f.validateID=function(t,i,r,u,o){var s=!1;t.errors||angular.isObject(t.errors)||(t.errors={});r||u!=undefined?isValidIdentifier(r,!1,!1,o)||(t.errors.inValid_id||(t.errors.inValid_id=n.VALIDATION.NOT_VALID_ID),s=!0):(delete t.errors.inValid_id,t.errors.empty_id||(t.errors.empty_id=n.VALIDATION.ID_EMPTY),s=!0);r==""&&u==!0&&(t.errors={});r&&(delete t.errors.empty_id,delete t.errors.duplicate_id);isValidIdentifier(r,!1,!1,o)&&delete t.errors.inValid_id;s&&i&&!e(i,t)&&i.push(t);t.errors&&!f.isEmptyObj(t.errors)&&i&&f.removeObjInToArray(i,t)},f.validateEmptyObjectField=function(t,i,r){var u=!1;t.errors||angular.isObject(t.errors)||(t.errors={});r||t.dictAttributes.sfwValue||(delete t.errors.inValid_id,t.errors.empty_ObjField||(t.errors.empty_ObjField=n.VALIDATION.OBJECT_FIELD_EMPTY),u=!0);r&&delete t.errors.empty_ObjField;u&&i&&!e(i,t)&&i.push(t);t.errors&&!f.isEmptyObj(t.errors)&&i&&f.removeObjInToArray(i,t)},f.validateIsEmptyMessageId=function(t,i,r){var u=!1;t.errors||angular.isObject(t.errors)||(t.errors={});r||!r!=undefined||(delete t.errors.inValid_id,t.errors.sfwMessageId||(t.errors.sfwMessageId=n.VALIDATION.EMPTY_FIELD),u=!0);r&&delete t.errors.sfwMessageId;u&&i&&!e(i,t)&&i.push(t);t.errors&&!f.isEmptyObj(t.errors)&&i&&f.removeObjInToArray(i,t)},f.validateIsEmptyMessageIdAndDescription=function(t,i,r,u){var o=!1,s;t.errors||angular.isObject(t.errors)||(t.errors={});r||u||(s=undefined,f.checkValidListValue(s,t,t.dictAttributes.sfwMessageId,"sfwMessageId","sfwMessageId",n.VALIDATION.MESSAGE_ID_EMPTY,i,!0),delete t.errors.EMPTY_MESSAGE_AND_ID,t.errors.EMPTY_MESSAGE_AND_ID||(t.errors.EMPTY_MESSAGE_AND_ID=n.VALIDATION.EMPTY_MESSAGE_AND_ID),delete t.errors.EMPTY_MESSAGE_DESC,t.errors.EMPTY_MESSAGE_DESC||(t.errors.EMPTY_MESSAGE_DESC=n.VALIDATION.EMPTY_MESSAGE_DESC),o=!0);r&&(delete t.errors.EMPTY_MESSAGE_DESC,delete t.errors.EMPTY_MESSAGE_AND_ID);u&&(delete t.errors.EMPTY_MESSAGE_DESC,delete t.errors.EMPTY_MESSAGE_AND_ID,t.errors.sfwMessageId&&delete t.errors.sfwMessageId,t.errors.EMPTY_FIELD&&delete t.errors.EMPTY_FIELD);t.errors.sfwMessageId&&t.errors.EMPTY_FIELD&&delete t.errors.sfwMessageId;o&&i&&!e(i,t)&&i.push(t);t.errors&&!f.isEmptyObj(t.errors)&&i&&f.removeObjInToArray(i,t)},f.validateDataType=function(t,i,r){t.errors||angular.isObject(t.errors)||(t.errors={});r&&r!=""||(t.errors.data_type||(t.errors.data_type=n.VALIDATION.DATA_TYPE_EMPTY),e(i,t)||i.push(t));r&&delete t.errors.data_type;t.errors&&!f.isEmptyObj(t.errors)&&f.removeObjInToArray(i,t)},f.validateEntity=function(t,i){var h,s=[],u;(s=r.getEntityNameList(),u=i?i:o(),u)&&(t.errors||angular.isObject(t.errors)||(t.errors={}),h=t&&t.dictAttributes?t.dictAttributes.sfwEntity:undefined,typeof h!="undefined"&&(t.errors.invalid_entity||(t.errors.invalid_entity=n.VALIDATION.INVALID_ENTITY),e(u,t)||u.push(t)),t&&s&&u&&s.length>0&&(!t.dictAttributes||t.dictAttributes.sfwEntity&&e(s,t.dictAttributes.sfwEntity)||(t.errors.invalid_entity||(t.errors.invalid_entity=n.VALIDATION.INVALID_ENTITY),e(u,t)||u.push(t)),e(s,t.dictAttributes.sfwEntity)&&delete t.errors.invalid_entity,t.errors&&!f.isEmptyObj(t.errors)&&f.removeObjInToArray(u,t)))},f.checkDuplicateId=function(n,t,i,r,u,e,o,h){r&&(n.errors&&n.errors.duplicate_id&&delete n.errors.duplicate_id,n.errors&&!f.isEmptyObj(n.errors)&&f.removeObjInToArray(i,n),n.warnings&&n.warnings.duplicate_id&&delete n.warnings.duplicate_id,n.errors&&!f.isEmptyObj(n.warnings)&&f.removeObjInToArray(i,n));s(n,t,i,u,e,o,h)},s=function(t,i,r,u,f,o,h){i.Elements.length>0&&angular.forEach(i.Elements,function(i){var c,l,a;i.Name!=="item"&&(c=i.dictAttributes.ID?i.dictAttributes.ID:"",l=t.dictAttributes.ID?t.dictAttributes.ID:"",c=h?c:c.toLowerCase(),l=h?l:l.toLowerCase(),c&&l&&c===l&&i!==t&&(t.errors||angular.isObject(t.errors)||(t.errors={}),t.warnings||angular.isObject(t.warnings)||(t.warnings={}),a=n.VALIDATION.DUPLICATE_ID,i.hasOwnProperty("isParent")&&i.isParent&&(a=n.VALIDATION.DUPLICATE_ID_IN_PARENT_ENTITY),i.hasOwnProperty("isParent")&&i.isParent&&o?t.warnings&&!t.warnings.duplicate_id&&(t.warnings.duplicate_id=a):t.errors&&!t.errors.duplicate_id&&(t.errors.duplicate_id=a),e(r,t)||(i.hasOwnProperty("isParent")&&i.isParent&&o?f.push(t):r.push(t))));i.Elements.length>0&&u.indexOf(i.Name)>-1&&s(t,i,r,u)})},f.findDuplicateDates=function(t,i,r,u){angular.forEach(t.Elements,function(t){if(t&&i&&t.dictAttributes[u]&&i.dictAttributes[u]&&t!=i){var o=new Date(t.dictAttributes[u]),s=new Date(i.dictAttributes[u]);f.IsValidDate(o)&&f.IsValidDate(s)&&o.toDateString()==s.toDateString()&&(i.errors||angular.isObject(i.errors)||(i.errors={}),i.errors&&!i.errors[u]&&(i.errors[u]=n.VALIDATION.DUPLICATE_EFFECTIVE_DATE),e(r,i)||r.push(i))}t&&t.Elements.length>0&&f.findDuplicateDates(t,i,r,u)})},f.findDuplicateId=function(n,t,i,r,u,e){var o=null,s,h;if(n.Elements.length>0)for(s=0;s<n.Elements.length;s++)if(currentObj=n.Elements[s],currentObj.Name!=r&&currentObj!=u)if(h=eval("currentObj."+e),h&&t&&h.toLowerCase()==t.toLowerCase()){o=currentObj;break}else if(currentObj.Elements.length>0&&i.indexOf(currentObj.Name)>-1&&(o=f.findDuplicateId(currentObj,t,i,r,u,e),o))break;return o},f.checkValidListValue=function(t,i,r,u,s,h,c,l,a,v,y){var p,w;if(w=typeof r!="undefined"?r:i&&i.dictAttributes?i.dictAttributes[u]:undefined,p=c?c:o(a),p){if(!i||i.errors||angular.isObject(i.errors)||(i.errors={}),l&&!w){i&&(i.errors[s]=n.VALIDATION.EMPTY_FIELD);e(p,i,y)||p.push(i);return}i&&i.errors.hasOwnProperty(s)&&(i.errors[s]="");w&&t?t&&t.length<=0?(i&&!i.errors[s]&&(i.errors[s]=h),e(p,i,y)||p.push(i)):i&&t&&p&&t.length>0&&(t=$.map(t,$.trim),w&&!e(t,v?w:w.trim(),y)&&(i.errors[s]||(i.errors[s]=h),e(p,i,y)||p.push(i)),(e(t,v?w:w.trim(),y)||!w)&&delete i.errors[s]):i&&i.errors.hasOwnProperty(s)&&delete i.errors[s];i&&i.errors&&!f.isEmptyObj(i.errors)&&f.removeObjInToArray(p,i)}},f.checkDuplicateValue=function(n,t,i,r,u,e,o){var s;s||(s=n.dictAttributes[r]);e&&(n.warnings&&n.warnings[u]&&delete n.warnings[u],s||n&&n.warnings&&n.warnings.hasOwnProperty(u)&&delete n.warnings[u],n.warnings&&!f.isEmptyObj(n.warnings)&&f.removeObjInToArray(i,n));s&&f.checkDuplicateValues(n,t,i,r,u,o)},f.checkDuplicateValues=function(t,i,r,u,o,s){i.Elements.length>0&&angular.forEach(i.Elements,function(i){if(i.dictAttributes[u]&&t.dictAttributes[u]&&i.dictAttributes[u].toLowerCase()==t.dictAttributes[u].toLowerCase()&&i!=t&&angular.isArray(s)&&s.indexOf(i.dictAttributes.sfwType)>-1){t.warnings||angular.isObject(t.warnings)||(t.warnings={});var h=n.VALIDATION.DUPLICATE_FIELD;i.hasOwnProperty("isParent")&&i.isParent&&(h="Duplicate field present in parent entity ");t.warnings&&!t.warnings[o]&&(t.warnings[o]=h);e(r,t)||r.push(t)}i.Elements.length>0&&f.checkDuplicateValues(t,i,r,u,o,s)})},f.checkValidListValueForMultilevel=function(t,i,r,u,e,o,s,h,c,l){var a=[],w=[],b=[],g,p,k,nt,d,tt,ut,it,rt,y,v;if(typeof r!="undefined"?g=r:i.dictAttributes&&i.dictAttributes[e]?g=i.dictAttributes[e]:i[e]&&(g=i[e]),g){if(a=g.split("."),a.indexOf("")>-1){b=[null];f.checkValidListValue(b,i,".",e,o,s,h,!1,!1,!0);return}ut=a.filter(Boolean);a=ut}else f.checkValidListValue(b,i,r,e,o,s,h,c,!1,!0);if(l&&l.length>0&&(p=l.contains("Object",!0)?!0:!1,k=l.contains("Collection",!0)||l.contains("List",!0)?!0:!1,nt=l.contains("Column",!0)?!0:!1,d=l.contains("CDOCollection",!0)?!0:!1,tt=l.contains("Expression",!0)?!0:!1),k&&(a.length>1?p=!0:(k=!0,p=!1)),i.Name&&(["sfwGridView","sfwChart","sfwListView","sfwCalendar","sfwScheduler"].indexOf(i.Name)>-1&&e=="sfwEntityField"?a.length>1?p=!0:(k=!0,p=!1):"sfwCheckBoxList"==i.Name&&e=="sfwEntityField"?a.length>1?p=!0:(d=!0,p=!1):i.Name=="sfwLabel"?tt=!0:(i.Name=="udc"||i.Name=="property")&&(p=!0)),it=!1,p||k||nt||d||(it=!0),a.length>0){if(w=f.getEntityAttributes(u,p,k,nt,d,tt),i.Name=="sfwDateTimePicker"&&a.length==1&&(w=w.filter(function(n){return n.DataType&&n.DataType.toLowerCase()=="datetime"})),b=f.getListByPropertyName(w,"ID"),(i.Name=="sfwGridView"||i.Name=="sfwSoftErrors")&&(b.push("InternalErrors"),b.push("ExternalErrors")),f.checkValidListValue(b,i,a[0],e,o,s,h,!1,!1,!0),i.errors&&i.errors[o])return;it&&(v=w.filter(function(n){return n.ID==a[0]}),v.length>0&&a.length==1&&v[0].DataType&&(v[0].DataType.toLowerCase()=="object"||v[0].DataType.toLowerCase()=="collection")&&f.checkValidListValue([],i,a[0],e,o,n.VALIDATION.ONLY_OBJECT_OR_COLLECTION,h,!1,!1,!0))}if(a.length>1)for(rt=!1,y=0;y<a.length;y++){if(l&&l.length>0&&l.contains("Object",!0)&&(l.contains("Collection",!0)||l.contains("List",!0))&&y+1==a.length-1&&(i.Name!="property"&&(p=!1),k=!0),i.Name=="sfwCheckBoxList"&&e=="sfwEntityField"&&y+1==a.length-1&&(p=!1,d=!0),["sfwGridView","sfwChart","sfwListView","sfwCalendar"].indexOf(i.Name)>-1&&e=="sfwEntityField"&&y+1==a.length-1&&(p=!1,k=!0),v=w.filter(function(n){return n.ID==a[y]}),v.length>0&&v[0].DataType&&v[0].DataType.toLowerCase()!="object"&&a[y+1]){f.checkValidListValue([],i,a[y+1],e,o,s,h,!1,!1,!0);break}if(v.length>0&&it&&y==a.length-1&&v[0].DataType&&(v[0].DataType.toLowerCase()=="object"||v[0].DataType.toLowerCase()=="collection")){f.checkValidListValue([],i,a[y+1],e,o,n.VALIDATION.ONLY_OBJECT_OR_COLLECTION,h,!1,!1,!0);break}v.length>0?typeof v[0].DataType!="undefined"&&(v[0].DataType.toLowerCase()=="object"||v[0].DataType.toLowerCase()=="collection"||v[0].DataType.toLowerCase()=="cdocollection"||v[0].DataType.toLowerCase()=="list")&&typeof v[0].Entity!="undefined"?a[y+1]&&(w=f.getEntityAttributes(v[0].Entity,p,k,nt,d,tt),i.Name=="sfwDateTimePicker"&&y+1==a.length-1&&(w=w.filter(function(n){return n.DataType&&n.DataType.toLowerCase()=="datetime"})),b=f.getListByPropertyName(w,"ID"),f.checkValidListValue(b,i,a[y+1],e,o,s,h,!1,!1,!0)):a[y+1]&&(rt=!0):rt=!0;rt&&(w=[],f.checkValidListValue(w,i,a[y+1],e,o,s,h,!1,!1,!0))}},f.checkValidListValueForXMLMethod=function(n,t,i,r,e,o,s,h,c,l,a,v){var w=[],b=[],nt=[],tt,rt,it,y,k,p,g,d;if(typeof i!="undefined"?tt=i:t.dictAttributes&&t.dictAttributes[e]?tt=t.dictAttributes[e]:t[e]&&(tt=t[e]),tt){if(w=tt.split("."),w.indexOf("")>-1){nt=[null];f.checkValidListValue(nt,t,".",e,o,s,h,!1,!1,!0);return}rt=w.filter(Boolean);w=rt}else f.checkValidListValue(nt,t,i,e,o,s,h,!1,!1,!0);if(angular.isArray(n)&&n.length>0&&(b=n),a){if(p=u.GetIntellisenseData(r,c,l,!0,!0,!0,!1,!1,!1),g=[],p)for(y=0;y<p.length;y++)p[y].Parameters&&p[y].Type=="Method"&&p[y].Parameters.length==0&&g.push(p[y]),p[y].Type!="Method"&&g.push(p[y]);b=b.concat(g)}else b=v?b.concat(u.GetIntellisenseData(r,c,l,!0,!1,!1,!1,!1,!0)):b.concat(u.GetIntellisenseData(r,c,l,!0,!0,!0,!0,!1,!1));if((!(w.length>0)||(nt=f.getListByPropertyName(b,"ID"),f.checkValidListValue(nt,t,w[0],e,o,s,h,!1,!1,!0),!t.errors||!t.errors[o]))&&w.length>1)for(it=!1,y=0;y<w.length;y++){if(k=b.filter(function(n){return n.ID==w[y]}),k.length>0&&k[0].DataType&&k[0].DataType.toLowerCase()!="object"&&w[y+1]){f.checkValidListValue([],t,w[y+1],e,o,s,h,!1,!1,!0);break}if(k.length>0)if(typeof k[0].DataType!="undefined"&&(k[0].DataType.toLowerCase()=="object"||k[0].DataType.toLowerCase()=="collection"||k[0].DataType.toLowerCase()=="cdocollection"||k[0].DataType.toLowerCase()=="list")&&typeof k[0].Entity!="undefined"){if(w[y+1]){if(a){if(p=u.GetIntellisenseData(k[0].Entity,c,l,!0,!0,!0,!1,!1,!1),g=[],p)for(d=0;d<p.length;d++)p[d].Parameters&&p[d].Type=="Method"&&p[d].Parameters.length==0&&g.push(p[d]),p[d].Type!="Method"&&g.push(p[d]);b=g}else b=u.GetIntellisenseData(k[0].Entity,c,l,!0,!0,!0,!0,!1,!1);nt=f.getListByPropertyName(b,"ID");f.checkValidListValue(nt,t,w[y+1],e,o,s,h,!1,!1,!0)}}else w[y+1]&&(it=!0);else it=!0;it&&(b=[],f.checkValidListValue(b,t,w[y+1],e,o,s,h,!1,!1,!0))}},f.checkDataFieldValue=function(n,t,i,r,u,e,o,s){var c=[],h=[];n&&n.length>0?t.Name=="sfwDateTimePicker"?(c=n.filter(function(n){return n.DataType&&n.DataType.toLowerCase()=="datetime"}),h=f.getListByPropertyName(c,r,!1),f.checkValidListValue(h,t,i,u,e,o,s)):(h=f.getListByPropertyName(n,r,!1),f.checkValidListValue(h,t,i,u,e,o,s)):f.checkValidListValue(h,t,i,u,e,o,s)},f.checkValidQuery=function(t,i,u,e,o,s,h,c,l,a){var v=[],p=[],k=[],d,y,w,b;if(u==""){f.checkValidListValue(t,i,u,o,s,h,c,a);return}if(typeof u!="undefined"){if(v=u.split("."),v.indexOf("")>-1||v.length==1){f.checkValidListValue(["null"],i,".",o,s,h,c,a);return}d=v.filter(Boolean);v=d}else{f.checkValidListValue(["null"],i,"null",o,s,h,c,a);return}if((!(v.length>0)||(p=r.getEntityNameList(),f.checkValidListValue(p,i,v[0],o,s,h,c,a),!i.errors||!i.errors[s]))&&v.length>1)for(y=0;y<v.length;y++)w=t.filter(function(n){return n.ID==v[y]}),w.length>0&&w[0].Queries?(p=e=="SubSelectQuery"?w[0].Queries.filter(function(n){return n.QueryType=="SubSelectQuery"}):e=="ScalarQuery"?w[0].Queries.filter(function(n){return n.QueryType=="ScalarQuery"}):w[0].Queries.filter(function(n){return n.QueryType!="SubSelectQuery"}),v[y+1]?(k=f.getListByPropertyName(p,"ID"),f.checkValidListValue(k,i,v[y+1],o,s,h,c,a),l&&(b=p.filter(function(n){return n.ID==v[y+1]}),b&&b.length>0&&b[0].Parameters.length>0&&f.checkValidListValue([],i,v[y+1],o,s,n.VALIDATION.QUERY_WITH_PARAMETER,c,a))):p=[]):y>1&&f.checkValidListValue([],i,v[y+1],o,s,h,c,a)},f.getListByPropertyName=function(n,t,i){var r=[];return n&&n.length>0&&t&&angular.forEach(n,function(n){var i;n&&n.hasOwnProperty(t)?(i=n[t],i&&r.push(i.trim())):n&&n.dictAttributes&&n.dictAttributes.hasOwnProperty(t)&&(i=n.dictAttributes[t],i&&r.push(i.trim()))}),r=r.sort(),i&&(r=r.reverse()),r},f.checkMultipleValueWithList=function(n,t,i,r,u,o,s,h){var l,a=!1,c;if(i)i=i.split(r);else{f.checkValidListValue(["null"],t,"null",u,o,s,h);return}for(c=0;c<i.length;c++)if(l=i[c],!e(n,l)){a=!0;break}(a||t.errors&&t.errors[o])&&f.checkValidListValue(n,t,l,u,o,s,h)},f.checkActiveForm=function(n,t,i,r,u,e,o){var h,c,s;if(i&&(i.indexOf(";")>-1||i.contains("="))){for(h=i.split(";"),c="",s=0;s<h.length;s++)c+=h[s].indexOf("=")>-1?h[s].split("=")[1]+";":h[s]+";";c=c.slice(0,-1);f.checkMultipleValueWithList(n,t,c,";",r,u,e,o)}else f.checkValidListValue(n,t,i,r,u,e,o)},f.validateDataTypes=function(t,i,r,u){var h="invalid_data_type_value",c=n.VALIDATION.INVALID_DATATYPE,s=!1;if(i||(i="",s=!0,c=n.VALIDATION.EMPTY_VALUE),t){switch(r){case"int":(isNaN(i)||i.contains("."))&&(s=!0);(!isNaN(i)&&parseInt(i)>2147483647||parseInt(i)<-2147483648)&&(s=!0);break;case"bool":["true","false"].indexOf(i)<=-1&&(s=!0);break;case"decimal":isNaN(i)?s=!0:(!isNaN(i)&&parseFloat(i)>79228162514264337593543950335||parseFloat(i)<-79228162514264337593543950335)&&(s=!0);break;case"double":isNaN(i)?s=!0:(!isNaN(i)&&parseFloat(i)>Number.MAX_VALUE||parseFloat(i)==Number.NEGATIVE_INFINITY)&&(s=!0);break;case"float":isNaN(i)?s=!0:(!isNaN(i)&&parseFloat(i)>Number.MAX_VALUE||parseFloat(i)==Number.NEGATIVE_INFINITY)&&(s=!0);break;case"long":isNaN(i)||i.contains(".")?s=!0:(!isNaN(i)&&parseInt(i)>9223372036854775807||parseInt(i)<-9223372036854775808)&&(s=!0);break;case"short":isNaN(i)||i.contains(".")?s=!0:(!isNaN(i)&&parseInt(i)>32767||parseInt(i)<-32768)&&(s=!0)}validationErrorList=u?u:o(isDialog);!t||t.errors||angular.isObject(t.errors)||(t.errors={});delete t.errors[h];s&&(t.errors[h]||(t.errors[h]=c),e(validationErrorList,t)||validationErrorList.push(t));t&&t.errors&&!f.isEmptyObj(t.errors)&&f.removeObjInToArray(validationErrorList,t)}},f.createFullPath=function(n,t){var f="",u,r,e,i;if(n&&t)for(u=-1,u=n.Elements.indexOf(t[0]),u>-1&&(f+=t[0].Name+"-"+u),r=-1,e=t.length-1,i=0;i<e;i++)r=-1,r=t[i].Elements.indexOf(t[i+1]),r>-1&&(f+=","+t[i+1].Name+"-"+r);return f},f.scrollToPosition=function(n,r,u){var e=i.currentopenfile&&i.currentopenfile.file?i.currentopenfile.file.FileName:undefined,f;((n.indexOf(".")>-1||n.indexOf("#")>-1)&&r.indexOf(".")>-1||r.indexOf("#")>-1&&e)&&(f=$("#"+e).contents(),t(function(){setTimeout(function(){var t=$(f).find(n+r).find("."+u);t&&$(f).find(n+r).scrollTo(t,null,null)},500)}))},f.validateRule=function(t,i,u,f,e,o,s,h,c){var v,y;if(t)if(c||(c="field value"),i){isValid=!1;var l=null,a=null,p=i.indexOf(".");p>-1?(v=i.split("."),v.length==2&&(l=v[0],a=v[1])):(l=u,a=i);l&&a&&(y=r.getEntityIntellisense().filter(function(n){return n.ID===l})[0],y&&y.Rules.some(function(n){return n.ID===a&&n.Status.toLowerCase()==="active"&&(!o||!o.length||o.indexOf(n.RuleType.toLowerCase())>-1)&&(!e||!e.length||e.indexOf(n.ReturnType.toLowerCase())>-1)})&&(isValid=!0));isValid?t&&t.errors&&t.errors[s]&&(t.errors[s]=null):(t.errors||(t.errors={}),t.errors[s]=String.format(n.VALIDATION.INVALID_GENERIC,c))}else h||(t.errors||(t.errors={}),t.errors[s]=String.format(n.VALIDATION.EMPTY_GENERIC,c))},f}]);app.filter("unique",[function(){return function(n,t){var i=[],r=[];return angular.forEach(n,function(n){var u=n[t];r.indexOf(u)===-1&&(r.push(u),i.push(n))}),i}}]);app.value("$ObjectsSearch",{QueryObj:{NodeName:"",Attribute:"",Operator:"",AttributeValue:"",isWholeWord:!1,isMatchCase:!1,operatorList:[]},AdvanceQueryObj:{fileName:"",containingText:"",location:"",isCreatedDate:!1,isModifiedDate:!1,fromDate:"",toDate:"",fileType:[],IsGetAllFiles:!1,QuerySearchList:[]},FileTypesQueryReference:["Entity","Lookup","Maintenance","Wizard","UserControl","Tooltip","FormLinkLookup","FormLinkMaintenance","FormLinkWizard","Report","BPMN","BPMTemplate","Correspondence","Prototype","OutboundFile"]});app.factory("$searchQuerybuilder",["$ObjectsSearch",function(n){var t={lstFilter:[],isAdvanceSearch:!0};return{AddsearchQuerybuilderObj:function(t){var i=angular.copy(n.QueryObj);i.operatorList=this.getOperatorList();t.push(i)},DeletesearchQuerybuilderObj:function(n,t){var i=n.indexOf(t);n.splice(i,1)},getOperatorList:function(){if(arguments.length==0)return[{name:"Has Attribute",value:"HasAttribute",key:"A"},{name:"Has Node",value:"HasNode",key:"N"},{name:"Contains",value:"Contains",key:"V"},{name:"Equal To",value:"EqualTo",key:"V"}];switch(arguments[0]){case"N":return[{name:"Has Node",value:"HasNode",key:"N"}];case"A":return[{name:"Has Attribute",value:"HasAttribute",key:"A"}];case"V":return[{name:"Contains",value:"Contains",key:"V"},{name:"Equal To",value:"EqualTo",key:"V"}]}},onchangeQueryBuilder:function(n,t,i){n.AttributeValue&&t.hasOwnProperty("AttributeValue"+i)&&t["AttributeValue"+i].$invalid&&t["AttributeValue"+i].$setValidity("data-value",!0);n.Attribute&&t.hasOwnProperty("Attribute"+i)&&t["Attribute"+i].$invalid&&t["Attribute"+i].$setValidity("data-value",!0);n.NodeName&&t.hasOwnProperty("NodeName"+i)&&t["NodeName"+i].$invalid&&t["NodeName"+i].$setValidity("data-value",!0);this.setcontrolValidity(n,t,i)},setcontrolValidity:function(n,t,i){n.Operator=="Contains"||n.Operator=="EqualTo"?n.AttributeValue||t.hasOwnProperty("AttributeValue"+i)&&t["AttributeValue"+i].$setValidity("data-value",!1):n.Operator=="HasAttribute"?n.Attribute||t.hasOwnProperty("Attribute"+i)&&t["Attribute"+i].$setValidity("data-value",!1):n.Operator=="HasNode"&&(n.NodeName||t.hasOwnProperty("NodeName"+i)&&t["NodeName"+i].$setValidity("data-value",!1))},onchangeOperatorQueryBuilder:function(n,t,i){t.hasOwnProperty("AttributeValue"+i)&&t["AttributeValue"+i].$setValidity("data-value",!0);t.hasOwnProperty("Attribute"+i)&&t["Attribute"+i].$setValidity("data-value",!0);t.hasOwnProperty("NodeName"+i)&&t["NodeName"+i].$setValidity("data-value",!0);this.setcontrolValidity(n,t,i)},getcssClassInvalidError:function(n,t){return n.hasOwnProperty(t)&&n[t].$invalid?"invalid-input-error":""},IsOperatorMode:function(n,t){if(t.operatorList.length>0)return t.operatorList.some(function(t){if(t.key!=n)return!0})},getGlobalQueryBuilder:t,setGlobalQueryBuilderFilters:function(n){t.lstFilter=n},setQueryBuilderIsAdvanceOption:function(n){t.isAdvanceSearch=n},clearSearchQueryBuilder:function(){t.lstFilter=[];t.isAdvanceSearch=!0}}}]);app.factory("$searchFindReferences",["$ObjectsSearch","$rootScope","hubcontext",function(n,t,i){var r={type:"",lstReferences:[],activeReference:null,ReferenceValue:"",activeReferenceID:""};return{get:function(u,f){var e=angular.copy(n.AdvanceQueryObj),o=angular.copy(n.QueryObj);return o.Operator="Contains",o.AttributeValue=u,o.isWholeWord=!0,o.isMatchCase=!0,r.ReferenceValue=u,e.ReferenceType=f,e.FileName=t.currentopenfile.file.FileName,e.FileType=n.FileTypesQueryReference,e.QuerySearchList.push(o),i.hubSearch.server.getFindReference(e)},getData:r,setData:function(n,t,i){r.type=n?n:r.type;r.lstReferences=t?t:r.lstReferences;r.activeReference=i;r.activeReferenceID=i?i.FileInfo.FileName+i.LineNumber:r.activeReferenceID},resetData:function(){r.type="";r.lstReferences=[];r.activeReference=null;r.activeReferenceID="";r.ReferenceValue=""}}}]);app.service("$ValidateBaseModelStructure",[function(){this.is_validModelElements=function(n,t,i){var r=!1;return n&&n.dictAttributes&&n.Name==t&&(r=!0,i&&(r=n.Elements&&n.Elements.length>0?!0:!1)),r}}]);app.service("$SgMessagesService",["$rootScope",function(n){this.Message=function(i,r,u,f,e){var o=n.$new(!0),s,h,c;s&&t(s);s=null;o.message=r;o.isConfirmBox=u;h=400;c=170;e&&(e.height&&(c=e.height),e.width&&(h=e.width));o.$evalAsync(function(){s=n.showDialog(o,i,"Common/views/sgAlertBox.html",{width:h,height:c,isAlert:!0})});o.cancelConfirmClick=function(){typeof f=="function"&&f(!1);t(s)};o.okConfirmClick=function(){typeof f=="function"&&f(!0);t(s)};return};var t=function(n){n&&n.close()}}]);app.service("$GetGridEntity",["$GetEntityFieldObjectService",function(n){this.getEntityName=function(t,i){var f=null,r=null,o,e,u;return t&&(t.dictAttributes.sfwType=="Lookup"||t.dictAttributes.sfwType=="FormLinkLookup")?f=t.dictAttributes.sfwEntity:t&&i&&(r=FindParent(i,"sfwGridView"),r&&r.dictAttributes.sfwParentGrid&&r.dictAttributes.sfwEntityField&&(e=FindControlByID(t,r.dictAttributes.sfwParentGrid),e&&e.dictAttributes.sfwEntityField&&(u=n.GetEntityFieldObjectFromEntityField(t.dictAttributes.sfwEntity,e.dictAttributes.sfwEntityField),u&&(f=u.Entity,FindParent(i,"ItemTemplate")&&(o=n.GetEntityFieldObjectFromEntityField(f,r.dictAttributes.sfwEntityField),o&&(f=o.Entity))))),i&&r&&r.dictAttributes.sfwParentGrid&&(i.Name=="TemplateField"||FindParent(i,"HeaderTemplate"))?(e=FindControlByID(t,r.dictAttributes.sfwParentGrid),e&&e.dictAttributes.sfwEntityField&&(u=n.GetEntityFieldObjectFromEntityField(t.dictAttributes.sfwEntity,e.dictAttributes.sfwEntityField),u&&(f=u.Entity))):i&&(i.Name=="TemplateField"||FindParent(i,"HeaderTemplate"))?f=t.dictAttributes.sfwEntity:r&&(u=n.GetEntityFieldObjectFromEntityField(t.dictAttributes.sfwEntity,r.dictAttributes.sfwEntityField),u&&(f=u.Entity))),f}}]);app.factory("$IentBaseMethodsFactory",[function(){var n=[];return{setIentBaseMethods:function(t){angular.forEach(t,function(n){n.MethodName&&(n.ID=n.MethodName)});n=t},getIentBaseMethods:function(){return n}}}]);app.factory("$ModuleValidationService",["$FormValidationService","$entityValidationService",function(n,t){var i={};return i.validate=function(i,r,u){u==="Form"?n.validateFileData(i,r):u==="Entity"&&t.validateFileData(i,r)},i}]);app.service("$getEnitityRule",["$rootScope","$filter","$Entityintellisenseservice",function(n,t,i){this.getWithParam=function(n,r,u){var s=[],h=[],e,f,o,c;if(n&&(e=i.GetIntellisenseData(n,"","",!0,!1,!1,!0,!1,!1),e&&e.length>0)){if(f=[],u)for(lstRuleTypes=u.split(","),o=0;o<lstRuleTypes.length;o++)c=lstRuleTypes[o],f=f.concat(t("filter")(e,{IsStatic:r,RuleType:c},!0));else f=t("filter")(e,{IsStatic:r},!0);if(f.length>0){function n(n){h.push(n.ID);this.push({ID:n.ID,Parameters:n.Parameters,ReturnType:n.ReturnType})}angular.forEach(f,n,s)}}return{objRule:s,ruleIds:h}}}]);app.service("$getEnitityXmlMethods",["$rootScope","$filter","$Entityintellisenseservice",function(n,t,i){this.get=function(n,t,r){var u=[];return n&&(u=i.GetIntellisenseData(n,"","",!0,!1,!1,!1,!1,!0),u&&u.length>0&&t&&t.trim().length>0&&(t.toLowerCase()=="load"?(u=u.filter(function(n){return n.MethodType.toLowerCase()=="load"}),r&&r.trim().length>0&&(r.toLowerCase()=="new"?u=u.filter(function(n){return n.Mode.toLowerCase()=="new"||n.Mode.toLowerCase()=="all"}):r.toLowerCase()=="update"&&(u=u.filter(function(n){return n.Mode.toLowerCase()=="update"||n.Mode.toLowerCase()=="all"})))):t.toLowerCase()=="nonload"&&(u=u.filter(function(n){n.MethodType.toLowerCase()!="load"})))),u};this.getByBusinessObject=function(n){var r=[],u,i;return n&&(u=$EntityIntellisenseFactory.getEntityIntellisense(),i=t("filter")(u,{BusinessObjectName:n},!0),i&&i.length>0&&(r=i[0].XmlMethods)),r}}]);app.service("$getEnitityObjectMethods",["$rootScope","$filter","$Entityintellisenseservice",function(n,t,i){this.get=function(n){var t=[];return n&&(t=i.GetIntellisenseData(n,"","",!0,!1,!0,!1,!1,!1)),t}}]);app.service("$Entityintellisenseservice",["$filter","$EntityIntellisenseFactory","$Entityintellisensefilterservice",function(n,t,i){this.GetIntellisenseData=function(r,u,f,e,o,s,h,c,l){var y=[],v=[],p=[],w=[],b=[],k=[],d,a,g;if(r){for(d=t.getEntityIntellisense(),parentEntityID=r;parentEntityID;)a=n("filter")(d,{ID:parentEntityID},!0),a&&a.length>0?(o&&(g=a[0].Attributes,v=v.concat(g)),parentEntityID=e?a[0].ParentId:"",s&&(w=w.concat(a[0].ObjectMethods)),h&&(p=p.concat(a[0].Rules)),c&&(b=b.concat(a[0].Queries)),l&&(k=k.concat(a[0].XmlMethods))):parentEntityID="";v.length>0&&(u||f)&&(v=i.GetIntellisenseFilterData(v,u,f));y=y.concat(v).concat(w).concat(p).concat(b).concat(k)}return y}}]);app.service("$Entityintellisensefilterservice",["$filter",function(n){this.GetIntellisenseFilterData=function(t,i,r){var o=[],e,u;if(i){var s=i.split(","),f=[],h=!1;for(u=0;u<s.length;u++)s[u]=="Object"&&(h=!0),f=f.concat(n("filter")(t,{Type:s[u]}));if(h||(f=f.concat(n("filter")(t,{Type:"Object"}))),r&&f.length>0){for(e=r.split(","),lstDataTypeAttr=[],u=0;u<e.length;u++)lstDataTypeAttr=lstDataTypeAttr.concat(n("filter")(f,{DataType:e[u]}));o=lstDataTypeAttr}else o=f}else if(r){for(e=r.split(","),lstDataTypeAttr=[],u=0;u<e.length;u++)lstDataTypeAttr=lstDataTypeAttr.concat(n("filter")(t,{DataType:e[u]}));o=lstDataTypeAttr}else o=t;return o}}]);app.service("$GetEntityFieldObjectService",["$filter","$Entityintellisenseservice",function(n,t){this.GetEntityFieldObjectFromEntityField=function(i,r){var u="",f,s,e,o;if(r&&(f=r.split("."),i&&r&&(s=t.GetIntellisenseData(i,"","",!0,!0,!1,!1,!1,!1),f.length>0)))for(e=0;e<f.length;e++)o=n("filter")(s,{ID:f[e]},!0),o&&o.length>0?(u=o[0],s=t.GetIntellisenseData(u.Entity,"","",!0,!0,!1,!1,!1,!1)):u="";return u};this.GetEntityFieldObjectFromFieldValue=function(i,r){var f="",e=t.GetIntellisenseData(i,"","",!0,!0,!1,!1,!1,!1),u;return r&&(u=n("filter")(e,{Value:r},!0),f=u&&u.length>0?u[0]:""),f}}]);app.service("$getModelList",[function(){this.getModelListFromQueryFieldlist=function(n){var r=[],i,t,u;if(n&&n.length>0)for(i=0;i<n.length;i++)t=n[i],t.Data1&&t.Data1!=null?datatype=t.Data1.toLowerCase():t.DataType&&(datatype=t.DataType.toLowerCase()),u={ID:t.CodeID,DisplayName:t.CodeID,Value:t.CodeID,DataType:datatype,Entity:"",Direction:"",IsPrivate:"",Type:"",KeyNo:"",CodeID:""},r.push(u);return r}}]);app.service("$getQueryparam",["$rootScope","$filter","$EntityIntellisenseFactory",function(n,t,i){this.get=function(n){var o="",r=n.split("."),u,f,e;if(r.length>1){var s=i.getEntityIntellisense(),c=s,h=t("filter")(s,{ID:r[0]},!0);if(h.length==1&&(u=t("filter")(h[0].Queries,{ID:r[1]},!0),u.length==1&&(f=u[0].Parameters,f.length>0))){e=[];function n(n){this.push(n.ID+"=")}angular.forEach(f,n,e);o=e.join(";")+";"}}return o};this.getMapVariableIds=function(n){function i(n){n.dictAttributes&&n.dictAttributes.id&&this.push(n.dictAttributes.id)}var t=[];return angular.forEach(n,i,t),t};this.getQueryparamfromString=function(n,t,i){var r=[],u;if(n[t]){u=n[t].split(i);function f(n){if(n){var t=n.split("=");this.push({ID:t[0],Value:t[1]})}}angular.forEach(u,f,r)}return r};this.getQueryparamfromObjArray=function(n,t,i){var u,r,f;if(n&&t&&i){for(u=[],r=0;r<n.length;r++)f={ID:getPropertyValue(n[r],t),Value:getPropertyValue(n[r],i)},u.push(f);return u}}}]);app.controller("SearchIDDescriptionController",["$scope","$rootScope","$timeout",function(n,t,i){n.Search={ID:"",Description:""};n.Init=function(){n.SearchResultCollection=[]};n.PopulateSearchResult=function(){function t(t){var i={};n.SearchResultCollection.length<100&&(n.strCode=="Codegroups"?n.Search.ID!=undefined&&n.Search.ID!=""&&n.Search.Description!=undefined&&n.Search.Description!=""?t.CodeID&&t.CodeID.contains(n.Search.ID)&&t.Description&&t.Description.toLowerCase().contains(n.Search.Description.toLowerCase())&&(i={ID:t.CodeID,Description:t.Description},n.SearchResultCollection.push(i)):(n.Search.ID!=undefined||n.Search.ID!="")&&(n.Search.Description==undefined||n.Search.Description=="")?t.CodeID&&t.CodeID.contains(n.Search.ID)&&(i={ID:t.CodeID,Description:t.Description},n.SearchResultCollection.push(i)):(n.Search.ID==undefined||n.Search.ID=="")&&(n.Search.Description!=undefined||n.Search.Description!="")&&t.Description&&t.Description.toLowerCase().contains(n.Search.Description.toLowerCase())&&(i={ID:t.CodeID,Description:t.Description},n.SearchResultCollection.push(i)):n.strCode=="Codeiddescription"?n.Search.ID!=undefined&&n.Search.ID!=""&&n.Search.Description!=undefined&&n.Search.Description!=""?t.CodeValue&&t.CodeValue.toLowerCase().contains(n.Search.ID.toLowerCase())&&t.Description&&t.Description.toLowerCase().contains(n.Search.Description.toLowerCase())&&(i={ID:t.CodeValue,Description:t.Description},n.SearchResultCollection.push(i)):(n.Search.ID!=undefined||n.Search.ID!="")&&(n.Search.Description==undefined||n.Search.Description=="")?t.CodeValue&&t.CodeValue.toLowerCase().contains(n.Search.ID.toLowerCase())&&(i={ID:t.CodeValue,Description:t.Description},n.SearchResultCollection.push(i)):(n.Search.ID==undefined||n.Search.ID=="")&&(n.Search.Description!=undefined||n.Search.Description!="")&&t.Description&&t.Description.toLowerCase().contains(n.Search.Description.toLowerCase())&&(i={ID:t.CodeValue,Description:t.Description},n.SearchResultCollection.push(i)):n.strCode=="Resources"?n.Search.ID!=undefined&&n.Search.ID!=""&&n.Search.Description!=undefined&&n.Search.Description!=""?t.ResourceID&&t.ResourceID.contains(n.Search.ID)&&t.ResourceDescription&&t.ResourceDescription.toLowerCase().contains(n.Search.Description.toLowerCase())&&(i={ID:t.ResourceID,Description:t.ResourceDescription},n.SearchResultCollection.push(i)):(n.Search.ID!=undefined||n.Search.ID!="")&&(n.Search.Description==undefined||n.Search.Description=="")?t.ResourceID&&t.ResourceID.contains(n.Search.ID)&&(i={ID:t.ResourceID,Description:t.ResourceDescription},n.SearchResultCollection.push(i)):(n.Search.ID==undefined||n.Search.ID=="")&&(n.Search.Description!=undefined||n.Search.Description!="")&&t.ResourceDescription&&t.ResourceDescription.toLowerCase().contains(n.Search.Description.toLowerCase())&&(i={ID:t.ResourceID,Description:t.ResourceDescription},n.SearchResultCollection.push(i)):n.Search.ID!=undefined&&n.Search.ID!=""&&n.Search.Description!=undefined&&n.Search.Description!=""?t.MessageID&&t.MessageID.contains(n.Search.ID)&&t.DisplayMessage&&t.DisplayMessage.toLowerCase().contains(n.Search.Description.toLowerCase())&&(i={ID:t.MessageID,Description:t.DisplayMessage,SeverityValue:t.SeverityValue},n.SearchResultCollection.push(i)):(n.Search.ID!=undefined||n.Search.ID!="")&&(n.Search.Description==undefined||n.Search.Description=="")?t.MessageID&&t.MessageID.contains(n.Search.ID)&&(i={ID:t.MessageID,Description:t.DisplayMessage,SeverityValue:t.SeverityValue},n.SearchResultCollection.push(i)):(n.Search.ID==undefined||n.Search.ID=="")&&(n.Search.Description!=undefined||n.Search.Description!="")&&t.DisplayMessage&&t.DisplayMessage.toLowerCase().contains(n.Search.Description.toLowerCase())&&(i={ID:t.MessageID,Description:t.DisplayMessage,SeverityValue:t.SeverityValue},n.SearchResultCollection.push(i)))}n.SearchResultCollection=[];n.strCode=="Codegroups"?angular.forEach(n.codegrouplist,t):n.strCode=="Codeiddescription"?angular.forEach(n.codevalueslist,t):n.strCode=="Resources"?angular.forEach(n.resourcelist,t):n.strCode=="Messages"&&angular.forEach(n.lstMessages,t)};n.SelectSearchObject=function(t){n.SelectedSearchResult=t};n.onOkClick=function(){n.$emit("onOKClick",n.SelectedSearchResult);i(function(){n.validateResource&&n.validateResource();n.validateMessageID&&n.validateMessageID()});n.onCancelClick()};n.onCancelClick=function(){n.SearchIDDescrDialog.close()};n.Init()}]);app.controller("FindAdvanceFilesController",["$scope","$rootScope","hubcontext","$resourceFactory",function(n,t,i,r){n.Init=function(){n.AdvanceSearch={};n.AdvanceSearch.filetypes=r.getFileTypeList();n.AdvanceSearch.searchFileType="All";n.AdvanceSearch.PageIndex=0;n.totalDisplayed=20};n.searchTrigger=function(){n.ngpausescroll=!0;n.before=performance.now();t.IsLoading=!0;i.hubSearch.server.getFileFindAdvance(n.getSearchObj())};n.searchFileSelect=function(i){n.FindDialog.close();t.openFile(i.FileInfo)};n.resetFind=function(){n.AdvanceSearch.PageIndex=0};$("#findFilesDiv").scroll(function(){n.totalDisplayed>=n.AdvanceSearch.findSearchList.length&&!n.ngpausescroll?(n.AdvanceSearch.PageIndex=n.AdvanceSearch.PageIndex+1,n.searchTrigger()):n.totalDisplayed<n.AdvanceSearch.findSearchList.length&&!n.ngpausescroll&&$(this)[0].scrollTop+$(this)[0].offsetHeight==$(this)[0].scrollHeight&&(n.$$phase?n.$evalAsync(function(){n.totalDisplayed+=20}):n.$apply(function(){n.totalDisplayed+=20}))});n.getSearchObj=function(){return{SearchText:n.AdvanceSearch.searchText,MatchCase:n.AdvanceSearch.matchCase,MatchWholeWord:n.AdvanceSearch.matchWholeWord,SearchPattern:n.AdvanceSearch.searchFileType,PageIndex:n.AdvanceSearch.PageIndex}};n.setFileFindAdvance=function(i,r){n.ngpausescroll=!1;n.$evalAsync(function(){t.IsLoading=!1;n.AdvanceSearch.CountFilesParsed=i.CountFilesParsed;i.PageIndex==1?(n.totalDisplayed=20,r!=null&&(n.AdvanceSearch.findSearchList=r)):r!=null&&(n.AdvanceSearch.findSearchList=n.AdvanceSearch.findSearchList.concat(r));n.AdvanceSearch.findSearchList.length<=n.totalDisplayed&&i.ScrollLoadEnable&&(n.AdvanceSearch.PageIndex=n.AdvanceSearch.PageIndex+1,n.searchTrigger())})};n.Init()}]);app.factory("$FormatQueryFactory",["hubcontext","$http",function(n){var i,t={sqlReserveWords:i};return n.hubMain&&(n.hubMain.client.setsqlserverreservedwords=function(n){var i=JSON.parse(n);t.sqlReserveWords=i}),{getSqlReserveWords:function(){return t.sqlReserveWords},formatQuery:function(n){if(n)return $.connection.hubEntityModel.server.formatQuery(n)},createQueryWithNoLock:function(n){if(n)return $.connection.hubEntityModel.server.createQueryWithNoLock(n)}}}]);app.service("$Chart",["$rootScope",function(n){var r=["#219ae7","#294ec7","#5E78CD","#30437E","#763555","#421D2F","#662A48","#CD6E1F","#e77b21","#EE9F5D","#f7caa5","#e0ab7f","#ef6000","#1FA28E","#25bba4","#34E0C6","#366657","#6d2d80","#6A5870","#004C63","#136B85","#149398","#107074","#149398","#107074"],t=[],i=[];this.drawBarChart=function(n,t,i,r){var f=document.getElementById(t),v=f.clientWidth,y=f.clientHeight,p=parseFloat(window.getComputedStyle(f,null).getPropertyValue("padding-left").replace("px","")),w=parseFloat(window.getComputedStyle(f,null).getPropertyValue("padding-right").replace("px","")),b=parseFloat(window.getComputedStyle(f,null).getPropertyValue("padding-top").replace("px","")),k=parseFloat(window.getComputedStyle(f,null).getPropertyValue("padding-bottom").replace("px","")),l=v-p-w,a=y-b-k,e=d3.select(f).append("svg"),u={top:20,right:20,bottom:35,left:40},s=l-u.left-u.right,o=a-u.top-u.bottom;e.attr("width",l).attr("height",a);var h=d3.scale.ordinal().domain(n.map(function(n){return n[i]})).rangeRoundBands([0,s],.1),c=d3.scale.linear().domain([0,d3.max(n,function(n){return n[r]})]).range([o,0]),d=d3.svg.axis().scale(h).orient("bottom").innerTickSize(-o).outerTickSize(0).tickPadding(10),g=d3.svg.axis().scale(c).orient("left").innerTickSize(-s).outerTickSize(0).tickPadding(10),e=d3.select("svg").attr("width",s+u.left+u.right).attr("height",o+u.top+u.bottom).append("g").attr("transform","translate("+u.left+","+u.top+")");e.append("g").attr("class","x axis").attr("transform","translate(0,"+o+")").call(d);e.append("g").attr("class","y axis").call(g);e.selectAll(".bar").data(n).enter().append("rect").attr("class","bar").attr("x",function(n){return h(n[i])}).attr("y",function(n){return c(n[r])}).attr("width",h.rangeBand()).attr("height",function(n){return o-c(n[r])}).attr("fill","#dab45f");e.selectAll(".x .tick text").attr("transform","translate(0,2)rotate(-12)")};this.drawStackedBarChart=function(n,t,i,u){var b;if($("#"+t)[0]){$("#"+t)[0].innerHTML="";var k=n,f=document.getElementById(t),d=f.clientWidth,g=f.clientHeight,nt=parseFloat(window.getComputedStyle(f,null).getPropertyValue("padding-left").replace("px","")),tt=parseFloat(window.getComputedStyle(f,null).getPropertyValue("padding-right").replace("px","")),it=parseFloat(window.getComputedStyle(f,null).getPropertyValue("padding-top").replace("px","")),rt=parseFloat(window.getComputedStyle(f,null).getPropertyValue("padding-bottom").replace("px","")),a=d-nt-tt,v=g-it-rt,e={top:20,right:50,bottom:35,left:20},y=a-e.left-e.right,p=v-e.top-e.bottom,w=35,o=d3.scale.ordinal().rangeRoundBands([0,y],.1),s=d3.scale.linear().range([p,0]),ut=d3.svg.axis().scale(o).orient("bottom").outerTickSize(0).tickPadding(10),ft=d3.svg.axis().scale(s).orient("left").innerTickSize(-y).outerTickSize(0).tickPadding(10),c=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(n){return"<strong>"+n.z+" :<\/strong> <span>"+n.y+"<\/span>"}),l=d3.select(f).append("svg").attr("width",a).attr("height",v).append("g").attr("transform","translate("+e.right+","+e.top+")").call(c),h=d3.layout.stack()(["Entity","LogicalRule","DecisionTable","ExcelMatrix","ExcelScenario","ObjectScenario","ParameterScenario","Lookup","Maintenance","Wizard","UserControl","Tooltip","Prototype","FormLinkLookup","FormLinkMaintenance","FormLinkWizard","Report","InboundFile","OutboundFile","Correspondence","PDFCorrespondence","BPMN","BPMTemplate","WorkflowMap"].map(function(n){return k.map(function(t){return{x:t[i],y:t[u][n],z:n}})}));o.domain(h[0].map(function(n){return n.x}));s.domain([0,d3.max(h[h.length-1],function(n){return n.y0+n.y})]).nice();l.append("g").attr("class","axis axis--x").attr("transform","translate(0,"+p+")").call(ut);l.append("g").attr("class","axis axis--y").call(ft).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text("Count");b=l.selectAll(".layer").data(h).enter().append("g").attr("class","layer").style("fill",function(n,t){return r[t]});b.selectAll("rect").data(function(n){return n}).enter().append("rect").attr("x",function(n){return o(n.x)+(o.rangeBand()-w)/2}).attr("y",function(n){return s(n.y+n.y0)}).attr("height",function(n){return s(n.y0)-s(n.y+n.y0)}).attr("width",Math.min(o.rangeBand(),w)).on("mouseover",c.show).on("mouseout",c.hide)}};this.drawPieChart=function(n,t,i,r){if($("#"+t)[0]){$("#"+t)[0].innerHTML="";var e=d3.sum(n,function(n){return d3.sum(d3.values(n))}),o=document.getElementById("TfsChart"),s=o.clientWidth,h=o.clientHeight,c=70,l=s,a=h,u=Math.min(l,a)/2,w=d3.scale.ordinal().range(["#a79773","#dab45f","#ffdf96"]),f=d3.select("#TfsChart").append("svg:svg").data([n]).attr("width",s).attr("height",h).append("svg:g").attr("transform","translate("+(u*1+(Math.max(l,a)-u)/4)+","+u*1+")"),v=f.append("text").attr("dy",".35em").style("text-anchor","middle").attr("class","textTop").text("TOTAL").attr("y",-10),y=f.append("text").attr("dy",".35em").style("text-anchor","middle").attr("class","textBottom").text(e).attr("y",10),p=d3.svg.arc().innerRadius(c+5).outerRadius(u-10),b=d3.svg.arc().innerRadius(c+10).outerRadius(u-5),k=d3.layout.pie().value(function(n){return n[r]}),d=f.selectAll("g.slice").data(k).enter().append("svg:g").attr("class","slice").on("mouseover",function(){d3.select(this).select("path").transition().duration(200).attr("d",b);v.text(d3.select(this).datum().data.Name).attr("y",-10);y.text(d3.select(this).datum().data.Count).attr("y",10)}).on("mouseout",function(){d3.select(this).select("path").transition().duration(100).attr("d",p);v.text("TOTAL").attr("y",-10);y.text(e)});d.append("svg:path").attr("fill",function(n,t){return w(t)}).attr("d",p)}};this.drawErDiagram=function(r){function st(){function s(o,s,c){d3.select("#"+r+" .context-menu").remove();h();d3.select("#"+r+" svg").append("g").attr("class","context-menu").selectAll("tmp").data(e).enter().append("g").attr("class","menu-entry").style({cursor:"pointer"}).on("mouseover",function(){disableUserInterractions(500);d3.select(this).select("rect").style(f.rect.mouseover)}).on("mouseout",function(){disableUserInterractions(500);d3.select(this).select("rect").style(f.rect.mouseout)}).on("click",function(){$.connection.hubMain.server.navigateToFile(c.id,"").done(function(t){n.openFile(t,!1)})});d3.selectAll("#"+r+" svg .menu-entry").append("rect").attr("x",o).attr("y",function(n,t){return s+t*i}).attr("width",u).attr("height",i).style(f.rect.mouseout);d3.selectAll("#"+r+" svg .menu-entry").append("text").text(function(n){return n}).attr("x",o).attr("y",function(n,t){return s+t*i}).attr("dy",i-t/2).attr("dx",t).style(f.text);d3.select("body").on("click",function(){d3.select("[wrapper-erdiagram] .context-menu").remove()})}function h(){if(o){d3.select("#"+r+" svg").selectAll("tmp").data(e).enter().append("text").text(function(n){return n}).style(f.text).attr("x",-1e3).attr("y",-1e3).attr("class","tmp");var n=d3.selectAll("#"+r+" .tmp")[0].map(function(n){return n.getBBox()});u=d3.max(n.map(function(n){return n.width}));t=t*u;u=u+2*t;i=d3.max(n.map(function(n){return n.height+t/2}));d3.selectAll("#"+r+" .tmp").remove();o=!1}}var i,u,t=.1,e=[],o=!1,f={rect:{mouseout:{fill:"rgb(244,244,244)",stroke:"white","stroke-width":"1px"},mouseover:{fill:"rgb(200,200,200)"}},text:{fill:"steelblue","font-size":"13"}};return s.items=function(){if(!arguments.length)return e;for(p in arguments)e.push(arguments[p]);return o=!0,s},s}function ft(){function ht(n){n.x=Math.max(0,Math.min(nt-n.width,d3.event.x));n.y=Math.max(0,Math.min(d-n.height,d3.event.y));d3.select(this).attr("transform","translate("+n.x+","+n.y+")");e.relayout();s.selectAll(".node").selectAll("rect").attr("height",function(n){return n.height});i.attr("d",b)}function rt(n){n.children.forEach(function(n){n.state="contained";n.parent=this;n._parent=null;rt(n)},n)}function ct(n){n.state="expanded";n.children.forEach(function(n){n.state="collapsed";n._parent=this;n.parent=null;rt(n)},n)}function lt(n){n.state="collapsed";rt(n)}function ot(){i.style("stroke",function(n){return n.type=="onetoone"?c:l}).style("marker-end",function(n){return n.type=="onetoone"?"url(#"+r+"arrowHeadOneToOne)":"url(#"+r+"arrowHeadOneToMany)"}).transition().duration(f).style("opacity",u.LINK_DEFAULT);t.selectAll("rect").style("fill",function(n){return n.color=y(n.type.replace(/ .*/,"")),n.color}).style("stroke","white").style("stroke-WIDTH","4").style("fill-opacity",u.NODE_DEFAULT);t.filter(function(n){return n.state==="collapsed"}).transition().duration(f).style("opacity",u.NODE_DEFAULT)}function st(n){disableUserInterractions(2*f);hideTooltip();n.state==="collapsed"?ct(n):lt(n);e.relayout();ft();i.attr("d",b);ot()}function at(){i.filter(function(n){return n.type==="onetomany"}).style("marker-end",function(){return"url(#"+r+"arrowHeadInflow)"}).style("stroke",l).style("opacity",u.LINK_DEFAULT);i.filter(function(n){return n.type==="onetoone"}).style("marker-end",function(){return"url(#"+r+"arrowHeadOutlow)"}).style("stroke",c).style("opacity",u.LINK_DEFAULT)}function vt(n){i.filter(function(t){return t.source!==n&&t.target!==n}).style("marker-end",function(){return"url(#"+r+"arrowHead)"}).transition().duration(f).style("opacity",u.LINK_FADED);t.filter(function(t){return t.name===n.name?!1:!e.connected(t,n)}).transition().duration(f).style("opacity",u.NODE_FADED)}var i,g,t,p,v,it;t=s.select("#nodes").selectAll(".node").data(e.collapsedNodes(),function(n){return n.id});t.transition().duration(f).attr("transform",function(n){return"translate("+n.x+","+n.y+")"}).style("opacity",u.NODE_DEFAULT).select("rect").style("fill",function(n){return n.color=y(n.type.replace(/ .*/,"")),n.color}).style("stroke",function(n){return d3.rgb(y(n.type.replace(/ .*/,""))).darker(.1)}).style("stroke-WIDTH","1px").attr("height",function(n){return n.height}).attr("width",e.nodeWidth());t.exit().transition().duration(f).attr("transform",function(n){var t,i,r;return t=n.ancestors.filter(function(n){return n.state==="collapsed"})[0],i=t?t.x:n.x,r=t?t.y:n.y,"translate("+i+","+r+")"}).remove();p=t.enter().append("g").attr("class","node");p.attr("transform",function(n){var t=n._parent?n._parent.x:n.x,i=n._parent?n._parent.y:n.y;return"translate("+t+","+i+")"}).style("opacity",1e-6).transition().duration(f).style("opacity",u.NODE_DEFAULT).attr("transform",function(n){return"translate("+n.x+","+n.y+")"});p.append("text").attr("class","node-name");p.append("rect");p.selectAll(".attributes").data(function(n){return n.attributes}).enter().append("text").attr("x",6).attr("y",function(n,t){return t*20+15}).attr("dy",".35em").text(function(n){return n}).attr("class","attributes");p.select("rect").style("fill",function(n){return n.color=y(n.type.replace(/ .*/,"")),n.color}).style("stroke","white").style("stroke-WIDTH","4").attr("stroke-linecap","round").attr("height",function(n){return n.height}).attr("width",function(n){var t=et(n);return t>160&&(t=t+15,n.width=t),t}).on("contextmenu",function(n){d3.event.preventDefault();disableUserInterractions(500);ut(n.x+d3.mouse(this)[0]+35,n.y+d3.mouse(this)[1]+35,n)});t.on("mouseenter",function(t){h||n.currentopenfile.file.FileName!=r||(ot(),at(t),vt(t),d3.select(this).select("rect").style("fill",function(n){return n.color=c,n.color}).style("stroke","white").style("stroke-WIDTH","4").style("fill-opacity",u.LINK_DEFAULT),w.style("left",t.x+o.LEFT+"px").style("top",t.y+t.height+o.TOP+15+"px").transition().duration(f).style("opacity",1).select(".value").text(function(){var n=t.children.length?"\n(Double click to expand)":"";return t.name}))});t.on("mouseleave",function(){h||n.currentopenfile.file.FileName!=r||(hideTooltip(),ot())});t.filter(function(n){return n.children.length}).on("dblclick",st);t.call(d3.behavior.drag().origin(function(n){return n}).on("dragstart",function(){d3.select("#"+r+" .context-menu").remove();this.parentNode.appendChild(this)}).on("drag",ht));t.filter(function(){return!0}).select("text.node-name").attr("x",-6).attr("y",function(n){return n.height/2}).attr("dy",".35em").attr("text-anchor","end").attr("transform",null).text(function(n){return n.name}).filter(function(n){return n.x<nt/2}).attr("x",function(n){var t=et(n);return t>160?(t=t+20,n.width=t-5):t=t+6,t}).attr("text-anchor","start");i=s.select("#links").selectAll("path.link").data(e.visibleLinks(),function(n){return n.id});i.transition().duration(f).attr("d",b).style("opacity",u.LINK_DEFAULT);i.exit().remove();g=i.enter().append("path").attr("class","link").style("fill","none");g.on("mouseenter",function(n){h||(showTooltip().select(".value").text(function(){return n.source.name+" → "+n.target.name+"\n"+n.type}),d3.select(this).style("stroke",function(n){return n.type=="onetoone"?c:l}).transition().duration(f/2).style("opacity",u.LINK_HIGHLIGHT))});g.on("mouseleave",function(){h||(hideTooltip(),d3.select(this).style("stroke",function(n){return n.type=="onetoone"?c:l}).transition().duration(f/2).style("opacity",u.LINK_DEFAULT))});g.sort(function(n,t){return t.thickness-n.thickness}).classed("leftToRight",function(n){return n.direction>0}).classed("rightToLeft",function(n){return n.direction<0}).style("marker-end",function(n){return n.type=="onetoone"?"url(#"+r+"arrowHeadOneToOne)":"url(#"+r+"arrowHeadOneToMany)"}).style("stroke",function(n){return n.type=="onetoone"?c:l}).style("opacity",0).transition().delay(f).duration(f).attr("d",b).style("stroke-WIDTH",function(n){return Math.max(1,n.thickness)}).style("opacity",u.LINK_DEFAULT);v=s.select("#collapsers").selectAll(".collapser").data(e.expandedNodes(),function(n){return n.id});it=v.enter().append("g").attr("class","collapser");it.append("circle").attr("r",a.RADIUS).style("fill",function(n){return n.color=y(n.type.replace(/ .*/,"")),n.color});it.style("opacity",u.NODE_DEFAULT).attr("transform",function(n){return"translate("+(n.x+n.width/2)+","+(n.y+a.RADIUS)+")"});it.on("dblclick",st);v.select("circle").attr("r",a.RADIUS);v.transition().delay(f).duration(f).attr("transform",function(n,t){return"translate("+(a.RADIUS+t*2*(a.RADIUS+a.SPACING))+","+(-a.RADIUS-k)+")"});v.on("mouseenter",function(n){if(!h){showTooltip().select(".value").text(function(){return n.name+"\n(Double click to collapse)"});var i=tt(n.type.replace(/ .*/,""));d3.select(this).style("opacity",u.NODE_HIGHLIGHT).select("circle").style("fill",i);t.filter(function(t){return t.ancestors.indexOf(n)>=0}).style("opacity",u.NODE_HIGHLIGHT).select("rect").style("fill",i)}});v.on("mouseleave",function(n){h||(hideTooltip(),d3.select(this).style("opacity",u.NODE_DEFAULT).select("circle").style("fill",function(n){return n.color}),t.filter(function(t){return t.ancestors.indexOf(n)>=0}).style("opacity",u.NODE_DEFAULT).select("rect").style("fill",function(n){return n.color}))});v.exit().remove()}function et(n){for(var i=e.nodeWidth(),t=0;t<n.attributes.length;t++)n.attributes[t].length*6>i&&(i=n.attributes[t].length*6);return i}for(var ot,ut,s,w,e,b,v,y,tt,h,u={NODE_DEFAULT:.9,NODE_FADED:.1,NODE_HIGHLIGHT:.8,LINK_DEFAULT:.6,LINK_FADED:.05,LINK_HIGHLIGHT:.9},it=["Entity",],c="#2E86D1",l="#D63028",rt=160,a={RADIUS:rt/2,SPACING:2},k=50,o={TOP:k,RIGHT:k,BOTTOM:k,LEFT:k},f=400,d=700-o.TOP-o.BOTTOM,nt=1400-o.LEFT-o.RIGHT,g=0,p=0;p<t.length;p++)g=t[p].attributes.length>0?g+t[p].attributes.length*25:g+25;g>d&&(d=g);ot=function(n){var t=d3.format(",.0f");return"£"+t(n)};ut=st().items("Navigate to Entity");formatFlow=function(n){var t=d3.format(",.0f");return"£"+t(Math.abs(n))+(n<0?" CR":" DR")};disableUserInterractions=function(n){h=!0;setTimeout(function(){h=!1},n)};hideTooltip=function(){return w.transition().duration(f).style("opacity",0)};showTooltip=function(){return w.style("left",d3.event.pageX+"px").style("top",d3.event.pageY+15+"px").transition().duration(f).style("opacity",1)};y=d3.scale.ordinal().domain(it).range(["#77b3d4"]);tt=d3.scale.ordinal().domain(it).range(["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494"]);s=d3.select("#"+r+" [wrapper-erdiagram]").append("svg").attr("width",nt+o.LEFT+o.RIGHT).attr("height",d+o.TOP+o.BOTTOM).append("g").attr("transform","translate("+o.LEFT+","+o.TOP+")");s.append("g").attr("id","links");s.append("g").attr("id","nodes");s.append("g").attr("id","collapsers");w=d3.select("#"+r+" [wrapper-erdiagram]").append("div").attr("id","tooltip");w.style("opacity",0).append("p").attr("class","value");e=d3.biHiSankey();e.nodeWidth(rt).nodeSpacing(1).linkSpacing(4).arrowheadScaleFactor(.5).size([nt,d]);b=e.link().curvature(.45);v=s.append("defs");v.append("marker").style("fill","#FFFFFF").attr("id",r+"arrowHead").attr("viewBox","0 0 10 10").attr("refX","5").attr("refY","5").attr("markerUnits","strokeWidth").attr("markerWidth","3").attr("markerHeight","3").attr("orient","auto").append("path").attr("d","M 0 0 L 1 0 L 6 5 L 1 10 L 0 10 z");v.append("marker").style("fill",c).attr("id",r+"arrowHeadOneToOne").attr("viewBox","0 0 10 10").attr("refX","5").attr("refY","5").attr("markerUnits","strokeWidth").attr("markerWidth","3").attr("markerHeight","3").attr("orient","auto").append("path").attr("d","M 0 0 L 1 0 L 6 5 L 1 10 L 0 10 z");v.append("marker").style("fill",l).attr("id",r+"arrowHeadOneToMany").attr("viewBox","0 0 10 10").attr("refX","5").attr("refY","5").attr("markerUnits","strokeWidth").attr("markerWidth","3").attr("markerHeight","3").attr("orient","auto").append("path").attr("d","M 0 0 L 1 0 L 6 5 L 1 10 L 0 10 z");v.append("marker").style("fill",l).attr("id",r+"arrowHeadInflow").attr("viewBox","0 0 10 10").attr("refX","5").attr("refY","5").attr("markerUnits","strokeWidth").attr("markerWidth","3").attr("markerHeight","3").attr("orient","auto").append("path").attr("d","M 0 0 L 1 0 L 6 5 L 1 10 L 0 10 z");v.append("marker").style("fill",c).attr("id",r+"arrowHeadOutlow").attr("viewBox","0 0 10 10").attr("refX","5").attr("refY","5").attr("markerUnits","strokeWidth").attr("markerWidth","3").attr("markerHeight","3").attr("orient","auto").append("path").attr("d","M 0 0 L 1 0 L 6 5 L 1 10 L 0 10 z");e.nodes(t).links(i).initializeNodes(function(n){n.state=n.parent?"contained":"collapsed"}).layout(32);disableUserInterractions(2*f);ft()};this.setData=function(n,r){t=n;i=r}}]);app.factory("$entityValidationService",["$filter","$Errors","$ValidationService","CONSTANTS","$Entityintellisenseservice","$rootScope",function(n,t,i,r,u,f){var c={},e={validationErrorList:[],warningList:[],objEntity:null,blnShowCreateWithClass:!0,objInheritedRules:{},PartialFileData:[],codegrouplist:[],lstMessages:[],lstBusBaseMethods:[],PartialFileDataTypes:[],lstBusinessObjectForProperty:[],lstMethods:[]};c.validateFileData=function(i,r){var u,f;e.objEntity=i;e.objInheritedRules={};e.PartialFileData=[];e.codegrouplist=[];e.lstMessages=[];e.lstBusBaseMethods=[];e.PartialFileDataTypes=[];e.lstBusinessObjectForProperty=[];e.lstMethods=[];i.dictAttributes.CreateWithClass&&i.dictAttributes.CreateWithClass.toLowerCase()=="false"&&(e.blnShowCreateWithClass=!1);e.objEntity.errors={};t.validationListObj&&angular.isArray(t.validationListObj)&&(f=n("filter")(t.validationListObj,{FileName:i.dictAttributes.ID}),f.length==0&&t.validationListObj.push({FileName:i.dictAttributes.ID,errorList:[]}),u=n("filter")(t.validationListObj,{FileName:i.dictAttributes.ID})[0]);e.validationErrorList=u.errorList=[];e.warningList=u.warningList=[];gt(i,r)};var k=function(){var w=o(e.objEntity,"attributes"),f,s,h,c,y,p,u;angular.forEach(w.Elements,function(n){g(n,undefined,!0);nt(n,undefined,!0);tt(n)});f=o(e.objEntity,"queries");angular.forEach(f.Elements,function(t){if(i.validateID(t,e.validationErrorList,t.dictAttributes.ID),t.Elements.length>0){var u=n("filter")(t.Elements,{Name:"mappedcolumns"})[0];u&&u.Elements.length>0&&angular.forEach(u.Elements,function(n){if(n&&n.dictAttributes.hasOwnProperty("sfwEntityField")&&n.dictAttributes.sfwEntityField)i.checkValidListValueForMultilevel([],n,n.dictAttributes.sfwEntityField,e.objEntity.dictAttributes.ID,"sfwEntityField","sfwEntityField",r.VALIDATION.ENTITY_FIELD_INCORRECT,e.validationErrorList,!1,"")})}});it(!1);rt(!1);l(!1);s=o(e.objEntity,"methods");angular.forEach(s.Elements,function(n){i.validateID(n,e.validationErrorList,n.dictAttributes.ID)});e.objEntity.dictAttributes.sfwObjectID?(h=e.lstMethods&&i.getListByPropertyName(e.lstMethods,"ShortName"),a(h)):e.blnShowCreateWithClass&&a([]);c=o(e.objEntity,"harderror");angular.forEach(c.Elements,function(n){n.objRule&&(i.validateIsEmptyMessageId(n.objRule,e.validationErrorList,n.objRule.dictAttributes.sfwMessageId),i.validateIsEmptyMessageIdAndDescription(n.objRule,e.validationErrorList,n.objRule.dictAttributes.sfwMessageId,n.objRule.dictAttributes.sfwMessage))});y=o(e.objEntity,"softerror");angular.forEach(y.Elements,function(n){n.objRule&&(i.validateIsEmptyMessageId(n.objRule,e.validationErrorList,n.objRule.dictAttributes.sfwMessageId),i.validateIsEmptyMessageIdAndDescription(n.objRule,e.validationErrorList,n.objRule.dictAttributes.sfwMessageId,n.objRule.dictAttributes.sfwMessage))});p=o(e.objEntity,"delete");angular.forEach(p.Elements,function(n){var t;n.dictAttributes.hasOwnProperty("ID")&&n.dictAttributes.ID&&(t="Object,Collection,List",i.checkValidListValueForMultilevel([],n,n.dictAttributes.ID,e.objEntity.dictAttributes.ID,"ID","ID",r.VALIDATION.ENTITY_FIELD_INCORRECT,e.validationErrorList,!1,t));n.dictAttributes.hasOwnProperty("sfwMethodName")&&n.dictAttributes.sfwMethodName&&(t="Property,Collection,Object",i.checkValidListValueForXMLMethod([],n,n.dictAttributes.sfwMethodName,e.objEntity.dictAttributes.ID,"sfwMethodName","invalid_method_name",r.VALIDATION.INVALID_NAME,e.validationErrorList,t,null,!0))});e.codegrouplist.length>0&&(u=i.getListByPropertyName(e.codegrouplist,"CodeID"),ut(u));ft(!1);et();e.objEntity.dictAttributes.sfwParentEntity?e.objInheritedRules&&(l(!0),v(e.objInheritedRules.Elements)):(u=[],e.objEntity.dictAttributes.sfwParentEntity&&e.objInheritedRules&&e.objInheritedRules.Elements&&(u=e.objInheritedRules.Elements),v(u));ot();st();!0&&(ht(),ct(),lt());at();vt();console.dir(t)},o=function(n,t){for(var i=null,r=0;r<n.Elements.length;r++)if(n.Elements[r].Name==t){i=n.Elements[r];break}return i||(i=d(t,n)),i},ni=function(n,t,i){var r=o(n,t);return o(r,i)},d=function(n,t){var i={Name:n,Value:"",dictAttributes:{},Elements:[]};return t.Elements.push(i),i},g=function(n,t,r){n&&(r?i.validateID(n,e.validationErrorList,n.dictAttributes.ID):i.validateID(n,e.validationErrorList,t))},nt=function(n,t,r){n&&(r?n.dictAttributes.sfwType=="Property"&&i.validateDataType(n,e.validationErrorList,n.dictAttributes.sfwDataType):i.validateDataType(n,e.validationErrorList,t))},tt=function(n){n&&(n.dictAttributes.sfwType=="Collection"||n.dictAttributes.sfwType=="CDOCollection"||n.dictAttributes.sfwType=="Object"||n.dictAttributes.sfwType=="List")&&i.validateEntity(n,e.validationErrorList)},it=function(n){var t=w(),u=o(e.objEntity,"attributes");angular.forEach(u.Elements,function(u){u.dictAttributes.sfwType!=="Description"&&i.checkDuplicateId(u,t,e.validationErrorList,n,r.ENTITY.NODES,e.warningList,f.iblnShowEntityDuplicateIdAsWarning,!0)})},rt=function(n){var t=o(e.objEntity,"queries");angular.forEach(t.Elements,function(u){i.checkDuplicateId(u,t,e.validationErrorList,n,r.ENTITY.NODES)})},l=function(n){var u=null,f,t;e.objInheritedRules&&e.objInheritedRules.Elements&&(u=e.objInheritedRules);f=y(u);t=o(e.objEntity,"rules");t&&angular.forEach(t.Elements,function(t){t.Name=="rule"&&i.checkDuplicateId(t,f,e.validationErrorList,n,r.ENTITY.NODES)})},a=function(n){var t=o(e.objEntity,"objectmethods");angular.forEach(t.Elements,function(t){i.validateID(t,e.validationErrorList,t.dictAttributes.ID);i.checkValidListValue(n,t,t.dictAttributes.ID,"ID","inValid_id",r.VALIDATION.INVALID_FIELD,e.validationErrorList)})},ut=function(n){var t=o(e.objEntity,"attributes");angular.forEach(t.Elements,function(t){t.dictAttributes.hasOwnProperty("sfwCodeID")&&t.dictAttributes.sfwCodeID&&i.checkValidListValue(n,t,t.dictAttributes.sfwCodeID,"sfwCodeID","invalid_code_group",r.VALIDATION.CODE_GROUP_NOT_EXISTS,e.validationErrorList)})},ft=function(n){var t,u,f,s;t=p("xmlmethod");f=o(e.objEntity,"methods");angular.forEach(f.Elements,function(u){i.validateID(u,e.validationErrorList,u.dictAttributes.ID);i.checkDuplicateId(u,t,e.validationErrorList,n,r.ENTITY.METHOD_NODES)});e.blnShowCreateWithClass&&(u=p("objmethod"),s=o(e.objEntity,"objectmethods"),angular.forEach(s.Elements,function(t){i.checkDuplicateId(t,u,e.validationErrorList,n,r.ENTITY.METHOD_NODES)}))},et=function(){if(e.PartialFileData&&angular.isArray(e.PartialFileData))for(var n=0;n<e.PartialFileData.length;n++)yt(e.PartialFileData[n])},l=function(n){var u=null,f,t;e.objInheritedRules&&e.objInheritedRules.Elements&&(u=e.objInheritedRules);f=y(u);t=o(e.objEntity,"rules");t&&angular.forEach(t.Elements,function(t){t.Name=="rule"&&i.checkDuplicateId(t,f,e.validationErrorList,n,r.ENTITY.NODES)})},v=function(n){var t=[],f=o(e.objEntity,"rules"),r,u;t=t.concat(i.getListByPropertyName(f.Elements,"ID",!1));t=t.concat(i.getListByPropertyName(n,"ID",!1));r=o(e.objEntity,"initialload");s(r.Elements,t);u=o(e.objEntity,"checklist");s(u.Elements,t)},ot=function(){var n=["Object","CDOCollection","Collection","List","Property"],t=w(),r=o(e.objEntity,"attributes");angular.forEach(r.Elements,function(r){angular.isArray(n)&&n.indexOf(r.dictAttributes.sfwType)>-1&&(r&&r.warnings&&delete r.warnings.sfwValue,i.checkDuplicateValue(r,t,e.warningList,"sfwValue","sfwValue",!0,n))})},st=function(){var t=i.getListByPropertyName(e.lstMessages,"MessageID"),n=o(e.objEntity,"constraint");n&&n.Elements.length>0&&angular.forEach(n.Elements,function(n){n&&n.dictAttributes.sfwMaxValue&&n.dictAttributes.sfwMaxMessageId&&i.checkValidListValue(t,n,n.dictAttributes.sfwMaxMessageId,"sfwMaxMessageId","sfwMaxMessageId",r.VALIDATION.INVALID_MESSAGE_ID,e.validationErrorList,!1);n&&n.dictAttributes.sfwMinValue&&n.dictAttributes.sfwMinMessageId&&i.checkValidListValue(t,n,n.dictAttributes.sfwMinMessageId,"sfwMinMessageId","sfwMinMessageId",r.VALIDATION.INVALID_MESSAGE_ID,e.validationErrorList,!1)})},ht=function(){kt()},ct=function(){var n=o(e.objEntity,"methods");angular.forEach(n.Elements,function(n){for(var u,t=0;t<n.Elements.length;t++)n.Elements[t].Name=="item"&&(u="Column,Property,Collection,Object",i.checkValidListValueForXMLMethod(e.lstBusBaseMethods,n.Elements[t],n.Elements[t].dictAttributes.ID,e.objEntity.dictAttributes.ID,"ID","invalid_method_name",r.VALIDATION.INVALID_NAME,e.validationErrorList,u,null,!1))})},lt=function(){var n=o(e.objEntity,"rules"),t;n&&(t=o(e.objEntity,"harderror"),angular.forEach(n.Elements,function(n){if(n.Name=="rule"){var i=t.Elements.filter(function(t){if(t&&t.dictAttributes.ID==n.dictAttributes.ID)return t});i&&i.length&&dt(n)}}))},at=function(){e.objEntity.dictAttributes.sfwErrorTable&&!e.objEntity.dictAttributes.sfwParentKeyValue?i.checkValidListValue([],e.objEntity,e.objEntity.dictAttributes.sfwParentKeyValue,"sfwParentKeyValue","sfwParentKeyValue","Parent Key Value for Error Table cannot be empty.",e.validationErrorList,!0):e.objEntity.dictAttributes.sfwErrorTable&&e.objEntity.dictAttributes.sfwParentKeyValue?e.objEntity.errors&&e.objEntity.errors.sfwParentKeyValue&&(e.objEntity.errors.sfwParentKeyValue=undefined):!e.objEntity.dictAttributes.sfwErrorTable&&e.objEntity.errors&&(e.objEntity.errors.sfwParentKeyValue=undefined)},vt=function(){e.objEntity.dictAttributes.sfwErrorTable&&!e.objEntity.dictAttributes.sfwStatusColumn?i.checkValidListValue([],e.objEntity,e.objEntity.dictAttributes.sfwStatusColumn,"sfwStatusColumn","sfwStatusColumn","Status Column for Error Table cannot be empty.",e.validationErrorList,!0):e.objEntity.dictAttributes.sfwErrorTable&&e.objEntity.dictAttributes.sfwStatusColumn?e.objEntity.dictAttributes.errors&&e.objEntity.dictAttributes.errors.sfwStatusColumn&&(e.objEntity.dictAttributes.errors.sfwStatusColumn=undefined):!e.objEntity.dictAttributes.sfwErrorTable&&e.objEntity.dictAttributes.errors&&(e.objEntity.dictAttributes.errors.sfwStatusColumn=undefined)},y=function(n){var t={Elements:[]},i=[],r=o(e.objEntity,"rules");return t.Elements=r.Elements&&r.Elements.slice(),e.objEntity.dictAttributes.sfwParentEntity&&n&&n.Elements&&(angular.forEach(n.Elements,function(n){if(n){var t={};t=angular.copy(n,t);t.isParent=!0;i.push(t)}}),t.Elements=t.Elements.concat(i)),t},p=function(n){var t={Elements:[]},r=[],f=!0,s=!0,h,c,i;return n=="xmlmethod"?(h=o(e.objEntity,"methods"),t.Elements=h.Elements.slice(),s=!1):(c=o(e.objEntity,"objectmethods"),t.Elements=c.Elements.slice(),f=!1),e.objEntity.dictAttributes.sfwParentEntity&&(i=u.GetIntellisenseData(e.objEntity.dictAttributes.sfwParentEntity,"","",!0,!1,s,!1,!1,f),i&&i.length>0&&(r=b(i),t.Elements=t.Elements.concat(r))),t},yt=function(n){pt(n);wt(n);bt(n)},pt=function(n){n.DataTypeError="";n.DataType&&n.DataType.trim().length>0?e.PartialFileDataTypes.indexOf(n.DataType)==-1&&(n.DataTypeError="Invalid Data Type."):n.DataTypeError="Enter Data Type.";h(n)},wt=function(n){n.ClassNameError="";n.DataType&&(n.DataType.toLowerCase()=="object"||n.DataType.toLowerCase()=="collection"||n.DataType.toLowerCase()=="cdocollection"||n.DataType.toLowerCase()=="list")&&(n.Class&&n.Class.trim().length>0?e.lstBusinessObjectForProperty&&!e.lstBusinessObjectForProperty.some(function(t){return t.ID==n.Class})&&(n.ClassNameError="Invalid Class Name."):n.ClassNameError="Enter Class Name.");h(n)},bt=function(n){n.PropertyNameError="";n.PropertyName&&n.PropertyName.trim().length>0?isValidIdentifier(n.PropertyID)?e.PartialFileData.filter(function(t){return t.PropertyID==n.PropertyID}).length>1&&(n.PropertyNameError="Duplicate Property ID."):n.PropertyNameError="Invalid Property Name.":n.PropertyNameError="Enter Property Name.";h(n)},s=function(n,t){angular.forEach(n,function(n){i.checkValidListValue(t,n,n.dictAttributes.ID,"ID","invalid_rule",n.dictAttributes.ID+" - "+r.VALIDATION.INVALID_RULE,e.validationErrorList);angular.isArray(n.Children)&&n.Children.length>0&&s(n.Children,t)})},w=function(){var n={Elements:[]},i=o(e.objEntity,"attributes"),t;return n.Elements=i.Elements&&i.Elements.slice(),e.objEntity.dictAttributes.sfwParentEntity&&(t=u.GetIntellisenseData(e.objEntity.dictAttributes.sfwParentEntity,"","",!0,!0,!1,!1,!1,!1),t&&t.length>0&&(n.Elements=n.Elements.concat(b(t)))),n},kt=function(){$.connection.hubEntityModel.server.validateExpressions(e.objEntity.dictAttributes.ID,!0).done(function(n){var t=o(e.objEntity,"attributes");angular.forEach(n,function(n,i){var r=t.Elements.filter(function(n){if(n.dictAttributes.sfwType=="Expression")return n.dictAttributes.ID==i});r&&r.length>0&&(r[0].Error=n)})});$.connection.hubEntityModel.server.validateExpressions(e.objEntity.dictAttributes.ID,!1).done(function(n){var t=o(e.objEntity,"rules");angular.forEach(n,function(n,i){var r=t.Elements.filter(function(n){return n.dictAttributes.ID==i});r&&r.length>0&&(r[0].Error=n)})})},dt=function(n){if(n){var t=i.getListByPropertyName(e.lstMessages,"MessageID");t.unshift("0");i.checkValidListValue(t,n,n.dictAttributes.sfwMessageId,"sfwMessageId","sfwMessageId",r.VALIDATION.MESSAGE_ID_EMPTY,e.validationErrorList,!0);n.dictAttributes.sfwMessage&&(delete n.errors.sfwMessageId,n&&n.errors&&!i.isEmptyObj(n.errors)&&i.removeObjInToArray(e.validationErrorList,n))}},b=function(n){var t=[];return angular.forEach(n,function(n){if(n&&n.ID){var i={dictAttributes:{},Elements:[]};i.dictAttributes.ID=n.ID;i.Name=n.Type;i.isParent=!0;n.hasOwnProperty("Value")&&n.Value&&(i.dictAttributes.sfwValue=n.Value);n.hasOwnProperty("Type")&&n.Type&&(i.dictAttributes.sfwType=n.Type);t.push(i)}}),t},h=function(n){n.IsValid=!0;n.DataTypeError&&n.DataTypeError.trim().length>0&&(n.IsValid=!1);n.ClassNameError&&n.ClassNameError.trim().length>0&&(n.IsValid=!1);n.PropertyNameError&&n.PropertyNameError.trim().length>0&&(n.IsValid=!1)},gt=function(n,t){hubMain.server.getEntityValidationData(e.objEntity.dictAttributes.ID,e.objEntity.dictAttributes.sfwParentEntity).done(function(n){n&&(e.codegrouplist=n.codegroup,e.objInheritedRules=n.inheritedRule,e.lstMessages=n.messages,e.lstBusinessObjectForProperty=n.businessObjectProperty);$.connection.hubEntityModel.server.getObjectDataForValidation(e.objEntity.dictAttributes.sfwObjectID).done(function(n){e.lstBusBaseMethods=n.busBaseMethods;e.lstMethods=n.objectTree?n.objectTree.lstMethods:[];e.PartialFileData=n.partialFileData?n.partialFileData[0]:{};e.PartialFileDataTypes=n.partialFileData?n.partialFileData[1]:[];k();t&&t.validateFile&&t.$evalAsync(function(){t.validateFile("Completed")})}).fail(function(){t&&t.validateFile&&t.$evalAsync(function(){t.validateFile("Failed")})})}).fail(function(){t&&t.validateFile&&t.$evalAsync(function(){t.validateFile("Failed")})})};return c}]);app.factory("$FormValidationService",["CONSTANTS","$timeout","$rootScope","$EntityIntellisenseFactory","$Entityintellisenseservice","$Errors","$filter","$GetEntityFieldObjectService","$ValidationService","$GetGridEntity",function(n,t,r,u,f,e,o,s,h,c){var g={},l={FormModel:{},SfxMainTable:{},validationErrorList:[],iswizard:!1,isLookup:!1,IsPrototype:!1,lstEntity:[],parameterList:[],gridQueryResult:[],lstQueriesName:[],validationData:{},objEntityExtraData:{},resourceList:[],queryIDList:[],lstMessages:[]},ft=function(n,t){n&&(n.dictAttributes.hasOwnProperty("sfwEntity")&&h.validateEntity(n,undefined),n.dictAttributes.sfwType.toLowerCase()=="lookup"?n.dictAttributes.ID.toLowerCase().startsWith("wfp")?l.IsPrototype=!0:l.isLookup=!0:n.dictAttributes.sfwType.toLowerCase()=="wizard"&&(l.iswizard=!0));l.isLookup&&pt();let i=!0;(l.validationData.CodeGroup||l.validationData.Resources||l.validationData.ActiveForms||l.validationData.RemoteObject)&&(i=!1);i&&$.connection.hubForm.server.getGlobleParameters().done(function(n){n&&et(n)});n.dictAttributes.sfwEntity&&n.errors&&!n.errors.invalid_entity?(l.lstEntity.push(n.dictAttributes.sfwEntity),l.lstQueriesName=[],nt(n,n.dictAttributes.sfwEntity,n),angular.isArray(l.lstQueriesName)&&l.lstQueriesName.length>0?$.connection.hubForm.server.getQueriesResult(l.lstQueriesName,"dummy").done(function(r){r&&(l.gridQueryResult=r,i?$.connection.hubMain.server.getFormValidationData().done(function(i){l.validationData=i;l.lstMessages=i.messages;b(n,t)}).fail(function(){t&&t.validateFile&&t.$evalAsync(function(){t.validateFile("Failed")})}):b(n,t))}).fail(function(){t&&t.validateFile&&t.$evalAsync(function(){t.validateFile("Failed")})}):i?$.connection.hubMain.server.getFormValidationData().done(function(i){l.validationData=i;l.lstMessages=i.messages;b(n,t)}).fail(function(){t&&t.validateFile&&t.$evalAsync(function(){t.validateFile("Failed")})}):b(n,t)):t&&t.validateFile&&t.$evalAsync(function(){t.validateFile("Completed")})},b=function(t,i){var u,r;l.resourceList=h.getListByPropertyName(l.validationData.Resources,"ResourceID",!1);l.lstEntity.length>0&&l.validationData.hasOwnProperty(t.dictAttributes.sfwEntity)&&(st(l.validationData[t.dictAttributes.sfwEntity]),l.objEntityExtraData.lstHardErrors=p(l.validationData[t.dictAttributes.sfwEntity],!1,t.dictAttributes.sfwHardErrorGroup));t.dictAttributes.hasOwnProperty("sfwResource")&&t.dictAttributes.sfwResource&&h.checkValidListValue(l.resourceList,t,t.dictAttributes.sfwResource,"sfwResource","invalid_resource",n.VALIDATION.RESOURCE_NOT_EXISTS,l.validationErrorList);u=h.getListByPropertyName(l.lstMessages,"MessageID",!1);t.dictAttributes.hasOwnProperty("sfwNewMessageID")&&t.dictAttributes.sfwNewMessageID&&h.checkValidListValue(u,t,t.dictAttributes.sfwNewMessageID,"sfwNewMessageID","sfwNewMessageID",n.VALIDATION.INVALID_MESSAGE_ID,l.validationErrorList);t.dictAttributes.hasOwnProperty("sfwOpenMessageID")&&t.dictAttributes.sfwOpenMessageID&&h.checkValidListValue(u,t,t.dictAttributes.sfwOpenMessageID,"sfwOpenMessageID","sfwOpenMessageID",n.VALIDATION.INVALID_MESSAGE_ID,l.validationErrorList);t.dictAttributes.hasOwnProperty("sfwDefaultButtonID")&&t.dictAttributes.sfwDefaultButtonID&&(r=[],FindControlListByName(l.SfxMainTable,"sfwButton",r),r=h.getListByPropertyName(r,"ID",!1),h.checkValidListValue(r,t,t.dictAttributes.sfwDefaultButtonID,"sfwDefaultButtonID","sfwDefaultButtonID",n.VALIDATION.BUTTON_NOT_EXISTS,l.validationErrorList));y(l.SfxMainTable,t.dictAttributes.sfwEntity,l.objEntityExtraData);i&&i.validateFile&&i.$evalAsync(function(){i.validateFile("Completed")})};g.validateFileData=function(n,t){var i,r;return e.validationListObj&&angular.isArray(e.validationListObj)&&(r=o("filter")(e.validationListObj,{FileName:n.dictAttributes.ID}),r.length==0&&e.validationListObj.push({FileName:n.dictAttributes.ID,errorList:[]}),i=o("filter")(e.validationListObj,{FileName:n.dictAttributes.ID})[0]),l.FormModel=n,n.errors={},yt(),l.validationErrorList=i.errorList=[],l.lstEntity=[],l.parameterList=[],l.gridQueryResult=[],l.objEntityExtraData={},l.resourceList=[],l.SfxMainTable&&(it(l.SfxMainTable),ft(n,t)),l.validationErrorList};var et=function(n){angular.forEach(n.Elements,function(n){if(n&&n.dictAttributes.ID){var t="~"+n.dictAttributes.ID;l.parameterList.push(t)}})},nt=function(t,i,r){angular.forEach(t.Elements,function(t){var u,f,e,o;n.FORM.COLLECTION_TYPE_NODES.indexOf(t.Name)>-1&&(u=null,t.Name=="sfwGridView"&&t.dictAttributes.sfwBoundToQuery&&t.dictAttributes.sfwBoundToQuery.toLowerCase()=="true"&&t.dictAttributes.sfwBaseQuery&&l.lstQueriesName.push(t.dictAttributes.sfwBaseQuery),t.Name=="sfwGridView"&&t.dictAttributes.sfwParentGrid?(f=FindControlByID(l.SfxMainTable,t.dictAttributes.sfwParentGrid),f&&f.dictAttributes.sfwEntityField&&(e=s.GetEntityFieldObjectFromEntityField(r.dictAttributes.sfwEntity,f.dictAttributes.sfwEntityField),e&&(o=s.GetEntityFieldObjectFromEntityField(e.Entity,t.dictAttributes.sfwEntityField),o&&(u=o.Entity)))):u=w(t.dictAttributes.sfwEntityField,i),u&&l.lstEntity.indexOf(u)<=-1&&l.lstEntity.push(u));t&&t.dictAttributes.ID&&l.parameterList.push(t.dictAttributes.ID);t.Elements&&t.Elements.length>0&&nt(t,i,r)})},ot=function(n){angular.forEach(n.Elements,function(n){if(n.dictAttributes.hasOwnProperty("sfwDataField")&&n.dictAttributes.sfwDataField)var t=u.getEntityIntellisense(),i=PopulateColumnList(n.dictAttributes.sfwQueryID,l.FormModel,t,$scope.lstLoadedEntityColumnsTree);n.Elements&&n.Elements.length>0&&ot(n)})},st=function(n){l.objEntityExtraData.lstRules=PopulateEntityRules(n,l.iswizard,l.FormModel.dictAttributes.sfwInitialLoadGroup)},y=function(t,i,r,f,e){angular.forEach(t.Elements,function(o){var b,gt,nt,st,ni,k,ft,s,g,yt,it,wt,bt,kt,dt,ot,pt,et;if(o.ParentVM=t,o.dictAttributes.hasOwnProperty("sfwVisibleRule")&&o.dictAttributes.sfwVisibleRule&&(b=r.lstRules,o.dictAttributes.sfwRelatedGrid&&(b=a(o)),o.dictAttributes.sfwParentGrid&&(b=a(o)),o.Name!="HeaderTemplate"&&o.Name!="FooterTemplate"&&FindParent(o,"sfwGridView")&&(b=a(o)),h.checkValidListValue(b,o,undefined,"sfwVisibleRule","invalid_visible_rule",n.VALIDATION.VISIBLE_RULE_NOT_EXISTS,l.validationErrorList)),o.dictAttributes.hasOwnProperty("sfwSelectColVisibleRule")&&o.dictAttributes.sfwSelectColVisibleRule&&(b=r.lstRules,o.dictAttributes.sfwRelatedGrid&&(b=a(o)),o.dictAttributes.sfwParentGrid&&(b=a(o)),o.Name!="HeaderTemplate"&&o.Name!="FooterTemplate"&&FindParent(o,"sfwGridView")&&(b=a(o)),h.checkValidListValue(b,o,undefined,"sfwSelectColVisibleRule","sfwSelectColVisibleRule",n.VALIDATION.VISIBLE_RULE_NOT_EXISTS,l.validationErrorList)),o.dictAttributes.hasOwnProperty("sfwEnableRule")&&o.dictAttributes.sfwEnableRule&&(b=r.lstRules,o.dictAttributes.sfwRelatedGrid&&(b=a(o)),h.checkValidListValue(b,o,undefined,"sfwEnableRule","invalid_enable_rule",n.VALIDATION.ENABLE_RULE_NOT_EXISTS,l.validationErrorList)),o.dictAttributes.hasOwnProperty("sfwReadOnlyRule")&&o.dictAttributes.sfwReadOnlyRule&&(b=r.lstRules,o.dictAttributes.sfwRelatedGrid&&(b=a(o)),h.checkValidListValue(b,o,undefined,"sfwReadOnlyRule","invalid_readonly_rule",n.VALIDATION.READONLY_RULE_NOT_EXISTS,l.validationErrorList)),o.dictAttributes.hasOwnProperty("sfwRulesGroup")&&o.dictAttributes.sfwRulesGroup&&ht(o,i),o.dictAttributes.hasOwnProperty("sfwEntityField")&&e?ct(o,e,t):o.dictAttributes.hasOwnProperty("sfwEntityField")&&o.Name!="parameter"&&o.dictAttributes.sfwEntityField&&(gt="",s=i,FindParent(o,"sfwGridView")&&(s=c.getEntityName(l.FormModel,o)),(o.dictAttributes.sfwEntityField=="InternalErrors"||o.dictAttributes.sfwEntityField=="ExternalErrors")&&(s="entError"),o.dictAttributes.sfwRelatedGrid&&(s=v(o,l.FormModel.dictAttributes.sfwEntity)),o.dictAttributes.sfwParentGrid&&(s=v(o,l.FormModel.dictAttributes.sfwEntity)),h.checkValidListValueForMultilevel([],o,o.dictAttributes.sfwEntityField,s,"sfwEntityField","sfwEntityField",n.VALIDATION.ENTITY_FIELD_INCORRECT,l.validationErrorList,!1,gt)),o.dictAttributes.hasOwnProperty("sfwRetrievalQuery")&&o.dictAttributes.sfwRetrievalQuery&&h.checkValidQuery(u.getEntityIntellisense(),o,o.dictAttributes.sfwRetrievalQuery,undefined,"sfwRetrievalQuery","sfwRetrievalQuery",n.VALIDATION.INVALID_QUERY,l.validationErrorList),o.dictAttributes.hasOwnProperty("sfwRetrievalMethod")&&o.dictAttributes.sfwRetrievalMethod&&(s=i,o.dictAttributes.sfwRelatedGrid&&(s=v(o,l.FormModel.dictAttributes.sfwEntity)),ft=d(s,!1,!0),h.checkValidListValue(ft,o,o.dictAttributes.sfwRetrievalMethod,"sfwRetrievalMethod","invalid_retrieval_method",n.VALIDATION.INVALID_METHOD,l.validationErrorList)),o.dictAttributes.hasOwnProperty("sfwAutoQuery")&&o.dictAttributes.sfwAutoQuery&&h.checkValidQuery(u.getEntityIntellisense(),o,o.dictAttributes.sfwAutoQuery,undefined,"sfwAutoQuery","sfwAutoQuery",n.VALIDATION.INVALID_QUERY,l.validationErrorList),o.dictAttributes.hasOwnProperty("sfwBaseQuery")&&o.dictAttributes.sfwBaseQuery&&h.checkValidQuery(u.getEntityIntellisense(),o,o.dictAttributes.sfwBaseQuery,undefined,"sfwBaseQuery","sfwBaseQuery",n.VALIDATION.INVALID_QUERY,l.validationErrorList),o.dictAttributes.hasOwnProperty("sfwResource")&&o.dictAttributes.sfwResource&&o.dictAttributes.sfwResource!=0&&h.checkValidListValue(l.resourceList,o,o.dictAttributes.sfwResource,"sfwResource","invalid_resource",n.VALIDATION.RESOURCE_NOT_EXISTS,l.validationErrorList),o.dictAttributes.hasOwnProperty("sfwValidationRules")&&o.dictAttributes.sfwValidationRules){for(nt=o;nt;){if(nt.Name=="sfwWizardStep")break;nt=nt.ParentVM}st=r.lstHardErrors;nt&&(yt=nt.dictAttributes.sfwRulesGroup,st=p(l.validationData[i],l.iswizard,yt));o.dictAttributes.sfwRelatedGrid&&(st=lt(o));h.checkMultipleValueWithList(st,o,o.dictAttributes.sfwValidationRules,";","sfwValidationRules","invalid_validation_rule",n.VALIDATION.VALIDATION_RULE_NOT_EXISTS,l.validationErrorList)}o.dictAttributes.hasOwnProperty("sfwActiveForm")&&o.dictAttributes.sfwActiveForm&&rt(o);o.dictAttributes.hasOwnProperty("Name")&&o.dictAttributes.Name&&o.Name=="udc"&&rt(o);o.dictAttributes.hasOwnProperty("sfwExpression")&&o.dictAttributes.sfwExpression&&(ni=u.getEntityIntellisense(),k=getEntityAttributeByType(ni,i,"Expression"),k=h.getListByPropertyName(k,"ID",!1),h.checkValidListValue(k,o,o.dictAttributes.sfwExpression,"sfwExpression","invalid_expression",n.VALIDATION.INVALID_EXPRESSION,l.validationErrorList));o.dictAttributes.hasOwnProperty("sfwMessageID")&&o.dictAttributes.sfwMessageID&&(k=h.getListByPropertyName(l.lstMessages,"MessageID",!1),h.checkValidListValue(k,o,o.dictAttributes.sfwMessageID,"sfwMessageID","sfwMessageID",n.VALIDATION.INVALID_MESSAGE_ID,l.validationErrorList));o.dictAttributes.hasOwnProperty("sfwMessageId")&&o.dictAttributes.sfwMessageId&&(k=h.getListByPropertyName(l.lstMessages,"MessageID",!1),h.checkValidListValue(k,o,o.dictAttributes.sfwMessageID,"sfwMessageId","sfwMessageId",n.VALIDATION.INVALID_MESSAGE_ID,l.validationErrorList));(o.Name=="sfwDropDownList"||o.Name=="sfwCascadingDropDownList"||o.Name=="sfwMultiSelectDropDownList"||o.Name=="sfwListPicker"||o.Name=="sfwListBox"||o.Name=="sfwRadioButtonList")&&o.dictAttributes.sfwLoadType=="CodeGroup"&&(k=h.getListByPropertyName(l.validationData.CodeGroup,"CodeID"),k.push("0"),at(o,k,i));o.dictAttributes.hasOwnProperty("sfwLoadSource")&&o.dictAttributes.sfwLoadSource&&(o.dictAttributes.sfwLoadType=="Query"?h.checkValidQuery(u.getEntityIntellisense(),o,o.dictAttributes.sfwLoadSource,undefined,"sfwLoadSource","sfwLoadSource",n.VALIDATION.INVALID_QUERY,l.validationErrorList):o.dictAttributes.sfwLoadType=="Method"?(s=i,o.dictAttributes.sfwRelatedGrid&&(s=v(o,l.FormModel.dictAttributes.sfwEntity)),ft=d(s,!0,!1),h.checkValidListValue(ft,o,o.dictAttributes.sfwLoadSource,"sfwLoadSource","invalid_method",n.VALIDATION.INVALID_METHOD,l.validationErrorList)):o.dictAttributes.sfwLoadType=="ServerMethod"&&tt(o));o.dictAttributes.hasOwnProperty("XValueMember")&&o.dictAttributes.XValueMember&&(h.checkValidListValueForMultilevel([],o,o.dictAttributes.XValueMember,i,"XValueMember","XValueMember",n.VALIDATION.INVALID_FIELD,l.validationErrorList,!1,""),ut(o,f));o.dictAttributes.hasOwnProperty("YValueMembers")&&o.dictAttributes.YValueMembers&&(h.checkValidListValueForMultilevel([],o,o.dictAttributes.YValueMembers,i,"YValueMembers","YValueMembers",n.VALIDATION.INVALID_FIELD,l.validationErrorList,!1,""),ut(o,f));o.dictAttributes.hasOwnProperty("sfwCodeTable")&&o.dictAttributes.sfwCodeTable&&h.checkValidQuery(u.getEntityIntellisense(),o,o.dictAttributes.sfwCodeTable,undefined,"sfwCodeTable","sfwCodeTable",n.VALIDATION.INVALID_CODE_TABLE,l.validationErrorList);o.dictAttributes.hasOwnProperty("sfwEntityField")&&o.dictAttributes.sfwEntityField&&o.dictAttributes.hasOwnProperty("sfwMethodName")&&o.dictAttributes.sfwMethodName=="btnOpen_Click"&&(k=vt(o,l.isLookup),h.checkValidListValue(k,o,o.dictAttributes.sfwEntityField,"sfwEntityField","sfwEntityField",n.VALIDATION.ENTITY_FIELD_INCORRECT,l.validationErrorList));l.isLookup&&!l.IsPrototype&&o.dictAttributes.hasOwnProperty("sfwQueryID")&&o.dictAttributes.sfwQueryID&&h.checkValidListValue(l.queryIDList,o,o.dictAttributes.sfwQueryID,"sfwQueryID","invalid_query_id",n.VALIDATION.INVALID_QUERY_ID,l.validationErrorList);o.dictAttributes.hasOwnProperty("sfwParameters")&&o.dictAttributes.sfwParameters&&validateParameters(o,o.dictAttributes.sfwParameters,"sfwParameters");o.dictAttributes.hasOwnProperty("sfwAutoParameters")&&o.dictAttributes.sfwAutoParameters&&validateParameters(o,o.dictAttributes.sfwAutoParameters,"sfwAutoParameters");o.dictAttributes.hasOwnProperty("sfwCascadingRetrievalParameters")&&o.dictAttributes.sfwCascadingRetrievalParameters&&validateParameters(o,o.dictAttributes.sfwCascadingRetrievalParameters,"sfwCascadingRetrievalParameters");o.dictAttributes.hasOwnProperty("sfwObjectMethod")&&o.dictAttributes.sfwObjectMethod&&(ft=d(i,!1,!1),h.checkValidListValue(ft,o,o.dictAttributes.sfwObjectMethod,"sfwObjectMethod","sfwObjectMethod",n.VALIDATION.INVALID_METHOD,l.validationErrorList),o&&o.errors&&o.errors.sfwObjectMethod&&tt(o,"sfwObjectMethod"));o.dictAttributes.hasOwnProperty("sfwEntityField")&&o.dictAttributes.sfwEntityField&&(o.Name=="sfwScheduler"||o.Name=="sfwCalendar")&&(s=w(o.dictAttributes.sfwEntityField,i),o.dictAttributes.hasOwnProperty("sfwEventId")&&o.dictAttributes.sfwEventId&&h.checkValidListValueForMultilevel([],o,o.dictAttributes.sfwEventId,s,"sfwEventId","sfwEventId",n.VALIDATION.INVALID_FIELD,l.validationErrorList,!1,""),o.dictAttributes.hasOwnProperty("sfwEventName")&&o.dictAttributes.sfwEventName&&h.checkValidListValueForMultilevel([],o,o.dictAttributes.sfwEventName,s,"sfwEventName","sfwEventName",n.VALIDATION.INVALID_FIELD,l.validationErrorList,!1,""),o.dictAttributes.hasOwnProperty("sfwEventStartDate")&&o.dictAttributes.sfwEventStartDate&&h.checkValidListValueForMultilevel([],o,o.dictAttributes.sfwEventStartDate,s,"sfwEventStartDate","sfwEventStartDate",n.VALIDATION.INVALID_FIELD,l.validationErrorList,!1,""),o.dictAttributes.hasOwnProperty("sfwEventEndDate")&&o.dictAttributes.sfwEventEndDate&&h.checkValidListValueForMultilevel([],o,o.dictAttributes.sfwEventEndDate,s,"sfwEventEndDate","sfwEventEndDate",n.VALIDATION.INVALID_FIELD,l.validationErrorList,!1,""),o.dictAttributes.hasOwnProperty("sfwEventCategory")&&o.dictAttributes.sfwEventCategory&&h.checkValidListValueForMultilevel([],o,o.dictAttributes.sfwEventCategory,s,"sfwEventCategory","sfwEventCategory",n.VALIDATION.INVALID_FIELD,l.validationErrorList,!1,""));o.Elements&&o.Elements.length>0&&(f&&f.errors&&f.errors.hasOwnProperty("series_errors")&&!h.isEmptyObj(f.errors.series_errors)&&delete f.errors.series_errors,g={},o.Name=="sfwWizardStep"?(yt=o.dictAttributes.sfwRulesGroup,g.lstHardErrors=p(l.validationData[i],l.iswizard,yt),g.lstRules=PopulateEntityRules(l.validationData[i],l.iswizard,null),y(o,i,g,f,e)):n.FORM.COLLECTION_TYPE_NODES.indexOf(o.Name)>-1?(wt="",o.dictAttributes.sfwEntityField&&(o.dictAttributes.sfwEntityField=="InternalErrors"||o.dictAttributes.sfwEntityField=="ExternalErrors")?it="entError":o.Name=="sfwGridView"&&o.dictAttributes.sfwBoundToQuery&&o.dictAttributes.sfwBoundToQuery.toLowerCase()=="true"?wt=o.dictAttributes.sfwBaseQuery:it=o.dictAttributes.sfwParentGrid&&o.dictAttributes.sfwEntityField?v(o,l.FormModel.dictAttributes.sfwEntity,!0):w(o.dictAttributes.sfwEntityField,i),bt={},o.Name=="sfwChart"&&(bt=o),it?(l.validationData&&l.validationData.hasOwnProperty(it)&&(g.lstHardErrors=p(l.validationData[it],l.iswizard,null),g.lstRules=PopulateEntityRules(l.validationData[it],l.iswizard,null)),y(o,it,g,bt,e)):y(o,i,r,f,wt)):o.Name=="sfwDialogPanel"?(kt=o.dictAttributes.ID,kt&&(ot=GetFieldFromFormObject(l.SfxMainTable,"sfwButton","sfwRelatedDialogPanel",kt),ot&&ot.length>0&&ot[0].dictAttributes.sfwRelatedControl&&(pt=GetFieldFromFormObject(l.SfxMainTable,"sfwGridView","ID",ot[0].dictAttributes.sfwRelatedControl),pt&&pt.length>0&&(dt=pt[0].dictAttributes.sfwEntityField))),dt&&(et=w(dt,i),l.validationData&&l.validationData.hasOwnProperty(et)&&(g.lstHardErrors=p(l.validationData[et],l.iswizard,null),g.lstRules=PopulateEntityRules(l.validationData[et],l.iswizard,null))),et?y(o,et,g,f,e):y(o,i,r,f,e)):y(o,i,r,f,e))})};validateParameters=function(n,t,i){var r,e,u,o,f;if(!angular.isArray(l.parameterList)||!(l.parameterList.length<=0))for(r="prop-",i=="sfwAutoParameters"?r="autoprop-":i=="sfwCascadingRetrievalParameters"&&(r="cprop-"),e=t.split(";"),u=0;u<e.length;u++)o=e[u].split("="),f=o[o.length-1],h.checkValidListValue(l.parameterList,n,f,i,r+f,"parameter value("+f+") does not exists",l.validationErrorList)};var ht=function(t,i){if(l.validationData&&l.validationData.hasOwnProperty(i)){var u=l.validationData[i],r=u&&u.lstGroupsList,f=[];angular.isArray(r)&&r.length>0&&(f=h.getListByPropertyName(r[0].Elements,"ID"));h.checkValidListValue(f,t,t.dictAttributes.sfwRulesGroup,"sfwRulesGroup","sfwRulesGroup",n.VALIDATION.INVALID_GROUP,l.validationErrorList)}},ct=function(t,i,r){if((t.Name==="sfwLabel"||t.Name=="parameter")&&r&&(r.Name=="HeaderTemplate"||r.Name=="FooterTemplate"||r.Name=="Parameters"))h.checkValidListValueForMultilevel([],t,t.dictAttributes.sfwEntityField,l.FormModel.dictAttributes.sfwEntity,"sfwEntityField","sfwEntityField",n.VALIDATION.ENTITY_FIELD_INCORRECT,l.validationErrorList,!1,"");else if(l.gridQueryResult&&l.gridQueryResult.hasOwnProperty(i)){var u=h.getListByPropertyName(l.gridQueryResult[i],"CodeID",!1);h.checkValidListValue(u,t,t.dictAttributes.sfwEntityField,"sfwEntityField","sfwEntityField",n.VALIDATION.ENTITY_FIELD_INCORRECT,l.validationErrorList)}},a=function(n){var i=[],t=null;return t=FindParent(n,"sfwGridView")?c.getEntityName(l.FormModel,n):v(n,l.FormModel.dictAttributes.sfwEntity),t&&(i=PopulateEntityRules(l.validationData[t],l.iswizard,null)),i},lt=function(n){var t=[],i=v(n,l.FormModel.dictAttributes.sfwEntity);return i&&(t=p(l.validationData[i],l.iswizard,null)),t},at=function(t,i,r){var f="",e;t.dictAttributes.sfwRelatedGrid&&(r=v(t,l.FormModel.dictAttributes.sfwEntity));IsCriteriaField(t)&&t.dictAttributes.sfwDataField?f="sfwDataField":t.dictAttributes.sfwEntityField&&(f="sfwEntityField");t.Name=="sfwCheckBoxList"&&(f="sfwCheckBoxField");t.dictAttributes.sfwLoadSource?h.checkValidListValue(i,t,t.dictAttributes.sfwLoadSource,"sfwLoadSource","invalid_code_group",n.VALIDATION.CODE_GROUP_NOT_EXISTS,l.validationErrorList):t.dictAttributes[f]&&t.errors&&!t.errors[f]&&(e=GetCodeID(r,t.dictAttributes[f],u.getEntityIntellisense()),e||h.checkValidListValue([],t,t.dictAttributes.sfwLoadSource,"sfwLoadSource","invalid_code_group",n.VALIDATION.CODE_GROUP_NOT_EXISTS,l.validationErrorList,!0))},tt=function(t,i){var r,u,f,e;i&&i.trim().length>0||(i="sfwLoadSource");r="srvCommon";u=[];l.FormModel&&l.FormModel.dictAttributes.sfwRemoteObject&&(r=l.FormModel.dictAttributes.sfwRemoteObject);l.validationData&&l.validationData.hasOwnProperty("RemoteObject")&&(u=l.validationData.RemoteObject);f=GetServerMethodObject(r,u);e=PopulateServerMethod([],t,f,!0);h.checkValidListValue(e,t,t.dictAttributes[i],i,i,n.VALIDATION.INVALID_METHOD,l.validationErrorList)},d=function(n,t,i){var r=f.GetIntellisenseData(n,"","",!0,!1,!0,!0,!1,!1),u=[];return r&&r.length>0&&(t?r=o("filter")(r,{ReturnType:"Collection"}):i&&(r=o("filter")(r,{ReturnType:"Object"})),r&&r.length>0&&(u=h.getListByPropertyName(r,"ID",!1))),u},w=function(n,t){var r="",i;return n&&(i=s.GetEntityFieldObjectFromEntityField(t,n),i&&(r=i.Entity)),r},it=function(t){angular.forEach(t.Elements,function(t){n.FORM.IGNORE_NODES.indexOf(t.Name)<=-1&&(t.Name=="sfwTable"&&l.FormModel.dictAttributes.sfwType.toLowerCase()=="lookup"?h.validateID(t,l.validationErrorList,t.dictAttributes.ID):t.Name!="sfwTable"&&h.validateID(t,l.validationErrorList,t.dictAttributes.ID),h.checkDuplicateId(t,l.FormModel,l.validationErrorList,!1,n.FORM.NODES));t.Elements&&t.Elements.length>0&&n.FORM.NODES.indexOf(t.Name)>-1&&it(t)})},rt=function(t){function o(n){n.FileType==e[r]&&f.push(n.FileID)}var u="sfwActiveForm",i="Lookup,Maintenance,Wizard,FormLinkLookup,FormLinkMaintenance,FormLinkWizard",f,e,r;if(t.dictAttributes.sfwMethodName=="btnCorrespondenceRows_Click"?i="Maintenance,FormLinkMaintenance":t.dictAttributes.sfwMethodName=="btnOpenLookup_Click"&&(i="Lookup,FormLinkLookup,Maintenance,FormLinkMaintenance"),(t.dictAttributes.sfwMethodName=="btnNewUpdate_Click"||t.dictAttributes.sfwMethodName=="btnPrototypeSearch_Click")&&(i="Maintenance,FormLinkMaintenance"),t.dictAttributes.sfwMethodName==="btnRetrieve_Click"&&(i="Lookup,FormLinkLookup"),(t.Name=="sfwOpenDetail"||t.Name=="sfwMultiCorrespondence")&&(i="Maintenance,FormLinkMaintenance"),t.Name=="sfwToolTipButton"&&(i="Tooltip,"),t.Name=="udc"&&(i="UserControl,",u="Name"),f=[],i.indexOf(",")>-1)for(e=i.split(","),r=0;r<e.length;r++)angular.forEach(l.validationData.ActiveForms,o);h.checkActiveForm(f,t,t.dictAttributes[u],u,"invalid_active_form",n.VALIDATION.INVALID_ACTIVE_FORM,l.validationErrorList)},ut=function(n,t){t&&t.errors&&!t.errors.hasOwnProperty("series_errors")&&(t.errors.series_errors={});for(var i in n.errors)t&&t.errors&&!t.errors.series_errors.hasOwnProperty(i)&&(t.errors.series_errors[i+"_"+n.dictAttributes.Name]=n.errors[i])},p=function(n,t,i){var u=[],r;return t?(lstHardErrorsTemp=GetBuisnessRules(n,"","",i,!0),angular.forEach(lstHardErrorsTemp,function(n){n!=undefined&&n!=""&&u.push(n)})):n&&n.lstHardErrorList&&(r=n.lstHardErrorList[0],r&&r.Elements.length>0&&angular.forEach(r.Elements,function(n){n!=undefined&&n.dictAttributes.ID!=""&&u.push(n.dictAttributes.ID)})),u},vt=function(n,t){var r=[],f,o,u,i,e;if(PopulateControlsForActiveForm(r,l.FormModel,n,t),f=[],o=FindParent(n,"sfwGridView"),(n.dictAttributes.sfwRelatedControl||o)&&r.length>0)for(u=0;u<r.length;u++)i=r[u],e="",e=i.indexOf("~")>-1?i.substring(0,i.indexOf("~")):i,f.push(e);return f},v=function(n,t,i){var r=t,o,u,e,f;return n.dictAttributes.sfwParentGrid&&n.dictAttributes.sfwEntityField?(o=FindControlByID(l.FormModel,n.dictAttributes.sfwParentGrid),u=s.GetEntityFieldObjectFromEntityField(l.FormModel.dictAttributes.sfwEntity,o.dictAttributes.sfwEntityField),u&&(r=u.Entity,i&&(e=s.GetEntityFieldObjectFromEntityField(u.Entity,n.dictAttributes.sfwEntityField),e&&(r=e.Entity)))):(f=FindControlByID(l.FormModel,n.dictAttributes.sfwRelatedGrid),f&&f.dictAttributes.sfwEntityField&&(r=w(f.dictAttributes.sfwEntityField,t))),r},yt=function(){function t(n){var u,t,i,e,f,r;if(n.ParentVM=l.SfxMainTable,n.Elements.length>0)if(l.FormModel.dictAttributes.sfwType=="Wizard"){for(k=0;k<n.Elements.length;k++)if(u=n.Elements[k],u.ParentVM=n,t=u.Elements.filter(function(n){return n.Name=="sfwWizard"}),t.length>0){if(t=t[0],t.ParentVM=u,i=t.Elements.filter(function(n){return n.Name=="WizardSteps"}),e=t.Elements.filter(function(n){return n.Name=="HeaderTemplate"}),i.length>0)for(i=i[0],f=0;f<i.Elements.length;f++)r=i.Elements[f],r.ParentVM=i,r.Name=="sfwWizardStep"&&(r.Elements[0].Name=="sfwTable"&&(r.TableVM=r.Elements[0]),r.isLoaded=!1);break}}else angular.forEach(n.Elements,function(t){t.ParentVM=n;var i=t.Elements.filter(function(n){return n.Name=="sfwPanel"||n.Name=="sfwDialogPanel"});if(i.length>0){for(i=i[0],i.ParentVM=t,i.IsMainPanel=!0,j=0;j<i.Elements.length;j++)if(i.Elements[j].Name=="sfwTable"){i.TableVM=i.Elements[j];break}i.isLoaded=!1}})}for(var n=0;n<l.FormModel.Elements.length;n++)if(l.FormModel.Elements[n].Name=="sfwTable"){l.SfxMainTable=l.FormModel.Elements[n];angular.forEach(l.SfxMainTable.Elements,t);break}},pt=function(){function u(n){n.dictAttributes.ID&&l.queryIDList.push(n.dictAttributes.ID)}var t=[],n=l.FormModel.Elements.filter(function(n){return n.Name=="initialload"}),r;if(n.length>0)for(i=0;i<n[0].Elements.length;i++)n[0].Elements[i]&&n[0].Elements[i].dictAttributes&&n[0].Elements[i].dictAttributes.ID&&t.push(n[0].Elements[i]);t.length>0&&(r=t[0]);l.queryIDList=[];angular.forEach(t,u)};return g}]);