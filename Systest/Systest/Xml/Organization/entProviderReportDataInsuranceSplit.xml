<?xml version="1.0" encoding="utf-8"?>
<entity ID="entProviderReportDataInsuranceSplit" sfwMainCDO="icdoProviderReportDataInsuranceSplit" sfwType="BusinessRule" sfwActive="True" sfwStatus="Review" sfwObjectID="busProviderReportDataInsuranceSplit" sfwTableName="sgt_provider_report_data_insurance_split" sfwView="False">
  <queries>
    <query ID="InsertSplitForInsrPlansByProvider" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="INSERT INTO SGT_PROVIDER_REPORT_DATA_INSURANCE_SPLIT&#xD;&#xA;(PROVIDER_REPORT_DATA_INSURANCE_COMP_ID, PERSON_ID, SSN, FIRST_NAME, LAST_NAME, PREMIUM_AMOUNT, FEE_AMOUNT, &#xD;&#xA;COVERAGE_CODE, CREATED_BY, CREATED_DATE, MODIFIED_BY, MODIFIED_DATE, UPDATE_SEQ)&#xD;&#xA;SELECT A.PROVIDER_REPORT_DATA_INSURANCE_COMP_ID, A.PERSON_ID, A.SSN, A.FIRST_NAME, A.LAST_NAME, A.PREMIUM_AMOUNT, A.FEE_AMOUNT, &#xD;&#xA;A.COVERAGE_CODE, 'PERSLink Batch'+' '+ convert(nvarchar,@batchscheduleid), GETDATE(), 'PERSLink Batch'+' '+ convert(nvarchar,@batchscheduleid), GETDATE(), 0&#xD;&#xA;FROM SGT_PROVIDER_REPORT_DATA_INSURANCE A&#xD;&#xA;LEFT OUTER JOIN SGT_PROVIDER_REPORT_DATA_INSURANCE_SPLIT B&#xD;&#xA;ON A.PROVIDER_REPORT_DATA_INSURANCE_COMP_ID = B.PROVIDER_REPORT_DATA_INSURANCE_COMP_ID&#xD;&#xA;WHERE A.PROVIDER_ORG_ID = @PROVIDERORGID&#xD;&#xA;AND A.EFFECTIVE_DATE &lt;= @EFFECTIVEDATE&#xD;&#xA;AND A.BATCH_REQUEST_ID IS NULL&#xD;&#xA;AND  B.PROVIDER_REPORT_DATA_INSURANCE_COMP_ID IS NULL">
      <parameters>
        <parameter ID="@PROVIDERORGID" sfwDataType="int" />
        <parameter ID="@EFFECTIVEDATE" sfwDataType="DateTime" />
        <parameter ID="@batchscheduleid" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="LoadSplitForHealthPlan" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT  A.PROVIDER_REPORT_DATA_INSURANCE_COMP_ID,A.PERSON_ID,A.SSN,A.FIRST_NAME,A.LAST_NAME,C.MEDICARE_CLAIM_NO, C.MEDICARE_PART_B_EFFECTIVE_DATE AS 'MEDICARE_EFFECTIVE_DATE',&#xD;&#xA;   0.00 AS PREMIUM_AMOUNT,0.00 AS FEE_AMOUNT,'' AS COVERAGE_CODE, '99991231' AS DOB, 0 AS CNT, 'MEMB' AS RELATIONSHIP_VALUE,&#xD;&#xA;   'PERSLink Batch'+' '+ convert(nvarchar,@batchscheduleid) AS CREATED_BY, GETDATE() AS CREATED_DATE, 'PERSLink Batch'+' '+ convert(nvarchar,@batchscheduleid) AS MODIFIED_BY, GETDATE() AS MODIFIED_DATE, 0 AS UPDATE_SEQ&#xD;&#xA;FROM  SGT_PROVIDER_REPORT_DATA_INSURANCE A&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT B&#xD;&#xA; ON  A.PERSON_ID = B.PERSON_ID AND A.PLAN_ID = B.PLAN_ID&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_GHDV C&#xD;&#xA; ON  C.PERSON_ACCOUNT_ID = B.PERSON_ACCOUNT_ID&#xD;&#xA;WHERE  A.PROVIDER_ORG_ID = @PROVIDERORGID&#xD;&#xA;AND   A.EFFECTIVE_DATE &lt;= @EFFECTIVEDATE&#xD;&#xA;AND   A.BATCH_REQUEST_ID IS NULL&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;UNION ALL&#xD;&#xA;&#xD;&#xA;SELECT  A.PROVIDER_REPORT_DATA_INSURANCE_COMP_ID,E.PERSON_ID,E.SSN,E.FIRST_NAME,E.LAST_NAME,D.MEDICARE_CLAIM_NO, D.MEDICARE_PART_B_EFFECTIVE_DATE AS 'MEDICARE_EFFECTIVE_DATE',&#xD;&#xA;   0.00 AS PREMIUM_AMOUNT,0.00 AS FEE_AMOUNT,'' AS COVERAGE_CODE, E.DATE_OF_BIRTH AS DOB, 0 AS CNT,D.RELATIONSHIP_VALUE AS RELATIONSHIP_VALUE,&#xD;&#xA;   'PERSLink Batch'+' '+ convert(nvarchar,@batchscheduleid) AS CREATED_BY, GETDATE() AS CREATED_DATE, 'PERSLink Batch'+' '+ convert(nvarchar,@batchscheduleid) AS MODIFIED_BY, GETDATE() AS MODIFIED_DATE, 0 AS UPDATE_SEQ&#xD;&#xA;FROM  SGT_PROVIDER_REPORT_DATA_INSURANCE A&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT ACC ON ACC.PERSON_ID = A.PERSON_ID AND ACC.PLAN_ID = A.PLAN_ID&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_DEPENDENT C&#xD;&#xA; ON  ACC.PERSON_ACCOUNT_ID = C.PERSON_ACCOUNT_ID&#xD;&#xA; AND (C.END_DATE &gt;= A.EFFECTIVE_DATE OR C.END_DATE IS NULL)&#xD;&#xA;INNER JOIN SGT_PERSON_DEPENDENT D&#xD;&#xA; ON  C.PERSON_DEPENDENT_ID = D.PERSON_DEPENDENT_ID&#xD;&#xA;INNER JOIN SGT_PERSON E&#xD;&#xA; ON  D.DEPENDENT_PERSLINK_ID = E.PERSON_ID&#xD;&#xA;WHERE  A.PROVIDER_ORG_ID = @PROVIDERORGID&#xD;&#xA;AND   A.EFFECTIVE_DATE &lt;= @EFFECTIVEDATE&#xD;&#xA;AND   A.BATCH_REQUEST_ID IS NULL&#xD;&#xA;AND   A.COVERAGE_CODE IN (SELECT DATA1 FROM SGS_CODE_VALUE WHERE CODE_ID = 1922)">
      <parameters>
        <parameter ID="@PROVIDERORGID" sfwDataType="int" />
        <parameter ID="@EFFECTIVEDATE" sfwDataType="DateTime" />
        <parameter ID="@batchscheduleid" sfwDataType="int" />
      </parameters>
    </query>
  </queries>
  <attributes>
    <attribute ID="ProviderReportDataInsuranceSplitId" sfwType="Column" sfwValue="provider_report_data_insurance_split_id" sfwKeyNo="1" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="True" sfwDataType="int" sfwRequired="False" />
    <attribute ID="ProviderReportDataInsuranceCompId" sfwType="Column" sfwValue="provider_report_data_insurance_comp_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="PersonId" sfwType="Column" sfwValue="person_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="Ssn" sfwType="Column" sfwValue="ssn" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="9" />
    <attribute ID="FirstName" sfwType="Column" sfwValue="first_name" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="50" />
    <attribute ID="LastName" sfwType="Column" sfwValue="last_name" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="50" />
    <attribute ID="PremiumAmount" sfwType="Column" sfwValue="premium_amount" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="11,2" />
    <attribute ID="FeeAmount" sfwType="Column" sfwValue="fee_amount" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="11,2" />
    <attribute ID="CoverageCode" sfwType="Column" sfwValue="coverage_code" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="MedicareClaimNo" sfwType="Column" sfwValue="medicare_claim_no" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="15" />
    <attribute ID="CreatedBy" sfwType="Column" sfwValue="created_by" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="50" />
    <attribute ID="CreatedDate" sfwType="Column" sfwValue="created_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="ModifiedBy" sfwType="Column" sfwValue="modified_by" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="50" />
    <attribute ID="ModifiedDate" sfwType="Column" sfwValue="modified_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="UpdateSeq" sfwType="Column" sfwValue="update_seq" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
  </attributes>
</entity>