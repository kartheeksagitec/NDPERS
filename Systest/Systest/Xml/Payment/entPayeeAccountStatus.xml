<entity ID="entPayeeAccountStatus" sfwActive="True" sfwStatus="Valid" sfwType="BusinessRule" sfwMainCDO="icdoPayeeAccountStatus" sfwObjectID="busPayeeAccountStatus" sfwTableName="sgt_payee_account_status">
  <rules>
    <rule ID="Is31DayRuleMet" sfwMessageId="5568" sfwExpression="(this.Is31DayRuleMet() == True) &amp;&amp; &#xA;!(this.icdoPayeeAccountStatus.suppress_warnings_flag == &quot;Y&quot;)" sfwObjectBased="True" />
    <rule ID="IsAddressNotExistForPayee" sfwMessageId="5646" sfwExpression="(this.IsAddressNotExistForPayee() == True)" sfwObjectBased="True" />
    <rule ID="IsApplicationStatusInvalid" sfwMessageId="5658" sfwExpression="(this.IsApplicationInValidStatus() == True)" sfwObjectBased="True" />
    <rule ID="IsBenefitTypeRetirement" sfwExpression="(RFunc.GetValue&lt;String&gt;(this, &quot;ibusPayeeAccount.icdoPayeeAccount.benefit_account_type_value&quot;) == &quot;RETR&quot;)" sfwObjectBased="True" />
    <rule ID="IsCalculationCancelled" sfwMessageId="5618" sfwExpression="(this.IsCalculationCancelled() == True)" sfwObjectBased="True" />
    <rule ID="IsCancelStatusNotAllowed" sfwMessageId="5640" sfwExpression="(this.IsStatusCancelNotAllowed() == True)" sfwObjectBased="True" />
    <rule ID="IsDROApplicationNotQualified" sfwMessageId="6302" sfwExpression="(this.IsDROApplicationQualified() == True)" sfwObjectBased="True" />
    <rule ID="IsNetAmountBelowZero" sfwMessageId="5615" sfwExpression="(RFunc.GetValue&lt;Decimal&gt;(this, &quot;ibusPayeeAccount.idecBenefitAmount&quot;) &lt; 0.00)" sfwObjectBased="True" />
    <rule ID="IsNetAmountNegative" sfwMessageId="5615" sfwExpression="(this.IsNetAmountNegative() == True)" sfwObjectBased="True" />
    <rule ID="IsNextPaymentDateLessthanRetirementDate" sfwMessageId="5540" sfwExpression="(this.IsNextPaymentDateInvalid() == True)" sfwObjectBased="True" />
    <rule ID="IsOutstandingCheckAvailableForBenefitAccountOwner" sfwMessageId="5681" sfwExpression="(this.IsAnyOutstandingCheckAvailable() == True)" sfwObjectBased="True" />
    <rule ID="IsPayeeRestricted" sfwMessageId="5645" sfwExpression="(this.IsPayeeRestricted() == True)" sfwObjectBased="True" />
    <rule ID="IsPopupBenefitApprovedAndNotRHICOptionStandard" sfwMessageId="5638" sfwExpression="(this.IsPopupBenefitApprovedAndNotRHICOptionStandardOrOptionFactorNotNull() == True) &amp;&amp; &#xA;!(this.icdoPayeeAccountStatus.suppress_warnings_flag == &quot;Y&quot;)" sfwObjectBased="True" />
    <rule ID="IsPopupBenefitApprovedAndNotSingleLifeOption" sfwMessageId="5639" sfwExpression="(this.IsPopupBenefitApprovedAndNotSingleLifeOption() == True) &amp;&amp; &#xA;!(this.icdoPayeeAccountStatus.suppress_warnings_flag == &quot;Y&quot;)" sfwObjectBased="True" />
    <rule ID="IsRHICBenefitGreaterThanHealthInsurance" sfwMessageId="5527" sfwExpression="(this.IsRHICGreaterThan3rdPary() == True)" sfwObjectBased="True" />
    <rule ID="IsRTWPersonAccountNOTValid" sfwMessageId="5628" sfwExpression="(this.IsRTWPersonAccountValid() == False)" sfwObjectBased="True" />
    <rule ID="IsSameUserApprovingReviewedRecord" sfwMessageId="5526" sfwExpression="(this.IsSameUserApprovingReviewedRecord() == True)" sfwObjectBased="True" />
    <rule ID="IsSameUserCancelPayeeAccout" sfwMessageId="5633" sfwExpression="(this.IsSameUserCancelPayeeAccount() == True)" sfwObjectBased="True" />
    <rule ID="IsStatusChangedToApprovedOrRecievingForAch" sfwMessageId="5517" sfwExpression="!(string.IsNullOrEmpty(this.icdoPayeeAccountStatus.status_value)) &amp;&amp; &#xA;(this.ValidateWhenStatusApprovedOrRecievedForAch() == True)" sfwObjectBased="True" />
    <rule ID="IsStatusChangedToApprovedOrRecievingForRollover" sfwMessageId="5561" sfwExpression="(this.ValidateWhenStatusApprovedOrRecievedForRollover() == True)" sfwObjectBased="True" />
    <rule ID="IsStatusChangedToApprovedOrRecievingForTax" sfwMessageId="5575" sfwExpression="(this.ValidateWhenStatusApprovedOrRecievedForTaxwithHolding() == True)" sfwObjectBased="True" />
    <rule ID="IsStatusChangedwhenPayeeDeathNotified" sfwMessageId="5554" sfwExpression="((this.IsStatusReceiving() == True) || &#xA;(this.IsStatusApproved() == True)) &amp;&amp; &#xA;(this.IsDeathNotifiedForPayee() == True)" sfwObjectBased="True" />
    <rule ID="IsStatusEffectiveDateInvalid" sfwMessageId="5616" sfwExpression="!(this.icdoPayeeAccountStatus.status_effective_date == DateTime.MinValue) &amp;&amp; &#xA;(this.IsStatusEffectiveDateInvalid() == True)" sfwObjectBased="True" />
    <rule ID="IsStatusEffectiveDateLessThanBenefitBeginDate" sfwMessageId="5627" sfwExpression="!(this.icdoPayeeAccountStatus.status_effective_date == DateTime.MinValue) &amp;&amp; &#xA;(this.icdoPayeeAccountStatus.status_effective_date &lt; RFunc.GetValue&lt;DateTime&gt;(this, &quot;ibusPayeeAccount.icdoPayeeAccount.benefit_begin_date&quot;))" sfwObjectBased="True" />
    <rule ID="IsStatusEffectiveDateNull" sfwMessageId="5518" sfwExpression="(this.icdoPayeeAccountStatus.status_effective_date == DateTime.MinValue)" sfwObjectBased="True" />
    <rule ID="IsStatusEffectiveDatePastDate" sfwMessageId="5584" sfwExpression="!(this.icdoPayeeAccountStatus.status_effective_date == DateTime.MinValue) &amp;&amp; &#xA;(this.icdoPayeeAccountStatus.status_effective_date &lt; RFunc.CurrentDate())" sfwObjectBased="True" />
    <rule ID="IsStatusNotCancelled" sfwMessageId="5657" sfwExpression="(this.IsStatusNotCancelled() == True)" sfwObjectBased="True" />
    <rule ID="IsStatusNotCancelPendingForRfProcessed" sfwMessageId="5652" sfwExpression="(this.IsStatusCancelPendingForRefundPayeeAccount() == True)" sfwObjectBased="True" />
    <rule ID="IsStatusNull" sfwMessageId="5550" sfwExpression="(string.IsNullOrEmpty(this.icdoPayeeAccountStatus.status_value))" sfwObjectBased="True" />
    <rule ID="IsStatusTerminatedOrSuspended" sfwMessageId="5519" sfwExpression="(this.IsStatusTerminatedOrSuspended() == True)" sfwObjectBased="True" />
    <rule ID="IsSuspensionReasonNotReuired" sfwMessageId="5539" sfwExpression="(this.IsSuspensionOrTerminationStatusValid() == &quot;SUSN&quot;)" sfwObjectBased="True" />
    <rule ID="IsSuspensionReasonNullandStatusSuspended" sfwMessageId="5521" sfwExpression="(this.IsSuspensionOrTerminationStatusValid() == &quot;SUSR&quot;)" sfwObjectBased="True" />
    <rule ID="IsTerminationReasonNotRequired" sfwMessageId="5538" sfwExpression="(this.IsSuspensionOrTerminationStatusValid() == &quot;TERN&quot;)" sfwObjectBased="True" />
    <rule ID="IsTerminationReasonNullanfStatusTerminated" sfwMessageId="5520" sfwExpression="(this.IsSuspensionOrTerminationStatusValid() == &quot;TERR&quot;)" sfwObjectBased="True" />
    <rule ID="IsUnderPaymentOptionBlank" sfwMessageId="5642" sfwExpression="(this.IsUnderPaymentOptionBlank() == True)" sfwObjectBased="True" />
    <rule ID="IsUserNotEligibleForApprove" sfwMessageId="6713" sfwExpression="!(this.IsUserEligibleForApproval() == True)" sfwObjectBased="True" />
    <rule ID="IsStatusApprovedForNonSpouse" sfwMessageId="10261" sfwExpression="(this.IsStatusApprovedForFedTax() == True) &amp;&amp; &#xA;!(this.icdoPayeeAccountStatus.suppress_warnings_flag == &quot;Y&quot;)" sfwObjectBased="True" />
    <rule ID="AreAnyNotCanceledPaymentsExistWhenPayeeAccChangedToCancelPending" sfwRuleType="Validation" sfwExpression="(this.AreNotCanceledPaymentsExist() == True)" sfwMessageId="10299" sfwObjectBased="True" />
    <rule ID="IsUnderPaymentNotApproved" sfwRuleType="Validation" sfwExpression="(this.IsUnderPaymentNotApproved() == True)" sfwMessageId="10309" sfwObjectBased="True" />
    <rule ID="IsBenefitOverPaymentExists" sfwRuleType="Validation" sfwExpression="(this.icdoPayeeAccountStatus.suppress_warnings_flag != &quot;Y&quot;) &amp;&amp;&#xA;(this.icdoPayeeAccountStatus.status_value == &quot;APRD&quot; ||&#xA;this.icdoPayeeAccountStatus.status_value == &quot;RAPD&quot; ||&#xA;this.icdoPayeeAccountStatus.status_value == &quot;APDS&quot; ||&#xA;this.icdoPayeeAccountStatus.status_value == &quot;DAPD&quot;||&#xA;this.icdoPayeeAccountStatus.status_value == &quot;PAPD&quot;)&#xA;&amp;&amp; (this.IsBenefitOverpayment() == true)" sfwMessageId="7731" sfwObjectBased="True" />
    <rule ID="IsThereNotCanceledRolloverExists" sfwRuleType="Validation" sfwExpression="!IsNotCanceledRolloverExisting()" sfwMessageId="10345" />
    <rule ID="IsRetroPaymentTypePopupBenefits" sfwRuleType="Validation" sfwObjectBased="True" sfwExpression="this.IsThereAPriorPopupExisting()" sfwMessageId="10407" />
    <rule ID="IsAutoRefundAndAmountGreaterThan1000" sfwRuleType="Validation" sfwObjectBased="False" sfwMessageId="10458" sfwExpression="this.IsAutoRefundAndAmountGreaterThan1000()" />
    <rule ID="IsStatusSuspendedToApproved" sfwRuleType="Validation" sfwObjectBased="True" sfwExpression="(this.icdoPayeeAccountStatus.suppress_warnings_flag != &quot;Y&quot;)&amp;&amp;&#xA;(this.IsStatusSuspendedToApproved() == true)" sfwMessageId="10500" />
  </rules>
  <delete />
  <checklist />
  <initialload>
    <item ID="IsBenefitTypeRetirement" sfwMode="All" sfwStatus="Active" />
  </initialload>
  <softerror />
  <harderror>
    <item ID="IsStatusChangedToApprovedOrRecievingForAch" sfwMode="All" sfwStatus="Active" />
    <item ID="IsSuspensionReasonNullandStatusSuspended" sfwMode="All" sfwStatus="Active" />
    <item ID="IsTerminationReasonNullanfStatusTerminated" sfwMode="All" sfwStatus="Active" />
    <item ID="IsStatusEffectiveDateNull" sfwMode="All" sfwStatus="Active" />
    <item ID="IsStatusTerminatedOrSuspended" sfwMode="All" sfwStatus="Active" />
    <item ID="IsSameUserApprovingReviewedRecord" sfwMode="All" sfwStatus="Active" />
    <item ID="IsRHICBenefitGreaterThanHealthInsurance" sfwMode="All" sfwStatus="Active" />
    <item ID="IsSuspensionReasonNotReuired" sfwMode="All" sfwStatus="Active" />
    <item ID="IsTerminationReasonNotRequired" sfwMode="All" sfwStatus="Active" />
    <item ID="IsStatusNull" sfwMode="All" sfwStatus="Active" />
    <item ID="IsStatusChangedToApprovedOrRecievingForRollover" sfwMode="All" sfwStatus="Active" />
    <item ID="Is31DayRuleMet" sfwMode="All" sfwStatus="Active" />
    <item ID="IsStatusChangedToApprovedOrRecievingForTax" sfwMode="All" sfwStatus="Active" />
    <item ID="IsStatusEffectiveDatePastDate" sfwMode="All" sfwStatus="Active" />
    <item ID="IsNetAmountBelowZero" sfwMode="All" sfwStatus="Active" />
    <item ID="IsStatusEffectiveDateInvalid" sfwMode="New" sfwStatus="Active" />
    <item ID="IsStatusEffectiveDateLessThanBenefitBeginDate" sfwMode="All" sfwStatus="Inactive" />
    <item ID="IsRTWPersonAccountNOTValid" sfwMode="All" sfwStatus="Active" />
    <item ID="IsDROApplicationNotQualified" sfwMode="All" sfwStatus="Active" />
    <item ID="IsStatusChangedwhenPayeeDeathNotified" sfwMode="All" sfwStatus="Active" />
    <item ID="IsUserNotEligibleForApprove" sfwMode="All" sfwStatus="Active" />
    <item ID="IsSameUserCancelPayeeAccout" sfwMode="All" sfwStatus="Active" />
    <item ID="IsCancelStatusNotAllowed" sfwMode="All" sfwStatus="Active" />
    <item ID="IsUnderPaymentOptionBlank" sfwMode="All" sfwStatus="Active" />
    <item ID="IsPayeeRestricted" sfwMode="All" sfwStatus="Active" />
    <item ID="IsNetAmountNegative" sfwMode="All" sfwStatus="Active" />
    <item ID="IsStatusNotCancelPendingForRfProcessed" sfwMode="All" sfwStatus="Active" />
    <item ID="IsCalculationCancelled" sfwMode="All" sfwStatus="Active" />
    <item ID="IsStatusNotCancelled" sfwMode="All" sfwStatus="Active" />
    <item ID="IsApplicationStatusInvalid" sfwMode="All" sfwStatus="Active" />
    <item ID="IsOutstandingCheckAvailableForBenefitAccountOwner" sfwMode="All" sfwStatus="Active" />
    <item ID="IsStatusApprovedForNonSpouse" sfwStatus="Active" sfwMode="All" />
    <item ID="AreAnyNotCanceledPaymentsExistWhenPayeeAccChangedToCancelPending" sfwStatus="Active" sfwMode="All" />
    <item ID="IsUnderPaymentNotApproved" sfwStatus="Active" sfwMode="All" />
    <item ID="IsBenefitOverPaymentExists" sfwStatus="Active" sfwMode="All" />
    <item ID="IsThereNotCanceledRolloverExists" sfwStatus="Active" sfwMode="All" />
    <item ID="IsRetroPaymentTypePopupBenefits" sfwMode="All" sfwStatus="Active" />
    <item ID="IsAutoRefundAndAmountGreaterThan1000" sfwMode="All" sfwStatus="Active" />
    <item ID="IsStatusSuspendedToApproved" sfwMode="All" sfwStatus="Active" />
  </harderror>
  <validatedelete />
  <groupslist />
  <updateablecdo />
  <commonproperties>
    <item ID="person_id" sfwObjectField="ibusPayeeAccount.icdoPayeeAccount.payee_perslink_id" sfwBeforeMethodName="LoadPayeeAccount" />
  </commonproperties>
  <queries>
    <query ID="UpdatePayeeAccountStatus" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="INSERT INTO SGT_PAYEE_ACCOUNT_STATUS&#xD;&#xA;(&#xD;&#xA;PAYEE_ACCOUNT_ID, STATUS_ID, STATUS_VALUE, STATUS_EFFECTIVE_DATE, SUSPENSION_STATUS_REASON_ID, SUSPENSION_STATUS_REASON_VALUE,&#xD;&#xA;TERMINATED_STATUS_REASON_ID, TERMINATED_STATUS_REASON_VALUE, CREATED_BY, CREATED_DATE, MODIFIED_BY, MODIFIED_DATE, UPDATE_SEQ)&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;SELECT &#xD;&#xA; PA.PAYEE_ACCOUNT_ID,2203 as Status_id,&#xD;&#xA; CASE WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE='RFND' AND (PA.BENEFIT_OPTION_VALUE in ('AURD','RGRD')) THEN 'RPCD'&#xD;&#xA;   WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'DETH' AND (PA.BENEFIT_OPTION_VALUE IN  ('AURD','REFD')) THEN 'TRDT'&#xD;&#xA;   WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'PSTD' AND (PA.BENEFIT_OPTION_VALUE IN  ('AURD','REFD')) THEN 'TRPS'&#xD;&#xA;   ELSE&#xD;&#xA;   CASE WHEN &#xD;&#xA;    (CASE WHEN PA.APPLICATION_ID IS NOT NULL &#xD;&#xA;      THEN BA_PLAN_ID &#xD;&#xA;      ELSE DROA_PLAN_ID END) = 7&#xD;&#xA;   THEN&#xD;&#xA;    CASE WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'RETR' THEN 'DCRC'&#xD;&#xA;       WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'DISA' THEN 'DCDS'&#xD;&#xA;       WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'DETH' AND (PA.BENEFIT_OPTION_VALUE IN  ('AURD','RGRD')) THEN 'TRMD'&#xD;&#xA;       WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'DETH' AND (PA.BENEFIT_OPTION_VALUE NOT IN  ('AURD','RGRD')) THEN 'DCDT'&#xD;&#xA;       WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'PSTD' THEN 'DCPS' END&#xD;&#xA;   ELSE&#xD;&#xA;    CASE WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'RETR' THEN 'RECV'&#xD;&#xA;      WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'DISA' THEN 'RCDS'&#xD;&#xA;      WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'DETH' THEN 'RCDT'&#xD;&#xA;      WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'PSTD' THEN 'RCPS' END&#xD;&#xA;   END &#xD;&#xA;  END AS STATUS_VALUE,&#xD;&#xA; case when pas_STATUS_EFFECTIVE_DATE &gt;= CONVERT(DATETIME,CONVERT(VARCHAR,getdate(),101) ,110) &#xD;&#xA;  then pas_STATUS_EFFECTIVE_DATE else  CONVERT(DATETIME,CONVERT(VARCHAR,getdate(),101) ,110) end as STATUS_EFFECTIVE_DATE,&#xD;&#xA; 2206 as SUSPENSION_STATUS_REASON_ID, &#xD;&#xA; null as SUSPENSION_STATUS_REASON_VALUE,&#xD;&#xA; 2205 as TERMINATED_STATUS_REASON_ID,&#xD;&#xA; null as TERMINATED_STATUS_REASON_VALUE ,&#xD;&#xA; 'PERSLink Batch'+' '+ convert(nvarchar,@batchscheduleid) as CREATED_BY,&#xD;&#xA; getdate() as CREATED_DATE,&#xD;&#xA; 'PERSLink Batch'+' '+ convert(nvarchar,@batchscheduleid) as MODIFIED_BY,&#xD;&#xA; getdate() as modified_date,&#xD;&#xA; 0 as UPDATE_SEQ&#xD;&#xA;FROM  &#xD;&#xA; ( Select Distinct pa.Payee_account_id ,&#xD;&#xA;  PA.BENEFIT_ACCOUNT_TYPE_VALUE,&#xD;&#xA;  PA.APPLICATION_ID,&#xD;&#xA;  BA.PLAN_ID  as BA_PLAN_ID,&#xD;&#xA;  DROA.PLAN_ID  as DROA_PLAN_ID,&#xD;&#xA;  pas.STATUS_EFFECTIVE_DATE as pas_STATUS_EFFECTIVE_DATE,&#xD;&#xA;  Pa.benefit_option_value From&#xD;&#xA; SGT_PAYEE_ACCOUNT PA WITH(NOLOCK)  &#xD;&#xA; INNER JOIN SGT_PAYEE_ACCOUNT_STATUS PAS WITH(NOLOCK) &#xD;&#xA;  ON PAS.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID &#xD;&#xA; INNER JOIN SGS_CODE_VALUE CV WITH(NOLOCK)&#xD;&#xA;  ON PAS.STATUS_ID= CV.CODE_ID AND PAS.STATUS_VALUE = CV.CODE_VALUE&#xD;&#xA; INNER JOIN SGT_PAYMENT_HISTORY_HEADER PHH WITH(NOLOCK)&#xD;&#xA;  ON PHH.PAYEE_ACCOUNT_ID=PA.PAYEE_ACCOUNT_ID &#xD;&#xA; LEFT OUTER JOIN SGT_BENEFIT_APPLICATION BA WITH(NOLOCK) &#xD;&#xA;  ON BA.BENEFIT_APPLICATIOn_ID = PA.APPLICATION_ID &#xD;&#xA; LEFT OUTER JOIN SGT_BENEFIT_DRO_CALCULATION DROC WITH(NOLOCK)&#xD;&#xA;  ON DROC.DRO_CALCULATION_ID = PA.DRO_CALCULATION_ID &#xD;&#xA; LEFT OUTER JOIN SGT_BENEFIT_DRO_APPLICATION DROA WITH(NOLOCK)&#xD;&#xA;  ON PA.DRO_APPLICATION_ID = DROA.DRO_APPLICATION_ID &#xD;&#xA;WHERE (CV.DATA2 = 'APRD')  &#xD;&#xA; AND PAYEE_ACCOUNT_STATUS_ID  = &#xD;&#xA;   ( &#xD;&#xA;    SELECT TOP 1 PAYEE_ACCOUNT_STATUS_ID&#xD;&#xA;    FROM SGT_PAYEE_ACCOUNT_STATUS PAS1 (nolock)&#xD;&#xA;    WHERE PAS1.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID&#xD;&#xA;    AND PAS1.STATUS_EFFECTIVE_DATE &lt;= @PAYMENTDATE&#xD;&#xA;    ORDER BY PAS1.STATUS_EFFECTIVE_DATE DESC,PAS1.PAYEE_ACCOUNT_STATUS_ID DESC&#xD;&#xA;   )&#xD;&#xA; AND PAS.STATUS_EFFECTIVE_DATE &lt;= @PAYMENTDATE &#xD;&#xA; AND pa.BENEFIT_BEGIN_DATE &lt;=  @PAYMENTDATE&#xD;&#xA; AND (pa.BENEFIT_END_DATE IS NULL OR pa.BENEFIT_END_DATE &gt; @PAYMENTDATE)&#xD;&#xA; AND PHH.PAYMENT_SCHEDULE_ID=@PAYMENTSCHEDULEID&#xD;&#xA; AND PA.BENEFIT_OPTION_VALUE NOT IN('DBCT','DTCT','DBDC','DBTT','SPEL')&#xD;&#xA; AND PHH.PAYEE_ACCOUNT_ID IS NOT NULL&#xD;&#xA; ) PA&#xD;&#xA;&#xD;&#xA;union all&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;SELECT &#xD;&#xA; PA.PAYEE_ACCOUNT_ID,2203 &#xD;&#xA;as Status_id,&#xD;&#xA; CASE WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE='RFND' AND (PA.BENEFIT_OPTION_VALUE in ('AURD','RGRD')) THEN 'RPCD'&#xD;&#xA;   WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'DETH' AND (PA.BENEFIT_OPTION_VALUE IN  ('AURD','REFD')) THEN 'TRDT'&#xD;&#xA;   ELSE&#xD;&#xA;   CASE WHEN &#xD;&#xA;    (CASE WHEN PA.APPLICATION_ID IS NOT NULL &#xD;&#xA;      THEN BA_PLAN_ID &#xD;&#xA;      ELSE DROA_PLAN_ID END) = 7&#xD;&#xA;   THEN&#xD;&#xA;    CASE WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'RETR' THEN 'DCRC'&#xD;&#xA;       WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'DISA' THEN 'DCDS'&#xD;&#xA;       WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'DETH' AND (PA.BENEFIT_OPTION_VALUE IN  ('AURD','RGRD')) THEN 'TRMD'&#xD;&#xA;       WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'DETH' AND (PA.BENEFIT_OPTION_VALUE NOT IN  ('AURD','RGRD')) THEN 'DCDT'&#xD;&#xA;       WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'PSTD' THEN 'DCPS' END&#xD;&#xA;   ELSE&#xD;&#xA;    CASE WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'RETR' THEN 'RECV'&#xD;&#xA;      WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'DISA' THEN 'RCDS'&#xD;&#xA;      WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'DETH' THEN 'RCDT'&#xD;&#xA;      WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'PSTD' THEN 'RCPS' END&#xD;&#xA;   END &#xD;&#xA;  END AS STATUS_VALUE,&#xD;&#xA; case when pas_STATUS_EFFECTIVE_DATE &gt;= CONVERT(DATETIME,CONVERT(VARCHAR,getdate(),101) ,110) &#xD;&#xA;   then pas_STATUS_EFFECTIVE_DATE else  CONVERT(DATETIME,CONVERT(VARCHAR,getdate(),101) ,110) end as STATUS_EFFECTIVE_DATE,&#xD;&#xA; 2206 as SUSPENSION_STATUS_REASON_ID, &#xD;&#xA; null as SUSPENSION_STATUS_REASON_VALUE,&#xD;&#xA; 2205 as TERMINATED_STATUS_REASON_ID,&#xD;&#xA; null as TERMINATED_STATUS_REASON_VALUE ,&#xD;&#xA; 'PERSLink Batch'+' '+ convert(nvarchar,@batchscheduleid) as CREATED_BY,&#xD;&#xA; getdate() as CREATED_DATE,&#xD;&#xA; 'PERSLink Batch'+' '+ convert(nvarchar,@batchscheduleid) as MODIFIED_BY,&#xD;&#xA; getdate() as modified_date,&#xD;&#xA; 0 as UPDATE_SEQ&#xD;&#xA;FROM  &#xD;&#xA; ( Select Distinct pa.Payee_account_id ,&#xD;&#xA;  PA.BENEFIT_ACCOUNT_TYPE_VALUE,&#xD;&#xA;  PA.APPLICATION_ID,&#xD;&#xA;  BA.PLAN_ID  as BA_PLAN_ID,&#xD;&#xA;  DROA.PLAN_ID  as DROA_PLAN_ID,&#xD;&#xA;  pas.STATUS_EFFECTIVE_DATE as pas_STATUS_EFFECTIVE_DATE,&#xD;&#xA;  Pa.benefit_option_value From&#xD;&#xA; SGT_PAYEE_ACCOUNT PA WITH(NOLOCK)  &#xD;&#xA; INNER JOIN SGT_PAYEE_ACCOUNT_STATUS PAS WITH(NOLOCK) &#xD;&#xA;  ON PAS.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID &#xD;&#xA; INNER JOIN SGS_CODE_VALUE CV WITH(NOLOCK)&#xD;&#xA;  ON PAS.STATUS_ID= CV.CODE_ID AND PAS.STATUS_VALUE = CV.CODE_VALUE &#xD;&#xA; LEFT OUTER JOIN SGT_BENEFIT_APPLICATION BA WITH(NOLOCK) &#xD;&#xA;  ON BA.BENEFIT_APPLICATIOn_ID = PA.APPLICATION_ID &#xD;&#xA; LEFT OUTER JOIN SGT_BENEFIT_DRO_CALCULATION DROC WITH(NOLOCK)&#xD;&#xA;  ON DROC.DRO_CALCULATION_ID = PA.DRO_CALCULATION_ID &#xD;&#xA; LEFT OUTER JOIN SGT_BENEFIT_DRO_APPLICATION DROA WITH(NOLOCK)&#xD;&#xA;  ON PA.DRO_APPLICATION_ID = DROA.DRO_APPLICATION_ID &#xD;&#xA;WHERE (CV.DATA2 = 'APRD')  &#xD;&#xA; AND PAYEE_ACCOUNT_STATUS_ID  = &#xD;&#xA;   ( &#xD;&#xA;    SELECT TOP 1 PAYEE_ACCOUNT_STATUS_ID&#xD;&#xA;    FROM SGT_PAYEE_ACCOUNT_STATUS PAS1 (nolock)&#xD;&#xA;    WHERE PAS1.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID&#xD;&#xA;    AND PAS1.STATUS_EFFECTIVE_DATE &lt;= @PAYMENTDATE&#xD;&#xA;    ORDER BY PAS1.STATUS_EFFECTIVE_DATE DESC,PAS1.PAYEE_ACCOUNT_STATUS_ID DESC&#xD;&#xA;   )&#xD;&#xA; AND PAS.STATUS_EFFECTIVE_DATE &lt;= @PAYMENTDATE &#xD;&#xA; AND pa.BENEFIT_BEGIN_DATE &lt;=  @PAYMENTDATE&#xD;&#xA; AND (pa.BENEFIT_END_DATE IS NULL OR pa.BENEFIT_END_DATE &gt; @PAYMENTDATE) &#xD;&#xA; AND PA.BENEFIT_OPTION_VALUE NOT IN('DBCT','DTCT','DBDC','DBTT','SPEL') &#xD;&#xA;) PA&#xD;&#xA;where pa.BA_PLAN_ID IN (7,28,30) OR DROA_PLAN_ID IN (7,28,30)">
      <parameters>
        <parameter ID="@PAYMENTDATE" sfwDataType="DateTime" />
        <parameter ID="@PAYMENTSCHEDULEID" sfwDataType="int" />
        <parameter ID="@batchscheduleid" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="UpdatePayeeAccountStatusComplete" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="INSERT INTO SGT_PAYEE_ACCOUNT_STATUS&#xD;&#xA;(&#xD;&#xA;PAYEE_ACCOUNT_ID, STATUS_ID, STATUS_VALUE, STATUS_EFFECTIVE_DATE, SUSPENSION_STATUS_REASON_ID, SUSPENSION_STATUS_REASON_VALUE, TERMINATED_STATUS_REASON_ID, TERMINATED_STATUS_REASON_VALUE, CREATED_BY, CREATED_DATE, MODIFIED_BY, MODIFIED_DATE, UPDATE_SEQ&#xD;&#xA;)&#xD;&#xA;&#xD;&#xA;SELECT &#xD;&#xA; PAYEE.PAYEE_ACCOUNT_ID,2203 as Status_id,&#xD;&#xA; CASE WHEN PAYEE.BENEFIT_ACCOUNT_TYPE_VALUE = 'RETR' THEN 'TRMD'&#xD;&#xA;   WHEN PAYEE.BENEFIT_ACCOUNT_TYPE_VALUE = 'DISA' THEN 'TRDS'&#xD;&#xA;   WHEN PAYEE.BENEFIT_ACCOUNT_TYPE_VALUE = 'DETH' THEN 'TRDT'&#xD;&#xA;   WHEN PAYEE.BENEFIT_ACCOUNT_TYPE_VALUE = 'PSTD' THEN 'TRPS' &#xD;&#xA; END AS STATUS_VALUE,&#xD;&#xA; case when STATUS_EFFECTIVE_DATE &gt;= CONVERT(DATETIME,CONVERT(VARCHAR,getdate(),101) ,110)&#xD;&#xA;     then STATUS_EFFECTIVE_DATE else  CONVERT(DATETIME,CONVERT(VARCHAR,getdate(),101) ,110) end  as STATUS_EFFECTIVE_DATE,&#xD;&#xA; 2206 as SUSPENSION_STATUS_REASON_ID, &#xD;&#xA; null as SUSPENSION_STATUS_REASON_VALUE,&#xD;&#xA; 2205 as TERMINATED_STATUS_REASON_ID,&#xD;&#xA; null as TERMINATED_STATUS_REASON_VALUE ,&#xD;&#xA; 'PERSLink Batch'+' '+ convert(nvarchar,@batchscheduleid) as CREATED_BY,&#xD;&#xA; getdate() as CREATED_DATE,&#xD;&#xA; 'PERSLink Batch'+' '+ convert(nvarchar,@batchscheduleid) as MODIFIED_BY,&#xD;&#xA; getdate() as modified_date,&#xD;&#xA; 0 as UPDATE_SEQ&#xD;&#xA;From&#xD;&#xA;(&#xD;&#xA;SELECT &#xD;&#xA; PA.PAYEE_ACCOUNT_ID, PA.BENEFIT_ACCOUNT_TYPE_VALUE ,pas.STATUS_EFFECTIVE_DATE&#xD;&#xA;FROM SGT_PAYEE_ACCOUNT PA WITH(NOLOCK)  &#xD;&#xA; INNER JOIN SGT_PAYEE_ACCOUNT_STATUS PAS WITH(NOLOCK) &#xD;&#xA;  ON PAS.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID &#xD;&#xA; INNER JOIN SGT_PAYMENT_HISTORY_HEADER PHH WITH(NOLOCK) &#xD;&#xA;  ON PHH.PAYEE_ACCOUNT_ID=PA.PAYEE_ACCOUNT_ID&#xD;&#xA; INNER JOIN &#xD;&#xA; ( SELECT DISTINCT PAYMENT_HISTORY_HEADER_ID &#xD;&#xA;   FROM SGT_PAYMENT_HISTORY_DISTRIBUTION &#xD;&#xA;   WHERE PAYMENT_METHOD_VALUE IN ('ACH','CHK')&#xD;&#xA; ) AS PHDN &#xD;&#xA;  ON PHDN.PAYMENT_HISTORY_HEADER_ID = PHH.PAYMENT_HISTORY_HEADER_ID&#xD;&#xA; INNER JOIN SGS_CODE_VALUE CV WITH(NOLOCK)&#xD;&#xA;  ON PAS.STATUS_ID= CV.CODE_ID AND PAS.STATUS_VALUE = CV.CODE_VALUE&#xD;&#xA;WHERE &#xD;&#xA; (CV.DATA2 = 'RECV' )  &#xD;&#xA; AND &#xD;&#xA; PAYEE_ACCOUNT_STATUS_ID  = &#xD;&#xA;   ( &#xD;&#xA;    SELECT TOP 1 PAYEE_ACCOUNT_STATUS_ID&#xD;&#xA;    FROM SGT_PAYEE_ACCOUNT_STATUS PAS1 (nolock)&#xD;&#xA;    WHERE PAS1.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID&#xD;&#xA;    AND PAS1.STATUS_EFFECTIVE_DATE &lt;= @PAYMENTDATE&#xD;&#xA;    ORDER BY PAS1.STATUS_EFFECTIVE_DATE DESC,PAS1.PAYEE_ACCOUNT_STATUS_ID DESC&#xD;&#xA;   )&#xD;&#xA; AND PAS.STATUS_EFFECTIVE_DATE &lt;= @PAYMENTDATE &#xD;&#xA; AND BENEFIT_BEGIN_DATE &lt;= @PAYMENTDATE&#xD;&#xA; AND (BENEFIT_END_DATE = dateadd(d,-1,dateadd(m,1,@PAYMENTDATE)))&#xD;&#xA;    AND PA.BENEFIT_ACCOUNT_TYPE_VALUE &lt;&gt; 'RFND'&#xD;&#xA; AND PHH.PAYEE_ACCOUNT_ID IS NOT NULL&#xD;&#xA; AND PA.BENEFIT_OPTION_VALUE NOT IN('DBCT','DTCT','DBDC','DBTT','SPEL')&#xD;&#xA; AND PHH.PAYMENT_SCHEDULE_ID=@PAYMENTSCHEDULEID&#xD;&#xA; ) AS PAYEE">
      <parameters>
        <parameter ID="@PAYMENTDATE" sfwDataType="DateTime" />
        <parameter ID="@PAYMENTSCHEDULEID" sfwDataType="int" />
        <parameter ID="@batchscheduleid" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="UpdatePayeeAccountStatusAdhoc" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="INSERT INTO SGT_PAYEE_ACCOUNT_STATUS&#xD;&#xA;(&#xD;&#xA; PAYEE_ACCOUNT_ID, STATUS_ID, STATUS_VALUE, STATUS_EFFECTIVE_DATE, SUSPENSION_STATUS_REASON_ID, SUSPENSION_STATUS_REASON_VALUE, TERMINATED_STATUS_REASON_ID, TERMINATED_STATUS_REASON_VALUE, CREATED_BY, CREATED_DATE, MODIFIED_BY, MODIFIED_DATE, UPDATE_SEQ&#xD;&#xA;)&#xD;&#xA;SELECT &#xD;&#xA; PA.PAYEE_ACCOUNT_ID,2203 as Status_id,&#xD;&#xA; CASE WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'DETH' AND (PA.BENEFIT_OPTION_VALUE IN  ('AURD','REFD')) THEN 'TRDT'&#xD;&#xA;   WHEN PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'PSTD' AND (PA.BENEFIT_OPTION_VALUE IN  ('AURD','REFD')) THEN 'TRPS'&#xD;&#xA;   WHEN (PA.BENEFIT_OPTION_VALUE in ('AURD','DBCT','DTCT','DBDC','DBTT','RGRD','SPEL')) THEN 'RPCD' END AS STATUS_VALUE,&#xD;&#xA; case when pas_STATUS_EFFECTIVE_DATE &gt;= CONVERT(DATETIME,CONVERT(VARCHAR,getdate(),101) ,110)&#xD;&#xA; then pas_STATUS_EFFECTIVE_DATE else  CONVERT(DATETIME,CONVERT(VARCHAR,getdate(),101) ,110) end as STATUS_EFFECTIVE_DATE,&#xD;&#xA; 2206 as SUSPENSION_STATUS_REASON_ID, &#xD;&#xA; null as SUSPENSION_STATUS_REASON_VALUE,&#xD;&#xA; 2205 as TERMINATED_STATUS_REASON_ID,&#xD;&#xA; null as TERMINATED_STATUS_REASON_VALUE ,&#xD;&#xA; 'PERSLink Batch'+' '+ convert(nvarchar,@batchscheduleid) as CREATED_BY,&#xD;&#xA; getdate() as CREATED_DATE,&#xD;&#xA; 'PERSLink Batch'+' '+ convert(nvarchar,@batchscheduleid) as MODIFIED_BY,&#xD;&#xA; getdate() as modified_date,&#xD;&#xA; 0 as UPDATE_SEQ&#xD;&#xA;From(&#xD;&#xA;  Select Distinct pa.Payee_account_id ,PA.BENEFIT_ACCOUNT_TYPE_VALUE, &#xD;&#xA;  pas.STATUS_EFFECTIVE_DATE as pas_STATUS_EFFECTIVE_DATE,&#xD;&#xA;  Pa.benefit_option_value&#xD;&#xA; FROM SGT_PAYEE_ACCOUNT PA &#xD;&#xA;  INNER JOIN SGT_PAYEE_ACCOUNT_STATUS PAS &#xD;&#xA;   ON PAS.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID &#xD;&#xA;  INNER JOIN SGT_PAYMENT_HISTORY_HEADER PHH &#xD;&#xA;   ON PHH.PAYEE_ACCOUNT_ID=PA.PAYEE_ACCOUNT_ID  &#xD;&#xA;  INNER JOIN SGS_CODE_VALUE CV &#xD;&#xA;   ON PAS.STATUS_ID= CV.CODE_ID AND PAS.STATUS_VALUE = CV.CODE_VALUE&#xD;&#xA;  INNER JOIN SGT_BENEFIT_APPLICATION BA &#xD;&#xA;   ON PA.Application_id = ba.benefit_application_id &#xD;&#xA; WHERE (CV.DATA2 = 'APRD' )  AND PHH.PAYMENT_SCHEDULE_ID= @PAYMENTSCHEDULEID&#xD;&#xA;  AND PAYEE_ACCOUNT_STATUS_ID  = &#xD;&#xA;   ( &#xD;&#xA;    SELECT TOP 1 PAYEE_ACCOUNT_STATUS_ID&#xD;&#xA;    FROM SGT_PAYEE_ACCOUNT_STATUS PAS1 (nolock)&#xD;&#xA;    WHERE PAS1.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID&#xD;&#xA;    AND PAS1.STATUS_EFFECTIVE_DATE &lt;= @PAYMENTDATE&#xD;&#xA;    ORDER BY PAS1.STATUS_EFFECTIVE_DATE DESC,PAS1.PAYEE_ACCOUNT_STATUS_ID DESC&#xD;&#xA;   )&#xD;&#xA;&#xD;&#xA;  AND dateadd(m,-1,BENEFIT_BEGIN_DATE) &lt;= @PAYMENTDATE&#xD;&#xA;  AND PAS.STATUS_EFFECTIVE_DATE &lt;= @PAYMENTDATE&#xD;&#xA;  AND (BENEFIT_END_DATE IS NULL OR BENEFIT_END_DATE &gt; @PAYMENTDATE)&#xD;&#xA;  AND ((PA.BENEFIT_ACCOUNT_TYPE_VALUE = 'RFND' &#xD;&#xA;  AND ( PA.BENEFIT_OPTION_VALUE in ('DBCT','DTCT','DBDC','DBTT','SPEL') &#xD;&#xA;     OR ( PA.BENEFIT_OPTION_VALUE in ('RGRD','AURD')&#xD;&#xA;       AND BA.HARDSHIP_APPROVED_FLAG = 'Y'&#xD;&#xA;       AND DATEADD(D,31,BA.TERMINATION_DATE) &lt;= @PAYMENTDATE --PROD PIR 4919&#xD;&#xA;     )&#xD;&#xA;   ))&#xD;&#xA;   OR (( PA.BENEFIT_ACCOUNT_TYPE_VALUE IN ('DETH', 'PSTD') AND PA.BENEFIT_OPTION_VALUE IN  ('REFD','AURD','RGRD') -- PROD PIR 5695&#xD;&#xA;       AND ISNULL(PA.INCLUDE_IN_ADHOC_FLAG,'N') = 'Y'&#xD;&#xA;     )))&#xD;&#xA;)PA">
      <parameters>
        <parameter ID="@PAYMENTSCHEDULEID" sfwDataType="int" />
        <parameter ID="@PAYMENTDATE" sfwDataType="DateTime" />
        <parameter ID="@batchscheduleid" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="PayeeErrorReportCreareReviewPayeeAccountStatus" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="INSERT INTO SGT_PAYEE_ACCOUNT_STATUS &#xD;&#xA;(&#xD;&#xA;PAYEE_ACCOUNT_ID, STATUS_ID, STATUS_VALUE, STATUS_EFFECTIVE_DATE, SUSPENSION_STATUS_REASON_ID, SUSPENSION_STATUS_REASON_VALUE, TERMINATED_STATUS_REASON_ID, TERMINATED_STATUS_REASON_VALUE, CREATED_BY, CREATED_DATE, MODIFIED_BY, MODIFIED_DATE, UPDATE_SEQ&#xD;&#xA;)&#xD;&#xA;SELECT  PAYEE_ACCOUNT_ID,&#xD;&#xA;     2203 AS STATUS_ID,&#xD;&#xA;  CASE WHEN BENEFIT_ACCOUNT_TYPE_VALUE = 'RETR' THEN 'REVW'&#xD;&#xA;    WHEN BENEFIT_ACCOUNT_TYPE_VALUE = 'RFND' THEN 'RRVW'&#xD;&#xA;    WHEN BENEFIT_ACCOUNT_TYPE_VALUE = 'DETH' THEN 'RDRW'&#xD;&#xA;    WHEN BENEFIT_ACCOUNT_TYPE_VALUE = 'DISA' THEN 'RVDS'&#xD;&#xA;    WHEN BENEFIT_ACCOUNT_TYPE_VALUE = 'PSTD' THEN 'RPRW' END&#xD;&#xA;  AS STATUS_VALUE,&#xD;&#xA;  CASE WHEN @BATCHDATE &gt; STATUS_EFFECTIVE_DATE THEN @BATCHDATE ELSE STATUS_EFFECTIVE_DATE END AS STATUS_EFFECTIVE_DATE,&#xD;&#xA;  2206 AS SUSPENSION_STATUS_REASON_ID, &#xD;&#xA;  NULL AS SUSPENSION_STATUS_REASON_VALUE,&#xD;&#xA;  2205 AS TERMINATED_STATUS_REASON_ID,&#xD;&#xA;  NULL AS TERMINATED_STATUS_REASON_VALUE ,&#xD;&#xA;  'PERSLink Batch'+' '+ convert(nvarchar,@batchscheduleid) as CREATED_BY,&#xD;&#xA;  GETDATE() AS CREATED_DATE,&#xD;&#xA;  'PERSLink Batch'+' '+ convert(nvarchar,@batchscheduleid) as MODIFIED_BY,&#xD;&#xA;  GETDATE() AS MODIFIED_DATE,&#xD;&#xA;  0 AS UPDATE_SEQ&#xD;&#xA;FROM (&#xD;&#xA;SELECT RPA.PAYEE_ACCOUNT_ID,RPA.BENEFIT_ACCOUNT_TYPE_VALUE,PAYEE.STATUS_EFFECTIVE_DATE FROM SGT_PAYEE_ACCOUNT RPA &#xD;&#xA;   INNER JOIN &#xD;&#xA;   (SELECT PA.*,PAS11.STATUS_EFFECTIVE_DATE FROM SGT_PAYEE_ACCOUNT PA &#xD;&#xA;   INNER JOIN SGT_PAYEE_ACCOUNT_STATUS PAS&#xD;&#xA;       ON PAS.PAYEE_ACCOUNT_ID=PA.PAYEE_ACCOUNT_ID &#xD;&#xA;   INNER JOIN SGS_CODE_VALUE CV WITH(NOLOCK)&#xD;&#xA;     ON PAS.STATUS_ID= CV.CODE_ID AND PAS.STATUS_VALUE = CV.CODE_VALUE&#xD;&#xA;   INNER JOIN SGT_PAYEE_ACCOUNT_STATUS PAS11&#xD;&#xA;       ON PAS11.PAYEE_ACCOUNT_ID=PA.PAYEE_ACCOUNT_ID &#xD;&#xA;   WHERE PA.BENEFIT_BEGIN_DATE&lt;=@PAYMENTDATE&#xD;&#xA;   AND (CV.DATA2 = 'RECV' OR CV.DATA2 = 'APRD' ) &#xD;&#xA;    AND PAS.PAYEE_ACCOUNT_STATUS_ID  = &#xD;&#xA;     (SELECT TOP 1 PAYEE_ACCOUNT_STATUS_ID&#xD;&#xA;      FROM SGT_PAYEE_ACCOUNT_STATUS PAS1 (NOLOCK)&#xD;&#xA;      WHERE PAS1.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID&#xD;&#xA;      AND PAS1.STATUS_EFFECTIVE_DATE &lt;= @PAYMENTDATE&#xD;&#xA;      ORDER BY PAS1.STATUS_EFFECTIVE_DATE DESC,PAS1.PAYEE_ACCOUNT_STATUS_ID DESC&#xD;&#xA;     )&#xD;&#xA;    AND PAS11.PAYEE_ACCOUNT_STATUS_ID  = &#xD;&#xA;     (SELECT TOP 1 PAYEE_ACCOUNT_STATUS_ID&#xD;&#xA;      FROM SGT_PAYEE_ACCOUNT_STATUS PAS1 (NOLOCK)&#xD;&#xA;      WHERE PAS1.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID&#xD;&#xA;      ORDER BY PAS1.STATUS_EFFECTIVE_DATE DESC,PAS1.PAYEE_ACCOUNT_STATUS_ID DESC&#xD;&#xA;     )&#xD;&#xA;   )PAYEE&#xD;&#xA;ON RPA.PAYEE_ACCOUNT_ID=PAYEE.PAYEE_ACCOUNT_ID &#xD;&#xA;WHERE RPA.STATUS_VALUE='REVW'&#xD;&#xA;)TEMP">
      <parameters>
        <parameter ID="@BATCHDATE" sfwDataType="DateTime" />
        <parameter ID="@PAYMENTDATE" sfwDataType="DateTime" />
        <parameter ID="@batchscheduleid" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="LoadPayeeAccountStatusForNextPaymentDate" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="Select paccs.* from sgt_payee_Account_status paccs&#xD;&#xA; inner join (select pa.* from sgt_payee_account pa &#xD;&#xA;   inner join sgt_payee_account_status pas&#xD;&#xA;       on pas.payee_account_id=pa.payee_account_id &#xD;&#xA;   inner join sgs_code_value cv with(nolock)&#xD;&#xA;     on pas.status_id= cv.code_id and pas.status_value = cv.code_value&#xD;&#xA;   where pa.benefit_begin_date&lt;=@paymentdate&#xD;&#xA;   and (cv.data2 = 'recv' or cv.data2 = 'aprd' ) &#xD;&#xA;    and pas.payee_account_status_id  = &#xD;&#xA;     (select max(payee_account_status_id) &#xD;&#xA;      from sgt_payee_account_status pas1 with(nolock) &#xD;&#xA;      where pas1.payee_account_id = pa.payee_account_id&#xD;&#xA;    ))Payee on payee.payee_Account_id=paccs.payee_account_id&#xD;&#xA;where paccs.payee_account_status_id  = &#xD;&#xA;     (select max(payee_account_status_id) &#xD;&#xA;      from sgt_payee_account_status pas1 with(nolock) &#xD;&#xA;      where pas1.payee_account_id = paccs.payee_account_id)">
      <parameters>
        <parameter ID="@paymentdate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadPaymentCompletePayeeAccounts" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="Select * from sgt_payee_Account a inner join &#xD;&#xA;(&#xD;&#xA;SELECT &#xD;&#xA; PA.PAYEE_ACCOUNT_ID, PA.BENEFIT_ACCOUNT_TYPE_VALUE ,pas.STATUS_EFFECTIVE_DATE&#xD;&#xA;FROM SGT_PAYEE_ACCOUNT PA WITH(NOLOCK)  &#xD;&#xA; INNER JOIN SGT_PAYEE_ACCOUNT_STATUS PAS WITH(NOLOCK) &#xD;&#xA;  ON PAS.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID &#xD;&#xA; INNER JOIN SGT_PAYMENT_HISTORY_HEADER PHH WITH(NOLOCK) &#xD;&#xA;  ON PHH.PAYEE_ACCOUNT_ID=PA.PAYEE_ACCOUNT_ID&#xD;&#xA; INNER JOIN &#xD;&#xA; ( SELECT DISTINCT PAYMENT_HISTORY_HEADER_ID &#xD;&#xA;   FROM SGT_PAYMENT_HISTORY_DISTRIBUTION &#xD;&#xA;   WHERE PAYMENT_METHOD_VALUE IN ('ACH','CHK')&#xD;&#xA; ) AS PHDN &#xD;&#xA;  ON PHDN.PAYMENT_HISTORY_HEADER_ID = PHH.PAYMENT_HISTORY_HEADER_ID&#xD;&#xA; INNER JOIN SGS_CODE_VALUE CV WITH(NOLOCK)&#xD;&#xA;  ON PAS.STATUS_ID= CV.CODE_ID AND PAS.STATUS_VALUE = CV.CODE_VALUE&#xD;&#xA;WHERE &#xD;&#xA; (CV.DATA2 = 'TRMD' )  &#xD;&#xA; AND &#xD;&#xA; PAYEE_ACCOUNT_STATUS_ID  = &#xD;&#xA;   ( &#xD;&#xA;    SELECT TOP 1 PAYEE_ACCOUNT_STATUS_ID&#xD;&#xA;    FROM SGT_PAYEE_ACCOUNT_STATUS PAS1 (nolock)&#xD;&#xA;    WHERE PAS1.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID&#xD;&#xA;    AND PAS1.STATUS_EFFECTIVE_DATE &lt;= @PAYMENTDATE&#xD;&#xA;    ORDER BY PAS1.STATUS_EFFECTIVE_DATE DESC,PAS1.PAYEE_ACCOUNT_STATUS_ID DESC&#xD;&#xA;   )&#xD;&#xA; AND PAS.STATUS_EFFECTIVE_DATE &lt;= @PAYMENTDATE &#xD;&#xA; AND BENEFIT_BEGIN_DATE &lt;= @PAYMENTDATE&#xD;&#xA; AND (BENEFIT_END_DATE = dateadd(d,-1,dateadd(m,1,@PAYMENTDATE)))&#xD;&#xA;    AND PA.BENEFIT_ACCOUNT_TYPE_VALUE &lt;&gt; 'RFND'&#xD;&#xA; AND PHH.PAYEE_ACCOUNT_ID IS NOT NULL&#xD;&#xA; AND PA.BENEFIT_OPTION_VALUE NOT IN('DBCT','DTCT','DBDC','DBTT','SPEL')&#xD;&#xA; AND PHH.PAYMENT_SCHEDULE_ID=@PAYMENTSCHEDULEID&#xD;&#xA;) AS PAYEE on a.payee_account_id=PAYEE.payee_Account_id">
      <parameters>
        <parameter ID="@PAYMENTDATE" sfwDataType="DateTime" />
        <parameter ID="@PAYMENTSCHEDULEID" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="LoadPayeeAccountByPayeePerslinkId" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT * FROM SGT_PAYEE_ACCOUNT WITH(NOLOCK) WHERE &#xD;&#xA;PAYEE_PERSLINK_ID IN &#xD;&#xA;(&#xD;&#xA;&#x9;SELECT BC.PERSON_ID FROM SGT_PAYEE_ACCOUNT PA WITH(NOLOCK)&#xD;&#xA;&#x9;INNER JOIN SGT_BENEFIT_CALCULATION BC WITH(NOLOCK) ON PA.CALCULATION_ID = BC.BENEFIT_CALCULATION_ID&#xD;&#xA;&#x9;WHERE PAYEE_ACCOUNT_ID = @PayeeAccountId&#xD;&#xA;)">
      <parameters>
        <parameter ID="@PayeeAccountId" sfwDataType="int" />
      </parameters>
    </query>
  </queries>
  <attributes>
    <attribute ID="PayeeAccountStatusId" sfwType="Column" sfwValue="payee_account_status_id" sfwKeyNo="1" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="True" sfwDataType="int" sfwRequired="False" />
    <attribute ID="PayeeAccountId" sfwType="Column" sfwValue="payee_account_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="StatusDescription" sfwType="Description" sfwValue="status_description" />
    <attribute ID="StatusId" sfwType="Column" sfwValue="status_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="2203" sfwDataType="int" sfwRequired="False" />
    <attribute ID="StatusValue" sfwType="Column" sfwValue="status_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="StatusEffectiveDate" sfwType="Column" sfwValue="status_effective_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="SuspensionStatusReasonDescription" sfwType="Description" sfwValue="suspension_status_reason_description" />
    <attribute ID="SuspensionStatusReasonId" sfwType="Column" sfwValue="suspension_status_reason_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="2206" sfwDataType="int" sfwRequired="False" />
    <attribute ID="SuspensionStatusReasonValue" sfwType="Column" sfwValue="suspension_status_reason_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="TerminatedStatusReasonDescription" sfwType="Description" sfwValue="terminated_status_reason_description" />
    <attribute ID="TerminatedStatusReasonId" sfwType="Column" sfwValue="terminated_status_reason_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="2205" sfwDataType="int" sfwRequired="False" />
    <attribute ID="TerminatedStatusReasonValue" sfwType="Column" sfwValue="terminated_status_reason_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="CreatedBy" sfwType="Column" sfwValue="created_by" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="50" />
    <attribute ID="CreatedDate" sfwType="Column" sfwValue="created_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="ModifiedBy" sfwType="Column" sfwValue="modified_by" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="50" />
    <attribute ID="ModifiedDate" sfwType="Column" sfwValue="modified_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="UpdateSeq" sfwType="Column" sfwValue="update_seq" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="objPayeeAccount" sfwType="Object" sfwEntity="entPayeeAccount" sfwValue="ibusPayeeAccount" />
    <attribute sfwDataType="string" sfwType="Property" ID="SuppressWarningsFlag" sfwValue="icdoPayeeAccountStatus.suppress_warnings_flag" />
    <attribute sfwDataType="datetime" sfwType="Property" ID="IdtNextPaymentDate" sfwValue="idtNextPaymentDate" />
    <attribute sfwDataType="string" sfwType="Property" ID="IstrPayeeAccountStatusData2" sfwValue="istrPayeeAccountStatusData2" />
  </attributes>
  <objectmethods>
    <method ID="LoadPayeeAccountStatusByBenefitType" sfwReturnType="Collection" sfwObjectID="cdoCodeValue" sfwEntity="entPostRetirementDeathApplication" />
  </objectmethods>
  <constraint />
  <methods />
  <lifecycle />
  <ExtraFields />
</entity>