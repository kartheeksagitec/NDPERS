<?xml version="1.0" encoding="utf-8"?>
<entity ID="entPaymentElectionAdjustment" sfwActive="True" sfwStatus="Valid" sfwType="BusinessRule" sfwMainCDO="icdoPaymentElectionAdjustment" sfwObjectID="busPaymentElectionAdjustment" sfwTableName="sgt_payment_election_adjustment" sfwView="False" sfwParentEntity="entExtendBase">
  <rules>
    <rule ID="IsInvalidPayeeAccount" sfwMessageId="4746" sfwExpression="(this.IsPayeeAccountInvalid() == True)" sfwObjectBased="True" />
    <rule ID="IsMonthlyAmountEntered" sfwMessageId="4747" sfwExpression="(this.icdoPaymentElectionAdjustment.repayment_type_value == &quot;INPY&quot;) &amp;&amp; &#xA;(this.icdoPaymentElectionAdjustment.monthly_amount &lt;= 0)" sfwObjectBased="True" />
    <rule ID="IsMonthlyAmountGreaterThanBenefitAmount" sfwMessageId="4748" sfwExpression="(this.IsMonthlyAmountGreaterThanBenefitAmount() == True)" sfwObjectBased="True" />
    <rule ID="IsMonthlyAmountGreaterThanTotalAmount" sfwMessageId="4749" sfwExpression="(this.icdoPaymentElectionAdjustment.total_adjustment_amount &lt; this.icdoPaymentElectionAdjustment.monthly_amount)" sfwObjectBased="True" />
    <rule ID="IsPayeeAccountIdNoSelected" sfwMessageId="7094" sfwExpression="(this.icdoPaymentElectionAdjustment.payment_option_value == &quot;PNCH&quot;) &amp;&amp; &#xA;(this.icdoPaymentElectionAdjustment.payee_account_id &lt;= 0)" sfwObjectBased="True" />
    <rule ID="VisibleRuleForApproveAndCancel" sfwExpression="(this.icdoPaymentElectionAdjustment.status_value == &quot;PEND&quot;) &amp;&amp; &#xA;!(this.icdoPaymentElectionAdjustment.modified_by == RFunc.GetValue&lt;String&gt;(this, &quot;iobjPassInfo.istrUserID&quot;))" sfwObjectBased="True" />
    <rule ID="VisibleRuleForSave" sfwExpression="(string.IsNullOrEmpty(this.icdoPaymentElectionAdjustment.status_value)) || &#xA;(this.icdoPaymentElectionAdjustment.status_value == &quot;PEND&quot;)" sfwObjectBased="True" />
  </rules>
  <delete />
  <checklist />
  <initialload>
    <item ID="VisibleRuleForApproveAndCancel" sfwMode="All" sfwStatus="Active" />
    <item ID="VisibleRuleForSave" sfwMode="All" sfwStatus="Active" />
  </initialload>
  <softerror />
  <harderror>
    <item ID="IsPayeeAccountIdNoSelected" sfwMode="All" sfwStatus="Active" />
    <item ID="IsInvalidPayeeAccount" sfwMode="All" sfwStatus="Active" />
    <item ID="IsMonthlyAmountEntered" sfwMode="All" sfwStatus="Active" />
    <item ID="IsMonthlyAmountGreaterThanBenefitAmount" sfwMode="All" sfwStatus="Active" />
    <item ID="IsMonthlyAmountGreaterThanTotalAmount" sfwMode="All" sfwStatus="Active" />
  </harderror>
  <validatedelete />
  <groupslist />
  <updateablecdo />
  <commonproperties>
    <item ID="person_id" sfwObjectField="ibusPersonAccount.icdoPersonAccount.person_id" />
  </commonproperties>
  <expressionfields />
  <queries>
    <query ID="LookUp" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT * FROM SGT_PAYMENT_ELECTION_ADJUSTMENT A WITH(NOLOCK)">
      <parameters />
    </query>
    <query ID="LookUpSubQueryPerson" sfwQueryType="SubSelectQuery" sfwSql="SELECT * FROM SGT_PERSON_ACCOUNT P WHERE A.PERSON_ACCOUNT_ID = P.PERSON_ACCOUNT_ID">
      <parameters />
    </query>
    <query ID="LoadApprovedInPaymentRequests" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT ADJ.*,ACCT.PERSON_ID&#xD;&#xA;FROM SGT_PERSON_ACCOUNT ACCT WITH(NOLOCK)&#xD;&#xA; INNER JOIN SGT_PAYMENT_ELECTION_ADJUSTMENT ADJ WITH(NOLOCK)&#xD;&#xA;  ON ADJ.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID&#xD;&#xA; INNER JOIN SGT_PLAN PL WITH(NOLOCK)&#xD;&#xA;  ON ACCT.PLAN_ID = PL.PLAN_ID  AND PL.PLAN_ID != 9&#xD;&#xA;WHERE ADJ.STATUS_VALUE IN ('APRD','IPAY')&#xD;&#xA; --AND ISNULL(ACCT.END_DATE,GETDATE()) &gt;= GETDATE()&#xD;&#xA; AND PL.BENEFIT_TYPE_VALUE = 'INSR'&#xD;&#xA; AND ACCT.PLAN_PARTICIPATION_STATUS_VALUE IN ('ENL2','SUS3')&#xD;&#xA;&#xD;&#xA;UNION ALL&#xD;&#xA;&#xD;&#xA;SELECT ADJ.*,PAM.MEMBER_PERSON_ID&#xD;&#xA;FROM SGT_PERSON_ACCOUNT ACCT WITH(NOLOCK)&#xD;&#xA; INNER JOIN SGT_PAYMENT_ELECTION_ADJUSTMENT ADJ WITH(NOLOCK)&#xD;&#xA;  ON ADJ.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID&#xD;&#xA; INNER JOIN SGT_PLAN PL WITH(NOLOCK)&#xD;&#xA;  ON ACCT.PLAN_ID = PL.PLAN_ID  AND PL.PLAN_ID = 9&#xD;&#xA;  INNER JOIN &#xD;&#xA;  (&#xD;&#xA;&#x9; SELECT PERSON_ACCOUNT_ID, MEMBER_PERSON_ID&#xD;&#xA;&#x9;&#x9;FROM SGT_PERSON_ACCOUNT_MEDICARE_PART_D_HISTORY&#xD;&#xA;&#x9;&#x9;WHERE END_DATE IS NULL&#xD;&#xA;  )PAM ON PAM.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID&#xD;&#xA;WHERE ADJ.STATUS_VALUE IN ('APRD','IPAY')&#xD;&#xA; --AND ISNULL(ACCT.END_DATE,GETDATE()) &gt;= GETDATE()&#xD;&#xA; AND PL.BENEFIT_TYPE_VALUE = 'INSR'&#xD;&#xA; AND ACCT.PLAN_PARTICIPATION_STATUS_VALUE IN ('ENL2','SUS3')">
      <parameters />
    </query>
    <query ID="UpdatePAPITAmount" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="DECLARE @NEXTBENEFITPAYMENTDATE DATETIME&#xD;&#xA;SELECT @NEXTBENEFITPAYMENTDATE = DATEADD(M,1,MAX(PAYMENT_DATE)) FROM SGT_PAYMENT_SCHEDULE WHERE SCHEDULE_TYPE_VALUE = 'MTLY'&#xD;&#xA; &#xD;&#xA;SELECT PAPIT.*,DUE.BALANCE_AMOUNT INTO #TEMP&#xD;&#xA;FROM SGT_PERSON_ACCOUNT ACCT WITH(NOLOCK)&#xD;&#xA; INNER JOIN (SELECT PERSON_ACCOUNT_ID,STATUS_VALUE,PAYMENT_OPTION_VALUE,PAYEE_ACCOUNT_ID,PROVIDER_ORG_ID&#xD;&#xA;    FROM SGT_PAYMENT_ELECTION_ADJUSTMENT WITH(NOLOCK)&#xD;&#xA;    WHERE STATUS_VALUE = 'IPAY' AND PAYMENT_OPTION_VALUE = 'PNCH'&#xD;&#xA;    GROUP BY PERSON_ACCOUNT_ID,STATUS_VALUE,PAYMENT_OPTION_VALUE,PAYEE_ACCOUNT_ID,PROVIDER_ORG_ID) ADJ&#xD;&#xA;  ON ADJ.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID&#xD;&#xA; INNER JOIN SGT_PLAN PL WITH(NOLOCK)&#xD;&#xA;  ON ACCT.PLAN_ID = PL.PLAN_ID &#xD;&#xA; INNER JOIN (&#xD;&#xA;     SELECT &#xD;&#xA;      CASE WHEN TRANSACTION_TYPE_VALUE IN ('IBSP','RIBS') THEN '1'&#xD;&#xA;         WHEN TRANSACTION_TYPE_VALUE IN ('IBAP','AIBS') THEN '2'&#xD;&#xA;         ELSE '0' END AS REC_ORDER,&#xD;&#xA;      ACCT.PLAN_ID,CONTR.PERSON_ACCOUNT_ID,CONTR.PROVIDER_ORG_ID,&#xD;&#xA;       SUM(ISNULL(CONTR.DUE_PREMIUM_AMOUNT,0)) &#xD;&#xA;       - SUM(ISNULL(CONTR.PAID_PREMIUM_AMOUNT,0)) AS BALANCE_AMOUNT&#xD;&#xA;      FROM SGT_PERSON_ACCOUNT_INSURANCE_CONTRIBUTION CONTR WITH(NOLOCK)&#xD;&#xA;       INNER JOIN SGT_PERSON_ACCOUNT ACCT WITH(NOLOCK)&#xD;&#xA;        ON CONTR.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID&#xD;&#xA;       --INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION ELEC WITH(NOLOCK) --PROD PIR 5413&#xD;&#xA;       -- ON ELEC.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID&#xD;&#xA;       INNER JOIN SGT_PLAN PL WITH(NOLOCK)&#xD;&#xA;        ON ACCT.PLAN_ID = PL.PLAN_ID&#xD;&#xA;      WHERE &#xD;&#xA;       CASE WHEN TRANSACTION_TYPE_VALUE IN ('IBSP','RIBS') THEN '1'&#xD;&#xA;         WHEN TRANSACTION_TYPE_VALUE IN ('IBAP','AIBS') THEN '2'&#xD;&#xA;         ELSE '0' END  = '2' &#xD;&#xA;       --AND (ELEC.IBS_FLAG='Y' OR ELEC.IBS_SUPPLEMENTAL_FLAG='Y')&#xD;&#xA;       --AND ISNULL(ACCT.END_DATE,@RUNDATE) &gt;= @RUNDATE&#xD;&#xA;       AND PL.BENEFIT_TYPE_VALUE = 'INSR'&#xD;&#xA;       AND ACCT.PLAN_PARTICIPATION_STATUS_VALUE IN ('ENL2','SUS3')&#xD;&#xA;      GROUP BY &#xD;&#xA;      CASE WHEN TRANSACTION_TYPE_VALUE IN ('IBSP','RIBS') THEN '1'&#xD;&#xA;         WHEN TRANSACTION_TYPE_VALUE IN ('IBAP','AIBS') THEN '2'&#xD;&#xA;         ELSE '0' END,&#xD;&#xA;       CONTR.PERSON_ACCOUNT_ID,ACCT.PLAN_ID,CONTR.PROVIDER_ORG_ID&#xD;&#xA;      HAVING SUM(ISNULL(CONTR.DUE_PREMIUM_AMOUNT,0)) &#xD;&#xA;       - SUM(ISNULL(CONTR.PAID_PREMIUM_AMOUNT,0)) &gt;= 0&#xD;&#xA;    ) DUE&#xD;&#xA;  ON DUE.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID AND DUE.PROVIDER_ORG_ID = ADJ.PROVIDER_ORG_ID&#xD;&#xA; INNER JOIN SGS_CODE_VALUE CV&#xD;&#xA;  ON CV.CODE_ID = 1711 and CV.DATA2 = ACCT.PLAN_ID&#xD;&#xA; INNER JOIN SGT_PAYMENT_ITEM_TYPE PIT&#xD;&#xA;  ON PIT.ITEM_TYPE_CODE = CV.DATA1 &#xD;&#xA; INNER JOIN SGT_PAYEE_ACCOUNT_PAYMENT_ITEM_TYPE PAPIT&#xD;&#xA;  ON PAPIT.PAYEE_ACCOUNT_ID = ADJ.PAYEE_ACCOUNT_ID AND PAPIT.PAYMENT_ITEM_TYPE_ID = PIT.PAYMENT_ITEM_TYPE_ID&#xD;&#xA;   AND PAPIT.VENDOR_ORG_ID = ADJ.PROVIDER_ORG_ID&#xD;&#xA;  AND PAPIT.END_DATE IS NULL&#xD;&#xA;WHERE --ISNULL(ACCT.END_DATE,@RUNDATE) &gt;= @RUNDATE AND&#xD;&#xA;  PL.BENEFIT_TYPE_VALUE = 'INSR'&#xD;&#xA; AND ACCT.PLAN_PARTICIPATION_STATUS_VALUE IN ('ENL2','SUS3')&#xD;&#xA; AND DUE.BALANCE_AMOUNT &lt; PAPIT.AMOUNT&#xD;&#xA; &#xD;&#xA;--END DATING THE EXISTING ITEM IN PAPIT&#xD;&#xA;UPDATE PAPIT&#xD;&#xA;SET PAPIT.END_DATE = CASE WHEN PAPIT.START_DATE &lt; @NEXTBENEFITPAYMENTDATE THEN CONVERT(VARCHAR(10),DATEADD(S,-1,@NEXTBENEFITPAYMENTDATE),120)&#xD;&#xA;      ELSE NULL END,&#xD;&#xA;PAPIT.AMOUNT = CASE WHEN PAPIT.START_DATE &lt; @NEXTBENEFITPAYMENTDATE THEN PAPIT.AMOUNT&#xD;&#xA;      ELSE A.BALANCE_AMOUNT END,&#xD;&#xA;PAPIT.MODIFIED_BY = 'PERSLink Batch'+' '+ convert(nvarchar,@batchscheduleid),&#xD;&#xA;PAPIT.MODIFIED_DATE = GETDATE(),&#xD;&#xA;PAPIT.UPDATE_SEQ = PAPIT.UPDATE_SEQ + 1&#xD;&#xA;FROM SGT_PAYEE_ACCOUNT_PAYMENT_ITEM_TYPE PAPIT&#xD;&#xA;INNER JOIN #TEMP A&#xD;&#xA; ON A.PAYEE_ACCOUNT_PAYMENT_ITEM_TYPE_ID = PAPIT.PAYEE_ACCOUNT_PAYMENT_ITEM_TYPE_ID&#xD;&#xA; &#xD;&#xA;--Delete the future dated zero amount records&#xD;&#xA;DELETE PAPIT&#xD;&#xA;FROM SGT_PAYEE_ACCOUNT_PAYMENT_ITEM_TYPE PAPIT&#xD;&#xA;INNER JOIN #TEMP A&#xD;&#xA; ON A.PAYEE_ACCOUNT_PAYMENT_ITEM_TYPE_ID = PAPIT.PAYEE_ACCOUNT_PAYMENT_ITEM_TYPE_ID&#xD;&#xA; AND PAPIT.AMOUNT = 0&#xD;&#xA; &#xD;&#xA;----CREATING NEW ENTRY&#xD;&#xA;INSERT INTO SGT_PAYEE_ACCOUNT_PAYMENT_ITEM_TYPE&#xD;&#xA; (PAYEE_ACCOUNT_ID, PAYMENT_ITEM_TYPE_ID, ACCOUNT_NUMBER, VENDOR_ORG_ID,AMOUNT,START_DATE,END_DATE,&#xD;&#xA; CREATED_BY, CREATED_DATE, MODIFIED_BY, MODIFIED_DATE, UPDATE_SEQ)&#xD;&#xA;SELECT A.PAYEE_ACCOUNT_ID,A.PAYMENT_ITEM_TYPE_ID,A.ACCOUNT_NUMBER,A.VENDOR_ORG_ID,A.BALANCE_AMOUNT,@NEXTBENEFITPAYMENTDATE,&#xD;&#xA; A.END_DATE,'PERSLink Batch'+' '+ convert(nvarchar,@batchscheduleid),GETDATE(),'PERSLink Batch'+' '+ convert(nvarchar,@batchscheduleid),GETDATE(),0&#xD;&#xA;FROM #TEMP A &#xD;&#xA;INNER JOIN SGT_PAYEE_ACCOUNT_PAYMENT_ITEM_TYPE PAPIT&#xD;&#xA; ON A.PAYEE_ACCOUNT_PAYMENT_ITEM_TYPE_ID = PAPIT.PAYEE_ACCOUNT_PAYMENT_ITEM_TYPE_ID&#xD;&#xA;WHERE A.BALANCE_AMOUNT &gt; 0&#xD;&#xA;AND PAPIT.START_DATE &lt; @NEXTBENEFITPAYMENTDATE&#xD;&#xA;&#xD;&#xA;DROP TABLE #TEMP">
      <parameters>
        <parameter ID="@RUNDATE" sfwDataType="DateTime" />
        <parameter ID="@batchscheduleid" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="UpdateRequestToCompleted" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="UPDATE ADJ&#xD;&#xA;SET ADJ.STATUS_VALUE = 'COMT'&#xD;&#xA;FROM SGT_PERSON_ACCOUNT ACCT  &#xD;&#xA; INNER JOIN SGT_PAYMENT_ELECTION_ADJUSTMENT ADJ  &#xD;&#xA;  ON ADJ.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID AND ADJ.STATUS_VALUE = 'IPAY'&#xD;&#xA; INNER JOIN SGT_PLAN PL  &#xD;&#xA;  ON ACCT.PLAN_ID = PL.PLAN_ID &#xD;&#xA; INNER JOIN (&#xD;&#xA;    SELECT ACCT.PLAN_ID,CONTR.PERSON_ACCOUNT_ID,CONTR.PROVIDER_ORG_ID,&#xD;&#xA;     SUM(ISNULL(CONTR.DUE_PREMIUM_AMOUNT,0)) &#xD;&#xA;     - SUM(ISNULL(CONTR.PAID_PREMIUM_AMOUNT,0)) AS BALANCE_AMOUNT&#xD;&#xA;    FROM SGT_PERSON_ACCOUNT_INSURANCE_CONTRIBUTION CONTR  &#xD;&#xA;     INNER JOIN SGT_PERSON_ACCOUNT ACCT  &#xD;&#xA;      ON CONTR.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID&#xD;&#xA;     --INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION ELEC  --PROD PIR 5413&#xD;&#xA;     -- ON ELEC.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID&#xD;&#xA;     INNER JOIN SGT_PLAN PL  &#xD;&#xA;      ON ACCT.PLAN_ID = PL.PLAN_ID&#xD;&#xA;    WHERE --(ELEC.IBS_FLAG='Y' OR ELEC.IBS_SUPPLEMENTAL_FLAG='Y')&#xD;&#xA;     --AND ISNULL(ACCT.END_DATE,@RUNDATE) &gt;= @RUNDATE&#xD;&#xA;     --AND &#xD;&#xA;     PL.BENEFIT_TYPE_VALUE = 'INSR'&#xD;&#xA;     AND ACCT.PLAN_PARTICIPATION_STATUS_VALUE IN ('ENL2','SUS3')&#xD;&#xA;    GROUP BY CONTR.PERSON_ACCOUNT_ID,ACCT.PLAN_ID,CONTR.PROVIDER_ORG_ID&#xD;&#xA;    HAVING SUM(ISNULL(CONTR.DUE_PREMIUM_AMOUNT,0)) &#xD;&#xA;     - SUM(ISNULL(CONTR.PAID_PREMIUM_AMOUNT,0)) = 0&#xD;&#xA;    ) DUE&#xD;&#xA;  ON DUE.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID AND DUE.PROVIDER_ORG_ID = ADJ.PROVIDER_ORG_ID&#xD;&#xA;WHERE --ISNULL(ACCT.END_DATE,@RUNDATE) &gt;= @RUNDATE AND&#xD;&#xA;  PL.BENEFIT_TYPE_VALUE = 'INSR'&#xD;&#xA; AND ACCT.PLAN_PARTICIPATION_STATUS_VALUE IN ('ENL2','SUS3')">
      <parameters>
        <parameter ID="@RUNDATE" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="rptPremiumAdjustmentReceivable" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT   PER.PERSON_ID,PER.LAST_NAME,PER.FIRST_NAME,ADJ.TOTAL_ADJUSTMENT_AMOUNT,&#xD;&#xA;    SUM(CASE WHEN CONTR.TRANSACTION_TYPE_VALUE = 'IBAP' THEN CONTR.PAID_PREMIUM_AMOUNT ELSE 0 END) AS PAID_AMOUNT,&#xD;&#xA;    MAX(CASE WHEN CONTR.TRANSACTION_TYPE_VALUE = 'IBAP' THEN CONTR.TRANSACTION_DATE ELSE NULL END) AS LAST_PAYMENT_DATE&#xD;&#xA;FROM   SGT_PAYMENT_ELECTION_ADJUSTMENT ADJ WITH(NOLOCK)&#xD;&#xA;INNER JOIN  SGT_PERSON_ACCOUNT ACCT WITH(NOLOCK)&#xD;&#xA;   ON ADJ.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID&#xD;&#xA;INNER JOIN  SGT_PERSON PER WITH(NOLOCK)&#xD;&#xA;   ON ACCT.PERSON_ID = PER.PERSON_ID&#xD;&#xA;INNER JOIN  SGT_PERSON_ACCOUNT_INSURANCE_CONTRIBUTION CONTR WITH(NOLOCK)&#xD;&#xA;   ON CONTR.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID AND ADJ.PROVIDER_ORG_ID = CONTR.PROVIDER_ORG_ID&#xD;&#xA;INNER JOIN  SGT_PLAN PLN WITH(NOLOCK)&#xD;&#xA;   ON ACCT.PLAN_ID = PLN.PLAN_ID&#xD;&#xA;WHERE   ADJ.STATUS_VALUE NOT IN ('CNLD','COMT')&#xD;&#xA;   AND ISNULL(ACCT.END_DATE,GETDATE()) &gt;= GETDATE()&#xD;&#xA;   AND PLN.BENEFIT_TYPE_VALUE = 'INSR'&#xD;&#xA;   AND ACCT.PLAN_PARTICIPATION_STATUS_VALUE = 'ENL2'&#xD;&#xA;GROUP BY  PER.PERSON_ID,PER.LAST_NAME,PER.FIRST_NAME,ADJ.TOTAL_ADJUSTMENT_AMOUNT&#xD;&#xA;ORDER BY  PER.PERSON_ID,PER.FIRST_NAME,PER.LAST_NAME">
      <parameters />
    </query>
    <query ID="GetAdjustmentPendingForPerson" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT PER.PERSON_ID,SUM(ISNULL(MONTHLY_AMOUNT,0)) AS MONTHLY_AMOUNT&#xD;&#xA;FROM SGT_PERSON_ACCOUNT ACCT WITH(NOLOCK)&#xD;&#xA; INNER JOIN SGT_PAYMENT_ELECTION_ADJUSTMENT ADJ WITH(NOLOCK)&#xD;&#xA;  ON ADJ.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID&#xD;&#xA; INNER JOIN SGT_PERSON PER WITH(NOLOCK)&#xD;&#xA;  ON ACCT.PERSON_ID = PER.PERSON_ID &#xD;&#xA;WHERE ADJ.STATUS_VALUE = 'PEND'&#xD;&#xA; AND PER.PERSON_ID = @PERSONID&#xD;&#xA; GROUP BY PER.PERSON_ID">
      <parameters>
        <parameter ID="@PERSONID" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="LoadApprovedRequestsForPersonAccount" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="--not used&#xD;&#xA;SELECT ADJ.*&#xD;&#xA;FROM SGT_PERSON_ACCOUNT ACCT WITH(NOLOCK)&#xD;&#xA; INNER JOIN SGT_PAYMENT_ELECTION_ADJUSTMENT ADJ WITH(NOLOCK)&#xD;&#xA;  ON ADJ.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID&#xD;&#xA; INNER JOIN SGT_PLAN PL WITH(NOLOCK)&#xD;&#xA;  ON ACCT.PLAN_ID = PL.PLAN_ID &#xD;&#xA;WHERE ADJ.STATUS_VALUE = 'APRD'&#xD;&#xA; --AND ISNULL(ACCT.END_DATE,GETDATE()) &gt;= GETDATE()&#xD;&#xA; AND PL.BENEFIT_TYPE_VALUE = 'INSR'&#xD;&#xA; AND ACCT.PLAN_PARTICIPATION_STATUS_VALUE IN ('ENL2','SUS3')&#xD;&#xA; AND ACCT.PERSON_ACCOUNT_ID = @PERSONACCOUNTID">
      <parameters>
        <parameter ID="@PERSONACCOUNTID" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="LoadPAPIT" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="--not used&#xD;&#xA;SELECT PAPIT.*,ISNULL(DUE.BALANCE_AMOUNT,0.0) AS BALANCE_AMOUNT&#xD;&#xA;FROM SGT_PERSON_ACCOUNT ACCT WITH(NOLOCK)&#xD;&#xA; INNER JOIN (SELECT PERSON_ACCOUNT_ID,STATUS_VALUE,PAYMENT_OPTION_VALUE,PAYEE_ACCOUNT_ID,PROVIDER_ORG_ID&#xD;&#xA;    FROM SGT_PAYMENT_ELECTION_ADJUSTMENT WITH(NOLOCK)&#xD;&#xA;    WHERE STATUS_VALUE = 'IPAY' AND PAYMENT_OPTION_VALUE = 'PNCH'&#xD;&#xA;    GROUP BY PERSON_ACCOUNT_ID,STATUS_VALUE,PAYMENT_OPTION_VALUE,PAYEE_ACCOUNT_ID,PROVIDER_ORG_ID) ADJ&#xD;&#xA;  ON ADJ.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID&#xD;&#xA; INNER JOIN SGT_PLAN PL WITH(NOLOCK)&#xD;&#xA;  ON ACCT.PLAN_ID = PL.PLAN_ID &#xD;&#xA; INNER JOIN (&#xD;&#xA;     SELECT &#xD;&#xA;      CASE WHEN TRANSACTION_TYPE_VALUE IN ('IBSP','RIBS') THEN '1'&#xD;&#xA;         WHEN TRANSACTION_TYPE_VALUE IN ('IBAP','AIBS') THEN '2'&#xD;&#xA;         ELSE '0' END AS REC_ORDER,&#xD;&#xA;      ACCT.PLAN_ID,CONTR.PERSON_ACCOUNT_ID,CONTR.PROVIDER_ORG_ID,&#xD;&#xA;       SUM(ISNULL(CONTR.DUE_PREMIUM_AMOUNT,0)) &#xD;&#xA;       - SUM(ISNULL(CONTR.PAID_PREMIUM_AMOUNT,0)) AS BALANCE_AMOUNT&#xD;&#xA;      FROM SGT_PERSON_ACCOUNT_INSURANCE_CONTRIBUTION CONTR WITH(NOLOCK)&#xD;&#xA;       INNER JOIN SGT_PERSON_ACCOUNT ACCT WITH(NOLOCK)&#xD;&#xA;        ON CONTR.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID&#xD;&#xA;       --INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION ELEC WITH(NOLOCK)&#xD;&#xA;       -- ON ELEC.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID&#xD;&#xA;       INNER JOIN SGT_PLAN PL WITH(NOLOCK)&#xD;&#xA;        ON ACCT.PLAN_ID = PL.PLAN_ID&#xD;&#xA;      WHERE &#xD;&#xA;       CASE WHEN TRANSACTION_TYPE_VALUE IN ('IBSP','RIBS') THEN '1'&#xD;&#xA;         WHEN TRANSACTION_TYPE_VALUE IN ('IBAP','AIBS') THEN '2'&#xD;&#xA;         ELSE '0' END  = '2' &#xD;&#xA;       --AND (ELEC.IBS_FLAG='Y' OR ELEC.IBS_SUPPLEMENTAL_FLAG='Y')&#xD;&#xA;       --AND ISNULL(ACCT.END_DATE,@RUNDATE) &gt;= @RUNDATE&#xD;&#xA;       AND PL.BENEFIT_TYPE_VALUE = 'INSR'&#xD;&#xA;       AND ACCT.PLAN_PARTICIPATION_STATUS_VALUE IN ('ENL2','SUS3')&#xD;&#xA;      GROUP BY &#xD;&#xA;      CASE WHEN TRANSACTION_TYPE_VALUE IN ('IBSP','RIBS') THEN '1'&#xD;&#xA;         WHEN TRANSACTION_TYPE_VALUE IN ('IBAP','AIBS') THEN '2'&#xD;&#xA;         ELSE '0' END,&#xD;&#xA;       CONTR.PERSON_ACCOUNT_ID,ACCT.PLAN_ID,CONTR.PROVIDER_ORG_ID&#xD;&#xA;      HAVING SUM(ISNULL(CONTR.DUE_PREMIUM_AMOUNT,0)) &#xD;&#xA;       - SUM(ISNULL(CONTR.PAID_PREMIUM_AMOUNT,0)) &gt; 0&#xD;&#xA;    ) DUE&#xD;&#xA;  ON DUE.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID AND ADJ.PROVIDER_ORG_ID = DUE.PROVIDER_ORG_ID&#xD;&#xA; INNER JOIN SGS_CODE_VALUE CV&#xD;&#xA;  ON CV.CODE_ID = 1711 and CV.DATA2 = ACCT.PLAN_ID&#xD;&#xA; INNER JOIN SGT_PAYMENT_ITEM_TYPE PIT&#xD;&#xA;  ON PIT.ITEM_TYPE_CODE = CV.DATA1 &#xD;&#xA; INNER JOIN SGT_PAYEE_ACCOUNT_PAYMENT_ITEM_TYPE PAPIT&#xD;&#xA;  ON PAPIT.PAYEE_ACCOUNT_ID = ADJ.PAYEE_ACCOUNT_ID AND PAPIT.PAYMENT_ITEM_TYPE_ID = PIT.PAYMENT_ITEM_TYPE_ID&#xD;&#xA;  AND PAPIT.VENDOR_ORG_ID = ADJ.PROVIDER_ORG_ID&#xD;&#xA;  AND @RUNDATE BETWEEN PAPIT.START_DATE AND ISNULL(PAPIT.END_DATE,'99991231')&#xD;&#xA;WHERE PL.BENEFIT_TYPE_VALUE = 'INSR'&#xD;&#xA; AND ACCT.PLAN_PARTICIPATION_STATUS_VALUE IN ('ENL2','SUS3')&#xD;&#xA; AND DUE.BALANCE_AMOUNT &lt; PAPIT.AMOUNT&#xD;&#xA; AND ACCT.PERSON_ACCOUNT_ID = @PERSONACCOUNTID">
      <parameters>
        <parameter ID="@RUNDATE" sfwDataType="DateTime" />
        <parameter ID="@PERSONACCOUNTID" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="UpdateRequestToCompletedForPersonAccount" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="--not used&#xD;&#xA;UPDATE ADJ&#xD;&#xA;SET ADJ.STATUS_VALUE = 'COMT'&#xD;&#xA;FROM SGT_PERSON_ACCOUNT ACCT  &#xD;&#xA; INNER JOIN SGT_PAYMENT_ELECTION_ADJUSTMENT ADJ  &#xD;&#xA;  ON ADJ.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID AND ADJ.STATUS_VALUE = 'IPAY'&#xD;&#xA; INNER JOIN SGT_PLAN PL  &#xD;&#xA;  ON ACCT.PLAN_ID = PL.PLAN_ID &#xD;&#xA; INNER JOIN (&#xD;&#xA;    SELECT ACCT.PLAN_ID,CONTR.PERSON_ACCOUNT_ID,CONTR.PROVIDER_ORG_ID,&#xD;&#xA;     SUM(ISNULL(CONTR.DUE_PREMIUM_AMOUNT,0)) &#xD;&#xA;     - SUM(ISNULL(CONTR.PAID_PREMIUM_AMOUNT,0)) AS BALANCE_AMOUNT&#xD;&#xA;    FROM SGT_PERSON_ACCOUNT_INSURANCE_CONTRIBUTION CONTR  &#xD;&#xA;     INNER JOIN SGT_PERSON_ACCOUNT ACCT  &#xD;&#xA;      ON CONTR.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID&#xD;&#xA;     --INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION ELEC  &#xD;&#xA;     -- ON ELEC.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID&#xD;&#xA;     INNER JOIN SGT_PLAN PL  &#xD;&#xA;      ON ACCT.PLAN_ID = PL.PLAN_ID&#xD;&#xA;    WHERE PL.BENEFIT_TYPE_VALUE = 'INSR'&#xD;&#xA;     AND ACCT.PLAN_PARTICIPATION_STATUS_VALUE IN ('ENL2','SUS3')&#xD;&#xA;    GROUP BY CONTR.PERSON_ACCOUNT_ID,ACCT.PLAN_ID,CONTR.PROVIDER_ORG_ID&#xD;&#xA;    HAVING SUM(ISNULL(CONTR.DUE_PREMIUM_AMOUNT,0)) &#xD;&#xA;     - SUM(ISNULL(CONTR.PAID_PREMIUM_AMOUNT,0)) = 0&#xD;&#xA;    ) DUE&#xD;&#xA;  ON DUE.PERSON_ACCOUNT_ID = ACCT.PERSON_ACCOUNT_ID AND ADJ.PROVIDER_ORG_ID = DUE.PROVIDER_ORG_ID&#xD;&#xA;WHERE PL.BENEFIT_TYPE_VALUE = 'INSR'&#xD;&#xA; AND ACCT.PLAN_PARTICIPATION_STATUS_VALUE IN ('ENL2','SUS3')&#xD;&#xA; AND ACCT.PERSON_ACCOUNT_ID = @PERSONACCOUNTID">
      <parameters>
        <parameter ID="@PERSONACCOUNTID" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="LoadApprovedInpayRequests" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT *&#xD;&#xA;FROM SGT_PAYMENT_ELECTION_ADJUSTMENT WITH(NOLOCK)&#xD;&#xA;WHERE STATUS_VALUE IN ('APRD','IPAY')">
      <parameters />
    </query>
    <query ID="LoadAllPAPIT" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT PAPIT.*&#xD;&#xA;FROM SGT_PAYEE_ACCOUNT_PAYMENT_ITEM_TYPE PAPIT&#xD;&#xA;INNER JOIN SGT_PAYMENT_ITEM_TYPE PIT &#xD;&#xA; ON PAPIT.PAYMENT_ITEM_TYPE_ID = PIT.PAYMENT_ITEM_TYPE_ID&#xD;&#xA;INNER JOIN SGS_CODE_VALUE CV&#xD;&#xA; ON ISNULL(CV.DATA1,'') = PIT.ITEM_TYPE_CODE AND CV.CODE_ID = 1711&#xD;&#xA;WHERE PAPIT.END_DATE IS NULL">
      <parameters />
    </query>
  </queries>
  <attributes>
    <attribute ID="PaymentElectionAdjustmentId" sfwType="Column" sfwValue="payment_election_adjustment_id" sfwKeyNo="1" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="True" sfwDataType="int" sfwRequired="False" />
    <attribute ID="IbsHeaderId" sfwType="Column" sfwValue="ibs_header_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="PersonAccountId" sfwType="Column" sfwValue="person_account_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="PayeeAccountId" sfwType="Column" sfwValue="payee_account_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="PaymentOptionDescription" sfwType="Description" sfwValue="payment_option_description" />
    <attribute ID="PaymentOptionId" sfwType="Column" sfwValue="payment_option_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="1703" sfwDataType="int" sfwRequired="False" />
    <attribute ID="PaymentOptionValue" sfwType="Column" sfwValue="payment_option_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="RepaymentTypeDescription" sfwType="Description" sfwValue="repayment_type_description" />
    <attribute ID="RepaymentTypeId" sfwType="Column" sfwValue="repayment_type_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="1709" sfwDataType="int" sfwRequired="False" />
    <attribute ID="RepaymentTypeValue" sfwType="Column" sfwValue="repayment_type_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="StatusDescription" sfwType="Description" sfwValue="status_description" />
    <attribute ID="StatusId" sfwType="Column" sfwValue="status_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="1710" sfwDataType="int" sfwRequired="False" />
    <attribute ID="StatusValue" sfwType="Column" sfwValue="status_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="TotalAdjustmentAmount" sfwType="Column" sfwValue="total_adjustment_amount" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,2" />
    <attribute ID="MonthlyAmount" sfwType="Column" sfwValue="monthly_amount" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,2" />
    <attribute ID="ApprovedDate" sfwType="Column" sfwValue="approved_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="CreatedBy" sfwType="Column" sfwValue="created_by" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="50" />
    <attribute ID="CreatedDate" sfwType="Column" sfwValue="created_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="ModifiedBy" sfwType="Column" sfwValue="modified_by" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="50" />
    <attribute ID="ModifiedDate" sfwType="Column" sfwValue="modified_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="UpdateSeq" sfwType="Column" sfwValue="update_seq" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="ProviderOrgId" sfwType="Column" sfwValue="provider_org_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="objPersonAccount" sfwType="Object" sfwEntity="entPersonAccount" sfwValue="ibusPersonAccount" />
    <attribute sfwDataType="decimal" sfwType="Property" ID="IdecTotalPaidAmount" sfwValue="idecTotalPaidAmount" />
    <attribute sfwDataType="decimal" sfwType="Property" ID="IdecTotalChargedPremium" sfwValue="idecTotalChargedPremium" />
    <attribute sfwDataType="decimal" sfwType="Property" ID="IdecTotalCorrectPremium" sfwValue="idecTotalCorrectPremium" />
    <attribute sfwType="Collection" sfwEntity="entIbsDetail" ID="lstIBSDetailGrouped" sfwValue="iclbIBSDetailGrouped" />
  </attributes>
  <objectmethods>
    <method ID="btn_Approve_Click" sfwReturnType="ArrayList" />
    <method ID="btn_Cancel_Click" sfwReturnType="ArrayList" />
  </objectmethods>
</entity>