<?xml version="1.0" encoding="utf-8"?>
<entity ID="entActuaryFilePensionDetail" sfwMainCDO="icdoActuaryFilePensionDetail" sfwType="BusinessRule" sfwActive="True" sfwStatus="Review" sfwObjectID="busActuaryFilePensionDetail" sfwTableName="sgt_actuary_file_pension_detail" sfwView="False">
  <queries>
    <query ID="flePensionFileOut" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="DECLARE @FYST DATETIME &#xD;&#xA;SET @FYST = CAST(CAST(CASE WHEN Month(@PAYMENTDATE) &lt;= 6 THEN YEAR(@PAYMENTDATE) -1 &#xD;&#xA;    ELSE YEAR(@PAYMENTDATE) END AS VARCHAR(4))+'/07/01' AS DATETIME)&#xD;&#xA;&#xD;&#xA;SELECT *  FROM&#xD;&#xA;(&#xD;&#xA;SELECT ACTUARY_FILE_HEADER_ID,PERSON_ID,PAYEE_ACCOUNT_ID,PERSON_ACCOUNT_ID,SSN,ACCOUNT_RELATION_VALUE,&#xD;&#xA;  PLAN_PARTICIPATION_STATUS_VALUE,EMPLOYMENT_STATUS_VALUE,APPLICATION_STATUS_VALUE,PAYEE_STATUS_VALUE,&#xD;&#xA;  EMPLOYMENT_TYPE_VALUE,HOURLY_VALUE,SEASONAL_VALUE,LAST_NAME,FIRST_NAME,MARITAL_STATUS_VALUE,DATE_OF_BIRTH,&#xD;&#xA;  PLAN_PARTICIPATION_START_DATE,BENEFIT_OPTION_VALUE,&#xD;&#xA;  ISNULL(PENSION_SERVICE_CREDIT,0.00) AS PENSION_SERVICE_CREDIT,&#xD;&#xA;  ISNULL(TOTAL_VESTED_SERVICE_CREDIT,0.00) as TOTAL_VESTED_SERVICE_CREDIT,&#xD;&#xA;  RETIREMENT_DATE,SPOUSE_DOB,&#xD;&#xA;  JOINT_ANNUITANT_DOB,MEMBERGENDER,SPOUSEGENDER,PLAN_ID,PLAN_NAME,ORG_ID,ORG_CODE,&#xD;&#xA;  ISNULL(TOTAL_SALARY,0.00) AS TOTAL_SALARY,&#xD;&#xA;  ISNULL(ACCOUNT_BALANCE,0.00) AS ACCOUNT_BALANCE ,&#xD;&#xA;  ISNULL(PENSION_SERVICE_CREDIT_BA,0.00) AS PENSION_SERVICE_CREDIT_BA,&#xD;&#xA;  ISNULL(TOTAL_VESTED_SERVICE_CREDIT_BA,0.00) AS TOTAL_VESTED_SERVICE_CREDIT_BA,&#xD;&#xA;  ISNULL(ACCRUED_BENEFIT_CALCULATION,0.00) AS ACCRUED_BENEFIT_CALCULATION,&#xD;&#xA;  ISNULL(MINIMUM_GUARANTEE_AMOUNT,0.00) AS MINIMUM_GUARANTEE_AMOUNT,&#xD;&#xA;  ISNULL(GROSS_CURRENT_MONTHLY_BENEFIT_AMOUNT,0.00) AS GROSS_CURRENT_MONTHLY_BENEFIT_AMOUNT,&#xD;&#xA;  ISNULL(AMOUNT_PAID_LTD,0.00) AS AMOUNT_PAID_LTD,&#xD;&#xA;  PURCHASED_SERVICE_CREDIT_SUM,SSLI_OR_UNIFORM_INCOME_COMMENCEMENT_AGE,PLAN_CODE,PAYEE_STATUS_EFFECTIVE_DATE,&#xD;&#xA;  ISNULL(ESTIMATED_SSLI_BENEFIT_AMOUNT,0.00) as ESTIMATED_SSLI_BENEFIT_AMOUNT,&#xD;&#xA;  OPTION_FACTOR,&#xD;&#xA;  ISNULL(VESTED_ER_AMOUNT,0.00) AS VESTED_ER_AMOUNT,SSLI_CHANGE_DATE,&#xD;&#xA;  ISNULL(TRAVELLERS_BASE_BENEFIT_AMOUNT,0.00) AS TRAVELLERS_BASE_BENEFIT_AMOUNT,&#xD;&#xA;  ISNULL(TRAVELLERS_CUMULATIVE_COLA_AMOUNT,0.00) AS TRAVELLERS_CUMULATIVE_COLA_AMOUNT,&#xD;&#xA;  ROWRANK,EMPLOYMENT_START_DATE,EMPLOYMENT_END_DATE, PAYEE_STATUS_DATA2,PAYEE_ACCT_EXISTS&#xD;&#xA;  ,TOTCTR,EHCTR,EDCTR,&#xD;&#xA;  ISNULL(CAST(TFFR_TIAA_SERVICE AS DECIMAL(9,2)),0.00) AS TFFR_TIAA_SERVICE,&#xD;&#xA;  EMP_DT_CHK, GRADUATED_BENEFIT_OPTION_VALUE&#xD;&#xA;FROM(  &#xD;&#xA;SELECT @HEADERID AS ACTUARY_FILE_HEADER_ID,A.PERSON_ID,NULL AS PAYEE_ACCOUNT_ID,A.PERSON_ACCOUNT_ID,P.SSN,NULL AS ACCOUNT_RELATION_VALUE,&#xD;&#xA;         PARH.PLAN_PARTICIPATION_STATUS_VALUE AS PLAN_PARTICIPATION_STATUS_VALUE,&#xD;&#xA;   CASE WHEN (TOTCTR = EHCTR) OR (TOTCTR = EDCTR) or PED.STATUS_VALUE is null&#xD;&#xA;    THEN'TERM'&#xD;&#xA;    ELSE PED.STATUS_VALUE END &#xD;&#xA;    AS EMPLOYMENT_STATUS_VALUE,&#xD;&#xA;         BA.ACTION_STATUS_VALUE AS APPLICATION_STATUS_VALUE,NULL AS PAYEE_STATUS_VALUE,PED.TYPE_VALUE AS EMPLOYMENT_TYPE_VALUE,PED.HOURLY_VALUE AS HOURLY_VALUE,&#xD;&#xA;         PED.SEASONAL_VALUE AS SEASONAL_VALUE,P.LAST_NAME,P.FIRST_NAME,P.MARITAL_STATUS_VALUE AS MARITAL_STATUS_VALUE,P.DATE_OF_BIRTH,&#xD;&#xA;         A.START_DATE AS PLAN_PARTICIPATION_START_DATE,NULL AS BENEFIT_OPTION_VALUE,&#xD;&#xA;  SUM(PENSION_SERVICE_CREDIT) AS PENSION_SERVICE_CREDIT,SUM(TOTAL_VESTED_SERVICE_CREDIT) AS TOTAL_VESTED_SERVICE_CREDIT,&#xD;&#xA;       NULL RETIREMENT_DATE,SP.DATE_OF_BIRTH AS SPOUSE_DOB,NULL AS JOINT_ANNUITANT_DOB,P.GENDER_VALUE AS MEMBERGENDER,SP.GENDER_VALUE AS SPOUSEGENDER,   &#xD;&#xA;         A.PLAN_ID,B.ACTUARY_NAME AS PLAN_NAME,PED.ORG_ID AS ORG_ID,PED.ORG_CODE,TOTAL_SALARY AS TOTAL_SALARY,(SUM(ACCOUNT_BALANCE)+SUM(ISNULL(PAR.CAPITAL_GAIN,0))) AS ACCOUNT_BALANCE,&#xD;&#xA;         NULL AS PENSION_SERVICE_CREDIT_BA,NULL AS TOTAL_VESTED_SERVICE_CREDIT_BA,NULL AS ACCRUED_BENEFIT_CALCULATION,NULL AS MINIMUM_GUARANTEE_AMOUNT,&#xD;&#xA;         NULL AS GROSS_CURRENT_MONTHLY_BENEFIT_AMOUNT,NULL AS AMOUNT_PAID_LTD,&#xD;&#xA;   SUM(PARC.PURCHASED_SERVICE_CREDIT_SUM) AS PURCHASED_SERVICE_CREDIT_SUM, &#xD;&#xA;   NULL AS SSLI_OR_UNIFORM_INCOME_COMMENCEMENT_AGE,&#xD;&#xA;         NULL AS ESTIMATED_SSLI_BENEFIT_AMOUNT,NULL AS OPTION_FACTOR,SUM(VESTED_ER_AMOUNT) AS VESTED_ER_AMOUNT,NULL SSLI_CHANGE_DATE,&#xD;&#xA;         NULL TRAVELLERS_BASE_BENEFIT_AMOUNT,NULL AS TRAVELLERS_CUMULATIVE_COLA_AMOUNT,PED.START_DATE AS EMPLOYMENT_START_DATE,PED.END_DATE AS EMPLOYMENT_END_DATE,B.PLAN_CODE,NULL AS PAYEE_STATUS_EFFECTIVE_DATE,&#xD;&#xA;   sum(PED.ROWRANK) AS ROWRANK,&#xD;&#xA;   NULL AS PAYEE_STATUS_DATA2, &#xD;&#xA;   Case when PCHK.PERSON_ACCOUNT_ID is null then 'N' Else 'Y' END as PAYEE_ACCT_EXISTS ,&#xD;&#xA;   PEDC.TOTCTR as TOTCTR,PEDC.EHCTR as EHCTR,PEDC.EDCTR as EDCTR,&#xD;&#xA;  sum(TIAATFFR.TFFR_TIAA_SERVICE) as TFFR_TIAA_SERVICE,&#xD;&#xA;  Case  When PARH.PLAN_PARTICIPATION_STATUS_VALUE = 'DSW1' then &#xD;&#xA;    Case when MAX_EMP_END_DATE is null or&#xD;&#xA;      MAX_EMP_END_DATE &gt;= P.DATE_OF_DEATH  then 'EDT_AFT_DTH'&#xD;&#xA;    when MAX_EMP_END_DATE is not null  &#xD;&#xA;     and MAX_EMP_END_DATE &lt; P.DATE_OF_DEATH then 'EDT_BEF_DTH'&#xD;&#xA;    Else null End&#xD;&#xA;   Else Null End  AS EMP_DT_CHK, NULL as GRADUATED_BENEFIT_OPTION_VALUE&#xD;&#xA;FROM SGT_PERSON_ACCOUNT A (NOLOCK)&#xD;&#xA;      INNER JOIN SGT_PLAN B(NOLOCK)&#xD;&#xA;             ON A.PLAN_ID=B.PLAN_ID &#xD;&#xA;      INNER JOIN SGT_PERSON P(NOLOCK)&#xD;&#xA;            ON A.PERSON_ID=P.PERSON_ID&#xD;&#xA;   INNER JOIN SGT_PERSON_ACCOUNT_RETIREMENT PAR(NOLOCK) &#xD;&#xA;   ON A.PERSON_ACCOUNT_ID =PAR.PERSON_ACCOUNT_ID&#xD;&#xA;      left outer JOIN &#xD;&#xA;   ( &#xD;&#xA;    SELECT * FROM &#xD;&#xA;    (&#xD;&#xA;     SELECT PED.*,PE.ORG_ID,EMPL.ORG_CODE,PAED.PERSON_ACCOUNT_ID&#xD;&#xA;     ,RANK() OVER (PARTITION BY PAED.PERSON_ACCOUNT_ID ORDER BY PED.STATUS_VALUE,PE.ORG_ID ) AS ROWRANK &#xD;&#xA;     FROM &#xD;&#xA;     SGT_PERSON_ACCOUNT_EMPLOYMENT_DETAIL PAED(NOLOCK)&#xD;&#xA;      INNER JOIN SGT_PERSON_EMPLOYMENT_DETAIL PED (NOLOCK)&#xD;&#xA;       ON PED.PERSON_EMPLOYMENT_DTL_ID=PAED.PERSON_EMPLOYMENT_DTL_ID&#xD;&#xA;      INNER JOIN SGT_PERSON_EMPLOYMENT PE(NOLOCK)&#xD;&#xA;       ON PE.PERSON_EMPLOYMENT_ID=PED.PERSON_EMPLOYMENT_ID&#xD;&#xA;      INNER JOIN SGT_PLAN P ON PAED.PLAN_ID = P.PLAN_ID&#xD;&#xA;      INNER JOIN SGT_ORGANIZATION EMPL(NOLOCK)&#xD;&#xA;       ON PE.ORG_ID=EMPL.ORG_ID&#xD;&#xA;      WHERE @PAYMENTDATE BETWEEN PED.START_DATE &#xD;&#xA;       AND (CASE WHEN PED.END_DATE IS NULL &#xD;&#xA;        THEN '99991231' ELSE PED.END_DATE END)&#xD;&#xA;       and P.BENEFIT_TYPE_VALUE = 'RETR'  &#xD;&#xA;       and PAED.PERSON_ACCOUNT_ID is not null&#xD;&#xA;    ) AS Temp Where ROWRANK = 1&#xD;&#xA;   ) AS PED&#xD;&#xA;            ON A.PERSON_ACCOUNT_ID =PED.PERSON_ACCOUNT_ID&#xD;&#xA;   INNER JOIN (&#xD;&#xA;   SELECT * FROM SGT_PERSON_ACCOUNT_RETIREMENT_HISTORY  PARH&#xD;&#xA;    WHERE @PAYMENTDATE BETWEEN PARH.START_DATE &#xD;&#xA;     AND (CASE WHEN PARH.END_DATE IS NULL THEN '99991231' ELSE PARH.END_DATE END)&#xD;&#xA;     AND PARH.START_DATE &lt;&gt; CASE WHEN PARH.END_DATE IS NOT NULL &#xD;&#xA;           THEN PARH.END_DATE ELSE '99991231' END&#xD;&#xA;     AND PARH.START_DATE &gt;= CASE WHEN PARH.PLAN_PARTICIPATION_STATUS_VALUE = 'WTN1'&#xD;&#xA;            THEN @FYST ELSE PARH.START_DATE  END&#xD;&#xA;   ) AS PARH&#xD;&#xA;   ON A.PERSON_ACCOUNT_ID = PARH.PERSON_ACCOUNT_ID&#xD;&#xA;   INNER JOIN &#xD;&#xA;   ( &#xD;&#xA;    SELECT &#xD;&#xA;     PAED1.PERSON_ACCOUNT_ID,Count(0) as TOTCTR,&#xD;&#xA;       SUM( CASE WHEN (PE1.END_DATE IS NULL  OR  PE1.END_DATE &gt; @PAYMENTDATE) THEN 0 ELSE 1 END) AS EHCTR,&#xD;&#xA;       SUM( CASE WHEN (PED1.END_DATE IS NULL OR PED1.END_DATE &gt; @PAYMENTDATE) THEN 0 ELSE 1 END) AS EDCTR,&#xD;&#xA;       Max(PE1.END_DATE) AS MAX_EMP_END_DATE&#xD;&#xA;    FROM &#xD;&#xA;    SGT_PERSON_EMPLOYMENT_DETAIL PED1 (NOLOCK)&#xD;&#xA;    INNER JOIN SGT_PERSON_EMPLOYMENT PE1 &#xD;&#xA;     on PED1.PERSON_EMPLOYMENT_ID = PE1.PERSON_EMPLOYMENT_ID&#xD;&#xA;    INNER JOIN SGT_PERSON_ACCOUNT_EMPLOYMENT_DETAIL PAED1(NOLOCK)&#xD;&#xA;     ON PED1.PERSON_EMPLOYMENT_DTL_ID = PAED1.PERSON_EMPLOYMENT_DTL_ID&#xD;&#xA;    INNER JOIN SGT_PLAN P ON PAED1.PLAN_ID = P.PLAN_ID&#xD;&#xA;    WHERE ELECTION_VALUE = 'ENLD' and P.BENEFIT_TYPE_VALUE = 'RETR'&#xD;&#xA;    Group by PAED1.PERSON_ACCOUNT_ID&#xD;&#xA;   ) AS PEDC&#xD;&#xA;   ON PEDC.PERSON_ACCOUNT_ID =A.PERSON_ACCOUNT_ID&#xD;&#xA;      LEFT JOIN SGT_BENEFIT_APPLICATION BA (NOLOCK)&#xD;&#xA;            ON A.PERSON_ID=BA.MEMBER_PERSON_ID &#xD;&#xA;    AND A.PLAN_ID = BA.PLAN_ID&#xD;&#xA;    AND BA.ACTION_STATUS_VALUE='DEFE'&#xD;&#xA;   LEFT OUTER JOIN      &#xD;&#xA;   (&#xD;&#xA;   SELECT PAC.PERSON_ACCOUNT_ID , &#xD;&#xA;    SUM(ISNULL(PENSION_SERVICE_CREDIT,0.00)) AS PENSION_SERVICE_CREDIT,&#xD;&#xA;    SUM(ISNULL(VESTED_SERVICE_CREDIT,0.00)) AS TOTAL_VESTED_SERVICE_CREDIT,&#xD;&#xA;    SUM(ISNULL(CASE WHEN EFFECTIVE_DATE BETWEEN @FYST AND @PAYMENTDATE THEN SALARY_AMOUNT ELSE 0.00 END,0.00)) AS TOTAL_SALARY,&#xD;&#xA;    SUM(ISNULL(POST_TAX_EE_AMOUNT,0.00) + &#xD;&#xA;     ISNULL(PRE_TAX_EE_AMOUNT,0.00) +&#xD;&#xA;     ISNULL(EE_RHIC_AMOUNT,0.00) + &#xD;&#xA;     ISNULL(EE_ER_PICKUP_AMOUNT,0.00) + &#xD;&#xA;     ISNULL(ER_VESTED_AMOUNT,0.00) + &#xD;&#xA;     ISNULL(INTEREST_AMOUNT,0.00)) AS ACCOUNT_BALANCE,&#xD;&#xA;     SUM(ISNULL(ER_VESTED_AMOUNT,0.00)) AS VESTED_ER_AMOUNT,&#xD;&#xA;     SUM( CASE WHEN TRANSACTION_TYPE_VALUE IN ('PADJ','PURC') &#xD;&#xA;       THEN PENSION_SERVICE_CREDIT ELSE 0 END) &#xD;&#xA;      AS  PURCHASED_SERVICE_CREDIT_SUM&#xD;&#xA;   FROM &#xD;&#xA;    SGT_PERSON_ACCOUNT PAC&#xD;&#xA;    INNER JOIN SGT_PERSON_ACCOUNT_RETIREMENT_CONTRIBUTION PARC&#xD;&#xA;     ON PAC.PERSON_ACCOUNT_ID = PARC.PERSON_ACCOUNT_ID&#xD;&#xA;    INNER JOIN &#xD;&#xA;      (&#xD;&#xA;       SELECT DISTINCT PERSON_ACCOUNT_ID  &#xD;&#xA;        FROM SGT_PERSON_ACCOUNT_RETIREMENT_HISTORY  PARH&#xD;&#xA;        WHERE @PAYMENTDATE BETWEEN PARH.START_DATE &#xD;&#xA;         AND (CASE WHEN PARH.END_DATE IS NULL &#xD;&#xA;           THEN '99991231' ELSE PARH.END_DATE END)&#xD;&#xA;         AND PARH.START_DATE &lt;&gt; CASE WHEN PARH.END_DATE IS NOT NULL &#xD;&#xA;           THEN PARH.END_DATE ELSE '99991231' END&#xD;&#xA;         AND PARH.START_DATE &gt;= CASE WHEN PARH.PLAN_PARTICIPATION_STATUS_VALUE = 'WTN1'&#xD;&#xA;           THEN @FYST ELSE PARH.START_DATE  END&#xD;&#xA;         AND PLAN_PARTICIPATION_STATUS_VALUE IN ('ENL1','SUS2')       &#xD;&#xA;      )PPS ON PAC.PERSON_ACCOUNT_ID = PPS.PERSON_ACCOUNT_ID&#xD;&#xA;    WHERE EFFECTIVE_DATE &lt;= @PAYMENTDATE&#xD;&#xA;    GROUP BY PAC.PERSON_ACCOUNT_ID&#xD;&#xA;   ) AS PARC&#xD;&#xA;   ON A.PERSON_ACCOUNT_ID = PARC.PERSON_ACCOUNT_ID&#xD;&#xA;      LEFT JOIN &#xD;&#xA;   (&#xD;&#xA;    SELECT PERSON_ID,CONTACT_PERSON_ID FROM &#xD;&#xA;     SGT_PERSON_CONTACT (NOLOCK) WHERE RELATIONSHIP_VALUE='SPOU' &#xD;&#xA;     AND STATUS_VALUE = 'ACT' AND CONTACT_PERSON_ID IS NOT NULL&#xD;&#xA;   ) AS CONT&#xD;&#xA;            ON P.PERSON_ID=CONT.PERSON_ID &#xD;&#xA;      LEFT JOIN SGT_PERSON SP(NOLOCK)&#xD;&#xA;            ON CONT.CONTACT_PERSON_ID=SP.PERSON_ID&#xD;&#xA;   LEFT OUTER JOIN &#xD;&#xA;  (&#xD;&#xA;     SELECT  &#xD;&#xA;        CASE WHEN PA.APPLICATION_ID IS NOT NULL THEN BAA.PERSON_ACCOUNT_ID &#xD;&#xA;        ELSE DROAP.PERSON_ACCOUNT_ID END AS PERSON_ACCOUNT_ID  &#xD;&#xA;     FROM SGT_PAYEE_ACCOUNT PA (NOLOCK)&#xD;&#xA;     INNER JOIN SGT_PAYEE_ACCOUNT_STATUS PAS (NOLOCK)&#xD;&#xA;     ON PAS.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID &#xD;&#xA;     INNER JOIN SGS_CODE_VALUE CV (NOLOCK)&#xD;&#xA;     ON PAS.STATUS_ID= CV.CODE_ID AND PAS.STATUS_VALUE = CV.CODE_VALUE&#xD;&#xA;     LEFT OUTER JOIN SGT_BENEFIT_CALCULATION CA (NOLOCK)&#xD;&#xA;     ON PA.CALCULATION_ID = CA.BENEFIT_CALCULATION_ID &#xD;&#xA;       LEFT OUTER JOIN &#xD;&#xA;     (&#xD;&#xA;      SELECT BA.BENEFIT_APPLICATION_ID,BAPA.PERSON_ACCOUNT_ID &#xD;&#xA;        FROM SGT_BENEFIT_APPLICATION(NOLOCK) BA &#xD;&#xA;       INNER JOIN SGT_BENEFIT_APPLICATION_PERSON_ACCOUNT(NOLOCK) BAPA &#xD;&#xA;       ON  BA.BENEFIT_APPLICATION_ID = BAPA.BENEFIT_APPLICATION_ID  &#xD;&#xA;       WHERE ISNULL(IS_APPLICATION_PERSON_ACCOUNT_FLAG,'N') = 'Y' AND BA.ACTION_STATUS_VALUE NOT IN ('DENI','CANC')&#xD;&#xA;      ) AS BAA ON PA.APPLICATION_ID = BAA.BENEFIT_APPLICATION_ID&#xD;&#xA;     LEFT OUTER JOIN SGT_BENEFIT_DRO_APPLICATION DROAP (NOLOCK)&#xD;&#xA;     ON PA.DRO_APPLICATION_ID = DROAP.DRO_APPLICATION_ID &#xD;&#xA;&#x9; INNER join SGT_PAYMENT_HISTORY_HEADER PHH&#xD;&#xA;&#x9; on PHH.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID and PHH.PAYMENT_DATE &lt;= @paymentdate --PIR 16078&#xD;&#xA;     WHERE  (PA.BENEFIT_ACCOUNT_TYPE_VALUE='DISA' ) -- OR (CV.DATA2='CNLD' OR  CV.DATA2='TRMD' OR  CV.DATA2='RPCD' OR  CV.DATA2='RECV')&#xD;&#xA;     AND  PAYEE_ACCOUNT_STATUS_ID  = &#xD;&#xA;      (SELECT TOP 1 PAYEE_ACCOUNT_STATUS_ID&#xD;&#xA;      FROM SGT_PAYEE_ACCOUNT_STATUS PAS1 (NOLOCK)&#xD;&#xA;      WHERE PAS1.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID&#xD;&#xA;      AND PAS1.STATUS_EFFECTIVE_DATE &lt;= @PAYMENTDATE&#xD;&#xA;      ORDER BY PAS1.STATUS_EFFECTIVE_DATE DESC,PAS1.PAYEE_ACCOUNT_STATUS_ID DESC&#xD;&#xA;      )&#xD;&#xA;  ) AS PAYEE ON A.PERSON_ACCOUNT_ID=PAYEE.PERSON_ACCOUNT_ID&#xD;&#xA;  LEFT OUTER JOIN &#xD;&#xA;   (&#xD;&#xA;    SELECT Distinct BAA.PERSON_ACCOUNT_ID AS PERSON_ACCOUNT_ID&#xD;&#xA;     FROM SGT_PAYEE_ACCOUNT PA&#xD;&#xA;     INNER JOIN SGT_PAYEE_ACCOUNT_STATUS PAS (NOLOCK)&#xD;&#xA;      ON PAS.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID &#xD;&#xA;     INNER JOIN SGS_CODE_VALUE CV (NOLOCK)&#xD;&#xA;      ON PAS.STATUS_ID= CV.CODE_ID AND PAS.STATUS_VALUE = CV.CODE_VALUE&#xD;&#xA;     INNER JOIN &#xD;&#xA;      (&#xD;&#xA;       SELECT BA.BENEFIT_APPLICATION_ID,BAPA.PERSON_ACCOUNT_ID &#xD;&#xA;         FROM SGT_BENEFIT_APPLICATION(NOLOCK) BA &#xD;&#xA;        INNER JOIN SGT_BENEFIT_APPLICATION_PERSON_ACCOUNT(NOLOCK) BAPA &#xD;&#xA;        ON  BA.BENEFIT_APPLICATION_ID = BAPA.BENEFIT_APPLICATION_ID  &#xD;&#xA;        WHERE ISNULL(IS_APPLICATION_PERSON_ACCOUNT_FLAG,'N') = 'Y' AND BA.ACTION_STATUS_VALUE NOT IN ('DENI','CANC')&#xD;&#xA;       ) AS BAA ON PA.APPLICATION_ID = BAA.BENEFIT_APPLICATION_ID&#xD;&#xA;     INNER JOIN SGT_PERSON_ACCOUNT_RETIREMENT_HISTORY PARH ON PARH.PERSON_ACCOUNT_ID = BAA.PERSON_ACCOUNT_ID&#xD;&#xA;     WHERE ACCOUNT_RELATION_VALUE = 'MEMB' AND CV.DATA2 &lt;&gt; 'CNLD'  AND PA.BENEFIT_BEGIN_DATE &lt;=@PAYMENTDATE&#xD;&#xA;       AND  PAYEE_ACCOUNT_STATUS_ID  = &#xD;&#xA;       (&#xD;&#xA;        SELECT TOP 1 PAYEE_ACCOUNT_STATUS_ID&#xD;&#xA;        FROM SGT_PAYEE_ACCOUNT_STATUS PAS1 (NOLOCK)&#xD;&#xA;        WHERE PAS1.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID&#xD;&#xA;        AND PAS1.STATUS_EFFECTIVE_DATE &lt;= @PAYMENTDATE&#xD;&#xA;        ORDER BY PAS1.STATUS_EFFECTIVE_DATE DESC,PAS1.PAYEE_ACCOUNT_STATUS_ID DESC&#xD;&#xA;       )&#xD;&#xA;       AND @paymentdate BETWEEN PARH.START_DATE and ISNULL( PARH.END_DATE, '12/31/9999') &#xD;&#xA;&#x9;   AND PARH.PLAN_PARTICIPATION_STATUS_VALUE not in ('ENL1','SUS2')&#xD;&#xA;    ) as PCHK&#xD;&#xA;   ON a.PERSON_ACCOUNT_ID = PCHK.PERSON_ACCOUNT_ID&#xD;&#xA;  LEFT OUTER JOIN &#xD;&#xA;   ( &#xD;&#xA;    SELECT PERSON_ID,SUM(ISNULL(TFFR_SERVICE,0))+SUM(ISNULL(TIAA_SERVICE,0)) AS TFFR_TIAA_SERVICE&#xD;&#xA;     FROM SGT_PERSON_TFFR_TIAA_SERVICE&#xD;&#xA;    WHERE ISNULL(TFFR_SERVICE_STATUS_VALUE,'') = 'APRV' &#xD;&#xA;     OR ISNULL(TIAA_SERVICE_STATUS_VALUE,'') = 'APRV'&#xD;&#xA;    GROUP BY PERSON_ID &#xD;&#xA;   ) AS TIAATFFR&#xD;&#xA;   ON A.PERSON_ID = TIAATFFR.PERSON_ID&#xD;&#xA;WHERE B.BENEFIT_TYPE_VALUE='RETR'&#xD;&#xA;        AND ((@PLANID = 0) OR (A.PLAN_ID = @PLANID))  &#xD;&#xA;  AND PAYEE.PERSON_ACCOUNT_ID IS NULL&#xD;&#xA;GROUP BY &#xD;&#xA;         A.PERSON_ID,A.PERSON_ACCOUNT_ID,P.SSN,&#xD;&#xA;         PARH.PLAN_PARTICIPATION_STATUS_VALUE,TOTCTR,EHCTR,EDCTR,&#xD;&#xA;  CASE WHEN (TOTCTR = EHCTR) OR (TOTCTR = EDCTR) or PED.STATUS_VALUE is null&#xD;&#xA;    THEN'TERM'&#xD;&#xA;    ELSE PED.STATUS_VALUE END ,&#xD;&#xA;         BA.ACTION_STATUS_VALUE,PED.TYPE_VALUE,PED.HOURLY_VALUE,&#xD;&#xA;         PED.SEASONAL_VALUE,P.LAST_NAME,P.FIRST_NAME,P.MARITAL_STATUS_VALUE,P.DATE_OF_BIRTH,&#xD;&#xA;         A.START_DATE,SP.DATE_OF_BIRTH,P.GENDER_VALUE,SP.GENDER_VALUE,B.PLAN_CODE,&#xD;&#xA;         A.PLAN_ID,B.ACTUARY_NAME,PED.ORG_ID ,PED.ORG_CODE,PED.START_DATE,PED.END_DATE,&#xD;&#xA;   Case when PCHK.PERSON_ACCOUNT_ID is null then 'N' Else 'Y' END,&#xD;&#xA;   Case  When PARH.PLAN_PARTICIPATION_STATUS_VALUE = 'DSW1' then &#xD;&#xA;    Case when MAX_EMP_END_DATE is null or&#xD;&#xA;      MAX_EMP_END_DATE &gt;= P.DATE_OF_DEATH  then 'EDT_AFT_DTH'&#xD;&#xA;    when MAX_EMP_END_DATE is not null  &#xD;&#xA;     and MAX_EMP_END_DATE &lt; P.DATE_OF_DEATH then 'EDT_BEF_DTH'&#xD;&#xA;    Else null End&#xD;&#xA;   Else Null End , PARC.TOTAL_SALARY&#xD;&#xA;)TEMP &#xD;&#xA;&#xD;&#xA;UNION ALL&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;SELECT ACTUARY_FILE_HEADER_ID,PERSON_ID,PAYEE_ACCOUNT_ID,PERSON_ACCOUNT_ID,SSN,ACCOUNT_RELATION_VALUE,&#xD;&#xA;  PLAN_PARTICIPATION_STATUS_VALUE,EMPLOYMENT_STATUS_VALUE,APPLICATION_STATUS_VALUE,PAYEE_STATUS_VALUE,&#xD;&#xA;  EMPLOYMENT_TYPE_VALUE,HOURLY_VALUE,SEASONAL_VALUE,LAST_NAME,FIRST_NAME,MARITAL_STATUS_VALUE,DATE_OF_BIRTH,&#xD;&#xA;  PLAN_PARTICIPATION_START_DATE,BENEFIT_OPTION_VALUE,&#xD;&#xA;  isnull(PENSION_SERVICE_CREDIT,0.00) as PENSION_SERVICE_CREDIT,&#xD;&#xA;  isnull(TOTAL_VESTED_SERVICE_CREDIT,0.00) as TOTAL_VESTED_SERVICE_CREDIT ,&#xD;&#xA;  RETIREMENT_DATE,SPOUSE_DOB,&#xD;&#xA;  JOINT_ANNUITANT_DOB,MEMBERGENDER,SPOUSEGENDER,PLAN_ID,PLAN_NAME,ORG_ID,ORG_CODE,TOTAL_SALARY,ACCOUNT_BALANCE,PENSION_SERVICE_CREDIT_BA,&#xD;&#xA;  TOTAL_VESTED_SERVICE_CREDIT_BA,ACCRUED_BENEFIT_CALCULATION,CASE WHEN MINIMUM_GUARANTEE_AMOUNT &gt; 0.00 THEN MINIMUM_GUARANTEE_AMOUNT ELSE 0.0 END AS MINIMUM_GUARANTEE_AMOUNT,&#xD;&#xA;  GROSS_CURRENT_MONTHLY_BENEFIT_AMOUNT,AMOUNT_PAID_LTD,PURCHASED_SERVICE_CREDIT_SUM,SSLI_OR_UNIFORM_INCOME_COMMENCEMENT_AGE,PLAN_CODE,PAYEE_STATUS_EFFECTIVE_DATE,&#xD;&#xA;  ESTIMATED_SSLI_BENEFIT_AMOUNT,OPTION_FACTOR,VESTED_ER_AMOUNT,SSLI_CHANGE_DATE,TRAVELLERS_BASE_BENEFIT_AMOUNT,&#xD;&#xA;  TRAVELLERS_CUMULATIVE_COLA_AMOUNT,ROWRANK,EMPLOYMENT_START_DATE,EMPLOYMENT_END_DATE,PAYEE_STATUS_DATA2,&#xD;&#xA;  PAYEE_ACCT_EXISTS,TOTCTR,EHCTR,EDCTR,&#xD;&#xA;  isnull(cast(TFFR_TIAA_SERVICE as decimal(9,2)),0.00) as TFFR_TIAA_SERVICE,&#xD;&#xA;  EMP_DT_CHK, GRADUATED_BENEFIT_OPTION_VALUE&#xD;&#xA;  FROM&#xD;&#xA;(&#xD;&#xA;SELECT @HEADERID AS ACTUARY_FILE_HEADER_ID,PA.PAYEE_PERSLINK_ID AS PERSON_ID,PA.PAYEE_ACCOUNT_ID,&#xD;&#xA;    isnull(AP.PERSON_ACCOUNT_ID,DROAP.PERSON_ACCOUNT_ID) as PERSON_ACCOUNT_ID,&#xD;&#xA;    P.SSN,PA.ACCOUNT_RELATION_VALUE AS ACCOUNT_RELATION_VALUE, Null AS PLAN_PARTICIPATION_STATUS_VALUE,NULL AS EMPLOYMENT_STATUS_VALUE,   &#xD;&#xA;    NULL AS APPLICATION_STATUS_VALUE,CV.CODE_VALUE AS PAYEE_STATUS_VALUE,NULL AS EMPLOYMENT_TYPE_VALUE,NULL AS HOURLY_VALUE,&#xD;&#xA;    NULL AS SEASONAL_VALUE,P.LAST_NAME,P.FIRST_NAME,P.MARITAL_STATUS_VALUE AS MARITAL_STATUS_VALUE,P.DATE_OF_BIRTH,NULL AS PLAN_PARTICIPATION_START_DATE,&#xD;&#xA;       PA.BENEFIT_OPTION_VALUE AS BENEFIT_OPTION_VALUE,NULL AS PENSION_SERVICE_CREDIT,NULL AS TOTAL_VESTED_SERVICE_CREDIT,&#xD;&#xA;    CASE WHEN PA.APPLICATION_ID IS NOT NULL THEN ISNULL(AP.RETIREMENT_DATE,PA.BENEFIT_BEGIN_DATE) ELSE &#xD;&#xA;    CASE WHEN PA.DRO_APPLICATION_ID IS NOT NULL THEN PA.BENEFIT_BEGIN_DATE ELSE NULL END END AS RETIREMENT_DATE,&#xD;&#xA;    SP.DATE_OF_BIRTH AS SPOUSE_DOB,JAP.DATE_OF_BIRTH AS JOINT_ANNUITANT_DOB,P.GENDER_VALUE MEMBERGENDER,SP.GENDER_VALUE SPOUSEGENDER,&#xD;&#xA;    CASE WHEN PA.APPLICATION_ID IS NOT NULL THEN AP.PLAN_ID ELSE DROAP.PLAN_ID END AS PLAN_ID,PL.ACTUARY_NAME AS PLAN_NAME,AP.RETIREMENT_ORG_ID AS ORG_ID,RTORG.ORG_CODE,NULL AS TOTAL_SALARY,&#xD;&#xA;    NULL AS ACCOUNT_BALANCE,ISNULL(BA.PENSION_SERVICE_CREDIT,0.00) AS PENSION_SERVICE_CREDIT_BA,ISNULL(BA.TOTAL_VESTED_SERVICE_CREDIT,0.00) AS TOTAL_VESTED_SERVICE_CREDIT_BA,&#xD;&#xA;    NULL AS ACCRUED_BENEFIT_CALCULATION,&#xD;&#xA;   (PA.MINIMUM_GUARANTEE_AMOUNT- SUM(ISNULL(PHH.MG_DED_AMT,0))) AS MINIMUM_GUARANTEE_AMOUNT,&#xD;&#xA;    SUM(ISNULL(PAPIT.GROSS_CURRENT_MONTHLY_BENEFIT_AMOUNT,0)) AS GROSS_CURRENT_MONTHLY_BENEFIT_AMOUNT,&#xD;&#xA;    PAS.STATUS_EFFECTIVE_DATE AS PAYEE_STATUS_EFFECTIVE_DATE,&#xD;&#xA;    SUM(ISNULL(PHH.AMOUNT_PAID_LTD,0)) AS AMOUNT_PAID_LTD,NULL AS PURCHASED_SERVICE_CREDIT_SUM, &#xD;&#xA;    CASE WHEN PA.ACCOUNT_RELATION_VALUE = 'MEMB' THEN&#xD;&#xA;  AP.SSLI_AGE ELSE NULL END AS SSLI_OR_UNIFORM_INCOME_COMMENCEMENT_AGE,&#xD;&#xA;    CASE WHEN PA.ACCOUNT_RELATION_VALUE = 'MEMB' THEN&#xD;&#xA;   SUM(BA.ESTIMATED_SS_BENEFIT_AMOUNT) ELSE NULL END &#xD;&#xA;  AS ESTIMATED_SSLI_BENEFIT_AMOUNT,&#xD;&#xA;     BA.OPTION_FACTOR AS OPTION_FACTOR,PL.PLAN_CODE,NULL AS EMPLOYMENT_START_DATE,NULL AS EMPLOYMENT_END_DATE,&#xD;&#xA;    NULL AS VESTED_ER_AMOUNT,&#xD;&#xA;    CASE WHEN PA.ACCOUNT_RELATION_VALUE = 'MEMB' THEN&#xD;&#xA;   BA.SSLI_CHANGE_DATE  ELSE NULL END &#xD;&#xA;  AS SSLI_CHANGE_DATE,&#xD;&#xA;  NULL AS TRAVELLERS_BASE_BENEFIT_AMOUNT,NULL AS TRAVELLERS_CUMULATIVE_COLA_AMOUNT,0 AS ROWRANK, CV.DATA2 AS PAYEE_STATUS_DATA2,&#xD;&#xA;  'Y' as PAYEE_ACCT_EXISTS       &#xD;&#xA;  ,0 as TOTCTR,0 as EHCTR,0 as EDCTR,&#xD;&#xA;  0 as TFFR_TIAA_SERVICE,&#xD;&#xA;  null as EMP_DT_CHK, CA.GRADUATED_BENEFIT_OPTION_VALUE&#xD;&#xA;FROM SGT_PAYEE_ACCOUNT PA (NOLOCK)&#xD;&#xA;  INNER JOIN SGT_PERSON P  (NOLOCK)&#xD;&#xA;   ON PA.PAYEE_PERSLINK_ID=P.PERSON_ID  &#xD;&#xA;  INNER JOIN SGT_PAYEE_ACCOUNT_STATUS PAS  (NOLOCK)&#xD;&#xA;   ON PAS.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID  &#xD;&#xA;  INNER JOIN SGT_BENEFIT_ACCOUNT BA  (NOLOCK)&#xD;&#xA;   ON PA.BENEFIT_ACCOUNT_ID= BA.BENEFIT_ACCOUNT_ID   &#xD;&#xA;  INNER JOIN SGS_CODE_VALUE CV  (NOLOCK)&#xD;&#xA;   ON PAS.STATUS_ID= CV.CODE_ID AND PAS.STATUS_VALUE = CV.CODE_VALUE&#xD;&#xA;  INNER JOIN &#xD;&#xA;   (&#xD;&#xA;    SELECT PAYEE_ACCOUNT_ID ,&#xD;&#xA;     SUM&#xD;&#xA;     (&#xD;&#xA;      CASE WHEN PAYPIT.ITEM_TYPE_DIRECTION=1 &#xD;&#xA;      AND PAYPIT.ALLOW_ROLLOVER_CODE_VALUE &lt;&gt; 'CRET'&#xD;&#xA;      THEN PHD.AMOUNT*PAYPIT.ITEM_TYPE_DIRECTION ELSE 0 END&#xD;&#xA;     ) AS MG_DED_AMT,&#xD;&#xA;     SUM(CASE WHEN PAYPIT.ITEM_TYPE_DIRECTION=1 THEN PHD.AMOUNT  ELSE 0 END) AS AMOUNT_PAID_LTD&#xD;&#xA;     FROM SGT_PAYMENT_HISTORY_HEADER PHH1 (NOLOCK)&#xD;&#xA;    INNER JOIN SGT_PAYMENT_HISTORY_DETAIL PHD  (NOLOCK)&#xD;&#xA;     ON PHH1.PAYMENT_HISTORY_HEADER_ID=PHD.PAYMENT_HISTORY_HEADER_ID&#xD;&#xA;    INNER JOIN SGT_PAYMENT_ITEM_TYPE PAYPIT (NOLOCK)&#xD;&#xA;     ON PHD.PAYMENT_ITEM_TYPE_ID=PAYPIT.PAYMENT_ITEM_TYPE_ID &#xD;&#xA;     WHERE PHH1.STATUS_VALUE IN ('PRCD', 'OUST')&#xD;&#xA;     AND PAYMENT_DATE &lt;= @PAYMENTDATE&#xD;&#xA;    GROUP BY PAYEE_ACCOUNT_ID&#xD;&#xA;   ) AS PHH  &#xD;&#xA;   ON PHH.PAYEE_ACCOUNT_ID=PA.PAYEE_ACCOUNT_ID&#xD;&#xA;  LEFT JOIN SGT_BENEFIT_CALCULATION CA  (NOLOCK)&#xD;&#xA;   ON PA.CALCULATION_ID = CA.BENEFIT_CALCULATION_ID &#xD;&#xA;  LEFT JOIN SGT_BENEFIT_CALCULATION_PAYEE BCP (NOLOCK)&#xD;&#xA;   ON CA.BENEFIT_CALCULATION_ID=BCP.BENEFIT_CALCULATION_ID AND CA.PERSON_ID=BCP.PAYEE_PERSON_ID&#xD;&#xA;  LEFT OUTER JOIN &#xD;&#xA;     (&#xD;&#xA;      SELECT BA.*,BAPA.PERSON_ACCOUNT_ID &#xD;&#xA;        FROM SGT_BENEFIT_APPLICATION(NOLOCK) BA &#xD;&#xA;       INNER JOIN SGT_BENEFIT_APPLICATION_PERSON_ACCOUNT(NOLOCK) BAPA &#xD;&#xA;       ON  BA.BENEFIT_APPLICATION_ID = BAPA.BENEFIT_APPLICATION_ID  &#xD;&#xA;       WHERE ISNULL(IS_APPLICATION_PERSON_ACCOUNT_FLAG,'N') = 'Y' AND BA.ACTION_STATUS_VALUE NOT IN ('DENI','CANC')&#xD;&#xA;      ) AS AP ON PA.APPLICATION_ID = AP.BENEFIT_APPLICATION_ID&#xD;&#xA;&#xD;&#xA;  LEFT OUTER JOIN SGT_BENEFIT_DRO_CALCULATION DROC  (NOLOCK)&#xD;&#xA;   ON PA.DRO_CALCULATION_ID = DROC.DRO_CALCULATION_ID&#xD;&#xA;  LEFT JOIN SGT_BENEFIT_CALCULATION_OPTIONS BCO&#xD;&#xA;   ON BCO.BENEFIT_CALCULATION_ID=CA.BENEFIT_CALCULATION_ID AND BCO.BENEFIT_CALCULATION_PAYEE_ID=BCP.BENEFIT_CALCULATION_PAYEE_ID&#xD;&#xA;  LEFT OUTER JOIN SGT_BENEFIT_DRO_APPLICATION DROAP  (NOLOCK)&#xD;&#xA;   ON PA.DRO_APPLICATION_ID = DROAP.DRO_APPLICATION_ID &#xD;&#xA;  LEFT JOIN &#xD;&#xA;   (&#xD;&#xA;    SELECT PERSON_ID,CONTACT_PERSON_ID FROM &#xD;&#xA;     SGT_PERSON_CONTACT (NOLOCK) WHERE RELATIONSHIP_VALUE='SPOU' &#xD;&#xA;     AND STATUS_VALUE = 'ACT' AND CONTACT_PERSON_ID IS NOT NULL&#xD;&#xA;   ) AS CONT&#xD;&#xA;            ON P.PERSON_ID=CONT.PERSON_ID &#xD;&#xA;  LEFT JOIN SGT_PERSON SP(NOLOCK)&#xD;&#xA;   ON CONT.CONTACT_PERSON_ID=SP.PERSON_ID   &#xD;&#xA;  LEFT JOIN SGT_PERSON JAP(NOLOCK)&#xD;&#xA;   ON AP.JOINT_ANNUITANT_PERSLINK_ID=JAP.PERSON_ID  &#xD;&#xA;  LEFT JOIN SGT_ORGANIZATION RTORG  (NOLOCK)&#xD;&#xA;   ON AP.RETIREMENT_ORG_ID=RTORG.ORG_ID  &#xD;&#xA;  LEFT JOIN &#xD;&#xA;   ( SELECT PAYEE_ACCOUNT_ID,&#xD;&#xA;     SUM(CASE WHEN PIT.ITEM_TYPE_DIRECTION = 1 THEN PAPIT.AMOUNT ELSE 0 END) AS GROSS_CURRENT_MONTHLY_BENEFIT_AMOUNT &#xD;&#xA;     FROM SGT_PAYEE_ACCOUNT_PAYMENT_ITEM_TYPE PAPIT (NOLOCK)&#xD;&#xA;     INNER JOIN SGT_PAYMENT_ITEM_TYPE PIT (NOLOCK)&#xD;&#xA;     ON PIT.PAYMENT_ITEM_TYPE_ID=PAPIT.PAYMENT_ITEM_TYPE_ID&#xD;&#xA;     WHERE @PAYMENTDATE BETWEEN START_DATE &#xD;&#xA;      AND (CASE WHEN END_DATE IS NULL THEN '99991231' ELSE END_DATE END)&#xD;&#xA;      AND NOT EXISTS (SELECT 1 FROM SGT_RETRO_ITEM_TYPE WHERE TO_ITEM_TYPE=PIT.ITEM_TYPE_CODE)&#xD;&#xA;     GROUP BY PAYEE_ACCOUNT_ID&#xD;&#xA;   ) PAPIT&#xD;&#xA;   ON PA.PAYEE_ACCOUNT_ID=PAPIT.PAYEE_ACCOUNT_ID&#xD;&#xA;  INNER JOIN  SGT_PLAN PL(NOLOCK)&#xD;&#xA;   ON PL.PLAN_ID=CASE WHEN PA.APPLICATION_ID IS NOT NULL THEN AP.PLAN_ID ELSE DROAP.PLAN_ID END      &#xD;&#xA;  WHERE CASE WHEN PA.APPLICATION_ID IS NOT NULL THEN AP.PLAN_ID ELSE DROAP.PLAN_ID END NOT IN(21,23,24) AND &#xD;&#xA;  ((@PLANID = 0) OR (AP.PLAN_ID = @PLANID)) AND  &#xD;&#xA;      PAYEE_ACCOUNT_STATUS_ID  = &#xD;&#xA;   (SELECT TOP 1 PAYEE_ACCOUNT_STATUS_ID&#xD;&#xA;   FROM SGT_PAYEE_ACCOUNT_STATUS PAS1 (NOLOCK)&#xD;&#xA;   WHERE PAS1.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID&#xD;&#xA;   AND PAS1.STATUS_EFFECTIVE_DATE &lt;= @PAYMENTDATE&#xD;&#xA;   ORDER BY PAS1.STATUS_EFFECTIVE_DATE DESC,PAS1.PAYEE_ACCOUNT_STATUS_ID DESC&#xD;&#xA;   )&#xD;&#xA;  and PAS.STATUS_EFFECTIVE_DATE &gt;= Case &#xD;&#xA;  when CV.DATA2 in ('TRMD','RPCD','CNLD') then @FYST else PAS.STATUS_EFFECTIVE_DATE End&#xD;&#xA;GROUP BY &#xD;&#xA;    PA.PAYEE_PERSLINK_ID ,PA.PAYEE_ACCOUNT_ID,isnull(AP.PERSON_ACCOUNT_ID,DROAP.PERSON_ACCOUNT_ID),&#xD;&#xA;    P.SSN,PA.ACCOUNT_RELATION_VALUE , &#xD;&#xA;    CV.CODE_VALUE,&#xD;&#xA;    P.LAST_NAME,P.FIRST_NAME,P.MARITAL_STATUS_VALUE,P.DATE_OF_BIRTH,&#xD;&#xA;       PA.BENEFIT_OPTION_VALUE,&#xD;&#xA;    CASE WHEN PA.APPLICATION_ID IS NOT NULL THEN ISNULL(AP.RETIREMENT_DATE,PA.BENEFIT_BEGIN_DATE) ELSE &#xD;&#xA;    CASE WHEN PA.DRO_APPLICATION_ID IS NOT NULL THEN PA.BENEFIT_BEGIN_DATE ELSE NULL END END,&#xD;&#xA;    SP.DATE_OF_BIRTH,JAP.DATE_OF_BIRTH,P.GENDER_VALUE,SP.GENDER_VALUE,&#xD;&#xA;    CASE WHEN PA.APPLICATION_ID IS NOT NULL THEN AP.PLAN_ID ELSE DROAP.PLAN_ID END,PL.ACTUARY_NAME,AP.RETIREMENT_ORG_ID,RTORG.ORG_CODE,&#xD;&#xA;    ISNULL(BA.PENSION_SERVICE_CREDIT,0.00),ISNULL(BA.TOTAL_VESTED_SERVICE_CREDIT,0.00),&#xD;&#xA;    PA.MINIMUM_GUARANTEE_AMOUNT,PL.PLAN_CODE,STATUS_EFFECTIVE_DATE,&#xD;&#xA;    AP.SSLI_AGE,&#xD;&#xA;    CA.ESTIMATED_SSLI_BENEFIT_AMOUNT,&#xD;&#xA;    BA.SSLI_CHANGE_DATE,CV.DATA2,BA.OPTION_FACTOR,CA.GRADUATED_BENEFIT_OPTION_VALUE&#xD;&#xA;)TEMP1&#xD;&#xA;&#xD;&#xA;UNION ALL&#xD;&#xA;&#xD;&#xA;-- QUERY 3RD PARTY JOB SERVICE PAYEES &#xD;&#xA;&#xD;&#xA;SELECT ACTUARY_FILE_HEADER_ID,PERSON_ID,PAYEE_ACCOUNT_ID,PERSON_ACCOUNT_ID,SSN,ACCOUNT_RELATION_VALUE,&#xD;&#xA;  PLAN_PARTICIPATION_STATUS_VALUE,EMPLOYMENT_STATUS_VALUE,APPLICATION_STATUS_VALUE,PAYEE_STATUS_VALUE,&#xD;&#xA;  EMPLOYMENT_TYPE_VALUE,HOURLY_VALUE,SEASONAL_VALUE,LAST_NAME,FIRST_NAME,MARITAL_STATUS_VALUE,DATE_OF_BIRTH,&#xD;&#xA;  PLAN_PARTICIPATION_START_DATE,BENEFIT_OPTION_VALUE,&#xD;&#xA;  isnull(PENSION_SERVICE_CREDIT,0.00) as PENSION_SERVICE_CREDIT,&#xD;&#xA;  isnull(TOTAL_VESTED_SERVICE_CREDIT,0.00) as TOTAL_VESTED_SERVICE_CREDIT ,&#xD;&#xA;  RETIREMENT_DATE,SPOUSE_DOB,&#xD;&#xA;  JOINT_ANNUITANT_DOB,MEMBERGENDER,SPOUSEGENDER,PLAN_ID,PLAN_NAME,ORG_ID,ORG_CODE,TOTAL_SALARY,ACCOUNT_BALANCE,PENSION_SERVICE_CREDIT_BA,&#xD;&#xA;  TOTAL_VESTED_SERVICE_CREDIT_BA,ACCRUED_BENEFIT_CALCULATION,CASE WHEN MINIMUM_GUARANTEE_AMOUNT &gt; 0.00 THEN MINIMUM_GUARANTEE_AMOUNT ELSE 0.0 END AS MINIMUM_GUARANTEE_AMOUNT,&#xD;&#xA;  GROSS_CURRENT_MONTHLY_BENEFIT_AMOUNT,AMOUNT_PAID_LTD,PURCHASED_SERVICE_CREDIT_SUM,SSLI_OR_UNIFORM_INCOME_COMMENCEMENT_AGE,PLAN_CODE,PAYEE_STATUS_EFFECTIVE_DATE,&#xD;&#xA;  ESTIMATED_SSLI_BENEFIT_AMOUNT,OPTION_FACTOR,VESTED_ER_AMOUNT,SSLI_CHANGE_DATE,TRAVELLERS_BASE_BENEFIT_AMOUNT,&#xD;&#xA;  TRAVELLERS_CUMULATIVE_COLA_AMOUNT,ROWRANK,EMPLOYMENT_START_DATE,EMPLOYMENT_END_DATE,PAYEE_STATUS_DATA2,&#xD;&#xA;  PAYEE_ACCT_EXISTS ,TOTCTR,EHCTR,EDCTR,&#xD;&#xA;  isnull(cast(TFFR_TIAA_SERVICE as decimal(9,2)),0.00) as TFFR_TIAA_SERVICE,&#xD;&#xA;  EMP_DT_CHK, GRADUATED_BENEFIT_OPTION_VALUE&#xD;&#xA;  FROM&#xD;&#xA;(&#xD;&#xA;SELECT @HEADERID AS ACTUARY_FILE_HEADER_ID,PA.PAYEE_PERSLINK_ID AS PERSON_ID,PA.PAYEE_ACCOUNT_ID,&#xD;&#xA;    isnull(AP.PERSON_ACCOUNT_ID,DROAP.PERSON_ACCOUNT_ID) as PERSON_ACCOUNT_ID,&#xD;&#xA;    P.SSN,PA.ACCOUNT_RELATION_VALUE AS ACCOUNT_RELATION_VALUE,NULL AS PLAN_PARTICIPATION_STATUS_VALUE,NULL AS EMPLOYMENT_STATUS_VALUE,   &#xD;&#xA;    NULL AS APPLICATION_STATUS_VALUE,CV.CODE_VALUE AS PAYEE_STATUS_VALUE,NULL AS EMPLOYMENT_TYPE_VALUE,NULL AS HOURLY_VALUE,&#xD;&#xA;    NULL AS SEASONAL_VALUE,P.LAST_NAME,P.FIRST_NAME,P.MARITAL_STATUS_VALUE AS MARITAL_STATUS_VALUE,P.DATE_OF_BIRTH,NULL AS PLAN_PARTICIPATION_START_DATE,&#xD;&#xA;       PA.BENEFIT_OPTION_VALUE AS BENEFIT_OPTION_VALUE,NULL AS PENSION_SERVICE_CREDIT,NULL AS TOTAL_VESTED_SERVICE_CREDIT,&#xD;&#xA;    CASE WHEN PA.APPLICATION_ID IS NOT NULL THEN ISNULL(AP.RETIREMENT_DATE,PA.BENEFIT_BEGIN_DATE) ELSE &#xD;&#xA;    CASE WHEN PA.DRO_APPLICATION_ID IS NOT NULL THEN PA.BENEFIT_BEGIN_DATE ELSE NULL END END AS RETIREMENT_DATE,&#xD;&#xA;    SP.DATE_OF_BIRTH AS SPOUSE_DOB,JAP.DATE_OF_BIRTH AS JOINT_ANNUITANT_DOB,P.GENDER_VALUE MEMBERGENDER,SP.GENDER_VALUE SPOUSEGENDER,&#xD;&#xA;    CASE WHEN PA.APPLICATION_ID IS NOT NULL THEN AP.PLAN_ID ELSE DROAP.PLAN_ID END AS PLAN_ID,PL.ACTUARY_NAME AS PLAN_NAME,AP.RETIREMENT_ORG_ID AS ORG_ID,RTORG.ORG_CODE,NULL AS TOTAL_SALARY,&#xD;&#xA;    NULL AS ACCOUNT_BALANCE,ISNULL(BA.PENSION_SERVICE_CREDIT,0.00) AS PENSION_SERVICE_CREDIT_BA,ISNULL(BA.TOTAL_VESTED_SERVICE_CREDIT,0.00) AS TOTAL_VESTED_SERVICE_CREDIT_BA,&#xD;&#xA;    NULL AS ACCRUED_BENEFIT_CALCULATION,&#xD;&#xA;   PA.MINIMUM_GUARANTEE_AMOUNT AS MINIMUM_GUARANTEE_AMOUNT,&#xD;&#xA;    SUM(ISNULL(PAPIT.GROSS_CURRENT_MONTHLY_BENEFIT_AMOUNT,0)) AS GROSS_CURRENT_MONTHLY_BENEFIT_AMOUNT,&#xD;&#xA;    PAS.STATUS_EFFECTIVE_DATE AS PAYEE_STATUS_EFFECTIVE_DATE,&#xD;&#xA;    NULL AS AMOUNT_PAID_LTD,NULL AS PURCHASED_SERVICE_CREDIT_SUM, &#xD;&#xA;     CASE WHEN PA.ACCOUNT_RELATION_VALUE = 'MEMB' THEN&#xD;&#xA;  AP.SSLI_AGE ELSE NULL END AS SSLI_OR_UNIFORM_INCOME_COMMENCEMENT_AGE,&#xD;&#xA;    CASE WHEN PA.ACCOUNT_RELATION_VALUE = 'MEMB' THEN&#xD;&#xA;   SUM(BA.ESTIMATED_SS_BENEFIT_AMOUNT) ELSE NULL END &#xD;&#xA;  AS ESTIMATED_SSLI_BENEFIT_AMOUNT,&#xD;&#xA;    BA.OPTION_FACTOR AS OPTION_FACTOR,PL.PLAN_CODE,NULL AS EMPLOYMENT_START_DATE,NULL AS EMPLOYMENT_END_DATE,&#xD;&#xA;    NULL AS VESTED_ER_AMOUNT,&#xD;&#xA;    CASE WHEN PA.ACCOUNT_RELATION_VALUE = 'MEMB' THEN&#xD;&#xA;   BA.SSLI_CHANGE_DATE  ELSE NULL END &#xD;&#xA;  AS SSLI_CHANGE_DATE,&#xD;&#xA;  sum(PAPIT.TRAVELLERS_BASE_BENEFIT_AMOUNT) AS TRAVELLERS_BASE_BENEFIT_AMOUNT,&#xD;&#xA;  sum(PAPIT.TRAVELLERS_CUMULATIVE_COLA_AMOUNT) AS TRAVELLERS_CUMULATIVE_COLA_AMOUNT,&#xD;&#xA;  0 AS ROWRANK, CV.DATA2 AS PAYEE_STATUS_DATA2,&#xD;&#xA;  'Y' as PAYEE_ACCT_EXISTS&#xD;&#xA;  ,0 as TOTCTR,0 as EHCTR,0 as EDCTR,&#xD;&#xA;  0 as TFFR_TIAA_SERVICE,&#xD;&#xA;  null as EMP_DT_CHK, CA.GRADUATED_BENEFIT_OPTION_VALUE&#xD;&#xA;FROM SGT_PAYEE_ACCOUNT PA (NOLOCK)&#xD;&#xA;  INNER JOIN SGT_PERSON P  (NOLOCK)&#xD;&#xA;   ON PA.PAYEE_PERSLINK_ID=P.PERSON_ID  &#xD;&#xA;  INNER JOIN SGT_PAYEE_ACCOUNT_STATUS PAS  (NOLOCK)&#xD;&#xA;   ON PAS.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID  &#xD;&#xA;  INNER JOIN SGT_BENEFIT_ACCOUNT BA  (NOLOCK)&#xD;&#xA;   ON PA.BENEFIT_ACCOUNT_ID= BA.BENEFIT_ACCOUNT_ID   &#xD;&#xA;  INNER JOIN SGS_CODE_VALUE CV  (NOLOCK)&#xD;&#xA;   ON PAS.STATUS_ID= CV.CODE_ID AND PAS.STATUS_VALUE = CV.CODE_VALUE&#xD;&#xA;  LEFT JOIN SGT_BENEFIT_CALCULATION CA  (NOLOCK)&#xD;&#xA;   ON PA.CALCULATION_ID = CA.BENEFIT_CALCULATION_ID &#xD;&#xA;  LEFT JOIN SGT_BENEFIT_CALCULATION_PAYEE BCP (NOLOCK)&#xD;&#xA;   ON CA.BENEFIT_CALCULATION_ID=BCP.BENEFIT_CALCULATION_ID AND CA.PERSON_ID=BCP.PAYEE_PERSON_ID&#xD;&#xA;  LEFT OUTER JOIN &#xD;&#xA;     (&#xD;&#xA;      SELECT BA.*,BAPA.PERSON_ACCOUNT_ID &#xD;&#xA;        FROM SGT_BENEFIT_APPLICATION(NOLOCK) BA &#xD;&#xA;       INNER JOIN SGT_BENEFIT_APPLICATION_PERSON_ACCOUNT(NOLOCK) BAPA &#xD;&#xA;       ON  BA.BENEFIT_APPLICATION_ID = BAPA.BENEFIT_APPLICATION_ID  &#xD;&#xA;       WHERE ISNULL(IS_APPLICATION_PERSON_ACCOUNT_FLAG,'N') = 'Y' AND BA.ACTION_STATUS_VALUE NOT IN ('DENI','CANC')&#xD;&#xA;      ) AS AP ON PA.APPLICATION_ID = AP.BENEFIT_APPLICATION_ID&#xD;&#xA;  LEFT OUTER JOIN SGT_BENEFIT_DRO_CALCULATION DROC  (NOLOCK)&#xD;&#xA;   ON PA.DRO_CALCULATION_ID = DROC.DRO_CALCULATION_ID&#xD;&#xA;  LEFT JOIN SGT_BENEFIT_CALCULATION_OPTIONS BCO&#xD;&#xA;   ON BCO.BENEFIT_CALCULATION_ID=CA.BENEFIT_CALCULATION_ID AND BCO.BENEFIT_CALCULATION_PAYEE_ID=BCP.BENEFIT_CALCULATION_PAYEE_ID&#xD;&#xA;  LEFT OUTER JOIN SGT_BENEFIT_DRO_APPLICATION DROAP  (NOLOCK)&#xD;&#xA;   ON PA.DRO_APPLICATION_ID = DROAP.DRO_APPLICATION_ID  &#xD;&#xA;  LEFT JOIN &#xD;&#xA;   (&#xD;&#xA;    SELECT PERSON_ID,CONTACT_PERSON_ID FROM &#xD;&#xA;     SGT_PERSON_CONTACT (NOLOCK) WHERE RELATIONSHIP_VALUE='SPOU' &#xD;&#xA;     AND STATUS_VALUE = 'ACT' AND CONTACT_PERSON_ID IS NOT NULL&#xD;&#xA;   ) AS CONT&#xD;&#xA;            ON P.PERSON_ID=CONT.PERSON_ID &#xD;&#xA;  LEFT JOIN SGT_PERSON SP(NOLOCK)&#xD;&#xA;   ON CONT.CONTACT_PERSON_ID=SP.PERSON_ID   &#xD;&#xA;  LEFT JOIN SGT_PERSON JAP(NOLOCK)&#xD;&#xA;   ON AP.JOINT_ANNUITANT_PERSLINK_ID=JAP.PERSON_ID  &#xD;&#xA;  LEFT JOIN SGT_ORGANIZATION RTORG  (NOLOCK)&#xD;&#xA;   ON AP.RETIREMENT_ORG_ID=RTORG.ORG_ID  &#xD;&#xA;  LEFT JOIN &#xD;&#xA;   ( SELECT PAYEE_ACCOUNT_ID,&#xD;&#xA;     SUM(CASE WHEN ISNULL(PIT.ITEM_TYPE_DIRECTION,'') = 1 &#xD;&#xA;         THEN PAPIT.AMOUNT &#xD;&#xA;         ELSE 0 END) &#xD;&#xA;         AS GROSS_CURRENT_MONTHLY_BENEFIT_AMOUNT ,&#xD;&#xA;     SUM(CASE WHEN ISNULL(PIT.ADHOC_COLA_GROUP_VALUE,'') = 'COLA' &#xD;&#xA;        THEN PAPIT.AMOUNT*PIT.ITEM_TYPE_DIRECTION ELSE 0 END) &#xD;&#xA;        AS TRAVELLERS_CUMULATIVE_COLA_AMOUNT,&#xD;&#xA;     SUM(CASE WHEN ISNULL(BASE_AMOUNT_FLAG,'N') = 'Y' AND &#xD;&#xA;        PIT.ITEM_TYPE_DIRECTION = 1 &#xD;&#xA;        THEN PAPIT.AMOUNT ELSE 0 END) &#xD;&#xA;        AS TRAVELLERS_BASE_BENEFIT_AMOUNT&#xD;&#xA;     FROM SGT_PAYEE_ACCOUNT_PAYMENT_ITEM_TYPE PAPIT (NOLOCK)&#xD;&#xA;     INNER JOIN SGT_PAYMENT_ITEM_TYPE PIT (NOLOCK)&#xD;&#xA;     ON PIT.PAYMENT_ITEM_TYPE_ID=PAPIT.PAYMENT_ITEM_TYPE_ID&#xD;&#xA;     WHERE @PAYMENTDATE BETWEEN START_DATE &#xD;&#xA;      AND (CASE WHEN END_DATE IS NULL THEN '99991231' ELSE END_DATE END)&#xD;&#xA;      AND NOT EXISTS (SELECT 1 FROM SGT_RETRO_ITEM_TYPE WHERE TO_ITEM_TYPE=PIT.ITEM_TYPE_CODE)&#xD;&#xA;     GROUP BY PAYEE_ACCOUNT_ID&#xD;&#xA;   ) PAPIT&#xD;&#xA;   ON PA.PAYEE_ACCOUNT_ID=PAPIT.PAYEE_ACCOUNT_ID&#xD;&#xA;  INNER JOIN  SGT_PLAN PL(NOLOCK)&#xD;&#xA;   ON PL.PLAN_ID=CASE WHEN PA.APPLICATION_ID IS NOT NULL THEN AP.PLAN_ID ELSE DROAP.PLAN_ID END      &#xD;&#xA;  WHERE CASE WHEN PA.APPLICATION_ID IS NOT NULL THEN AP.PLAN_ID ELSE DROAP.PLAN_ID END = 23 AND &#xD;&#xA;  ((@PLANID = 0) OR (AP.PLAN_ID = @PLANID)) AND  &#xD;&#xA;      PAYEE_ACCOUNT_STATUS_ID  = &#xD;&#xA;   (SELECT TOP 1 PAYEE_ACCOUNT_STATUS_ID&#xD;&#xA;   FROM SGT_PAYEE_ACCOUNT_STATUS PAS1 (NOLOCK)&#xD;&#xA;   WHERE PAS1.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID&#xD;&#xA;   AND PAS1.STATUS_EFFECTIVE_DATE &lt;= @PAYMENTDATE&#xD;&#xA;   ORDER BY PAS1.STATUS_EFFECTIVE_DATE DESC,PAS1.PAYEE_ACCOUNT_STATUS_ID DESC&#xD;&#xA;   )&#xD;&#xA;  and PAS.STATUS_EFFECTIVE_DATE &gt;= Case &#xD;&#xA;  when CV.DATA2 in ('TRMD','RPCD','CNLD') then @FYST else PAS.STATUS_EFFECTIVE_DATE End&#xD;&#xA;GROUP BY &#xD;&#xA;    PA.PAYEE_PERSLINK_ID ,PA.PAYEE_ACCOUNT_ID,isnull(AP.PERSON_ACCOUNT_ID,DROAP.PERSON_ACCOUNT_ID),&#xD;&#xA;    P.SSN,PA.ACCOUNT_RELATION_VALUE , &#xD;&#xA;    CV.CODE_VALUE,&#xD;&#xA;    P.LAST_NAME,P.FIRST_NAME,P.MARITAL_STATUS_VALUE,P.DATE_OF_BIRTH,&#xD;&#xA;       PA.BENEFIT_OPTION_VALUE,&#xD;&#xA;    CASE WHEN PA.APPLICATION_ID IS NOT NULL THEN ISNULL(AP.RETIREMENT_DATE,PA.BENEFIT_BEGIN_DATE) ELSE &#xD;&#xA;    CASE WHEN PA.DRO_APPLICATION_ID IS NOT NULL THEN PA.BENEFIT_BEGIN_DATE ELSE NULL END END,&#xD;&#xA;    SP.DATE_OF_BIRTH,JAP.DATE_OF_BIRTH,P.GENDER_VALUE,SP.GENDER_VALUE,&#xD;&#xA;    CASE WHEN PA.APPLICATION_ID IS NOT NULL THEN AP.PLAN_ID ELSE DROAP.PLAN_ID END,PL.ACTUARY_NAME,AP.RETIREMENT_ORG_ID,RTORG.ORG_CODE,&#xD;&#xA;    ISNULL(BA.PENSION_SERVICE_CREDIT,0.00),ISNULL(BA.TOTAL_VESTED_SERVICE_CREDIT,0.00),&#xD;&#xA;    PA.MINIMUM_GUARANTEE_AMOUNT,PL.PLAN_CODE,STATUS_EFFECTIVE_DATE,&#xD;&#xA;    AP.SSLI_AGE,&#xD;&#xA;    CA.ESTIMATED_SSLI_BENEFIT_AMOUNT,&#xD;&#xA;    BA.SSLI_CHANGE_DATE,CV.DATA2,BA.OPTION_FACTOR,CA.GRADUATED_BENEFIT_OPTION_VALUE&#xD;&#xA;)TEMP2&#xD;&#xA;&#xD;&#xA;UNION ALL&#xD;&#xA;&#xD;&#xA;-- QUERY FOR DC PLAN STATUS AS DC RECEIVING&#xD;&#xA;&#xD;&#xA;SELECT ACTUARY_FILE_HEADER_ID,PERSON_ID,PAYEE_ACCOUNT_ID,PERSON_ACCOUNT_ID,SSN,ACCOUNT_RELATION_VALUE,&#xD;&#xA;  PLAN_PARTICIPATION_STATUS_VALUE,EMPLOYMENT_STATUS_VALUE,APPLICATION_STATUS_VALUE,PAYEE_STATUS_VALUE,&#xD;&#xA;  EMPLOYMENT_TYPE_VALUE,HOURLY_VALUE,SEASONAL_VALUE,LAST_NAME,FIRST_NAME,MARITAL_STATUS_VALUE,DATE_OF_BIRTH,&#xD;&#xA;  PLAN_PARTICIPATION_START_DATE,BENEFIT_OPTION_VALUE,&#xD;&#xA;  isnull(PENSION_SERVICE_CREDIT,0.00) as PENSION_SERVICE_CREDIT,&#xD;&#xA;  isnull(TOTAL_VESTED_SERVICE_CREDIT,0.00) as TOTAL_VESTED_SERVICE_CREDIT ,&#xD;&#xA;  RETIREMENT_DATE,SPOUSE_DOB,&#xD;&#xA;  JOINT_ANNUITANT_DOB,MEMBERGENDER,SPOUSEGENDER,PLAN_ID,PLAN_NAME,ORG_ID,ORG_CODE,TOTAL_SALARY,ACCOUNT_BALANCE,PENSION_SERVICE_CREDIT_BA,&#xD;&#xA;  TOTAL_VESTED_SERVICE_CREDIT_BA,ACCRUED_BENEFIT_CALCULATION,CASE WHEN MINIMUM_GUARANTEE_AMOUNT &gt; 0.00 THEN MINIMUM_GUARANTEE_AMOUNT ELSE 0.0 END AS MINIMUM_GUARANTEE_AMOUNT,&#xD;&#xA;  GROSS_CURRENT_MONTHLY_BENEFIT_AMOUNT,AMOUNT_PAID_LTD,PURCHASED_SERVICE_CREDIT_SUM,SSLI_OR_UNIFORM_INCOME_COMMENCEMENT_AGE,PLAN_CODE,PAYEE_STATUS_EFFECTIVE_DATE,&#xD;&#xA;  ESTIMATED_SSLI_BENEFIT_AMOUNT,OPTION_FACTOR,VESTED_ER_AMOUNT,SSLI_CHANGE_DATE,TRAVELLERS_BASE_BENEFIT_AMOUNT,&#xD;&#xA;  TRAVELLERS_CUMULATIVE_COLA_AMOUNT,ROWRANK,EMPLOYMENT_START_DATE,EMPLOYMENT_END_DATE,PAYEE_STATUS_DATA2,&#xD;&#xA;  PAYEE_ACCT_EXISTS ,TOTCTR,EHCTR,EDCTR,&#xD;&#xA;  isnull(cast(TFFR_TIAA_SERVICE as decimal(9,2)),0.00) as TFFR_TIAA_SERVICE,&#xD;&#xA;  EMP_DT_CHK, GRADUATED_BENEFIT_OPTION_VALUE&#xD;&#xA;  FROM&#xD;&#xA;(&#xD;&#xA;SELECT @HEADERID AS ACTUARY_FILE_HEADER_ID,PA.PAYEE_PERSLINK_ID AS PERSON_ID,PA.PAYEE_ACCOUNT_ID,&#xD;&#xA;    isnull(AP.PERSON_ACCOUNT_ID,DROAP.PERSON_ACCOUNT_ID) as PERSON_ACCOUNT_ID,&#xD;&#xA;    P.SSN,PA.ACCOUNT_RELATION_VALUE AS ACCOUNT_RELATION_VALUE,NULL AS PLAN_PARTICIPATION_STATUS_VALUE,NULL AS EMPLOYMENT_STATUS_VALUE,   &#xD;&#xA;    NULL AS APPLICATION_STATUS_VALUE,CV.CODE_VALUE AS PAYEE_STATUS_VALUE,NULL AS EMPLOYMENT_TYPE_VALUE,NULL AS HOURLY_VALUE,&#xD;&#xA;    NULL AS SEASONAL_VALUE,P.LAST_NAME,P.FIRST_NAME,P.MARITAL_STATUS_VALUE AS MARITAL_STATUS_VALUE,P.DATE_OF_BIRTH,NULL AS PLAN_PARTICIPATION_START_DATE,&#xD;&#xA;       PA.BENEFIT_OPTION_VALUE AS BENEFIT_OPTION_VALUE,NULL AS PENSION_SERVICE_CREDIT,NULL AS TOTAL_VESTED_SERVICE_CREDIT,&#xD;&#xA;    CASE WHEN PA.APPLICATION_ID IS NOT NULL THEN ISNULL(AP.RETIREMENT_DATE,PA.BENEFIT_BEGIN_DATE) ELSE &#xD;&#xA;    CASE WHEN PA.DRO_APPLICATION_ID IS NOT NULL THEN PA.BENEFIT_BEGIN_DATE ELSE NULL END END AS RETIREMENT_DATE,&#xD;&#xA;    SP.DATE_OF_BIRTH AS SPOUSE_DOB,JAP.DATE_OF_BIRTH AS JOINT_ANNUITANT_DOB,P.GENDER_VALUE MEMBERGENDER,SP.GENDER_VALUE SPOUSEGENDER,&#xD;&#xA;    CASE WHEN PA.APPLICATION_ID IS NOT NULL THEN AP.PLAN_ID ELSE DROAP.PLAN_ID END AS PLAN_ID,PL.ACTUARY_NAME AS PLAN_NAME,AP.RETIREMENT_ORG_ID AS ORG_ID,RTORG.ORG_CODE,NULL AS TOTAL_SALARY,&#xD;&#xA;    NULL AS ACCOUNT_BALANCE,ISNULL(BA.PENSION_SERVICE_CREDIT,0.00) AS PENSION_SERVICE_CREDIT_BA,ISNULL(BA.TOTAL_VESTED_SERVICE_CREDIT,0.00) AS TOTAL_VESTED_SERVICE_CREDIT_BA,&#xD;&#xA;    NULL AS ACCRUED_BENEFIT_CALCULATION,&#xD;&#xA;   PA.MINIMUM_GUARANTEE_AMOUNT AS MINIMUM_GUARANTEE_AMOUNT,&#xD;&#xA;    SUM(ISNULL(PAPIT.GROSS_CURRENT_MONTHLY_BENEFIT_AMOUNT,0)) AS GROSS_CURRENT_MONTHLY_BENEFIT_AMOUNT,&#xD;&#xA;    PAS.STATUS_EFFECTIVE_DATE AS PAYEE_STATUS_EFFECTIVE_DATE,&#xD;&#xA;    NULL AS AMOUNT_PAID_LTD,NULL AS PURCHASED_SERVICE_CREDIT_SUM, &#xD;&#xA;     CASE WHEN PA.ACCOUNT_RELATION_VALUE = 'MEMB' THEN&#xD;&#xA;  AP.SSLI_AGE ELSE NULL END AS SSLI_OR_UNIFORM_INCOME_COMMENCEMENT_AGE,&#xD;&#xA;    CASE WHEN PA.ACCOUNT_RELATION_VALUE = 'MEMB' THEN&#xD;&#xA;   SUM(BA.ESTIMATED_SS_BENEFIT_AMOUNT) ELSE NULL END &#xD;&#xA;  AS ESTIMATED_SSLI_BENEFIT_AMOUNT,&#xD;&#xA;    BA.OPTION_FACTOR AS OPTION_FACTOR,PL.PLAN_CODE,NULL AS EMPLOYMENT_START_DATE,NULL AS EMPLOYMENT_END_DATE,&#xD;&#xA;    NULL AS VESTED_ER_AMOUNT,&#xD;&#xA;    CASE WHEN PA.ACCOUNT_RELATION_VALUE = 'MEMB' THEN&#xD;&#xA;   BA.SSLI_CHANGE_DATE  ELSE NULL END &#xD;&#xA;  AS SSLI_CHANGE_DATE,&#xD;&#xA;  sum(TRAVLRS.TRAVELLERS_BASE_BENEFIT_AMOUNT) AS TRAVELLERS_BASE_BENEFIT_AMOUNT,&#xD;&#xA;  sum(TRAVLRS.TRAVELLERS_CUMULATIVE_COLA_AMOUNT) AS TRAVELLERS_CUMULATIVE_COLA_AMOUNT,&#xD;&#xA;  0 AS ROWRANK, CV.DATA2 AS PAYEE_STATUS_DATA2,&#xD;&#xA;  'Y' as PAYEE_ACCT_EXISTS&#xD;&#xA;  ,0 as TOTCTR,0 as EHCTR,0 as EDCTR,&#xD;&#xA;  0 as TFFR_TIAA_SERVICE,&#xD;&#xA;  null as EMP_DT_CHK, CA.GRADUATED_BENEFIT_OPTION_VALUE&#xD;&#xA;FROM SGT_PAYEE_ACCOUNT PA (NOLOCK)&#xD;&#xA;  INNER JOIN SGT_PERSON P  (NOLOCK)&#xD;&#xA;   ON PA.PAYEE_PERSLINK_ID=P.PERSON_ID  &#xD;&#xA;  INNER JOIN SGT_PAYEE_ACCOUNT_STATUS PAS  (NOLOCK)&#xD;&#xA;   ON PAS.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID  &#xD;&#xA;  INNER JOIN SGT_BENEFIT_ACCOUNT BA  (NOLOCK)&#xD;&#xA;   ON PA.BENEFIT_ACCOUNT_ID= BA.BENEFIT_ACCOUNT_ID   &#xD;&#xA;  INNER JOIN SGS_CODE_VALUE CV  (NOLOCK)&#xD;&#xA;   ON PAS.STATUS_ID= CV.CODE_ID AND PAS.STATUS_VALUE = CV.CODE_VALUE&#xD;&#xA;  LEFT JOIN SGT_BENEFIT_CALCULATION CA  (NOLOCK)&#xD;&#xA;   ON PA.CALCULATION_ID = CA.BENEFIT_CALCULATION_ID &#xD;&#xA;  LEFT JOIN SGT_BENEFIT_CALCULATION_PAYEE BCP (NOLOCK)&#xD;&#xA;   ON CA.BENEFIT_CALCULATION_ID=BCP.BENEFIT_CALCULATION_ID AND CA.PERSON_ID=BCP.PAYEE_PERSON_ID&#xD;&#xA;  LEFT OUTER JOIN &#xD;&#xA;     (&#xD;&#xA;      SELECT BA.*,BAPA.PERSON_ACCOUNT_ID &#xD;&#xA;        FROM SGT_BENEFIT_APPLICATION(NOLOCK) BA &#xD;&#xA;       INNER JOIN SGT_BENEFIT_APPLICATION_PERSON_ACCOUNT(NOLOCK) BAPA &#xD;&#xA;       ON  BA.BENEFIT_APPLICATION_ID = BAPA.BENEFIT_APPLICATION_ID  &#xD;&#xA;       WHERE ISNULL(IS_APPLICATION_PERSON_ACCOUNT_FLAG,'N') = 'Y' AND BA.ACTION_STATUS_VALUE NOT IN ('DENI','CANC')&#xD;&#xA;      ) AS AP ON PA.APPLICATION_ID = AP.BENEFIT_APPLICATION_ID&#xD;&#xA;  LEFT OUTER JOIN SGT_BENEFIT_DRO_CALCULATION DROC  (NOLOCK)&#xD;&#xA;   ON PA.DRO_CALCULATION_ID = DROC.DRO_CALCULATION_ID&#xD;&#xA;  LEFT JOIN SGT_BENEFIT_CALCULATION_OPTIONS BCO&#xD;&#xA;   ON BCO.BENEFIT_CALCULATION_ID=CA.BENEFIT_CALCULATION_ID AND BCO.BENEFIT_CALCULATION_PAYEE_ID=BCP.BENEFIT_CALCULATION_PAYEE_ID&#xD;&#xA;  LEFT OUTER JOIN SGT_BENEFIT_DRO_APPLICATION DROAP  (NOLOCK)&#xD;&#xA;   ON PA.DRO_APPLICATION_ID = DROAP.DRO_APPLICATION_ID  &#xD;&#xA;  LEFT JOIN &#xD;&#xA;   (&#xD;&#xA;    SELECT PERSON_ID,CONTACT_PERSON_ID FROM &#xD;&#xA;     SGT_PERSON_CONTACT (NOLOCK) WHERE RELATIONSHIP_VALUE='SPOU' &#xD;&#xA;     AND STATUS_VALUE = 'ACT' AND CONTACT_PERSON_ID IS NOT NULL&#xD;&#xA;   ) AS CONT&#xD;&#xA;            ON P.PERSON_ID=CONT.PERSON_ID &#xD;&#xA;  LEFT JOIN SGT_PERSON SP(NOLOCK)&#xD;&#xA;   ON CONT.CONTACT_PERSON_ID=SP.PERSON_ID   &#xD;&#xA;  LEFT JOIN SGT_PERSON JAP(NOLOCK)&#xD;&#xA;   ON AP.JOINT_ANNUITANT_PERSLINK_ID=JAP.PERSON_ID  &#xD;&#xA;  LEFT JOIN SGT_ORGANIZATION RTORG  (NOLOCK)&#xD;&#xA;   ON AP.RETIREMENT_ORG_ID=RTORG.ORG_ID  &#xD;&#xA;  LEFT JOIN &#xD;&#xA;   ( SELECT PAYEE_ACCOUNT_ID,&#xD;&#xA;     SUM(CASE WHEN ISNULL(PIT.ADHOC_COLA_GROUP_VALUE,'') = 'COLA' &#xD;&#xA;        THEN PAPIT.AMOUNT*PIT.ITEM_TYPE_DIRECTION ELSE 0 END) &#xD;&#xA;        AS TRAVELLERS_CUMULATIVE_COLA_AMOUNT,&#xD;&#xA;     SUM(CASE WHEN ISNULL(BASE_AMOUNT_FLAG,'N') = 'Y' AND &#xD;&#xA;        PIT.ITEM_TYPE_DIRECTION = 1 &#xD;&#xA;        THEN PAPIT.AMOUNT ELSE 0 END) &#xD;&#xA;        AS TRAVELLERS_BASE_BENEFIT_AMOUNT&#xD;&#xA;     FROM SGT_PAYEE_ACCOUNT_PAYMENT_ITEM_TYPE PAPIT (NOLOCK)&#xD;&#xA;     INNER JOIN SGT_PAYMENT_ITEM_TYPE PIT (NOLOCK)&#xD;&#xA;     ON PIT.PAYMENT_ITEM_TYPE_ID=PAPIT.PAYMENT_ITEM_TYPE_ID&#xD;&#xA;     WHERE @PAYMENTDATE BETWEEN START_DATE &#xD;&#xA;      AND (CASE WHEN END_DATE IS NULL THEN '99991231' ELSE END_DATE END)&#xD;&#xA;     GROUP BY PAYEE_ACCOUNT_ID&#xD;&#xA;   ) TRAVLRS&#xD;&#xA;   ON PA.PAYEE_ACCOUNT_ID=TRAVLRS.PAYEE_ACCOUNT_ID&#xD;&#xA;  LEFT JOIN &#xD;&#xA;   ( SELECT PAYEE_ACCOUNT_ID,&#xD;&#xA;     SUM(CASE WHEN ISNULL(PIT.ITEM_TYPE_DIRECTION,'') = 1 &#xD;&#xA;         THEN PAPIT.AMOUNT &#xD;&#xA;         ELSE 0 END) &#xD;&#xA;         AS GROSS_CURRENT_MONTHLY_BENEFIT_AMOUNT&#xD;&#xA;     FROM SGT_PAYEE_ACCOUNT_PAYMENT_ITEM_TYPE PAPIT (NOLOCK)&#xD;&#xA;     INNER JOIN SGT_PAYMENT_ITEM_TYPE PIT (NOLOCK)&#xD;&#xA;     ON PIT.PAYMENT_ITEM_TYPE_ID=PAPIT.PAYMENT_ITEM_TYPE_ID&#xD;&#xA;     WHERE @PAYMENTDATE BETWEEN START_DATE &#xD;&#xA;      AND (CASE WHEN END_DATE IS NULL THEN '99991231' ELSE END_DATE END)&#xD;&#xA;      AND NOT EXISTS (SELECT 1 FROM SGT_RETRO_ITEM_TYPE WHERE TO_ITEM_TYPE=PIT.ITEM_TYPE_CODE)&#xD;&#xA;     GROUP BY PAYEE_ACCOUNT_ID&#xD;&#xA;   ) PAPIT&#xD;&#xA;   ON PA.PAYEE_ACCOUNT_ID=PAPIT.PAYEE_ACCOUNT_ID&#xD;&#xA;  INNER JOIN  SGT_PLAN PL(NOLOCK)&#xD;&#xA;   ON PL.PLAN_ID=CASE WHEN PA.APPLICATION_ID IS NOT NULL THEN AP.PLAN_ID ELSE DROAP.PLAN_ID END      &#xD;&#xA;  WHERE CASE WHEN PA.APPLICATION_ID IS NOT NULL THEN AP.PLAN_ID ELSE DROAP.PLAN_ID END = 7 AND &#xD;&#xA;  ((@PLANID = 0) OR (AP.PLAN_ID = @PLANID)) AND  &#xD;&#xA;      PAYEE_ACCOUNT_STATUS_ID  = &#xD;&#xA;   (SELECT TOP 1 PAYEE_ACCOUNT_STATUS_ID&#xD;&#xA;   FROM SGT_PAYEE_ACCOUNT_STATUS PAS1 (NOLOCK)&#xD;&#xA;   WHERE PAS1.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID&#xD;&#xA;   AND PAS1.STATUS_EFFECTIVE_DATE &lt;= @PAYMENTDATE&#xD;&#xA;   ORDER BY PAS1.STATUS_EFFECTIVE_DATE DESC,PAS1.PAYEE_ACCOUNT_STATUS_ID DESC&#xD;&#xA;   )&#xD;&#xA;  and ( PAS.STATUS_EFFECTIVE_DATE &gt;= Case &#xD;&#xA;  when CV.DATA2 in ('TRMD','RPCD','CNLD') then @FYST else PAS.STATUS_EFFECTIVE_DATE End&#xD;&#xA;  OR  CV.DATA2 = 'DCRC')&#xD;&#xA;GROUP BY &#xD;&#xA;    PA.PAYEE_PERSLINK_ID ,PA.PAYEE_ACCOUNT_ID,isnull(AP.PERSON_ACCOUNT_ID,DROAP.PERSON_ACCOUNT_ID),&#xD;&#xA;    P.SSN,PA.ACCOUNT_RELATION_VALUE , &#xD;&#xA;    CV.CODE_VALUE,&#xD;&#xA;    P.LAST_NAME,P.FIRST_NAME,P.MARITAL_STATUS_VALUE,P.DATE_OF_BIRTH,&#xD;&#xA;       PA.BENEFIT_OPTION_VALUE,&#xD;&#xA;    CASE WHEN PA.APPLICATION_ID IS NOT NULL THEN ISNULL(AP.RETIREMENT_DATE,PA.BENEFIT_BEGIN_DATE) ELSE &#xD;&#xA;    CASE WHEN PA.DRO_APPLICATION_ID IS NOT NULL THEN PA.BENEFIT_BEGIN_DATE ELSE NULL END END,&#xD;&#xA;    SP.DATE_OF_BIRTH,JAP.DATE_OF_BIRTH,P.GENDER_VALUE,SP.GENDER_VALUE,&#xD;&#xA;    CASE WHEN PA.APPLICATION_ID IS NOT NULL THEN AP.PLAN_ID ELSE DROAP.PLAN_ID END,PL.ACTUARY_NAME,AP.RETIREMENT_ORG_ID,RTORG.ORG_CODE,&#xD;&#xA;    ISNULL(BA.PENSION_SERVICE_CREDIT,0.00),ISNULL(BA.TOTAL_VESTED_SERVICE_CREDIT,0.00),&#xD;&#xA;    PA.MINIMUM_GUARANTEE_AMOUNT,PL.PLAN_CODE,STATUS_EFFECTIVE_DATE,&#xD;&#xA;    AP.SSLI_AGE,&#xD;&#xA;    CA.ESTIMATED_SSLI_BENEFIT_AMOUNT,&#xD;&#xA;    BA.SSLI_CHANGE_DATE,CV.DATA2,BA.OPTION_FACTOR, CA.GRADUATED_BENEFIT_OPTION_VALUE&#xD;&#xA;)TEMP3&#xD;&#xA;&#xD;&#xA;)A &#xD;&#xA;LEFT JOIN SGT_PERSON_ACCOUNT C ON A.PERSON_ACCOUNT_ID=C.PERSON_ACCOUNT_ID&#xD;&#xA;LEFT JOIN SGT_PLAN PL ON C.PLAN_ID=PL.PLAN_ID&#xD;&#xA;INNER JOIN SGT_PERSON P ON A.PERSON_ID=P.PERSON_ID&#xD;&#xA;LEFT JOIN ( SELECT PA.*,PAS.STATUS_EFFECTIVE_DATE FROM SGT_PAYEE_ACCOUNT PA&#xD;&#xA;   INNER JOIN SGT_PAYEE_ACCOUNT_STATUS PAS&#xD;&#xA;   ON PA.PAYEE_ACCOUNT_ID=PAS.PAYEE_ACCOUNT_ID&#xD;&#xA;   WHERE   PAYEE_ACCOUNT_STATUS_ID  = &#xD;&#xA;   (SELECT TOP 1 PAYEE_ACCOUNT_STATUS_ID&#xD;&#xA;     FROM SGT_PAYEE_ACCOUNT_STATUS PAS1 (NOLOCK)&#xD;&#xA;     WHERE PAS1.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID&#xD;&#xA;     AND PAS1.STATUS_EFFECTIVE_DATE &lt;= @PAYMENTDATE&#xD;&#xA;     ORDER BY PAS1.STATUS_EFFECTIVE_DATE DESC,PAS1.PAYEE_ACCOUNT_STATUS_ID DESC)&#xD;&#xA;     ) AS PAYEE ON A.PAYEE_ACCOUNT_ID=PAYEE.PAYEE_ACCOUNT_ID &#xD;&#xA;LEFT JOIN SGT_BENEFIT_APPLICATION BENAPP ON PAYEE.application_id = BENAPP.benefit_application_id&#xD;&#xA;SET NOCOUNT OFF">
      <parameters>
        <parameter ID="@HEADERID" sfwDataType="int" />
        <parameter ID="@PAYMENTDATE" sfwDataType="DateTime" />
        <parameter ID="@PLANID" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="LoadPreviousPensionFileDetails" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="select pl.actuary_name as PLAN_NAME, * &#xD;&#xA;from sgt_actuary_file_pension_detail a&#xD;&#xA; inner join (select * &#xD;&#xA;    from sgt_actuary_file_header &#xD;&#xA;    where actuary_file_header_id=(&#xD;&#xA;     select max(actuary_file_header_id )&#xD;&#xA;     from sgt_actuary_file_header &#xD;&#xA;     where year(effective_date)=year(&#xD;&#xA;         (select max(effective_date) &#xD;&#xA;          from sgt_actuary_file_header &#xD;&#xA;          where STATUS_VALUE='PRSD' AND &#xD;&#xA;             pension_file_type_value='ANNL' and &#xD;&#xA;             FILE_TYPE_VALUE='APPF'&#xD;&#xA;    ))    &#xD;&#xA;       and pension_file_type_value='ANNL' and FILE_TYPE_VALUE='APPF'))b&#xD;&#xA;  on a.actuary_file_header_id=b.actuary_file_header_id&#xD;&#xA; left join sgt_person_Account c&#xD;&#xA;  on a.person_account_id=c.person_account_id&#xD;&#xA; left join sgt_plan pl on c.plan_id=pl.plan_id&#xD;&#xA; inner join sgt_person p on a.person_id=p.person_id&#xD;&#xA; left join ( select pa.*,pas.status_effective_date&#xD;&#xA;     from sgt_payee_Account pa&#xD;&#xA;    inner join sgt_payee_account_status pas&#xD;&#xA;     on pa.payee_Account_id=pas.payee_Account_id&#xD;&#xA;    where   payee_account_status_id  = &#xD;&#xA;      (select top 1 payee_account_status_id&#xD;&#xA;      from sgt_payee_account_status pas1 (nolock)&#xD;&#xA;      where pas1.payee_account_id = pa.payee_account_id      &#xD;&#xA;      order by pas1.payee_account_status_id desc)&#xD;&#xA;     ) as payee on a.payee_account_id=payee.payee_account_id &#xD;&#xA;where B.STATUS_VALUE='PRSD' AND ((@planid = 0) or (c.plan_id = @planid))">
      <parameters>
        <parameter ID="@planid" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="LoadPensionFileMembersTIAATFFRService" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="Select cont.* from sgt_Person_Tffr_Tiaa_Service cont  &#xD;&#xA; inner join (&#xD;&#xA;    select person_id &#xD;&#xA;    from sgt_actuary_file_pension_detail a&#xD;&#xA;     inner join (select * &#xD;&#xA;        from sgt_actuary_file_header &#xD;&#xA;        where actuary_file_header_id=(&#xD;&#xA;         select max(actuary_file_header_id )&#xD;&#xA;         from sgt_actuary_file_header &#xD;&#xA;         where year(effective_date)=year(&#xD;&#xA;             (select max(effective_date) &#xD;&#xA;              from sgt_actuary_file_header &#xD;&#xA;              where STATUS_VALUE='PRSD' AND &#xD;&#xA;                 pension_file_type_value='ANNL' and &#xD;&#xA;                 FILE_TYPE_VALUE='APPF'&#xD;&#xA;        ))    &#xD;&#xA;           and pension_file_type_value='ANNL' and FILE_TYPE_VALUE='APPF'))b&#xD;&#xA;      on a.actuary_file_header_id=b.actuary_file_header_id&#xD;&#xA;&#xD;&#xA;    where B.STATUS_VALUE='PRSD' AND a.payee_Account_id is null&#xD;&#xA;&#xD;&#xA;    union&#xD;&#xA;&#xD;&#xA;    select person_id &#xD;&#xA;    from sgt_actuary_file_pension_detail a &#xD;&#xA;    where actuary_file_header_id=@actuaryfileheaderid and a.payee_account_id is null&#xD;&#xA;    ) as person &#xD;&#xA;on cont.person_id=person.person_id&#xD;&#xA;">
      <parameters>
        <parameter ID="@actuaryfileheaderid" sfwDataType="int" />
      </parameters>
    </query>
  </queries>
  <attributes>
    <attribute ID="ActuaryFilePensionDetailId" sfwType="Column" sfwValue="actuary_file_pension_detail_id" sfwKeyNo="1" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="True" sfwDataType="int" sfwRequired="False" />
    <attribute ID="ActuaryFileHeaderId" sfwType="Column" sfwValue="actuary_file_header_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="PersonId" sfwType="Column" sfwValue="person_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="PayeeAccountId" sfwType="Column" sfwValue="payee_account_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="PersonAccountId" sfwType="Column" sfwValue="person_account_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="PlanParticipationStatusDescription" sfwType="Description" sfwValue="plan_participation_status_description" />
    <attribute ID="PlanParticipationStatusId" sfwType="Column" sfwValue="plan_participation_status_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="337" sfwDataType="int" sfwRequired="False" />
    <attribute ID="AccountRelationDescription" sfwType="Description" sfwValue="account_relation_description" />
    <attribute ID="AccountRelationId" sfwType="Column" sfwValue="account_relation_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="2225" sfwDataType="int" sfwRequired="False" />
    <attribute ID="AccountRelationValue" sfwType="Column" sfwValue="account_relation_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="PlanParticipationStatusValue" sfwType="Column" sfwValue="plan_participation_status_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="EmploymentStatusDescription" sfwType="Description" sfwValue="employment_status_description" />
    <attribute ID="EmploymentStatusId" sfwType="Column" sfwValue="employment_status_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="2605" sfwDataType="int" sfwRequired="False" />
    <attribute ID="EmploymentStatusValue" sfwType="Column" sfwValue="employment_status_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="ApplicationStatusDescription" sfwType="Description" sfwValue="application_status_description" />
    <attribute ID="ApplicationStatusId" sfwType="Column" sfwValue="application_status_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="1901" sfwDataType="int" sfwRequired="False" />
    <attribute ID="ApplicationStatusValue" sfwType="Column" sfwValue="application_status_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="PayeeStatusDescription" sfwType="Description" sfwValue="payee_status_description" />
    <attribute ID="PayeeStatusId" sfwType="Column" sfwValue="payee_status_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="2203" sfwDataType="int" sfwRequired="False" />
    <attribute ID="PayeeStatusValue" sfwType="Column" sfwValue="payee_status_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="EmploymentTypeDescription" sfwType="Description" sfwValue="employment_type_description" />
    <attribute ID="EmploymentTypeId" sfwType="Column" sfwValue="employment_type_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="313" sfwDataType="int" sfwRequired="False" />
    <attribute ID="EmploymentTypeValue" sfwType="Column" sfwValue="employment_type_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="HourlyDescription" sfwType="Description" sfwValue="hourly_description" />
    <attribute ID="HourlyId" sfwType="Column" sfwValue="hourly_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="311" sfwDataType="int" sfwRequired="False" />
    <attribute ID="HourlyValue" sfwType="Column" sfwValue="hourly_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="SeasonalDescription" sfwType="Description" sfwValue="seasonal_description" />
    <attribute ID="SeasonalId" sfwType="Column" sfwValue="seasonal_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="312" sfwDataType="int" sfwRequired="False" />
    <attribute ID="SeasonalValue" sfwType="Column" sfwValue="seasonal_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="MaritalStatusDescription" sfwType="Description" sfwValue="marital_status_description" />
    <attribute ID="MaritalStatusId" sfwType="Column" sfwValue="marital_status_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="306" sfwDataType="int" sfwRequired="False" />
    <attribute ID="MaritalStatusValue" sfwType="Column" sfwValue="marital_status_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="PlanParticipationStartDate" sfwType="Column" sfwValue="plan_participation_start_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="BenefitOptionDescription" sfwType="Description" sfwValue="benefit_option_description" />
    <attribute ID="BenefitOptionId" sfwType="Column" sfwValue="benefit_option_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="2216" sfwDataType="int" sfwRequired="False" />
    <attribute ID="BenefitOptionValue" sfwType="Column" sfwValue="benefit_option_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="PensionServiceCredit" sfwType="Column" sfwValue="pension_service_credit" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,6" />
    <attribute ID="TotalVestedServiceCredit" sfwType="Column" sfwValue="total_vested_service_credit" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,6" />
    <attribute ID="RetirementDate" sfwType="Column" sfwValue="retirement_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="SpouseDob" sfwType="Column" sfwValue="spouse_dob" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="JointAnnuitantDob" sfwType="Column" sfwValue="joint_annuitant_dob" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="OrgId" sfwType="Column" sfwValue="org_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="TotalSalary" sfwType="Column" sfwValue="total_salary" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,2" />
    <attribute ID="AccountBalance" sfwType="Column" sfwValue="account_balance" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,2" />
    <attribute ID="PensionServiceCreditBa" sfwType="Column" sfwValue="pension_service_credit_ba" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,6" />
    <attribute ID="TotalVestedServiceCreditBa" sfwType="Column" sfwValue="total_vested_service_credit_ba" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,6" />
    <attribute ID="AccruedBenefitCalculation" sfwType="Column" sfwValue="accrued_benefit_calculation" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,2" />
    <attribute ID="MinimumGuaranteeAmount" sfwType="Column" sfwValue="minimum_guarantee_amount" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,2" />
    <attribute ID="GrossCurrentMonthlyBenefitAmount" sfwType="Column" sfwValue="gross_current_monthly_benefit_amount" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,2" />
    <attribute ID="AmountPaidLtd" sfwType="Column" sfwValue="amount_paid_ltd" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,2" />
    <attribute ID="PurchasedServiceCreditSum" sfwType="Column" sfwValue="purchased_service_credit_sum" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,2" />
    <attribute ID="SsliOrUniformIncomeCommencementAge" sfwType="Column" sfwValue="ssli_or_uniform_income_commencement_age" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="9,4" />
    <attribute ID="EstimatedSsliBenefitAmount" sfwType="Column" sfwValue="estimated_ssli_benefit_amount" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,2" />
    <attribute ID="OptionFactor" sfwType="Column" sfwValue="option_factor" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,5" />
    <attribute ID="VestedErAmount" sfwType="Column" sfwValue="vested_er_amount" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,2" />
    <attribute ID="SsliChangeDate" sfwType="Column" sfwValue="ssli_change_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="TravellersBaseBenefitAmount" sfwType="Column" sfwValue="travellers_base_benefit_amount" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,2" />
    <attribute ID="TravellersCumulativeColaAmount" sfwType="Column" sfwValue="travellers_cumulative_cola_amount" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,2" />
    <attribute ID="CreatedBy" sfwType="Column" sfwValue="created_by" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="50" />
    <attribute ID="CreatedDate" sfwType="Column" sfwValue="created_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="ModifiedBy" sfwType="Column" sfwValue="modified_by" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="50" />
    <attribute ID="ModifiedDate" sfwType="Column" sfwValue="modified_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="UpdateSeq" sfwType="Column" sfwValue="update_seq" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="BenefitAccountTypeDescription" sfwType="Description" sfwValue="benefit_account_type_description" />
    <attribute ID="BenefitAccountTypeId" sfwType="Column" sfwValue="benefit_account_type_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="1904" sfwDataType="int" sfwRequired="False" />
    <attribute ID="BenefitAccountTypeValue" sfwType="Column" sfwValue="benefit_account_type_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="BenefitSubTypeDescription" sfwType="Description" sfwValue="benefit_sub_type_description" />
    <attribute ID="BenefitSubTypeId" sfwType="Column" sfwValue="benefit_sub_type_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="2201" sfwDataType="int" sfwRequired="False" />
    <attribute ID="BenefitSubTypeValue" sfwType="Column" sfwValue="benefit_sub_type_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
  </attributes>
</entity>