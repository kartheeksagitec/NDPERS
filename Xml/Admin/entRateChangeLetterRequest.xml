<?xml version="1.0" encoding="utf-8"?>
<entity ID="entRateChangeLetterRequest" sfwActive="True" sfwStatus="Valid" sfwType="BusinessRule" sfwMainCDO="icdoRateChangeLetterRequest" sfwReadOnlyRule="IsStatusIsPrcoessedOrFailed" sfwObjectID="busRateChangeLetterRequest" sfwTableName="sgt_rate_change_letter_request" sfwView="False">
  <rules>
    <rule ID="IsEffectiveDateNull" sfwMessageId="8202" sfwExpression="(this.icdoRateChangeLetterRequest.effective_date == DateTime.MinValue)" sfwObjectBased="True" />
    <rule ID="IsLetterTypeNotSelected" sfwMessageId="8203" sfwExpression="(string.IsNullOrEmpty(this.icdoRateChangeLetterRequest.letter_type_value))" sfwObjectBased="True" />
    <rule ID="IsProviderEnteredForRHIC" sfwMessageId="8213" sfwExpression="(this.icdoRateChangeLetterRequest.letter_type_value == &quot;RHIC&quot;) &amp;&amp; &#xA;(RFunc.GetValue&lt;Int32&gt;(this, &quot;ibusProviderOrganization.icdoOrganization.org_id&quot;) &gt; 0)" sfwObjectBased="True" />
    <rule ID="IsProviderNotSelectedForOthenThenRHIC" sfwMessageId="8201" sfwExpression="!(this.icdoRateChangeLetterRequest.letter_type_value == &quot;RHIC&quot;) &amp;&amp; &#xA;!(RFunc.GetValue&lt;Int32&gt;(this, &quot;ibusProviderOrganization.icdoOrganization.org_id&quot;) &gt; 0)" sfwObjectBased="True" />
    <rule ID="IsRecordDuplicated" sfwMessageId="8205" sfwExpression="!(string.IsNullOrEmpty(this.icdoRateChangeLetterRequest.letter_type_value)) &amp;&amp; &#xA;!(this.icdoRateChangeLetterRequest.effective_date == DateTime.MinValue) &amp;&amp; &#xA;(RFunc.GetValue&lt;Int32&gt;(this, &quot;ibusProviderOrganization.icdoOrganization.org_id&quot;) &gt; 0) &amp;&amp; &#xA;(this.IsRecordDuplicated() == False)" sfwObjectBased="True" />
    <rule ID="IsStatusIsPrcoessedOrFailed" sfwExpression="(this.icdoRateChangeLetterRequest.status_value == &quot;PROC&quot;) || &#xA;(this.icdoRateChangeLetterRequest.status_value == &quot;FAIL&quot;)" sfwObjectBased="True" />
    <rule ID="IsValidProvider" sfwMessageId="8204" sfwExpression="!(this.icdoRateChangeLetterRequest.letter_type_value == &quot;RHIC&quot;) &amp;&amp; &#xA;!(string.IsNullOrEmpty(this.icdoRateChangeLetterRequest.letter_type_value)) &amp;&amp; &#xA;(RFunc.GetValue&lt;Int32&gt;(this, &quot;ibusProviderOrganization.icdoOrganization.org_id&quot;) &gt; 0) &amp;&amp; &#xA;!(this.IsValidProvider() == True) &amp;&amp;&#xA;!(this.icdoRateChangeLetterRequest.letter_type_value == &quot;MDPD&quot;)&#xA;&#xA;&#xA;" sfwObjectBased="True" />
    <rule ID="IsAtLeastOnePlanCheckedForLetterTypeInsurance" sfwRuleType="Validation" sfwExpression="((this.icdoRateChangeLetterRequest.health == &quot;N&quot;) &amp;&amp; (this.icdoRateChangeLetterRequest.medd == &quot;N&quot;) &amp;&amp; &#xD;&#xA;(this.icdoRateChangeLetterRequest.dental == &quot;N&quot;) &amp;&amp; (this.icdoRateChangeLetterRequest.vision == &quot;N&quot;) &amp;&amp;&#xD;&#xA;(this.icdoRateChangeLetterRequest.life == &quot;N&quot;))" sfwMessageId="10286" sfwObjectBased="True" />
  </rules>
  <delete />
  <checklist />
  <initialload>
    <item ID="IsStatusIsPrcoessedOrFailed" sfwMode="All" sfwStatus="Active" />
  </initialload>
  <softerror />
  <harderror>
    <item ID="IsLetterTypeNotSelected" sfwMode="All" sfwStatus="Inactive" />
    <item ID="IsEffectiveDateNull" sfwMode="All" sfwStatus="Active" />
    <item ID="IsProviderNotSelectedForOthenThenRHIC" sfwMode="All" sfwStatus="Inactive" />
    <item ID="IsValidProvider" sfwMode="All" sfwStatus="Inactive" />
    <item ID="IsRecordDuplicated" sfwMode="All" sfwStatus="Inactive" />
    <item ID="IsProviderEnteredForRHIC" sfwMode="All" sfwStatus="Inactive" />
    <item ID="IsAtLeastOnePlanCheckedForLetterTypeInsurance" sfwStatus="Active" sfwMode="All" />
  </harderror>
  <validatedelete />
  <groupslist />
  <updateablecdo />
  <commonproperties />
  <constraint />
  <queries>
    <query ID="Lookup" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="Select * from sgt_rate_change_letter_request RC WITH(NOLOCK)&#xD;&#xA;left outer join sgt_organization ORG WITH(NOLOCK) on ORG.org_id = RC.provider_org_id order by 1 desc">
      <parameters />
    </query>
    <query ID="GetCountOfOrgPlanProvider" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT 1 from sgt_org_plan_provider opp WITH(NOLOCK)&#xD;&#xA;INNER JOIN sgt_org_plan op WITH(NOLOCK) ON op.org_plan_id = opp.org_plan_id&#xD;&#xA;where plan_id = @planID and provider_org_id = @providerOrgID">
      <parameters>
        <parameter ID="@planID" sfwDataType="int" />
        <parameter ID="@providerOrgID" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="LoadOrgToBillGHDVMembers" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT PAG.*,PA.*,P.*,PAPE.* FROM SGT_PERSON_ACCOUNT_GHDV PAG WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_GHDV_HISTORY PAGH WITH(NOLOCK) ON PAG.person_account_ghdv_id = PAGH.person_account_ghdv_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) on PAG.person_account_id = PA.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PA.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;INNER JOIN SGT_PERSON P WITH(NOLOCK) on PA.person_id = P.person_id&#xD;&#xA;WHERE (ibs_org_id = @orgID  or IBS_SUPPLEMENTAL_ORG_ID = @orgID) AND &#xD;&#xA;PA.plan_id = @planID AND PAGH.plan_participation_status_value = 'ENL2'&#xD;&#xA;AND @effectiveDate between PAGH.start_date and isnull(PAGH.end_date,'01/01/2900')&#xD;&#xA;AND PAGH.start_date &lt;&gt; isnull(PAGH.end_date,'01/01/2900') --ignore same dated history records">
      <parameters>
        <parameter ID="@orgID" sfwDataType="int" />
        <parameter ID="@planID" sfwDataType="int" />
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadAllEmployerOrgPlanByProvider" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="select op.*,o.* from sgt_org_plan op WITH(NOLOCK)&#xD;&#xA;INNER JOIN sgt_organization o WITH(NOLOCK) on o.org_id = op.org_id &#xD;&#xA;and o.org_type_value = 'EMPL' AND o.status_value = 'ACTV'&#xD;&#xA;INNER JOIN sgt_org_plan_provider opp WITH(NOLOCK) on opp.org_plan_id = op.org_plan_id&#xD;&#xA;and provider_org_id = @providerOrgId&#xD;&#xA;where Plan_Id = @planID and @effectiveDate between participation_start_date and isnull(participation_end_date,'9999-12-31')">
      <parameters>
        <parameter ID="@providerOrgId" sfwDataType="int" />
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
        <parameter ID="@planID" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="LoadTFFRPensionCheckGHDVMembers" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT PAG.*,PA.*,P.*,PAPE.* FROM SGT_PERSON_ACCOUNT_GHDV PAG WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_GHDV_HISTORY PAGH WITH(NOLOCK) ON PAG.person_account_ghdv_id = PAGH.person_account_ghdv_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) on PAG.person_account_id = PA.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PA.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;INNER JOIN SGT_PERSON P WITH(NOLOCK) on PA.person_id = P.person_id&#xD;&#xA;WHERE payment_method_value = 'TFPC' and ibs_flag = 'Y' AND PA.plan_id = @planID &#xD;&#xA;AND PAGH.plan_participation_status_value = 'ENL2'&#xD;&#xA;AND @effectiveDate between PAGH.start_date and isnull(PAGH.end_date,'01/01/2900')&#xD;&#xA;AND PAGH.start_date &lt;&gt; isnull(PAGH.end_date,'01/01/2900')  --ignore same dated history records">
      <parameters>
        <parameter ID="@planID" sfwDataType="int" />
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadIBSGHDVMembers" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT P.person_id as PersonId,PAGH.DENTAL_INSURANCE_TYPE_VALUE as DentalInsurance,&#xD;&#xA;PAGH.VISION_INSURANCE_TYPE_VALUE as VisionInsurance,PAGH.LEVEL_OF_COVERAGE_VALUE as LevelOfCoverage,&#xD;&#xA;PAG.*,PA.*,P.*,PAPE.* FROM SGT_PERSON_ACCOUNT_GHDV PAG WITH(NOLOCK) &#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_GHDV_HISTORY PAGH WITH(NOLOCK) ON PAG.person_account_ghdv_id = PAGH.person_account_ghdv_id &#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) on PAG.person_account_id = PA.person_account_id &#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PA.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID &#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate &#xD;&#xA;INNER JOIN SGT_PERSON P WITH(NOLOCK) on PA.person_id = P.person_id &#xD;&#xA;WHERE ibs_flag = 'Y' AND PA.plan_id = @planID AND &#xD;&#xA;ibs_org_id is null --and payment_method_value &lt;&gt; 'TFPC' --PROD Pir 4443 &#xD;&#xA;AND PAGH.plan_participation_status_value = 'ENL2' &#xD;&#xA;AND ( &#xD;&#xA;((pagh.dental_insurance_type_value is null OR pagh.dental_insurance_type_value = 'RT16') &#xD;&#xA;AND (pagh.health_insurance_type_value is null OR pagh.health_insurance_type_value = 'RT12') &#xD;&#xA;AND (pagh.vision_insurance_type_value is null OR pagh.vision_insurance_type_value ='RETR')) &#xD;&#xA;OR pagh.cobra_type_value is not null) &#xD;&#xA;AND @effectiveDate between PAGH.start_date and isnull(PAGH.end_date,'01/01/2900') &#xD;&#xA;AND PAGH.start_date &lt;&gt; isnull(PAGH.end_date,'01/01/2900') --ignore same dated history records">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
        <parameter ID="@planID" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="LoadOrgToBillEAPMembers" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT PA.*,P.*,PAPE.* FROM SGT_PERSON_ACCOUNT PA WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_EAP_HISTORY PAEH WITH(NOLOCK) ON PA.person_account_id = PAEH.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON P WITH(NOLOCK) ON P.person_id = PA.person_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PAPE.PERSON_ACCOUNT_ID = PA.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;WHERE PA.plan_id = 14 and (ibs_org_id = @orgID OR IBS_SUPPLEMENTAL_ORG_ID = @orgID)&#xD;&#xA;AND PAEH.plan_participation_status_value = 'ENL2'&#xD;&#xA;AND @effectiveDate between PAEH.start_date and isnull(PAEH.end_date,'01/01/2900')&#xD;&#xA;AND PAEH.start_date &lt;&gt; isnull(PAEH.end_date,'01/01/2900')  --ignore same dated history records">
      <parameters>
        <parameter ID="@orgID" sfwDataType="int" />
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadOrgToBillLifeMembers" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT DISTINCT PAL.*,PA.*,P.*,PAPE.* FROM SGT_PERSON_ACCOUNT_LIFE PAL WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_LIFE_HISTORY PALH WITH(NOLOCK) ON PAL.person_account_id = PALH.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) on PAL.person_account_id = PA.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PA.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;INNER JOIN SGT_PERSON P WITH(NOLOCK) on PA.person_id = P.person_id&#xD;&#xA;WHERE (ibs_org_id = @orgID  or IBS_SUPPLEMENTAL_ORG_ID = @orgID)&#xD;&#xA;AND PALH.plan_participation_status_value = 'ENL2'&#xD;&#xA;AND PALH.plan_option_status_value = 'ENLD'&#xD;&#xA;AND @effectiveDate between PALH.effective_start_date and isnull(PALH.effective_end_date,'01/01/2900')&#xD;&#xA;AND PALH.effective_start_date &lt;&gt; isnull(PALH.effective_end_date,'01/01/2900') --ignore same dated history records&#xD;&#xA;AND ((@excludeOnlyBasic = 1 and PALH.level_of_coverage_value in ('SPML','DSPL','SPSL')) OR @excludeOnlyBasic = 0)">
      <parameters>
        <parameter ID="@orgID" sfwDataType="int" />
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
        <parameter ID="@excludeOnlyBasic" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="LoadOrgToBillLTCMembers" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT DISTINCT PALO.*,PA.*,P.*,PAPE.* FROM SGT_PERSON_ACCOUNT_LTC_OPTION PALO WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_LTC_OPTION_HISTORY PALOH WITH(NOLOCK) ON PALO.person_account_ltc_option_id = PALOH.person_account_ltc_option_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) ON PALO.person_account_id = PA.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PA.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;INNER JOIN SGT_PERSON P WITH(NOLOCK) on PA.person_id = P.person_id&#xD;&#xA;WHERE (ibs_org_id = @orgID  or IBS_SUPPLEMENTAL_ORG_ID = @orgID)&#xD;&#xA;AND PALOH.plan_participation_status_value = 'ENL2'&#xD;&#xA;AND @effectiveDate between PALOH.effective_start_date and isnull(PALOH.effective_end_date,'01/01/2900')&#xD;&#xA;AND PALOH.effective_start_date &lt;&gt; isnull(PALOH.effective_end_date,'01/01/2900') --ignore same dated history records">
      <parameters>
        <parameter ID="@orgID" sfwDataType="int" />
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadTFFRPensionCheckLifeMembers" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT DISTINCT PAL.*,PA.*,P.*,PAPE.* FROM SGT_PERSON_ACCOUNT_LIFE PAL WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_LIFE_HISTORY PALH WITH(NOLOCK) ON PAL.person_account_id = PALH.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) on PAL.person_account_id = PA.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PA.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;INNER JOIN SGT_PERSON P WITH(NOLOCK) on PA.person_id = P.person_id&#xD;&#xA;WHERE payment_method_value = 'TFPC' and ibs_flag = 'Y'&#xD;&#xA;AND PALH.plan_participation_status_value = 'ENL2'&#xD;&#xA;AND @effectiveDate between PALH.effective_start_date and isnull(PALH.effective_end_date,'01/01/2900')&#xD;&#xA;AND PALH.effective_start_date &lt;&gt; isnull(PALH.effective_end_date,'01/01/2900') --ignore same dated history records&#xD;&#xA;AND ((@excludeOnlyBasic = 1 and PALH.level_of_coverage_value in ('SPML','DSPL','SPSL')) OR @excludeOnlyBasic = 0)">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
        <parameter ID="@excludeOnlyBasic" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="LoadTFFRPensionCheckLTCMembers" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT DISTINCT PALO.*,PA.*,P.*,PAPE.* FROM SGT_PERSON_ACCOUNT_LTC_OPTION PALO WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_LTC_OPTION_HISTORY PALOH WITH(NOLOCK) ON PALO.person_account_ltc_option_id = PALOH.person_account_ltc_option_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) ON PALO.person_account_id = PA.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PA.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;INNER JOIN SGT_PERSON P WITH(NOLOCK) on PA.person_id = P.person_id&#xD;&#xA;WHERE payment_method_value = 'TFPC' and ibs_flag = 'Y'&#xD;&#xA;AND PALOH.plan_participation_status_value = 'ENL2'&#xD;&#xA;AND @effectiveDate between PALOH.effective_start_date and isnull(PALOH.effective_end_date,'01/01/2900')&#xD;&#xA;AND PALOH.effective_start_date &lt;&gt; isnull(PALOH.effective_end_date,'01/01/2900') --ignore same dated history records">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadTFFRPensionCheckEAPMembers" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT PA.*,P.*,PAPE.* FROM SGT_PERSON_ACCOUNT PA WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_EAP_HISTORY PAEH WITH(NOLOCK) ON PA.person_account_id = PAEH.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON P WITH(NOLOCK) ON P.person_id = PA.person_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PAPE.PERSON_ACCOUNT_ID = PA.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;WHERE PA.plan_id = 14 and payment_method_value = 'TFPC' and ibs_flag = 'Y'&#xD;&#xA;AND PAEH.plan_participation_status_value = 'ENL2'&#xD;&#xA;AND @effectiveDate between PAEH.start_date and isnull(PAEH.end_date,'01/01/2900')&#xD;&#xA;AND PAEH.start_date &lt;&gt; isnull(PAEH.end_date,'01/01/2900') --ignore same dated history records">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadIBSLTCMembers" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT DISTINCT PALO.*,PA.*,P.*,PAPE.* FROM SGT_PERSON_ACCOUNT_LTC_OPTION PALO WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_LTC_OPTION_HISTORY PALOH WITH(NOLOCK) ON PALO.person_account_ltc_option_id = PALOH.person_account_ltc_option_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) ON PALO.person_account_id = PA.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PA.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;INNER JOIN SGT_PERSON P WITH(NOLOCK) on PA.person_id = P.person_id&#xD;&#xA;WHERE ibs_flag = 'Y' and ibs_org_id is null and IBS_SUPPLEMENTAL_ORG_ID is null &#xD;&#xA;--and payment_method_value &lt;&gt; 'TFPC' --PROD Pir 4443&#xD;&#xA;AND PALOH.plan_participation_status_value = 'ENL2'&#xD;&#xA;AND @effectiveDate between PALOH.effective_start_date and isnull(PALOH.effective_end_date,'01/01/2900')&#xD;&#xA;AND PALOH.effective_start_date &lt;&gt; isnull(PALOH.effective_end_date,'01/01/2900') --ignore same dated history records">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadIBSLifeMembers" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT DISTINCT P.person_id as PersonId, PAL.*,PA.*,P.*,PAPE.* FROM SGT_PERSON_ACCOUNT_LIFE PAL WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_LIFE_HISTORY PALH WITH(NOLOCK) ON PAL.person_account_id = PALH.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) on PAL.person_account_id = PA.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PA.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;INNER JOIN SGT_PERSON P WITH(NOLOCK) on PA.person_id = P.person_id&#xD;&#xA;WHERE ibs_flag = 'Y' and ibs_org_id is null&#xD;&#xA;--and payment_method_value &lt;&gt; 'TFPC' --PROD Pir 4443&#xD;&#xA;AND PALH.plan_participation_status_value = 'ENL2'&#xD;&#xA;AND PALH.plan_option_status_value = 'ENLD'&#xD;&#xA;and palh.life_insurance_type_value = 'REME'&#xD;&#xA;AND @effectiveDate between PALH.effective_start_date and isnull(PALH.effective_end_date,'01/01/2900')&#xD;&#xA;AND PALH.effective_start_date &lt;&gt; isnull(PALH.effective_end_date,'01/01/2900') --ignore same dated history records">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadProviderOrgPlan" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="select op.*,o.* from sgt_org_plan op WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_ORGANIZATION o WITH(NOLOCK) ON op.org_id = o.org_id&#xD;&#xA;WHERE op.org_id = @providerOrgId&#xD;&#xA;AND @effectiveDate between participation_start_date and isnull(participation_end_date,'9999-12-31')&#xD;&#xA;AND Plan_Id = @planID">
      <parameters>
        <parameter ID="@providerOrgId" sfwDataType="int" />
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
        <parameter ID="@planID" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="LoadAllProviderOrgPlans" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="select op.* from sgt_org_plan op WITH(NOLOCK)&#xD;&#xA;inner join sgt_organization o WITH(NOLOCK) on o.org_id = op.org_id and o.org_type_value='PRVD'">
      <parameters />
    </query>
    <query ID="LoadOrgToBillGHDVHistory" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT PAGH.* FROM SGT_PERSON_ACCOUNT_GHDV_HISTORY PAGH WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_GHDV PAG WITH(NOLOCK) ON PAGH.PERSON_ACCOUNT_GHDV_ID = PAG.PERSON_ACCOUNT_GHDV_ID&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) ON PAG.PERSON_ACCOUNT_ID = PA.PERSON_ACCOUNT_ID&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PAG.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;where PA.plan_id = @planID &#xD;&#xA;and (ibs_org_id IS NOT NULL OR IBS_SUPPLEMENTAL_ORG_ID IS NOT NULL)&#xD;&#xA;AND PAGH.plan_participation_status_value = 'ENL2'&#xD;&#xA;--AND @effectiveDate between PAGH.start_date and isnull(PAGH.end_date,'01/01/2900')&#xD;&#xA;AND PAGH.start_date &lt;&gt; isnull(PAGH.end_date,'01/01/2900') --ignore same dated history records&#xD;&#xA;ORDER BY ISNULL(PAGH.END_DATE,'2900-01-01') DESC,&#xD;&#xA;PAGH.START_DATE DESC,PAGH.PERSON_ACCOUNT_GHDV_HISTORY_ID DESC">
      <parameters>
        <parameter ID="@planID" sfwDataType="int" />
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadOrgToBillEAPHistory" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT PAEH.* FROM SGT_PERSON_ACCOUNT_EAP_HISTORY PAEH WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) ON PAEH.person_account_id = PA.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PAEH.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;WHERE ibs_org_id IS NOT NULL OR IBS_SUPPLEMENTAL_ORG_ID IS NOT NULL&#xD;&#xA;AND PAEH.plan_participation_status_value = 'ENL2'&#xD;&#xA;--AND @effectiveDate between PAEH.start_date and isnull(PAEH.end_date,'01/01/2900')&#xD;&#xA;AND PAEH.start_date &lt;&gt; isnull(PAEH.end_date,'01/01/2900') --ignore same dated history records&#xD;&#xA;ORDER BY ISNULL(PAEH.END_DATE,'2900-01-01') DESC,&#xD;&#xA;PAEH.START_DATE DESC,PAEH.PERSON_ACCOUNT_EAP_HISTORY_ID DESC">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadOrgToBillLTCHistory" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT DISTINCT PALOH.* FROM SGT_PERSON_ACCOUNT_LTC_OPTION_HISTORY PALOH WITH(NOLOCK) &#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_LTC_OPTION PALO WITH(NOLOCK) ON PALOH.PERSON_ACCOUNT_LTC_OPTION_ID = PALO.PERSON_ACCOUNT_LTC_OPTION_ID&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) ON PALO.person_account_id = PA.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PALO.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;WHERE ibs_org_id IS NOT NULL OR IBS_SUPPLEMENTAL_ORG_ID IS NOT NULL&#xD;&#xA;AND PALOH.plan_participation_status_value = 'ENL2'&#xD;&#xA;--AND @effectiveDate between PALOH.effective_start_date and isnull(PALOH.effective_end_date,'01/01/2900')&#xD;&#xA;AND PALOH.effective_start_date &lt;&gt; isnull(PALOH.effective_end_date,'01/01/2900') --ignore same dated history records&#xD;&#xA;ORDER BY PALOH.PERSON_ACCOUNT_LTC_OPTION_HISTORY_ID DESC">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadOrgToBillLifeHistory" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT DISTINCT PALH.* FROM SGT_PERSON_ACCOUNT_LIFE_HISTORY PALH WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) ON PALH.person_account_id = PA.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PALH.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;WHERE ibs_org_id IS NOT NULL OR IBS_SUPPLEMENTAL_ORG_ID IS NOT NULL&#xD;&#xA;AND PALH.plan_participation_status_value = 'ENL2'&#xD;&#xA;AND PALH.plan_option_status_value = 'ENLD'&#xD;&#xA;--AND @effectiveDate between PALH.effective_start_date and isnull(PALH.effective_end_date,'01/01/2900')&#xD;&#xA;AND PALH.effective_start_date &lt;&gt; isnull(PALH.effective_end_date,'01/01/2900') --ignore same dated history records&#xD;&#xA;ORDER BY PALH.PERSON_ACCOUNT_LIFE_HISTORY_ID DESC">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadOrgToBillLifeOptions" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT DISTINCT PALO.* FROM SGT_PERSON_ACCOUNT_LIFE_OPTION PALO WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_LIFE_HISTORY PALH WITH(NOLOCK) ON PALO.person_account_id = PALH.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) ON PALO.person_account_id = PA.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PALO.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;WHERE ibs_org_id IS NOT NULL OR IBS_SUPPLEMENTAL_ORG_ID IS NOT NULL&#xD;&#xA;AND PALH.plan_participation_status_value = 'ENL2'&#xD;&#xA;AND PALH.plan_option_status_value = 'ENLD'&#xD;&#xA;AND @effectiveDate between PALH.effective_start_date and isnull(PALH.effective_end_date,'01/01/2900')&#xD;&#xA;AND PALH.effective_start_date &lt;&gt; isnull(PALH.effective_end_date,'01/01/2900') --ignore same dated history records">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadTFFRPensionCheckLifeHistory" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT DISTINCT PALH.* FROM SGT_PERSON_ACCOUNT_LIFE_HISTORY PALH WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) ON PALH.person_account_id = PA.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PALH.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;WHERE PAPE.payment_method_value = 'TFPC' and ibs_flag = 'Y'&#xD;&#xA;AND PALH.plan_participation_status_value = 'ENL2'&#xD;&#xA;AND PALH.plan_option_status_value = 'ENLD'&#xD;&#xA;AND @effectiveDate between PALH.effective_start_date and isnull(PALH.effective_end_date,'01/01/2900')&#xD;&#xA;AND PALH.effective_start_date &lt;&gt; isnull(PALH.effective_end_date,'01/01/2900') --ignore same dated history records">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadTFFRPensionCheckLTCHistory" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT DISTINCT PALOH.* FROM SGT_PERSON_ACCOUNT_LTC_OPTION_HISTORY PALOH WITH(NOLOCK) &#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_LTC_OPTION PALO WITH(NOLOCK) ON PALOH.PERSON_ACCOUNT_LTC_OPTION_ID = PALO.PERSON_ACCOUNT_LTC_OPTION_ID&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) ON PALO.person_account_id = PA.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PALO.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;WHERE payment_method_value = 'TFPC' and ibs_flag = 'Y'&#xD;&#xA;AND PALOH.plan_participation_status_value = 'ENL2'&#xD;&#xA;AND @effectiveDate between PALOH.effective_start_date and isnull(PALOH.effective_end_date,'01/01/2900')&#xD;&#xA;AND PALOH.effective_start_date &lt;&gt; isnull(PALOH.effective_end_date,'01/01/2900') --ignore same dated history records">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadTFFRPensionCheckEAPHistory" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT PAEH.* FROM SGT_PERSON_ACCOUNT_EAP_HISTORY PAEH WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) ON PAEH.person_account_id = PA.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PAEH.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;WHERE payment_method_value = 'TFPC' and ibs_flag = 'Y'&#xD;&#xA;AND PAEH.plan_participation_status_value = 'ENL2'&#xD;&#xA;AND @effectiveDate between PAEH.start_date and isnull(PAEH.end_date,'01/01/2900')&#xD;&#xA;AND PAEH.start_date &lt;&gt; isnull(PAEH.end_date,'01/01/2900') --ignore same dated history records">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadTFFRPensionCheckGHDVHistory" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT PAGH.* FROM SGT_PERSON_ACCOUNT_GHDV_HISTORY PAGH WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_GHDV PAG WITH(NOLOCK) ON PAGH.PERSON_ACCOUNT_GHDV_ID = PAG.PERSON_ACCOUNT_GHDV_ID&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) ON PAG.PERSON_ACCOUNT_ID = PA.PERSON_ACCOUNT_ID&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PAG.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;where PA.plan_id = @planID AND PAPE.payment_method_value = 'TFPC' and &#xD;&#xA;PAPE.ibs_flag = 'Y' AND PAGH.plan_participation_status_value = 'ENL2'&#xD;&#xA;AND @effectiveDate between PAGH.start_date and isnull(PAGH.end_date,'01/01/2900')&#xD;&#xA;AND PAGH.start_date &lt;&gt; isnull(PAGH.end_date,'01/01/2900') --ignore same dated history records">
      <parameters>
        <parameter ID="@planID" sfwDataType="int" />
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadTFFRPensionCheckLifeOptions" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT DISTINCT PALO.* FROM SGT_PERSON_ACCOUNT_LIFE_OPTION PALO WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_LIFE_HISTORY PALH WITH(NOLOCK) ON PALO.person_account_id = PALH.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) ON PALO.person_account_id = PA.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PALO.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;WHERE pape.payment_method_value = 'TFPC' and ibs_flag = 'Y'&#xD;&#xA;AND PALH.plan_participation_status_value = 'ENL2'&#xD;&#xA;AND PALH.plan_option_status_value = 'ENLD'&#xD;&#xA;AND @effectiveDate between PALH.effective_start_date and isnull(PALH.effective_end_date,'01/01/2900')&#xD;&#xA;AND PALH.effective_start_date &lt;&gt; isnull(PALH.effective_end_date,'01/01/2900') --ignore same dated history records">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadIBSMembersGHDVHistory" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT PAGH.* FROM SGT_PERSON_ACCOUNT_GHDV_HISTORY PAGH WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_GHDV PAG WITH(NOLOCK) ON PAGH.PERSON_ACCOUNT_GHDV_ID = PAG.PERSON_ACCOUNT_GHDV_ID&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) ON PAG.PERSON_ACCOUNT_ID = PA.PERSON_ACCOUNT_ID&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PAG.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;where ibs_flag = 'Y' and plan_id = @planID&#xD;&#xA;and ibs_org_id is null --and payment_method_value &lt;&gt; 'TFPC' --PROD PIR 4443&#xD;&#xA;AND PAGH.plan_participation_status_value = 'ENL2'&#xD;&#xA;AND (&#xD;&#xA;    ((pagh.dental_insurance_type_value is null OR pagh.dental_insurance_type_value = 'RT16') &#xD;&#xA;    AND (pagh.health_insurance_type_value is null OR pagh.health_insurance_type_value = 'RT12')&#xD;&#xA;    AND (pagh.vision_insurance_type_value is null OR pagh.vision_insurance_type_value ='RETR'))&#xD;&#xA;    OR pagh.cobra_type_value is not null)&#xD;&#xA;--AND @effectiveDate between PAGH.start_date and isnull(PAGH.end_date,'01/01/2900')&#xD;&#xA;AND PAGH.start_date &lt;&gt; isnull(PAGH.end_date,'01/01/2900') --ignore same dated history records&#xD;&#xA;ORDER BY ISNULL(PAGH.END_DATE,'2900-01-01') DESC,&#xD;&#xA;PAGH.START_DATE DESC,PAGH.PERSON_ACCOUNT_GHDV_HISTORY_ID DESC">
      <parameters>
        <parameter ID="@planID" sfwDataType="int" />
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadIBSMembersLifeHistory" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT DISTINCT PALH.* FROM SGT_PERSON_ACCOUNT_LIFE_HISTORY PALH WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) ON PALH.person_account_id = PA.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PALH.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;WHERE  ibs_flag = 'Y' and ibs_org_id is null&#xD;&#xA;--and payment_method_value &lt;&gt; 'TFPC' --PROD PIR 4443&#xD;&#xA;AND PALH.plan_participation_status_value = 'ENL2'&#xD;&#xA;AND PALH.plan_option_status_value = 'ENLD'&#xD;&#xA;and palh.life_insurance_type_value = 'REME'&#xD;&#xA;--AND @effectiveDate between PALH.effective_start_date and isnull(PALH.effective_end_date,'01/01/2900')&#xD;&#xA;AND PALH.effective_start_date &lt;&gt; isnull(PALH.effective_end_date,'01/01/2900') --ignore same dated history records&#xD;&#xA;ORDER BY PALH.PERSON_ACCOUNT_LIFE_HISTORY_ID DESC">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadIBSMembersLifeOptions" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT DISTINCT PALO.* FROM SGT_PERSON_ACCOUNT_LIFE_OPTION PALO WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_LIFE_HISTORY PALH WITH(NOLOCK) ON PALO.person_account_id = PALH.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) ON PALO.person_account_id = PA.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PALO.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;WHERE ibs_flag = 'Y' and ibs_org_id is null &#xD;&#xA;--and payment_method_value &lt;&gt; 'TFPC' --PROD PIR 4443&#xD;&#xA;AND PALH.plan_participation_status_value = 'ENL2'&#xD;&#xA;AND PALH.plan_option_status_value = 'ENLD'&#xD;&#xA;and palh.life_insurance_type_value = 'REME'&#xD;&#xA;AND @effectiveDate between PALH.effective_start_date and isnull(PALH.effective_end_date,'01/01/2900')&#xD;&#xA;AND PALH.effective_start_date &lt;&gt; isnull(PALH.effective_end_date,'01/01/2900') --ignore same dated history records">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadIBSMembersLTCHistory" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT DISTINCT PALOH.* FROM SGT_PERSON_ACCOUNT_LTC_OPTION_HISTORY PALOH WITH(NOLOCK) &#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_LTC_OPTION PALO WITH(NOLOCK) ON PALOH.PERSON_ACCOUNT_LTC_OPTION_ID = PALO.PERSON_ACCOUNT_LTC_OPTION_ID&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) on PALO.person_account_id = PA.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PALO.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;WHERE ibs_flag = 'Y' and ibs_org_id is null and IBS_SUPPLEMENTAL_ORG_ID is null &#xD;&#xA;--and payment_method_value &lt;&gt; 'TFPC' --PROD PIR 4443&#xD;&#xA;AND PALOH.plan_participation_status_value = 'ENL2'&#xD;&#xA;--AND @effectiveDate between PALOH.effective_start_date and isnull(PALOH.effective_end_date,'01/01/2900')&#xD;&#xA;AND PALOH.effective_start_date &lt;&gt; isnull(PALOH.effective_end_date,'01/01/2900') --ignore same dated history records&#xD;&#xA;ORDER BY PALOH.PERSON_ACCOUNT_LTC_OPTION_HISTORY_ID DESC">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="IsValidProvider" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="select count(*) from sgt_organization WITH(NOLOCK) where org_code = @org_code">
      <parameters>
        <parameter ID="@org_code" />
      </parameters>
    </query>
    <query ID="LoadActiveLifeMembers" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="select distinct pa.*,per.*,p.*,pe.*,ped.*,pal.* from sgt_person_account_employment_detail paed WITH(NOLOCK)&#xD;&#xA;inner join sgt_person_employment_detail ped WITH(NOLOCK) on paed.PERSON_EMPLOYMENT_DTL_ID = ped.PERSON_EMPLOYMENT_DTL_ID&#xD;&#xA;inner join sgt_person_employment pe WITH(NOLOCK) on pe.person_employment_id = ped.person_employment_id&#xD;&#xA;inner join sgt_person_account pa WITH(NOLOCK) on pa.person_account_id = paed.person_account_id&#xD;&#xA;inner join sgt_plan p WITH(NOLOCK) on p.plan_id = pa.plan_id&#xD;&#xA;inner join sgt_person per WITH(NOLOCK) on per.person_id = pa.person_id&#xD;&#xA;inner join sgt_person_account_life pal WITH(NOLOCK) on pal.person_account_id = pa.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_LIFE_HISTORY PALH WITH(NOLOCK) ON PAL.person_account_id = PALH.person_account_id&#xD;&#xA;where paed.election_value = 'ENLD' and p.plan_id = 13 and&#xD;&#xA;@effectiveDate between ped.start_date and isnull(ped.end_date,'01/01/2900') and&#xD;&#xA;@effectiveDate between pe.start_date and isnull(pe.end_date,'01/01/2900')&#xD;&#xA;AND PALH.plan_participation_status_value = 'ENL2'&#xD;&#xA;AND PALH.plan_option_status_value = 'ENLD'&#xD;&#xA;and palh.life_insurance_type_value = 'NREM'&#xD;&#xA;AND @effectiveDate between PALH.effective_start_date and isnull(PALH.effective_end_date,'01/01/2900')&#xD;&#xA;AND PALH.effective_start_date &lt;&gt; isnull(PALH.effective_end_date,'01/01/2900') --ignore same dated history records&#xD;&#xA;AND ((@excludeOnlyBasic = 1 and PALH.level_of_coverage_value in ('SPML','DSPL','SPSL')) OR @excludeOnlyBasic = 0)">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
        <parameter ID="@excludeOnlyBasic" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="LoadActiveLifeMembersHistory" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="select distinct palh.* from sgt_person_account_employment_detail paed WITH(NOLOCK)&#xD;&#xA;inner join sgt_person_employment_detail ped WITH(NOLOCK) on paed.PERSON_EMPLOYMENT_DTL_ID = ped.PERSON_EMPLOYMENT_DTL_ID&#xD;&#xA;inner join sgt_person_employment pe WITH(NOLOCK) on pe.person_employment_id = ped.person_employment_id&#xD;&#xA;inner join sgt_person_account pa WITH(NOLOCK) on pa.person_account_id = paed.person_account_id&#xD;&#xA;inner join sgt_person_account_life_history palh WITH(NOLOCK) on palh.person_account_id = pa.person_account_id&#xD;&#xA;where paed.election_value = 'ENLD' AND&#xD;&#xA;paed.plan_id = 13 AND&#xD;&#xA;PALH.plan_participation_status_value = 'ENL2' AND &#xD;&#xA;PALH.plan_option_status_value = 'ENLD' AND&#xD;&#xA;palh.life_insurance_type_value = 'NREM' AND&#xD;&#xA;@effectiveDate between ped.start_date and isnull(ped.end_date,'01/01/2900') and&#xD;&#xA;@effectiveDate between pe.start_date and isnull(pe.end_date,'01/01/2900') and&#xD;&#xA;@effectiveDate between PALH.effective_start_date and isnull(PALH.effective_end_date,'01/01/2900') and&#xD;&#xA;PALH.effective_start_date &lt;&gt; isnull(PALH.effective_end_date,'01/01/2900') --ignore same dated history records&#xD;&#xA;order by palh.PERSON_ACCOUNT_LIFE_HISTORY_ID desc">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadActiveLifeOption" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="select palh.* from sgt_person_account_employment_detail paed WITH(NOLOCK)&#xD;&#xA;inner join sgt_person_employment_detail ped WITH(NOLOCK) on paed.PERSON_EMPLOYMENT_DTL_ID = ped.PERSON_EMPLOYMENT_DTL_ID&#xD;&#xA;inner join sgt_person_employment pe WITH(NOLOCK) on pe.person_employment_id = ped.person_employment_id&#xD;&#xA;inner join sgt_person_account pa WITH(NOLOCK) on pa.person_account_id = paed.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_LIFE_HISTORY PALH WITH(NOLOCK) ON PA.person_account_id = PALH.person_account_id&#xD;&#xA;where paed.election_value = 'ENLD' and&#xD;&#xA;paed.plan_id = 13 AND&#xD;&#xA;PALH.plan_participation_status_value = 'ENL2' AND PALH.plan_option_status_value = 'ENLD' and&#xD;&#xA;palh.life_insurance_type_value = 'NREM' AND&#xD;&#xA;@effectiveDate between ped.start_date and isnull(ped.end_date,'01/01/2900') and&#xD;&#xA;@effectiveDate between pe.start_date and isnull(pe.end_date,'01/01/2900') and&#xD;&#xA;@effectiveDate between PALH.effective_start_date and isnull(PALH.effective_end_date,'01/01/2900') and&#xD;&#xA;PALH.effective_start_date &lt;&gt; isnull(PALH.effective_end_date,'01/01/2900') --ignore same dated history records">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadAllPensionCheckMembersNetCheckAmount" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="select papit.payee_account_id as payee_account_id,sum(amount * item_type_direction) as NetCheckAmount from &#xD;&#xA;sgt_payee_account_payment_item_type papit&#xD;&#xA;inner join sgt_payment_item_type pit on papit.payment_item_type_id = pit.payment_item_type_id&#xD;&#xA;where @effectiveDate between start_date and isnull(end_date,'9999-12-31')&#xD;&#xA;and exists(select 1 from sgt_person_account_payment_election pape where pape.payment_method_value = 'PNCH'&#xD;&#xA;and papit.payee_account_id = pape.payee_account_id)&#xD;&#xA;group by papit.payee_account_id">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadHealthRateStructureCodes" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT * &#xD;&#xA;                        FROM SGT_ORG_PLAN_HEALTH_MEDICARE_PART_D_RATE A WITH(NOLOCK)&#xD;&#xA;                  INNER JOIN SGT_ORG_PLAN_GROUP_HEALTH_MEDICARE_PART_D_COVERAGE_REF B WITH(NOLOCK)&#xD;&#xA;                        ON A.ORG_PLAN_GROUP_HEALTH_MEDICARE_PART_D_COVERAGE_REF_ID = &#xD;&#xA;                              B.ORG_PLAN_GROUP_HEALTH_MEDICARE_PART_D_COVERAGE_REF_ID&#xD;&#xA;                  INNER JOIN SGT_ORG_PLAN_GROUP_HEALTH_MEDICARE_PART_D_RATE_REF C WITH(NOLOCK)&#xD;&#xA;                        ON B.ORG_PLAN_GROUP_HEALTH_MEDICARE_PART_D_RATE_REF_ID =&#xD;&#xA;                              C.ORG_PLAN_GROUP_HEALTH_MEDICARE_PART_D_RATE_REF_ID&#xD;&#xA;                  WHERE A.EFFECTIVE_DATE = @effective_date">
      <parameters>
        <parameter ID="@effective_date" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadDentalRateStructureCodes" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="select * from SGT_ORG_PLAN_DENTAL_RATE WITH(NOLOCK) where effective_date =@effective_date">
      <parameters>
        <parameter ID="@effective_date" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadVisionlRateStructureCodes" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="select * from SGT_ORG_PLAN_VISION_RATE where effective_date =@effective_date">
      <parameters>
        <parameter ID="@effective_date" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadIBSMedicareMembers" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT DISTINCT P.person_id as PersonId, PALO.*,PA.*,P.*,PAPE.* FROM SGT_PERSON_ACCOUNT_MEDICARE_PART_D_HISTORY PALO WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) ON PALO.person_account_id = PA.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PA.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;INNER JOIN SGT_PERSON P WITH(NOLOCK) on PA.person_id = P.person_id&#xD;&#xA;WHERE ibs_flag = 'Y' and ibs_org_id is null&#xD;&#xA;--and payment_method_value &lt;&gt; 'TFPC' --PROD Pir 4443&#xD;&#xA;AND PALO.plan_participation_status_value = 'ENL2'&#xD;&#xA;AND @effectiveDate between PALO.start_date and isnull(PALO.end_date,'01/01/2900')&#xD;&#xA;AND PALO.start_date &lt;&gt; isnull(PALO.end_date,'01/01/2900') --ignore same dated history records">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadIBSMembersMedicareHistory" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT PALO.* FROM SGT_PERSON_ACCOUNT_MEDICARE_PART_D_HISTORY PALO WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) ON PALO.person_account_id = PA.person_account_id&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PA.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @effectiveDate&#xD;&#xA;INNER JOIN SGT_PERSON P WITH(NOLOCK) on PA.person_id = P.person_id&#xD;&#xA;WHERE ibs_flag = 'Y' and ibs_org_id is null&#xD;&#xA;--and payment_method_value &lt;&gt; 'TFPC' --PROD Pir 4443&#xD;&#xA;AND PALO.plan_participation_status_value = 'ENL2'&#xD;&#xA;--AND @effectiveDate between PALO.start_date and isnull(PALO.end_date,'01/01/2900')&#xD;&#xA;AND PALO.start_date &lt;&gt; isnull(PALO.end_date,'01/01/2900') --ignore same dated history records">
      <parameters>
        <parameter ID="@effectiveDate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadIBSRetireeMembers" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="DECLARE @HEALTH CHAR(1)&#xD;&#xA;DECLARE @DENTAL CHAR(1)&#xD;&#xA;DECLARE @VISION CHAR(1)&#xD;&#xA;DECLARE @MEDICARE CHAR(1)&#xD;&#xA;DECLARE @LIFE CHAR(1)&#xD;&#xA;DECLARE @CURRENTDATE DATETIME = GETDATE()&#xD;&#xA;DECLARE @RATE_CHANGE_REQUEST_ID INT&#xD;&#xA;DECLARE @PREV_HISTORY_DATE DATETIME = DATEADD(DD,-1, @EFFECTIVEDATE)&#xD;&#xA;&#xD;&#xA;SELECT @HEALTH = HEALTH&#xD;&#xA;,@DENTAL = DENTAL&#xD;&#xA;,@VISION = VISION&#xD;&#xA;,@MEDICARE = MEDD&#xD;&#xA;,@LIFE = LIFE&#xD;&#xA;,@RATE_CHANGE_REQUEST_ID = RATE_CHANGE_LETTER_REQUEST_ID&#xD;&#xA;FROM &#xD;&#xA;SGT_RATE_CHANGE_LETTER_REQUEST WHERE STATUS_VALUE = 'PEND'&#xD;&#xA;&#xD;&#xA;SELECT * FROM&#xD;&#xA;(&#xD;&#xA;SELECT &#xD;&#xA;  P.PERSON_ID as PERSON_ID&#xD;&#xA;FROM SGT_PERSON_ACCOUNT_GHDV PAG WITH(NOLOCK) &#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_GHDV_HISTORY PAGH WITH(NOLOCK) ON PAG.PERSON_ACCOUNT_GHDV_ID = PAGH.PERSON_ACCOUNT_GHDV_ID &#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) ON PAG.PERSON_ACCOUNT_ID = PA.PERSON_ACCOUNT_ID &#xD;&#xA;AND ((PA.PLAN_ID IN (&#xD;&#xA;CASE WHEN @HEALTH = 'Y' THEN 12 ELSE 0 END, &#xD;&#xA;CASE WHEN @DENTAL = 'Y' THEN 16 ELSE 0 END,&#xD;&#xA;CASE WHEN @VISION = 'Y' THEN 17 ELSE 0 END)))&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PA.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID &#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @EFFECTIVEDATE &#xD;&#xA;INNER JOIN SGT_PERSON P WITH(NOLOCK) ON PA.PERSON_ID = P.PERSON_ID &#xD;&#xA;INNER JOIN ( &#xD;&#xA;&#x9;SELECT &#xD;&#xA;&#x9;ROW_NUMBER() OVER (PARTITION BY PERADD.PERSON_ID ORDER BY &#xD;&#xA;&#x9;&#x9;CASE WHEN ADDRESS_TYPE_VALUE = 'TEMP' AND ( CONVERT(DATETIME,PERADD.START_DATE,101) &lt;= CONVERT(DATETIME,GETDATE(),101) &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND CONVERT(DATETIME, isnull(PERADD.END_DATE,'99991231'),101) &gt;= CONVERT(DATETIME,GETDATE(),101)) THEN 0&#xD;&#xA;&#x9;&#x9;&#x9;WHEN ADDRESS_TYPE_VALUE = 'PERM' AND (PERADD.END_DATE IS NULL) THEN 1&#xD;&#xA;&#x9;&#x9;&#x9;WHEN ADDRESS_TYPE_VALUE = 'PERM' AND PERADD.END_DATE IS NOT NULL THEN 2&#xD;&#xA;&#x9;&#x9;&#x9;ELSE 3&#xD;&#xA;&#x9;&#x9;END, PERADD.END_DATE DESC) AS SR_NO,&#xD;&#xA;&#x9;&#x9;&#x9;PERADD.* &#xD;&#xA;FROM SGT_PERSON_ADDRESS AS PERADD WITH(NOLOCK)&#xD;&#xA;) as PADD ON PADD.PERSON_ID = P.PERSON_ID and PADD.SR_NO = 1&#xD;&#xA;LEFT OUTER JOIN SGT_PERSON_ACCOUNT_GHDV_HISTORY PREVHIS WITH(NOLOCK) ON PREVHIS.PERSON_ACCOUNT_GHDV_ID = PAG.PERSON_ACCOUNT_GHDV_ID &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND PREVHIS.[START_DATE] &lt;&gt; ISNULL(PREVHIS.END_DATE,'01/01/2900') AND (@PREV_HISTORY_DATE BETWEEN PREVHIS.[START_DATE] AND ISNULL(PREVHIS.END_DATE,'01/01/2900'))&#xD;&#xA;WHERE PAPE.IBS_FLAG = 'Y' AND&#xD;&#xA;PAPE.IBS_ORG_ID IS NULL&#xD;&#xA;AND PAGH.PLAN_PARTICIPATION_STATUS_VALUE = 'ENL2' &#xD;&#xA;AND ( &#xD;&#xA;((PAGH.DENTAL_INSURANCE_TYPE_VALUE IS NULL OR PAGH.DENTAL_INSURANCE_TYPE_VALUE = 'RT16') &#xD;&#xA;AND (PAGH.HEALTH_INSURANCE_TYPE_VALUE IS NULL OR PAGH.HEALTH_INSURANCE_TYPE_VALUE = 'RT12') &#xD;&#xA;AND (PAGH.VISION_INSURANCE_TYPE_VALUE IS NULL OR PAGH.VISION_INSURANCE_TYPE_VALUE ='RETR')) &#xD;&#xA;OR PAGH.COBRA_TYPE_VALUE IS NOT NULL) &#xD;&#xA;AND @EFFECTIVEDATE BETWEEN PAGH.START_DATE AND ISNULL(PAGH.END_DATE,'01/01/2900') &#xD;&#xA;AND PAGH.START_DATE &lt;&gt; ISNULL(PAGH.END_DATE,'01/01/2900')&#xD;&#xA;--AND (PADD.UNDELIVERABLE_ADDRESS  IS NULL &#xD;&#xA;--OR PADD.UNDELIVERABLE_ADDRESS = 'N')  &#xD;&#xA;AND (PADD.END_DATE IS NULL OR PADD.END_DATE &gt; @CURRENTDATE)&#xD;&#xA;AND (PREVHIS.PERSON_ACCOUNT_GHDV_HISTORY_ID IS NULL OR PREVHIS.PERSON_ACCOUNT_GHDV_HISTORY_ID = PAGH.PERSON_ACCOUNT_GHDV_HISTORY_ID OR &#xD;&#xA;(PREVHIS.PLAN_PARTICIPATION_STATUS_VALUE = 'ENL2' AND 1 = CASE PA.PLAN_ID WHEN 12 THEN&#xD;&#xA;(CASE WHEN PAGH.HEALTH_INSURANCE_TYPE_VALUE = 'RT12' AND PREVHIS.HEALTH_INSURANCE_TYPE_VALUE != 'RT12' THEN 0 ELSE 1 END) WHEN 16 THEN &#xD;&#xA;(CASE WHEN PAGH.DENTAL_INSURANCE_TYPE_VALUE = 'RT16' AND PREVHIS.DENTAL_INSURANCE_TYPE_VALUE != 'RT16' THEN 0 ELSE 1 END) WHEN 17 THEN &#xD;&#xA;(CASE WHEN PAGH.VISION_INSURANCE_TYPE_VALUE = 'RETR' AND PREVHIS.VISION_INSURANCE_TYPE_VALUE != 'RETR' THEN 0 ELSE 1 END) END))&#xD;&#xA;&#xD;&#xA;UNION &#xD;&#xA;&#xD;&#xA;SELECT &#xD;&#xA;  PAMPH.MEMBER_PERSON_ID AS PERSON_ID&#xD;&#xA;FROM SGT_PERSON_ACCOUNT_MEDICARE_PART_D_HISTORY PAMPH WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) ON PAMPH.PERSON_ACCOUNT_ID = PA.PERSON_ACCOUNT_ID &#xD;&#xA;AND PA.PLAN_ID = CASE WHEN @MEDICARE = 'Y' THEN 9 ELSE 0 END&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PA.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @EFFECTIVEDATE&#xD;&#xA;INNER JOIN SGT_PERSON P WITH(NOLOCK) ON PA.PERSON_ID = P.PERSON_ID&#xD;&#xA;INNER JOIN ( &#xD;&#xA;&#x9;SELECT &#xD;&#xA;&#x9;ROW_NUMBER() OVER (PARTITION BY PERADD.PERSON_ID ORDER BY &#xD;&#xA;&#x9;&#x9;CASE WHEN ADDRESS_TYPE_VALUE = 'TEMP' AND ( CONVERT(DATETIME,PERADD.START_DATE,101) &lt;= CONVERT(DATETIME,GETDATE(),101) &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND CONVERT(DATETIME, isnull(PERADD.END_DATE,'99991231'),101) &gt;= CONVERT(DATETIME,GETDATE(),101)) THEN 0&#xD;&#xA;&#x9;&#x9;&#x9;WHEN ADDRESS_TYPE_VALUE = 'PERM' AND (PERADD.END_DATE IS NULL) THEN 1&#xD;&#xA;&#x9;&#x9;&#x9;WHEN ADDRESS_TYPE_VALUE = 'PERM' AND PERADD.END_DATE IS NOT NULL THEN 2&#xD;&#xA;&#x9;&#x9;&#x9;ELSE 3&#xD;&#xA;&#x9;&#x9;END, PERADD.END_DATE DESC) AS SR_NO,&#xD;&#xA;&#x9;&#x9;&#x9;PERADD.* &#xD;&#xA;FROM SGT_PERSON_ADDRESS AS PERADD WITH(NOLOCK)&#xD;&#xA;) as PADD ON PADD.PERSON_ID = PAMPH.MEMBER_PERSON_ID and PADD.SR_NO = 1 --NEED TO CHECK MEMBER ADDRESS IS DELIVERABLE OR NOT&#xD;&#xA;WHERE PAPE.IBS_FLAG = 'Y' AND PAPE.IBS_ORG_ID IS NULL&#xD;&#xA;AND PAMPH.PLAN_PARTICIPATION_STATUS_VALUE = 'ENL2'&#xD;&#xA;AND @EFFECTIVEDATE BETWEEN PAMPH.START_DATE AND ISNULL(PAMPH.END_DATE,'01/01/2900')&#xD;&#xA;AND PAMPH.START_DATE &lt;&gt; ISNULL(PAMPH.END_DATE,'01/01/2900')&#xD;&#xA;--AND (PADD.UNDELIVERABLE_ADDRESS  IS NULL &#xD;&#xA;--OR PADD.UNDELIVERABLE_ADDRESS = 'N')  &#xD;&#xA;AND (PADD.END_DATE IS NULL OR PADD.END_DATE &gt; @CURRENTDATE)&#xD;&#xA;&#xD;&#xA;UNION&#xD;&#xA;&#xD;&#xA;SELECT&#xD;&#xA;   P.PERSON_ID AS PERSON_ID&#xD;&#xA;FROM SGT_PERSON_ACCOUNT_LIFE PAL WITH(NOLOCK)&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_LIFE_HISTORY PALH WITH(NOLOCK) ON PAL.PERSON_ACCOUNT_ID = PALH.PERSON_ACCOUNT_ID&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT PA WITH(NOLOCK) ON PAL.PERSON_ACCOUNT_ID = PA.PERSON_ACCOUNT_ID&#xD;&#xA;AND PA.PLAN_ID = CASE WHEN @LIFE = 'Y' THEN 13 ELSE 0 END&#xD;&#xA;INNER JOIN SGT_PERSON_ACCOUNT_PAYMENT_ELECTION PAPE WITH(NOLOCK) ON PA.PERSON_ACCOUNT_ID = PAPE.PERSON_ACCOUNT_ID&#xD;&#xA;AND IBS_EFFECTIVE_DATE &lt;= @EFFECTIVEDATE&#xD;&#xA;INNER JOIN SGT_PERSON P WITH(NOLOCK) ON PA.PERSON_ID = P.PERSON_ID &#xD;&#xA;INNER JOIN ( &#xD;&#xA;&#x9;SELECT &#xD;&#xA;&#x9;ROW_NUMBER() OVER (PARTITION BY PERADD.PERSON_ID ORDER BY &#xD;&#xA;&#x9;&#x9;CASE WHEN ADDRESS_TYPE_VALUE = 'TEMP' AND ( CONVERT(DATETIME,PERADD.START_DATE,101) &lt;= CONVERT(DATETIME,GETDATE(),101) &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND CONVERT(DATETIME, isnull(PERADD.END_DATE,'99991231'),101) &gt;= CONVERT(DATETIME,GETDATE(),101)) THEN 0&#xD;&#xA;&#x9;&#x9;&#x9;WHEN ADDRESS_TYPE_VALUE = 'PERM' AND (PERADD.END_DATE IS NULL) THEN 1&#xD;&#xA;&#x9;&#x9;&#x9;WHEN ADDRESS_TYPE_VALUE = 'PERM' AND PERADD.END_DATE IS NOT NULL THEN 2&#xD;&#xA;&#x9;&#x9;&#x9;ELSE 3&#xD;&#xA;&#x9;&#x9;END, PERADD.END_DATE DESC) AS SR_NO,&#xD;&#xA;&#x9;&#x9;&#x9;PERADD.* &#xD;&#xA;FROM SGT_PERSON_ADDRESS AS PERADD WITH(NOLOCK)&#xD;&#xA;) as PADD ON PADD.PERSON_ID = P.PERSON_ID and PADD.SR_NO = 1&#xD;&#xA;LEFT OUTER JOIN SGT_PERSON_ACCOUNT_LIFE_HISTORY PREVHIS WITH(NOLOCK) ON PREVHIS.PERSON_ACCOUNT_ID = PALH.PERSON_ACCOUNT_ID &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND PREVHIS.EFFECTIVE_START_DATE &lt;&gt; ISNULL(PREVHIS.EFFECTIVE_END_DATE,'01/01/2900') AND (@PREV_HISTORY_DATE BETWEEN PREVHIS.EFFECTIVE_START_DATE AND ISNULL(PREVHIS.EFFECTIVE_END_DATE,'01/01/2900'))&#xD;&#xA;WHERE PAPE.IBS_FLAG = 'Y' &#xD;&#xA;AND PAPE.IBS_ORG_ID IS NULL&#xD;&#xA;AND PALH.PLAN_PARTICIPATION_STATUS_VALUE = 'ENL2'&#xD;&#xA;AND PALH.PLAN_OPTION_STATUS_VALUE = 'ENLD'&#xD;&#xA;AND PALH.LIFE_INSURANCE_TYPE_VALUE = 'REME'&#xD;&#xA;AND @EFFECTIVEDATE BETWEEN PALH.EFFECTIVE_START_DATE AND ISNULL(PALH.EFFECTIVE_END_DATE,'01/01/2900')&#xD;&#xA;AND PALH.EFFECTIVE_START_DATE &lt;&gt; ISNULL(PALH.EFFECTIVE_END_DATE,'01/01/2900')&#xD;&#xA;--AND (PADD.UNDELIVERABLE_ADDRESS  IS NULL &#xD;&#xA;--OR PADD.UNDELIVERABLE_ADDRESS = 'N')  &#xD;&#xA;AND (PADD.END_DATE IS NULL OR PADD.END_DATE &gt; @CURRENTDATE)&#xD;&#xA;AND (PREVHIS.PERSON_ACCOUNT_LIFE_HISTORY_ID IS NULL OR PREVHIS.PERSON_ACCOUNT_LIFE_HISTORY_ID = PALH.PERSON_ACCOUNT_LIFE_HISTORY_ID OR &#xD;&#xA;(PREVHIS.PLAN_OPTION_STATUS_VALUE = 'ENLD' AND &#xD;&#xA;PREVHIS.PLAN_PARTICIPATION_STATUS_VALUE = 'ENL2' AND 1 = &#xD;&#xA;(CASE WHEN PALH.LIFE_INSURANCE_TYPE_VALUE = 'REME' AND PREVHIS.LIFE_INSURANCE_TYPE_VALUE != 'REME' THEN 0 ELSE 1 END)&#xD;&#xA;))&#xD;&#xA;&#xD;&#xA;) AS RATECHANGEDPERSONS &#xD;&#xA;WHERE RATECHANGEDPERSONS.PERSON_ID NOT IN (SELECT person_id FROM SGT_RATE_CHANGE_LETTER_DETAIL WITH(NOLOCK) WHERE BATCH_REQUEST_ID = @RATE_CHANGE_REQUEST_ID)&#xD;&#xA;ORDER BY PERSON_ID">
      <parameters>
        <parameter ID="@EFFECTIVEDATE" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadCombinedRHICAmount" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT PERSON_ID, SUM(D.RHIC_AMOUNT) AS COMBINED_RHIC_AMOUNT FROM SGT_BENEFIT_RHIC_COMBINE C&#xD;&#xA;INNER JOIN SGT_BENEFIT_RHIC_COMBINE_DETAIL D ON C.BENEFIT_RHIC_COMBINE_ID = D.BENEFIT_RHIC_COMBINE_ID&#xD;&#xA;WHERE (@EFFECTIVE_DATE BETWEEN C.[START_DATE] AND ISNULL(C.[END_DATE], '01/01/2900')) &#xD;&#xA;AND C.ACTION_STATUS_VALUE IN ('APPR', 'ENDD')&#xD;&#xA;AND ISNULL(D.COMBINE_FLAG, 'N') = 'Y'&#xD;&#xA;GROUP BY C.PERSON_ID">
      <parameters>
        <parameter ID="@EFFECTIVE_DATE" sfwDataType="DateTime" />
      </parameters>
    </query>
  </queries>
  <attributes>
    <attribute ID="RateChangeLetterRequestId" sfwType="Column" sfwValue="rate_change_letter_request_id" sfwKeyNo="1" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="True" sfwDataType="int" sfwRequired="False" />
    <attribute ID="LetterTypeDescription" sfwType="Description" sfwValue="letter_type_description" />
    <attribute ID="LetterTypeId" sfwType="Column" sfwValue="letter_type_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="4000" sfwDataType="int" sfwRequired="False" />
    <attribute ID="LetterTypeValue" sfwType="Column" sfwValue="letter_type_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="EffectiveDate" sfwType="Column" sfwValue="effective_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="ProviderOrgId" sfwType="Column" sfwValue="provider_org_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="StatusDescription" sfwType="Description" sfwValue="status_description" />
    <attribute ID="StatusId" sfwType="Column" sfwValue="status_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="4001" sfwDataType="int" sfwRequired="False" />
    <attribute ID="StatusValue" sfwType="Column" sfwValue="status_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="CreatedBy" sfwType="Column" sfwValue="created_by" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="50" />
    <attribute ID="CreatedDate" sfwType="Column" sfwValue="created_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="ModifiedBy" sfwType="Column" sfwValue="modified_by" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="50" />
    <attribute ID="ModifiedDate" sfwType="Column" sfwValue="modified_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="UpdateSeq" sfwType="Column" sfwValue="update_seq" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="Health" sfwType="Column" sfwValue="health" sfwIsNull="True" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="string" sfwLength="1" />
    <attribute ID="Medd" sfwType="Column" sfwValue="medd" sfwIsNull="True" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="string" sfwLength="1" />
    <attribute ID="Dental" sfwType="Column" sfwValue="dental" sfwIsNull="True" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="string" sfwLength="1" />
    <attribute ID="Vision" sfwType="Column" sfwValue="vision" sfwIsNull="True" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="string" sfwLength="1" />
    <attribute ID="Life" sfwType="Column" sfwValue="life" sfwIsNull="True" sfwKeyNo="0" sfwIsIdentity="False" sfwDataType="string" sfwLength="1" />
    <attribute sfwDataType="string" sfwType="Property" ID="EffectiveLongDate" sfwValue="icdoRateChangeLetterRequest.effective_long_date" />
    <attribute sfwDataType="boolean" sfwType="Property" ID="IblnIsLetterTypeDental" sfwValue="iblnIsLetterTypeDental" />
    <attribute sfwDataType="boolean" sfwType="Property" ID="IblnIsLetterTypeEAP" sfwValue="iblnIsLetterTypeEAP" />
    <attribute sfwDataType="boolean" sfwType="Property" ID="IblnIsLetterTypeRHICOrHealth" sfwValue="iblnIsLetterTypeRHICOrHealth" />
    <attribute sfwDataType="boolean" sfwType="Property" ID="IblnIsLetterTypeLife" sfwValue="iblnIsLetterTypeLife" />
    <attribute sfwDataType="boolean" sfwType="Property" ID="IblnIsLetterTypeLTC" sfwValue="iblnIsLetterTypeLTC" />
    <attribute sfwDataType="boolean" sfwType="Property" ID="IblnIsLetterTypeVision" sfwValue="iblnIsLetterTypeVision" />
    <attribute ID="objPlan" sfwType="Object" sfwEntity="entPlan" sfwValue="ibusPlan" />
    <attribute ID="objProviderOrgPlan" sfwType="Object" sfwEntity="entOrgPlan" sfwValue="ibusProviderOrgPlan" />
    <attribute sfwDataType="int" sfwType="Property" ID="EffectiveYear" sfwValue="EffectiveYear" />
  </attributes>
</entity>