<?xml version="1.0" encoding="utf-8"?>
<entity ID="entMasPayeeAccount" sfwActive="True" sfwStatus="Review" sfwType="BusinessRule" sfwMainCDO="icdoMasPayeeAccount" sfwObjectID="busMasPayeeAccount" sfwTableName="sgt_mas_payee_account" sfwView="False">
  <rules />
  <delete>
    <property ID="lstMasPayeeAccountPapit" sfwMethodName="LoadMasPayeeAccountPapits" />
  </delete>
  <checklist />
  <initialload />
  <softerror />
  <harderror />
  <validatedelete />
  <groupslist />
  <updateablecdo />
  <commonproperties />
  <queries>
    <query ID="LoadMasPayeeAccount" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT &#xD;&#xA;&#x9;&#x9;DISTINCT &#xD;&#xA;&#x9;&#x9;B.PERSON_ID,&#xD;&#xA;&#x9;&#x9;B.MAS_SELECTION_ID,&#xD;&#xA;&#x9;&#x9;C.PAYEE_ACCOUNT_ID,&#xD;&#xA;&#x9;&#x9;C.PAYEE_PERSLINK_ID,&#xD;&#xA;&#x9;&#x9;C.MEMBER_PERSON_ID,&#xD;&#xA;&#x9;&#x9;A.IS_HEALTH_ENROLLED,&#xD;&#xA;&#x9;&#x9;A.IS_DENTAL_ENROLLED,&#xD;&#xA;&#x9;&#x9;A.IS_VISION_ENROLLED,&#xD;&#xA;&#x9;&#x9;A.IS_LIFE_ENROLLED,&#xD;&#xA;&#x9;&#x9;A.IS_LTC_ENROLLED,&#xD;&#xA;&#x9;&#x9;A.IS_MEDICARE_PART_D_ENROLLED,&#xD;&#xA;&#x9;&#x9;C.PLAN_ID, &#xD;&#xA;&#x9;&#x9;ISNULL(DET.RHIC_AMOUNT, 0.00) AS MEMBERRHICAMOUNT,&#xD;&#xA;&#x9;&#x9;SGS_CODE_VALUE.[DESCRIPTION] AS RHIC_BENEFIT_OPTION_DESCRIPTION,&#xD;&#xA;&#x9;&#x9;C.BENEFIT_ACCOUNT_TYPE_VALUE,&#xD;&#xA;&#x9;&#x9;CASE WHEN C.ACCOUNT_RELATION_VALUE='MEMB' THEN 1 ELSE 2 END AS ACCOUNT_ORDER,&#xD;&#xA;&#x9;&#x9;C.ACCOUNT_BALANCE,&#xD;&#xA;&#x9;&#x9;0.00 AS PREVIOUS_STATEMENT_BALANCE,&#xD;&#xA;&#x9;&#x9;0.00 AS INTEREST_AMOUNT,&#xD;&#xA;&#x9;&#x9;0.00 AS HEALTHPREMIUMAMOUNT,&#xD;&#xA;&#x9;&#x9;0.00 AS HEALTHRHICAMOUNT,&#xD;&#xA;&#x9;&#x9;0.00 AS MEDICAREPREMIUMAMOUNT,&#xD;&#xA;&#x9;&#x9;0.00 AS VISIONPREMIUMAMOUNT,&#xD;&#xA;&#x9;&#x9;0.00 AS DETNTALPREMIUMAMOUNT,&#xD;&#xA;&#x9;&#x9;'' AS ISLIFEPREMIUMWAIVER,&#xD;&#xA;&#x9;&#x9;0.00 AS WAIVEDAMOUNT&#xD;&#xA;&#x9;&#x9;,ISNULL(' - ' + c.PLAN_BENEFIT_TIER_DESCRIPTION,'') AS PLAN_BENEFIT_TIER_DESCRIPTION&#xD;&#xA;FROM&#x9;&#x9;SGT_MAS_SELECTION B WITH(NOLOCK)&#xD;&#xA;INNER JOIN&#x9;SGT_MAS_PERSON A WITH(NOLOCK) ON B.MAS_SELECTION_ID = A.MAS_SELECTION_ID&#xD;&#xA;INNER JOIN&#x9;SGT_MAS_BATCH_REQUEST MBR WITH(NOLOCK) ON MBR.MAS_BATCH_REQUEST_ID = B.MAS_BATCH_REQUEST_ID&#xD;&#xA;LEFT JOIN&#x9;SGT_MAS_PAYEE_ACCOUNT C WITH(NOLOCK) ON A.MAS_PERSON_ID = C.MAS_PERSON_ID&#xD;&#xA;LEFT JOIN&#x9;SGT_BENEFIT_RHIC_COMBINE_DETAIL DET WITH(NOLOCK) ON DET.DONAR_PAYEE_ACCOUNT_ID = C.PAYEE_ACCOUNT_ID&#xD;&#xA;LEFT JOIN&#x9;SGT_BENEFIT_RHIC_COMBINE COMB WITH(NOLOCK) ON DET.BENEFIT_RHIC_COMBINE_ID = COMB.BENEFIT_RHIC_COMBINE_ID &#xD;&#xA;LEFT JOIN&#x9;SGS_CODE_VALUE WITH(NOLOCK) ON C.RHIC_BENEFIT_OPTION_ID = SGS_CODE_VALUE.CODE_ID AND C.RHIC_BENEFIT_OPTION_VALUE = SGS_CODE_VALUE.CODE_VALUE&#xD;&#xA;WHERE&#x9;MBR.MAS_BATCH_REQUEST_ID = CASE WHEN ISNULL(@BATCHREQID,0) = 0 THEN MBR.MAS_BATCH_REQUEST_ID ELSE @BATCHREQID END&#xD;&#xA;&#x9;&#x9;AND B.MAS_SELECTION_ID = CASE WHEN ISNULL(@MAS_SELECTION_ID,0) = 0 THEN B.MAS_SELECTION_ID ELSE @MAS_SELECTION_ID END&#xD;&#xA;&#x9;&#x9;AND MBR.STATEMENT_EFFECTIVE_DATE = @PAYMENTDATE&#xD;&#xA;&#x9;&#x9;AND ((COMB.[START_DATE] &lt; @PAYMENTDATE&#xD;&#xA;&#x9;&#x9;&#x9;AND (@PAYMENTDATE BETWEEN COMB.[START_DATE] &#xD;&#xA;&#x9;&#x9;&#x9;AND (CASE WHEN COMB.END_DATE IS NULL THEN '99991231' ELSE COMB.END_DATE END)&#xD;&#xA;&#x9;&#x9;&#x9;AND COMB.ACTION_STATUS_VALUE IN ( 'APPR','ENDD') AND DET.COMBINE_FLAG = 'Y')) OR (DET.BENEFIT_RHIC_COMBINE_DETAIL_ID IS NULL))">
      <parameters>
        <parameter ID="@BATCHREQID" sfwDataType="int" />
        <parameter ID="@PAYMENTDATE" sfwDataType="DateTime" />
        <parameter ID="@MAS_SELECTION_ID" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="LoadMasPayeeAccountBySelection" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT  A.*,C.*,A.FULL_NAME AS PAYEE_NAME,B.*,ISNULL(PREFIX.DESCRIPTION,'') + ' ' +ISNULL(M.FIRST_NAME,'') + ' ' &#xD;&#xA;  + ISNULL(M.MIDDLE_NAME,'') + ' ' + ISNULL(M.LAST_NAME,'') + ' ' + ISNULL(SUFFIX.DESCRIPTION,'')AS OWNER_NAME ,&#xD;&#xA;  ISNULL(M.FIRST_NAME,'') AS OWNER_FIRST_NAME,IS_DB_PLAN_ENROLED AS IS_PLAN_DB,IS_DC_PLAN_ENROLED AS IS_PLAN_DC,&#xD;&#xA;  '' AS IS_RHIC_APPLIED_HEALTH,CASE WHEN C.BENEFIT_ACCOUNT_TYPE_VALUE='DISA' THEN 'Y' ELSE 'N' END AS IS_BENEFIT_TYPE_DISABILITY,&#xD;&#xA;  UNIFORM_INCOME_FLAG AS IS_SSLI_SELECTED,CASE WHEN SSLI_CHANGE_DATE &gt;= C.BENEFIT_BEGIN_DATE THEN 'Y' ELSE 'N' END AS IS_SSLE_DATE_FUTURE,&#xD;&#xA;  CASE WHEN SSLI_CHANGE_DATE &lt; C.BENEFIT_BEGIN_DATE THEN 'Y' ELSE 'N' END AS IS_SSLE_DATE_PAST,&#xD;&#xA;  ISNULL(OP.DATA1,'') AS TERM_CERTAIN_YEAR,CASE WHEN ISNULL(OP.DATA2,'')='AP' THEN 'Y' ELSE 'N' END AS IS_AP_PAYEE,&#xD;&#xA;  CASE WHEN ISNULL(OP.DATA2,'')='BAO' THEN 'Y' ELSE 'N' END AS IS_BAO_PAYEE,&#xD;&#xA;  D.PLAN_NAME + ' Retirement Plan' AS PLAN_NAME,'' AS IS_RETIREE_HEALTH_ENROLLED,'' AS IS_PARTD_HEALTH_ENROLLED,&#xD;&#xA;  CV.DESCRIPTION AS ACCOUNT_RELATIONSHIP_DESCRIPTION,C.ACCOUNT_RELATION_VALUE AS ACCOUNT_RELATIONSHIP_VALUE,&#xD;&#xA;  MBR.BATCH_REQUEST_TYPE_VALUE,MBR.STATEMENT_EFFECTIVE_DATE,OP.DESCRIPTION AS BENEFIT_OPTION_DESCRIPTION,&#xD;&#xA;  SSLI_CHANGE_DATE,RHIC.DESCRIPTION AS RHIC_BENEFIT_OPTION_DESCRIPTION,&#xD;&#xA;  PRVD.TELEPHONE AS ORG_CONTACT_PHONE_NUMBER,&#xD;&#xA;  PRVD.ORG_NAME AS ORG_NAME,&#xD;&#xA;  0.00 as HealthPremiumAmount,0.00 as HealthRHICAmount,&#xD;&#xA;  0.00 as Previous_Statement_Balance,0.00 as Interest_Amount,'' as IsLifePremiumwaiver,'' as IsLifeCoverageValid,0.00 as WaivedAmount,PHD.GROSS_AMOUNT AS LTD_PAID_AMOUNT,&#xD;&#xA;  a.IS_BENEFICIARY_REQUIRED,0.00 as DetntalPremiumAmount,0.00 as VisionPremiumAmount,0.00 as LTCMemberPremiumAmount,0.00 as LTCSpousepremiumAmount,&#xD;&#xA;  case when a.ADDR_STATE_DESCRIPTION is not null&#xD;&#xA;  then (select c.code_value from sgs_code_value c where code_id=150 and c.description=ADDR_STATE_DESCRIPTION) end as state_value,&#xD;&#xA;  isnull(case when c.BENEFIT_ACCOUNT_TYPE_VALUE='DISA' then 'Y'&#xD;&#xA;    when (c.BENEFIT_ACCOUNT_TYPE_VALUE='RETR' or c.BENEFIT_ACCOUNT_TYPE_VALUE='DETH' )and (isnull(MINIMUM_GUARANTEE_AMOUNT,0.00)-isnull(SUBMINIG_AMOUNT,0.00))&gt; 0 then 'Y'&#xD;&#xA;    when c.BENEFIT_ACCOUNT_TYPE_VALUE='PSTD' and C.ACCOUNT_RELATION_VALUE='JANT' and (isnull(MINIMUM_GUARANTEE_AMOUNT,0.00)-isnull(SUBMINIG_AMOUNT,0.00))&gt; 0 then 'Y'   &#xD;&#xA;    end,'N') as IS_BENEFICIARY_EXIST,&#xD;&#xA;  case when addr_country_value='0001' then '' else addr_country_description end as country,&#xD;&#xA;  case when (C.account_relation_value = 'MEMB' or (C.account_relation_value in('BENE','JANT') and C.family_relation_value = 'SPOU')) THEN 'N' ELSE 'Y' END AS IS_NONSPOUSE_BENE,&#xD;&#xA;  COMBINED_RHIC_AMOUNT AS MEMBERRHICAMOUNT,&#xD;&#xA;  case when BRC.BENEFIT_RHIC_COMBINE_ID&gt;0 then 'Y' else 'N' END AS IS_COMBINING_RHIC,&#xD;&#xA;  CASE WHEN BRC.CREATED_BY='CONVERSION'&#xD;&#xA;    THEN CASE WHEN RHIC_BENEFIT_OPTION_VALUE='RD50' THEN COMBINED_RHIC_AMOUNT/2 &#xD;&#xA;        WHEN RHIC_BENEFIT_OPTION_VALUE='R100' THEN COMBINED_RHIC_AMOUNT END &#xD;&#xA;   ELSE &#xD;&#xA;     CASE WHEN RHIC_BENEFIT_OPTION_VALUE='RD50' THEN BRCD1.RHIC_AMOUNT/2 &#xD;&#xA;       WHEN RHIC_BENEFIT_OPTION_VALUE='R100' THEN BRCD1.RHIC_AMOUNT END &#xD;&#xA;  END AS SPOUSERHICAMOUNT, &#xD;&#xA;  CASE WHEN BRC.CREATED_BY='CONVERSION' THEN 'Y' &#xD;&#xA;    WHEN BRC.CREATED_BY&lt;&gt;'CONVERSION' AND BRCD1.BENEFIT_RHIC_COMBINE_DETAIL_ID&gt;0 THEN 'Y' END AS RHIC_RECEIVER,&#xD;&#xA;  CASE WHEN BRC.CREATED_BY&lt;&gt;'CONVERSION' AND BRCD2.BENEFIT_RHIC_COMBINE_DETAIL_ID&gt;0 THEN 'Y' END AS RHIC_DONOR,&#xD;&#xA;  '' as DentalDep,'' as VisionDep,'' as Healthdep,'' as MedicareDep,CASE when C.ACCOUNT_RELATION_VALUE='MEMB' THEN 1 ELSE 2 END AS ACCOUNT_ORDER,&#xD;&#xA;  ISNULL(USR.FIRST_NAME,'') +' '+ CASE WHEN USR.MIDDLE_INITIAL IS NULL THEN '' ELSE USR.MIDDLE_INITIAL+' ' END + ISNULL(USR.LAST_NAME,'') AS 'REQUESTED_BY',&#xD;&#xA;   '' as IS_CURRENT_LIFE_BENEFICIARY_EXISTS,&#xD;&#xA;  '' as IS_CURRENT_RETIREMENT_BENEFICIARY_EXISTS,&#xD;&#xA;  '' AS DISPLAY_RHIC&#xD;&#xA;  ,ISNULL(' - ' + c.PLAN_BENEFIT_TIER_DESCRIPTION,'') AS PLAN_BENEFIT_TIER_DESCRIPTION&#xD;&#xA;FROM SGT_MAS_PERSON A &#xD;&#xA;  INNER JOIN SGT_MAS_SELECTION B&#xD;&#xA;   ON A.MAS_SELECTION_ID=B.MAS_SELECTION_ID&#xD;&#xA;  LEFT JOIN SGT_MAS_PAYEE_ACCOUNT C&#xD;&#xA;   ON A.MAS_PERSON_ID=C.MAS_PERSON_ID&#xD;&#xA;  LEFT JOIN SGT_PLAN D &#xD;&#xA;   ON C.PLAN_ID=D.PLAN_ID     &#xD;&#xA;  LEFT JOIN SGT_PERSON M&#xD;&#xA;   ON M.PERSON_ID=C.MEMBER_PERSON_ID&#xD;&#xA;  LEFT OUTER JOIN SGS_CODE_VALUE(NOLOCK) PREFIX&#xD;&#xA;   ON PREFIX.CODE_ID=M.NAME_PREFIX_ID&#xD;&#xA;    AND PREFIX.CODE_VALUE=M.NAME_PREFIX_VALUE&#xD;&#xA;  LEFT OUTER JOIN SGS_CODE_VALUE(NOLOCK) SUFFIX &#xD;&#xA;   ON SUFFIX.CODE_ID=M.NAME_SUFFIX_ID&#xD;&#xA;    AND SUFFIX.CODE_VALUE=M.NAME_SUFFIX_VALUE &#xD;&#xA;  LEFT JOIN SGS_CODE_VALUE OP &#xD;&#xA;   ON OP.CODE_ID=C.BENEFIT_OPTION_ID AND OP.CODE_VALUE=C.BENEFIT_OPTION_VALUE &#xD;&#xA;  INNER JOIN SGT_MAS_BATCH_REQUEST MBR&#xD;&#xA;   ON MBR.MAS_BATCH_REQUEST_ID=B.MAS_BATCH_REQUEST_ID&#xD;&#xA;  LEFT JOIN SGS_CODE_VALUE CV&#xD;&#xA;   ON CV.CODE_ID=C.ACCOUNT_RELATION_ID AND CV.CODE_VALUE=C.ACCOUNT_RELATION_VALUE&#xD;&#xA;  LEFT JOIN SGS_CODE_VALUE RHIC&#xD;&#xA;   ON RHIC.CODE_ID=C.RHIC_BENEFIT_OPTION_ID AND RHIC.CODE_VALUE=C.RHIC_BENEFIT_OPTION_VALUE&#xD;&#xA;  LEFT JOIN (&#xD;&#xA;     SELECT phh.PERSON_ID,&#xD;&#xA;      SUM(CASE WHEN &#xD;&#xA;      PIT.ITEM_TYPE_DIRECTION = 1 &#xD;&#xA;      and PAYMENT_1099R_FLAG = 'Y' &#xD;&#xA;      and VENDOR_FLAG= 'N'  &#xD;&#xA;      and ALLOW_ROLLOVER_CODE_VALUE &lt;&gt; 'CRET'&#xD;&#xA;      THEN &#xD;&#xA;       PHD.AMOUNT &#xD;&#xA;      ELSE 0 END&#xD;&#xA;      )  AS GROSS_AMOUNT,&#xD;&#xA;      SUM(CASE WHEN &#xD;&#xA;      PIT.ITEM_TYPE_DIRECTION = 1       &#xD;&#xA;      and ALLOW_ROLLOVER_CODE_VALUE &lt;&gt; 'CRET'&#xD;&#xA;      THEN &#xD;&#xA;       PHD.AMOUNT &#xD;&#xA;      ELSE 0 END&#xD;&#xA;      )  AS SUBMINIG_AMOUNT&#xD;&#xA;     FROM SGT_PAYMENT_HISTORY_HEADER PHH(NOLOCK)&#xD;&#xA;       INNER JOIN SGT_PAYMENT_HISTORY_DETAIL PHD(NOLOCK) &#xD;&#xA;         ON PHH.PAYMENT_HISTORY_HEADER_ID = PHD.PAYMENT_HISTORY_HEADER_ID&#xD;&#xA;       INNER JOIN SGT_PAYMENT_ITEM_TYPE PIT(NOLOCK) &#xD;&#xA;         ON PHD.PAYMENT_ITEM_TYPE_ID = PIT.PAYMENT_ITEM_TYPE_ID &#xD;&#xA;     where phh.payment_date&lt;=@paymentdate&#xD;&#xA;     GROUP BY phh.PERSON_ID&#xD;&#xA;     )PHD ON PHD.PERSON_ID=B.PERSON_ID &#xD;&#xA;  LEFT JOIN &#xD;&#xA;    (&#xD;&#xA;      SELECT BENEFIT_RHIC_COMBINE_ID,PERSON_ID,START_DATE,End_date,CREATED_BY,COMBINED_RHIC_AMOUNT,  &#xD;&#xA;   RANK() OVER (PARTITION BY PERSON_ID ORDER BY isnull(End_date,'99991231') Desc,start_date desc ,Benefit_rhic_combine_id desc ) AS ROWRANK &#xD;&#xA;   FROM  SGT_BENEFIT_RHIC_COMBINE  RC &#xD;&#xA;   WHERE @paymentdate BETWEEN RC.START_DATE &#xD;&#xA;   AND (CASE WHEN RC.END_DATE IS NULL THEN '99991231' ELSE RC.END_DATE END)&#xD;&#xA;   AND ACTION_STATUS_VALUE in ( 'APPR','ENDD')&#xD;&#xA;   and isnull(COMBINED_RHIC_AMOUNT,0) &lt;&gt; 0&#xD;&#xA;        ) AS BRC&#xD;&#xA;   ON BRC.PERSON_ID=C.PAYEE_PERSLINK_ID&#xD;&#xA;  LEFT JOIN SGT_BENEFIT_RHIC_COMBINE_DETAIL BRCD1&#xD;&#xA;   ON BRC.BENEFIT_RHIC_COMBINE_ID=BRCD1.BENEFIT_RHIC_COMBINE_ID and BRCD1.DONAR_PAYEE_ACCOUNT_ID=C.PAYEE_ACCOUNT_ID&#xD;&#xA;  LEFT JOIN SGT_BENEFIT_RHIC_COMBINE_DETAIL BRCD2&#xD;&#xA;   ON BRC.BENEFIT_RHIC_COMBINE_ID=BRCD2.BENEFIT_RHIC_COMBINE_ID and BRCD2.DONAR_PAYEE_ACCOUNT_ID&lt;&gt;C.PAYEE_ACCOUNT_ID&#xD;&#xA;  LEFT JOIN SGT_ORGANIZATION PRVD&#xD;&#xA;   ON PRVD.ORG_ID=(Select top 1 a.org_id from sgt_org_plan a&#xD;&#xA;       inner join sgt_organization b &#xD;&#xA;        on a.org_id=b.org_id &#xD;&#xA;       where plan_id=12 and org_type_value='PRVD')&#xD;&#xA;  INNER JOIN SGS_USER USR WITH(NOLOCK) ON USR.USER_ID=MBR.CREATED_BY&#xD;&#xA;WHERE B.MAS_SELECTION_ID=@MAS_SELECTION_ID">
      <parameters>
        <parameter ID="@MAS_SELECTION_ID" sfwDataType="int" />
        <parameter ID="@paymentdate" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadBenefitOption" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="select  p.plan_name+ ' Retirement' as plan_name,b.person_id as PERSON_ID,BENEFIT_OPTION_VALUE,cv.description as BENEFIT_OPTION,&#xD;&#xA;&#x9;&#x9;c.PAYEE_ACCOUNT_ID as PAYEE_ACCOUNT_ID,ISNULL(' - ' + c.PLAN_BENEFIT_TIER_DESCRIPTION,'') AS PLAN_BENEFIT_TIER_DESCRIPTION&#xD;&#xA;from SGT_MAS_PERSON a WITH(NOLOCK)&#xD;&#xA;  inner join SGT_MAS_SELECTION b WITH(NOLOCK)&#xD;&#xA;   on a.MAS_SELECTION_ID=b.MAS_SELECTION_ID&#xD;&#xA;  left join SGT_MAS_PAYEE_ACCOUNT c WITH(NOLOCK)&#xD;&#xA;   on a.MAS_PERSON_ID=c.MAS_PERSON_ID  &#xD;&#xA;  left join sgt_plan p  WITH(NOLOCK)&#xD;&#xA;   on p.plan_id=c.plan_id  &#xD;&#xA;  left join sgs_code_value cv WITH(NOLOCK)&#xD;&#xA;   on cv.code_id=c.BENEFIT_OPTION_ID and cv.code_value=c.BENEFIT_OPTION_VALUE&#xD;&#xA;where MAS_BATCH_REQUEST_ID=@batchrequestid">
      <parameters>
        <parameter ID="@batchrequestid" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="LoadBenefitOptionBySelection" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="select   p.plan_name+ ' Retirement' as plan_name,b.person_id as PERSON_ID,BENEFIT_OPTION_VALUE,cv.description as BENEFIT_OPTION,&#xD;&#xA;&#x9;&#x9; C.PAYEE_ACCOUNT_ID as PAYEE_ACCOUNT_ID,ISNULL(' - ' + c.PLAN_BENEFIT_TIER_DESCRIPTION,'') AS PLAN_BENEFIT_TIER_DESCRIPTION&#xD;&#xA;from SGT_MAS_PERSON a &#xD;&#xA;  inner join SGT_MAS_SELECTION b&#xD;&#xA;   on a.MAS_SELECTION_ID=b.MAS_SELECTION_ID&#xD;&#xA;  left join SGT_MAS_PAYEE_ACCOUNT c&#xD;&#xA;   on a.MAS_PERSON_ID=c.MAS_PERSON_ID  &#xD;&#xA;  left join sgt_plan p &#xD;&#xA;   on p.plan_id=c.plan_id  &#xD;&#xA;  left join sgs_code_value cv&#xD;&#xA;   on cv.code_id=c.BENEFIT_OPTION_ID and cv.code_value=c.BENEFIT_OPTION_VALUE&#xD;&#xA;where b.MAS_SELECTION_ID=@MAS_SELECTION_ID">
      <parameters>
        <parameter ID="@MAS_SELECTION_ID" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="LoadMasPayeeAccountOnlineStatement" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="select A.*,C.*,A.FULL_NAME AS PAYEE_NAME,&#xD;&#xA;ISNULL(PREFIX.DESCRIPTION,'') + ' ' +ISNULL(M.FIRST_NAME,'') + ' ' &#xD;&#xA;+ ISNULL(M.MIDDLE_NAME,'') + ' ' + ISNULL(M.LAST_NAME,'') + ' ' + ISNULL(SUFFIX.DESCRIPTION,'')AS OWNER_NAME ,&#xD;&#xA;ISNULL(M.FIRST_NAME,'') AS OWNER_FIRST_NAME,&#xD;&#xA;RET.ORG_NAME AS ORG_NAME,IS_DB_PLAN_ENROLED AS IS_PLAN_DB,IS_DC_PLAN_ENROLED AS IS_PLAN_DC,&#xD;&#xA;'' AS IS_RHIC_APPLIED_HEALTH,'' AS IS_COMBINING_RHIC,&#xD;&#xA;CASE WHEN C.BENEFIT_ACCOUNT_TYPE_VALUE='DISA' THEN 'Y' ELSE 'N' END AS IS_BENEFIT_TYPE_DISABILITY,&#xD;&#xA;UNIFORM_INCOME_FLAG AS IS_SSLI_SELECTED,&#xD;&#xA;CASE WHEN SSLI_CHANGE_DATE &gt;= C.BENEFIT_BEGIN_DATE THEN 'Y' ELSE 'N' END AS IS_SSLE_DATE_FUTURE,&#xD;&#xA;CASE WHEN SSLI_CHANGE_DATE &lt; C.BENEFIT_BEGIN_DATE THEN 'Y' ELSE 'N' END AS IS_SSLE_DATE_PAST,&#xD;&#xA;ISNULL(OP.DATA1,'') AS TERM_CERTAIN_YEAR,&#xD;&#xA;CASE WHEN ISNULL(OP.DATA2,'')='AP' THEN 'Y' ELSE 'N' END AS IS_AP_PAYEE,&#xD;&#xA;CASE WHEN ISNULL(OP.DATA2,'')='BAO' THEN 'Y' ELSE 'N' END AS IS_BAO_PAYEE&#xD;&#xA; from SGT_MAS_PERSON a &#xD;&#xA;  inner join SGT_MAS_SELECTION b&#xD;&#xA;   on a.MAS_SELECTION_ID=b.MAS_SELECTION_ID&#xD;&#xA;  inner join SGT_MAS_PAYEE_ACCOUNT c&#xD;&#xA;   on a.MAS_PERSON_ID=c.MAS_PERSON_ID&#xD;&#xA;  inner join sgt_plan d &#xD;&#xA;   on c.plan_id=d.plan_id  &#xD;&#xA;  INNER JOIN SGT_ORGANIZATION RET&#xD;&#xA;   ON RET.ORG_ID=C.RETIREMENT_ORG_ID&#xD;&#xA;  INNER JOIN SGT_PERSON M&#xD;&#xA;   ON M.PERSON_ID=C.MEMBER_PERSON_ID&#xD;&#xA;  LEFT OUTER JOIN SGS_CODE_VALUE(NOLOCK) PREFIX&#xD;&#xA;   on PREFIX.CODE_ID=M.NAME_PREFIX_ID&#xD;&#xA;    and prefix.code_value=M.NAME_PREFIX_VALUE&#xD;&#xA;  LEFT OUTER JOIN SGS_CODE_VALUE(NOLOCK) SUFFIX &#xD;&#xA;   on SUFFIX.CODE_ID=M.NAME_SUFFIX_ID&#xD;&#xA;    and SUFFIX.code_value=M.NAME_SUFFIX_VALUE &#xD;&#xA;  INNER JOIN SGS_CODE_VALUE OP &#xD;&#xA;   ON OP.CODE_ID=C.BENEFIT_OPTION_ID AND OP.CODE_VALUE=C.BENEFIT_OPTION_VALUE &#xD;&#xA;where MAS_BATCH_REQUEST_ID=@BATCHREUESTID&#xD;&#xA;">
      <parameters>
        <parameter ID="@BATCHREUESTID" sfwDataType="int" />
      </parameters>
    </query>
    <query ID="LoadGrossAmountByPlan" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT PHH.PERSON_ID as PERSON_ID,'Gross Paid Life to Date:' as GrossPaidLifeToDate ,p.PLAN_NAME + ' Retirement Plan' AS PLAN_NAME,&#xD;&#xA;      SUM(temp.gross_amount&#xD;&#xA;      )  AS GROSS_AMOUNT&#xD;&#xA;     FROM &#xD;&#xA;     (&#xD;&#xA;     SELECT  PHH.PAYMENT_HISTORY_HEADER_ID,sum(case when pit.item_type_direction = 1 then Amount else 0 end ) as gross_amount    &#xD;&#xA;FROM &#xD;&#xA;SGT_PAYMENT_HISTORY_HEADER PHH WITH(NOLOCK)  &#xD;&#xA;INNER JOIN  SGT_PAYMENT_HISTORY_DETAIL PHD WITH(NOLOCK) ON PHD.PAYMENT_HISTORY_HEADER_ID = PHH.PAYMENT_HISTORY_HEADER_ID&#xD;&#xA;INNER JOIN SGT_PAYMENT_ITEM_TYPE PIT WITH(NOLOCK) ON PHD.PAYMENT_ITEM_TYPE_ID = PIT.PAYMENT_ITEM_TYPE_ID -- AND PIT.ALLOW_ROLLOVER_CODE_VALUE &lt;&gt; 'CRET'&#xD;&#xA;INNER JOIN SGT_PAYEE_ACCOUNT PA WITH(NOLOCK) &#xD;&#xA;         ON PHH.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID &#xD;&#xA;where phh.PERSON_ID = @PERSONID&#xD;&#xA;and PHH.PAYMENT_DATE&lt;= @PAYMENTDATE &#xD;&#xA;and PHH.STATUS_VALUE = 'PRCD'&#xD;&#xA;AND PA.BENEFIT_ACCOUNT_TYPE_VALUE &lt;&gt; 'RFND' AND PA.BENEFIT_OPTION_VALUE NOT IN ('AURD','REFD','RGRD')&#xD;&#xA;GROUP BY phh.PAYMENT_HISTORY_HEADER_ID ,phh.PLAN_ID &#xD;&#xA;)as temp&#xD;&#xA;     inner join &#xD;&#xA;     SGT_PAYMENT_HISTORY_HEADER PHH WITH(NOLOCK) on temp.PAYMENT_HISTORY_HEADER_ID = PHH.PAYMENT_HISTORY_HEADER_ID&#xD;&#xA;     inner join SGT_PLAN p WITH(NOLOCK) on p.PLAN_ID = PHH.PLAN_ID&#xD;&#xA;     GROUP BY p.PLAN_NAME,PHH.PERSON_ID&#xD;&#xA;">
      <parameters>
        <parameter ID="@PERSONID" sfwDataType="int" />
        <parameter ID="@PAYMENTDATE" sfwDataType="DateTime" />
      </parameters>
    </query>
    <query ID="LoadStatementEffectiveDate" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="SELECT top 1 STATEMENT_EFFECTIVE_DATE FROM SGT_MAS_BATCH_REQUEST WITH(NOLOCK)&#xD;&#xA;WHERE MAS_BATCH_REQUEST_ID in &#xD;&#xA;(SELECT MAS_BATCH_REQUEST_ID FROM SGT_MAS_SELECTION WITH(NOLOCK) WHERE MAS_SELECTION_ID = @mas_selection_id)">
      <parameters>
        <parameter ID="@mas_selection_id" sfwDataType="int" />
      </parameters>
    </query>
  </queries>
  <attributes>
    <attribute ID="MasPayeeAccountId" sfwType="Column" sfwValue="mas_payee_account_id" sfwKeyNo="1" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="True" sfwDataType="int" sfwRequired="False" />
    <attribute ID="MasPersonId" sfwType="Column" sfwValue="mas_person_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="MemberPersonId" sfwType="Column" sfwValue="member_person_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="PayeePerslinkId" sfwType="Column" sfwValue="payee_perslink_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="PlanId" sfwType="Column" sfwValue="plan_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="PayeeAccountId" sfwType="Column" sfwValue="payee_account_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="BenefitAccountTypeDescription" sfwType="Description" sfwValue="benefit_account_type_description" />
    <attribute ID="BenefitAccountTypeId" sfwType="Column" sfwValue="benefit_account_type_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwCodeID="1904" sfwDataType="int" sfwRequired="False" />
    <attribute ID="BenefitAccountTypeValue" sfwType="Column" sfwValue="benefit_account_type_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="BenefitAccountSubTypeDescription" sfwType="Description" sfwValue="benefit_account_sub_type_description" />
    <attribute ID="BenefitAccountSubTypeId" sfwType="Column" sfwValue="benefit_account_sub_type_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwCodeID="2201" sfwDataType="int" sfwRequired="False" />
    <attribute ID="BenefitAccountSubTypeValue" sfwType="Column" sfwValue="benefit_account_sub_type_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="BenefitOptionDescription" sfwType="Description" sfwValue="benefit_option_description" />
    <attribute ID="BenefitOptionId" sfwType="Column" sfwValue="benefit_option_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwCodeID="2216" sfwDataType="int" sfwRequired="False" />
    <attribute ID="BenefitOptionValue" sfwType="Column" sfwValue="benefit_option_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="AccountRelationDescription" sfwType="Description" sfwValue="account_relation_description" />
    <attribute ID="AccountRelationId" sfwType="Column" sfwValue="account_relation_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwCodeID="2225" sfwDataType="int" sfwRequired="False" />
    <attribute ID="AccountRelationValue" sfwType="Column" sfwValue="account_relation_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="FamilyRelationDescription" sfwType="Description" sfwValue="family_relation_description" />
    <attribute ID="FamilyRelationId" sfwType="Column" sfwValue="family_relation_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwCodeID="321" sfwDataType="int" sfwRequired="False" />
    <attribute ID="FamilyRelationValue" sfwType="Column" sfwValue="family_relation_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="MinimumGuaranteeAmount" sfwType="Column" sfwValue="minimum_guarantee_amount" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,2" />
    <attribute ID="NontaxableBeginningBalance" sfwType="Column" sfwValue="nontaxable_beginning_balance" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,2" />
    <attribute ID="RhicBenefitOptionDescription" sfwType="Description" sfwValue="rhic_benefit_option_description" />
    <attribute ID="RhicBenefitOptionId" sfwType="Column" sfwValue="rhic_benefit_option_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwCodeID="1905" sfwDataType="int" sfwRequired="False" />
    <attribute ID="RhicBenefitOptionValue" sfwType="Column" sfwValue="rhic_benefit_option_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="SsliChangeDate" sfwType="Column" sfwValue="ssli_change_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="SsliAge" sfwType="Column" sfwValue="ssli_age" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="9,4" />
    <attribute ID="UniformIncomeFlag" sfwType="Column" sfwValue="uniform_income_flag" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="1" />
    <attribute ID="BenefitBeginDate" sfwType="Column" sfwValue="benefit_begin_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="BenefitEndDate" sfwType="Column" sfwValue="benefit_end_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="JointAnnuitantPerslinkId" sfwType="Column" sfwValue="joint_annuitant_perslink_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="RetirementOrgId" sfwType="Column" sfwValue="retirement_org_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="AccountBalance" sfwType="Column" sfwValue="account_balance" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,2" />
    <attribute ID="MemberRhicAmount" sfwType="Column" sfwValue="member_rhic_amount" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,2" />
    <attribute ID="SpouseRhicAmount" sfwType="Column" sfwValue="spouse_rhic_amount" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,2" />
    <attribute ID="TermCertainEndDate" sfwType="Column" sfwValue="term_certain_end_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="CreatedBy" sfwType="Column" sfwValue="created_by" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="50" />
    <attribute ID="CreatedDate" sfwType="Column" sfwValue="created_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="ModifiedBy" sfwType="Column" sfwValue="modified_by" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="50" />
    <attribute ID="ModifiedDate" sfwType="Column" sfwValue="modified_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="UpdateSeq" sfwType="Column" sfwValue="update_seq" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute sfwType="Collection" sfwEntity="entMasPayeeAccountPapit" ID="lstMasPayeeAccountPapit" sfwValue="iclbMasPayeeAccountPapit" />
    <attribute ID="PersonAccountId" sfwType="Column" sfwValue="person_account_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="PlanBenefitTierDescription" sfwType="Column" sfwValue="plan_benefit_tier_description" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="2000" />
  </attributes>
  <objectmethods>
    <method ID="LoadMasPayeeAccountPapits" sfwReturnType="Void" />
  </objectmethods>
</entity>