<?xml version="1.0" encoding="utf-8"?>
<form ID="wfmContactMaintenance" sfwActive="True" sfwStatus="Review" sfwRemoteObject="srvOrganization" sfwResource="310 " sfwType="Maintenance" sfwTitle="Contact Maintenance" version="3.5" sfwEntity="entContact">
  <initialload>
    <callmethods sfwMode="New" sfwMethodName="NewContact" />
    <callmethods sfwMode="Update" sfwMethodName="FindContact" />
  </initialload>
  <sfwTable ID="Main">
    <sfwRow>
      <sfwColumn>
        <sfwPanel ID="pnltoolbar">
          <sfwTable ID="toolbar">
            <sfwRow>
              <sfwColumn>
                <sfwButton ID="btnSave" sfwMethodName="btnSave_Click" sfwNavigationParameter="AintContactid=ContactId" Text="Save" />
                <sfwButton ID="btnCancel" sfwMethodName="btnCancel_Click" Text="Refresh" />
                <sfwButton ID="btnPrev" sfwMethodName="btnPrev_Click" Text="Prev" />
                <sfwButton ID="btnNext" sfwMethodName="btnNext_Click" Text="Next" />
                <sfwButton ID="btnCorrespondence" sfwMethodName="btnCorrespondence_Click" Text="Correspondence" />
                <sfwButton ID="btnRemoveWSSAccess" sfwMethodName="btnValidateExecuteBusinessMethod_Click" sfwObjectMethod="btnRemoveWSSAccess_Click" sfwResource="325" sfwVisibleRule="IsContactHavingWSSAccess" Text="Remove WSS Access" sfwExecuteMethodType="ObjectMethod" OnClientClick="btnRemoveWSSAccess()" Visible="False" />
                <sfwButton sfwMethodName="btnExecuteBusinessMethod_Click" Text="Inactive Contact" ID="btnInactiveContact" sfwObjectMethod="btnInactiveContact" sfwExecuteMethodType="ObjectMethod" sfwNavigationParameter="aintContactId=ContactId" CssClass="hideControl" />
              </sfwColumn>
            </sfwRow>
          </sfwTable>
        </sfwPanel>
      </sfwColumn>
    </sfwRow>
    <sfwRow>
      <sfwColumn>
        <sfwPanel ID="pnlMain" sfwCaption="Contact Information">
          <sfwTable CssClass="Table" ID="tblMain">
            <sfwRow>
              <sfwColumn>
                <sfwLabel ID="capContactId" Text="Contact ID : " sfwIsCaption="True" />
              </sfwColumn>
              <sfwColumn>
                <sfwLabel ID="lblContactId" sfwEntityField="ContactId" />
              </sfwColumn>
              <sfwColumn />
              <sfwColumn />
            </sfwRow>
            <sfwRow>
              <sfwColumn>
                <sfwLabel BackColor="White" BorderColor="White" ForeColor="Red" ID="cap1" SkinID="ReqInformation" Text="*" sfwIsCaption="True" />
                <sfwLabel ID="capLastName" Text="Last Name : " sfwIsCaption="True" />
              </sfwColumn>
              <sfwColumn>
                <sfwTextBox ID="txtLastName" sfwEntityField="LastName" />
              </sfwColumn>
              <sfwColumn>
                <sfwLabel BackColor="White" BorderColor="White" ForeColor="Red" ID="cap" SkinID="ReqInformation" Text="*" sfwIsCaption="True" />
                <sfwLabel ID="capFirstName" Text="First Name : " sfwIsCaption="True" />
              </sfwColumn>
              <sfwColumn>
                <sfwTextBox ID="txtFirstName" sfwEntityField="FirstName" />
              </sfwColumn>
            </sfwRow>
            <sfwRow>
              <sfwColumn>
                <sfwLabel ID="capMiddleName" Text="Middle Name : " sfwIsCaption="True" />
              </sfwColumn>
              <sfwColumn>
                <sfwTextBox ID="txtMiddleName" sfwEntityField="MiddleName" />
              </sfwColumn>
              <sfwColumn />
              <sfwColumn />
            </sfwRow>
            <sfwRow>
              <sfwColumn>
                <sfwLabel ID="capPhoneNo" Text="Phone No : " sfwIsCaption="True" />
              </sfwColumn>
              <sfwColumn>
                <sfwTextBox ID="txtPhoneNo" sfwDataFormat="{0:(###)###-####}" sfwEntityField="PhoneNo" />
              </sfwColumn>
              <sfwColumn>
                <sfwLabel ID="capPhoneNoExtn" Text="Phone No Extn : " sfwIsCaption="True" />
              </sfwColumn>
              <sfwColumn>
                <sfwTextBox ID="txtPhoneNoExtn" sfwEntityField="PhoneNoExtn" />
              </sfwColumn>
            </sfwRow>
            <sfwRow>
              <sfwColumn>
                <sfwLabel ID="capFaxNo" Text="Fax No : " sfwIsCaption="True" />
              </sfwColumn>
              <sfwColumn>
                <sfwTextBox ID="txtFaxNo" sfwDataFormat="{0:(###)###-####}" sfwEntityField="FaxNo" />
              </sfwColumn>
              <sfwColumn>
                <sfwLabel ID="capFaxNoExtn" Text="Fax No Extn : " sfwIsCaption="True" />
              </sfwColumn>
              <sfwColumn>
                <sfwTextBox ID="txtFaxNoExtn" sfwEntityField="FaxNoExtn" />
              </sfwColumn>
            </sfwRow>
            <sfwRow>
              <sfwColumn>
                <sfwLabel ID="capOtherPhoneNumber" Text="Other Phone No : " sfwIsCaption="True" />
              </sfwColumn>
              <sfwColumn>
                <sfwTextBox ID="txtOtherPhoneNumber" sfwDataFormat="{0:(###)###-####}" sfwEntityField="OtherPhoneNumber" />
              </sfwColumn>
              <sfwColumn>
                <sfwLabel ID="capOtherPhoneNumberExtn" Text="Other Phone No Extn : " sfwIsCaption="True" />
              </sfwColumn>
              <sfwColumn>
                <sfwTextBox ID="txtOtherPhoneNumberExtn" sfwEntityField="OtherPhoneNumberExtn" />
              </sfwColumn>
            </sfwRow>
            <sfwRow>
              <sfwColumn>
                <sfwLabel BackColor="White" BorderColor="White" ForeColor="Red" ID="cap2" SkinID="ReqInformation" Text="*" sfwIsCaption="True" />
                <sfwLabel ID="capStatusDescription" Text="Status : " sfwIsCaption="True" />
              </sfwColumn>
              <sfwColumn>
                <sfwDropDownList ID="ddlStatusValue" sfwDefaultValue="ACTV" sfwLoadType="CodeGroup" sfwLoadSource="215" sfwEntityField="StatusValue" />
              </sfwColumn>
              <sfwColumn>
                <sfwLabel ID="capEmailAddress" Text="Email Address : " sfwIsCaption="True" />
              </sfwColumn>
              <sfwColumn>
                <sfwTextBox ID="txtEmailAddress" sfwEntityField="EmailAddress" Width="500px" />
              </sfwColumn>
            </sfwRow>
            <sfwRow>
              <sfwColumn>
                <sfwLabel ID="capNpnNumber" Text="NPN Number : " sfwIsCaption="True" />
              </sfwColumn>
              <sfwColumn>
                <sfwTextBox ID="txtNpnNumber" MaxLength="10" sfwEntityField="NpnNumber" />
              </sfwColumn>
              <sfwColumn>
                <sfwLabel ID="capRegistrationDate" Text="Registration Date : " sfwIsCaption="True" />
              </sfwColumn>
              <sfwColumn>
                <sfwTextBox ID="txtRegistrationDate" sfwDataFormat="{0:d}" sfwEntityField="RegistrationDate" />
              </sfwColumn>
            </sfwRow>
            <sfwRow>
              <sfwColumn>
                <sfwLabel ID="capNdpersLoginId" Text="ND Login ID : " sfwIsCaption="True" />
              </sfwColumn>
              <sfwColumn>
                <sfwLabel ID="lblNdpersLoginId" sfwEntityField="NdpersLoginId" />
              </sfwColumn>
              <sfwColumn>
                <sfwLabel ID="capExceptFromTraining" Text="Exempt From Training : " sfwIsCaption="True" />
              </sfwColumn>
              <sfwColumn>
                <sfwCheckBox ID="chkExceptFromTrainingFlag" sfwDefaultValue="N" sfwEntityField="ExemptFromTrainingFlag" />
              </sfwColumn>
            </sfwRow>
          </sfwTable>
        </sfwPanel>
      </sfwColumn>
    </sfwRow>
    <sfwRow>
      <sfwColumn>
        <sfwPanel ID="pnlContactAddrTab" sfwCaption="Other Details">
          <sfwTable ID="tblContactAddrTab">
            <sfwRow>
              <sfwColumn>
                <sfwTabContainer ID="tctContactAddrTab">
                  <Tabs>
                    <sfwTabSheet HeaderText="Affiliated Organization" ID="tshAffiliatedOrg">
                      <sfwTable ID="tblAffiliatedOrg">
                        <sfwRow>
                          <sfwColumn CssClass="captionTd">
                            <sfwLabel ID="capLabel" sfwIsCaption="True" Text="Org Code Id : " />
                            <sfwTextBox ID="txtOrgCodeId" sfwEntityField="IstrOrgCodeId" />
                            <sfwImageButton ID="btnRetrieveClick" sfwMethodName="btnRetrieve_Click" ImageUrl="~/Image/Lookup.jpg" ImageAlign="AbsMiddle" Text="Retrieve_Click" sfwActiveForm="wfmContactOrganizationLookup" sfwRelatedControl="txtOrgCodeId" sfwSelection="Many" sfwSelectedIndex="OrgCode" />
                            <sfwButton sfwMethodName="btnExecuteBusinessMethod_Click" Text="Add Organization" ID="btnAffiliateNewOrg" sfwObjectMethod="btnSaveNewOrg_Click" sfwExecuteMethodType="ObjectMethod" sfwNavigationParameter="aintOrgCodeId=IstrOrgCodeId;aintContactId=ContactId" />
                          </sfwColumn>
                        </sfwRow>
                        <sfwRow>
                          <sfwColumn>
                            <sfwButton ID="btnOpenOrg" sfwActiveForm="wfmOrganizationMaintenance" sfwMethodName="btnOpen_Click" sfwNavigationParameter="Aintorgid=OrgId" sfwRelatedControl="grvAffliatedOrgs" Text="Open" sfwDisableViewOnly="True" />
                            <sfwButton ID="btnDeleteAffiliatedOrg" sfwMethodName="btnExecuteBusinessMethod_Click" sfwRelatedControl="grvAffliatedOrgs" sfwSelection="Many" Text="Inactivate" OnClientClick="fnInactiveSelectedOrgContact(e);" sfwExecuteMethodType="ObjectMethod" sfwObjectMethod="btnRemoveOrg_Click" sfwNavigationParameter="aintOrgCodeId=OrgId;aintContactId=ContactId" />
                          </sfwColumn>
                        </sfwRow>
                        <sfwRow>
                          <sfwColumn>
                            <sfwGridView AllowPaging="True" AllowSorting="True" AutoGenerateColumns="False" ID="grvAffliatedOrgs" sfwSelection="Many" sfwEntityField="lstAffliatedOrgs">
                              <Columns>
                                <TemplateField HeaderText="Org Code ID">
                                  <ItemTemplate>
                                    <sfwLabel sfwLinkable="True" sfwRelatedControl="btnOpenOrg" sfwEntityField="OrgCode" />
                                  </ItemTemplate>
                                </TemplateField>
                                <TemplateField HeaderText="Org Name">
                                  <ItemTemplate>
                                    <sfwLabel sfwEntityField="OrgName" />
                                  </ItemTemplate>
                                </TemplateField>
                                <TemplateField HeaderText="Org Status">
                                  <ItemTemplate>
                                    <sfwLabel sfwEntityField="StatusDescription" />
                                  </ItemTemplate>
                                </TemplateField>
                                <TemplateField HeaderText="Org ID" Visible="False">
                                  <ItemTemplate>
                                    <sfwLabel sfwEntityField="OrgId" />
                                  </ItemTemplate>
                                </TemplateField>
                                <TemplateField HeaderText="Status with Organization">
                                  <ItemTemplate>
                                    <sfwLabel sfwEntityField="lstrOrgContactStatus" />
                                  </ItemTemplate>
                                </TemplateField>
                              </Columns>
                            </sfwGridView>
                          </sfwColumn>
                        </sfwRow>
                        <sfwRow>
                          <sfwColumn>
                            <sfwLabel ID="lblIsContactAffiliatedWithNoOrg" sfwEntityField="IblnIsContactAffiliatedWithNoOrg" CssClass="hideControl" />
                          </sfwColumn>
                        </sfwRow>
                      </sfwTable>
                    </sfwTabSheet>
                    <sfwTabSheet HeaderText="Contact Addresses" ID="tshContactAddr">
                      <sfwTable ID="tblContactAddr">
                        <sfwRow>
                          <sfwColumn>
                            <sfwButton ID="btnNewContactAddress" sfwActiveForm="wfmContactAddressMaintenance" sfwMethodName="btnNew_Click" sfwNavigationParameter="AintContactid=lblContactId" Text="New" />
                            <sfwButton ID="btnOpenContactAddress" sfwActiveForm="wfmContactAddressMaintenance" sfwMethodName="btnOpen_Click" sfwNavigationParameter="AintContactAddressid=ContactOrgAddressId" sfwRelatedControl="grvContactAddress" Text="Open" sfwDisableViewOnly="True" />
                            <sfwButton ID="btnDeleteContactAddress" sfwMethodName="btnDelete_Click" sfwRelatedControl="grvContactAddress" Text="Delete" />
                            <sfwButton ID="btnSetPrimaryAddress" sfwMethodName="btnExecuteBusinessMethod_Click" sfwNavigationParameter="aintContactAddressId=ContactOrgAddressId" sfwObjectMethod="SetContactPrimaryAddress" sfwRelatedControl="grvContactAddress" sfwSelection="One" Text="Set Primary Address" OnClientClick="fnCheckRecordSelect(e)" />
                          </sfwColumn>
                        </sfwRow>
                        <sfwRow>
                          <sfwColumn>
                            <sfwGridView AllowPaging="True" AllowSorting="True" AutoGenerateColumns="False" ID="grvContactAddress" sfwSelection="Many" sfwEntityField="lstContactAddress" sfwGridEntity="entOrgContactAddress">
                              <Columns>
                                <TemplateField HeaderText="Address">
                                  <ItemTemplate>
                                    <sfwLabel sfwLinkable="True" sfwRelatedControl="btnOpenContactAddress" sfwEntityField="AddrDescription" />
                                  </ItemTemplate>
                                </TemplateField>
                                <TemplateField HeaderText="City">
                                  <ItemTemplate>
                                    <sfwLabel sfwEntityField="City" />
                                  </ItemTemplate>
                                </TemplateField>
                                <TemplateField HeaderText="State">
                                  <ItemTemplate>
                                    <sfwLabel sfwEntityField="StateDescription" />
                                  </ItemTemplate>
                                </TemplateField>
                                <TemplateField HeaderText="Country">
                                  <ItemTemplate>
                                    <sfwLabel sfwEntityField="CountryDescription" />
                                  </ItemTemplate>
                                </TemplateField>
                                <TemplateField HeaderText="Zip Code">
                                  <ItemTemplate>
                                    <sfwLabel sfwEntityField="ZipCode" />
                                  </ItemTemplate>
                                </TemplateField>
                                <TemplateField HeaderText="Zip 4 Code">
                                  <ItemTemplate>
                                    <sfwLabel sfwEntityField="Zip4Code" />
                                  </ItemTemplate>
                                </TemplateField>
                                <TemplateField HeaderText="Foreign Postal Code">
                                  <ItemTemplate>
                                    <sfwLabel sfwEntityField="ForeignPostalCode" />
                                  </ItemTemplate>
                                </TemplateField>
                                <TemplateField HeaderText="Foreign Province">
                                  <ItemTemplate>
                                    <sfwLabel sfwEntityField="ForeignProvince" />
                                  </ItemTemplate>
                                </TemplateField>
                                <TemplateField HeaderText="Contact Org Address ID" Visible="False">
                                  <ItemTemplate>
                                    <sfwLabel sfwEntityField="ContactOrgAddressId" />
                                  </ItemTemplate>
                                </TemplateField>
                                <TemplateField HeaderText="Primary Address Flag">
                                  <ItemTemplate>
                                    <sfwLabel sfwEntityField="PrimaryAddressFlag" />
                                  </ItemTemplate>
                                </TemplateField>
                              </Columns>
                            </sfwGridView>
                          </sfwColumn>
                        </sfwRow>
                      </sfwTable>
                    </sfwTabSheet>
                    <sfwTabSheet HeaderText="Seminar Attendance" ID="tshNewPage">
                      <sfwTable ID="tblNewPage">
                        <sfwRow>
                          <sfwColumn>
                            <sfwButton ID="btnNewSeminarAttendeeDetail" sfwActiveForm="wfmSeminarAttendeeDetailMaintenance" sfwMethodName="btnNew_Click" Text="New" Visible="False" />
                            <sfwButton ID="btnOpenSeminarAttendeeDetail" sfwActiveForm="wfmSeminarAttendeeDetailMaintenance" sfwMethodName="btnOpen_Click" sfwNavigationParameter="Aintseminarattendeedetailid=SeminarAttendeeDetailId" sfwRelatedControl="grvSeminarAttendeeDetail" Text="Open" sfwDisableViewOnly="True" />
                            <sfwButton ID="btnOpenContactTicket" sfwActiveForm="wfmContactTicketMaintenance" sfwMethodName="btnOpen_Click" sfwNavigationParameter="Aintcontactticketid=objSeminarSchedule.ContactTicketId" sfwRelatedControl="grvSeminarAttendeeDetail" Text="Open" sfwDisableViewOnly="True" />
                          </sfwColumn>
                        </sfwRow>
                        <sfwRow>
                          <sfwColumn>
                            <sfwGridView AllowPaging="True" AllowSorting="True" AutoGenerateColumns="False" ID="grvSeminarAttendeeDetail" sfwSelection="Many" sfwEntityField="lstSeminarAttendeeDetail" sfwGridEntity="entSeminarAttendeeDetail">
                              <Columns>
                                <TemplateField HeaderText="Ticket Number">
                                  <ItemTemplate>
                                    <sfwLabel sfwLinkable="True" sfwRelatedControl="btnOpenContactTicket" sfwEntityField="objSeminarSchedule.ContactTicketId" />
                                  </ItemTemplate>
                                </TemplateField>
                                <TemplateField HeaderText="Seminar Type">
                                  <ItemTemplate>
                                    <sfwLabel sfwEntityField="objSeminarSchedule.SeminarTypeDescription" />
                                  </ItemTemplate>
                                </TemplateField>
                                <TemplateField HeaderText="Seminar Name">
                                  <ItemTemplate>
                                    <sfwLabel sfwEntityField="objSeminarSchedule.SeminarName" />
                                  </ItemTemplate>
                                </TemplateField>
                                <TemplateField HeaderText="Seminar Date">
                                  <ItemTemplate>
                                    <sfwLabel sfwDataFormat="{0:d}" sfwEntityField="objSeminarSchedule.SeminarDate1" />
                                  </ItemTemplate>
                                </TemplateField>
                                <TemplateField HeaderText="Facilitator">
                                  <ItemTemplate>
                                    <sfwLabel sfwEntityField="objFacilitator.UserId" />
                                  </ItemTemplate>
                                </TemplateField>
                                <TemplateField HeaderText="Seminar Attendee Detail ID" Visible="False">
                                  <ItemTemplate>
                                    <sfwLabel sfwEntityField="SeminarAttendeeDetailId" />
                                  </ItemTemplate>
                                </TemplateField>
                              </Columns>
                            </sfwGridView>
                          </sfwColumn>
                        </sfwRow>
                      </sfwTable>
                    </sfwTabSheet>
                    <sfwTabSheet ID="tshNewPage1" HeaderText="Notes">
                      <sfwTable ID="tblTable">
                        <sfwRow>
                          <sfwColumn>
                            <sfwButton ID="btnNewScreenNotes" sfwActiveForm="wfmScreenNotesMaintenance" sfwMethodName="btnNew_Click" sfwNavigationParameter="ScreenId=#7021;ScreenValue=#CONM;ScreenPrimaryId=lblContactId" sfwResource="199" Text="New" />
                            <sfwButton ID="btnOpenScreenNotes" sfwActiveForm="wfmScreenNotesMaintenance" sfwMethodName="btnOpen_Click" sfwNavigationParameter="aintPrimaryKey=ScreenNotesId" sfwRelatedControl="grvScreenNotes" sfwResource="199" Text="Open" sfwDisableViewOnly="True" />
                            <sfwButton ID="btndeleteNotes" sfwMethodName="btnDelete_Click" sfwRelatedControl="grvScreenNotes" sfwResource="199" Text="Delete" />
                          </sfwColumn>
                          <sfwColumn />
                          <sfwColumn />
                          <sfwColumn />
                        </sfwRow>
                        <sfwRow>
                          <sfwColumn ColumnSpan="4">
                            <sfwGridView sfwEntityField="lstScreenNotes" ID="grvScreenNotes" AllowPaging="True" AllowSorting="True" sfwSelection="Many">
                              <Columns>
                                <TemplateField HeaderText="Modified By">
                                  <ItemTemplate>
                                    <sfwLabel sfwEntityField="ModifiedBy" sfwLinkable="True" sfwRelatedControl="btnOpenScreenNotes" />
                                  </ItemTemplate>
                                </TemplateField>
                                <TemplateField HeaderText="Modified Date">
                                  <ItemTemplate>
                                    <sfwLabel sfwEntityField="ModifiedDate" sfwDataFormat="{0:d}" />
                                  </ItemTemplate>
                                </TemplateField>
                                <TemplateField HeaderText="Note ID">
                                  <ItemTemplate>
                                    <sfwLabel sfwEntityField="ScreenNotesId" />
                                  </ItemTemplate>
                                </TemplateField>
                                <TemplateField HeaderText="Notes">
                                  <ItemTemplate>
                                    <sfwLabel sfwEntityField="Notes" />
                                  </ItemTemplate>
                                </TemplateField>
                              </Columns>
                            </sfwGridView>
                          </sfwColumn>
                        </sfwRow>
                      </sfwTable>
                    </sfwTabSheet>
                  </Tabs>
                </sfwTabContainer>
              </sfwColumn>
            </sfwRow>
          </sfwTable>
        </sfwPanel>
      </sfwColumn>
    </sfwRow>
    <sfwRow>
      <sfwColumn>
        <sfwPanel ID="pnlAuditInfo" sfwCaption="Audit Information">
          <sfwTable CssClass="Table" ID="tblAuditInfo">
            <sfwRow>
              <sfwColumn>
                <sfwLabel ID="capCreate" Text="Create : " sfwIsCaption="True" />
              </sfwColumn>
              <sfwColumn>
                <sfwLabel ID="lblCreatedBy" sfwEntityField="CreatedBy" />
                <sfwLabel ID="lblUpdateSeq" sfwTwoWayBinding="True" Visible="False" sfwEntityField="UpdateSeq" />
              </sfwColumn>
              <sfwColumn>
                <sfwLabel ID="lblCreatedDate" sfwEntityField="CreatedDate" sfwDataFormat="{0:G}" />
              </sfwColumn>
              <sfwColumn>
                <sfwLabel ID="capModify" Text="Modify : " sfwIsCaption="True" />
              </sfwColumn>
              <sfwColumn>
                <sfwLabel ID="lblModifiedBy" sfwEntityField="ModifiedBy" />
              </sfwColumn>
              <sfwColumn>
                <sfwLabel ID="lblModifiedDate" sfwEntityField="ModifiedDate" sfwDataFormat="{0:G}" />
              </sfwColumn>
            </sfwRow>
          </sfwTable>
        </sfwPanel>
      </sfwColumn>
    </sfwRow>
  </sfwTable>
  <loaddetails>
    <entityfield ID="lstAffliatedOrgs" sfwNewAutoLoad="False" sfwUpdateAutoLoad="False" />
    <entityfield ID="lstContactAddress" sfwNewAutoLoad="False" sfwUpdateAutoLoad="False" />
    <entityfield ID="lstSeminarAttendeeDetail" sfwNewAutoLoad="False" sfwUpdateAutoLoad="False" />
    <entityfield ID="lstScreenNotes" sfwNewAutoLoad="False" sfwUpdateAutoLoad="False" />
  </loaddetails>
</form>