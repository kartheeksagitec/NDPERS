<?xml version="1.0" encoding="utf-8"?>
<entity ID="entActuaryFileRhicDetail" sfwMainCDO="icdoActuaryFileRhicDetail" sfwType="BusinessRule" sfwActive="True" sfwStatus="Review" sfwObjectID="busActuaryFileRhicDetail" sfwTableName="sgt_actuary_file_rhic_detail" sfwView="False">
  <queries>
    <query ID="fleRhicFileData" sfwQueryType="SelectQuery" sfwDataType="EntityTable" sfwSql="&#xD;&#xA;SELECT    @HEADERID AS ACTUARY_FILE_HEADER_ID,P.PERSON_ID AS PERSON_ID,&#xD;&#xA;     PA.PAYEE_ACCOUNT_ID,PA.PERSON_ACCOUNT_ID,&#xD;&#xA;     PA.BENEFIT_OPTION_VALUE,&#xD;&#xA;     P.FIRST_NAME,P.LAST_NAME,PA.ACCOUNT_RELATION_VALUE,&#xD;&#xA;     PA.PAYEE_STATUS_VALUE,P.SSN,&#xD;&#xA;     P.MARITAL_STATUS_VALUE,P.DATE_OF_BIRTH ,P.GENDER_VALUE,&#xD;&#xA;     CASE WHEN P.GENDER_VALUE='MALE' THEN 'M' ELSE 'F' END GENDER,&#xD;&#xA;     ISNULL(PA.BENEFIT_BEGIN_DATE,RC1.RHIC_BEGIN_DATE) AS RHIC_BENEFIT_BEGIN_DATE,&#xD;&#xA;     PA.PLAN_PARTICIPATION_START_DATE,&#xD;&#xA;     CAST((PENSION_SERVICE_CREDIT/12.0) AS DECIMAL(10,6)) AS PENSION_SERVICE_CREDIT,CAST((TOTAL_VESTED_SERVICE_CREDIT/12.0) AS DECIMAL(10,6)) AS TOTAL_VESTED_SERVICE_CREDIT, &#xD;&#xA;     BRC.MONTHLY_RHIC_AMOUNT AS MONTHLY_RHIC_AMOUNT,&#xD;&#xA;     BRC.APPLIED_GHDV_RHIC_AMOUNT AS APPLIED_GHDV_RHIC_AMOUNT,&#xD;&#xA;     PACI.COVERAGE_CODE,PA.JOINT_ANNUITANT_DOB,&#xD;&#xA;     PA.RHIC_OPTION_VALUE,&#xD;&#xA;     PA.JOINT_ANNUITANT_GENDER_VALUE, PA.OWNER_PERSLINK_ID&#xD;&#xA;  FROM&#xD;&#xA;   (&#xD;&#xA;   --PIR 17486 - RHIC issues 1 &amp; 2 - Excluding plan id 6 and 23. And displaying RHIC amount linked to payee account separately&#xD;&#xA;    SELECT PERSON_ID,START_DATE,End_date,&#xD;&#xA;     (ISNULL(TOTAL_OTHER_RHIC_AMOUNT,0)+&#xD;&#xA;      ISNULL(TOTAL_REIMBURSEMENT_AMOUNT,0)) AS APPLIED_GHDV_RHIC_AMOUNT,&#xD;&#xA;      (ISNULL(DET.RHIC_AMOUNT,0)- ISNULL(TOTAL_JS_RHIC_AMOUNT,0)) AS MONTHLY_RHIC_AMOUNT&#xD;&#xA;     ,RANK() OVER (PARTITION BY PERSON_ID ORDER BY isnull(End_date,'99991231') Desc,start_date desc ,RC.Benefit_rhic_combine_id desc ) AS ROWRANK &#xD;&#xA;     ,DET.DONAR_PAYEE_ACCOUNT_ID&#xD;&#xA;     FROM  SGT_BENEFIT_RHIC_COMBINE  RC &#xD;&#xA;&#x9; INNER JOIN SGT_BENEFIT_RHIC_COMBINE_DETAIL DET on DET.BENEFIT_RHIC_COMBINE_ID = RC.BENEFIT_RHIC_COMBINE_ID&#xD;&#xA;&#x9; INNER JOIN SGT_PAYEE_ACCOUNT PAYEE on PAYEE.PAYEE_ACCOUNT_ID  = DET.DONAR_PAYEE_ACCOUNT_ID&#xD;&#xA;&#x9; INNER JOIN SGT_BENEFIT_APPLICATION APP on PAYEE.APPLICATION_ID = APP.BENEFIT_APPLICATION_ID&#xD;&#xA;     WHERE @EFFECTIVEDATE BETWEEN RC.START_DATE &#xD;&#xA;     AND (CASE WHEN RC.END_DATE IS NULL THEN '99991231' ELSE RC.END_DATE END)&#xD;&#xA;     AND RC.ACTION_STATUS_VALUE in ( 'APPR','ENDD')&#xD;&#xA;     and isnull(COMBINED_RHIC_AMOUNT,0) &lt;&gt; isnull(TOTAL_JS_RHIC_AMOUNT,0)&#xD;&#xA;&#x9; AND PLAN_ID NOT IN (6, 23)&#xD;&#xA;   ) AS BRC&#xD;&#xA;  INNER JOIN SGT_PERSON P&#xD;&#xA;   ON BRC.PERSON_ID=P.PERSON_ID &#xD;&#xA;  LEFT OUTER JOIN &#xD;&#xA;   (&#xD;&#xA;    SELECT PERSON_ID,MIN(RC1.START_DATE) AS RHIC_BEGIN_DATE &#xD;&#xA;     FROM  SGT_BENEFIT_RHIC_COMBINE  RC1 &#xD;&#xA;     WHERE @EFFECTIVEDATE BETWEEN RC1.START_DATE &#xD;&#xA;     AND (CASE WHEN RC1.END_DATE IS NULL THEN '99991231' ELSE RC1.END_DATE END)&#xD;&#xA;     AND ACTION_STATUS_VALUE IN ( 'APPR','ENDD')&#xD;&#xA;     AND ISNULL(COMBINED_RHIC_AMOUNT,0) &lt;&gt; ISNULL(TOTAL_JS_RHIC_AMOUNT,0)&#xD;&#xA;    GROUP BY PERSON_ID&#xD;&#xA;   ) RC1 ON BRC.PERSON_ID=RC1.PERSON_ID &#xD;&#xA;  LEFT OUTER JOIN &#xD;&#xA;   (&#xD;&#xA;    SELECT Pa.*,PAS.STATUS_VALUE AS PAYEE_STATUS_VALUE,&#xD;&#xA;     PACM.START_DATE AS PLAN_PARTICIPATION_START_DATE, PACM.PERSON_ID AS OWNER_PERSLINK_ID,&#xD;&#xA;     BAA.DATE_OF_BIRTH AS JOINT_ANNUITANT_DOB,&#xD;&#xA;     BAA.PERSON_ACCOUNT_ID,&#xD;&#xA;     BACC.RHIC_BENEFIT_OPTION_VALUE AS RHIC_OPTION_VALUE,&#xD;&#xA;     BAA.GENDER_VALUE AS JOINT_ANNUITANT_GENDER_VALUE,&#xD;&#xA;     PENSION_SERVICE_CREDIT,&#xD;&#xA;     TOTAL_VESTED_SERVICE_CREDIT,BAA.PLAN_ID&#xD;&#xA;     From SGT_PAYEE_ACCOUNT PA  (NOLOCK)&#xD;&#xA;     INNER JOIN SGT_BENEFIT_ACCOUNT BACC&#xD;&#xA;      ON BACC.BENEFIT_ACCOUNT_ID=PA.BENEFIT_ACCOUNT_ID&#xD;&#xA;     INNER JOIN SGT_PAYEE_ACCOUNT_STATUS PAS &#xD;&#xA;      ON PAS.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID  &#xD;&#xA;     INNER JOIN SGS_CODE_VALUE CV (NOLOCK)&#xD;&#xA;      ON PAS.STATUS_ID= CV.CODE_ID AND PAS.STATUS_VALUE = CV.CODE_VALUE&#xD;&#xA;     INNER JOIN &#xD;&#xA;      (&#xD;&#xA;       SELECT BA.BENEFIT_APPLICATION_ID,BA.PLAN_ID,BAPA.PERSON_ACCOUNT_ID,J.DATE_OF_BIRTH,J.GENDER_VALUE &#xD;&#xA;       FROM SGT_BENEFIT_APPLICATION(NOLOCK) BA &#xD;&#xA;        INNER JOIN SGT_BENEFIT_APPLICATION_PERSON_ACCOUNT(NOLOCK) BAPA &#xD;&#xA;         ON  BA.BENEFIT_APPLICATION_ID = BAPA.BENEFIT_APPLICATION_ID  &#xD;&#xA;        LEFT OUTER JOIN SGT_PERSON J&#xD;&#xA;         ON J.PERSON_ID=BA.JOINT_ANNUITANT_PERSLINK_ID      &#xD;&#xA;       WHERE ISNULL(IS_APPLICATION_PERSON_ACCOUNT_FLAG,'N') = 'Y' &#xD;&#xA;          AND BA.ACTION_STATUS_VALUE NOT IN ('DENI','CANC')&#xD;&#xA;       )AS BAA ON PA.APPLICATION_ID = BAA.BENEFIT_APPLICATION_ID&#xD;&#xA;     INNER JOIN SGT_PERSON_ACCOUNT PACM&#xD;&#xA;      ON PACM.PERSON_ACCOUNT_ID=BAA.PERSON_ACCOUNT_ID &#xD;&#xA;     WHERE (CV.DATA2 NOT IN ('TRMD','CNLD')) &#xD;&#xA;     AND PAYEE_ACCOUNT_STATUS_ID  = &#xD;&#xA;      (SELECT TOP 1 PAYEE_ACCOUNT_STATUS_ID&#xD;&#xA;       FROM SGT_PAYEE_ACCOUNT_STATUS PAS1 (NOLOCK)&#xD;&#xA;       WHERE PAS1.PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID&#xD;&#xA;       AND PAS1.STATUS_EFFECTIVE_DATE &lt;= @EFFECTIVEDATE&#xD;&#xA;       ORDER BY PAS1.STATUS_EFFECTIVE_DATE DESC,PAS1.PAYEE_ACCOUNT_STATUS_ID DESC&#xD;&#xA;      )&#xD;&#xA;     AND PAS.STATUS_EFFECTIVE_DATE &lt;= @EFFECTIVEDATE&#xD;&#xA;     AND BENEFIT_BEGIN_DATE &lt;=  @EFFECTIVEDATE&#xD;&#xA;     AND (BENEFIT_END_DATE IS NULL OR BENEFIT_END_DATE &gt; @EFFECTIVEDATE)&#xD;&#xA;     AND PA.BENEFIT_ACCOUNT_TYPE_VALUE &lt;&gt; 'RFND'  &#xD;&#xA;     AND ((@PLANID = 0) OR (BAA.PLAN_ID = @PLANID))&#xD;&#xA;     AND PACM.PLAN_ID NOT IN(21)&#xD;&#xA;   ) PA&#xD;&#xA;   ON BRC.PERSON_ID=PA.PAYEE_PERSLINK_ID AND BRC.DONAR_PAYEE_ACCOUNT_ID = PA.PAYEE_ACCOUNT_ID&#xD;&#xA;  LEFT OUTER JOIN &#xD;&#xA;  (&#xD;&#xA;   SELECT PACI.PERSON_ACCOUNT_ID,&#xD;&#xA;       PACI.PERSON_ID,GHDVH.PLAN_PARTICIPATION_STATUS_VALUE,GHDVH.COVERAGE_CODE &#xD;&#xA;    FROM SGT_PERSON_ACCOUNT PACI&#xD;&#xA;   INNER JOIN SGT_PERSON_ACCOUNT_GHDV GHDV &#xD;&#xA;    ON GHDV.PERSON_ACCOUNT_ID=PACI.PERSON_ACCOUNT_ID&#xD;&#xA;   INNER JOIN SGT_PERSON_ACCOUNT_GHDV_HISTORY GHDVH&#xD;&#xA;    ON GHDVH.PERSON_ACCOUNT_GHDV_ID =GHDV.PERSON_ACCOUNT_GHDV_ID &#xD;&#xA;    WHERE @EFFECTIVEDATE BETWEEN GHDVH.START_DATE &#xD;&#xA;      AND (CASE WHEN GHDVH.END_DATE IS NULL THEN '99991231' &#xD;&#xA;          ELSE GHDVH.END_DATE END)&#xD;&#xA;      AND GHDVH.START_DATE &lt;&gt; CASE WHEN GHDVH.END_DATE IS NOT NULL &#xD;&#xA;            THEN GHDVH.END_DATE ELSE '99991231' END&#xD;&#xA;      AND GHDVH.PLAN_PARTICIPATION_STATUS_VALUE='ENL2' &#xD;&#xA;      AND (PACI.PLAN_ID=12 OR PACI.PLAN_ID=9) &#xD;&#xA;  ) AS PACI&#xD;&#xA;  ON PACI.PERSON_ID=BRC.PERSON_ID &#xD;&#xA; Where RowRank = 1&#xD;&#xA;  AND ((@PLANID = 0) OR (PA.PLAN_ID = @PLANID))">
      <parameters>
        <parameter ID="@EFFECTIVEDATE" sfwDataType="DateTime" />
        <parameter ID="@HEADERID" sfwDataType="int" />
        <parameter ID="@PLANID" sfwDataType="int" />
      </parameters>
    </query>
  </queries>
  <attributes>
    <attribute ID="ActuaryFileRhicDetailId" sfwType="Column" sfwValue="actuary_file_rhic_detail_id" sfwKeyNo="1" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="True" sfwDataType="int" sfwRequired="False" />
    <attribute ID="ActuaryFileHeaderId" sfwType="Column" sfwValue="actuary_file_header_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="PersonId" sfwType="Column" sfwValue="person_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="PayeeAccountId" sfwType="Column" sfwValue="payee_account_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="PersonAccountId" sfwType="Column" sfwValue="person_account_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
    <attribute ID="AccountRelationDescription" sfwType="Description" sfwValue="account_relation_description" />
    <attribute ID="AccountRelationId" sfwType="Column" sfwValue="account_relation_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="2225" sfwDataType="int" sfwRequired="False" />
    <attribute ID="AccountRelationValue" sfwType="Column" sfwValue="account_relation_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="PayeeStatusDescription" sfwType="Description" sfwValue="payee_status_description" />
    <attribute ID="PayeeStatusId" sfwType="Column" sfwValue="payee_status_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="2203" sfwDataType="int" sfwRequired="False" />
    <attribute ID="PayeeStatusValue" sfwType="Column" sfwValue="payee_status_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="MaritalStatusDescription" sfwType="Description" sfwValue="marital_status_description" />
    <attribute ID="MaritalStatusId" sfwType="Column" sfwValue="marital_status_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="306" sfwDataType="int" sfwRequired="False" />
    <attribute ID="MaritalStatusValue" sfwType="Column" sfwValue="marital_status_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="RhicBenefitBeginDate" sfwType="Column" sfwValue="rhic_benefit_begin_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="PlanParticipationStartDate" sfwType="Column" sfwValue="plan_participation_start_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="BenefitOptionDescription" sfwType="Description" sfwValue="benefit_option_description" />
    <attribute ID="BenefitOptionId" sfwType="Column" sfwValue="benefit_option_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="2216" sfwDataType="int" sfwRequired="False" />
    <attribute ID="BenefitOptionValue" sfwType="Column" sfwValue="benefit_option_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="PensionServiceCredit" sfwType="Column" sfwValue="pension_service_credit" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,6" />
    <attribute ID="TotalVestedServiceCredit" sfwType="Column" sfwValue="total_vested_service_credit" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,6" />
    <attribute ID="MonthlyRhicAmount" sfwType="Column" sfwValue="monthly_rhic_amount" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,2" />
    <attribute ID="AppliedGhdvRhicAmount" sfwType="Column" sfwValue="applied_ghdv_rhic_amount" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="decimal" sfwRequired="False" sfwLength="13,2" />
    <attribute ID="CoverageCode" sfwType="Column" sfwValue="coverage_code" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="JointAnnuitantDob" sfwType="Column" sfwValue="joint_annuitant_dob" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="JointAnnuitantGenderDescription" sfwType="Description" sfwValue="joint_annuitant_gender_description" />
    <attribute ID="JointAnnuitantGenderId" sfwType="Column" sfwValue="joint_annuitant_gender_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="300" sfwDataType="int" sfwRequired="False" />
    <attribute ID="JointAnnuitantGenderValue" sfwType="Column" sfwValue="joint_annuitant_gender_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="RhicOptionDescription" sfwType="Description" sfwValue="rhic_option_description" />
    <attribute ID="RhicOptionId" sfwType="Column" sfwValue="rhic_option_id" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwCodeID="1905" sfwDataType="int" sfwRequired="False" />
    <attribute ID="RhicOptionValue" sfwType="Column" sfwValue="rhic_option_value" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="True" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="4" />
    <attribute ID="CreatedBy" sfwType="Column" sfwValue="created_by" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="50" />
    <attribute ID="CreatedDate" sfwType="Column" sfwValue="created_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="ModifiedBy" sfwType="Column" sfwValue="modified_by" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="string" sfwRequired="False" sfwLength="50" />
    <attribute ID="ModifiedDate" sfwType="Column" sfwValue="modified_date" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="DateTime" sfwRequired="False" />
    <attribute ID="UpdateSeq" sfwType="Column" sfwValue="update_seq" sfwKeyNo="0" sfwIsSequence="False" sfwIsNull="False" sfwIsIdentity="False" sfwDataType="int" sfwRequired="False" />
  </attributes>
</entity>